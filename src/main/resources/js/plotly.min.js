(function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,t.Plotly=e()}})(function(){var e=String.prototype,t=Math.sign,o=Math.asin,d=Math.acos,c=Math.SQRT2,m=Math.exp,L=Math.atan2,E=Math.LN2,I=Math.LN10,P=Math.log,D=String.fromCharCode,R=Math.cos,M=Math.ceil,N=Math.sqrt,V=Math.round,Pe=Math.PI,De=Math.sin,ea=Math.min,ya=Math.pow,fa=Math.tan,xa=Math.atan,_a=Math.abs,ba=Math.floor,va=Math.max,ka;return function(){function l(s,e,r){function t(d,i){if(!e[d]){if(!s[d]){var n="function"==typeof require&&require;if(!i&&n)return n(d,!0);if(o)return o(d,!0);var c=new Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c}var a=e[d]={exports:{}};s[d][0].call(a.exports,function(e){var a=s[d][1][e];return t(a||e)},a,a.exports,l,s,e,r)}return e[d].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)t(r[a]);return t}return l}()({1:[function(e){"use strict";var t=e("../src/lib"),a={"X,X div":"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color 0.3s ease 0s;-moz-transition:background-color 0.3s ease 0s;-ms-transition:background-color 0.3s ease 0s;-o-transition:background-color 0.3s ease 0s;transition:background-color 0.3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var r in a){var o=r.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(o,a[r])}},{"../src/lib":719}],2:[function(e,t){"use strict";t.exports=e("../src/transforms/aggregate")},{"../src/transforms/aggregate":1266}],3:[function(e,t){"use strict";t.exports=e("../src/traces/bar")},{"../src/traces/bar":864}],4:[function(e,t){"use strict";t.exports=e("../src/traces/barpolar")},{"../src/traces/barpolar":876}],5:[function(e,t){"use strict";t.exports=e("../src/traces/box")},{"../src/traces/box":886}],6:[function(e,t){"use strict";t.exports=e("../src/components/calendars")},{"../src/components/calendars":591}],7:[function(e,t){"use strict";t.exports=e("../src/traces/candlestick")},{"../src/traces/candlestick":895}],8:[function(e,t){"use strict";t.exports=e("../src/traces/carpet")},{"../src/traces/carpet":914}],9:[function(e,t){"use strict";t.exports=e("../src/traces/choropleth")},{"../src/traces/choropleth":928}],10:[function(e,t){"use strict";t.exports=e("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":935}],11:[function(e,t){"use strict";t.exports=e("../src/traces/cone")},{"../src/traces/cone":941}],12:[function(e,t){"use strict";t.exports=e("../src/traces/contour")},{"../src/traces/contour":956}],13:[function(e,t){"use strict";t.exports=e("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":967}],14:[function(e,t){"use strict";t.exports=e("../src/core")},{"../src/core":697}],15:[function(e,t){"use strict";t.exports=e("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":977}],16:[function(e,t){"use strict";t.exports=e("../src/transforms/filter")},{"../src/transforms/filter":1267}],17:[function(e,t){"use strict";t.exports=e("../src/traces/funnel")},{"../src/traces/funnel":987}],18:[function(e,t){"use strict";t.exports=e("../src/traces/funnelarea")},{"../src/traces/funnelarea":996}],19:[function(e,t){"use strict";t.exports=e("../src/transforms/groupby")},{"../src/transforms/groupby":1268}],20:[function(e,t){"use strict";t.exports=e("../src/traces/heatmap")},{"../src/traces/heatmap":1009}],21:[function(e,t){"use strict";t.exports=e("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1018}],22:[function(e,t){"use strict";t.exports=e("../src/traces/histogram")},{"../src/traces/histogram":1030}],23:[function(e,t){"use strict";t.exports=e("../src/traces/histogram2d")},{"../src/traces/histogram2d":1036}],24:[function(e,t){"use strict";t.exports=e("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1040}],25:[function(e,t){"use strict";var a=e("./core");a.register([e("./bar"),e("./box"),e("./heatmap"),e("./histogram"),e("./histogram2d"),e("./histogram2dcontour"),e("./contour"),e("./scatterternary"),e("./violin"),e("./funnel"),e("./waterfall"),e("./pie"),e("./sunburst"),e("./funnelarea"),e("./scatter3d"),e("./surface"),e("./isosurface"),e("./volume"),e("./mesh3d"),e("./cone"),e("./streamtube"),e("./scattergeo"),e("./choropleth"),e("./scattergl"),e("./splom"),e("./pointcloud"),e("./heatmapgl"),e("./parcoords"),e("./parcats"),e("./scattermapbox"),e("./choroplethmapbox"),e("./densitymapbox"),e("./sankey"),e("./indicator"),e("./table"),e("./carpet"),e("./scattercarpet"),e("./contourcarpet"),e("./ohlc"),e("./candlestick"),e("./scatterpolar"),e("./scatterpolargl"),e("./barpolar")]),a.register([e("./aggregate"),e("./filter"),e("./groupby"),e("./sort")]),a.register([e("./calendars")]),t.exports=a},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./indicator":26,"./isosurface":27,"./mesh3d":28,"./ohlc":29,"./parcats":30,"./parcoords":31,"./pie":32,"./pointcloud":33,"./sankey":34,"./scatter3d":35,"./scattercarpet":36,"./scattergeo":37,"./scattergl":38,"./scattermapbox":39,"./scatterpolar":40,"./scatterpolargl":41,"./scatterternary":42,"./sort":43,"./splom":44,"./streamtube":45,"./sunburst":46,"./surface":47,"./table":48,"./violin":49,"./volume":50,"./waterfall":51}],26:[function(e,t){"use strict";t.exports=e("../src/traces/indicator")},{"../src/traces/indicator":1046}],27:[function(e,t){"use strict";t.exports=e("../src/traces/isosurface")},{"../src/traces/isosurface":1052}],28:[function(e,t){"use strict";t.exports=e("../src/traces/mesh3d")},{"../src/traces/mesh3d":1057}],29:[function(e,t){"use strict";t.exports=e("../src/traces/ohlc")},{"../src/traces/ohlc":1062}],30:[function(e,t){"use strict";t.exports=e("../src/traces/parcats")},{"../src/traces/parcats":1071}],31:[function(e,t){"use strict";t.exports=e("../src/traces/parcoords")},{"../src/traces/parcoords":1081}],32:[function(e,t){"use strict";t.exports=e("../src/traces/pie")},{"../src/traces/pie":1092}],33:[function(e,t){"use strict";t.exports=e("../src/traces/pointcloud")},{"../src/traces/pointcloud":1101}],34:[function(e,t){"use strict";t.exports=e("../src/traces/sankey")},{"../src/traces/sankey":1107}],35:[function(e,t){"use strict";t.exports=e("../src/traces/scatter3d")},{"../src/traces/scatter3d":1143}],36:[function(e,t){"use strict";t.exports=e("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1149}],37:[function(e,t){"use strict";t.exports=e("../src/traces/scattergeo")},{"../src/traces/scattergeo":1156}],38:[function(e,t){"use strict";t.exports=e("../src/traces/scattergl")},{"../src/traces/scattergl":1167}],39:[function(e,t){"use strict";t.exports=e("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1176}],40:[function(e,t){"use strict";t.exports=e("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1183}],41:[function(e,t){"use strict";t.exports=e("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1189}],42:[function(e,t){"use strict";t.exports=e("../src/traces/scatterternary")},{"../src/traces/scatterternary":1196}],43:[function(e,t){"use strict";t.exports=e("../src/transforms/sort")},{"../src/transforms/sort":1270}],44:[function(e,t){"use strict";t.exports=e("../src/traces/splom")},{"../src/traces/splom":1205}],45:[function(e,t){"use strict";t.exports=e("../src/traces/streamtube")},{"../src/traces/streamtube":1213}],46:[function(e,t){"use strict";t.exports=e("../src/traces/sunburst")},{"../src/traces/sunburst":1220}],47:[function(e,t){"use strict";t.exports=e("../src/traces/surface")},{"../src/traces/surface":1229}],48:[function(e,t){"use strict";t.exports=e("../src/traces/table")},{"../src/traces/table":1237}],49:[function(e,t){"use strict";t.exports=e("../src/traces/violin")},{"../src/traces/violin":1245}],50:[function(e,t){"use strict";t.exports=e("../src/traces/volume")},{"../src/traces/volume":1253}],51:[function(e,t){"use strict";t.exports=e("../src/traces/waterfall")},{"../src/traces/waterfall":1261}],52:[function(e,t){"use strict";function a(e,t){this._controllerNames=Object.keys(e),this._controllerList=this._controllerNames.map(function(t){return e[t]}),this._mode=t,this._active=e[t],this._active||(this._mode="turntable",this._active=e.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}t.exports=function(e){e=e||{};var t=e.eye||[0,0,1],n=e.center||[0,0,0],l=e.up||[0,1,0],s=e.distanceLimits||[0,1/0],d=e.mode||"turntable",c=r(),p=o(),u=i();return c.setDistanceLimits(s[0],s[1]),c.lookAt(0,t,n,l),p.setDistanceLimits(s[0],s[1]),p.lookAt(0,t,n,l),u.setDistanceLimits(s[0],s[1]),u.lookAt(0,t,n,l),new a({turntable:c,orbit:p,matrix:u},d)};var r=e("turntable-camera-controller"),o=e("orbit-camera-controller"),i=e("matrix-camera-controller"),n=a.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(e){for(var t=e[0],a=[],r=0;r<e[1];++r)a.push("a"+r);var o="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+a.join()+")}";n[t]=Function.apply(null,a.concat(o))}),n.recalcMatrix=function(e){this._active.recalcMatrix(e)},n.getDistance=function(e){return this._active.getDistance(e)},n.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)},n.lastT=function(){return this._active.lastT()},n.setMode=function(e){if(e!==this._mode){var t=this._controllerNames.indexOf(e);if(!(0>t)){var a=this._active,r=this._controllerList[t],o=va(a.lastT(),r.lastT());a.recalcMatrix(o),r.setMatrix(o,a.computedMatrix),this._active=r,this._mode=e,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},n.getMode=function(){return this._mode}},{"matrix-camera-controller":433,"orbit-camera-controller":456,"turntable-camera-controller":542}],53:[function(e,t,a){(function(r,o){"object"==typeof a&&"undefined"!=typeof t?o(a,e("d3-array"),e("d3-collection"),e("d3-shape"),e("elementary-circuits-directed-graph")):"function"==typeof ka&&ka.amd?ka(["exports","d3-array","d3-collection","d3-shape","elementary-circuits-directed-graph"],o):o(r.d3=r.d3||{},r.d3,r.d3,r.d3,null)})(this,function(e,t,a,r,o){"use strict";function i(e){return e.target.depth}function n(e,t){return e.sourceLinks.length?e.depth:t-1}function l(e){return function(){return e}}function s(e,t){return c(e.source,t.source)||e.index-t.index}function d(e,t){return c(e.target,t.target)||e.index-t.index}function c(e,t){return e.partOfCycle===t.partOfCycle?e.y0-t.y0:"top"===e.circularLinkType||"bottom"===t.circularLinkType?-1:1}function p(e){return e.value}function u(e){return(e.y0+e.y1)/2}function g(e){return u(e.source)}function h(e){return u(e.target)}function m(e){return e.index}function y(e){return e.nodes}function f(e){return e.links}function x(e,t){var a=e.get(t);if(!a)throw new Error("missing: "+t);return a}function _(e,t){return t(e)}function b(){function e(){var e={nodes:O.apply(null,arguments),links:R.apply(null,arguments)};r(e),v(e,P,F),o(e),b(e),k(e,P),w(e,M,P),T(e);for(var t=0;t<4;t++)U(e,I,P),H(e,I,P),B(e,C,I,P),U(e,I,P),H(e,I,P);return W(e,C,I),L(e,j,I,P),e}function r(e){e.nodes.forEach(function(e,t){e.index=t,e.sourceLinks=[],e.targetLinks=[]});var t=a.map(e.nodes,P);return e.links.forEach(function(e,a){e.index=a;var r=e.source,o=e.target;"object"!==("undefined"==typeof r?"undefined":X(r))&&(r=e.source=x(t,r)),"object"!==("undefined"==typeof o?"undefined":X(o))&&(o=e.target=x(t,o)),r.sourceLinks.push(e),o.targetLinks.push(e)}),e}function o(e){e.nodes.forEach(function(e){e.partOfCycle=!1,e.value=va(t.sum(e.sourceLinks,p),t.sum(e.targetLinks,p)),e.sourceLinks.forEach(function(t){t.circular&&(e.partOfCycle=!0,e.circularLinkType=t.circularLinkType)}),e.targetLinks.forEach(function(t){t.circular&&(e.partOfCycle=!0,e.circularLinkType=t.circularLinkType)})})}function i(e){var a=0,r=0,o=0,i=0,n=t.max(e.nodes,function(e){return e.column});return e.links.forEach(function(e){e.circular&&("top"==e.circularLinkType?a+=e.width:r+=e.width,0==e.target.column&&(i+=e.width),e.source.column==n&&(o+=e.width))}),a=0<a?a+25+10:a,r=0<r?r+25+10:r,o=0<o?o+25+10:o,i=0<i?i+25+10:i,{top:a,bottom:r,left:i,right:o}}function _(e,a){var r=t.max(e.nodes,function(e){return e.column}),o=E-S,i=I-C,n=o+a.right+a.left,l=i+a.top+a.bottom,s=o/n,d=i/l;return S=S*s+a.left,E=0==a.right?E:E*s,C=C*d+a.top,I*=d,e.nodes.forEach(function(e){e.x0=S+e.column*((E-S-z)/r),e.x1=e.x0+z}),d}function b(e){var t,a,r;for(t=e.nodes,a=[],r=0;t.length;++r,t=a,a=[])t.forEach(function(e){e.depth=r,e.sourceLinks.forEach(function(e){0>a.indexOf(e.target)&&!e.circular&&a.push(e.target)})});for(t=e.nodes,a=[],r=0;t.length;++r,t=a,a=[])t.forEach(function(e){e.height=r,e.targetLinks.forEach(function(e){0>a.indexOf(e.source)&&!e.circular&&a.push(e.source)})});e.nodes.forEach(function(e){e.column=ba(D.call(null,e,r))})}function w(e,r,o){function l(a){if(V){var r=1/0;m.forEach(function(e){var t=I*V/(e.length+1);r=t<r?t:r}),N=r}var o=t.min(m,function(e){return(I-C-(e.length-1)*N)/t.sum(e,p)});o*=Z,e.links.forEach(function(e){e.width=e.value*o});var n=i(e),l=_(e,n);o*=l,e.links.forEach(function(e){e.width=e.value*o}),m.forEach(function(e){var t=e.length;e.forEach(function(e,r){e.depth==m.length-1&&1==t?(e.y0=I/2-e.value*o,e.y1=e.y0+e.value*o):0==e.depth&&1==t?(e.y0=I/2-e.value*o,e.y1=e.y0+e.value*o):e.partOfCycle?0==A(e,a)?(e.y0=I/2+r,e.y1=e.y0+e.value*o):"top"==e.circularLinkType?(e.y0=C+r,e.y1=e.y0+e.value*o):(e.y0=I-e.value*o-r,e.y1=e.y0+e.value*o):0==n.top||0==n.bottom?(e.y0=(I-C)/t*r,e.y1=e.y0+e.value*o):(e.y0=(I-C)/2-t/2+r,e.y1=e.y0+e.value*o)})})}function s(e,a){var r=m.length;m.forEach(function(o){var i=o.length,n=o[0].depth;o.forEach(function(o){var l;if(o.sourceLinks.length||o.targetLinks.length)if(o.partOfCycle&&0<A(o,a));else if(0==n&&1==i)l=o.y1-o.y0,o.y0=I/2-l/2,o.y1=I/2+l/2;else if(n==r-1&&1==i)l=o.y1-o.y0,o.y0=I/2-l/2,o.y1=I/2+l/2;else{var s=0,d=t.mean(o.sourceLinks,h),c=t.mean(o.targetLinks,g);s=d&&c?(d+c)/2:d||c;var p=(s-u(o))*e;o.y0+=p,o.y1+=p}})})}function d(){m.forEach(function(e){var t=C,a=e.length,r,o,n;for(e.sort(c),n=0;n<a;++n)r=e[n],o=t-r.y0,0<o&&(r.y0+=o,r.y1+=o),t=r.y1+N;if(o=t-N-I,0<o)for(t=r.y0-=o,r.y1-=o,n=a-2;0<=n;--n)r=e[n],o=r.y1+N-t,0<o&&(r.y0-=o,r.y1-=o),t=r.y0})}var m=a.nest().key(function(e){return e.column}).sortKeys(t.ascending).entries(e.nodes).map(function(e){return e.values});l(o),d();for(var y=1,f=r;0<f;--f)s(y*=.99,o),d()}function T(e){e.nodes.forEach(function(e){e.sourceLinks.sort(d),e.targetLinks.sort(s)}),e.nodes.forEach(function(e){var t=e.y0,a=t,r=e.y1,o=r;e.sourceLinks.forEach(function(e){e.circular?(e.y0=r-e.width/2,r-=e.width):(e.y0=t+e.width/2,t+=e.width)}),e.targetLinks.forEach(function(e){e.circular?(e.y1=o-e.width/2,o-=e.width):(e.y1=a+e.width/2,a+=e.width)})})}var S=0,C=0,E=1,I=1,z=24,P=m,D=n,O=y,R=f,M=32,j=2,F=null,N,V;return e.nodeId=function(t){return arguments.length?(P="function"==typeof t?t:l(t),e):P},e.nodeAlign=function(t){return arguments.length?(D="function"==typeof t?t:l(t),e):D},e.nodeWidth=function(t){return arguments.length?(z=+t,e):z},e.nodePadding=function(t){return arguments.length?(N=+t,e):N},e.nodes=function(t){return arguments.length?(O="function"==typeof t?t:l(t),e):O},e.links=function(t){return arguments.length?(R="function"==typeof t?t:l(t),e):R},e.size=function(t){return arguments.length?(S=C=0,E=+t[0],I=+t[1],e):[E-S,I-C]},e.extent=function(t){return arguments.length?(S=+t[0][0],E=+t[1][0],C=+t[0][1],I=+t[1][1],e):[[S,C],[E,I]]},e.iterations=function(t){return arguments.length?(M=+t,e):M},e.circularLinkGap=function(t){return arguments.length?(j=+t,e):j},e.nodePaddingRatio=function(t){return arguments.length?(V=+t,e):V},e.sortNodes=function(t){return arguments.length?(F=t,e):F},e.update=function(e){return k(e,P),T(e),e.links.forEach(function(e){e.circular&&(e.circularLinkType=e.y0+e.y1<I?"top":"bottom",e.source.circularLinkType=e.circularLinkType,e.target.circularLinkType=e.circularLinkType)}),U(e,I,P,!1),H(e,I,P),L(e,j,I,P),e},e}function v(e,t,a){var r=0;if(null===a){for(var n=[],l=0;l<e.links.length;l++){var s=e.links[l],d=s.source.index,c=s.target.index;n[d]||(n[d]=[]),n[c]||(n[c]=[]),-1===n[d].indexOf(c)&&n[d].push(c)}var p=o(n);p.sort(function(e,t){return e.length-t.length});var u={};for(l=0;l<p.length;l++){var g=p[l],h=g.slice(-2);u[h[0]]||(u[h[0]]={}),u[h[0]][h[1]]=!0}e.links.forEach(function(e){var t=e.target.index,a=e.source.index;t===a||u[a]&&u[a][t]?(e.circular=!0,e.circularLinkID=r,++r):e.circular=!1})}else e.links.forEach(function(e){e.source[a]<e.target[a]?e.circular=!1:(e.circular=!0,e.circularLinkID=r,++r)})}function k(e,t){var a=0,r=0;e.links.forEach(function(o){o.circular&&(o.circularLinkType=o.source.circularLinkType||o.target.circularLinkType?o.source.circularLinkType?o.source.circularLinkType:o.target.circularLinkType:a<r?"top":"bottom","top"==o.circularLinkType?++a:++r,e.nodes.forEach(function(e){(_(e,t)==_(o.source,t)||_(e,t)==_(o.target,t))&&(e.circularLinkType=o.circularLinkType)}))}),e.links.forEach(function(e){e.circular&&(e.source.circularLinkType==e.target.circularLinkType&&(e.circularLinkType=e.source.circularLinkType),Y(e,t)&&(e.circularLinkType=e.source.circularLinkType))})}function w(e){var t=_a(e.y1-e.y0),a=_a(e.target.x0-e.source.x1);return xa(a/t)}function T(e,t){return!(e.source.column<t.target.column)&&!(e.target.column>t.source.column)}function A(e,t){var a=0;e.sourceLinks.forEach(function(e){a=e.circular&&!Y(e,t)?a+1:a});var r=0;return e.targetLinks.forEach(function(e){r=e.circular&&!Y(e,t)?r+1:r}),a+r}function S(e){var t=e.source.sourceLinks,a=0;t.forEach(function(e){a=e.circular?a+1:a});var r=e.target.targetLinks,o=0;return r.forEach(function(e){o=e.circular?o+1:o}),!(1<a||1<o)}function C(e,t,a){return e.sort(I),e.forEach(function(r,o){var i=0;if(Y(r,a)&&S(r))r.circularPathData.verticalBuffer=i+r.width/2;else{var n=0;for(n;n<o;n++)if(T(e[o],e[n])){var l=e[n].circularPathData.verticalBuffer+e[n].width/2+t;i=l>i?l:i}r.circularPathData.verticalBuffer=i+r.width/2}}),e}function L(e,a,o,i){var n=t.min(e.links,function(e){return e.source.y0});e.links.forEach(function(e){e.circular&&(e.circularPathData={})});var l=e.links.filter(function(e){return"top"==e.circularLinkType});C(l,a,i);var s=e.links.filter(function(e){return"bottom"==e.circularLinkType});C(s,a,i),e.links.forEach(function(t){if(t.circular){if(t.circularPathData.arcRadius=t.width+10,t.circularPathData.leftNodeBuffer=5,t.circularPathData.rightNodeBuffer=5,t.circularPathData.sourceWidth=t.source.x1-t.source.x0,t.circularPathData.sourceX=t.source.x0+t.circularPathData.sourceWidth,t.circularPathData.targetX=t.target.x0,t.circularPathData.sourceY=t.y0,t.circularPathData.targetY=t.y1,Y(t,i)&&S(t))t.circularPathData.leftSmallArcRadius=10+t.width/2,t.circularPathData.leftLargeArcRadius=10+t.width/2,t.circularPathData.rightSmallArcRadius=10+t.width/2,t.circularPathData.rightLargeArcRadius=10+t.width/2,"bottom"==t.circularLinkType?(t.circularPathData.verticalFullExtent=t.source.y1+25+t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius):(t.circularPathData.verticalFullExtent=t.source.y0-25-t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius);else{var s=t.source.column,d=t.circularLinkType,c=e.links.filter(function(e){return e.source.column==s&&e.circularLinkType==d});"bottom"==t.circularLinkType?c.sort(P):c.sort(z);var p=0;c.forEach(function(e,r){e.circularLinkID==t.circularLinkID&&(t.circularPathData.leftSmallArcRadius=10+t.width/2+p,t.circularPathData.leftLargeArcRadius=10+t.width/2+r*a+p),p+=e.width}),s=t.target.column,c=e.links.filter(function(e){return e.target.column==s&&e.circularLinkType==d}),"bottom"==t.circularLinkType?c.sort(O):c.sort(D),p=0,c.forEach(function(e,r){e.circularLinkID==t.circularLinkID&&(t.circularPathData.rightSmallArcRadius=10+t.width/2+p,t.circularPathData.rightLargeArcRadius=10+t.width/2+r*a+p),p+=e.width}),"bottom"==t.circularLinkType?(t.circularPathData.verticalFullExtent=va(o,t.source.y1,t.target.y1)+25+t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent-t.circularPathData.rightLargeArcRadius):(t.circularPathData.verticalFullExtent=n-25-t.circularPathData.verticalBuffer,t.circularPathData.verticalLeftInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.leftLargeArcRadius,t.circularPathData.verticalRightInnerExtent=t.circularPathData.verticalFullExtent+t.circularPathData.rightLargeArcRadius)}t.circularPathData.leftInnerExtent=t.circularPathData.sourceX+t.circularPathData.leftNodeBuffer,t.circularPathData.rightInnerExtent=t.circularPathData.targetX-t.circularPathData.rightNodeBuffer,t.circularPathData.leftFullExtent=t.circularPathData.sourceX+t.circularPathData.leftLargeArcRadius+t.circularPathData.leftNodeBuffer,t.circularPathData.rightFullExtent=t.circularPathData.targetX-t.circularPathData.rightLargeArcRadius-t.circularPathData.rightNodeBuffer}if(t.circular)t.path=E(t);else{var u=r.linkHorizontal().source(function(e){var t=e.source.x0+(e.source.x1-e.source.x0),a=e.y0;return[t,a]}).target(function(e){var t=e.target.x0,a=e.y1;return[t,a]});t.path=u(t)}})}function E(e){var t="";return t="top"==e.circularLinkType?"M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 0 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY-e.circularPathData.leftSmallArcRadius)+" L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 0 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 0 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY-e.circularPathData.rightSmallArcRadius)+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 0 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" L"+e.circularPathData.targetX+" "+e.circularPathData.targetY:"M"+e.circularPathData.sourceX+" "+e.circularPathData.sourceY+" L"+e.circularPathData.leftInnerExtent+" "+e.circularPathData.sourceY+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftSmallArcRadius+" 0 0 1 "+e.circularPathData.leftFullExtent+" "+(e.circularPathData.sourceY+e.circularPathData.leftSmallArcRadius)+" L"+e.circularPathData.leftFullExtent+" "+e.circularPathData.verticalLeftInnerExtent+" A"+e.circularPathData.leftLargeArcRadius+" "+e.circularPathData.leftLargeArcRadius+" 0 0 1 "+e.circularPathData.leftInnerExtent+" "+e.circularPathData.verticalFullExtent+" L"+e.circularPathData.rightInnerExtent+" "+e.circularPathData.verticalFullExtent+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightLargeArcRadius+" 0 0 1 "+e.circularPathData.rightFullExtent+" "+e.circularPathData.verticalRightInnerExtent+" L"+e.circularPathData.rightFullExtent+" "+(e.circularPathData.targetY+e.circularPathData.rightSmallArcRadius)+" A"+e.circularPathData.rightLargeArcRadius+" "+e.circularPathData.rightSmallArcRadius+" 0 0 1 "+e.circularPathData.rightInnerExtent+" "+e.circularPathData.targetY+" L"+e.circularPathData.targetX+" "+e.circularPathData.targetY,t}function I(e,t){return R(e)==R(t)?"bottom"==e.circularLinkType?P(e,t):z(e,t):R(t)-R(e)}function z(e,t){return e.y0-t.y0}function P(e,t){return t.y0-e.y0}function D(e,t){return e.y1-t.y1}function O(e,t){return t.y1-e.y1}function R(e){return e.target.column-e.source.column}function M(e){return e.target.x0-e.source.x1}function j(e,t){var a=w(e),r=M(t)/fa(a),o="up"==q(e)?e.y1+r:e.y1-r;return o}function F(e,t){var a=w(e),r=M(t)/fa(a),o="up"==q(e)?e.y1-r:e.y1+r;return o}function B(e,a,r,t){e.links.forEach(function(o){if(!o.circular&&1<o.target.column-o.source.column){var n=o.source.column+1,l=o.target.column-1,s=1,d=l-n+1;for(s=1;n<=l;n++,s++)e.nodes.forEach(function(i){if(i.column==n){var l=s/(d+1),c=ya(1-l,3),p=3*l*ya(1-l,2),u=3*ya(l,2)*(1-l),g=ya(l,3),h=c*o.y0+p*o.y0+u*o.y1+g*o.y1,m=h-o.width/2,y=h+o.width/2,f;m>i.y0&&m<i.y1?(f=i.y1-m+10,f="bottom"==i.circularLinkType?f:-f,i=V(i,f,a,r),e.nodes.forEach(function(e){_(e,t)==_(i,t)||e.column!=i.column||N(i,e)&&V(e,f,a,r)})):y>i.y0&&y<i.y1?(f=y-i.y0+10,i=V(i,f,a,r),e.nodes.forEach(function(e){_(e,t)==_(i,t)||e.column!=i.column||e.y0<i.y1&&e.y1>i.y1&&V(e,f,a,r)})):m<i.y0&&y>i.y1&&(f=y-i.y0+10,i=V(i,f,a,r),e.nodes.forEach(function(e){_(e,t)==_(i,t)||e.column!=i.column||e.y0<i.y1&&e.y1>i.y1&&V(e,f,a,r)}))}})}})}function N(e,t){return!!(e.y0>t.y0&&e.y0<t.y1)||!!(e.y1>t.y0&&e.y1<t.y1)||!!(e.y0<t.y0&&e.y1>t.y1)}function V(e,t,a,r){return e.y0+t>=a&&e.y1+t<=r&&(e.y0+=t,e.y1+=t,e.targetLinks.forEach(function(e){e.y1+=t}),e.sourceLinks.forEach(function(e){e.y0+=t})),e}function U(e,t,a,r){e.nodes.forEach(function(o){r&&o.y+(o.y1-o.y0)>t&&(o.y-=o.y+(o.y1-o.y0)-t);var i=e.links.filter(function(e){return _(e.source,a)==_(o,a)}),n=i.length;1<n&&i.sort(function(e,t){if(!e.circular&&!t.circular){if(e.target.column==t.target.column)return e.y1-t.y1;if(!G(e,t))return e.y1-t.y1;if(e.target.column>t.target.column){var a=F(t,e);return e.y1-a}if(t.target.column>e.target.column){var r=F(e,t);return r-t.y1}}return e.circular&&!t.circular?"top"==e.circularLinkType?-1:1:t.circular&&!e.circular?"top"==t.circularLinkType?1:-1:e.circular&&t.circular?e.circularLinkType===t.circularLinkType&&"top"==e.circularLinkType?e.target.column===t.target.column?e.target.y1-t.target.y1:t.target.column-e.target.column:e.circularLinkType===t.circularLinkType&&"bottom"==e.circularLinkType?e.target.column===t.target.column?t.target.y1-e.target.y1:e.target.column-t.target.column:"top"==e.circularLinkType?-1:1:void 0});var l=o.y0;i.forEach(function(e){e.y0=l+e.width/2,l+=e.width}),i.forEach(function(e,t){if("bottom"==e.circularLinkType){var a=t+1,r=0;for(a;a<n;a++)r+=i[a].width;e.y0=o.y1-r-e.width/2}})})}function H(e,t,a){e.nodes.forEach(function(t){var r=e.links.filter(function(e){return _(e.target,a)==_(t,a)}),o=r.length;1<o&&r.sort(function(e,t){if(!e.circular&&!t.circular){if(e.source.column==t.source.column)return e.y0-t.y0;if(!G(e,t))return e.y0-t.y0;if(t.source.column<e.source.column){var a=j(t,e);return e.y0-a}if(e.source.column<t.source.column){var r=j(e,t);return r-t.y0}}return e.circular&&!t.circular?"top"==e.circularLinkType?-1:1:t.circular&&!e.circular?"top"==t.circularLinkType?1:-1:e.circular&&t.circular?e.circularLinkType===t.circularLinkType&&"top"==e.circularLinkType?e.source.column===t.source.column?e.source.y1-t.source.y1:e.source.column-t.source.column:e.circularLinkType===t.circularLinkType&&"bottom"==e.circularLinkType?e.source.column===t.source.column?e.source.y1-t.source.y1:t.source.column-e.source.column:"top"==e.circularLinkType?-1:1:void 0});var i=t.y0;r.forEach(function(e){e.y1=i+e.width/2,i+=e.width}),r.forEach(function(e,a){if("bottom"==e.circularLinkType){var i=a+1,n=0;for(i;i<o;i++)n+=r[i].width;e.y1=t.y1-n-e.width/2}})})}function G(e,t){return q(e)==q(t)}function q(e){return 0<e.y0-e.y1?"up":"down"}function Y(e,t){return _(e.source,t)==_(e.target,t)}function W(e,a,r){var o=e.nodes,i=e.links,n=!1,l=!1;if(i.forEach(function(e){"top"==e.circularLinkType?n=!0:"bottom"==e.circularLinkType&&(l=!0)}),!1==n||!1==l){var s=t.min(o,function(e){return e.y0}),d=t.max(o,function(e){return e.y1}),c=(r-a)/(d-s);o.forEach(function(e){var t=(e.y1-e.y0)*c;e.y0=(e.y0-s)*c,e.y1=e.y0+t}),i.forEach(function(e){e.y0=(e.y0-s)*c,e.y1=(e.y1-s)*c,e.width*=c})}}o=o&&o.hasOwnProperty("default")?o["default"]:o;var X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z=.3;e.sankeyCircular=b,e.sankeyCenter=function(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,i)-1:0},e.sankeyLeft=function(e){return e.depth},e.sankeyRight=function(e,t){return t-1-e.height},e.sankeyJustify=n,Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-array":152,"d3-collection":153,"d3-shape":161,"elementary-circuits-directed-graph":172}],54:[function(e,t,a){(function(r,o){"object"==typeof a&&"undefined"!=typeof t?o(a,e("d3-array"),e("d3-collection"),e("d3-shape")):"function"==typeof ka&&ka.amd?ka(["exports","d3-array","d3-collection","d3-shape"],o):o(r.d3=r.d3||{},r.d3,r.d3,r.d3)})(this,function(e,t,a,r){"use strict";function o(e){return e.target.depth}function i(e,t){return e.sourceLinks.length?e.depth:t-1}function n(e){return function(){return e}}function l(e,t){return d(e.source,t.source)||e.index-t.index}function s(e,t){return d(e.target,t.target)||e.index-t.index}function d(e,t){return e.y0-t.y0}function c(e){return e.value}function p(e){return(e.y0+e.y1)/2}function u(e){return p(e.source)*e.value}function g(e){return p(e.target)*e.value}function h(e){return e.index}function m(e){return e.nodes}function y(e){return e.links}function f(e,t){var a=e.get(t);if(!a)throw new Error("missing: "+t);return a}function x(e){return[e.source.x1,e.y0]}function _(e){return[e.target.x0,e.y1]}e.sankey=function(){function e(){var e={nodes:E.apply(null,arguments),links:I.apply(null,arguments)};return r(e),o(e),x(e),_(e,z),b(e),e}function r(e){e.nodes.forEach(function(e,t){e.index=t,e.sourceLinks=[],e.targetLinks=[]});var t=a.map(e.nodes,C);e.links.forEach(function(e,a){e.index=a;var r=e.source,o=e.target;"object"!=typeof r&&(r=e.source=f(t,r)),"object"!=typeof o&&(o=e.target=f(t,o)),r.sourceLinks.push(e),o.targetLinks.push(e)})}function o(e){e.nodes.forEach(function(e){e.value=va(t.sum(e.sourceLinks,c),t.sum(e.targetLinks,c))})}function x(e){var t,a,r;for(t=e.nodes,a=[],r=0;t.length;++r,t=a,a=[])t.forEach(function(e){e.depth=r,e.sourceLinks.forEach(function(e){0>a.indexOf(e.target)&&a.push(e.target)})});for(t=e.nodes,a=[],r=0;t.length;++r,t=a,a=[])t.forEach(function(e){e.height=r,e.targetLinks.forEach(function(e){0>a.indexOf(e.source)&&a.push(e.source)})});var o=(w-v-A)/(r-1);e.nodes.forEach(function(e){e.x1=(e.x0=v+va(0,ea(r-1,ba(L.call(null,e,r))))*o)+A})}function _(e){function r(){var a=t.max(s,function(e){return e.length}),r=P*(T-k)/(a-1);S>r&&(S=r);var o=t.min(s,function(e){return(T-k-(e.length-1)*S)/t.sum(e,c)});s.forEach(function(e){e.forEach(function(e,t){e.y1=(e.y0=t)+e.value*o})}),e.links.forEach(function(e){e.width=e.value*o})}function o(e){s.forEach(function(a){a.forEach(function(a){if(a.targetLinks.length){var r=(t.sum(a.targetLinks,u)/t.sum(a.targetLinks,c)-p(a))*e;a.y0+=r,a.y1+=r}})})}function i(e){s.slice().reverse().forEach(function(a){a.forEach(function(a){if(a.sourceLinks.length){var r=(t.sum(a.sourceLinks,g)/t.sum(a.sourceLinks,c)-p(a))*e;a.y0+=r,a.y1+=r}})})}function l(){s.forEach(function(e){var t=k,a=e.length,r,o,n;for(e.sort(d),n=0;n<a;++n)r=e[n],o=t-r.y0,0<o&&(r.y0+=o,r.y1+=o),t=r.y1+S;if(o=t-S-T,0<o)for(t=r.y0-=o,r.y1-=o,n=a-2;0<=n;--n)r=e[n],o=r.y1+S-t,0<o&&(r.y0-=o,r.y1-=o),t=r.y0})}var s=a.nest().key(function(e){return e.x0}).sortKeys(t.ascending).entries(e.nodes).map(function(e){return e.values});r(),l();for(var h=1,m=z;0<m;--m)i(h*=.99),l(),o(h),l()}function b(e){e.nodes.forEach(function(e){e.sourceLinks.sort(s),e.targetLinks.sort(l)}),e.nodes.forEach(function(e){var t=e.y0,a=t;e.sourceLinks.forEach(function(e){e.y0=t+e.width/2,t+=e.width}),e.targetLinks.forEach(function(e){e.y1=a+e.width/2,a+=e.width})})}var v=0,k=0,w=1,T=1,A=24,S=8,C=h,L=i,E=m,I=y,z=32,P=2/3;return e.update=function(e){return b(e),e},e.nodeId=function(t){return arguments.length?(C="function"==typeof t?t:n(t),e):C},e.nodeAlign=function(t){return arguments.length?(L="function"==typeof t?t:n(t),e):L},e.nodeWidth=function(t){return arguments.length?(A=+t,e):A},e.nodePadding=function(t){return arguments.length?(S=+t,e):S},e.nodes=function(t){return arguments.length?(E="function"==typeof t?t:n(t),e):E},e.links=function(t){return arguments.length?(I="function"==typeof t?t:n(t),e):I},e.size=function(t){return arguments.length?(v=k=0,w=+t[0],T=+t[1],e):[w-v,T-k]},e.extent=function(t){return arguments.length?(v=+t[0][0],w=+t[1][0],k=+t[0][1],T=+t[1][1],e):[[v,k],[w,T]]},e.iterations=function(t){return arguments.length?(z=+t,e):z},e},e.sankeyCenter=function(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?t.min(e.sourceLinks,o)-1:0},e.sankeyLeft=function(e){return e.depth},e.sankeyRight=function(e,t){return t-1-e.height},e.sankeyJustify=i,e.sankeyLinkHorizontal=function(){return r.linkHorizontal().source(x).target(_)},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-array":152,"d3-collection":153,"d3-shape":161}],55:[function(e,t,a){"use strict";function r(e){var t=0,a;switch(e.type){case"Polygon":return o(e.coordinates);case"MultiPolygon":for(a=0;a<e.coordinates.length;a++)t+=o(e.coordinates[a]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;}return 0}function o(e){var t=0;if(e&&0<e.length){t+=_a(n(e[0]));for(var a=1;a<e.length;a++)t-=_a(n(e[a]))}return t}function n(e){var t=0,a=e.length,r,o,n,s,d,c,p;if(2<a){for(p=0;p<a;p++)p===a-2?(s=a-2,d=a-1,c=0):p===a-1?(s=a-1,d=0,c=1):(s=p,d=p+1,c=p+2),r=e[s],o=e[d],n=e[c],t+=(l(n[0])-l(r[0]))*De(l(o[1]));t=t*6378137*6378137/2}return t}function l(e){return e*Pe/180}Object.defineProperty(a,"__esModule",{value:!0});var s=e("@turf/meta");a.default=function(e){return s.geomReduce(e,function(e,t){return e+r(t)},0)}},{"@turf/meta":58}],56:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("@turf/meta"),o=e("@turf/helpers");a.default=function(e,t){void 0===t&&(t={});var a=0,i=0,n=0;return r.coordEach(e,function(e){a+=e[0],i+=e[1],n++}),o.point([a/n,i/n],t.properties)}},{"@turf/helpers":57,"@turf/meta":58}],57:[function(e,t,a){"use strict";function r(e,t,a){void 0===a&&(a={});var r={type:"Feature"};return(0===a.id||a.id)&&(r.id=a.id),a.bbox&&(r.bbox=a.bbox),r.properties=t||{},r.geometry=e,r}function o(e,t,a){void 0===a&&(a={});return r({type:"Point",coordinates:e},t,a)}function i(e,t,a){void 0===a&&(a={});for(var o=0,i=e,n;o<i.length;o++){if(n=i[o],4>n.length)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<n[n.length-1].length;l++)if(n[n.length-1][l]!==n[0][l])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,a)}function n(e,t,a){if(void 0===a&&(a={}),2>e.length)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,a)}function l(e,t){void 0===t&&(t={});var a={type:"FeatureCollection"};return t.id&&(a.id=t.id),t.bbox&&(a.bbox=t.bbox),a.features=e,a}function s(e,t,a){void 0===a&&(a={});return r({type:"MultiLineString",coordinates:e},t,a)}function d(e,t,a){void 0===a&&(a={});return r({type:"MultiPoint",coordinates:e},t,a)}function c(e,t,a){void 0===a&&(a={});return r({type:"MultiPolygon",coordinates:e},t,a)}function p(e,t){void 0===t&&(t="kilometers");var r=a.factors[t];if(!r)throw new Error(t+" units is invalid");return e*r}function u(e,t){void 0===t&&(t="kilometers");var r=a.factors[t];if(!r)throw new Error(t+" units is invalid");return e/r}function g(e){return 180*(e%(2*Pe))/Pe}function h(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(a,"__esModule",{value:!0}),a.earthRadius=6371008.8,a.factors={centimeters:100*a.earthRadius,centimetres:100*a.earthRadius,degrees:a.earthRadius/111325,feet:3.28084*a.earthRadius,inches:39.37*a.earthRadius,kilometers:a.earthRadius/1e3,kilometres:a.earthRadius/1e3,meters:a.earthRadius,metres:a.earthRadius,miles:a.earthRadius/1609.344,millimeters:1e3*a.earthRadius,millimetres:1e3*a.earthRadius,nauticalmiles:a.earthRadius/1852,radians:1,yards:a.earthRadius/1.0936},a.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/a.earthRadius,yards:1/1.0936},a.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},a.feature=r,a.geometry=function(e,t,a){switch(void 0===a&&(a={}),e){case"Point":return o(t).geometry;case"LineString":return n(t).geometry;case"Polygon":return i(t).geometry;case"MultiPoint":return d(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return c(t).geometry;default:throw new Error(e+" is invalid");}},a.point=o,a.points=function(e,t,a){return void 0===a&&(a={}),l(e.map(function(e){return o(e,t)}),a)},a.polygon=i,a.polygons=function(e,t,a){return void 0===a&&(a={}),l(e.map(function(e){return i(e,t)}),a)},a.lineString=n,a.lineStrings=function(e,t,a){return void 0===a&&(a={}),l(e.map(function(e){return n(e,t)}),a)},a.featureCollection=l,a.multiLineString=s,a.multiPoint=d,a.multiPolygon=c,a.geometryCollection=function(e,t,a){void 0===a&&(a={});return r({type:"GeometryCollection",geometries:e},t,a)},a.round=function(e,t){if(void 0===t&&(t=0),t&&!(0<=t))throw new Error("precision must be a positive number");var a=ya(10,t||0);return V(e*a)/a},a.radiansToLength=p,a.lengthToRadians=u,a.lengthToDegrees=function(e,t){return g(u(e,t))},a.bearingToAzimuth=function(e){var t=e%360;return 0>t&&(t+=360),t},a.radiansToDegrees=g,a.degreesToRadians=function(e){return e%360*Pe/180},a.convertLength=function(e,t,a){if(void 0===t&&(t="kilometers"),void 0===a&&(a="kilometers"),!(0<=e))throw new Error("length must be a positive number");return p(u(e,t),a)},a.convertArea=function(e,t,r){if(void 0===t&&(t="meters"),void 0===r&&(r="kilometers"),!(0<=e))throw new Error("area must be a positive number");var o=a.areaFactors[t];if(!o)throw new Error("invalid original units");var i=a.areaFactors[r];if(!i)throw new Error("invalid final units");return e/o*i},a.isNumber=h,a.isObject=function(e){return!!e&&e.constructor===Object},a.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!h(e))throw new Error("bbox must only contain numbers")})},a.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},a.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},a.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},a.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},a.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},a.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},a.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},a.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],58:[function(e,t,a){"use strict";function r(e,t,a){if(null!==e)for(var o=0,i=0,n=e.type,s="FeatureCollection"===n,d=s?e.features.length:1,c=0,p,u,g,h,m,y,f,x;c<d;c++){f=s?e.features[c].geometry:"Feature"===n?e.geometry:e,x=!!f&&"GeometryCollection"===f.type,m=x?f.geometries.length:1;for(var _=0;_<m;_++){var b=0,v=0;if(h=x?f.geometries[_]:f,null!==h){y=h.coordinates;var w=h.type;switch(o=a&&("Polygon"===w||"MultiPolygon"===w)?1:0,w){case null:break;case"Point":if(!1===t(y,i,c,b,v))return!1;i++,b++;break;case"LineString":case"MultiPoint":for(p=0;p<y.length;p++){if(!1===t(y[p],i,c,b,v))return!1;i++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(p=0;p<y.length;p++){for(u=0;u<y[p].length-o;u++){if(!1===t(y[p][u],i,c,b,v))return!1;i++}"MultiLineString"===w&&b++,"Polygon"===w&&v++}"Polygon"===w&&b++;break;case"MultiPolygon":for(p=0;p<y.length;p++){for(v=0,u=0;u<y[p].length;u++){for(g=0;g<y[p][u].length-o;g++){if(!1===t(y[p][u][g],i,c,b,v))return!1;i++}v++}b++}break;case"GeometryCollection":for(p=0;p<h.geometries.length;p++)if(!1===r(h.geometries[p],t,a))return!1;break;default:throw new Error("Unknown Geometry Type");}}}}}function o(e,t){var a;switch(e.type){case"FeatureCollection":for(a=0;a<e.features.length&&!(!1===t(e.features[a].properties,a));a++);break;case"Feature":t(e.properties,0);}}function i(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var a=0;a<e.features.length&&!1!==t(e.features[a],a);a++);}function n(e,t){var a=0,r="FeatureCollection"===e.type,o="Feature"===e.type,n=r?e.features.length:1,l,s,d,c,p,u,h,m,y,f;for(l=0;l<n;l++){for(u=r?e.features[l].geometry:o?e.geometry:e,m=r?e.features[l].properties:o?e.properties:{},y=r?e.features[l].bbox:o?e.bbox:void 0,f=r?e.features[l].id:o?e.id:void 0,h=!!u&&"GeometryCollection"===u.type,p=h?u.geometries.length:1,d=0;d<p;d++){if(c=h?u.geometries[d]:u,null===c){if(!1===t(null,a,m,y,f))return!1;continue}switch(c.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(!1===t(c,a,m,y,f))return!1;break}case"GeometryCollection":{for(s=0;s<c.geometries.length;s++)if(!1===t(c.geometries[s],a,m,y,f))return!1;break}default:throw new Error("Unknown Geometry Type");}}a++}}function l(e,t){n(e,function(e,a,r,o,i){var n=null===e?null:e.type;switch(n){case null:case"Point":case"LineString":case"Polygon":return!1!==t(c.feature(e,r,{bbox:o,id:i}),a,0)&&void 0;}var l;"MultiPoint"===n?l="Point":"MultiLineString"===n?l="LineString":"MultiPolygon"===n?l="Polygon":void 0;for(var s=0;s<e.coordinates.length;s++){var d=e.coordinates[s],p={type:l,coordinates:d};if(!1===t(c.feature(p,r),a,s))return!1}})}function s(e,t){l(e,function(e,a,o){var i=0;if(e.geometry){var n=e.geometry.type;if("Point"!==n&&"MultiPoint"!==n){var l=0,s=0,d=0,p;if(!1===r(e,function(r,n,u,g,h){if(void 0===p||a>l||g>s||h>d)return p=r,l=a,s=g,d=h,void(i=0);var m=c.lineString([p,r],e.properties);return!1!==t(m,a,o,h,i)&&void(i++,p=r)}))return!1}}})}function d(e,t){if(!e)throw new Error("geojson is required");l(e,function(e,a,r){if(null!==e.geometry){var o=e.geometry.type,i=e.geometry.coordinates;switch(o){case"LineString":if(!1===t(e,a,r,0,0))return!1;break;case"Polygon":for(var n=0;n<i.length;n++)if(!1===t(c.lineString(i[n],e.properties),a,r,n))return!1;}}})}Object.defineProperty(a,"__esModule",{value:!0});var c=e("@turf/helpers");a.coordEach=r,a.coordReduce=function(e,t,a,o){var i=a;return r(e,function(e,r,o,n,l){i=0===r&&void 0===a?e:t(i,e,r,o,n,l)},o),i},a.propEach=o,a.propReduce=function(e,t,a){var r=a;return o(e,function(e,o){r=0===o&&void 0===a?e:t(r,e,o)}),r},a.featureEach=i,a.featureReduce=function(e,t,a){var r=a;return i(e,function(e,o){r=0===o&&void 0===a?e:t(r,e,o)}),r},a.coordAll=function(e){var t=[];return r(e,function(e){t.push(e)}),t},a.geomEach=n,a.geomReduce=function(e,t,a){var r=a;return n(e,function(e,o,i,n,l){r=0===o&&void 0===a?e:t(r,e,o,i,n,l)}),r},a.flattenEach=l,a.flattenReduce=function(e,t,a){var r=a;return l(e,function(e,o,i){r=0===o&&0===i&&void 0===a?e:t(r,e,o,i)}),r},a.segmentEach=s,a.segmentReduce=function(e,t,a){var r=a,o=!1;return s(e,function(e,i,n,l,s){r=!1===o&&void 0===a?e:t(r,e,i,n,l,s),o=!0}),r},a.lineEach=d,a.lineReduce=function(e,t,a){var r=a;return d(e,function(e,o,i,n){r=0===o&&void 0===a?e:t(r,e,o,i,n)}),r},a.findSegment=function(e,t){if(t=t||{},!c.isObject(t))throw new Error("options is invalid");var a=t.featureIndex||0,r=t.multiFeatureIndex||0,o=t.geometryIndex||0,i=t.segmentIndex||0,n=t.properties,l;switch(e.type){case"FeatureCollection":0>a&&(a=e.features.length+a),n=n||e.features[a].properties,l=e.features[a].geometry;break;case"Feature":n=n||e.properties,l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid");}if(null===l)return null;var s=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return 0>i&&(i=s.length+i-1),c.lineString([s[i],s[i+1]],n,t);case"Polygon":return 0>o&&(o=s.length+o),0>i&&(i=s[o].length+i-1),c.lineString([s[o][i],s[o][i+1]],n,t);case"MultiLineString":return 0>r&&(r=s.length+r),0>i&&(i=s[r].length+i-1),c.lineString([s[r][i],s[r][i+1]],n,t);case"MultiPolygon":return 0>r&&(r=s.length+r),0>o&&(o=s[r].length+o),0>i&&(i=s[r][o].length-i-1),c.lineString([s[r][o][i],s[r][o][i+1]],n,t);}throw new Error("geojson is invalid")},a.findPoint=function(e,t){if(t=t||{},!c.isObject(t))throw new Error("options is invalid");var a=t.featureIndex||0,r=t.multiFeatureIndex||0,o=t.geometryIndex||0,i=t.coordIndex||0,n=t.properties,l;switch(e.type){case"FeatureCollection":0>a&&(a=e.features.length+a),n=n||e.features[a].properties,l=e.features[a].geometry;break;case"Feature":n=n||e.properties,l=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=e;break;default:throw new Error("geojson is invalid");}if(null===l)return null;var s=l.coordinates;switch(l.type){case"Point":return c.point(s,n,t);case"MultiPoint":return 0>r&&(r=s.length+r),c.point(s[r],n,t);case"LineString":return 0>i&&(i=s.length+i),c.point(s[i],n,t);case"Polygon":return 0>o&&(o=s.length+o),0>i&&(i=s[o].length+i),c.point(s[o][i],n,t);case"MultiLineString":return 0>r&&(r=s.length+r),0>i&&(i=s[r].length+i),c.point(s[r][i],n,t);case"MultiPolygon":return 0>r&&(r=s.length+r),0>o&&(o=s[r].length+o),0>i&&(i=s[r][o].length-i),c.point(s[r][o][i],n,t);}throw new Error("geojson is invalid")}},{"@turf/helpers":57}],59:[function(e,t){"use strict";var a="undefined"==typeof WeakMap?e("weak-map"):WeakMap,r=e("gl-buffer"),o=e("gl-vao"),i=new a;t.exports=function(e){var t=i.get(e),a=t&&(t._triangleBuffer.handle||t._triangleBuffer.buffer);if(!a||!e.isBuffer(a)){var n=r(e,new Float32Array([-1,-1,-1,4,4,-1]));t=o(e,[{buffer:n,type:e.FLOAT,size:2}]),t._triangleBuffer=n,i.set(e,t)}t.bind(),e.drawArrays(e.TRIANGLES,0,3),t.unbind()}},{"gl-buffer":241,"gl-vao":327,"weak-map":552}],60:[function(e,t){t.exports=function(e){var t=0,a=0,r=0,o=0;return e.map(function(e){e=e.slice();var n=e[0],l=n.toUpperCase();if(n!=l)switch(e[0]=l,n){case"a":e[6]+=r,e[7]+=o;break;case"v":e[1]+=o;break;case"h":e[1]+=r;break;default:for(var s=1;s<e.length;)e[s++]+=r,e[s++]+=o;}return"Z"===l?(r=t,o=a):"H"===l?r=e[1]:"V"===l?o=e[1]:"M"===l?(r=t=e[1],o=a=e[2]):(r=e[e.length-2],o=e[e.length-1]),e})}},{}],61:[function(e,t){var a=e("pad-left");t.exports=function(e,t,r){t="number"==typeof t?t:1,r=r||": ";var o=e.split(/\r?\n/),n=(o.length+t-1+"").length;return o.map(function(e,o){var i=o+t,l=(i+"").length,s=a(i,n-l);return s+r+e}).join("\n")}},{"pad-left":457}],62:[function(e,t){"use strict";function a(e,t){for(var a=Array(t+1),n=0;n<e.length;++n)a[n]=e[n];for(var n=0;n<=e.length;++n){for(var l=e.length,s;l<=t;++l){s=Array(t);for(var d=0;d<t;++d)s[d]=ya(l+1-n,d);a[l]=s}var c=r.apply(void 0,a);if(c)return!0}return!1}t.exports=function(e){var t=e.length;if(0===t)return[];if(1===t)return[0];for(var r=e[0].length,o=[e[0]],n=[0],l=1;l<t;++l){if(o.push(e[l]),!a(o,r)){o.pop();continue}if(n.push(l),n.length===r+1)return n}return n};var r=e("robust-orientation")},{"robust-orientation":510}],63:[function(e,t){"use strict";t.exports=function(e,t){return a(t).filter(function(a){for(var o=Array(a.length),n=0;n<a.length;++n)o[n]=t[a[n]];return 1>r(o)*e})};var a=e("delaunay-triangulate"),r=e("circumradius")},{circumradius:114,"delaunay-triangulate":165}],64:[function(e,t){t.exports=function(e,t){return r(a(e,t))};var a=e("alpha-complex"),r=e("simplicial-complex-boundary")},{"alpha-complex":63,"simplicial-complex-boundary":517}],65:[function(e,t){"use strict";t.exports=function(e,t){if(!e||null==e.length)throw Error("Argument should be an array");t=null==t?1:ba(t);for(var a=Array(2*t),r=0;r<t;r++){for(var o=-Infinity,n=1/0,s=r,d=e.length;s<d;s+=t)e[s]>o&&(o=e[s]),e[s]<n&&(n=e[s]);a[r]=n,a[t+r]=o}return a}},{}],66:[function(e,t){"use strict";var a=e("array-bounds");t.exports=function(e,t,r){if(!e||null==e.length)throw Error("Argument should be an array");null==t&&(t=1),null==r&&(r=a(e,t));for(var o=0;o<t;o++){var n=r[t+o],s=r[o],d=o,c=e.length;if(n===1/0&&s===-Infinity)for(d=o;d<c;d+=t)e[d]=e[d]===n?1:e[d]===s?0:.5;else if(n===1/0)for(d=o;d<c;d+=t)e[d]=e[d]===n?1:0;else if(s===-Infinity)for(d=o;d<c;d+=t)e[d]=e[d]===s?0:1;else{var l=n-s;for(d=o;d<c;d+=t)e[d]=0==l?.5:(e[d]-s)/l}}return e}},{"array-bounds":65}],67:[function(e,t){t.exports=function(e,t){var r="number"==typeof e,o="number"==typeof t;r&&!o?(t=e,e=0):!r&&!o&&(e=0,t=0),e|=0,t|=0;var n=t-e;if(0>n)throw new Error("array length must be positive");for(var l=Array(n),a=0,s=e;a<n;a++,s++)l[a]=s;return l}},{}],68:[function(e,t){(function(a){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function r(e,t){if(e===t)return 0;for(var a=e.length,r=t.length,o=0,n=ea(a,r);o<n;++o)if(e[o]!==t[o]){a=e[o],r=t[o];break}return a<r?-1:r<a?1:0}function o(e){return a.Buffer&&"function"==typeof a.Buffer.isBuffer?a.Buffer.isBuffer(e):!!(null!=e&&e._isBuffer)}function i(e){return Object.prototype.toString.call(e)}function n(e){return!o(e)&&!("function"!=typeof a.ArrayBuffer)&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(!!(e instanceof DataView)||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}function l(e){if(k.isFunction(e)){if(A)return e.name;var t=e.toString(),a=t.match(C);return a&&a[1]}}function s(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function d(e){if(A||!k.isFunction(e))return k.inspect(e);var t=l(e),a=t?": "+t:"";return"[Function"+a+"]"}function c(e){return s(d(e.actual),128)+" "+e.operator+" "+s(d(e.expected),128)}function p(e,t,a,r,o){throw new S.AssertionError({message:a,actual:e,expected:t,operator:r,stackStartFunction:o})}function u(e,t){e||p(e,!0,t,"==",S.ok)}function g(e,t,a,l){if(e===t)return!0;if(o(e)&&o(t))return 0===r(e,t);if(k.isDate(e)&&k.isDate(t))return e.getTime()===t.getTime();if(k.isRegExp(e)&&k.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if((null===e||"object"!=typeof e)&&(null===t||"object"!=typeof t))return a?e===t:e==t;if(n(e)&&n(t)&&i(e)===i(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(o(e)!==o(t))return!1;l=l||{actual:[],expected:[]};var s=l.actual.indexOf(e);return-1!==s&&s===l.expected.indexOf(t)||(l.actual.push(e),l.expected.push(t),m(e,t,a,l))}function h(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function m(e,t,r,o){if(null===e||e===void 0||null===t||t===void 0)return!1;if(k.isPrimitive(e)||k.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var n=h(e),l=h(t);if(n&&!l||!n&&l)return!1;if(n)return e=T.call(e),t=T.call(t),g(e,t,r);var s=L(e),d=L(t),c,p;if(s.length!==d.length)return!1;for(s.sort(),d.sort(),p=s.length-1;0<=p;p--)if(s[p]!==d[p])return!1;for(p=s.length-1;0<=p;p--)if(c=s[p],!g(e[c],t[c],r,o))return!1;return!0}function y(e,t,a){g(e,t,!0)&&p(e,t,a,"notDeepStrictEqual",y)}function f(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(t){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function x(e){var t;try{e()}catch(a){t=a}return t}function _(e,t,a,r){var o;if("function"!=typeof t)throw new TypeError("\"block\" argument must be a function");"string"==typeof a&&(r=a,a=null),o=x(t),r=(a&&a.name?" ("+a.name+").":".")+(r?" "+r:"."),e&&!o&&p(o,a,"Missing expected exception"+r);var i="string"==typeof r,n=!e&&k.isError(o),l=!e&&o&&!a;if((n&&i&&f(o,a)||l)&&p(o,a,"Got unwanted exception"+r),e&&o&&a&&!f(o,a)||!e&&o)throw o}function b(e,t){e||p(e,!0,t,"==",b)}var v=e("object-assign"),k=e("util/"),w=Object.prototype.hasOwnProperty,T=Array.prototype.slice,A=function(){return"foo"===function(){}.name}(),S=t.exports=u,C=/\s*function\s+([^\(\s]*)\s*/;S.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=c(this),this.generatedMessage=!0);var t=e.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var a=new Error;if(a.stack){var r=a.stack,o=l(t),i=r.indexOf("\n"+o);if(0<=i){var n=r.indexOf("\n",i+1);r=r.substring(n+1)}this.stack=r}}},k.inherits(S.AssertionError,Error),S.fail=p,S.ok=u,S.equal=function(e,t,a){e!=t&&p(e,t,a,"==",S.equal)},S.notEqual=function(e,t,a){e==t&&p(e,t,a,"!=",S.notEqual)},S.deepEqual=function(e,t,a){g(e,t,!1)||p(e,t,a,"deepEqual",S.deepEqual)},S.deepStrictEqual=function(e,t,a){g(e,t,!0)||p(e,t,a,"deepStrictEqual",S.deepStrictEqual)},S.notDeepEqual=function(e,t,a){g(e,t,!1)&&p(e,t,a,"notDeepEqual",S.notDeepEqual)},S.notDeepStrictEqual=y,S.strictEqual=function(e,t,a){e!==t&&p(e,t,a,"===",S.strictEqual)},S.notStrictEqual=function(e,t,a){e===t&&p(e,t,a,"!==",S.notStrictEqual)},S.throws=function(e,t,a){_(!0,e,t,a)},S.doesNotThrow=function(e,t,a){_(!1,e,t,a)},S.ifError=function(e){if(e)throw e},S.strict=v(b,S,{equal:S.strictEqual,deepEqual:S.deepStrictEqual,notEqual:S.notStrictEqual,notDeepEqual:S.notDeepStrictEqual}),S.strict.strict=S.strict;var L=Object.keys||function(e){var t=[];for(var a in e)w.call(e,a)&&t.push(a);return t}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"object-assign":454,"util/":71}],69:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}},{}],70:[function(e,t){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],71:[function(e,t,a){(function(t,r){function o(e,t){var r={seen:[],stylize:n};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),m(t)?r.showHidden=t:t&&a._extend(r,t),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),s(r,e,r.depth)}function i(e,t){var a=o.styles[t];return a?"\x1B["+o.colors[a][0]+"m"+e+"\x1B["+o.colors[a][1]+"m":e}function n(e){return e}function l(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function s(e,t,r){if(e.customInspect&&t&&A(t.inspect)&&t.inspect!==a.inspect&&!(t.constructor&&t.constructor.prototype===t)){var o=t.inspect(r,e);return _(o)||(o=s(e,o,r)),o}var i=d(e,t);if(i)return i;var m=Object.keys(t),y=l(m);if(e.showHidden&&(m=Object.getOwnPropertyNames(t)),T(t)&&(0<=m.indexOf("message")||0<=m.indexOf("description")))return c(t);if(0===m.length){if(A(t)){var f=t.name?": "+t.name:"";return e.stylize("[Function"+f+"]","special")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(w(t))return e.stylize(Date.prototype.toString.call(t),"date");if(T(t))return c(t)}var x="",b=!1,k=["{","}"];if(h(t)&&(b=!0,k=["[","]"]),A(t)){var S=t.name?": "+t.name:"";x=" [Function"+S+"]"}if(v(t)&&(x=" "+RegExp.prototype.toString.call(t)),w(t)&&(x=" "+Date.prototype.toUTCString.call(t)),T(t)&&(x=" "+c(t)),0===m.length&&(!b||0==t.length))return k[0]+x+k[1];if(0>r)return v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var n;return n=b?p(e,t,r,y,m):m.map(function(a){return u(e,t,r,y,a,b)}),e.seen.pop(),g(n,x,k)}function d(e,t){if(b(t))return e.stylize("undefined","undefined");if(_(t)){var a="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return e.stylize(a,"string")}return f(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,a,r,o){for(var n=[],s=0,d=t.length;s<d;++s)E(t,s+"")?n.push(u(e,t,a,r,s+"",!0)):n.push("");return o.forEach(function(o){o.match(/^\d+$/)||n.push(u(e,t,a,r,o,!0))}),n}function u(e,t,a,r,o,i){var n,l,d;if(d=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},d.get?d.set?l=e.stylize("[Getter/Setter]","special"):l=e.stylize("[Getter]","special"):d.set&&(l=e.stylize("[Setter]","special")),E(r,o)||(n="["+o+"]"),l||(0>e.seen.indexOf(d.value)?(l=y(a)?s(e,d.value,null):s(e,d.value,a-1),-1<l.indexOf("\n")&&(i?l=l.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):l="\n"+l.split("\n").map(function(e){return"   "+e}).join("\n"))):l=e.stylize("[Circular]","special")),b(n)){if(i&&o.match(/^\d+$/))return l;n=JSON.stringify(""+o),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+l}function g(e,t,a){var r=0,o=e.reduce(function(e,t){return r++,0<=t.indexOf("\n")&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return 60<o?a[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+a[1]:a[0]+t+" "+e.join(", ")+" "+a[1]}function h(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function f(e){return"number"==typeof e}function _(e){return"string"==typeof e}function b(e){return void 0===e}function v(e){return k(e)&&"[object RegExp]"===S(e)}function k(e){return"object"==typeof e&&null!==e}function w(e){return k(e)&&"[object Date]"===S(e)}function T(t){return k(t)&&("[object Error]"===S(t)||t instanceof Error)}function A(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function C(e){return 10>e?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),D[e.getMonth()],t].join(" ")}function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var I=/%[sdj%]/g;a.format=function(e){if(!_(e)){for(var t=[],a=0;a<arguments.length;a++)t.push(o(arguments[a]));return t.join(" ")}for(var a=1,r=arguments,n=r.length,l=(e+"").replace(I,function(e){if("%%"===e)return"%";if(a>=n)return e;switch(e){case"%s":return r[a++]+"";case"%d":return+r[a++];case"%j":try{return JSON.stringify(r[a++])}catch(e){return"[Circular]"}default:return e;}}),s=r[a];a<n;s=r[++a])l+=y(s)||!k(s)?" "+s:" "+o(s);return l},a.deprecate=function(e,o){function i(){if(!n){if(t.throwDeprecation)throw new Error(o);else t.traceDeprecation?console.trace(o):console.error(o);n=!0}return e.apply(this,arguments)}if(b(r.process))return function(){return a.deprecate(e,o).apply(this,arguments)};if(!0===t.noDeprecation)return e;var n=!1;return i};var z={},P;a.debuglog=function(e){if(b(P)&&(P=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!z[e])if(new RegExp("\\b"+e+"\\b","i").test(P)){var r=t.pid;z[e]=function(){var t=a.format.apply(a,arguments);console.error("%s %d: %s",e,r,t)}}else z[e]=function(){};return z[e]},a.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=h,a.isBoolean=m,a.isNull=y,a.isNullOrUndefined=function(e){return null==e},a.isNumber=f,a.isString=_,a.isSymbol=function(e){return"symbol"==typeof e},a.isUndefined=b,a.isRegExp=v,a.isObject=k,a.isDate=w,a.isError=T,a.isFunction=A,a.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e},a.isBuffer=e("./support/isBuffer");var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];a.log=function(){console.log("%s - %s",L(),a.format.apply(a,arguments))},a.inherits=e("inherits"),a._extend=function(e,t){if(!t||!k(t))return e;for(var a=Object.keys(t),r=a.length;r--;)e[a[r]]=t[a[r]];return e}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./support/isBuffer":70,_process:482,inherits:69}],72:[function(e,t){t.exports=function(e){return atob(e)}},{}],73:[function(e,t){"use strict";function a(e){for(var t=0,a=0;a<e.length;++a)t+=e[a];return t}t.exports=function(e,t){for(var o=t.length,n=Array(o+1),l=0,s;l<o;++l){s=Array(o+1);for(var d=0;d<=o;++d)s[d]=e[d][l];n[l]=s}n[o]=Array(o+1);for(var l=0;l<=o;++l)n[o][l]=1;for(var c=Array(o+1),l=0;l<o;++l)c[l]=t[l];c[o]=1;var p=r(n,c),u=a(p[o+1]);0===u&&(u=1);for(var g=Array(o+1),l=0;l<=o;++l)g[l]=a(p[l])/u;return g};var r=e("robust-linear-solve")},{"robust-linear-solve":509}],74:[function(e,t,a){"use strict";function r(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.indexOf("=");-1===a&&(a=t);var r=a===t?0:4-a%4;return[a,r]}function o(e,t,a){return 3*(t+a)/4-a}function n(e){for(var t=r(e),a=t[0],n=t[1],l=new u(o(e,a,n)),s=0,d=0<n?a-4:a,c=0,g;c<d;c+=4)g=p[e.charCodeAt(c)]<<18|p[e.charCodeAt(c+1)]<<12|p[e.charCodeAt(c+2)]<<6|p[e.charCodeAt(c+3)],l[s++]=255&g>>16,l[s++]=255&g>>8,l[s++]=255&g;return 2===n&&(g=p[e.charCodeAt(c)]<<2|p[e.charCodeAt(c+1)]>>4,l[s++]=255&g),1===n&&(g=p[e.charCodeAt(c)]<<10|p[e.charCodeAt(c+1)]<<4|p[e.charCodeAt(c+2)]>>2,l[s++]=255&g>>8,l[s++]=255&g),l}function l(e){return c[63&e>>18]+c[63&e>>12]+c[63&e>>6]+c[63&e]}function s(e,t,a){for(var r=[],o=t,n;o<a;o+=3)n=(16711680&e[o]<<16)+(65280&e[o+1]<<8)+(255&e[o+2]),r.push(l(n));return r.join("")}function d(e){for(var t=e.length,a=t%3,r=[],o=16383,n=0,l=t-a,d;n<l;n+=o)r.push(s(e,n,n+o>l?l:n+o));return 1===a?(d=e[t-1],r.push(c[d>>2]+c[63&d<<4]+"==")):2===a&&(d=(e[t-2]<<8)+e[t-1],r.push(c[d>>10]+c[63&d>>4]+c[63&d<<2]+"=")),r.join("")}a.byteLength=function(e){var t=r(e),a=t[0],o=t[1];return 3*(a+o)/4-o},a.toByteArray=n,a.fromByteArray=d;for(var c=[],p=[],u="undefined"==typeof Uint8Array?Array:Uint8Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,m=g.length;h<m;++h)c[h]=g[h],p[g.charCodeAt(h)]=h;p[45]=62,p[95]=63},{}],75:[function(e,t){"use strict";var r=e("./lib/rationalize");t.exports=function(e,t){return r(e[0].mul(t[1]).add(t[0].mul(e[1])),e[1].mul(t[1]))}},{"./lib/rationalize":85}],76:[function(e,t){"use strict";t.exports=function(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],77:[function(e,t){"use strict";var r=e("./lib/rationalize");t.exports=function(e,t){return r(e[0].mul(t[1]),e[1].mul(t[0]))}},{"./lib/rationalize":85}],78:[function(e,t){"use strict";function r(e,t){if(o(e))return t?d(e,r(t)):[e[0].clone(),e[1].clone()];var c=0,p,u;if(i(e))p=e.clone();else if("string"==typeof e)p=l(e);else{if(0===e)return[n(0),n(1)];if(e===ba(e))p=n(e);else{for(;e!==ba(e);)e*=ya(2,256),c-=256;p=n(e)}}if(o(t))p.mul(t[1]),u=t[0].clone();else if(i(t))u=t.clone();else if("string"==typeof t)u=l(t);else if(!t)u=n(1);else if(t===ba(t))u=n(t);else{for(;t!==ba(t);)t*=ya(2,256),c+=256;u=n(t)}return 0<c?p=p.ushln(c):0>c&&(u=u.ushln(-c)),s(p,u)}var o=e("./is-rat"),i=e("./lib/is-bn"),n=e("./lib/num-to-bn"),l=e("./lib/str-to-bn"),s=e("./lib/rationalize"),d=e("./div");t.exports=r},{"./div":77,"./is-rat":79,"./lib/is-bn":83,"./lib/num-to-bn":84,"./lib/rationalize":85,"./lib/str-to-bn":86}],79:[function(e,t){"use strict";var a=e("./lib/is-bn");t.exports=function(e){return Array.isArray(e)&&2===e.length&&a(e[0])&&a(e[1])}},{"./lib/is-bn":83}],80:[function(e,t){"use strict";var a=e("bn.js");t.exports=function(e){return e.cmp(new a(0))}},{"bn.js":94}],81:[function(e,t){"use strict";var a=e("./bn-sign");t.exports=function(e){var t=e.length,r=e.words,o=0;if(1===t)o=r[0];else if(2===t)o=r[0]+67108864*r[1];else for(var n=0,l;n<t;n++)l=r[n],o+=l*ya(67108864,n);return a(e)*o}},{"./bn-sign":80}],82:[function(e,t){"use strict";var a=e("double-bits"),r=e("bit-twiddle").countTrailingZeros;t.exports=function(e){var t=r(a.lo(e));if(32>t)return t;var o=r(a.hi(e));return 20<o?52:o+32}},{"bit-twiddle":92,"double-bits":167}],83:[function(e,t){"use strict";e("bn.js");t.exports=function(e){return e&&"object"==typeof e&&!!e.words}},{"bn.js":94}],84:[function(e,t){"use strict";var a=e("bn.js"),r=e("double-bits");t.exports=function(t){var o=r.exponent(t);return 52>o?new a(t):new a(t*ya(2,52-o)).ushln(o-52)}},{"bn.js":94,"double-bits":167}],85:[function(e,t){"use strict";var a=e("./num-to-bn"),r=e("./bn-sign");t.exports=function(e,t){var o=r(e),i=r(t);if(0===o)return[a(0),a(1)];if(0===i)return[a(0),a(0)];0>i&&(e=e.neg(),t=t.neg());var n=e.gcd(t);return n.cmpn(1)?[e.div(n),t.div(n)]:[e,t]}},{"./bn-sign":80,"./num-to-bn":84}],86:[function(e,t){"use strict";var a=e("bn.js");t.exports=function(e){return new a(e)}},{"bn.js":94}],87:[function(e,t){"use strict";var r=e("./lib/rationalize");t.exports=function(e,t){return r(e[0].mul(t[0]),e[1].mul(t[1]))}},{"./lib/rationalize":85}],88:[function(e,t){"use strict";var a=e("./lib/bn-sign");t.exports=function(e){return a(e[0])*a(e[1])}},{"./lib/bn-sign":80}],89:[function(e,t){"use strict";var r=e("./lib/rationalize");t.exports=function(e,t){return r(e[0].mul(t[1]).sub(e[1].mul(t[0])),e[1].mul(t[1]))}},{"./lib/rationalize":85}],90:[function(e,t){"use strict";var r=e("./lib/bn-to-num"),o=e("./lib/ctz");t.exports=function(e){var t=e[0],a=e[1];if(0===t.cmpn(0))return 0;var i=t.abs().divmod(a.abs()),n=i.div,l=r(n),d=i.mod,c=t.negative===a.negative?1:-1;if(0===d.cmpn(0))return c*l;if(l){var p=o(l)+4,s=r(d.ushln(p).divRound(a));return c*(l+s*ya(2,-p))}var u=a.bitLength()-d.bitLength()+53,s=r(d.ushln(u).divRound(a));return 1023>u?c*s*ya(2,-u):(s*=ya(2,-1023),c*s*ya(2,1023-u))}},{"./lib/bn-to-num":81,"./lib/ctz":82}],91:[function(e,t){"use strict";function a(e,t,a,r,o,i){var n=["function ",e,"(a,l,h,",r.join(","),"){",i?"":"var i=",a?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",o?".get(m)":"[m]"];return i?0>t.indexOf("c")?n.push(";if(x===y){return m}else if(x<=y){"):n.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):n.push(";if(",t,"){i=m;"),a?n.push("l=m+1}else{h=m-1}"):n.push("h=m-1}else{l=m+1}"),n.push("}"),i?n.push("return -1};"):n.push("return i};"),n.join("")}function r(e,t,r,o){var i=new Function([a("A","x"+e+"y",t,["y"],!1,o),a("B","x"+e+"y",t,["y"],!0,o),a("P","c(x,y)"+e+"0",t,["y","c"],!1,o),a("Q","c(x,y)"+e+"0",t,["y","c"],!0,o),"function dispatchBsearch",r,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",r].join(""));return i()}t.exports={ge:r(">=",!1,"GE"),gt:r(">",!1,"GT"),lt:r("<",!0,"LT"),le:r("<=",!0,"LE"),eq:r("-",!0,"EQ",!0)}},{}],92:[function(e,t,a){"use strict";"use restrict";function r(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}a.INT_BITS=32,a.INT_MAX=2147483647,a.INT_MIN=-2147483648,a.sign=function(e){return(0<e)-(0>e)},a.abs=function(e){var t=e>>31;return(e^t)-t},a.min=function(e,t){return t^(e^t)&-(e<t)},a.max=function(e,t){return e^(e^t)&-(e<t)},a.isPow2=function(e){return!(e&e-1)&&!!e},a.log2=function(e){var t,a;return t=(65535<e)<<4,e>>>=t,a=(255<e)<<3,e>>>=a,t|=a,a=(15<e)<<2,e>>>=a,t|=a,a=(3<e)<<1,e>>>=a,t|=a,t|e>>1},a.log10=function(e){return 1e9<=e?9:1e8<=e?8:1e7<=e?7:1e6<=e?6:1e5<=e?5:1e4<=e?4:1e3<=e?3:100<=e?2:10<=e?1:0},a.popCount=function(e){return e-=1431655765&e>>>1,e=(858993459&e)+(858993459&e>>>2),16843009*(252645135&e+(e>>>4))>>>24},a.countTrailingZeros=r,a.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},a.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},a.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,1&27030>>>e};var o=Array(256);(function(e){for(var t=0;256>t;++t){var a=t,o=t,n=7;for(a>>>=1;a;a>>>=1)o<<=1,o|=1&a,--n;e[t]=255&o<<n}})(o),a.reverse=function(e){return o[255&e]<<24|o[255&e>>>8]<<16|o[255&e>>>16]<<8|o[255&e>>>24]},a.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},a.deinterleave2=function(e,t){return e=1431655765&e>>>t,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},a.interleave3=function(e,t,a){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,a&=1023,a=4278190335&(a|a<<16),a=251719695&(a|a<<8),a=3272356035&(a|a<<4),a=1227133513&(a|a<<2),e|a<<2},a.deinterleave3=function(e,t){return e=1227133513&e>>>t,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},a.nextCombination=function(e){var a=e|e-1;return a+1|(~a&-~a)-1>>>r(e)+1}},{}],93:[function(e,t){"use strict";function r(e,t,a,r,i,n,l){for(var s=0;s<t;s++){for(var d=0;d<a;d++)r[d]=e[d*t+s];for(o(r,i,n,l,a),d=0;d<a;d++)e[d*t+s]=i[d]}for(d=0;d<a;d++){for(s=0;s<t;s++)r[s]=e[d*t+s];for(o(r,i,n,l,t),s=0;s<t;s++)e[d*t+s]=N(i[s])}}function o(e,t,a,r,o){a[0]=0,r[0]=-100000000000000000000,r[1]=100000000000000000000;for(var i=1,n=0,l;i<o;i++){for(l=(e[i]+i*i-(e[a[n]]+a[n]*a[n]))/(2*i-2*a[n]);l<=r[n];)n--,l=(e[i]+i*i-(e[a[n]]+a[n]*a[n]))/(2*i-2*a[n]);n++,a[n]=i,r[n]=l,r[n+1]=100000000000000000000}for(i=0,n=0;i<o;i++){for(;r[n+1]<i;)n++;t[i]=(i-a[n])*(i-a[n])+e[a[n]]}}var n=e("clamp");t.exports=function(e,t){t||(t={});var o=null==t.cutoff?.25:t.cutoff,s=null==t.radius?8:t.radius,c=t.channel||0,p,u,g,m,y,x,_,b,k,T,A;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");p=t.width,u=t.height,m=e,x=t.stride?t.stride:ba(e.length/p/u)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(b=e,_=b.getContext("2d"),p=b.width,u=b.height,k=_.getImageData(0,0,p,u),m=k.data,x=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(b=e.canvas,_=e,p=b.width,u=b.height,k=_.getImageData(0,0,p,u),m=k.data,x=4):window.ImageData&&e instanceof window.ImageData&&(k=e,p=e.width,u=e.height,m=k.data,x=4);if(g=va(p,u),window.Uint8ClampedArray&&m instanceof window.Uint8ClampedArray||window.Uint8Array&&m instanceof window.Uint8Array)for(y=m,m=Array(p*u),(T=0,A=y.length);T<A;T++)m[T]=y[T*x+c]/255;else if(1!==x)throw Error("Raw data can have only 1 value per pixel");var S=Array(p*u),C=Array(p*u),L=Array(g),f=Array(g),d=Array(g+1),E=Array(g);for(T=0,A=p*u;T<A;T++){var v=m[T];S[T]=1===v?0:0===v?100000000000000000000:ya(va(0,.5-v),2),C[T]=1===v?100000000000000000000:0===v?0:ya(va(0,v-.5),2)}r(S,p,u,L,f,E,d),r(C,p,u,L,f,E,d);var a=window.Float32Array?new Float32Array(p*u):Array(p*u);for(T=0,A=p*u;T<A;T++)a[T]=n(1-((S[T]-C[T])/s+o),0,1);return a}},{clamp:115}],94:[function(e,t){(function(t,a){"use strict";var v=Math.imul,k=Math.clz32;function o(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}function n(e,t,a){return n.isBN(e)?e:void(this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&(("le"===t||"be"===t)&&(a=t,t=10),this._init(e||0,t||10,a||"be")))}function r(e,t,a){for(var o=0,n=ea(e.length,a),l=t,s;l<n;l++)s=e.charCodeAt(l)-48,o<<=4,o|=49<=s&&54>=s?s-49+10:17<=s&&22>=s?s-17+10:15&s;return o}function l(e,t,a,o){for(var n=0,l=ea(e.length,a),s=t,d;s<l;s++)d=e.charCodeAt(s)-48,n*=o,n+=49<=d?d-49+10:17<=d?d-17+10:d;return n}function s(e){for(var t=Array(e.bitLength()),a=0;a<t.length;a++){var r=0|a/26,o=a%26;t[a]=(e.words[r]&1<<o)>>>o}return t}function d(e,t,o){o.negative=t.negative^e.negative;var n=0|e.length+t.length;o.length=n,n=0|n-1;var l=0|e.words[0],s=0|t.words[0],d=l*s,c=67108863&d,p=0|d/67108864;o.words[0]=c;for(var u=1;u<n;u++){for(var g=p>>>26,h=67108863&p,m=ea(u,t.length-1),y=va(0,u-e.length+1),f;y<=m;y++)f=0|u-y,l=0|e.words[f],s=0|t.words[y],d=l*s+h,g+=0|d/67108864,h=67108863&d;o.words[u]=0|h,p=0|g}return 0===p?o.length--:o.words[u]=0|p,o.strip()}function c(e,t,o){o.negative=t.negative^e.negative,o.length=e.length+t.length;for(var n=0,l=0,s=0,d;s<o.length-1;s++){d=l,l=0;for(var c=67108863&n,p=ea(s,t.length-1),u=va(0,s-e.length+1);u<=p;u++){var g=s-u,i=0|e.words[g],a=0|t.words[u],h=i*a,r=67108863&h;d=0|d+(0|h/67108864),r=0|r+c,c=67108863&r,d=0|d+(r>>>26),l+=d>>>26,d&=67108863}o.words[s]=c,n=d,d=l}return 0===n?o.length--:o.words[s]=n,o.strip()}function p(e,t,a){var r=new u;return r.mulp(e,t,a)}function u(e,t){this.x=e,this.y=t}function g(e,t){this.name=e,this.p=new n(t,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function h(){g.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function m(){g.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){g.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function f(){g.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function x(e){if("string"==typeof e){var t=n._prime(e);this.m=t.p,this.prime=t}else o(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function _(e){x.call(this,e),this.shift=this.m.bitLength(),0!=this.shift%26&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=n:a.BN=n,n.BN=n,n.wordSize=26;var w;try{w=e("buffer").Buffer}catch(t){}n.isBN=function(e){return!!(e instanceof n)||null!==e&&"object"==typeof e&&e.constructor.wordSize===n.wordSize&&Array.isArray(e.words)},n.max=function(e,t){return 0<e.cmp(t)?e:t},n.min=function(e,t){return 0>e.cmp(t)?e:t},n.prototype._init=function(e,t,a){if("number"==typeof e)return this._initNumber(e,t,a);if("object"==typeof e)return this._initArray(e,t,a);"hex"===t&&(t=16),o(t===(0|t)&&2<=t&&36>=t),e=e.toString().replace(/\s+/g,"");var r=0;"-"===e[0]&&r++,16===t?this._parseHex(e,r):this._parseBase(e,t,r),"-"===e[0]&&(this.negative=1),this.strip();"le"!==a||this._initArray(this.toArray(),t,a)},n.prototype._initNumber=function(e,t,a){0>e&&(this.negative=1,e=-e),67108864>e?(this.words=[67108863&e],this.length=1):4503599627370496>e?(this.words=[67108863&e,67108863&e/67108864],this.length=2):(o(9007199254740992>e),this.words=[67108863&e,67108863&e/67108864,1],this.length=3);"le"!==a||this._initArray(this.toArray(),t,a)},n.prototype._initArray=function(e,t,a){if(o("number"==typeof e.length),0>=e.length)return this.words=[0],this.length=1,this;this.length=M(e.length/3),this.words=Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var n=0,l,s;if("be"===a)for(r=e.length-1,l=0;0<=r;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[l]|=67108863&s<<n,this.words[l+1]=67108863&s>>>26-n,n+=24,26<=n&&(n-=26,l++);else if("le"===a)for(r=0,l=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[l]|=67108863&s<<n,this.words[l+1]=67108863&s>>>26-n,n+=24,26<=n&&(n-=26,l++);return this.strip()},n.prototype._parseHex=function(e,t){this.length=M((e.length-t)/6),this.words=Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var o=0,n,l;for(a=e.length-6,n=0;a>=t;a-=6)l=r(e,a,a+6),this.words[n]|=67108863&l<<o,this.words[n+1]|=4194303&l>>>26-o,o+=24,26<=o&&(o-=26,n++);a+6!==t&&(l=r(e,t,a+6),this.words[n]|=67108863&l<<o,this.words[n+1]|=4194303&l>>>26-o),this.strip()},n.prototype._parseBase=function(e,t,a){this.words=[0],this.length=1;for(var r=0,o=1;67108863>=o;o*=t)r++;r--,o=0|o/t;for(var n=e.length-a,s=n%r,d=ea(n,n-s)+a,c=0,p=a;p<d;p+=r)c=l(e,p,p+r,t),this.imuln(o),67108864>this.words[0]+c?this.words[0]+=c:this._iaddn(c);if(0!==s){var u=1;for(c=l(e,p,e.length,t),p=0;p<s;p++)u*=t;this.imuln(u),67108864>this.words[0]+c?this.words[0]+=c:this._iaddn(c)}},n.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},n.prototype.clone=function(){var e=new n(null);return this.copy(e),e},n.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;1<this.length&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var T=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],A=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],S=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(e,t){e=e||10,t=0|t||1;var a;if(16===e||"hex"===e){a="";for(var n=0,l=0,s=0;s<this.length;s++){var d=this.words[s],p=(16777215&(d<<n|l)).toString(16);l=16777215&d>>>24-n,a=0!==l||s!=this.length-1?T[6-p.length]+p+a:p+a,n+=2,26<=n&&(n-=26,s--)}for(0!==l&&(a=l.toString(16)+a);0!=a.length%t;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}if(e===(0|e)&&2<=e&&36>=e){var u=A[e],g=S[e];a="";var h=this.clone();for(h.negative=0;!h.isZero();){var m=h.modn(g).toString(e);h=h.idivn(g),a=h.isZero()?m+a:T[u-m.length]+m+a}for(this.isZero()&&(a="0"+a);0!=a.length%t;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}o(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:2<this.length&&o(!1,"Number can only safely store up to 53 bits"),0===this.negative?e:-e},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(e,t){return o("undefined"!=typeof w),this.toArrayLike(w,e,t)},n.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},n.prototype.toArrayLike=function(e,t,a){var r=this.byteLength(),n=a||va(1,r);o(r<=n,"byte array longer than desired length"),o(0<n,"Requested array length <= 0"),this.strip();var l=new e(n),s=this.clone(),d,c;if(!("le"===t)){for(c=0;c<n-r;c++)l[c]=0;for(c=0;!s.isZero();c++)d=s.andln(255),s.iushrn(8),l[n-c-1]=d}else{for(c=0;!s.isZero();c++)d=s.andln(255),s.iushrn(8),l[c]=d;for(;c<n;c++)l[c]=0}return l},n.prototype._countBits=k?function(e){return 32-k(e)}:function(e){var a=e,o=0;return 4096<=a&&(o+=13,a>>>=13),64<=a&&(o+=7,a>>>=7),8<=a&&(o+=4,a>>>=4),2<=a&&(o+=2,a>>>=2),o+a},n.prototype._zeroBits=function(e){if(0===e)return 26;var a=e,o=0;return 0==(8191&a)&&(o+=13,a>>>=13),0==(127&a)&&(o+=7,a>>>=7),0==(15&a)&&(o+=4,a>>>=4),0==(3&a)&&(o+=2,a>>>=2),0==(1&a)&&o++,o},n.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0,a;t<this.length&&(a=this._zeroBits(this.words[t]),e+=a,26===a);t++);return e},n.prototype.byteLength=function(){return M(this.bitLength()/8)},n.prototype.toTwos=function(e){return 0===this.negative?this.clone():this.abs().inotn(e).iaddn(1)},n.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]|=e.words[t];return this.strip()},n.prototype.ior=function(e){return o(0==(this.negative|e.negative)),this.iuor(e)},n.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},n.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},n.prototype.iuand=function(e){var t=this.length>e.length?e:this;for(var a=0;a<t.length;a++)this.words[a]&=e.words[a];return this.length=t.length,this.strip()},n.prototype.iand=function(e){return o(0==(this.negative|e.negative)),this.iuand(e)},n.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},n.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},n.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var o=0;o<r.length;o++)this.words[o]=t.words[o]^r.words[o];if(this!==t)for(;o<t.length;o++)this.words[o]=t.words[o];return this.length=t.length,this.strip()},n.prototype.ixor=function(e){return o(0==(this.negative|e.negative)),this.iuxor(e)},n.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},n.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},n.prototype.inotn=function(e){o("number"==typeof e&&0<=e);var t=0|M(e/26),a=e%26;this._expand(t),0<a&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return 0<a&&(this.words[r]=~this.words[r]&67108863>>26-a),this.strip()},n.prototype.notn=function(e){return this.clone().inotn(e)},n.prototype.setn=function(e,t){o("number"==typeof e&&0<=e);var a=0|e/26,r=e%26;return this._expand(a+1),t?this.words[a]|=1<<r:this.words[a]&=~(1<<r),this.strip()},n.prototype.iadd=function(e){var t;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();var o,n;this.length>e.length?(o=this,n=e):(o=e,n=this);for(var l=0,s=0;s<n.length;s++)t=(0|o.words[s])+(0|n.words[s])+l,this.words[s]=67108863&t,l=t>>>26;for(;0!==l&&s<o.length;s++)t=(0|o.words[s])+l,this.words[s]=67108863&t,l=t>>>26;if(this.length=o.length,0!==l)this.words[this.length]=l,this.length++;else if(o!==this)for(;s<o.length;s++)this.words[s]=o.words[s];return this},n.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},n.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var o=this.cmp(e);if(0===o)return this.negative=0,this.length=1,this.words[0]=0,this;var n,l;0<o?(n=this,l=e):(n=e,l=this);for(var s=0,d=0;d<l.length;d++)t=(0|n.words[d])-(0|l.words[d])+s,s=t>>26,this.words[d]=67108863&t;for(;0!==s&&d<n.length;d++)t=(0|n.words[d])+s,s=t>>26,this.words[d]=67108863&t;if(0===s&&d<n.length&&n!==this)for(;d<n.length;d++)this.words[d]=n.words[d];return this.length=va(this.length,d),n!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(e){return this.clone().isub(e)};var C=function(e,t,r){var i=e.words,a=t.words,n=r.words,o=0,l=0|i[0],s=8191&l,d=l>>>13,p=0|i[1],u=8191&p,g=p>>>13,h=0|i[2],m=8191&h,y=h>>>13,f=0|i[3],x=8191&f,_=f>>>13,b=0|i[4],k=8191&b,w=b>>>13,T=0|i[5],A=8191&T,S=T>>>13,C=0|i[6],L=8191&C,E=C>>>13,I=0|i[7],z=8191&I,P=I>>>13,D=0|i[8],O=8191&D,R=D>>>13,M=0|i[9],j=8191&M,F=M>>>13,B=0|a[0],N=8191&B,V=B>>>13,U=0|a[1],H=8191&U,G=U>>>13,q=0|a[2],Y=8191&q,W=q>>>13,X=0|a[3],Z=8191&X,K=X>>>13,J=0|a[4],Q=8191&J,$=J>>>13,ee=0|a[5],te=8191&ee,ae=ee>>>13,re=0|a[6],oe=8191&re,ie=re>>>13,ne=0|a[7],le=8191&ne,se=ne>>>13,de=0|a[8],ce=8191&de,pe=de>>>13,ue=0|a[9],ge=8191&ue,he=ue>>>13,me,ye,fe;r.negative=e.negative^t.negative,r.length=19,me=v(s,N),ye=v(s,V),ye=0|ye+v(d,N),fe=v(d,V);var xe=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(xe>>>26),xe&=67108863,me=v(u,N),ye=v(u,V),ye=0|ye+v(g,N),fe=v(g,V),me=0|me+v(s,H),ye=0|ye+v(s,G),ye=0|ye+v(d,H),fe=0|fe+v(d,G);var _e=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(_e>>>26),_e&=67108863,me=v(m,N),ye=v(m,V),ye=0|ye+v(y,N),fe=v(y,V),me=0|me+v(u,H),ye=0|ye+v(u,G),ye=0|ye+v(g,H),fe=0|fe+v(g,G),me=0|me+v(s,Y),ye=0|ye+v(s,W),ye=0|ye+v(d,Y),fe=0|fe+v(d,W);var be=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(be>>>26),be&=67108863,me=v(x,N),ye=v(x,V),ye=0|ye+v(_,N),fe=v(_,V),me=0|me+v(m,H),ye=0|ye+v(m,G),ye=0|ye+v(y,H),fe=0|fe+v(y,G),me=0|me+v(u,Y),ye=0|ye+v(u,W),ye=0|ye+v(g,Y),fe=0|fe+v(g,W),me=0|me+v(s,Z),ye=0|ye+v(s,K),ye=0|ye+v(d,Z),fe=0|fe+v(d,K);var ve=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ve>>>26),ve&=67108863,me=v(k,N),ye=v(k,V),ye=0|ye+v(w,N),fe=v(w,V),me=0|me+v(x,H),ye=0|ye+v(x,G),ye=0|ye+v(_,H),fe=0|fe+v(_,G),me=0|me+v(m,Y),ye=0|ye+v(m,W),ye=0|ye+v(y,Y),fe=0|fe+v(y,W),me=0|me+v(u,Z),ye=0|ye+v(u,K),ye=0|ye+v(g,Z),fe=0|fe+v(g,K),me=0|me+v(s,Q),ye=0|ye+v(s,$),ye=0|ye+v(d,Q),fe=0|fe+v(d,$);var ke=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ke>>>26),ke&=67108863,me=v(A,N),ye=v(A,V),ye=0|ye+v(S,N),fe=v(S,V),me=0|me+v(k,H),ye=0|ye+v(k,G),ye=0|ye+v(w,H),fe=0|fe+v(w,G),me=0|me+v(x,Y),ye=0|ye+v(x,W),ye=0|ye+v(_,Y),fe=0|fe+v(_,W),me=0|me+v(m,Z),ye=0|ye+v(m,K),ye=0|ye+v(y,Z),fe=0|fe+v(y,K),me=0|me+v(u,Q),ye=0|ye+v(u,$),ye=0|ye+v(g,Q),fe=0|fe+v(g,$),me=0|me+v(s,te),ye=0|ye+v(s,ae),ye=0|ye+v(d,te),fe=0|fe+v(d,ae);var we=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(we>>>26),we&=67108863,me=v(L,N),ye=v(L,V),ye=0|ye+v(E,N),fe=v(E,V),me=0|me+v(A,H),ye=0|ye+v(A,G),ye=0|ye+v(S,H),fe=0|fe+v(S,G),me=0|me+v(k,Y),ye=0|ye+v(k,W),ye=0|ye+v(w,Y),fe=0|fe+v(w,W),me=0|me+v(x,Z),ye=0|ye+v(x,K),ye=0|ye+v(_,Z),fe=0|fe+v(_,K),me=0|me+v(m,Q),ye=0|ye+v(m,$),ye=0|ye+v(y,Q),fe=0|fe+v(y,$),me=0|me+v(u,te),ye=0|ye+v(u,ae),ye=0|ye+v(g,te),fe=0|fe+v(g,ae),me=0|me+v(s,oe),ye=0|ye+v(s,ie),ye=0|ye+v(d,oe),fe=0|fe+v(d,ie);var Te=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Te>>>26),Te&=67108863,me=v(z,N),ye=v(z,V),ye=0|ye+v(P,N),fe=v(P,V),me=0|me+v(L,H),ye=0|ye+v(L,G),ye=0|ye+v(E,H),fe=0|fe+v(E,G),me=0|me+v(A,Y),ye=0|ye+v(A,W),ye=0|ye+v(S,Y),fe=0|fe+v(S,W),me=0|me+v(k,Z),ye=0|ye+v(k,K),ye=0|ye+v(w,Z),fe=0|fe+v(w,K),me=0|me+v(x,Q),ye=0|ye+v(x,$),ye=0|ye+v(_,Q),fe=0|fe+v(_,$),me=0|me+v(m,te),ye=0|ye+v(m,ae),ye=0|ye+v(y,te),fe=0|fe+v(y,ae),me=0|me+v(u,oe),ye=0|ye+v(u,ie),ye=0|ye+v(g,oe),fe=0|fe+v(g,ie),me=0|me+v(s,le),ye=0|ye+v(s,se),ye=0|ye+v(d,le),fe=0|fe+v(d,se);var Ae=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ae>>>26),Ae&=67108863,me=v(O,N),ye=v(O,V),ye=0|ye+v(R,N),fe=v(R,V),me=0|me+v(z,H),ye=0|ye+v(z,G),ye=0|ye+v(P,H),fe=0|fe+v(P,G),me=0|me+v(L,Y),ye=0|ye+v(L,W),ye=0|ye+v(E,Y),fe=0|fe+v(E,W),me=0|me+v(A,Z),ye=0|ye+v(A,K),ye=0|ye+v(S,Z),fe=0|fe+v(S,K),me=0|me+v(k,Q),ye=0|ye+v(k,$),ye=0|ye+v(w,Q),fe=0|fe+v(w,$),me=0|me+v(x,te),ye=0|ye+v(x,ae),ye=0|ye+v(_,te),fe=0|fe+v(_,ae),me=0|me+v(m,oe),ye=0|ye+v(m,ie),ye=0|ye+v(y,oe),fe=0|fe+v(y,ie),me=0|me+v(u,le),ye=0|ye+v(u,se),ye=0|ye+v(g,le),fe=0|fe+v(g,se),me=0|me+v(s,ce),ye=0|ye+v(s,pe),ye=0|ye+v(d,ce),fe=0|fe+v(d,pe);var Se=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Se>>>26),Se&=67108863,me=v(j,N),ye=v(j,V),ye=0|ye+v(F,N),fe=v(F,V),me=0|me+v(O,H),ye=0|ye+v(O,G),ye=0|ye+v(R,H),fe=0|fe+v(R,G),me=0|me+v(z,Y),ye=0|ye+v(z,W),ye=0|ye+v(P,Y),fe=0|fe+v(P,W),me=0|me+v(L,Z),ye=0|ye+v(L,K),ye=0|ye+v(E,Z),fe=0|fe+v(E,K),me=0|me+v(A,Q),ye=0|ye+v(A,$),ye=0|ye+v(S,Q),fe=0|fe+v(S,$),me=0|me+v(k,te),ye=0|ye+v(k,ae),ye=0|ye+v(w,te),fe=0|fe+v(w,ae),me=0|me+v(x,oe),ye=0|ye+v(x,ie),ye=0|ye+v(_,oe),fe=0|fe+v(_,ie),me=0|me+v(m,le),ye=0|ye+v(m,se),ye=0|ye+v(y,le),fe=0|fe+v(y,se),me=0|me+v(u,ce),ye=0|ye+v(u,pe),ye=0|ye+v(g,ce),fe=0|fe+v(g,pe),me=0|me+v(s,ge),ye=0|ye+v(s,he),ye=0|ye+v(d,ge),fe=0|fe+v(d,he);var Ce=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ce>>>26),Ce&=67108863,me=v(j,H),ye=v(j,G),ye=0|ye+v(F,H),fe=v(F,G),me=0|me+v(O,Y),ye=0|ye+v(O,W),ye=0|ye+v(R,Y),fe=0|fe+v(R,W),me=0|me+v(z,Z),ye=0|ye+v(z,K),ye=0|ye+v(P,Z),fe=0|fe+v(P,K),me=0|me+v(L,Q),ye=0|ye+v(L,$),ye=0|ye+v(E,Q),fe=0|fe+v(E,$),me=0|me+v(A,te),ye=0|ye+v(A,ae),ye=0|ye+v(S,te),fe=0|fe+v(S,ae),me=0|me+v(k,oe),ye=0|ye+v(k,ie),ye=0|ye+v(w,oe),fe=0|fe+v(w,ie),me=0|me+v(x,le),ye=0|ye+v(x,se),ye=0|ye+v(_,le),fe=0|fe+v(_,se),me=0|me+v(m,ce),ye=0|ye+v(m,pe),ye=0|ye+v(y,ce),fe=0|fe+v(y,pe),me=0|me+v(u,ge),ye=0|ye+v(u,he),ye=0|ye+v(g,ge),fe=0|fe+v(g,he);var Le=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Le>>>26),Le&=67108863,me=v(j,Y),ye=v(j,W),ye=0|ye+v(F,Y),fe=v(F,W),me=0|me+v(O,Z),ye=0|ye+v(O,K),ye=0|ye+v(R,Z),fe=0|fe+v(R,K),me=0|me+v(z,Q),ye=0|ye+v(z,$),ye=0|ye+v(P,Q),fe=0|fe+v(P,$),me=0|me+v(L,te),ye=0|ye+v(L,ae),ye=0|ye+v(E,te),fe=0|fe+v(E,ae),me=0|me+v(A,oe),ye=0|ye+v(A,ie),ye=0|ye+v(S,oe),fe=0|fe+v(S,ie),me=0|me+v(k,le),ye=0|ye+v(k,se),ye=0|ye+v(w,le),fe=0|fe+v(w,se),me=0|me+v(x,ce),ye=0|ye+v(x,pe),ye=0|ye+v(_,ce),fe=0|fe+v(_,pe),me=0|me+v(m,ge),ye=0|ye+v(m,he),ye=0|ye+v(y,ge),fe=0|fe+v(y,he);var Ee=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ee>>>26),Ee&=67108863,me=v(j,Z),ye=v(j,K),ye=0|ye+v(F,Z),fe=v(F,K),me=0|me+v(O,Q),ye=0|ye+v(O,$),ye=0|ye+v(R,Q),fe=0|fe+v(R,$),me=0|me+v(z,te),ye=0|ye+v(z,ae),ye=0|ye+v(P,te),fe=0|fe+v(P,ae),me=0|me+v(L,oe),ye=0|ye+v(L,ie),ye=0|ye+v(E,oe),fe=0|fe+v(E,ie),me=0|me+v(A,le),ye=0|ye+v(A,se),ye=0|ye+v(S,le),fe=0|fe+v(S,se),me=0|me+v(k,ce),ye=0|ye+v(k,pe),ye=0|ye+v(w,ce),fe=0|fe+v(w,pe),me=0|me+v(x,ge),ye=0|ye+v(x,he),ye=0|ye+v(_,ge),fe=0|fe+v(_,he);var Ie=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ie>>>26),Ie&=67108863,me=v(j,Q),ye=v(j,$),ye=0|ye+v(F,Q),fe=v(F,$),me=0|me+v(O,te),ye=0|ye+v(O,ae),ye=0|ye+v(R,te),fe=0|fe+v(R,ae),me=0|me+v(z,oe),ye=0|ye+v(z,ie),ye=0|ye+v(P,oe),fe=0|fe+v(P,ie),me=0|me+v(L,le),ye=0|ye+v(L,se),ye=0|ye+v(E,le),fe=0|fe+v(E,se),me=0|me+v(A,ce),ye=0|ye+v(A,pe),ye=0|ye+v(S,ce),fe=0|fe+v(S,pe),me=0|me+v(k,ge),ye=0|ye+v(k,he),ye=0|ye+v(w,ge),fe=0|fe+v(w,he);var ze=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ze>>>26),ze&=67108863,me=v(j,te),ye=v(j,ae),ye=0|ye+v(F,te),fe=v(F,ae),me=0|me+v(O,oe),ye=0|ye+v(O,ie),ye=0|ye+v(R,oe),fe=0|fe+v(R,ie),me=0|me+v(z,le),ye=0|ye+v(z,se),ye=0|ye+v(P,le),fe=0|fe+v(P,se),me=0|me+v(L,ce),ye=0|ye+v(L,pe),ye=0|ye+v(E,ce),fe=0|fe+v(E,pe),me=0|me+v(A,ge),ye=0|ye+v(A,he),ye=0|ye+v(S,ge),fe=0|fe+v(S,he);var Pe=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Pe>>>26),Pe&=67108863,me=v(j,oe),ye=v(j,ie),ye=0|ye+v(F,oe),fe=v(F,ie),me=0|me+v(O,le),ye=0|ye+v(O,se),ye=0|ye+v(R,le),fe=0|fe+v(R,se),me=0|me+v(z,ce),ye=0|ye+v(z,pe),ye=0|ye+v(P,ce),fe=0|fe+v(P,pe),me=0|me+v(L,ge),ye=0|ye+v(L,he),ye=0|ye+v(E,ge),fe=0|fe+v(E,he);var De=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(De>>>26),De&=67108863,me=v(j,le),ye=v(j,se),ye=0|ye+v(F,le),fe=v(F,se),me=0|me+v(O,ce),ye=0|ye+v(O,pe),ye=0|ye+v(R,ce),fe=0|fe+v(R,pe),me=0|me+v(z,ge),ye=0|ye+v(z,he),ye=0|ye+v(P,ge),fe=0|fe+v(P,he);var Oe=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Oe>>>26),Oe&=67108863,me=v(j,ce),ye=v(j,pe),ye=0|ye+v(F,ce),fe=v(F,pe),me=0|me+v(O,ge),ye=0|ye+v(O,he),ye=0|ye+v(R,ge),fe=0|fe+v(R,he);var Re=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Re>>>26),Re&=67108863,me=v(j,ge),ye=v(j,he),ye=0|ye+v(F,ge),fe=v(F,he);var Me=0|(0|o+me)+((8191&ye)<<13);return o=0|(0|fe+(ye>>>13))+(Me>>>26),Me&=67108863,n[0]=xe,n[1]=_e,n[2]=be,n[3]=ve,n[4]=ke,n[5]=we,n[6]=Te,n[7]=Ae,n[8]=Se,n[9]=Ce,n[10]=Le,n[11]=Ee,n[12]=Ie,n[13]=ze,n[14]=Pe,n[15]=De,n[16]=Oe,n[17]=Re,n[18]=Me,0!==o&&(n[19]=o,r.length++),r};v||(C=d),n.prototype.mulTo=function(e,t){var a=this.length+e.length,r;return r=10===this.length&&10===e.length?C(this,e,t):63>a?d(this,e,t):1024>a?c(this,e,t):p(this,e,t),r},u.prototype.makeRBT=function(e){for(var a=Array(e),t=n.prototype._countBits(e)-1,r=0;r<e;r++)a[r]=this.revBin(r,t,e);return a},u.prototype.revBin=function(e,t,a){if(0===e||e===a-1)return e;for(var r=0,o=0;o<t;o++)r|=(1&e)<<t-o-1,e>>=1;return r},u.prototype.permute=function(e,t,a,r,o,n){for(var l=0;l<n;l++)r[l]=t[e[l]],o[l]=a[e[l]]},u.prototype.transform=function(e,t,a,r,o,i){this.permute(i,e,t,a,r,o);for(var n=1;n<o;n<<=1)for(var d=n<<1,l=R(2*Pe/d),c=De(2*Pe/d),u=0;u<o;u+=d)for(var g=l,h=c,m=0;m<n;m++){var y=a[u+m],f=r[u+m],x=a[u+m+n],_=r[u+m+n],b=g*x-h*_;_=g*_+h*x,x=b,a[u+m]=y+x,r[u+m]=f+_,a[u+m+n]=y-x,r[u+m+n]=f-_,m!==d&&(b=l*g-c*h,h=l*h+c*g,g=b)}},u.prototype.guessLen13b=function(e,t){var a=1|va(t,e),r=1&a,o=0;for(a=0|a/2;a;a>>>=1)o++;return 1<<o+1+r},u.prototype.conjugate=function(e,a,r){if(!(1>=r))for(var o=0,n;o<r/2;o++)n=e[o],e[o]=e[r-o-1],e[r-o-1]=n,n=a[o],a[o]=-a[r-o-1],a[r-o-1]=-n},u.prototype.normalize13b=function(e,t){for(var a=0,r=0,o;r<t/2;r++)o=8192*V(e[2*r+1]/t)+V(e[2*r]/t)+a,e[r]=67108863&o,a=67108864>o?0:0|o/67108864;return e},u.prototype.convert13b=function(e,t,a,r){for(var n=0,l=0;l<t;l++)n+=0|e[l],a[2*l]=8191&n,n>>>=13,a[2*l+1]=8191&n,n>>>=13;for(l=2*t;l<r;++l)a[l]=0;o(0===n),o(0==(-8192&n))},u.prototype.stub=function(e){for(var t=Array(e),a=0;a<e;a++)t[a]=0;return t},u.prototype.mulp=function(e,t,a){var r=2*this.guessLen13b(e.length,t.length),o=this.makeRBT(r),n=this.stub(r),l=Array(r),s=Array(r),d=Array(r),c=Array(r),p=Array(r),u=Array(r),g=a.words;g.length=r,this.convert13b(e.words,e.length,l,r),this.convert13b(t.words,t.length,c,r),this.transform(l,n,s,d,r,o),this.transform(c,n,p,u,r,o);for(var h=0,m;h<r;h++)m=s[h]*p[h]-d[h]*u[h],d[h]=s[h]*u[h]+d[h]*p[h],s[h]=m;return this.conjugate(s,d,r),this.transform(s,d,g,n,r,o),this.conjugate(g,n,r),this.normalize13b(g,r),a.negative=e.negative^t.negative,a.length=e.length+t.length,a.strip()},n.prototype.mul=function(e){var t=new n(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},n.prototype.mulf=function(e){var t=new n(null);return t.words=Array(this.length+e.length),p(this,e,t)},n.prototype.imul=function(e){return this.clone().mulTo(e,this)},n.prototype.imuln=function(e){o("number"==typeof e),o(67108864>e);for(var t=0,a=0;a<this.length;a++){var r=(0|this.words[a])*e,n=(67108863&r)+(67108863&t);t>>=26,t+=0|r/67108864,t+=n>>>26,this.words[a]=67108863&n}return 0!==t&&(this.words[a]=t,this.length++),this},n.prototype.muln=function(e){return this.clone().imuln(e)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(e){var t=s(e);if(0===t.length)return new n(1);for(var a=this,r=0;r<t.length&&!(0!==t[r]);r++,a=a.sqr());if(++r<t.length)for(var o=a.sqr();r<t.length;r++,o=o.sqr())0!==t[r]&&(a=a.mul(o));return a},n.prototype.iushln=function(e){o("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26,r;if(0!=t){var n=0;for(r=0;r<this.length;r++){var l=this.words[r]&67108863>>>26-t<<26-t,s=(0|this.words[r])-l<<t;this.words[r]=s|n,n=l>>>26-t}n&&(this.words[r]=n,this.length++)}if(0!==a){for(r=this.length-1;0<=r;r--)this.words[r+a]=this.words[r];for(r=0;r<a;r++)this.words[r]=0;this.length+=a}return this.strip()},n.prototype.ishln=function(e){return o(0===this.negative),this.iushln(e)},n.prototype.iushrn=function(e,t,a){o("number"==typeof e&&0<=e);var n=t?(t-t%26)/26:0;var l=e%26,r=ea((e-l)/26,this.length),s=a;if(n-=r,n=va(0,n),s){for(var d=0;d<r;d++)s.words[d]=this.words[d];s.length=r}if(0===r);else if(this.length>r)for(this.length-=r,d=0;d<this.length;d++)this.words[d]=this.words[d+r];else this.words[0]=0,this.length=1;var c=0;for(d=this.length-1;0<=d&&(0!=c||d>=n);d--){var p=0|this.words[d];this.words[d]=c<<26-l|p>>>l,c=p&(67108863^67108863>>>l<<l)}return s&&0!=c&&(s.words[s.length++]=c),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(e,t,a){return o(0===this.negative),this.iushrn(e,t,a)},n.prototype.shln=function(e){return this.clone().ishln(e)},n.prototype.ushln=function(e){return this.clone().iushln(e)},n.prototype.shrn=function(e){return this.clone().ishrn(e)},n.prototype.ushrn=function(e){return this.clone().iushrn(e)},n.prototype.testn=function(e){o("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26;if(this.length<=a)return!1;var r=this.words[a];return!!(r&1<<t)},n.prototype.imaskn=function(e){o("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26;if(o(0===this.negative,"imaskn works only with positive numbers"),this.length<=a)return this;if(0!=t&&a++,this.length=ea(a,this.length),0!=t){this.words[this.length-1]&=67108863^67108863>>>t<<t}return this.strip()},n.prototype.maskn=function(e){return this.clone().imaskn(e)},n.prototype.iaddn=function(e){return o("number"==typeof e),o(67108864>e),0>e?this.isubn(-e):0===this.negative?this._iaddn(e):1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this)},n.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&67108864<=this.words[t];t++)this.words[t]-=67108864,t==this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=va(this.length,t+1),this},n.prototype.isubn=function(e){if(o("number"==typeof e),o(67108864>e),0>e)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&0>this.words[0])this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&0>this.words[t];t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},n.prototype.addn=function(e){return this.clone().iaddn(e)},n.prototype.subn=function(e){return this.clone().isubn(e)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(e,t,a){var r=e.length+a,n;this._expand(r);var l=0,s;for(n=0;n<e.length;n++){s=(0|this.words[n+a])+l;var d=(0|e.words[n])*t;s-=67108863&d,l=(s>>26)-(0|d/67108864),this.words[n+a]=67108863&s}for(;n<this.length-a;n++)s=(0|this.words[n+a])+l,l=s>>26,this.words[n+a]=67108863&s;if(0===l)return this.strip();for(o(-1===l),l=0,n=0;n<this.length;n++)s=-(0|this.words[n])+l,l=s>>26,this.words[n]=67108863&s;return this.negative=1,this.strip()},n.prototype._wordDiv=function(e,t){var r=this.length-e.length,o=this.clone(),l=e,s=0|l.words[l.length-1],d=this._countBits(s);r=26-d,0!=r&&(l=l.ushln(r),o.iushln(r),s=0|l.words[l.length-1]);var c=o.length-l.length,p;if("mod"!==t){p=new n(null),p.length=c+1,p.words=Array(p.length);for(var u=0;u<p.length;u++)p.words[u]=0}var g=o.clone()._ishlnsubmul(l,1,c);0===g.negative&&(o=g,p&&(p.words[c]=1));for(var h=c-1,m;0<=h;h--){for(m=67108864*(0|o.words[l.length+h])+(0|o.words[l.length+h-1]),m=ea(0|m/s,67108863),o._ishlnsubmul(l,m,h);0!==o.negative;)m--,o.negative=0,o._ishlnsubmul(l,1,h),o.isZero()||(o.negative^=1);p&&(p.words[h]=m)}return p&&p.strip(),o.strip(),"div"!==t&&0!=r&&o.iushrn(r),{div:p||null,mod:o}},n.prototype.divmod=function(e,t,a){if(o(!e.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var r,i,l;return 0!==this.negative&&0===e.negative?(l=this.neg().divmod(e,t),"mod"!==t&&(r=l.div.neg()),"div"!==t&&(i=l.mod.neg(),a&&0!==i.negative&&i.iadd(e)),{div:r,mod:i}):0===this.negative&&0!==e.negative?(l=this.divmod(e.neg(),t),"mod"!==t&&(r=l.div.neg()),{div:r,mod:l.mod}):0==(this.negative&e.negative)?e.length>this.length||0>this.cmp(e)?{div:new n(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new n(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new n(this.modn(e.words[0]))}:this._wordDiv(e,t):(l=this.neg().divmod(e.neg(),t),"div"!==t&&(i=l.mod.neg(),a&&0!==i.negative&&i.isub(e)),{div:l.div,mod:i})},n.prototype.div=function(e){return this.divmod(e,"div",!1).div},n.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},n.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},n.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var a=0===t.div.negative?t.mod:t.mod.isub(e),r=e.ushrn(1),o=e.andln(1),i=a.cmp(r);return 0>i||1===o&&0===i?t.div:0===t.div.negative?t.div.iaddn(1):t.div.isubn(1)},n.prototype.modn=function(e){o(67108863>=e);for(var t=0,a=this.length-1;0<=a;a--)t=(67108864%e*t+(0|this.words[a]))%e;return t},n.prototype.idivn=function(e){o(67108863>=e);for(var t=0,a=this.length-1,r;0<=a;a--)r=(0|this.words[a])+67108864*t,this.words[a]=0|r/e,t=r%e;return this.strip()},n.prototype.divn=function(e){return this.clone().idivn(e)},n.prototype.egcd=function(e){o(0===e.negative),o(!e.isZero());var t=this,a=e.clone();t=0===t.negative?t.clone():t.umod(e);for(var r=new n(1),l=new n(0),s=new n(0),d=new n(1),c=0;t.isEven()&&a.isEven();)t.iushrn(1),a.iushrn(1),++c;for(var p=a.clone(),u=t.clone();!t.isZero();){for(var h=0,m=1;0==(t.words[0]&m)&&26>h;++h,m<<=1);if(0<h)for(t.iushrn(h);0<h--;)(r.isOdd()||l.isOdd())&&(r.iadd(p),l.isub(u)),r.iushrn(1),l.iushrn(1);for(var y=0,f=1;0==(a.words[0]&f)&&26>y;++y,f<<=1);if(0<y)for(a.iushrn(y);0<y--;)(s.isOdd()||d.isOdd())&&(s.iadd(p),d.isub(u)),s.iushrn(1),d.iushrn(1);0<=t.cmp(a)?(t.isub(a),r.isub(s),l.isub(d)):(a.isub(t),s.isub(r),d.isub(l))}return{a:s,b:d,gcd:a.iushln(c)}},n.prototype._invmp=function(e){o(0===e.negative),o(!e.isZero());var t=this,r=e.clone();t=0===t.negative?t.clone():t.umod(e);for(var l=new n(1),s=new n(0),d=r.clone();0<t.cmpn(1)&&0<r.cmpn(1);){for(var c=0,p=1;0==(t.words[0]&p)&&26>c;++c,p<<=1);if(0<c)for(t.iushrn(c);0<c--;)l.isOdd()&&l.iadd(d),l.iushrn(1);for(var u=0,g=1;0==(r.words[0]&g)&&26>u;++u,g<<=1);if(0<u)for(r.iushrn(u);0<u--;)s.isOdd()&&s.iadd(d),s.iushrn(1);0<=t.cmp(r)?(t.isub(r),l.isub(s)):(r.isub(t),s.isub(l))}var h;return h=0===t.cmpn(1)?l:s,0>h.cmpn(0)&&h.iadd(e),h},n.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var o=this.clone(),i=e.clone();o.negative=0,i.negative=0;for(var n=0;o.isEven()&&i.isEven();n++)o.iushrn(1),i.iushrn(1);do{for(;o.isEven();)o.iushrn(1);for(;i.isEven();)i.iushrn(1);var l=o.cmp(i);if(0>l){var r=o;o=i,i=r}else if(0===l||0===i.cmpn(1))break;o.isub(i)}while(!0);return i.iushln(n)},n.prototype.invm=function(e){return this.egcd(e).a.umod(e)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(e){return this.words[0]&e},n.prototype.bincn=function(e){o("number"==typeof e);var t=e%26,a=(e-t)/26,r=1<<t;if(this.length<=a)return this._expand(a+1),this.words[a]|=r,this;for(var n=r,l=a,s;0!==n&&l<this.length;l++)s=0|this.words[l],s+=n,n=s>>>26,s&=67108863,this.words[l]=s;return 0!==n&&(this.words[l]=n,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(e){var t=0>e;if(0!==this.negative&&!t)return-1;if(0===this.negative&&t)return 1;this.strip();var a;if(1<this.length)a=1;else{t&&(e=-e),o(67108863>=e,"Number is too big");var r=0|this.words[0];a=r===e?0:r<e?-1:1}return 0===this.negative?a:0|-a},n.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0===this.negative?t:0|-t},n.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;0<=r;r--){var o=0|this.words[r],a=0|e.words[r];if(o!==a){o<a?t=-1:o>a&&(t=1);break}}return t},n.prototype.gtn=function(e){return 1===this.cmpn(e)},n.prototype.gt=function(e){return 1===this.cmp(e)},n.prototype.gten=function(e){return 0<=this.cmpn(e)},n.prototype.gte=function(e){return 0<=this.cmp(e)},n.prototype.ltn=function(e){return-1===this.cmpn(e)},n.prototype.lt=function(e){return-1===this.cmp(e)},n.prototype.lten=function(e){return 0>=this.cmpn(e)},n.prototype.lte=function(e){return 0>=this.cmp(e)},n.prototype.eqn=function(e){return 0===this.cmpn(e)},n.prototype.eq=function(e){return 0===this.cmp(e)},n.red=function(e){return new x(e)},n.prototype.toRed=function(e){return o(!this.red,"Already a number in reduction context"),o(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},n.prototype.fromRed=function(){return o(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(e){return this.red=e,this},n.prototype.forceRed=function(e){return o(!this.red,"Already a number in reduction context"),this._forceRed(e)},n.prototype.redAdd=function(e){return o(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},n.prototype.redIAdd=function(e){return o(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},n.prototype.redSub=function(e){return o(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},n.prototype.redISub=function(e){return o(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},n.prototype.redShl=function(e){return o(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},n.prototype.redMul=function(e){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},n.prototype.redIMul=function(e){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},n.prototype.redSqr=function(){return o(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return o(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return o(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return o(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return o(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(e){return o(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var L={k256:null,p224:null,p192:null,p25519:null};g.prototype._tmp=function(){var e=new n(null);return e.words=Array(M(this.n/13)),e},g.prototype.ireduce=function(e){var t=e,a;do this.split(t,this.tmp),t=this.imulK(t),t=t.iadd(this.tmp),a=t.bitLength();while(a>this.n);var o=a<this.n?-1:t.ucmp(this.p);return 0===o?(t.words[0]=0,t.length=1):0<o?t.isub(this.p):t.strip(),t},g.prototype.split=function(e,t){e.iushrn(this.n,0,t)},g.prototype.imulK=function(e){return e.imul(this.k)},i(h,g),h.prototype.split=function(e,t){for(var a=4194303,r=ea(e.length,9),o=0;o<r;o++)t.words[o]=e.words[o];if(t.length=r,9>=e.length)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=n&a,o=10;o<e.length;o++){var l=0|e.words[o];e.words[o-10]=(l&a)<<4|n>>>22,n=l}n>>>=22,e.words[o-10]=n,e.length-=0===n&&10<e.length?10:9},h.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,a=0,r;a<e.length;a++)r=0|e.words[a],t+=977*r,e.words[a]=67108863&t,t=64*r+(0|t/67108864);return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(m,g),i(y,g),i(f,g),f.prototype.imulK=function(e){for(var t=0,a=0;a<e.length;a++){var r=19*(0|e.words[a])+t,o=67108863&r;r>>>=26,e.words[a]=o,t=r}return 0!==t&&(e.words[e.length++]=t),e},n._prime=function e(t){if(L[t])return L[t];var e;if("k256"===t)e=new h;else if("p224"===t)e=new m;else if("p192"===t)e=new y;else if("p25519"===t)e=new f;else throw new Error("Unknown prime "+t);return L[t]=e,e},x.prototype._verify1=function(e){o(0===e.negative,"red works only with positives"),o(e.red,"red works only with red numbers")},x.prototype._verify2=function(e,t){o(0==(e.negative|t.negative),"red works only with positives"),o(e.red&&e.red===t.red,"red works only with red numbers")},x.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},x.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},x.prototype.add=function(e,t){this._verify2(e,t);var a=e.add(t);return 0<=a.cmp(this.m)&&a.isub(this.m),a._forceRed(this)},x.prototype.iadd=function(e,t){this._verify2(e,t);var a=e.iadd(t);return 0<=a.cmp(this.m)&&a.isub(this.m),a},x.prototype.sub=function(e,t){this._verify2(e,t);var a=e.sub(t);return 0>a.cmpn(0)&&a.iadd(this.m),a._forceRed(this)},x.prototype.isub=function(e,t){this._verify2(e,t);var a=e.isub(t);return 0>a.cmpn(0)&&a.iadd(this.m),a},x.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},x.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},x.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},x.prototype.isqr=function(e){return this.imul(e,e.clone())},x.prototype.sqr=function(e){return this.mul(e,e)},x.prototype.sqrt=function(e){if(e.isZero())return e.clone();var a=this.m.andln(3);if(o(1==a%2),3===a){var l=this.m.add(new n(1)).iushrn(2);return this.pow(e,l)}for(var d=this.m.subn(1),p=0;!d.isZero()&&0===d.andln(1);)p++,d.iushrn(1);o(!d.isZero());var u=new n(1).toRed(this),g=u.redNeg(),h=this.m.subn(1).iushrn(1),y=this.m.bitLength();for(y=new n(2*y*y).toRed(this);0!==this.pow(y,h).cmp(g);)y.redIAdd(g);for(var f=this.pow(y,d),x=this.pow(e,d.addn(1).iushrn(1)),_=this.pow(e,d),v=p;0!==_.cmp(u);){for(var k=_,w=0;0!==k.cmp(u);w++)k=k.redSqr();o(w<v);var T=this.pow(f,new n(1).iushln(v-w-1));x=x.redMul(T),f=T.redSqr(),_=_.redMul(f),v=w}return x},x.prototype.invm=function(e){var t=e._invmp(this.m);return 0===t.negative?this.imod(t):(t.negative=0,this.imod(t).redNeg())},x.prototype.pow=function(e,t){if(t.isZero())return new n(1).toRed(this);if(0===t.cmpn(1))return e.clone();var a=Array(16);a[0]=new n(1).toRed(this),a[1]=e;for(var r=2;r<a.length;r++)a[r]=this.mul(a[r-1],e);var o=a[0],l=0,s=0,d=t.bitLength()%26;for(0===d&&(d=26),r=t.length-1;0<=r;r--){for(var c=t.words[r],p=d-1,u;0<=p;p--){if(u=1&c>>p,o!==a[0]&&(o=this.sqr(o)),0===u&&0===l){s=0;continue}l<<=1,l|=u,s++,4!==s&&(0!=r||0!=p)||(o=this.mul(o,a[l]),s=0,l=0)}d=26}return o},x.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},x.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},n.mont=function(e){return new _(e)},i(_,x),_.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},_.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},_.prototype.imul=function(e,a){if(e.isZero()||a.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(a),t=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=r.isub(t).iushrn(this.shift),i=o;return 0<=o.cmp(this.m)?i=o.isub(this.m):0>o.cmpn(0)&&(i=o.iadd(this.m)),i._forceRed(this)},_.prototype.mul=function(e,a){if(e.isZero()||a.isZero())return new n(0)._forceRed(this);var r=e.mul(a),t=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=r.isub(t).iushrn(this.shift),i=o;return 0<=o.cmp(this.m)?i=o.isub(this.m):0>o.cmpn(0)&&(i=o.iadd(this.m)),i._forceRed(this)},_.prototype.invm=function(e){var t=this.imod(e._invmp(this.m).mul(this.r2));return t._forceRed(this)}})("undefined"==typeof t||t,this)},{buffer:103}],95:[function(e,t){"use strict";t.exports=function(e){var t=e.length,a=0,r,o,n;for(r=0;r<t;++r)a+=e[r].length;var l=Array(a),s=0;for(r=0;r<t;++r){var u=e[r],c=u.length;for(o=0;o<c;++o){var d=l[s++]=Array(c-1),g=0;for(n=0;n<c;++n)n!==o&&(d[g++]=u[n]);if(1&o){var h=d[1];d[1]=d[0],d[0]=h}}}return l}},{}],96:[function(e,t){"use strict";function a(e,t){for(var a=0;a<e;++a)if(!(t[a]<=t[a+e]))return!0;return!1}function r(e,t,r,o){for(var l=0,s=0,d=0,c=e.length,n;d<c;++d)if(n=e[d],!a(t,n)){for(var p=0;p<2*t;++p)r[l++]=n[p];o[s++]=d}return s}function o(e,t,a,o){var i=e.length,l=t.length;if(!(0>=i||0>=l)){var u=e[0].length>>>1;if(!(0>=u)){var d=s.mallocDouble(2*u*i),g=s.mallocInt32(i),h;if(i=r(e,u,d,g),0<i){if(1==u&&o)c.init(i),h=c.sweepComplete(u,a,0,i,d,g,0,i,d,g);else{var y=s.mallocDouble(2*u*l),f=s.mallocInt32(l);l=r(t,u,y,f),0<l&&(c.init(i+l),h=1==u?c.sweepBipartite(u,a,0,i,d,g,0,l,y,f):p(u,a,o,i,d,g,l,y,f),s.free(y),s.free(f))}s.free(d),s.free(g)}return h}}}function i(e,t){u.push([e,t])}function n(e){return u=[],o(e,e,i,!0),u}function l(e,t){return u=[],o(e,t,i,!1),u}t.exports=function(e,t,a){switch(arguments.length){case 1:return n(e);case 2:return"function"==typeof t?o(e,e,t,!0):l(e,t);case 3:return o(e,t,a,!1);default:throw new Error("box-intersect: Invalid arguments");}};var s=e("typedarray-pool"),c=e("./lib/sweep"),p=e("./lib/intersect"),u},{"./lib/intersect":98,"./lib/sweep":102,"typedarray-pool":545}],97:[function(e,t,a){"use strict";function r(e,t,a){var r="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(a?"Full":""),o=["function ",r,"(",i.join(),"){","var ","es","=2*","d",";"],n="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",l="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(a?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?o.push(n,"Q",":",l):o.push(l,"Q",":",n),a?o.push("if(y1<x0||x1<y0)continue;"):t?o.push("if(y0<=x0||x1<y0)continue;"):o.push("if(y0<x0||x1<y0)continue;"),o.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?o.push("yi,xi"):o.push("xi,yi"),o.push(");if(rv!==void 0)return rv;}}}"),{name:r,code:o.join("")}}function o(e){function t(t,a){var n=r(t,a,e);o.push(n.code),l.push("return "+n.name+"("+i.join()+");")}var a="bruteForce"+(e?"Full":"Partial"),o=[],n=i.slice();e||n.splice(3,0,"fp");var l=["function "+a+"("+n.join()+"){"];l.push("if(re-rs>be-bs){"),e?(t(!0,!1),l.push("}else{"),t(!1,!1)):(l.push("if(fp){"),t(!0,!0),l.push("}else{"),t(!0,!1),l.push("}}else{if(fp){"),t(!1,!0),l.push("}else{"),t(!1,!1),l.push("}")),l.push("}}return "+a);var s=o.join("")+l.join(""),d=new Function(s);return d()}var i=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];a.partial=o(!1),a.full=o(!0)},{}],98:[function(e,t){"use strict";function a(e,t){var a=0|8*s.log2(t+1)*(e+1),r=s.nextPow2(6*a);k.length<r&&(l.free(k),k=l.mallocInt32(r));var o=s.nextPow2(2*a);w<o&&(l.free(w),w=l.mallocDouble(o))}function r(e,t,a,r,o,i,n,l,s){var d=6*e;k[d]=t,k[d+1]=a,k[d+2]=r,k[d+3]=o,k[d+4]=i,k[d+5]=n;var c=2*e;w[c]=l,w[c+1]=s}function o(e,t,a,r,o,n,l,s,d,c,p){var u=2*e,g=d*u,h=c[g+t];red_loop:for(var m=o,y=o*u;m<n;++m,y+=u){var f=l[y+t],x=l[y+t+e];if(!(h<f||x<h)&&!(r&&h===f)){for(var _=s[m],b=t+1;b<e;++b){var f=l[y+b],x=l[y+b+e],v=c[g+b],k=c[g+b+e];if(x<v||k<f)continue red_loop}var w;if(w=r?a(p,_):a(_,p),void 0!==w)return w}}}function i(e,t,a,r,o,n,l,s,d,c){var p=2*e,u=s*p,g=d[u+t];red_loop:for(var h=r,m=r*p,y;h<o;++h,m+=p)if(y=l[h],y!==c){var f=n[m+t],x=n[m+t+e];if(!(g<f||x<g)){for(var _=t+1;_<e;++_){var f=n[m+_],x=n[m+_+e],b=d[u+_],v=d[u+_+e];if(x<b||v<f)continue red_loop}var k=a(y,c);if(void 0!==k)return k}}}function n(e,t,n,l,s,d,h,v,T){a(e,l+h);var A=0,S;for(r(A++,0,0,l,0,h,n?16:0,-Infinity,1/0),n||r(A++,0,0,h,0,l,1,-Infinity,1/0);0<A;){A-=1;var C=6*A,L=k[C],E=k[C+1],I=k[C+2],z=k[C+3],P=k[C+4],D=k[C+5],O=2*A,R=w[O],M=w[O+1],j=1&D,F=!!(16&D),B=s,N=d,V=v,U=T;if((j&&(B=v,N=T,V=s,U=d),!(2&D&&(I=f(e,L,E,I,B,N,M),E>=I)))&&!(4&D&&(E=x(e,L,E,I,B,N,R),E>=I))){var H=I-E,G=P-z;if(F){if(4194304>e*H*(H+G)){if(S=u.scanComplete(e,L,t,E,I,B,N,z,P,V,U),void 0!==S)return S;continue}}else if(128>e*ea(H,G)){if(S=c(e,L,t,j,E,I,B,N,z,P,V,U),void 0!==S)return S;continue}else if(4194304>e*H*G){if(S=u.scanBipartite(e,L,t,j,E,I,B,N,z,P,V,U),void 0!==S)return S;continue}var q=m(e,L,E,I,B,N,R,M);if(E<q)if(128>e*(q-E)){if(S=p(e,L+1,t,E,q,B,N,z,P,V,U),void 0!==S)return S;}else if(L!==e-2)r(A++,L+1,E,q,z,P,j,-Infinity,1/0),r(A++,L+1,z,P,E,q,1^j,-Infinity,1/0);else if(S=j?u.sweepBipartite(e,t,z,P,V,U,E,q,B,N):u.sweepBipartite(e,t,E,q,B,N,z,P,V,U),void 0!==S)return S;if(q<I){var Y=g(e,L,z,P,V,U),W=V[2*e*Y+L],X=y(e,L,Y,P,V,U,W);if(X<P&&r(A++,L,q,I,X,P,(4|j)+(F?16:0),W,M),z<Y&&r(A++,L,q,I,z,Y,(2|j)+(F?16:0),R,W),Y+1===X){if(S=F?i(e,L,t,q,I,B,N,Y,V,U[Y]):o(e,L,t,j,q,I,B,N,Y,V,U[Y]),void 0!==S)return S;}else if(Y<X){var Z;if(!F)Z=j?b(e,L,q,I,B,N,W):_(e,L,q,I,B,N,W),q<Z&&(L===e-2?j?S=u.sweepBipartite(e,t,Y,X,V,U,q,Z,B,N):S=u.sweepBipartite(e,t,q,Z,B,N,Y,X,V,U):(r(A++,L+1,q,Z,Y,X,j,-Infinity,1/0),r(A++,L+1,Y,X,q,Z,1^j,-Infinity,1/0)));else if(Z=_(e,L,q,I,B,N,W),q<Z){var K=y(e,L,q,Z,B,N,W);if(L===e-2){if(q<K&&(S=u.sweepComplete(e,t,q,K,B,N,Y,X,V,U),void 0!==S))return S;if(K<Z&&(S=u.sweepBipartite(e,t,K,Z,B,N,Y,X,V,U),void 0!==S))return S}else q<K&&r(A++,L+1,q,K,Y,X,16,-Infinity,1/0),K<Z&&(r(A++,L+1,K,Z,Y,X,0,-Infinity,1/0),r(A++,L+1,Y,X,K,Z,1,-Infinity,1/0))}}}}}}t.exports=n;var l=e("typedarray-pool"),s=e("bit-twiddle"),d=e("./brute"),c=d.partial,p=d.full,u=e("./sweep"),g=e("./median"),h=e("./partition"),m=h("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),y=h("lo===p0",["p0"]),f=h("lo<p0",["p0"]),x=h("hi<=p0",["p0"]),_=h("lo<=p0&&p0<=hi",["p0"]),b=h("lo<p0&&p0<=hi",["p0"]),v=1024,k=l.mallocInt32(v),w=l.mallocDouble(v)},{"./brute":97,"./median":99,"./partition":100,"./sweep":102,"bit-twiddle":92,"typedarray-pool":545}],99:[function(e,t){"use strict";function a(e,t,a,r,o,n){for(var l=2*e,s=l*(a+1)+t,d=a+1,c;d<r;++d,s+=l){c=o[s];for(var p=d,u=l*(d-1);p>a&&o[u+t]>c;--p,u-=l){for(var g=u,h=u+l,m=0,f;m<l;++m,++g,++h)f=o[g],o[g]=o[h],o[h]=f;var _=n[p];n[p]=n[p-1],n[p-1]=_}}}t.exports=function(e,t,r,n,l,s){if(n<=r+1)return r;for(var d=r,c=n,p=n+r>>>1,u=2*e,g=p,h=l[u*p+t];d<c;){if(8>c-d){a(e,t,d,c,l,s),h=l[u*p+t];break}var m=c-d,f=0|Math.random()*m+d,_=l[u*f+t],b=0|Math.random()*m+d,v=l[u*b+t],k=0|Math.random()*m+d,w=l[u*k+t];_<=v?w>=v?(g=b,h=v):_>=w?(g=f,h=_):(g=k,h=w):v>=w?(g=b,h=v):w>=_?(g=f,h=_):(g=k,h=w);for(var T=u*(c-1),A=u*g,S=0,C;S<u;++S,++T,++A)C=l[T],l[T]=l[A],l[A]=C;var L=s[c-1];s[c-1]=s[g],s[g]=L,g=o(e,t,d,c-1,l,s,h);for(var T=u*(c-1),A=u*g,S=0,C;S<u;++S,++T,++A)C=l[T],l[T]=l[A],l[A]=C;var L=s[c-1];if(s[c-1]=s[g],s[g]=L,p<g){for(c=g-1;d<c&&l[u*(c-1)+t]===h;)c-=1;c+=1}else if(g<p)for(d=g+1;d<c&&l[u*d+t]===h;)d+=1;else break}return o(e,t,r,p,l,s,l[u*p+t])};var r=e("./partition"),o=r("lo<p0",["p0"])},{"./partition":100}],100:[function(e,t){"use strict";t.exports=function(e,t){var a=["a","b","c","d","e","f"].concat(t),r=[];return 0<=e.indexOf("lo")&&r.push("lo=e[k+n]"),0<=e.indexOf("hi")&&r.push("hi=e[k+o]"),a.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",r.join()).replace("$",e)),Function.apply(void 0,a)}},{}],101:[function(e,t){"use strict";function a(e,t,r){for(var o=2*(e+1),n=e+1;n<=t;++n){for(var l=r[o++],a=r[o++],s=n,d=o-2;s-->e;){var c=r[d-2],p=r[d-1];if(c<l)break;else if(c===l&&p<a)break;r[d]=c,r[d+1]=p,d-=2}r[d]=l,r[d+1]=a}}function r(e,t,a){e*=2,t*=2;var r=a[e],o=a[e+1];a[e]=a[t],a[e+1]=a[t+1],a[t]=r,a[t+1]=o}function o(e,t,a){e*=2,t*=2,a[e]=a[t],a[e+1]=a[t+1]}function i(e,t,a,r){e*=2,t*=2,a*=2;var o=r[e],n=r[e+1];r[e]=r[t],r[e+1]=r[t+1],r[t]=r[a],r[t+1]=r[a+1],r[a]=o,r[a+1]=n}function n(e,t,a,r,o){e*=2,t*=2,o[e]=o[t],o[t]=a,o[e+1]=o[t+1],o[t+1]=r}function l(e,t,a){e*=2,t*=2;var r=a[e],o=a[t];if(r<o)return!1;return r!==o||a[e+1]>a[t+1]}function s(e,t,a,r){e*=2;var o=r[e];if(o<t)return!0;return!(o!==t)&&r[e+1]<a}function d(e,t,c){var p=0|(t-e+1)/6,u=e+p,g=t-p,h=e+t>>1,m=h-p,f=h+p,_=u,b=m,v=h,w=f,T=g,A=e+1,S=t-1,C=0;l(_,b,c)&&(C=_,_=b,b=C),l(w,T,c)&&(C=w,w=T,T=C),l(_,v,c)&&(C=_,_=v,v=C),l(b,v,c)&&(C=b,b=v,v=C),l(_,w,c)&&(C=_,_=w,w=C),l(v,w,c)&&(C=v,v=w,w=C),l(b,T,c)&&(C=b,b=T,T=C),l(b,v,c)&&(C=b,b=v,v=C),l(w,T,c)&&(C=w,w=T,T=C);for(var L=c[2*b],E=c[2*b+1],I=c[2*w],P=c[2*w+1],D=2*_,O=2*v,R=2*T,M=0;2>M;++M){var j=c[D+M],x=c[O+M],y=c[R+M];c[2*u+M]=j,c[2*h+M]=x,c[2*g+M]=y}o(m,e,c),o(f,t,c);for(var z=A;z<=S;++z)if(s(z,L,E,c))z!==A&&r(z,A,c),++A;else if(!s(z,I,P,c))for(;;)if(!s(S,I,P,c)){if(--S<z)break;continue}else{s(S,L,E,c)?(i(z,A,S,c),++A,--S):(r(z,S,c),--S);break}n(e,A-1,L,E,c),n(t,S+1,I,P,c),A-2-e<=32?a(e,A-2,c):d(e,A-2,c),t-(S+2)<=32?a(S+2,t,c):d(S+2,t,c),S-A<=32?a(A,S,c):d(A,S,c)}t.exports=function(e,t){t<=128?a(0,t-1,e):d(0,t-1,e)}},{}],102:[function(e,t){"use strict";function a(e){var t=c.nextPow2(e);g.length<t&&(d.free(g),g=d.mallocInt32(t)),h.length<t&&(d.free(h),h=d.mallocInt32(t)),m.length<t&&(d.free(m),m=d.mallocInt32(t)),y.length<t&&(d.free(y),y=d.mallocInt32(t)),f.length<t&&(d.free(f),f=d.mallocInt32(t)),x.length<t&&(d.free(x),x=d.mallocInt32(t));var a=8*t;_.length<a&&(d.free(_),_=d.mallocDouble(a))}function r(e,t,a,r){var o=t[r],i=e[a-1];e[o]=i,t[i]=o}function o(e,t,a,r){e[a]=r,t[r]=a}function i(t,a,l,s,d,c,u,f,x,b){for(var v=0,k=2*t,w=t-1,T=k-1,A=l;A<s;++A){var S=c[A],C=k*A;_[v++]=d[C+w],_[v++]=-(S+1),_[v++]=d[C+T],_[v++]=S}for(var A=u;A<f;++A){var S=b[A]+268435456,L=k*A;_[v++]=x[L+w],_[v++]=-S,_[v++]=x[L+T],_[v++]=S}var E=v>>>1;p(_,E);for(var n=0,I=0,A=0,z;A<E;++A)if(z=0|_[2*A+1],268435456<=z)z=0|z-268435456,r(m,y,I--,z);else if(0<=z)r(g,h,n--,z);else if(-268435456>=z){z=0|-z-268435456;for(var P=0,D;P<n;++P)if(D=a(g[P],z),void 0!==D)return D;o(m,y,I++,z)}else{z=0|-z-1;for(var P=0,D;P<I;++P)if(D=a(z,m[P]),void 0!==D)return D;o(g,h,n++,z)}}function n(t,a,l,s,d,c,u,b,v,k){for(var w=0,T=2*t,A=t-1,S=T-1,C=l;C<s;++C){var L=c[C]+1<<1,E=T*C;_[w++]=d[E+A],_[w++]=-L,_[w++]=d[E+S],_[w++]=L}for(var C=u;C<b;++C){var L=k[C]+1<<1,I=T*C;_[w++]=v[I+A],_[w++]=1|-L,_[w++]=v[I+S],_[w++]=1|L}var z=w>>>1;p(_,z);for(var n=0,P=0,D=0,C=0;C<z;++C){var O=0|_[2*C+1],e=1&O;if(C<z-1&&O>>1==_[2*C+3]>>1&&(e=2,C+=1),0>O){for(var R=-(O>>1)-1,M=0,F;M<D;++M)if(F=a(f[M],R),void 0!==F)return F;if(0!==e)for(var M=0,F;M<n;++M)if(F=a(g[M],R),void 0!==F)return F;if(1!==e)for(var M=0,F;M<P;++M)if(F=a(m[M],R),void 0!==F)return F;0===e?o(g,h,n++,R):1===e?o(m,y,P++,R):2===e&&o(f,x,D++,R)}else{var R=(O>>1)-1;0===e?r(g,h,n--,R):1===e?r(m,y,P--,R):2===e&&r(f,x,D--,R)}}}function l(t,a,l,s,d,c,u,m,y,f,x,b){var v=0,w=2*t,T=a,A=1,S=1;s?S=268435456:A=268435456;for(var C=d;C<c;++C){var L=C+A,E=w*C;_[v++]=u[E+T],_[v++]=-L,_[v++]=u[E+(a+t)],_[v++]=L}for(var C=y;C<f;++C){var L=C+S,I=w*C;_[v++]=x[I+T],_[v++]=-L}var z=v>>>1;p(_,z);for(var n=0,C=0,P;C<z;++C)if(P=0|_[2*C+1],0>P){var L=-P,D=!1;if(268435456<=L?(D=!s,L-=268435456):(D=!!s,L-=1),D)o(g,h,n++,L);else{var O=b[L],R=w*L,M=x[R+a+1],F=x[R+a+1+t];red_loop:for(var B=0;B<n;++B){var N=g[B],V=w*N;if(!(F<u[V+a+1]||u[V+a+1+t]<M)){for(var U=a+2;U<t;++U)if(x[R+U+t]<u[V+U]||u[V+U+t]<x[R+U])continue red_loop;var H=m[N],G;if(G=s?l(O,H):l(H,O),void 0!==G)return G}}}}else r(g,h,n--,P-A)}function s(t,a,r,o,l,s,d,c,u,h,m){for(var y=0,f=2*t,x=a,b=o;b<l;++b){var v=b+268435456,w=f*b;_[y++]=s[w+x],_[y++]=-v,_[y++]=s[w+(a+t)],_[y++]=v}for(var b=c;b<u;++b){var v=b+1,T=f*b;_[y++]=h[T+x],_[y++]=-v}var A=y>>>1;p(_,A);for(var n=0,b=0,S;b<A;++b)if(S=0|_[2*b+1],0>S){var v=-S;if(268435456<=v)g[n++]=v-268435456;else{v-=1;var C=m[v],L=f*v,E=h[L+a+1],I=h[L+a+1+t];red_loop:for(var z=0;z<n;++z){var P=g[z],D=d[P];if(D===C)break;var O=f*P;if(!(I<s[O+a+1]||s[O+a+1+t]<E)){for(var R=a+2;R<t;++R)if(h[L+R+t]<s[O+R]||s[O+R+t]<h[L+R])continue red_loop;var M=r(D,C);if(void 0!==M)return M}}}}else{for(var v=S-268435456,z=n-1;0<=z;--z)if(g[z]===v){for(var R=z+1;R<n;++R)g[R-1]=g[R];break}--n}}t.exports={init:a,sweepBipartite:i,sweepComplete:n,scanBipartite:l,scanComplete:s};var d=e("typedarray-pool"),c=e("bit-twiddle"),p=e("./sort"),u=1024,g=d.mallocInt32(u),h=d.mallocInt32(u),m=d.mallocInt32(u),y=d.mallocInt32(u),f=d.mallocInt32(u),x=d.mallocInt32(u),_=d.mallocDouble(8*u)},{"./sort":101,"bit-twiddle":92,"typedarray-pool":545}],103:[function(){},{}],104:[function(e,t){function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=_(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function r(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function n(e,t,a){if(t)e.call(a);else for(var r=e.length,o=f(e,r),n=0;n<r;++n)o[n].call(a)}function l(e,t,a,r){if(t)e.call(a,r);else for(var o=e.length,n=f(e,o),l=0;l<o;++l)n[l].call(a,r)}function s(e,t,a,r,o){if(t)e.call(a,r,o);else for(var n=e.length,l=f(e,n),s=0;s<n;++s)l[s].call(a,r,o)}function d(e,t,a,r,o,n){if(t)e.call(a,r,o,n);else for(var l=e.length,s=f(e,l),d=0;d<l;++d)s[d].call(a,r,o,n)}function c(e,t,a,r){if(t)e.apply(a,r);else for(var o=e.length,n=f(e,o),l=0;l<o;++l)n[l].apply(a,r)}function p(e,t,a,o){var i,n,l;if("function"!=typeof a)throw new TypeError("\"listener\" argument must be a function");if(n=e._events,n?(n.newListener&&(e.emit("newListener",t,a.listener?a.listener:a),n=e._events),l=n[t]):(n=e._events=_(null),e._eventsCount=0),!l)l=n[t]=a,++e._eventsCount;else if("function"==typeof l?l=n[t]=o?[a,l]:[l,a]:o?l.unshift(a):l.push(a),!l.warned&&(i=r(e),i&&0<i&&l.length>i)){l.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+l.length+" \""+(t+"\" listeners added. Use emitter.setMaxListeners() to increase limit."));s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=l.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}return e}function u(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e);}}function g(e,t,a){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},o=v.call(u,r);return o.listener=a,r.wrapFn=o,o}function h(e,t,a){var r=e._events;if(!r)return[];var o=r[t];return o?"function"==typeof o?a?[o.listener||o]:[o]:a?x(o):f(o,o.length):[]}function m(e){var t=this._events;if(t){var a=t[e];if("function"==typeof a)return 1;if(a)return a.length}return 0}function y(e,t){for(var a=t,r=a+1,o=e.length;r<o;a+=1,r+=1)e[a]=e[r];e.pop()}function f(e,t){for(var a=Array(t),r=0;r<t;++r)a[r]=e[r];return a}function x(e){for(var t=Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}var _=Object.create||function(e){var t=function(){};return t.prototype=e,new t},b=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return a},v=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var k=10,w;try{var T={};Object.defineProperty&&Object.defineProperty(T,"x",{value:0}),w=0===T.x}catch(e){w=!1}w?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return k},set:function(e){if("number"!=typeof e||0>e||e!==e)throw new TypeError("\"defaultMaxListeners\" must be a positive number");k=e}}):a.defaultMaxListeners=k,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return r(this)},a.prototype.emit=function(e){var t="error"===e,a,r,o,p,u,g;if(g=this._events,g)t=t&&null==g.error;else if(!t)return!1;if(t){if(1<arguments.length&&(a=arguments[1]),a instanceof Error)throw a;else{var h=new Error("Unhandled \"error\" event. ("+a+")");throw h.context=a,h}return!1}if(r=g[e],!r)return!1;var m="function"==typeof r;switch(o=arguments.length,o){case 1:n(r,m,this);break;case 2:l(r,m,this,arguments[1]);break;case 3:s(r,m,this,arguments[1],arguments[2]);break;case 4:d(r,m,this,arguments[1],arguments[2],arguments[3]);break;default:for(p=Array(o-1),u=1;u<o;u++)p[u-1]=arguments[u];c(r,m,this,p);}return!0},a.prototype.addListener=function(e,t){return p(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return p(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.on(e,g(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(e,g(this,e,t)),this},a.prototype.removeListener=function(e,t){var a,r,o,n,l;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if(r=this._events,!r)return this;if(a=r[e],!a)return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=_(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,a.listener||t));else if("function"!=typeof a){for(o=-1,n=a.length-1;0<=n;n--)if(a[n]===t||a[n].listener===t){l=a[n].listener,o=n;break}if(0>o)return this;0===o?a.shift():y(a,o),1===a.length&&(r[e]=a[0]),r.removeListener&&this.emit("removeListener",e,l||t)}return this},a.prototype.removeAllListeners=function(e){var t,a,r;if(a=this._events,!a)return this;if(!a.removeListener)return 0===arguments.length?(this._events=_(null),this._eventsCount=0):a[e]&&(0==--this._eventsCount?this._events=_(null):delete a[e]),this;if(0===arguments.length){var o=b(a),n;for(r=0;r<o.length;++r)n=o[r],"removeListener"===n||this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=_(null),this._eventsCount=0,this}if(t=a[e],"function"==typeof t)this.removeListener(e,t);else if(t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],105:[function(e,t,a){(function(t){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */"use strict";function r(e){if(2147483647<e)throw new RangeError("The value \""+e+"\" is invalid for option \"size\"");var a=new Uint8Array(e);return a.__proto__=t.prototype,a}function t(e,a,r){if("number"==typeof e){if("string"==typeof a)throw new TypeError("The \"string\" argument must be of type string. Received type number");return l(e)}return o(e,a,r)}function o(e,a,r){if("string"==typeof e)return s(e,a);if(ArrayBuffer.isView(e))return d(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(q(e,ArrayBuffer)||e&&q(e.buffer,ArrayBuffer))return c(e,a,r);if("number"==typeof e)throw new TypeError("The \"value\" argument must not be of type number. Received type number");var o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return t.from(o,a,r);var i=p(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),a,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function i(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be of type number");else if(0>e)throw new RangeError("The value \""+e+"\" is invalid for option \"size\"")}function n(e,t,a){return i(e),0>=e?r(e):void 0===t?r(e):"string"==typeof a?r(e).fill(t,a):r(e).fill(t)}function l(e){return i(e),r(0>e?0:0|u(e))}function s(e,a){if(("string"!=typeof a||""===a)&&(a="utf8"),!t.isEncoding(a))throw new TypeError("Unknown encoding: "+a);var o=0|h(e,a),i=r(o),n=i.write(e,a);return n!==o&&(i=i.slice(0,n)),i}function d(e){for(var t=0>e.length?0:0|u(e.length),a=r(t),o=0;o<t;o+=1)a[o]=255&e[o];return a}function c(e,a,r){if(0>a||e.byteLength<a)throw new RangeError("\"offset\" is outside of buffer bounds");if(e.byteLength<a+(r||0))throw new RangeError("\"length\" is outside of buffer bounds");var o;return o=void 0===a&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,a):new Uint8Array(e,a,r),o.__proto__=t.prototype,o}function p(e){if(t.isBuffer(e)){var a=0|u(e.length),o=r(a);return 0===o.length?o:(e.copy(o,0,0,a),o)}return void 0===e.length?"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0:"number"!=typeof e.length||Y(e.length)?r(0):d(e)}function u(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),t.alloc(+e)}function h(e,a){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||q(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError("The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. Received type "+typeof e);var r=e.length,o=2<arguments.length&&!0===arguments[2];if(!o&&0===r)return 0;for(var i=!1;;)switch(a){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return H(e).length;default:if(i)return o?-1:N(e).length;a=(""+a).toLowerCase(),i=!0;}}function m(e,t,a){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),0>=a)return"";if(a>>>=0,t>>>=0,a<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,a);case"utf8":case"utf-8":return S(this,t,a);case"ascii":return L(this,t,a);case"latin1":case"binary":return E(this,t,a);case"base64":return A(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,t,a);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0;}}function y(e,t,a){var r=e[t];e[t]=e[a],e[a]=r}function f(e,a,r,o,i){if(0===e.length)return-1;if("string"==typeof r?(o=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648),r=+r,Y(r)&&(r=i?0:e.length-1),0>r&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(0>r)if(i)r=0;else return-1;if("string"==typeof a&&(a=t.from(a,o)),t.isBuffer(a))return 0===a.length?-1:x(e,a,r,o,i);if("number"==typeof a)return a&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,a,r):Uint8Array.prototype.lastIndexOf.call(e,a,r):x(e,[a],r,o,i);throw new TypeError("val must be string, number or Buffer")}function x(e,t,a,r,o){function n(e,t){return 1===l?e[t]:e.readUInt16BE(t*l)}var l=1,s=e.length,d=t.length;if(void 0!==r&&(r=(r+"").toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(2>e.length||2>t.length)return-1;l=2,s/=2,d/=2,a/=2}var c;if(o){var p=-1;for(c=a;c<s;c++)if(n(e,c)!==n(t,-1===p?0:c-p))-1!==p&&(c-=c-p),p=-1;else if(-1===p&&(p=c),c-p+1===d)return p*l}else for(a+d>s&&(a=s-d),c=a;0<=c;c--){for(var u=!0,g=0;g<d;g++)if(n(e,c+g)!==n(t,g)){u=!1;break}if(u)return c}return-1}function _(e,t,a,r){a=+a||0;var o=e.length-a;r?(r=+r,r>o&&(r=o)):r=o;var n=t.length;r>n/2&&(r=n/2);for(var l=0,s;l<r;++l){if(s=parseInt(t.substr(2*l,2),16),Y(s))return l;e[a+l]=s}return l}function b(e,t,a,r){return G(N(t,e.length-a),e,a,r)}function v(e,t,a,r){return G(V(t),e,a,r)}function k(e,t,a,r){return v(e,t,a,r)}function w(e,t,a,r){return G(H(t),e,a,r)}function T(e,t,a,r){return G(U(t,e.length-a),e,a,r)}function A(e,t,a){return 0===t&&a===e.length?W.fromByteArray(e):W.fromByteArray(e.slice(t,a))}function S(e,t,a){a=ea(e.length,a);for(var r=[],o=t;o<a;){var n=e[o],l=null,s=239<n?4:223<n?3:191<n?2:1;if(o+s<=a){var d,c,p,u;1===s?128>n&&(l=n):2===s?(d=e[o+1],128==(192&d)&&(u=(31&n)<<6|63&d,127<u&&(l=u))):3===s?(d=e[o+1],c=e[o+2],128==(192&d)&&128==(192&c)&&(u=(15&n)<<12|(63&d)<<6|63&c,2047<u&&(55296>u||57343<u)&&(l=u))):4===s?(d=e[o+1],c=e[o+2],p=e[o+3],128==(192&d)&&128==(192&c)&&128==(192&p)&&(u=(15&n)<<18|(63&d)<<12|(63&c)<<6|63&p,65535<u&&1114112>u&&(l=u))):void 0}null===l?(l=65533,s=1):65535<l&&(l-=65536,r.push(55296|1023&l>>>10),l=56320|1023&l),r.push(l),o+=s}return C(r)}function C(e){var t=e.length;if(t<=4096)return D.apply(String,e);for(var a="",r=0;r<t;)a+=D.apply(String,e.slice(r,r+=4096));return a}function L(e,t,a){var r="";a=ea(e.length,a);for(var o=t;o<a;++o)r+=D(127&e[o]);return r}function E(e,t,a){var r="";a=ea(e.length,a);for(var o=t;o<a;++o)r+=D(e[o]);return r}function I(e,t,a){var r=e.length;(!t||0>t)&&(t=0),(!a||0>a||a>r)&&(a=r);for(var o="",n=t;n<a;++n)o+=B(e[n]);return o}function z(e,t,a){for(var r=e.slice(t,a),o="",n=0;n<r.length;n+=2)o+=D(r[n]+256*r[n+1]);return o}function P(e,t,a){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function O(e,a,r,o,i,n){if(!t.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(a>i||a<n)throw new RangeError("\"value\" argument is out of bounds");if(r+o>e.length)throw new RangeError("Index out of range")}function R(e,t,a,r){if(a+r>e.length)throw new RangeError("Index out of range");if(0>a)throw new RangeError("Index out of range")}function M(e,t,a,r,o){return t=+t,a>>>=0,o||R(e,t,a,4,34028234663852886e22,-34028234663852886e22),X.write(e,t,a,r,23,4),a+4}function j(e,t,a,r,o){return t=+t,a>>>=0,o||R(e,t,a,8,17976931348623157e292,-17976931348623157e292),X.write(e,t,a,r,52,8),a+8}function F(e){if(e=e.split("=")[0],e=e.trim().replace(Z,""),2>e.length)return"";for(;0!=e.length%4;)e+="=";return e}function B(e){return 16>e?"0"+e.toString(16):e.toString(16)}function N(e,t){t=t||1/0;for(var a=e.length,r=null,o=[],n=0,l;n<a;++n){if(l=e.charCodeAt(n),55295<l&&57344>l){if(!r){if(56319<l){-1<(t-=3)&&o.push(239,191,189);continue}else if(n+1===a){-1<(t-=3)&&o.push(239,191,189);continue}r=l;continue}if(56320>l){-1<(t-=3)&&o.push(239,191,189),r=l;continue}l=(r-55296<<10|l-56320)+65536}else r&&-1<(t-=3)&&o.push(239,191,189);if(r=null,128>l){if(0>(t-=1))break;o.push(l)}else if(2048>l){if(0>(t-=2))break;o.push(192|l>>6,128|63&l)}else if(65536>l){if(0>(t-=3))break;o.push(224|l>>12,128|63&l>>6,128|63&l)}else if(1114112>l){if(0>(t-=4))break;o.push(240|l>>18,128|63&l>>12,128|63&l>>6,128|63&l)}else throw new Error("Invalid code point")}return o}function V(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}function U(e,t){for(var a=[],r=0,o,n,l;r<e.length&&!(0>(t-=2));++r)o=e.charCodeAt(r),n=o>>8,l=o%256,a.push(l),a.push(n);return a}function H(e){return W.toByteArray(F(e))}function G(e,t,a,r){for(var o=0;o<r&&!(o+a>=t.length||o>=e.length);++o)t[o+a]=e[o];return o}function q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!==e}var W=e("base64-js"),X=e("ieee754");a.Buffer=t,a.SlowBuffer=g,a.INSPECT_MAX_BYTES=50;a.kMaxLength=2147483647,t.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),t.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){return t.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){return t.isBuffer(this)?this.byteOffset:void 0}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=function(e,t,a){return o(e,t,a)},t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,t.alloc=function(e,t,a){return n(e,t,a)},t.allocUnsafe=function(e){return l(e)},t.allocUnsafeSlow=function(e){return l(e)},t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,r){if(q(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),q(r,Uint8Array)&&(r=t.from(r,r.offset,r.byteLength)),!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError("The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array");if(e===r)return 0;for(var o=e.length,n=r.length,l=0,s=ea(o,n);l<s;++l)if(e[l]!==r[l]){o=e[l],n=r[l];break}return o<n?-1:n<o?1:0},t.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},t.concat=function(e,a){if(!Array.isArray(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return t.alloc(0);var r;if(a===void 0)for(a=0,r=0;r<e.length;++r)a+=e[r].length;var o=t.allocUnsafe(a),n=0;for(r=0;r<e.length;++r){var l=e[r];if(q(l,Uint8Array)&&(l=t.from(l)),!t.isBuffer(l))throw new TypeError("\"list\" argument must be an Array of Buffers");l.copy(o,n),n+=l.length}return o},t.byteLength=h,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var e="",t=a.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},t.prototype.compare=function(e,a,r,o,n){if(q(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError("The \"target\" argument must be one of type Buffer or Uint8Array. Received type "+typeof e);if(void 0===a&&(a=0),void 0===r&&(r=e?e.length:0),void 0===o&&(o=0),void 0===n&&(n=this.length),0>a||r>e.length||0>o||n>this.length)throw new RangeError("out of range index");if(o>=n&&a>=r)return 0;if(o>=n)return-1;if(a>=r)return 1;if(a>>>=0,r>>>=0,o>>>=0,n>>>=0,this===e)return 0;for(var l=n-o,s=r-a,d=ea(l,s),c=this.slice(o,n),p=e.slice(a,r),u=0;u<d;++u)if(c[u]!==p[u]){l=c[u],s=p[u];break}return l<s?-1:s<l?1:0},t.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},t.prototype.indexOf=function(e,t,a){return f(this,e,t,a,!0)},t.prototype.lastIndexOf=function(e,t,a){return f(this,e,t,a,!1)},t.prototype.write=function(e,t,a,r){if(void 0===t)r="utf8",a=this.length,t=0;else if(void 0===a&&"string"==typeof t)r=t,a=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(a)?(a>>>=0,void 0===r&&(r="utf8")):(r=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-t;if((void 0===a||a>o)&&(a=o),0<e.length&&(0>a||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,e,t,a);case"utf8":case"utf-8":return b(this,e,t,a);case"ascii":return v(this,e,t,a);case"latin1":case"binary":return k(this,e,t,a);case"base64":return w(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,a);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0;}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};t.prototype.slice=function(e,a){var r=this.length;e=~~e,a=void 0===a?r:~~a,0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),0>a?(a+=r,0>a&&(a=0)):a>r&&(a=r),a<e&&(a=e);var o=this.subarray(e,a);return o.__proto__=t.prototype,o},t.prototype.readUIntLE=function(e,t,a){e>>>=0,t>>>=0,a||P(e,t,this.length);for(var r=this[e],o=1,n=0;++n<t&&(o*=256);)r+=this[e+n]*o;return r},t.prototype.readUIntBE=function(e,t,a){e>>>=0,t>>>=0,a||P(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},t.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,a){e>>>=0,t>>>=0,a||P(e,t,this.length);for(var r=this[e],o=1,n=0;++n<t&&(o*=256);)r+=this[e+n]*o;return o*=128,r>=o&&(r-=ya(2,8*t)),r},t.prototype.readIntBE=function(e,t,a){e>>>=0,t>>>=0,a||P(e,t,this.length);for(var r=t,o=1,n=this[e+--r];0<r&&(o*=256);)n+=this[e+--r]*o;return o*=128,n>=o&&(n-=ya(2,8*t)),n},t.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},t.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),X.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),X.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),X.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),X.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,a,r){if(e=+e,t>>>=0,a>>>=0,!r){var o=ya(2,8*a)-1;O(this,e,t,a,o,0)}var n=1,l=0;for(this[t]=255&e;++l<a&&(n*=256);)this[t+l]=255&e/n;return t+a},t.prototype.writeUIntBE=function(e,t,a,r){if(e=+e,t>>>=0,a>>>=0,!r){var o=ya(2,8*a)-1;O(this,e,t,a,o,0)}var n=a-1,l=1;for(this[t+n]=255&e;0<=--n&&(l*=256);)this[t+n]=255&e/l;return t+a},t.prototype.writeUInt8=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,a,r){if(e=+e,t>>>=0,!r){var o=ya(2,8*a-1);O(this,e,t,a,o-1,-o)}var n=0,l=1,s=0;for(this[t]=255&e;++n<a&&(l*=256);)0>e&&0===s&&0!==this[t+n-1]&&(s=1),this[t+n]=255&(e/l>>0)-s;return t+a},t.prototype.writeIntBE=function(e,t,a,r){if(e=+e,t>>>=0,!r){var o=ya(2,8*a-1);O(this,e,t,a,o-1,-o)}var n=a-1,l=1,s=0;for(this[t+n]=255&e;0<=--n&&(l*=256);)0>e&&0===s&&0!==this[t+n+1]&&(s=1),this[t+n]=255&(e/l>>0)-s;return t+a},t.prototype.writeInt8=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},t.prototype.writeInt16LE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,a){return e=+e,t>>>=0,a||O(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,a){return M(this,e,t,!0,a)},t.prototype.writeFloatBE=function(e,t,a){return M(this,e,t,!1,a)},t.prototype.writeDoubleLE=function(e,t,a){return j(this,e,t,!0,a)},t.prototype.writeDoubleBE=function(e,t,a){return j(this,e,t,!1,a)},t.prototype.copy=function(e,a,r,o){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),o||0===o||(o=this.length),a>=e.length&&(a=e.length),a||(a=0),0<o&&o<r&&(o=r),o===r)return 0;if(0===e.length||0===this.length)return 0;if(0>a)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("Index out of range");if(0>o)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-a<o-r&&(o=e.length-a+r);var n=o-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(a,r,o);else if(this===e&&r<a&&a<o)for(var l=n-1;0<=l;--l)e[l+a]=this[l+r];else Uint8Array.prototype.set.call(e,this.subarray(r,o),a);return n},t.prototype.fill=function(e,a,r,o){if("string"==typeof e){if("string"==typeof a?(o=a,a=0,r=this.length):"string"==typeof r&&(o=r,r=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!t.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===e.length){var n=e.charCodeAt(0);("utf8"===o&&128>n||"latin1"===o)&&(e=n)}}else"number"==typeof e&&(e&=255);if(0>a||this.length<a||this.length<r)throw new RangeError("Out of range index");if(r<=a)return this;a>>>=0,r=r===void 0?this.length:r>>>0,e||(e=0);var l;if("number"==typeof e)for(l=a;l<r;++l)this[l]=e;else{var s=t.isBuffer(e)?e:t.from(e,o),d=s.length;if(0===d)throw new TypeError("The value \""+e+"\" is invalid for argument \"value\"");for(l=0;l<r-a;++l)this[l+a]=s[l%d]}return this};var Z=/[^+/0-9A-Za-z-_]/g}).call(this,e("buffer").Buffer)},{"base64-js":74,buffer:105,ieee754:412}],106:[function(e,t){"use strict";function a(t){return[ea(t[0],t[1]),va(t[0],t[1])]}function r(e,t){return e[0]-t[0]||e[1]-t[1]}function o(e){return e.map(a).sort(r)}function n(e,t,a){return t in e?e[t]:a}var l=e("./lib/monotone"),s=e("./lib/triangulation"),d=e("./lib/delaunay"),c=e("./lib/filter");t.exports=function(e,t,a){Array.isArray(t)?(a=a||{},t=t||[]):(a=t||{},t=[]);var r=!!n(a,"delaunay",!0),p=!!n(a,"interior",!0),u=!!n(a,"exterior",!0),g=!!n(a,"infinity",!1);if(!p&&!u||0===e.length)return[];var h=l(e,t);if(r||p!==u||g){for(var m=s(e.length,o(t)),y=0,x;y<h.length;++y)x=h[y],m.addTriangle(x[0],x[1],x[2]);return r&&d(e,m),u?p?g?c(m,0,g):m.cells():c(m,1,g):c(m,-1)}return h}},{"./lib/delaunay":107,"./lib/filter":108,"./lib/monotone":109,"./lib/triangulation":110}],107:[function(e,t){"use strict";function r(e,t,r,i,n,l){var s=t.opposite(i,n);if(!(0>s)){if(n<i){var d=i;i=n,n=d,d=l,l=s,s=d}t.isConstraint(i,n)||0>o(e[i],e[n],e[l],e[s])&&r.push(i,n)}}var o=e("robust-in-sphere")[4],i=e("binary-search-bounds");t.exports=function(e,n){for(var l=[],d=e.length,c=n.stars,p=0,u;p<d;++p){u=c[p];for(var g=1,h;g<u.length;g+=2)if((h=u[g],!(h<p))&&!n.isConstraint(p,h)){for(var m=u[g-1],f=-1,_=1;_<u.length;_+=2)if(u[_-1]===h){f=u[_];break}0>f||0>o(e[p],e[h],e[m],e[f])&&l.push(p,h)}}for(;0<l.length;){for(var h=l.pop(),p=l.pop(),m=-1,f=-1,u=c[p],v=1;v<u.length;v+=2){var w=u[v-1],s=u[v];w===h?f=s:s===h&&(m=w)}0>m||0>f||0<=o(e[p],e[h],e[m],e[f])||(n.flip(p,h),r(e,n,l,m,p,f),r(e,n,l,p,f,m),r(e,n,l,f,h,m),r(e,n,l,h,m,f))}}},{"binary-search-bounds":111,"robust-in-sphere":508}],108:[function(e,t){"use strict";function r(e,t,a,r,o,i,n){this.cells=e,this.neighbor=t,this.flags=r,this.constraint=a,this.active=o,this.next=i,this.boundary=n}function o(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]}function i(e,t){for(var n=e.cells(),l=n.length,s=0;s<l;++s){var d=n[s],p=d[0],u=d[1],g=d[2];u<g?u<p&&(d[0]=u,d[1]=g,d[2]=p):g<p&&(d[0]=g,d[1]=p,d[2]=u)}n.sort(o);for(var h=Array(l),s=0;s<h.length;++s)h[s]=0;var m=[],f=[],_=Array(3*l),v=Array(3*l),k=null;t&&(k=[]);for(var w=new r(n,_,v,h,m,f,k),s=0,d;s<l;++s){d=n[s];for(var T=0;3>T;++T){var p=d[T],u=d[(T+1)%3],A=_[3*s+T]=w.locate(u,p,e.opposite(u,p)),a=v[3*s+T]=e.isConstraint(p,u);0>A&&(a?f.push(s):(m.push(s),h[s]=1),t&&k.push([u,p,-1]))}}return w}function n(e,t,a){for(var r=0,o=0;o<e.length;++o)t[o]===a&&(e[r++]=e[o]);return e.length=r,e}var l=e("binary-search-bounds");t.exports=function(e,a,r){var o=i(e,r);if(0===a)return r?o.cells.concat(o.boundary):o.cells;for(var l=1,s=o.active,d=o.next,p=o.flags,u=o.cells,g=o.constraint,h=o.neighbor;0<s.length||0<d.length;){for(;0<s.length;){var m=s.pop();if(p[m]!==-l){p[m]=l;for(var t=u[m],c=0,y;3>c;++c)y=h[3*m+c],0<=y&&0===p[y]&&(g[3*m+c]?d.push(y):(s.push(y),p[y]=l))}}var x=d;d=s,s=x,d.length=0,l=-l}var _=n(u,p,a);return r?_.concat(o.boundary):_};var s=r.prototype;s.locate=function(){var e=[0,0,0];return function(t,a,r){var i=t,n=a,s=r;return(a<r?a<t&&(i=a,n=r,s=t):r<t&&(i=r,n=t,s=a),0>i)?-1:(e[0]=i,e[1]=n,e[2]=s,l.eq(this.cells,e,o))}}()},{"binary-search-bounds":111}],109:[function(e,t){"use strict";function a(e,t,a,r,o){this.a=e,this.b=t,this.idx=a,this.lowerIds=r,this.upperIds=o}function r(e,t,a,r){this.a=e,this.b=t,this.type=a,this.idx=r}function o(e,t){var a=e.a[0]-t.a[0]||e.a[1]-t.a[1]||e.type-t.type;return a?a:0!==e.type&&(a=g(e.a,e.b,t.b),a)?a:e.idx-t.idx}function n(e,t){return g(e.a,e.b,t)}function l(e,t,a,r,o){for(var l=u.lt(t,r,n),s=u.gt(t,r,n),d=l;d<s;++d){for(var c=t[d],p=c.lowerIds,h=p.length;1<h&&0<g(a[p[h-2]],a[p[h-1]],r);)e.push([p[h-1],p[h-2],o]),h-=1;p.length=h,p.push(o);for(var y=c.upperIds,h=y.length;1<h&&0>g(a[y[h-2]],a[y[h-1]],r);)e.push([y[h-2],y[h-1],o]),h-=1;y.length=h,y.push(o)}}function s(e,t){var a;return(a=e.a[0]<t.a[0]?g(e.a,e.b,t.a):g(t.b,t.a,e.a),a)?a:(a=t.b[0]<e.b[0]?g(e.a,e.b,t.b):g(t.b,t.a,e.b),a||e.idx-t.idx)}function d(e,t,r){var o=u.le(e,r,s),i=e[o],n=i.upperIds,l=n[n.length-1];i.upperIds=[l],e.splice(o+1,0,new a(r.a,r.b,r.idx,[l],n))}function c(e,t,a){var r=a.a;a.a=a.b,a.b=r;var o=u.eq(e,a,s),i=e[o],n=e[o-1];n.upperIds=i.upperIds,e.splice(o,1)}var u=e("binary-search-bounds"),g=e("robust-orientation")[3];t.exports=function(t,n){for(var s=t.length,p=n.length,u=[],g=0;g<s;++g)u.push(new r(t[g],null,0,g));for(var g=0;g<p;++g){var h=n[g],e=t[h[0]],m=t[h[1]];e[0]<m[0]?u.push(new r(e,m,2,g),new r(m,e,1,g)):e[0]>m[0]&&u.push(new r(m,e,2,g),new r(e,m,1,g))}u.sort(o);for(var y=u[0].a[0]-(1+_a(u[0].a[0]))*ya(2,-52),f=[new a([y,1],[y,0],-1,[],[],[],[])],x=[],g=0,_=u.length;g<_;++g){var b=u[g],v=b.type;v===0?l(x,f,t,b.a,b.idx):v===2?d(f,t,b):c(f,t,b)}return x}},{"binary-search-bounds":111,"robust-orientation":510}],110:[function(e,t){"use strict";function a(e,t){this.stars=e,this.edges=t}function r(e,t,a){for(var r=1,o=e.length;r<o;r+=2)if(e[r-1]===t&&e[r]===a)return e[r-1]=e[o-2],e[r]=e[o-1],void(e.length=o-2)}var o=e("binary-search-bounds");t.exports=function(e,t){for(var r=Array(e),o=0;o<e;++o)r[o]=[];return new a(r,t)};var i=a.prototype;i.isConstraint=function(){function t(e,t){return e[0]-t[0]||e[1]-t[1]}var a=[0,0];return function(e,r){return a[0]=ea(e,r),a[1]=va(e,r),0<=o.eq(this.edges,a,t)}}(),i.removeTriangle=function(e,t,a){var o=this.stars;r(o[e],t,a),r(o[t],a,e),r(o[a],e,t)},i.addTriangle=function(e,t,a){var r=this.stars;r[e].push(t,a),r[t].push(a,e),r[a].push(e,t)},i.opposite=function(e,t){for(var a=this.stars[t],r=1,o=a.length;r<o;r+=2)if(a[r]===e)return a[r-1];return-1},i.flip=function(e,t){var r=this.opposite(e,t),a=this.opposite(t,e);this.removeTriangle(e,t,r),this.removeTriangle(t,e,a),this.addTriangle(e,a,r),this.addTriangle(t,r,a)},i.edges=function(){for(var e=this.stars,t=[],a=0,r=e.length,o;a<r;++a){o=e[a];for(var n=0,l=o.length;n<l;n+=2)t.push([o[n],o[n+1]])}return t},i.cells=function(){for(var e=this.stars,a=[],r=0,o=e.length,n;r<o;++r){n=e[r];for(var l=0,d=n.length;l<d;l+=2){var c=n[l],s=n[l+1];r<ea(c,s)&&a.push([r,c,s])}}return a}},{"binary-search-bounds":111}],111:[function(e,t){"use strict";function a(e,t,a,r,o){var i=["function ",e,"(a,l,h,",r.join(","),"){",o?"":"var i=",a?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return o?0>t.indexOf("c")?i.push(";if(x===y){return m}else if(x<=y){"):i.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):i.push(";if(",t,"){i=m;"),a?i.push("l=m+1}else{h=m-1}"):i.push("h=m-1}else{l=m+1}"),i.push("}"),o?i.push("return -1};"):i.push("return i};"),i.join("")}function r(e,t,r,o){var i=new Function([a("A","x"+e+"y",t,["y"],o),a("P","c(x,y)"+e+"0",t,["y","c"],o),"function dispatchBsearch",r,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",r].join(""));return i()}t.exports={ge:r(">=",!1,"GE"),gt:r(">",!1,"GT"),lt:r("<",!0,"LT"),le:r("<=",!0,"LE"),eq:r("-",!0,"EQ",!0)}},{}],112:[function(e,t){"use strict";t.exports=function(e){for(var t=1,a=1;a<e.length;++a)for(var r=0;r<a;++r)if(e[a]<e[r])t=-t;else if(e[r]===e[a])return 0;return t}},{}],113:[function(e,t){"use strict";function a(e,t){for(var a=0,r=e.length,o=0;o<r;++o)a+=e[o]*t[o];return a}function r(e){var t=e.length;if(0===t)return[];var r=e[0].length,o=n([e.length+1,e.length+1],1),s=n([e.length+1],1);o[t][t]=0;for(var d=0;d<t;++d){for(var c=0;c<=d;++c)o[c][d]=o[d][c]=2*a(e[d],e[c]);s[d]=a(e[d],e[d])}for(var p=l(o,s),u=0,g=p[t+1],d=0;d<g.length;++d)u+=g[d];for(var m=Array(t),d=0;d<t;++d){for(var g=p[d],y=0,c=0;c<g.length;++c)y+=g[c];m[d]=y/u}return m}function o(e){if(0===e.length)return[];for(var t=e[0].length,a=n([t]),o=r(e),l=0;l<e.length;++l)for(var s=0;s<t;++s)a[s]+=e[l][s]*o[l];return a}var n=e("dup"),l=e("robust-linear-solve");o.barycenetric=r,t.exports=o},{dup:170,"robust-linear-solve":509}],114:[function(e,t){t.exports=function(e){for(var t=a(e),r=0,o=0,n;o<e.length;++o){n=e[o];for(var l=0;l<t.length;++l)r+=ya(n[l]-t[l],2)}return N(r/e.length)};var a=e("circumcenter")},{circumcenter:113}],115:[function(e,t){t.exports=function(e,t,a){return t<a?e<t?t:e>a?a:e:e<a?a:e>t?t:e}},{}],116:[function(e,t){"use strict";function a(e){var t=_(e);return[v(t,-Infinity),v(t,1/0)]}function r(t,r){for(var o=Array(r.length),n=0;n<r.length;++n){var l=r[n],e=t[l[0]],a=t[l[1]];o[n]=[v(ea(e[0],a[0]),-Infinity),v(ea(e[1],a[1]),-Infinity),v(va(e[0],a[0]),1/0),v(va(e[1],a[1]),1/0)]}return o}function o(e){for(var t=Array(e.length),a=0,r;a<e.length;++a)r=e[a],t[a]=[v(r[0],-Infinity),v(r[1],-Infinity),v(r[0],1/0),v(r[1],1/0)];return t}function i(t,r,o){var n=[];return m(o,function(o,i){var l=r[o],e=r[i];if(l[0]!==e[0]&&l[0]!==e[1]&&l[1]!==e[0]&&l[1]!==e[1]){var s=t[l[0]],a=t[l[1]],p=t[e[0]],c=t[e[1]];y(s,a,p,c)&&n.push([o,i])}}),n}function n(t,r,o,i){var n=[];return m(o,i,function(o,i){var l=r[o];if(l[0]!==i&&l[1]!==i){var e=t[i],s=t[l[0]],a=t[l[1]];y(s,a,e,e)&&n.push([o,i])}}),n}function l(r,o,n,l,d){var c=r.map(function(e){return[f(e[0]),f(e[1])]}),p,u;for(p=0;p<n.length;++p){var g=n[p];u=g[0];var h=g[1],m=o[u],y=o[h],v=k(b(r[m[0]]),b(r[m[1]]),b(r[y[0]]),b(r[y[1]]));if(v){var w=r.length;r.push([_(v[0]),_(v[1])]),c.push(v),l.push([u,w],[h,w])}}for(l.sort(function(e,t){if(e[0]!==t[0])return e[0]-t[0];var a=c[e[1]],r=c[t[1]];return x(a[0],r[0])||x(a[1],r[1])}),p=l.length-1;0<=p;--p){var T=l[p];u=T[0];var A=o[u],S=A[0],C=A[1],L=r[S],a=r[C];if(0>(L[0]-a[0]||L[1]-a[1])){var E=S;S=C,C=E}A[0]=S;var I=A[1]=T[1],z;for(d&&(z=A[2]);0<p&&l[p-1][0]===u;){var T=l[--p],P=T[1];d?o.push([I,P,z]):o.push([I,P]),I=P}d?o.push([I,C,z]):o.push([I,C])}return c}function s(e,t){for(var r=t.length,o=new h(r),n=[],l=0;l<t.length;++l){var s=t[l],d=a(s[0]),c=a(s[1]);n.push([v(d[0],-Infinity),v(c[0],-Infinity),v(d[1],1/0),v(c[1],1/0)])}m(n,function(e,t){o.link(e,t)});for(var p=!0,u=Array(r),l=0,g;l<r;++l)g=o.find(l),g!==l&&(p=!1,e[g]=[ea(e[l][0],e[g][0]),ea(e[l][1],e[g][1])]);if(p)return null;for(var y=0,l=0,g;l<r;++l)g=o.find(l),g===l?(u[l]=y,e[y++]=e[l]):u[l]=-1;e.length=y;for(var l=0;l<r;++l)0>u[l]&&(u[l]=u[o.find(l)]);return u}function d(e,t){return e[0]-t[0]||e[1]-t[1]}function c(e,t){var a=e[0]-t[0]||e[1]-t[1];if(a)return a;return e[2]<t[2]?-1:e[2]>t[2]?1:0}function p(t,r,o){if(0!==t.length){if(r)for(var n=0;n<t.length;++n){var l=t[n],s=r[l[0]],p=r[l[1]];l[0]=ea(s,p),l[1]=va(s,p)}else for(var n=0;n<t.length;++n){var l=t[n],s=l[0],p=l[1];l[0]=ea(s,p),l[1]=va(s,p)}o?t.sort(c):t.sort(d);for(var u=1,n=1;n<t.length;++n){var g=t[n-1],h=t[n];(h[0]!==g[0]||h[1]!==g[1]||o&&h[2]!==g[2])&&(t[u++]=h)}t.length=u}}function u(e,t,a){var r=s(e,[],o(e));return p(t,r,a),!!r}function g(e,t,a){var d=r(e,t),c=i(e,t,d),u=o(e),g=n(e,t,d,u),h=l(e,t,c,g,a),m=s(e,h,u);return p(t,m,a),!!m||0<c.length||0<g.length}t.exports=function(t,a,r){var o;if(r){o=a;for(var n=Array(a.length),l=0,s;l<a.length;++l)s=a[l],n[l]=[s[0],s[1],r[l]];a=n}for(var d=u(t,a,!!r);g(t,a,!!r);)d=!0;if(!!r&&d){o.length=0,r.length=0;for(var l=0,s;l<a.length;++l)s=a[l],o.push([s[0],s[1]]),r.push(s[2])}return d};var h=e("union-find"),m=e("box-intersect"),y=e("robust-segment-intersect"),f=e("big-rat"),x=e("big-rat/cmp"),_=e("big-rat/to-float"),b=e("rat-vec"),v=e("nextafter"),k=e("./lib/rat-seg-intersect")},{"./lib/rat-seg-intersect":117,"big-rat":78,"big-rat/cmp":76,"big-rat/to-float":90,"box-intersect":96,nextafter:451,"rat-vec":486,"robust-segment-intersect":513,"union-find":546}],117:[function(e,t){"use strict";function o(e,t){return l(i(e[0],t[1]),i(e[1],t[0]))}t.exports=function(e,a,i,l){var d=u(a,e),c=u(l,i),m=o(d,c);if(0===p(m))return null;var y=u(e,i),f=o(c,y),x=n(f,m),t=h(d,x),s=g(e,t);return s};var i=e("big-rat/mul"),n=e("big-rat/div"),l=e("big-rat/sub"),p=e("big-rat/sign"),u=e("rat-vec/sub"),g=e("rat-vec/add"),h=e("rat-vec/muls")},{"big-rat/div":77,"big-rat/mul":87,"big-rat/sign":88,"big-rat/sub":89,"rat-vec/add":485,"rat-vec/muls":487,"rat-vec/sub":488}],118:[function(e,t){"use strict";function a(e,t){null==t&&(t=!0);var i=e[0],l=e[1],s=e[2],d=e[3];null==d&&(d=t?1:255),t&&(i*=255,l*=255,s*=255,d*=255),i=255&o(i,0,255),l=255&o(l,0,255),s=255&o(s,0,255),d=255&o(d,0,255);var c=16777216*i+(l<<16)+(s<<8)+d;return c}var o=e("clamp");t.exports=a,t.exports.to=a,t.exports.from=function(e,t){e=+e;var o=e>>>24,r=(16711680&e)>>>16,i=(65280&e)>>>8,l=255&e;return!1===t?[o,r,i,l]:[o/255,r/255,i/255,l/255]}},{clamp:115}],119:[function(e,t){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],120:[function(e,t){"use strict";function a(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray)||!!(Array.isArray(e)&&(1<e[0]||0===e[0])&&(1<e[1]||0===e[1])&&(1<e[2]||0===e[2])&&(!e[3]||1<e[3]))}var r=e("color-rgba"),o=e("clamp"),i=e("dtype");t.exports=function e(t,n){"float"!==n&&n||(n="array"),"uint"===n&&(n="uint8"),"uint_clamped"===n&&(n="uint8_clamped");var l=i(n),s=new l(4),e="uint8"!==n&&"uint8_clamped"!==n;return(t.length&&"string"!=typeof t||(t=r(t),t[0]/=255,t[1]/=255,t[2]/=255),a(t))?(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=null==t[3]?255:t[3],e&&(s[0]/=255,s[1]/=255,s[2]/=255,s[3]/=255),s):(e?(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=null==t[3]?1:t[3]):(s[0]=o(ba(255*t[0]),0,255),s[1]=o(ba(255*t[1]),0,255),s[2]=o(ba(255*t[2]),0,255),s[3]=null==t[3]?255:o(ba(255*t[3]),0,255)),s)}},{clamp:115,"color-rgba":122,dtype:169}],121:[function(e,t){(function(a){"use strict";var o=e("color-name"),i=e("is-plain-obj"),n=e("defined");t.exports=function(e){var t=[],s=1,d,c;if("string"==typeof e){if(o[e])t=o[e].slice(),c="rgb";else if("transparent"===e)s=0,c="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var p=e.slice(1),u=p.length,g=4>=u;s=1,g?(t=[parseInt(p[0]+p[0],16),parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16)],4===u&&(s=parseInt(p[3]+p[3],16)/255)):(t=[parseInt(p[0]+p[1],16),parseInt(p[2]+p[3],16),parseInt(p[4]+p[5],16)],8===u&&(s=parseInt(p[6]+p[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),c="rgb"}else if(d=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var h=d[1],p=h.replace(/a$/,"");c=p;var u="cmyk"===p?4:"gray"===p?1:3;t=d[2].trim().split(/\s*,\s*/).map(function(e,t){if(/%$/.test(e))return t===u?parseFloat(e)/100:"rgb"===p?255*parseFloat(e)/100:parseFloat(e);if("h"===p[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==l[e])return l[e]}return parseFloat(e)}),h===p&&t.push(1),s="rgb"===h?1:void 0===t[u]?1:t[u],t=t.slice(0,u)}else 10<e.length&&/[0-9](?:\s|\/)/.test(e)&&(t=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),c=e.match(/([a-z])/ig).join("").toLowerCase());}else if(!isNaN(e))c="rgb",t=[e>>>16,(65280&e)>>>8,255&e];else if(i(e)){var y=n(e.r,e.red,e.R,null);null===y?(c="hsl",t=[n(e.h,e.hue,e.H),n(e.s,e.saturation,e.S),n(e.l,e.lightness,e.L,e.b,e.brightness)]):(c="rgb",t=[y,n(e.g,e.green,e.G),n(e.b,e.blue,e.B)]),s=n(e.a,e.alpha,e.opacity,1),null!=e.opacity&&(s/=100)}else(Array.isArray(e)||a.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e))&&(t=[e[0],e[1],e[2]],c="rgb",s=4===e.length?e[3]:1);return{space:c,values:t,alpha:s}};var l={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"color-name":119,defined:164,"is-plain-obj":422}],122:[function(e,t){"use strict";var a=e("color-parse"),r=e("color-space/hsl"),o=e("clamp");t.exports=function(e){var t=a(e),i;return t.space?(i=[,,,],i[0]=o(t.values[0],0,255),i[1]=o(t.values[1],0,255),i[2]=o(t.values[2],0,255),"h"===t.space[0]&&(i=r.rgb(i)),i.push(o(t.alpha,0,1)),i):[]}},{clamp:115,"color-parse":121,"color-space/hsl":123}],123:[function(e,t){"use strict";var a=e("./rgb");t.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t=e[0]/360,a=e[1]/100,r=e[2]/100,o,n,l,s,d;if(0==a)return d=255*r,[d,d,d];n=.5>r?r*(1+a):r+a-r*a,o=2*r-n,s=[0,0,0];for(var c=0;3>c;c++)l=t+1/3*-(c-1),0>l?l++:1<l&&l--,d=1>6*l?o+6*(n-o)*l:1>2*l?n:2>3*l?o+6*((n-o)*(2/3-l)):o,s[c]=255*d;return s}},a.hsl=function(e){var t=e[0]/255,a=e[1]/255,r=e[2]/255,o=ea(t,a,r),i=va(t,a,r),n=i-o,d,c,p;return i===o?d=0:t===i?d=(a-r)/n:a===i?d=2+(r-t)/n:r===i&&(d=4+(t-a)/n),d=ea(60*d,360),0>d&&(d+=360),p=(o+i)/2,c=i===o?0:.5>=p?n/(i+o):n/(2-i-o),[d,100*c,100*p]}},{"./rgb":124}],124:[function(e,t){"use strict";t.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],125:[function(e,t){t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],126:[function(e,t){"use strict";function a(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function r(e){for(var t="#",a=0,r;3>a;++a)r=e[a],r=r.toString(16),t+=("00"+r).substr(r.length);return t}function o(e){return"rgba("+e.join(",")+")"}var i=e("./colorScale"),n=e("lerp");t.exports=function(e){var t,l,s,d,p,u,g,h,m,y,f;if(e||(e={}),h=(e.nshades||72)-1,g=e.format||"hex",u=e.colormap,u||(u="jet"),"string"==typeof u){if(u=u.toLowerCase(),!i[u])throw Error(u+" not a supported colorscale");p=i[u]}else if(Array.isArray(u))p=u.slice();else throw Error("unsupported colormap option",u);if(p.length>h+1)throw new Error(u+" map requires nshades to be at least size "+p.length);y=Array.isArray(e.alpha)?2===e.alpha.length?e.alpha.slice():[1,1]:"number"==typeof e.alpha?[e.alpha,e.alpha]:[1,1],t=p.map(function(e){return V(e.index*h)}),y[0]=ea(va(y[0],0),1),y[1]=ea(va(y[1],0),1);var c=p.map(function(e,t){var a=p[t].index,r=p[t].rgb.slice();return 4===r.length&&0<=r[3]&&1>=r[3]?r:(r[3]=y[0]+(y[1]-y[0])*a,r)}),m=[];for(f=0;f<t.length-1;++f){d=t[f+1]-t[f],l=c[f],s=c[f+1];for(var x=0,_;x<d;x++)_=x/d,m.push([V(n(l[0],s[0],_)),V(n(l[1],s[1],_)),V(n(l[2],s[2],_)),n(l[3],s[3],_)])}return m.push(p[p.length-1].rgb.concat(y[1])),"hex"===g?m=m.map(r):"rgbaString"===g?m=m.map(o):"float"===g&&(m=m.map(a)),m}},{"./colorScale":125,lerp:425}],127:[function(e,t){"use strict";function r(e,t,a){var r=n(e[0],-t[0]),o=n(e[1],-t[1]),i=n(a[0],-t[0]),c=n(a[1],-t[1]),p=s(l(r,i),l(o,c));return 0<=p[p.length-1]}t.exports=function(e,t,a,n){var l=o(t,a,n);if(0===l){var s=i(o(e,t,a)),d=i(o(e,t,n));if(s===d){if(0===s){var c=r(e,t,a),p=r(e,t,n);return c===p?0:c?1:-1}return 0}return 0===d?0<s?-1:r(e,t,n)?-1:1:0===s?0<d?1:r(e,t,a)?1:-1:i(d-s)}var u=o(e,t,a);if(0<u)return 0<l&&0<o(e,t,n)?1:-1;if(0>u)return 0<l||0<o(e,t,n)?1:-1;var g=o(e,t,n);return 0<g?1:r(e,t,a)?1:-1};var o=e("robust-orientation"),i=e("signum"),n=e("two-sum"),l=e("robust-product"),s=e("robust-sum")},{"robust-orientation":510,"robust-product":511,"robust-sum":515,signum:516,"two-sum":544}],128:[function(e,t){function r(e,t){return e-t}t.exports=function(e,a){var l=e.length,n=e.length-a.length;if(n)return n;switch(l){case 0:return 0;case 1:return e[0]-a[0];case 2:return e[0]+e[1]-a[0]-a[1]||o(e[0],e[1])-o(a[0],a[1]);case 3:var s=e[0]+e[1],d=a[0]+a[1];if(n=s+e[2]-(d+a[2]),n)return n;var c=o(e[0],e[1]),p=o(a[0],a[1]);return o(c,e[2])-o(p,a[2])||o(c+e[2],s)-o(p+a[2],d);case 4:var u=e[0],g=e[1],h=e[2],m=e[3],y=a[0],f=a[1],x=a[2],_=a[3];return u+g+h+m-(y+f+x+_)||o(u,g,h,m)-o(y,f,x,_,y)||o(u+g,u+h,u+m,g+h,g+m,h+m)-o(y+f,y+x,y+_,f+x,f+_,x+_)||o(u+g+h,u+g+m,u+h+m,g+h+m)-o(y+f+x,y+f+_,y+x+_,f+x+_);default:for(var b=e.slice().sort(r),v=a.slice().sort(r),k=0;k<l;++k)if(n=b[k]-v[k],n)return n;return 0;}};var o=ea},{}],129:[function(e,t){"use strict";var r=e("compare-cell"),o=e("cell-orientation");t.exports=function(e,t){return r(e,t)||o(e)-o(t)}},{"cell-orientation":112,"compare-cell":128}],130:[function(e,t){"use strict";var a=e("./lib/ch1d"),r=e("./lib/ch2d"),o=e("./lib/chnd");t.exports=function(e){var t=e.length;if(0===t)return[];if(1===t)return[[0]];var i=e[0].length;if(0===i)return[];return 1===i?a(e):2===i?r(e):o(e,i)}},{"./lib/ch1d":131,"./lib/ch2d":132,"./lib/chnd":133}],131:[function(e,t){"use strict";t.exports=function(e){for(var t=0,a=0,r=1;r<e.length;++r)e[r][0]<e[t][0]&&(t=r),e[r][0]>e[a][0]&&(a=r);return t<a?[[t],[a]]:t>a?[[a],[t]]:[[t]]}},{}],132:[function(e,t){"use strict";t.exports=function(e){var t=r(e),o=t.length;if(2>=o)return[];for(var n=Array(o),l=t[o-1],s=0,d;s<o;++s)d=t[s],n[s]=[l,d],l=d;return n};var r=e("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":434}],133:[function(e,t){"use strict";function a(e,t){for(var a=e.length,r=Array(a),o=0;o<t.length;++o)r[o]=e[t[o]];for(var n=t.length,o=0;o<a;++o)0>t.indexOf(o)&&(r[n++]=e[o]);return r}function r(e,t){for(var a=e.length,r=t.length,o=0,n;o<a;++o){n=e[o];for(var l=0,s;l<n.length;++l)if(s=n[l],s<r)n[l]=t[s];else{s-=r;for(var d=0;d<r;++d)s>=t[d]&&(s+=1);n[l]=s}}return e}t.exports=function(t,n){try{return o(t,!0)}catch(c){var l=i(t);if(l.length<=n)return[];var s=a(t,l),d=o(s,!0);return r(d,l)}};var o=e("incremental-convex-hull"),i=e("affine-hull")},{"affine-hull":62,"incremental-convex-hull":413}],134:[function(e,t){t.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],135:[function(e,t){t.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],136:[function(e,t){t.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],137:[function(e,t){t.exports=["normal","italic","oblique"]},{}],138:[function(e,t){t.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],139:[function(e,t){"use strict";t.exports={parse:e("./parse"),stringify:e("./stringify")}},{"./parse":141,"./stringify":142}],140:[function(e,t){"use strict";var a=e("css-font-size-keywords");t.exports={isSize:function(e){return /^[\d\.]/.test(e)||-1!==e.indexOf("/")||-1!==a.indexOf(e)}}},{"css-font-size-keywords":135}],141:[function(e,t){"use strict";function a(e){if("string"!=typeof e)throw new Error("Font argument must be a string.");if(u[e])return u[e];if(""===e)throw new Error("Cannot parse an empty string.");if(-1!==n.indexOf(e))return u[e]={system:e};for(var t={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},a=c(e,/\s+/),g;g=a.shift();){if(-1!==i.indexOf(g))return["style","variant","weight","stretch"].forEach(function(e){t[e]=g}),u[e]=t;if(-1!==s.indexOf(g)){t.style=g;continue}if("normal"===g||"small-caps"===g){t.variant=g;continue}if(-1!==d.indexOf(g)){t.stretch=g;continue}if(-1!==l.indexOf(g)){t.weight=g;continue}if(p(g)){var h=c(g,"/");if(t.size=h[0],null==h[1]?"/"===a[0]&&(a.shift(),t.lineHeight=r(a.shift())):t.lineHeight=r(h[1]),!a.length)throw new Error("Missing required font-family.");return t.family=c(a.join(" "),/\s*,\s*/).map(o),u[e]=t}throw new Error("Unknown or unsupported font token: "+g)}throw new Error("Missing required font-size.")}function r(e){var t=parseFloat(e);return t.toString()===e?t:e}var o=e("unquote"),i=e("css-global-keywords"),n=e("css-system-font-keywords"),l=e("css-font-weight-keywords"),s=e("css-font-style-keywords"),d=e("css-font-stretch-keywords"),c=e("string-split-by"),p=e("./lib/util").isSize;t.exports=a;var u=a.cache={}},{"./lib/util":140,"css-font-stretch-keywords":136,"css-font-style-keywords":137,"css-font-weight-keywords":138,"css-global-keywords":143,"css-system-font-keywords":144,"string-split-by":529,unquote:548}],142:[function(e,t){"use strict";function a(e,t){if(e&&!t[e]&&!l[e])throw Error("Unknown keyword `"+e+"`");return e}function r(e){for(var t={},a=0;a<e.length;a++)t[e[a]]=1;return t}var i=e("pick-by-alias"),n=e("./lib/util").isSize,l=r(e("css-global-keywords")),s=r(e("css-system-font-keywords")),d=r(e("css-font-weight-keywords")),c=r(e("css-font-style-keywords")),p=r(e("css-font-stretch-keywords")),u={normal:1,"small-caps":1},g={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},h={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};t.exports=function(e){if(e=i(e,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),e.system)return e.system&&a(e.system,s),e.system;if(a(e.style,c),a(e.variant,u),a(e.weight,d),a(e.stretch,p),null==e.size&&(e.size=h.size),"number"==typeof e.size&&(e.size+="px"),!n)throw Error("Bad size value `"+e.size+"`");e.family||(e.family=h.family),Array.isArray(e.family)&&(!e.family.length&&(e.family=[h.family]),e.family=e.family.map(function(e){return g[e]?e:"\""+e+"\""}).join(", "));var t=[];return t.push(e.style),e.variant!==e.style&&t.push(e.variant),e.weight!==e.variant&&e.weight!==e.style&&t.push(e.weight),e.stretch!==e.weight&&e.stretch!==e.variant&&e.stretch!==e.style&&t.push(e.stretch),t.push(e.size+(null==e.lineHeight||"normal"===e.lineHeight||"1"==e.lineHeight+""?"":"/"+e.lineHeight)),t.push(e.family),t.filter(Boolean).join(" ")}},{"./lib/util":140,"css-font-stretch-keywords":136,"css-font-style-keywords":137,"css-font-weight-keywords":138,"css-global-keywords":143,"css-system-font-keywords":144,"pick-by-alias":465}],143:[function(e,t){t.exports=["inherit","initial","unset"]},{}],144:[function(e,t){t.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],145:[function(e,t){"use strict";t.exports=function(e,a,r,o,n,t){var l=n-1,s=n*n,d=l*l,c=(1+2*n)*d,p=n*d,u=s*(3-2*n),g=s*l;if(e.length){t||(t=Array(e.length));for(var h=e.length-1;0<=h;--h)t[h]=c*e[h]+p*a[h]+u*r[h]+g*o[h];return t}return c*e+p*a+u*r+g*o},t.exports.derivative=function(e,a,r,o,n,t){var l=6*n*n-6*n,s=3*n*n-4*n+1,d=-6*n*n+6*n,c=3*n*n-2*n;if(e.length){t||(t=Array(e.length));for(var p=e.length-1;0<=p;--p)t[p]=l*e[p]+s*a[p]+d*r[p]+c*o[p];return t}return l*e+s*a+d*r[p]+c*o}},{}],146:[function(e,t){"use strict";function a(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}var r=e("./lib/thunk.js");t.exports=function(e){var t=new a;t.pre=e.pre,t.body=e.body,t.post=e.post;var o=e.args.slice(0);t.argTypes=o;for(var n=0,l;n<o.length;++n)if(l=o[n],"array"===l||"object"==typeof l&&l.blockIndices){if(t.argTypes[n]="array",t.arrayArgs.push(n),t.arrayBlockIndices.push(l.blockIndices?l.blockIndices:0),t.shimArgs.push("array"+n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array args");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===l)t.scalarArgs.push(n),t.shimArgs.push("scalar"+n);else if("index"===l){if(t.indexArgs.push(n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array index");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array index");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array index")}else if("shape"===l){if(t.shapeArgs.push(n),n<t.pre.args.length&&t.pre.args[n].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array shape");if(n<t.post.args.length&&t.post.args[n].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if("object"==typeof l&&l.offset)t.argTypes[n]="offset",t.offsetArgs.push({array:l.array,offset:l.offset}),t.offsetArgIndex.push(n);else throw new Error("cwise: Unknown argument type "+o[n]);if(0>=t.arrayArgs.length)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>o.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>o.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>o.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,r(t)}},{"./lib/thunk.js":148}],147:[function(e,t){"use strict";function a(e,t,a){var r=e.length,o=t.arrayArgs.length,n=0<t.indexArgs.length,l=[],s=[],d=0,c=0,p,u;for(p=0;p<r;++p)s.push(["i",p,"=0"].join(""));for(u=0;u<o;++u)for(p=0;p<r;++p)c=d,d=e[p],0===p?s.push(["d",u,"s",p,"=t",u,"p",d].join("")):s.push(["d",u,"s",p,"=(t",u,"p",d,"-s",c,"*t",u,"p",c,")"].join(""));for(0<s.length&&l.push("var "+s.join(",")),p=r-1;0<=p;--p)d=e[p],l.push(["for(i",p,"=0;i",p,"<s",d,";++i",p,"){"].join(""));for(l.push(a),p=0;p<r;++p){for(c=d,d=e[p],u=0;u<o;++u)l.push(["p",u,"+=d",u,"s",p].join(""));n&&(0<p&&l.push(["index[",c,"]-=s",c].join("")),l.push(["++index[",d,"]"].join(""))),l.push("}")}return l.join("\n")}function r(e,t,r,o){for(var n=t.length,l=r.arrayArgs.length,s=r.blockSize,d=0<r.indexArgs.length,c=[],p=0;p<l;++p)c.push(["var offset",p,"=p",p].join(""));for(var p=e;p<n;++p)c.push(["for(var j"+p+"=SS[",t[p],"]|0;j",p,">0;){"].join("")),c.push(["if(j",p,"<",s,"){"].join("")),c.push(["s",t[p],"=j",p].join("")),c.push(["j",p,"=0"].join("")),c.push(["}else{s",t[p],"=",s].join("")),c.push(["j",p,"-=",s,"}"].join("")),d&&c.push(["index[",t[p],"]=j",p].join(""));for(var p=0,u;p<l;++p){u=["offset"+p];for(var g=e;g<n;++g)u.push(["j",g,"*t",p,"p",t[g]].join(""));c.push(["p",p,"=(",u.join("+"),")"].join(""))}c.push(a(t,r,o));for(var p=e;p<n;++p)c.push("}");return c.join("\n")}function o(e){for(var t=0,a=e[0].length;t<a;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}function n(e,t,a){for(var r=e.body,o=[],n=[],l=0,s;l<e.args.length;++l)if(s=e.args[l],!(0>=s.count)){var d=new RegExp(s.name,"g"),c="",p=t.arrayArgs.indexOf(l);switch(t.argTypes[l]){case"offset":var u=t.offsetArgIndex.indexOf(l),g=t.offsetArgs[u];p=g.array,c="+q"+u;case"array":c="p"+p+c;var h="l"+l,m="a"+p;if(0===t.arrayBlockIndices[p])1===s.count?"generic"===a[p]?s.lvalue?(o.push(["var ",h,"=",m,".get(",c,")"].join("")),r=r.replace(d,h),n.push([m,".set(",c,",",h,")"].join(""))):r=r.replace(d,[m,".get(",c,")"].join("")):r=r.replace(d,[m,"[",c,"]"].join("")):"generic"===a[p]?(o.push(["var ",h,"=",m,".get(",c,")"].join("")),r=r.replace(d,h),s.lvalue&&n.push([m,".set(",c,",",h,")"].join(""))):(o.push(["var ",h,"=",m,"[",c,"]"].join("")),r=r.replace(d,h),s.lvalue&&n.push([m,"[",c,"]=",h].join("")));else{for(var y=[s.name],f=[c],x=0;x<_a(t.arrayBlockIndices[p]);x++)y.push("\\s*\\[([^\\]]+)\\]"),f.push("$"+(x+1)+"*t"+p+"b"+x);if(d=new RegExp(y.join(""),"g"),c=f.join("+"),"generic"===a[p])throw new Error("cwise: Generic arrays not supported in combination with blocks!");else r=r.replace(d,[m,"[",c,"]"].join(""))}break;case"scalar":r=r.replace(d,"Y"+t.scalarArgs.indexOf(l));break;case"index":r=r.replace(d,"index");break;case"shape":r=r.replace(d,"shape");}}return[o.join("\n"),r,n.join("\n")].join("\n").trim()}function l(e){for(var a=Array(e.length),r=!0,o=0;o<e.length;++o){var n=e[o],t=n.match(/\d+/);t=t?t[0]:"",a[o]=0===n.charAt(0)?"u"+n.charAt(1)+t:n.charAt(0)+t,0<o&&(r=r&&a[o]===a[o-1])}return r?a[0]:a.join("")}var s=e("uniq");t.exports=function(e,t){for(var d=0|t[1].length-_a(e.arrayBlockIndices[0]),c=Array(e.arrayArgs.length),p=Array(e.arrayArgs.length),u=0;u<e.arrayArgs.length;++u)p[u]=t[2*u],c[u]=t[2*u+1];for(var g=[],h=[],m=[],y=[],x=[],u=0;u<e.arrayArgs.length;++u){0>e.arrayBlockIndices[u]?(m.push(0),y.push(d),g.push(d),h.push(d+e.arrayBlockIndices[u])):(m.push(e.arrayBlockIndices[u]),y.push(e.arrayBlockIndices[u]+d),g.push(0),h.push(e.arrayBlockIndices[u]));for(var _=[],b=0;b<c[u].length;b++)m[u]<=c[u][b]&&c[u][b]<y[u]&&_.push(c[u][b]-m[u]);x.push(_)}for(var v=["SS"],k=["'use strict'"],w=[],b=0;b<d;++b)w.push(["s",b,"=SS[",b,"]"].join(""));for(var u=0;u<e.arrayArgs.length;++u){v.push("a"+u),v.push("t"+u),v.push("p"+u);for(var b=0;b<d;++b)w.push(["t",u,"p",b,"=t",u,"[",m[u]+b,"]"].join(""));for(var b=0;b<_a(e.arrayBlockIndices[u]);++b)w.push(["t",u,"b",b,"=t",u,"[",g[u]+b,"]"].join(""))}for(var u=0;u<e.scalarArgs.length;++u)v.push("Y"+u);if(0<e.shapeArgs.length&&w.push("shape=SS.slice(0)"),0<e.indexArgs.length){for(var T=Array(d),u=0;u<d;++u)T[u]="0";w.push(["index=[",T.join(","),"]"].join(""))}for(var u=0;u<e.offsetArgs.length;++u){for(var A=e.offsetArgs[u],S=[],b=0;b<A.offset.length;++b)if(0===A.offset[b])continue;else 1===A.offset[b]?S.push(["t",A.array,"p",b].join("")):S.push([A.offset[b],"*t",A.array,"p",b].join(""));0===S.length?w.push("q"+u+"=0"):w.push(["q",u,"=",S.join("+")].join(""))}var C=s([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));w=w.concat(C),0<w.length&&k.push("var "+w.join(","));for(var u=0;u<e.arrayArgs.length;++u)k.push("p"+u+"|=0");3<e.pre.body.length&&k.push(n(e.pre,e,p));var L=n(e.body,e,p),E=o(x);E<d?k.push(r(E,x[0],e,L)):k.push(a(x[0],e,L)),3<e.post.body.length&&k.push(n(e.post,e,p)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+k.join("\n")+"\n----------");var I=[e.funcName||"unnamed","_cwise_loop_",c[0].join("s"),"m",E,l(p)].join(""),z=new Function(["function ",I,"(",v.join(","),"){",k.join("\n"),"} return ",I].join(""));return z()}},{uniq:547}],148:[function(e,t){"use strict";var a=e("./compile.js");t.exports=function(e){var t=["'use strict'","var CACHED={}"],r=[],o=e.funcName+"_cwise_thunk";t.push(["return function ",o,"(",e.shimArgs.join(","),"){"].join(""));for(var n=[],l=[],s=[["array",e.arrayArgs[0],".shape.slice(",va(0,e.arrayBlockIndices[0]),0>e.arrayBlockIndices[0]?","+e.arrayBlockIndices[0]+")":")"].join("")],d=[],c=[],p=0,u;p<e.arrayArgs.length;++p)u=e.arrayArgs[p],r.push(["t",u,"=array",u,".dtype,","r",u,"=array",u,".order"].join("")),n.push("t"+u),n.push("r"+u),l.push("t"+u),l.push("r"+u+".join()"),s.push("array"+u+".data"),s.push("array"+u+".stride"),s.push("array"+u+".offset|0"),0<p&&(d.push("array"+e.arrayArgs[0]+".shape.length===array"+u+".shape.length+"+(_a(e.arrayBlockIndices[0])-_a(e.arrayBlockIndices[p]))),c.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+va(0,e.arrayBlockIndices[0])+"]===array"+u+".shape[shapeIndex+"+va(0,e.arrayBlockIndices[p])+"]"));1<e.arrayArgs.length&&(t.push("if (!("+d.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+_a(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var p=0;p<e.scalarArgs.length;++p)s.push("scalar"+e.scalarArgs[p]);r.push(["type=[",l.join(","),"].join()"].join("")),r.push("proc=CACHED[type]"),t.push("var "+r.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",n.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------");var g=new Function("compile",t.join("\n"));return g(a.bind(void 0,e))}},{"./compile.js":147}],149:[function(e,t){t.exports=e("cwise-compiler")},{"cwise-compiler":146}],150:[function(e,t){"use strict";var a=e("es5-ext/object/copy"),r=e("es5-ext/object/normalize-options"),o=e("es5-ext/object/valid-callable"),i=e("es5-ext/object/map"),n=e("es5-ext/object/valid-callable"),l=e("es5-ext/object/valid-value"),s=Function.prototype.bind,d=Object.defineProperty,c=Object.prototype.hasOwnProperty,p;p=function(e,t,r){var o=l(t)&&n(t.value),i;return i=a(t),delete i.writable,delete i.value,i.get=function(){return!r.overwriteDefinition&&c.call(this,e)?o:(t.value=s.call(o,r.resolveContext?r.resolveContext(this):this),d(this,e,t),this[e])},i},t.exports=function(e){var t=r(arguments[1]);return null!=t.resolveContext&&o(t.resolveContext),i(e,function(e,a){return p(a,e,t)})}},{"es5-ext/object/copy":189,"es5-ext/object/map":198,"es5-ext/object/normalize-options":199,"es5-ext/object/valid-callable":203,"es5-ext/object/valid-value":205}],151:[function(e,t){"use strict";var a=e("es5-ext/object/assign"),r=e("es5-ext/object/normalize-options"),o=e("es5-ext/object/is-callable"),i=e("es5-ext/string/#/contains"),n;n=t.exports=function(t,o){var n,l,s,d,p;return 2>arguments.length||"string"!=typeof t?(d=o,o=t,t=null):d=arguments[2],null==t?(n=s=!0,l=!1):(n=i.call(t,"c"),l=i.call(t,"e"),s=i.call(t,"w")),p={value:o,configurable:n,enumerable:l,writable:s},d?a(r(d),p):p},n.gs=function(t,n,l){var s,d,p,u;return"string"==typeof t?p=arguments[3]:(p=l,l=n,n=t,t=null),null==n?n=void 0:o(n)?null==l?l=void 0:!o(l)&&(p=l,l=void 0):(p=n,n=l=void 0),null==t?(s=!0,d=!1):(s=i.call(t,"c"),d=i.call(t,"e")),u={get:n,set:l,configurable:s,enumerable:d},p?a(r(p),u):u}},{"es5-ext/object/assign":186,"es5-ext/object/is-callable":192,"es5-ext/object/normalize-options":199,"es5-ext/string/#/contains":206}],152:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function a(e){return 1===e.length&&(e=r(e)),{left:function(t,a,r,o){for(null==r&&(r=0),null==o&&(o=t.length);r<o;){var i=r+o>>>1;0>e(t[i],a)?r=i+1:o=i}return r},right:function(t,a,r,o){for(null==r&&(r=0),null==o&&(o=t.length);r<o;){var i=r+o>>>1;0<e(t[i],a)?o=i:r=i+1}return r}}}function r(e){return function(a,r){return t(e(a),r)}}function o(e,t){null==t&&(t=l);for(var a=0,r=e.length-1,o=e[0],n=Array(0>r?0:r);a<r;)n[a]=t(o,o=e[++a]);return n}function l(e,t){return[e,t]}function s(e){return null===e?NaN:+e}function d(e,t){var a=e.length,r=0,o=-1,n=0,l=0,d,c;if(null==t)for(;++o<a;)isNaN(d=s(e[o]))||(c=d-n,n+=c/++r,l+=c*(d-n));else for(;++o<a;)isNaN(d=s(t(e[o],o,e)))||(c=d-n,n+=c/++r,l+=c*(d-n));return 1<r?l/(r-1):void 0}function c(e,t){var a=d(e,t);return a?N(a):a}function p(e,t){var a=e.length,r=-1,o,n,l;if(null==t){for(;++r<a;)if(null!=(o=e[r])&&o>=o)for(n=l=o;++r<a;)null!=(o=e[r])&&(n>o&&(n=o),l<o&&(l=o));}else for(;++r<a;)if(null!=(o=t(e[r],r,e))&&o>=o)for(n=l=o;++r<a;)null!=(o=t(e[r],r,e))&&(n>o&&(n=o),l<o&&(l=o));return[n,l]}function u(e){return function(){return e}}function g(e){return e}function h(e,t,a){e=+e,t=+t,a=2>(o=arguments.length)?(t=e,e=0,1):3>o?1:+a;for(var r=-1,o=0|va(0,M((t-e)/a)),l=Array(o);++r<o;)l[r]=e+r*a;return l}function m(e,t,a){var r=-1,o,l,s,d;if(t=+t,e=+e,a=+a,e===t&&0<a)return[e];if((o=t<e)&&(l=e,e=t,t=l),0===(d=y(e,t,a))||!isFinite(d))return[];if(0<d)for(e=M(e/d),t=ba(t/d),s=Array(l=M(t-e+1));++r<l;)s[r]=(e+r)*d;else for(e=ba(e*d),t=M(t*d),s=Array(l=M(e-t+1));++r<l;)s[r]=(e-r)/d;return o&&s.reverse(),s}function y(e,t,a){var r=(t-e)/va(0,a),o=ba(P(r)/I),n=r/ya(10,o);return 0<=o?(n>=R?10:n>=j?5:n>=i?2:1)*ya(10,o):-ya(10,-o)/(n>=R?10:n>=j?5:n>=i?2:1)}function f(e,t,a){var r=_a(t-e)/va(0,a),o=ya(10,ba(P(r)/I)),n=r/o;return n>=R?o*=10:n>=j?o*=5:n>=i&&(o*=2),t<e?-o:o}function x(e){return M(P(e.length)/E)+1}function _(){function e(e){var o=e.length,n=Array(o),l,s;for(l=0;l<o;++l)n[l]=t(e[l],l,e);var d=a(n),c=d[0],p=d[1],u=r(n,c,p);Array.isArray(u)||(u=f(c,p,u),u=h(M(c/u)*u,p,u));for(var g=u.length;u[0]<=c;)u.shift(),--g;for(;u[g-1]>p;)u.pop(),--g;var y=Array(g+1),_;for(l=0;l<=g;++l)_=y[l]=[],_.x0=0<l?u[l-1]:c,_.x1=l<g?u[l]:p;for(l=0;l<o;++l)s=n[l],c<=s&&s<=p&&y[C(u,s,0,g)].push(e[l]);return y}var t=g,a=p,r=x;return e.value=function(a){return arguments.length?(t="function"==typeof a?a:u(a),e):t},e.domain=function(t){return arguments.length?(a="function"==typeof t?t:u([t[0],t[1]]),e):a},e.thresholds=function(t){return arguments.length?(r="function"==typeof t?t:Array.isArray(t)?u(D.call(t)):u(t),e):r},e}function b(e,t,a){if(null==a&&(a=s),!!(d=e.length)){if(0>=(t=+t)||2>d)return+a(e[0],0,e);if(1<=t)return+a(e[d-1],d-1,e);var r=(d-1)*t,o=ba(r),i=+a(e[o],o,e),l=+a(e[o+1],o+1,e),d;return i+(l-i)*(r-o)}}function v(e,t){var a=e.length,r=-1,o,n;if(null==t){for(;++r<a;)if(null!=(o=e[r])&&o>=o)for(n=o;++r<a;)null!=(o=e[r])&&o>n&&(n=o);}else for(;++r<a;)if(null!=(o=t(e[r],r,e))&&o>=o)for(n=o;++r<a;)null!=(o=t(e[r],r,e))&&o>n&&(n=o);return n}function k(e,t){var a=e.length,r=-1,o,n;if(null==t){for(;++r<a;)if(null!=(o=e[r])&&o>=o)for(n=o;++r<a;)null!=(o=e[r])&&n>o&&(n=o);}else for(;++r<a;)if(null!=(o=t(e[r],r,e))&&o>=o)for(n=o;++r<a;)null!=(o=t(e[r],r,e))&&n>o&&(n=o);return n}function w(e,t){var a=e.length,r=-1,o=0,n;if(null==t)for(;++r<a;)(n=+e[r])&&(o+=n);else for(;++r<a;)(n=+t(e[r],r,e))&&(o+=n);return o}function T(e){if(!(s=e.length))return[];for(var t=-1,a=k(e,A),r=Array(a);++t<a;)for(var o=-1,l=r[t]=Array(s),s;++o<s;)l[o]=e[o][t];return r}function A(e){return e.length}var S=a(t),C=S.right,L=S.left,z=Array.prototype,D=z.slice,O=z.map,R=N(50),j=N(10),i=N(2);e.bisect=C,e.bisectRight=C,e.bisectLeft=L,e.ascending=t,e.bisector=a,e.cross=function(e,t,a){var r=e.length,o=t.length,n=Array(r*o),s,d,c,p;for(null==a&&(a=l),s=c=0;s<r;++s)for(p=e[s],d=0;d<o;++d,++c)n[c]=a(p,t[d]);return n},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=c,e.extent=p,e.histogram=_,e.thresholdFreedmanDiaconis=function(e,a,r){return e=O.call(e,s).sort(t),M((r-a)/(2*(b(e,.75)-b(e,.25))*ya(e.length,-1/3)))},e.thresholdScott=function(e,t,a){return M((a-t)/(3.5*c(e)*ya(e.length,-1/3)))},e.thresholdSturges=x,e.max=v,e.mean=function(e,t){var a=e.length,r=a,o=-1,n=0,l;if(null==t)for(;++o<a;)isNaN(l=s(e[o]))?--r:n+=l;else for(;++o<a;)isNaN(l=s(t(e[o],o,e)))?--r:n+=l;return r?n/r:void 0},e.median=function(e,a){var r=e.length,o=-1,n=[],l;if(null==a)for(;++o<r;)isNaN(l=s(e[o]))||n.push(l);else for(;++o<r;)isNaN(l=s(a(e[o],o,e)))||n.push(l);return b(n.sort(t),.5)},e.merge=function(e){for(var t=e.length,a=-1,r=0,o,l,s;++a<t;)r+=e[a].length;for(l=Array(r);0<=--t;)for(s=e[t],o=s.length;0<=--o;)l[--r]=s[o];return l},e.min=k,e.pairs=o,e.permute=function(e,t){for(var a=t.length,r=Array(a);a--;)r[a]=e[t[a]];return r},e.quantile=b,e.range=h,e.scan=function(e,a){if(s=e.length){var r=0,o=0,l=e[o],s,d;for(null==a&&(a=t);++r<s;)(0>a(d=e[r],l)||0!==a(l,l))&&(l=d,o=r);if(0===a(l,l))return o}},e.shuffle=function(e,a,r){for(var o=(null==r?e.length:r)-(a=null==a?0:+a),n,l;o;)l=0|Math.random()*o--,n=e[o+a],e[o+a]=e[l+a],e[l+a]=n;return e},e.sum=w,e.ticks=m,e.tickIncrement=y,e.tickStep=f,e.transpose=T,e.variance=d,e.zip=function(){return T(arguments)},Object.defineProperty(e,"__esModule",{value:!0})})},{}],153:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function t(){}function a(e,a){var r=new t;if(e instanceof t)e.each(function(e,t){r.set(t,e)});else if(Array.isArray(e)){var l=-1,s=e.length,n;if(null==a)for(;++l<s;)r.set(l,e[l]);else for(;++l<s;)r.set(a(n=e[l],l,e),n)}else if(e)for(var d in e)r.set(d,e[d]);return r}function r(){return{}}function o(e,t,a){e[t]=a}function i(){return a()}function n(e,t,a){e.set(t,a)}function l(){}function s(e,t){var a=new l;if(e instanceof l)e.each(function(e){a.add(e)});else if(e){var r=-1,o=e.length;if(null==t)for(;++r<o;)a.add(e[r]);else for(;++r<o;)a.add(t(e[r],r,e))}return a}t.prototype=a.prototype={constructor:t,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if(e[0]==="$")return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var d=a.prototype;l.prototype=s.prototype={constructor:l,has:d.has,add:function(e){return e+="",this["$"+e]=e,this},remove:d.remove,clear:d.clear,values:d.keys,size:d.size,empty:d.empty,each:d.each};e.nest=function(){function e(t,r,o,s){if(r>=l.length)return null!=d&&t.sort(d),null==c?t:c(t);for(var p=-1,u=t.length,n=l[r++],g=a(),h=o(),m,y,f;++p<u;)(f=g.get(m=n(y=t[p])+""))?f.push(y):g.set(m,[y]);return g.each(function(t,a){s(h,a,e(t,r,o,s))}),h}function t(e,a){if(++a>l.length)return e;var r=s[a-1],o;return null!=c&&a>=l.length?o=e.entries():(o=[],e.each(function(e,r){o.push({key:r,values:t(e,a)})})),null==r?o:o.sort(function(e,t){return r(e.key,t.key)})}var l=[],s=[],d,c,p;return p={object:function(t){return e(t,0,r,o)},map:function(t){return e(t,0,i,n)},entries:function(a){return t(e(a,0,i,n),0)},key:function(e){return l.push(e),p},sortKeys:function(e){return s[l.length-1]=e,p},sortValues:function(e){return d=e,p},rollup:function(e){return c=e,p}}},e.set=s,e.map=a,e.keys=function(e){var t=[];for(var a in e)t.push(a);return t},e.values=function(e){var t=[];for(var a in e)t.push(e[a]);return t},e.entries=function(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t},Object.defineProperty(e,"__esModule",{value:!0})})},{}],154:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var r in t)a[r]=t[r];return a}function i(){}function n(e){var t;return e=(e+"").trim().toLowerCase(),(t=Y.exec(e))?(t=parseInt(t[1],16),new p(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1)):(t=W.exec(e))?l(parseInt(t[1],16)):(t=X.exec(e))?new p(t[1],t[2],t[3],1):(t=Z.exec(e))?new p(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=J.exec(e))?s(t[1],t[2],t[3],t[4]):(t=Q.exec(e))?s(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=$.exec(e))?g(t[1],t[2]/100,t[3]/100,1):(t=ee.exec(e))?g(t[1],t[2]/100,t[3]/100,t[4]):te.hasOwnProperty(e)?l(te[e]):"transparent"===e?new p(NaN,NaN,NaN,0):null}function l(e){return new p(255&e>>16,255&e>>8,255&e,1)}function s(e,t,o,i){return 0>=i&&(e=t=o=NaN),new p(e,t,o,i)}function d(e){return(e instanceof i||(e=n(e)),!e)?new p:(e=e.rgb(),new p(e.r,e.g,e.b,e.opacity))}function c(e,t,a,r){return 1===arguments.length?d(e):new p(e,t,a,null==r?1:r)}function p(e,t,a,r){this.r=+e,this.g=+t,this.b=+a,this.opacity=+r}function u(e){return e=va(0,ea(255,V(e)||0)),(16>e?"0":"")+e.toString(16)}function g(e,t,r,o){return 0>=o?e=t=r=NaN:0>=r||1<=r?e=t=NaN:0>=t&&(e=NaN),new f(e,t,r,o)}function m(e){if(e instanceof f)return new f(e.h,e.s,e.l,e.opacity);if(e instanceof i||(e=n(e)),!e)return new f;if(e instanceof f)return e;e=e.rgb();var t=e.r/255,a=e.g/255,r=e.b/255,d=ea(t,a,r),c=va(t,a,r),p=NaN,u=c-d,g=(c+d)/2;return u?(p=t===c?(a-r)/u+6*(a<r):a===c?(r-t)/u+2:(t-a)/u+4,u/=.5>g?c+d:2-c-d,p*=60):u=0<g&&1>g?0:p,new f(p,u,g,e.opacity)}function y(e,t,a,r){return 1===arguments.length?m(e):new f(e,t,a,null==r?1:r)}function f(e,t,a,r){this.h=+e,this.s=+t,this.l=+a,this.opacity=+r}function x(e,t,a){return 255*(60>e?t+(a-t)*e/60:180>e?a:240>e?t+(a-t)*(240-e)/60:t)}function _(e){if(e instanceof v)return new v(e.l,e.a,e.b,e.opacity);if(e instanceof P){if(isNaN(e.h))return new v(e.l,0,0,e.opacity);var t=e.h*ae;return new v(e.l,R(t)*e.c,De(t)*e.c,e.opacity)}e instanceof p||(e=d(e));var a=S(e.r),r=S(e.g),i=S(e.b),n=k((.2225045*a+.7168786*r+.0606169*i)/1),l,s;return a===r&&r===i?l=s=n:(l=k((.4360747*a+.3850649*r+.1430804*i)/K),s=k((.0139322*a+.0971045*r+.7141733*i)/ie)),new v(116*n-16,500*(l-n),200*(n-s),e.opacity)}function b(e,t,a,r){return 1===arguments.length?_(e):new v(e,t,a,null==r?1:r)}function v(e,t,a,r){this.l=+e,this.a=+t,this.b=+a,this.opacity=+r}function k(e){return e>ne?ya(e,1/3):e/h+r}function w(e){return e>o?e*e*e:h*(e-r)}function T(e){return 255*(.0031308>=e?12.92*e:1.055*ya(e,1/2.4)-.055)}function S(e){return .04045>=(e/=255)?e/12.92:ya((e+.055)/1.055,2.4)}function I(e){if(e instanceof P)return new P(e.h,e.c,e.l,e.opacity);if(e instanceof v||(e=_(e)),0===e.a&&0===e.b)return new P(NaN,0,e.l,e.opacity);var t=L(e.b,e.a)*re;return new P(0>t?t+360:t,N(e.a*e.a+e.b*e.b),e.l,e.opacity)}function z(e,t,a,r){return 1===arguments.length?I(e):new P(e,t,a,null==r?1:r)}function P(e,t,a,r){this.h=+e,this.c=+t,this.l=+a,this.opacity=+r}function O(e){if(e instanceof j)return new j(e.h,e.s,e.l,e.opacity);e instanceof p||(e=d(e));var t=e.r/255,a=e.g/255,r=e.b/255,i=(de*r+E*t-se*a)/(de+E-se),n=r-i,l=(D*(a-i)-B*n)/C,c=N(l*l+n*n)/(D*i*(1-i)),s=c?L(l,n)*re-120:NaN;return new j(0>s?s+360:s,c,i,e.opacity)}function M(e,t,a,r){return 1===arguments.length?O(e):new j(e,t,a,null==r?1:r)}function j(e,t,a,r){this.h=+e,this.s=+t,this.l=+a,this.opacity=+r}var F=.7,U=1/F,H="\\s*([+-]?\\d+)\\s*",G="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",q="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Y=/^#([0-9a-f]{3})$/,W=/^#([0-9a-f]{6})$/,X=new RegExp("^rgb\\("+[H,H,H]+"\\)$"),Z=new RegExp("^rgb\\("+[q,q,q]+"\\)$"),J=new RegExp("^rgba\\("+[H,H,H,G]+"\\)$"),Q=new RegExp("^rgba\\("+[q,q,q,G]+"\\)$"),$=new RegExp("^hsl\\("+[G,q,q]+"\\)$"),ee=new RegExp("^hsla\\("+[G,q,q,G]+"\\)$"),te={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t(i,n,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),t(p,c,a(i,{brighter:function(e){return e=null==e?U:ya(U,e),new p(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?F:ya(F,e),new p(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&255>=this.r&&0<=this.g&&255>=this.g&&0<=this.b&&255>=this.b&&0<=this.opacity&&1>=this.opacity},hex:function(){return"#"+u(this.r)+u(this.g)+u(this.b)},toString:function(){var e=this.opacity;return e=isNaN(e)?1:va(0,ea(1,e)),(1===e?"rgb(":"rgba(")+va(0,ea(255,V(this.r)||0))+", "+va(0,ea(255,V(this.g)||0))+", "+va(0,ea(255,V(this.b)||0))+(1===e?")":", "+e+")")}})),t(f,y,a(i,{brighter:function(e){return e=null==e?U:ya(U,e),new f(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?F:ya(F,e),new f(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,r=a+(.5>a?a:1-a)*t,o=2*a-r;return new p(x(240<=e?e-240:e+120,o,r),x(e,o,r),x(120>e?e+240:e-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity}}));var ae=Pe/180,re=180/Pe,oe=18,K=.96422,ie=.82521,r=4/29,o=6/29,h=3*o*o,ne=o*o*o;t(v,b,a(i,{brighter:function(e){return new v(this.l+oe*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new v(this.l-oe*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return t=K*w(t),e=1*w(e),a=ie*w(a),new p(T(3.1338561*t-1.6168667*e-.4906146*a),T(-.9787684*t+1.9161415*e+.033454*a),T(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(P,z,a(i,{brighter:function(e){return new P(this.h,this.c,this.l+oe*(null==e?1:e),this.opacity)},darker:function(e){return new P(this.h,this.c,this.l-oe*(null==e?1:e),this.opacity)},rgb:function(){return _(this).rgb()}}));var le=-.14861,A=+1.78277,B=-.29227,C=-.90649,D=+1.97294,E=D*C,se=D*A,de=A*B-C*le;t(j,M,a(i,{brighter:function(e){return e=null==e?U:ya(U,e),new j(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?F:ya(F,e),new j(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*ae,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),a=R(e),o=De(e);return new p(255*(t+r*(le*a+A*o)),255*(t+r*(B*a+C*o)),255*(t+r*(D*a)),this.opacity)}})),e.color=n,e.rgb=c,e.hsl=y,e.lab=b,e.hcl=z,e.lch=function(e,t,a,r){return 1===arguments.length?I(e):new P(a,t,e,null==r?1:r)},e.gray=function(e,t){return new v(e,0,0,null==t?1:t)},e.cubehelix=M,Object.defineProperty(e,"__esModule",{value:!0})})},{}],155:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function t(){for(var e=0,r=arguments.length,o={},n;e<r;++e){if(!(n=arguments[e]+"")||n in o)throw new Error("illegal type: "+n);o[n]=[]}return new a(o)}function a(e){this._=e}function r(e,a){return e.trim().split(/^|\s+/).map(function(e){var r="",o=e.indexOf(".");if(0<=o&&(r=e.slice(o+1),e=e.slice(0,o)),e&&!a.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}function o(e,t){for(var a=0,r=e.length,o;a<r;++a)if((o=e[a]).name===t)return o.value}function l(e,t,a){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=s,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=a&&e.push({name:t,value:a}),e}var s={value:function(){}};a.prototype=t.prototype={constructor:a,on:function(e,a){var s=this._,d=r(e+"",s),c=-1,p=d.length,n;if(2>arguments.length){for(;++c<p;)if((n=(e=d[c]).type)&&(n=o(s[n],e.name)))return n;return}if(null!=a&&"function"!=typeof a)throw new Error("invalid callback: "+a);for(;++c<p;)if(n=(e=d[c]).type)s[n]=l(s[n],e.name,a);else if(null==a)for(n in s)s[n]=l(s[n],e.name,null);return this},copy:function(){var e={},r=this._;for(var o in r)e[o]=r[o].slice();return new a(e)},call:function(e,a){if(0<(l=arguments.length-2))for(var r=Array(l),o=0,l,s;o<l;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],o=0,l=s.length;o<l;++o)s[o].value.apply(a,r)},apply:function(e,a,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],t=0,l=o.length;t<l;++t)o[t].value.apply(a,r)}},e.dispatch=t,Object.defineProperty(e,"__esModule",{value:!0})})},{}],156:[function(e,t,a){(function(r,o){"object"==typeof a&&"undefined"!=typeof t?o(a,e("d3-quadtree"),e("d3-collection"),e("d3-dispatch"),e("d3-timer")):"function"==typeof ka&&ka.amd?ka(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],o):o(r.d3=r.d3||{},r.d3,r.d3,r.d3,r.d3)})(this,function(e,t,a,r,o){"use strict";function l(e){return e.x+e.vx}function s(e){return e.y+e.vy}function i(e){return e.index}function d(e,t){var a=e.get(t);if(!a)throw new Error("missing: "+t);return a}function c(e){return e.x}function p(e){return e.y}var u=function(e){return function(){return e}},g=function(){return 1e-6*(Math.random()-.5)},h=Pe*(3-N(5));e.forceCenter=function(e,t){function a(){var a=r.length,o=0,n=0,l,s;for(l=0;l<a;++l)s=r[l],o+=s.x,n+=s.y;for(o=o/a-e,n=n/a-t,l=0;l<a;++l)s=r[l],s.x-=o,s.y-=n}var r;return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){r=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a},e.forceCollide=function(e){function a(){function e(e,t,a,o,n){var s=e.data,d=e.r,c=_+d;if(s){if(s.index>h.index){var p=m-s.x-s.vx,u=f-s.y-s.vy,v=p*p+u*u;v<c*c&&(0===p&&(p=g(),v+=p*p),0===u&&(u=g(),v+=u*u),v=(c-(v=N(v)))/v*i,h.vx+=(p*=v)*(c=(d*=d)/(b+d)),h.vy+=(u*=v)*c,s.vx-=p*(c=1-c),s.vy-=u*c)}return}return t>m+c||o<m-c||a>f+c||n<f-c}for(var a=c.length,o=0,n,u,h,m,f,_,b;o<d;++o)for(u=t.quadtree(c,l,s).visitAfter(r),n=0;n<a;++n)h=c[n],_=p[h.index],b=_*_,m=h.x+h.vx,f=h.y+h.vy,u.visit(e)}function r(e){if(e.data)return e.r=p[e.data.index];for(var t=e.r=0;4>t;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function o(){if(c){var t=c.length,a,r;for(p=Array(t),a=0;a<t;++a)r=c[a],p[r.index]=+e(r,a,c)}}var i=1,d=1,c,p;return"function"!=typeof e&&(e=u(null==e?1:+e)),a.initialize=function(e){c=e,o()},a.iterations=function(e){return arguments.length?(d=+e,a):d},a.strength=function(e){return arguments.length?(i=+e,a):i},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:u(+t),o(),a):e},a},e.forceLink=function(e){function t(e){return 1/ea(v[e.source.index],v[e.target.index])}function r(t){for(var a=0,r=e.length;a<m;++a)for(var o=0,n,s,d,c,p,u,h;o<r;++o)n=e[o],s=n.source,d=n.target,c=d.x+d.vx-s.x-s.vx||g(),p=d.y+d.vy-s.y-s.vy||g(),u=N(c*c+p*p),u=(u-_[o])/u*t*f[o],c*=u,p*=u,d.vx-=c*(h=k[o]),d.vy-=p*h,s.vx+=c*(h=1-h),s.vy+=p*h}function o(){if(b){var t=b.length,r=e.length,o=a.map(b,c),n,p;for(n=0,v=Array(t);n<r;++n)p=e[n],p.index=n,"object"!=typeof p.source&&(p.source=d(o,p.source)),"object"!=typeof p.target&&(p.target=d(o,p.target)),v[p.source.index]=(v[p.source.index]||0)+1,v[p.target.index]=(v[p.target.index]||0)+1;for(n=0,k=Array(r);n<r;++n)p=e[n],k[n]=v[p.source.index]/(v[p.source.index]+v[p.target.index]);f=Array(r),l(),_=Array(r),s()}}function l(){if(b)for(var t=0,a=e.length;t<a;++t)f[t]=+p(e[t],t,e)}function s(){if(b)for(var t=0,a=e.length;t<a;++t)_[t]=+h(e[t],t,e)}var c=i,p=t,h=u(30),m=1,f,_,b,v,k;return null==e&&(e=[]),r.initialize=function(e){b=e,o()},r.links=function(t){return arguments.length?(e=t,o(),r):e},r.id=function(e){return arguments.length?(c=e,r):c},r.iterations=function(e){return arguments.length?(m=+e,r):m},r.strength=function(e){return arguments.length?(p="function"==typeof e?e:u(+e),l(),r):p},r.distance=function(e){return arguments.length?(h="function"==typeof e?e:u(+e),s(),r):h},r},e.forceManyBody=function(){function e(e){var a=m.length,n=t.quadtree(m,c,p).visitAfter(r),l;for(b=e,l=0;l<a;++l)f=m[l],n.visit(o)}function a(){if(m){var e=m.length,t,a;for(v=Array(e),t=0;t<e;++t)a=m[t],v[a.index]=+l(a,t,m)}}function r(e){var t=0,a=0,r,o,n,l,s;if(e.length){for(n=l=s=0;4>s;++s)(r=e[s])&&(o=_a(r.value))&&(t+=r.value,a+=o,n+=o*r.x,l+=o*r.y);e.x=n/a,e.y=l/a}else{r=e,r.x=r.data.x,r.y=r.data.y;do t+=v[r.data.index];while(r=r.next)}e.value=t}function o(e,t,a,r){if(!e.value)return!0;var o=e.x-f.x,i=e.y-f.y,n=r-t,c=o*o+i*i;if(n*n/h<c)return c<d&&(0===o&&(o=g(),c+=o*o),0===i&&(i=g(),c+=i*i),c<s&&(c=N(s*c)),f.vx+=o*e.value*b/c,f.vy+=i*e.value*b/c),!0;if(!(e.length||c>=d)){(e.data!==f||e.next)&&(0===o&&(o=g(),c+=o*o),0===i&&(i=g(),c+=i*i),c<s&&(c=N(s*c)));do e.data!==f&&(n=v[e.data.index]*b/c,f.vx+=o*n,f.vy+=i*n);while(e=e.next)}}var l=u(-30),s=1,d=1/0,h=.81,m,f,b,v;return e.initialize=function(e){m=e,a()},e.strength=function(t){return arguments.length?(l="function"==typeof t?t:u(+t),a(),e):l},e.distanceMin=function(t){return arguments.length?(s=t*t,e):N(s)},e.distanceMax=function(t){return arguments.length?(d=t*t,e):N(d)},e.theta=function(t){return arguments.length?(h=t*t,e):N(h)},e},e.forceRadial=function(e,t,a){function r(e){for(var o=0,l=s.length;o<l;++o){var n=s[o],p=n.x-t||1e-6,u=n.y-a||1e-6,g=N(p*p+u*u),r=(c[o]-g)*d[o]*e/g;n.vx+=p*r,n.vy+=u*r}}function o(){if(s){var t=s.length,a;for(d=Array(t),c=Array(t),a=0;a<t;++a)c[a]=+e(s[a],a,s),d[a]=isNaN(c[a])?0:+l(s[a],a,s)}}var l=u(.1),s,d,c;return"function"!=typeof e&&(e=u(+e)),null==t&&(t=0),null==a&&(a=0),r.initialize=function(e){s=e,o()},r.strength=function(e){return arguments.length?(l="function"==typeof e?e:u(+e),o(),r):l},r.radius=function(t){return arguments.length?(e="function"==typeof t?t:u(+t),o(),r):e},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(e){return arguments.length?(a=+e,r):a},r},e.forceSimulation=function(e){function t(){i(),y.call("tick",f),s<d&&(m.stop(),y.call("end",f))}function i(){var t=e.length,a,r;for(s+=(p-s)*c,g.each(function(e){e(s)}),a=0;a<t;++a)r=e[a],null==r.fx?r.x+=r.vx*=u:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=u:(r.y=r.fy,r.vy=0)}function n(){for(var t=0,a=e.length,r;t<a;++t){if(r=e[t],r.index=t,isNaN(r.x)||isNaN(r.y)){var o=10*N(t),n=t*h;r.x=o*R(n),r.y=o*De(n)}(isNaN(r.vx)||isNaN(r.vy))&&(r.vx=r.vy=0)}}function l(t){return t.initialize&&t.initialize(e),t}var s=1,d=.001,c=1-ya(d,1/300),p=0,u=.6,g=a.map(),m=o.timer(t),y=r.dispatch("tick","end"),f;return null==e&&(e=[]),n(),f={tick:i,restart:function(){return m.restart(t),f},stop:function(){return m.stop(),f},nodes:function(t){return arguments.length?(e=t,n(),g.each(l),f):e},alpha:function(e){return arguments.length?(s=+e,f):s},alphaMin:function(e){return arguments.length?(d=+e,f):d},alphaDecay:function(e){return arguments.length?(c=+e,f):+c},alphaTarget:function(e){return arguments.length?(p=+e,f):p},velocityDecay:function(e){return arguments.length?(u=1-e,f):1-u},force:function(e,t){return 1<arguments.length?(null==t?g.remove(e):g.set(e,l(t)),f):g.get(e)},find:function(t,a,r){var o=0,l=e.length,n,s,d,c,p;for(null==r?r=1/0:r*=r,o=0;o<l;++o)c=e[o],n=t-c.x,s=a-c.y,d=n*n+s*s,d<r&&(p=c,r=d);return p},on:function(e,t){return 1<arguments.length?(y.on(e,t),f):y.on(e)}}},e.forceX=function(e){function t(e){for(var t=0,a=o.length,r;t<a;++t)r=o[t],r.vx+=(s[t]-r.x)*l[t]*e}function a(){if(o){var t=o.length,a;for(l=Array(t),s=Array(t),a=0;a<t;++a)l[a]=isNaN(s[a]=+e(o[a],a,o))?0:+r(o[a],a,o)}}var r=u(.1),o,l,s;return"function"!=typeof e&&(e=u(null==e?0:+e)),t.initialize=function(e){o=e,a()},t.strength=function(e){return arguments.length?(r="function"==typeof e?e:u(+e),a(),t):r},t.x=function(r){return arguments.length?(e="function"==typeof r?r:u(+r),a(),t):e},t},e.forceY=function(e){function t(e){for(var t=0,a=o.length,r;t<a;++t)r=o[t],r.vy+=(s[t]-r.y)*l[t]*e}function a(){if(o){var t=o.length,a;for(l=Array(t),s=Array(t),a=0;a<t;++a)l[a]=isNaN(s[a]=+e(o[a],a,o))?0:+r(o[a],a,o)}}var r=u(.1),o,l,s;return"function"!=typeof e&&(e=u(null==e?0:+e)),t.initialize=function(e){o=e,a()},t.strength=function(e){return arguments.length?(r="function"==typeof e?e:u(+e),a(),t):r},t.y=function(r){return arguments.length?(e="function"==typeof r?r:u(+r),a(),t):e},t},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-collection":153,"d3-dispatch":155,"d3-quadtree":160,"d3-timer":162}],157:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e,t){return e.parent===t.parent?1:2}function a(e){return e.reduce(r,0)/e.length}function r(e,t){return e+t.x}function o(e){return 1+e.reduce(i,0)}function i(e,t){return va(e,t.y)}function n(e){for(var t;t=e.children;)e=t[0];return e}function l(e){for(var t;t=e.children;)e=t[t.length-1];return e}function s(){function e(e){var t=0,c;e.eachAfter(function(e){var i=e.children;i?(e.x=a(i),e.y=o(i)):(e.x=c?t+=r(e,c):0,e.y=0,c=e)});var p=n(e),u=l(e),g=p.x-r(p,u)/2,h=u.x+r(u,p)/2;return e.eachAfter(d?function(t){t.x=(t.x-e.x)*i,t.y=(e.y-t.y)*s}:function(t){t.x=(t.x-g)/(h-g)*i,t.y=(1-(e.y?t.y/e.y:1))*s})}var r=t,i=1,s=1,d=!1;return e.separation=function(t){return arguments.length?(r=t,e):r},e.size=function(t){return arguments.length?(d=!1,i=+t[0],s=+t[1],e):d?null:[i,s]},e.nodeSize=function(t){return arguments.length?(d=!0,i=+t[0],s=+t[1],e):d?[i,s]:null},e}function d(e){var t=0,a=e.children,r=a&&a.length;if(!r)t=1;else for(;0<=--r;)t+=a[r].value;e.value=t}function c(e,t){if(e===t)return e;var r=e.ancestors(),o=t.ancestors(),i=null;for(e=r.pop(),t=o.pop();e===t;)i=e,e=r.pop(),t=o.pop();return i}function p(e,t){var a=new m(e),r=+e.value&&(a.value=e.value),o=[a],l,s,d,c,p;for(null==t&&(t=u);l=o.pop();)if(r&&(l.value=+l.data.value),(d=t(l.data))&&(p=d.length))for(l.children=Array(p),c=p-1;0<=c;--c)o.push(s=l.children[c]=new m(d[c])),s.parent=l,s.depth=l.depth+1;return a.eachBefore(h)}function u(e){return e.children}function g(e){e.data=e.data.data}function h(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function m(e){this.data=e,this.depth=this.height=0,this.parent=null}function y(e){for(var a=e.length,r,o;a;)o=0|Math.random()*a--,r=e[a],e[a]=e[o],e[o]=r;return e}function f(t){for(var a=0,r=(t=y(oe.call(t))).length,o=[],n,l;a<r;)n=t[a],l&&b(l,n)?++a:(l=k(o=x(o,n)),a=0);return l}function x(e,t){var a,r;if(v(t,e))return[t];for(a=0;a<e.length;++a)if(_(t,e[a])&&v(T(e[a],t),e))return[e[a],t];for(a=0;a<e.length-1;++a)for(r=a+1;r<e.length;++r)if(_(T(e[a],e[r]),t)&&_(T(e[a],t),e[r])&&_(T(e[r],t),e[a])&&v(A(e[a],e[r],t),e))return[e[a],e[r],t];throw new Error}function _(e,t){var a=e.r-t.r,r=t.x-e.x,o=t.y-e.y;return 0>a||a*a<r*r+o*o}function b(e,t){var a=e.r-t.r+1e-6,r=t.x-e.x,o=t.y-e.y;return 0<a&&a*a>r*r+o*o}function v(e,t){for(var a=0;a<t.length;++a)if(!b(e,t[a]))return!1;return!0}function k(e){switch(e.length){case 1:return w(e[0]);case 2:return T(e[0],e[1]);case 3:return A(e[0],e[1],e[2]);}}function w(e){return{x:e.x,y:e.y,r:e.r}}function T(e,t){var a=e.x,r=e.y,o=e.r,i=t.x,n=t.y,s=t.r,d=i-a,c=n-r,p=s-o,u=N(d*d+c*c);return{x:(a+i+d/u*p)/2,y:(r+n+c/u*p)/2,r:(u+o+s)/2}}function A(e,t,a){var o=e.x,i=e.y,n=e.r,l=t.x,s=t.y,d=t.r,c=a.x,p=a.y,u=a.r,g=o-l,h=o-c,m=i-s,y=i-p,f=d-n,x=u-n,_=o*o+i*i-n*n,b=_-l*l-s*s+d*d,v=_-c*c-p*p+u*u,k=h*m-g*y,w=(m*v-y*b)/(2*k)-o,T=(y*f-m*x)/k,S=(h*b-g*v)/(2*k)-i,L=(g*x-h*f)/k,E=T*T+L*L-1,A=2*(n+w*T+S*L),I=w*w+S*S-n*n,C=-(E?(A+N(A*A-4*E*I))/(2*E):I/A);return{x:o+w+T*C,y:i+S+L*C,r:C}}function S(e,t,a){var r=e.x-t.x,o=e.y-t.y,i=r*r+o*o,n,l,s,d;i?(l=t.r+a.r,l*=l,d=e.r+a.r,d*=d,l>d?(n=(i+d-l)/(2*i),s=N(va(0,d/i-n*n)),a.x=e.x-n*r-s*o,a.y=e.y-n*o+s*r):(n=(i+l-d)/(2*i),s=N(va(0,l/i-n*n)),a.x=t.x+n*r-s*o,a.y=t.y+n*o+s*r)):(a.x=t.x+a.r,a.y=t.y)}function C(e,t){var a=e.r+t.r-1e-6,r=t.x-e.x,o=t.y-e.y;return 0<a&&a*a>r*r+o*o}function L(e){var t=e._,a=e.next._,r=t.r+a.r,o=(t.x*a.r+a.x*t.r)/r,i=(t.y*a.r+a.y*t.r)/r;return o*o+i*i}function E(e){this._=e,this.next=null,this.previous=null}function I(e){if(!(l=e.length))return 0;var t,r,o,l,s,d,p,u,g,h,m;if(t=e[0],t.x=0,t.y=0,!(1<l))return t.r;if(r=e[1],t.x=-r.r,r.x=t.r,r.y=0,!(2<l))return t.r+r.r;S(r,t,o=e[2]),t=new E(t),r=new E(r),o=new E(o),t.next=o.previous=r,r.next=t.previous=o,o.next=r.previous=t;pack:for(p=3;p<l;++p){S(t._,r._,o=e[p]),o=new E(o),u=r.next,g=t.previous,h=r._.r,m=t._.r;do if(h<=m){if(C(u._,o._)){r=u,t.next=r,r.previous=t,--p;continue pack}h+=u._.r,u=u.next}else{if(C(g._,o._)){t=g,t.next=r,r.previous=t,--p;continue pack}m+=g._.r,g=g.previous}while(u!==g.next);for(o.previous=t,o.next=r,t.next=r.previous=r=o,s=L(t);(o=o.next)!==r;)(d=L(o))<s&&(t=o,s=d);r=t.next}for(t=[r._],o=r;(o=o.next)!==r;)t.push(o._);for(o=f(t),p=0;p<l;++p)t=e[p],t.x-=o.x,t.y-=o.y;return o.r}function z(e){return null==e?null:P(e)}function P(e){if("function"!=typeof e)throw new Error;return e}function D(){return 0}function O(e){return function(){return e}}function R(e){return N(e.value)}function M(e){return function(t){t.children||(t.r=va(0,+e(t)||0))}}function j(t,a){return function(o){if(r=o.children){var l=r.length,n=t(o)*a||0,r,s,d;if(n)for(s=0;s<l;++s)r[s].r+=n;if(d=I(r),n)for(s=0;s<l;++s)r[s].r-=n;o.r=d+n}}}function F(e){return function(t){var a=t.parent;t.r*=e,a&&(t.x=a.x+e*t.x,t.y=a.y+e*t.y)}}function B(e){e.x0=V(e.x0),e.y0=V(e.y0),e.x1=V(e.x1),e.y1=V(e.y1)}function U(e,t,a,r,o){for(var l=e.children,s=-1,d=l.length,n=e.value&&(r-t)/e.value,c;++s<d;)c=l[s],c.y0=a,c.y1=o,c.x0=t,c.x1=t+=c.value*n}function H(){function e(e){var l=e.height+1;return e.x0=e.y0=o,e.x1=a,e.y1=r/l,e.eachBefore(t(r,l)),i&&e.eachBefore(B),e}function t(e,t){return function(a){a.children&&U(a,a.x0,e*(a.depth+1)/t,a.x1,e*(a.depth+2)/t);var r=a.x0,i=a.y0,n=a.x1-o,l=a.y1-o;n<r&&(r=n=(r+n)/2),l<i&&(i=l=(i+l)/2),a.x0=r,a.y0=i,a.x1=n,a.y1=l}}var a=1,r=1,o=0,i=!1;return e.round=function(t){return arguments.length?(i=!!t,e):i},e.size=function(t){return arguments.length?(a=+t[0],r=+t[1],e):[a,r]},e.padding=function(t){return arguments.length?(o=+t,e):o},e}function G(e){return e.id}function q(e){return e.parentId}function Y(){function e(e){var r=e.length,o=Array(r),l={},s,c,p,u,g,y,f;for(c=0;c<r;++c)s=e[c],g=o[c]=new m(s),null!=(y=t(s,c,e))&&(y+="")&&(f="$"+(g.id=y),l[f]=f in l?ne:g);for(c=0;c<r;++c)if(g=o[c],y=a(e[c],c,e),null==y||!(y+="")){if(p)throw new Error("multiple roots");p=g}else{if(u=l["$"+y],!u)throw new Error("missing: "+y);if(u===ne)throw new Error("ambiguous: "+y);u.children?u.children.push(g):u.children=[g],g.parent=u}if(!p)throw new Error("no root");if(p.parent=ie,p.eachBefore(function(e){e.depth=e.parent.depth+1,--r}).eachBefore(h),p.parent=null,0<r)throw new Error("cycle");return p}var t=G,a=q;return e.id=function(a){return arguments.length?(t=P(a),e):t},e.parentId=function(t){return arguments.length?(a=P(t),e):a},e}function W(e,t){return e.parent===t.parent?1:2}function X(e){var t=e.children;return t?t[0]:e.t}function Z(e){var t=e.children;return t?t[t.length-1]:e.t}function K(e,t,a){var r=a/(t.i-e.i);t.c-=r,t.s+=a,e.c+=r,t.z+=a,t.m+=a}function J(e){for(var t=0,a=0,r=e.children,o=r.length,n;0<=--o;)n=r[o],n.z+=t,n.m+=t,t+=n.s+(a+=n.c)}function Q(e,t,a){return e.a.parent===t.parent?e.a:a}function $(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function ee(e){for(var t=new $(e,0),a=[t],r,o,l,s,d;r=a.pop();)if(l=r._.children)for(r.children=Array(d=l.length),s=d-1;0<=s;--s)a.push(o=r.children[s]=new $(l[s],s)),o.parent=r;return(t.parent=new $(null,0)).children=[t],t}function te(){function e(e){var o=ee(e);if(o.eachAfter(a),o.parent.m=-o.z,o.eachBefore(r),d)e.eachBefore(i);else{var c=e,p=e,u=e;e.eachBefore(function(e){e.x<c.x&&(c=e),e.x>p.x&&(p=e),e.depth>u.depth&&(u=e)});var g=c===p?1:n(c,p)/2,s=g-c.x,h=l/(p.x+g+s),m=t/(u.depth||1);e.eachBefore(function(e){e.x=(e.x+s)*h,e.y=e.depth*m})}return e}function a(e){var t=e.children,a=e.parent.children,r=e.i?a[e.i-1]:null;if(t){J(e);var i=(t[0].z+t[t.length-1].z)/2;r?(e.z=r.z+n(e._,r._),e.m=e.z-i):e.z=i}else r&&(e.z=r.z+n(e._,r._));e.parent.A=o(e,r,e.parent.A||a[0])}function r(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function o(e,t,a){if(t){for(var r=e,o=e,i=t,l=r.parent.children[0],s=r.m,d=o.m,c=i.m,p=l.m,u;i=Z(i),r=X(r),i&&r;)l=X(l),o=Z(o),o.a=e,u=i.z+c-r.z-s+n(i._,r._),0<u&&(K(Q(i,e,a),e,u),s+=u,d+=u),c+=i.m,s+=r.m,p+=l.m,d+=o.m;i&&!Z(o)&&(o.t=i,o.m+=c-d),r&&!X(l)&&(l.t=r,l.m+=s-p,a=e)}return a}function i(e){e.x*=l,e.y=e.depth*t}var n=W,l=1,t=1,d=null;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(a){return arguments.length?(d=!1,l=+a[0],t=+a[1],e):d?null:[l,t]},e.nodeSize=function(a){return arguments.length?(d=!0,l=+a[0],t=+a[1],e):d?[l,t]:null},e}function ae(e,t,a,r,o){for(var l=e.children,s=-1,d=l.length,n=e.value&&(o-a)/e.value,c;++s<d;)c=l[s],c.x0=t,c.x1=r,c.y0=a,c.y1=a+=c.value*n}function re(e,t,a,r,o,i){for(var l=[],s=t.children,d=0,c=0,p=s.length,n=t.value,u,g,h,m,y,f,x,_,b,v,k;d<p;){h=o-a,m=i-r;do y=s[c++].value;while(!y&&c<p);for(f=x=y,v=va(m/h,h/m)/(n*e),k=y*y*v,b=va(x/k,k/f);c<p;++c){if(y+=g=s[c].value,g<f&&(f=g),g>x&&(x=g),k=y*y*v,_=va(x/k,k/f),_>b){y-=g;break}b=_}l.push(u={value:y,dice:h<m,children:s.slice(d,c)}),u.dice?U(u,a,r,o,n?r+=m*y/n:i):ae(u,a,r,n?a+=h*y/n:o,i),n-=y,d=c}return l}m.prototype=p.prototype={constructor:m,count:function(){return this.eachAfter(d)},each:function(e){var t=this,a=[t],r,o,l,s;do for(r=a.reverse(),a=[];t=r.pop();)if(e(t),o=t.children,o)for(l=0,s=o.length;l<s;++l)a.push(o[l]);while(a.length);return this},eachAfter:function(e){for(var t=this,a=[t],r=[],o,l,s;t=a.pop();)if(r.push(t),o=t.children,o)for(l=0,s=o.length;l<s;++l)a.push(o[l]);for(;t=r.pop();)e(t);return this},eachBefore:function(e){for(var t=this,a=[t],r,o;t=a.pop();)if(e(t),r=t.children,r)for(o=r.length-1;0<=o;--o)a.push(r[o]);return this},sum:function(e){return this.eachAfter(function(t){for(var a=+e(t.data)||0,r=t.children,o=r&&r.length;0<=--o;)a+=r[o].value;t.value=a})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,a=c(t,e),r=[t];t!==a;)t=t.parent,r.push(t);for(var o=r.length;e!==a;)r.splice(o,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(a){a!==e&&t.push({source:a.parent,target:a})}),t},copy:function(){return p(this).eachBefore(g)}};var oe=Array.prototype.slice,ie={depth:-1},ne={};$.prototype=Object.create(m.prototype);var le=(1+N(5))/2,se=function e(t){function a(e,a,r,o,i){re(t,e,a,r,o,i)}return a.ratio=function(t){return e(1<(t=+t)?t:1)},a}(le),de=function e(t){function a(e,a,r,o,l){if((p=e._squarify)&&p.ratio===t)for(var s=-1,d=p.length,c=e.value,p,u,g,h,m;++s<d;){for(u=p[s],g=u.children,(h=u.value=0,m=g.length);h<m;++h)u.value+=g[h].value;u.dice?U(u,a,r,o,r+=(l-r)*u.value/c):ae(u,a,r,a+=(o-a)*u.value/c,l),c-=u.value}else e._squarify=p=re(t,e,a,r,o,l),p.ratio=t}return a.ratio=function(t){return e(1<(t=+t)?t:1)},a}(le);e.cluster=s,e.hierarchy=p,e.pack=function(){function e(e){return e.x=a/2,e.y=r/2,t?e.eachBefore(M(t)).eachAfter(j(o,.5)).eachBefore(F(1)):e.eachBefore(M(R)).eachAfter(j(D,1)).eachAfter(j(o,e.r/ea(a,r))).eachBefore(F(ea(a,r)/(2*e.r))),e}var t=null,a=1,r=1,o=D;return e.radius=function(a){return arguments.length?(t=z(a),e):t},e.size=function(t){return arguments.length?(a=+t[0],r=+t[1],e):[a,r]},e.padding=function(t){return arguments.length?(o="function"==typeof t?t:O(+t),e):o},e},e.packSiblings=function(e){return I(e),e},e.packEnclose=f,e.partition=H,e.stratify=Y,e.tree=te,e.treemap=function(){function e(e){return e.x0=e.y0=0,e.x1=o,e.y1=i,e.eachBefore(t),n=[0],r&&e.eachBefore(B),e}function t(e){var t=n[e.depth],r=e.x0+t,o=e.y0+t,i=e.x1-t,g=e.y1-t;i<r&&(r=i=(r+i)/2),g<o&&(o=g=(o+g)/2),e.x0=r,e.y0=o,e.x1=i,e.y1=g,e.children&&(t=n[e.depth+1]=l(e)/2,r+=u(e)-t,o+=s(e)-t,i-=d(e)-t,g-=c(e)-t,i<r&&(r=i=(r+i)/2),g<o&&(o=g=(o+g)/2),a(e,r,o,i,g))}var a=se,r=!1,o=1,i=1,n=[0],l=D,s=D,d=D,c=D,u=D;return e.round=function(t){return arguments.length?(r=!!t,e):r},e.size=function(t){return arguments.length?(o=+t[0],i=+t[1],e):[o,i]},e.tile=function(t){return arguments.length?(a=P(t),e):a},e.padding=function(t){return arguments.length?e.paddingInner(t).paddingOuter(t):e.paddingInner()},e.paddingInner=function(t){return arguments.length?(l="function"==typeof t?t:O(+t),e):l},e.paddingOuter=function(t){return arguments.length?e.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):e.paddingTop()},e.paddingTop=function(t){return arguments.length?(s="function"==typeof t?t:O(+t),e):s},e.paddingRight=function(t){return arguments.length?(d="function"==typeof t?t:O(+t),e):d},e.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:O(+t),e):c},e.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:O(+t),e):u},e},e.treemapBinary=function(e,t,a,r,o){function l(e,t,a,r,o,i,d){if(e>=t-1){var c=s[e];return c.x0=r,c.y0=o,c.x1=i,void(c.y1=d)}for(var p=n[e],u=a/2+p,g=e+1,h=t-1;g<h;){var m=g+h>>>1;n[m]<u?g=m+1:h=m}u-n[g-1]<n[g]-u&&e+1<g&&--g;var y=n[g]-p,f=a-y;if(i-r>d-o){var x=(r*f+i*y)/a;l(e,g,y,r,o,x,d),l(g,t,f,x,o,i,d)}else{var _=(o*f+d*y)/a;l(e,g,y,r,o,i,_),l(g,t,f,r,_,i,d)}}var s=e.children,d=s.length,n=Array(d+1),c,p;for(n[0]=p=c=0;c<d;++c)n[c+1]=p+=s[c].value;l(0,d,e.value,t,a,r,o)},e.treemapDice=U,e.treemapSlice=ae,e.treemapSliceDice=function(e,t,a,r,o){(1&e.depth?ae:U)(e,t,a,r,o)},e.treemapSquarify=se,e.treemapResquarify=de,Object.defineProperty(e,"__esModule",{value:!0})})},{}],158:[function(e,t,a){(function(r,o){"object"==typeof a&&"undefined"!=typeof t?o(a,e("d3-color")):"function"==typeof ka&&ka.amd?ka(["exports","d3-color"],o):o(r.d3=r.d3||{},r.d3)})(this,function(e,o){"use strict";function l(e,t,a,r,o){var i=e*e,n=i*e;return((1-3*e+3*i-n)*t+(4-6*i+3*n)*a+(1+3*e+3*i-3*n)*r+n*o)/6}function s(e){var a=e.length-1;return function(r){var o=0>=r?r=0:1<=r?(r=1,a-1):ba(r*a),i=e[o],n=e[o+1],s=0<o?e[o-1]:2*i-n,d=o<a-1?e[o+2]:2*n-i;return l((r-o/a)*a,s,i,n,d)}}function d(e){var a=e.length;return function(r){var o=ba((0>(r%=1)?++r:r)*a),i=e[(o+a-1)%a],n=e[o%a],s=e[(o+1)%a],d=e[(o+2)%a];return l((r-o/a)*a,i,n,s,d)}}function p(e){return function(){return e}}function u(e,a){return function(r){return e+r*a}}function g(e,r,o){return e=ya(e,o),r=ya(r,o)-e,o=1/o,function(a){return ya(e+a*r,o)}}function h(e,t){var a=t-e;return a?u(e,180<a||-180>a?a-360*V(a/360):a):p(isNaN(e)?t:e)}function f(e){return 1==(e=+e)?x:function(t,a){return a-t?g(t,a,e):p(isNaN(t)?a:t)}}function x(e,t){var a=t-e;return a?u(e,a):p(isNaN(e)?t:e)}function _(e){return function(t){var a=t.length,n=Array(a),l=Array(a),s=Array(a),d,c;for(d=0;d<a;++d)c=o.rgb(t[d]),n[d]=c.r||0,l[d]=c.g||0,s[d]=c.b||0;return n=e(n),l=e(l),s=e(s),c.opacity=1,function(e){return c.r=n(e),c.g=l(e),c.b=s(e),c+""}}}function v(e,t){var a=t?t.length:0,r=e?ea(a,e.length):0,o=Array(r),n=Array(a),l;for(l=0;l<r;++l)o[l]=E(e[l],t[l]);for(;l<a;++l)n[l]=t[l];return function(e){for(l=0;l<r;++l)n[l]=o[l](e);return n}}function k(e,r){var o=new Date;return e=+e,r-=e,function(a){return o.setTime(e+r*a),o}}function w(e,r){return e=+e,r-=e,function(a){return e+r*a}}function T(e,t){var r={},o={},i;for(i in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)i in e?r[i]=E(e[i],t[i]):o[i]=t[i];return function(e){for(i in r)o[i]=r[i](e);return o}}function A(e){return function(){return e}}function S(e){return function(a){return e(a)+""}}function C(e,r){var t=Y.lastIndex=W.lastIndex=0,o=-1,n=[],l=[],s,d,c;for(e+="",r+="";(s=Y.exec(e))&&(d=W.exec(r));)(c=d.index)>t&&(c=r.slice(t,c),n[o]?n[o]+=c:n[++o]=c),(s=s[0])===(d=d[0])?n[o]?n[o]+=d:n[++o]=d:(n[++o]=null,l.push({i:o,x:w(s,d)})),t=W.lastIndex;return t<r.length&&(c=r.slice(t),n[o]?n[o]+=c:n[++o]=c),2>n.length?l[0]?S(l[0].x):A(r):(r=l.length,function(e){for(var t=0,a;t<r;++t)n[(a=l[t]).i]=a.x(e);return n.join("")})}function E(e,a){var r=typeof a,t;return null==a||"boolean"==r?p(a):("number"==r?w:"string"==r?(t=o.color(a))?(a=t,H):C:a instanceof o.color?H:a instanceof Date?k:Array.isArray(a)?v:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?T:w)(e,a)}function I(t,r,o,i,n,e){var l,s,p;return(l=N(t*t+r*r))&&(t/=l,r/=l),(p=t*o+r*i)&&(o-=t*p,i-=r*p),(s=N(o*o+i*i))&&(o/=s,i/=s,p/=s),t*i<r*o&&(t=-t,r=-r,p=-p,l=-l),{translateX:n,translateY:e,rotate:L(r,t)*X,skewX:xa(p)*X,scaleX:l,scaleY:s}}function z(e){return"none"===e?Z:(ie||(ie=document.createElement("DIV"),ne=document.documentElement,le=document.defaultView),ie.style.transform=e,e=le.getComputedStyle(ne.appendChild(ie),null).getPropertyValue("transform"),ne.removeChild(ie),e=e.slice(7,-1).split(","),I(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function D(e){return null==e?Z:(se||(se=document.createElementNS("http://www.w3.org/2000/svg","g")),se.setAttribute("transform",e),!(e=se.transform.baseVal.consolidate()))?Z:(e=e.matrix,I(e.a,e.b,e.c,e.d,e.e,e.f))}function O(e,t,a,r){function o(e){return e.length?e.pop()+" ":""}function i(e,r,o,n,l,s){if(e!==o||r!==n){var d=l.push("translate(",null,t,null,a);s.push({i:d-4,x:w(e,o)},{i:d-2,x:w(r,n)})}else(o||n)&&l.push("translate("+o+t+n+a)}function n(e,t,i,n){e===t?t&&i.push(o(i)+"rotate("+t+r):(180<e-t?t+=360:180<t-e&&(e+=360),n.push({i:i.push(o(i)+"rotate(",null,r)-2,x:w(e,t)}))}function l(e,t,a,i){e===t?t&&a.push(o(a)+"skewX("+t+r):i.push({i:a.push(o(a)+"skewX(",null,r)-2,x:w(e,t)})}function d(e,t,a,r,n,l){if(e!==a||t!==r){var s=n.push(o(n)+"scale(",null,",",null,")");l.push({i:s-4,x:w(e,a)},{i:s-2,x:w(t,r)})}else(1!==a||1!==r)&&n.push(o(n)+"scale("+a+","+r+")")}return function(t,r){var c=[],s=[];return t=e(t),r=e(r),i(t.translateX,t.translateY,r.translateX,r.translateY,c,s),n(t.rotate,r.rotate,c,s),l(t.skewX,r.skewX,c,s),d(t.scaleX,t.scaleY,r.scaleX,r.scaleY,c,s),t=r=null,function(e){for(var t=-1,a=s.length,r;++t<a;)c[(r=s[t]).i]=r.x(e);return c.join("")}}}function R(e){return((e=m(e))+1/e)/2}function M(e){return((e=m(e))-1/e)/2}function j(e){return((e=m(2*e))-1)/(e+1)}function F(e){return function(a,r){var i=e((a=o.hsl(a)).h,(r=o.hsl(r)).h),n=x(a.s,r.s),s=x(a.l,r.l),l=x(a.opacity,r.opacity);return function(e){return a.h=i(e),a.s=n(e),a.l=s(e),a.opacity=l(e),a+""}}}function B(e){return function(a,r){var i=e((a=o.hcl(a)).h,(r=o.hcl(r)).h),n=x(a.c,r.c),s=x(a.l,r.l),l=x(a.opacity,r.opacity);return function(e){return a.h=i(e),a.c=n(e),a.l=s(e),a.opacity=l(e),a+""}}}function U(e){return function t(a){function r(r,i){var n=e((r=o.cubehelix(r)).h,(i=o.cubehelix(i)).h),d=x(r.s,i.s),s=x(r.l,i.l),l=x(r.opacity,i.opacity);return function(e){return r.h=n(e),r.s=d(e),r.l=s(ya(e,a)),r.opacity=l(e),r+""}}return a=+a,r.gamma=t,r}(1)}var H=function e(t){function a(e,t){var a=i((e=o.rgb(e)).r,(t=o.rgb(t)).r),r=i(e.g,t.g),n=i(e.b,t.b),l=x(e.opacity,t.opacity);return function(o){return e.r=a(o),e.g=r(o),e.b=n(o),e.opacity=l(o),e+""}}var i=f(t);return a.gamma=e,a}(1),G=_(s),q=_(d),Y=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,W=new RegExp(Y.source,"g"),X=180/Pe,Z={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},K=O(z,"px, ","px)","deg)"),J=O(D,", ",")",")"),Q=c,$=F(h),ee=F(x),te=B(h),ae=B(x),re=U(h),oe=U(x),ie,ne,le,se;e.interpolate=E,e.interpolateArray=v,e.interpolateBasis=s,e.interpolateBasisClosed=d,e.interpolateDate=k,e.interpolateDiscrete=function(e){var a=e.length;return function(r){return e[va(0,ea(a-1,ba(r*a)))]}},e.interpolateHue=function(e,t){var a=h(+e,+t);return function(e){var t=a(e);return t-360*ba(t/360)}},e.interpolateNumber=w,e.interpolateObject=T,e.interpolateRound=function(e,r){return e=+e,r-=e,function(a){return V(e+r*a)}},e.interpolateString=C,e.interpolateTransformCss=K,e.interpolateTransformSvg=J,e.interpolateZoom=function(e,t){var a=e[0],r=e[1],o=e[2],n=t[0],l=t[1],s=t[2],d=n-a,c=l-r,p=d*d+c*c,u,g;if(p<1e-12)g=P(s/o)/Q,u=function(e){return[a+e*d,r+e*c,o*m(Q*e*g)]};else{var h=N(p),y=(s*s-o*o+4*p)/(2*(2*o)*h),f=(s*s-o*o-4*p)/(2*(2*s)*h),x=P(N(y*y+1)-y),_=P(N(f*f+1)-f);g=(_-x)/Q,u=function(e){var t=e*g,i=R(x),n=o/(2*h)*(i*j(Q*t+x)-M(x));return[a+n*d,r+n*c,o*i/R(Q*t+x)]}}return u.duration=1e3*g,u},e.interpolateRgb=H,e.interpolateRgbBasis=G,e.interpolateRgbBasisClosed=q,e.interpolateHsl=$,e.interpolateHslLong=ee,e.interpolateLab=function(e,t){var r=x((e=o.lab(e)).l,(t=o.lab(t)).l),i=x(e.a,t.a),a=x(e.b,t.b),n=x(e.opacity,t.opacity);return function(o){return e.l=r(o),e.a=i(o),e.b=a(o),e.opacity=n(o),e+""}},e.interpolateHcl=te,e.interpolateHclLong=ae,e.interpolateCubehelix=re,e.interpolateCubehelixLong=oe,e.piecewise=function(e,t){for(var a=0,r=t.length-1,o=t[0],n=Array(0>r?0:r);a<r;)n[a]=e(o,o=t[++a]);return function(e){var a=va(0,ea(r-1,ba(e*=r)));return n[a](e-a)}},e.quantize=function(e,t){for(var a=Array(t),r=0;r<t;++r)a[r]=e(r/(t-1));return a},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-color":154}],159:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function t(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function a(){return new t}var o=Pe,i=2*o,n=1e-6;t.prototype=a.prototype={constructor:t,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,a,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+a)+","+(this._y1=+r)},bezierCurveTo:function(e,t,a,r,o,i){this._+="C"+ +e+","+ +t+","+ +a+","+ +r+","+(this._x1=+o)+","+(this._y1=+i)},arcTo:function(e,t,a,i,s){e=+e,t=+t,a=+a,i=+i,s=+s;var c=this._x1,p=this._y1,u=a-e,g=i-t,h=c-e,m=p-t,y=h*h+m*m;if(0>s)throw new Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(!(y>n));else if(!(_a(m*u-g*h)>n)||!s)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var f=a-c,x=i-p,_=u*u+g*g,b=N(_),v=N(y),k=s*fa((o-d((_+y-(f*f+x*x))/(2*b*v)))/2),l=k/v,w=k/b;_a(l-1)>n&&(this._+="L"+(e+l*h)+","+(t+l*m)),this._+="A"+s+","+s+",0,0,"+ +(m*f>h*x)+","+(this._x1=e+w*u)+","+(this._y1=t+w*g)}},arc:function(e,t,a,l,s,d){e=+e,t=+t,a=+a;var c=a*R(l),p=a*De(l),u=e+c,g=t+p,h=1^d,m=d?l-s:s-l;if(0>a)throw new Error("negative radius: "+a);null===this._x1?this._+="M"+u+","+g:(_a(this._x1-u)>n||_a(this._y1-g)>n)&&(this._+="L"+u+","+g);a&&(0>m&&(m=m%i+i),m>i-n?this._+="A"+a+","+a+",0,1,"+h+","+(e-c)+","+(t-p)+"A"+a+","+a+",0,1,"+h+","+(this._x1=u)+","+(this._y1=g):m>n&&(this._+="A"+a+","+a+",0,"+ +(m>=o)+","+h+","+(this._x1=e+a*R(s))+","+(this._y1=t+a*De(s))))},rect:function(e,t,a,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +a+"v"+ +r+"h"+-a+"Z"},toString:function(){return this._}},e.path=a,Object.defineProperty(e,"__esModule",{value:!0})})},{}],160:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e,t,a,r){if(isNaN(t)||isNaN(a))return e;var o=e._root,n={data:r},l=e._x0,s=e._y0,d=e._x1,c=e._y1,p,u,g,h,m,y,f,x,_;if(!o)return e._root=n,e;for(;o.length;)if((y=t>=(u=(l+d)/2))?l=u:d=u,(f=a>=(g=(s+c)/2))?s=g:c=g,(p=o,!(o=o[x=f<<1|y])))return p[x]=n,e;if(h=+e._x.call(null,o.data),m=+e._y.call(null,o.data),t===h&&a===m)return n.next=o,p?p[x]=n:e._root=n,e;do p=p?p[x]=[,,,,]:e._root=[,,,,],(y=t>=(u=(l+d)/2))?l=u:d=u,(f=a>=(g=(s+c)/2))?s=g:c=g;while((x=f<<1|y)==(_=(m>=g)<<1|h>=u));return p[_]=o,p[x]=n,e}function a(e){return e[0]}function r(e){return e[1]}function o(e,t,o){var i=new n(null==t?a:t,null==o?r:o,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function n(e,t,a,r,o,i){this._x=e,this._y=t,this._x0=a,this._y0=r,this._x1=o,this._y1=i,this._root=void 0}function l(e){for(var t={data:e.data},a=t;e=e.next;)a=a.next={data:e.data};return t}var s=function(e,t,a,r,o){this.node=e,this.x0=t,this.y0=a,this.x1=r,this.y1=o},d=o.prototype=n.prototype;d.copy=function(){var e=new n(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,a,r;if(!t)return e;if(!t.length)return e._root=l(t),e;for(a=[{source:t,target:e._root=[,,,,]}];t=a.pop();)for(var o=0;4>o;++o)(r=t.source[o])&&(r.length?a.push({source:r,target:t.target[o]=[,,,,]}):t.target[o]=l(r));return e},d.add=function(e){var a=+this._x.call(null,e),r=+this._y.call(null,e);return t(this.cover(a,r),a,r,e)},d.addAll=function(e){var a=e.length,r=Array(a),o=Array(a),n=1/0,l=1/0,s=-Infinity,c=-Infinity,p,u,g,h;for(u=0;u<a;++u)isNaN(g=+this._x.call(null,p=e[u]))||isNaN(h=+this._y.call(null,p))||(r[u]=g,o[u]=h,g<n&&(n=g),g>s&&(s=g),h<l&&(l=h),h>c&&(c=h));for(s<n&&(n=this._x0,s=this._x1),c<l&&(l=this._y0,c=this._y1),this.cover(n,l).cover(s,c),u=0;u<a;++u)t(this,r[u],o[u],e[u]);return this},d.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var a=this._x0,r=this._y0,o=this._x1,n=this._y1;if(isNaN(a))o=(a=ba(e))+1,n=(r=ba(t))+1;else if(a>e||e>o||r>t||t>n){var l=o-a,s=this._root,d,c;switch(c=(t<(r+n)/2)<<1|e<(a+o)/2){case 0:{do d=[,,,,],d[c]=s,s=d;while((l*=2,o=a+l,n=r+l,e>o||t>n));break}case 1:{do d=[,,,,],d[c]=s,s=d;while((l*=2,a=o-l,n=r+l,a>e||t>n));break}case 2:{do d=[,,,,],d[c]=s,s=d;while((l*=2,o=a+l,r=n-l,e>o||r>t));break}case 3:{do d=[,,,,],d[c]=s,s=d;while((l*=2,a=o-l,r=n-l,a>e||r>t));break}}this._root&&this._root.length&&(this._root=s)}else return this;return this._x0=a,this._y0=r,this._x1=o,this._y1=n,this},d.data=function(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e},d.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},d.find=function(e,t,a){var r=this._x0,o=this._y0,n=this._x1,l=this._y1,c=[],p=this._root,u,g,h,m,y,f,x;for(p&&c.push(new s(p,r,o,n,l)),null==a?a=1/0:(r=e-a,o=t-a,n=e+a,l=t+a,a*=a);f=c.pop();)if(!(!(p=f.node)||(g=f.x0)>n||(h=f.y0)>l||(m=f.x1)<r||(y=f.y1)<o))if(p.length){var _=(g+m)/2,b=(h+y)/2;c.push(new s(p[3],_,b,m,y),new s(p[2],g,b,_,y),new s(p[1],_,h,m,b),new s(p[0],g,h,_,b)),(x=(t>=b)<<1|e>=_)&&(f=c[c.length-1],c[c.length-1]=c[c.length-1-x],c[c.length-1-x]=f)}else{var v=e-+this._x.call(null,p.data),k=t-+this._y.call(null,p.data),w=v*v+k*k;if(w<a){var T=N(a=w);r=e-T,o=t-T,n=e+T,l=t+T,u=p.data}}return u},d.remove=function(e){if(isNaN(p=+this._x.call(null,e))||isNaN(u=+this._y.call(null,e)))return this;var t=this._root,a=this._x0,r=this._y0,o=this._x1,n=this._y1,l,s,d,c,p,u,g,h,m,f,_,b;if(!t)return this;if(t.length)for(;;){if((m=p>=(g=(a+o)/2))?a=g:o=g,(f=u>=(h=(r+n)/2))?r=h:n=h,(l=t,!(t=t[_=f<<1|m])))return this;if(!t.length)break;(l[3&_+1]||l[3&_+2]||l[3&_+3])&&(s=l,b=_)}for(;t.data!==e;)if(d=t,!(t=t.next))return this;return((c=t.next)&&delete t.next,d)?(c?d.next=c:delete d.next,this):l?(c?l[_]=c:delete l[_],(t=l[0]||l[1]||l[2]||l[3])&&t===(l[3]||l[2]||l[1]||l[0])&&!t.length&&(s?s[b]=t:this._root=t),this):(this._root=c,this)},d.removeAll=function(e){for(var t=0,a=e.length;t<a;++t)this.remove(e[t]);return this},d.root=function(){return this._root},d.size=function(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e},d.visit=function(e){var t=[],a=this._root,r,o,i,n,l,d;for(a&&t.push(new s(a,this._x0,this._y0,this._x1,this._y1));r=t.pop();)if(!e(a=r.node,i=r.x0,n=r.y0,l=r.x1,d=r.y1)&&a.length){var c=(i+l)/2,p=(n+d)/2;(o=a[3])&&t.push(new s(o,c,p,l,d)),(o=a[2])&&t.push(new s(o,i,p,c,d)),(o=a[1])&&t.push(new s(o,c,n,l,p)),(o=a[0])&&t.push(new s(o,i,n,c,p))}return this},d.visitAfter=function(e){var t=[],a=[],r;for(this._root&&t.push(new s(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var o=r.node;if(o.length){var i=r.x0,n=r.y0,l=r.x1,d=r.y1,c=(i+l)/2,p=(n+d)/2,u;(u=o[0])&&t.push(new s(u,i,n,c,p)),(u=o[1])&&t.push(new s(u,c,n,l,p)),(u=o[2])&&t.push(new s(u,i,p,c,d)),(u=o[3])&&t.push(new s(u,c,p,l,d))}a.push(r)}for(;r=a.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this},d.x=function(e){return arguments.length?(this._x=e,this):this._x},d.y=function(e){return arguments.length?(this._y=e,this):this._y},e.quadtree=o,Object.defineProperty(e,"__esModule",{value:!0})})},{}],161:[function(e,t,a){(function(r,o){"object"==typeof a&&"undefined"!=typeof t?o(a,e("d3-path")):"function"==typeof ka&&ka.amd?ka(["exports","d3-path"],o):o(r.d3=r.d3||{},r.d3)})(this,function(e,a){"use strict";function r(e){return function(){return e}}function i(e){return 1<e?0:-1>e?Ie:d(e)}function n(e){return 1<=e?ze:-1>=e?-ze:o(e)}function l(e){return e.innerRadius}function p(e){return e.outerRadius}function u(e){return e.startAngle}function g(e){return e.endAngle}function h(e){return e&&e.padAngle}function m(e,a,r,o,i,n,l,s){var d=r-e,c=o-a,p=l-i,u=s-n,g=u*d-p*c;if(!(g*g<Ee))return g=(p*(a-n)-u*(e-i))/g,[e+g*d,a+g*c]}function f(e,t,a,o,i,n,l){var s=e-a,c=t-o,p=(l?n:-n)/Le(s*s+c*c),u=p*c,g=-p*s,h=e+u,m=t+g,y=a+u,f=o+g,x=(h+y)/2,_=(m+f)/2,b=y-h,v=f-m,k=b*b+v*v,w=i-n,r=h*f-y*m,T=(0>v?-1:1)*Le(Ae(0,w*w*k-r*r)),d=(r*v-b*T)/k,A=(-r*b-v*T)/k,S=(r*v+b*T)/k,C=(-r*b+v*T)/k,L=d-x,E=A-_,I=S-x,z=C-_;return L*L+E*E>I*I+z*z&&(d=S,A=C),{cx:d,cy:A,x01:-u,y01:-g,x11:d*(i/w-1),y11:A*(i/w-1)}}function _(){function e(){var e=+t.apply(this,arguments),l=+o.apply(this,arguments),p=c.apply(this,arguments)-ze,u=y.apply(this,arguments)-ze,g=ke(u-p),h=u>p,_,v;if(b||(b=_=a.path()),l<e&&(v=l,l=e,e=v),!(l>Ee))b.moveTo(0,0);else if(g>Oe-Ee)b.moveTo(l*Te(p),l*Ce(p)),b.arc(0,0,l,p,u,!h),e>Ee&&(b.moveTo(e*Te(u),e*Ce(u)),b.arc(0,0,e,u,p,h));else{var k=p,w=u,T=p,A=u,S=g,C=g,L=x.apply(this,arguments)/2,E=L>Ee&&(d?+d.apply(this,arguments):Le(e*e+l*l)),I=Se(ke(l-e)/2,+s.apply(this,arguments)),z=I,P=I,D,O;if(E>Ee){var R=n(E/e*Ce(L)),M=n(E/l*Ce(L));(S-=2*R)>Ee?(R*=h?1:-1,T+=R,A-=R):(S=0,T=A=(p+u)/2),(C-=2*M)>Ee?(M*=h?1:-1,k+=M,w-=M):(C=0,k=w=(p+u)/2)}var j=l*Te(k),F=l*Ce(k),B=e*Te(A),N=e*Ce(A);if(I>Ee){var V=l*Te(w),U=l*Ce(w),H=e*Te(T),G=e*Ce(T),q;if(g<Ie&&(q=m(j,F,H,G,V,U,B,N))){var Y=j-q[0],W=F-q[1],X=V-q[0],Z=U-q[1],K=1/Ce(i((Y*X+W*Z)/(Le(Y*Y+W*W)*Le(X*X+Z*Z)))/2),J=Le(q[0]*q[0]+q[1]*q[1]);z=Se(I,(e-J)/(K-1)),P=Se(I,(l-J)/(K+1))}}C>Ee?P>Ee?(D=f(H,G,j,F,l,P,h),O=f(V,U,B,N,l,P,h),b.moveTo(D.cx+D.x01,D.cy+D.y01),P<I?b.arc(D.cx,D.cy,P,we(D.y01,D.x01),we(O.y01,O.x01),!h):(b.arc(D.cx,D.cy,P,we(D.y01,D.x01),we(D.y11,D.x11),!h),b.arc(0,0,l,we(D.cy+D.y11,D.cx+D.x11),we(O.cy+O.y11,O.cx+O.x11),!h),b.arc(O.cx,O.cy,P,we(O.y11,O.x11),we(O.y01,O.x01),!h))):(b.moveTo(j,F),b.arc(0,0,l,k,w,!h)):b.moveTo(j,F),e>Ee&&S>Ee?z>Ee?(D=f(B,N,V,U,e,-z,h),O=f(j,F,H,G,e,-z,h),b.lineTo(D.cx+D.x01,D.cy+D.y01),z<I?b.arc(D.cx,D.cy,z,we(D.y01,D.x01),we(O.y01,O.x01),!h):(b.arc(D.cx,D.cy,z,we(D.y01,D.x01),we(D.y11,D.x11),!h),b.arc(0,0,e,we(D.cy+D.y11,D.cx+D.x11),we(O.cy+O.y11,O.cx+O.x11),h),b.arc(O.cx,O.cy,z,we(O.y11,O.x11),we(O.y01,O.x01),!h))):b.arc(0,0,e,A,T,h):b.lineTo(B,N)}return(b.closePath(),_)?(b=null,_+""||null):void 0}var t=l,o=p,s=r(0),d=null,c=u,y=g,x=h,b=null;return e.centroid=function(){var e=(+t.apply(this,arguments)+ +o.apply(this,arguments))/2,r=(+c.apply(this,arguments)+ +y.apply(this,arguments))/2-Ie/2;return[Te(r)*e,Ce(r)*e]},e.innerRadius=function(a){return arguments.length?(t="function"==typeof a?a:r(+a),e):t},e.outerRadius=function(t){return arguments.length?(o="function"==typeof t?t:r(+t),e):o},e.cornerRadius=function(t){return arguments.length?(s="function"==typeof t?t:r(+t),e):s},e.padRadius=function(t){return arguments.length?(d=null==t?null:"function"==typeof t?t:r(+t),e):d},e.startAngle=function(t){return arguments.length?(c="function"==typeof t?t:r(+t),e):c},e.endAngle=function(t){return arguments.length?(y="function"==typeof t?t:r(+t),e):y},e.padAngle=function(t){return arguments.length?(x="function"==typeof t?t:r(+t),e):x},e.context=function(t){return arguments.length?(b=null==t?null:t,e):b},e}function b(e){this._context=e}function v(e){return new b(e)}function w(e){return e[0]}function t(e){return e[1]}function y(){function e(e){var t=e.length,r=!1,n,g,h;for(null==c&&(u=p(h=a.path())),n=0;n<=t;++n)!(n<t&&s(g=e[n],n,e))==r&&((r=!r)?u.lineStart():u.lineEnd()),r&&u.point(+o(g,n,e),+l(g,n,e));if(h)return u=null,h+""||null}var o=w,l=t,s=r(!0),c=null,p=v,u=null;return e.x=function(t){return arguments.length?(o="function"==typeof t?t:r(+t),e):o},e.y=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),e):l},e.defined=function(t){return arguments.length?(s="function"==typeof t?t:r(!!t),e):s},e.curve=function(t){return arguments.length?(p=t,null!=c&&(u=p(c)),e):p},e.context=function(t){return arguments.length?(null==t?c=u=null:u=p(c=t),e):c},e}function x(){function e(e){var t=e.length,r=!1,o=Array(t),n=Array(t),y,f,x,_,b;for(null==g&&(m=h(b=a.path())),y=0;y<=t;++y){if(!(y<t&&u(_=e[y],y,e))==r)if(r=!r)f=y,m.areaStart(),m.lineStart();else{for(m.lineEnd(),m.lineStart(),x=y-1;x>=f;--x)m.point(o[x],n[x]);m.lineEnd(),m.areaEnd()}r&&(o[y]=+l(_,y,e),n[y]=+c(_,y,e),m.point(s?+s(_,y,e):o[y],p?+p(_,y,e):n[y]))}if(b)return m=null,b+""||null}function o(){return y().defined(u).curve(h).context(g)}var l=w,s=null,c=r(0),p=t,u=r(!0),g=null,h=v,m=null;return e.x=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),s=null,e):l},e.x0=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),e):l},e.x1=function(t){return arguments.length?(s=null==t?null:"function"==typeof t?t:r(+t),e):s},e.y=function(t){return arguments.length?(c="function"==typeof t?t:r(+t),p=null,e):c},e.y0=function(t){return arguments.length?(c="function"==typeof t?t:r(+t),e):c},e.y1=function(t){return arguments.length?(p=null==t?null:"function"==typeof t?t:r(+t),e):p},e.lineX0=e.lineY0=function(){return o().x(l).y(c)},e.lineY1=function(){return o().x(l).y(p)},e.lineX1=function(){return o().x(s).y(c)},e.defined=function(t){return arguments.length?(u="function"==typeof t?t:r(!!t),e):u},e.curve=function(t){return arguments.length?(h=t,null!=g&&(m=h(g)),e):h},e.context=function(t){return arguments.length?(null==t?g=m=null:m=h(g=t),e):g},e}function T(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function A(e){return e}function S(){function e(e){var r=e.length,n=0,c=Array(r),u=Array(r),g=+l.apply(this,arguments),h=ea(Oe,va(-Oe,s.apply(this,arguments)-g)),m=ea(_a(h)/r,d.apply(this,arguments)),p=m*(0>h?-1:1),y,f,x,_,b;for(y=0;y<r;++y)0<(b=u[c[y]=y]=+t(e[y],y,e))&&(n+=b);for(null==a?null!=o&&c.sort(function(t,a){return o(e[t],e[a])}):c.sort(function(e,t){return a(u[e],u[t])}),y=0,x=n?(h-r*p)/n:0;y<r;++y,g=_)f=c[y],b=u[f],_=g+(0<b?b*x:0)+p,u[f]={data:e[f],index:y,value:b,startAngle:g,endAngle:_,padAngle:m};return u}var t=A,a=T,o=null,l=r(0),s=r(Oe),d=r(0);return e.value=function(a){return arguments.length?(t="function"==typeof a?a:r(+a),e):t},e.sortValues=function(t){return arguments.length?(a=t,o=null,e):a},e.sort=function(t){return arguments.length?(o=t,a=null,e):o},e.startAngle=function(t){return arguments.length?(l="function"==typeof t?t:r(+t),e):l},e.endAngle=function(t){return arguments.length?(s="function"==typeof t?t:r(+t),e):s},e.padAngle=function(t){return arguments.length?(d="function"==typeof t?t:r(+t),e):d},e}function C(e){this._curve=e}function E(e){function t(t){return new C(e(t))}return t._curve=e,t}function I(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(E(e)):t()._curve},e}function z(){return I(y().curve(Re))}function P(){var e=x().curve(Re),t=e.curve,a=e.lineX0,r=e.lineX1,o=e.lineY0,i=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return I(a())},delete e.lineX0,e.lineEndAngle=function(){return I(r())},delete e.lineX1,e.lineInnerRadius=function(){return I(o())},delete e.lineY0,e.lineOuterRadius=function(){return I(i())},delete e.lineY1,e.curve=function(e){return arguments.length?t(E(e)):t()._curve},e}function D(e,t){return[(t=+t)*R(e-=Pe/2),t*De(e)]}function O(e){return e.source}function M(e){return e.target}function j(e){function o(){var r=Me.call(arguments),o=i.apply(this,r),s=n.apply(this,r),t;if(c||(c=t=a.path()),e(c,+l.apply(this,(r[0]=o,r)),+d.apply(this,r),+l.apply(this,(r[0]=s,r)),+d.apply(this,r)),t)return c=null,t+""||null}var i=O,n=M,l=w,d=t,c=null;return o.source=function(e){return arguments.length?(i=e,o):i},o.target=function(e){return arguments.length?(n=e,o):n},o.x=function(e){return arguments.length?(l="function"==typeof e?e:r(+e),o):l},o.y=function(e){return arguments.length?(d="function"==typeof e?e:r(+e),o):d},o.context=function(e){return arguments.length?(c=null==e?null:e,o):c},o}function F(e,t,a,r,o){e.moveTo(t,a),e.bezierCurveTo(t=(t+r)/2,a,t,o,r,o)}function B(e,t,a,r,o){e.moveTo(t,a),e.bezierCurveTo(t,a=(a+o)/2,r,a,r,o)}function V(e,t,a,r,o){var i=D(t,a),n=D(t,a=(a+o)/2),l=D(r,a),s=D(r,o);e.moveTo(i[0],i[1]),e.bezierCurveTo(n[0],n[1],l[0],l[1],s[0],s[1])}function U(){function e(){var e;if(i||(i=e=a.path()),t.apply(this,arguments).draw(i,+o.apply(this,arguments)),e)return i=null,e+""||null}var t=r(je),o=r(64),i=null;return e.type=function(a){return arguments.length?(t="function"==typeof a?a:r(a),e):t},e.size=function(t){return arguments.length?(o="function"==typeof t?t:r(+t),e):o},e.context=function(t){return arguments.length?(i=null==t?null:t,e):i},e}function H(){}function G(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function q(e){this._context=e}function Y(e){this._context=e}function W(e){this._context=e}function X(e,t){this._basis=new q(e),this._beta=t}function Z(e,t,a){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-a),e._x2,e._y2)}function K(e,t){this._context=e,this._k=(1-t)/6}function J(e,t){this._context=e,this._k=(1-t)/6}function Q(e,t){this._context=e,this._k=(1-t)/6}function $(e,t,r){var o=e._x1,i=e._y1,l=e._x2,s=e._y2;if(e._l01_a>Ee){var d=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,a=3*e._l01_a*(e._l01_a+e._l12_a);o=(o*d-e._x0*e._l12_2a+e._x2*e._l01_2a)/a,i=(i*d-e._y0*e._l12_2a+e._y2*e._l01_2a)/a}if(e._l23_a>Ee){var n=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);l=(l*n+e._x1*e._l23_2a-t*e._l12_2a)/c,s=(s*n+e._y1*e._l23_2a-r*e._l12_2a)/c}e._context.bezierCurveTo(o,i,l,s,e._x2,e._y2)}function ee(e,t){this._context=e,this._alpha=t}function te(e,t){this._context=e,this._alpha=t}function ae(e,t){this._context=e,this._alpha=t}function re(e){this._context=e}function oe(e){return 0>e?-1:1}function ie(e,t,a){var r=e._x1-e._x0,o=t-e._x1,i=(e._y1-e._y0)/(r||0>o&&-0),n=(a-e._y1)/(o||0>r&&-0);return(oe(i)+oe(n))*ea(_a(i),_a(n),.5*_a((i*o+n*r)/(r+o)))||0}function ne(e,a){var t=e._x1-e._x0;return t?(3*(e._y1-e._y0)/t-a)/2:a}function le(e,t,a){var r=e._x0,o=e._y0,i=e._x1,n=e._y1,l=(i-r)/3;e._context.bezierCurveTo(r+l,o+l*t,i-l,n-l*a,i,n)}function se(e){this._context=e}function de(e){this._context=new ce(e)}function ce(e){this._context=e}function pe(e){this._context=e}function ue(e){var t=e.length-1,o=Array(t),a=Array(t),n=Array(t),r,l;for(o[0]=0,a[0]=2,n[0]=e[0]+2*e[1],r=1;r<t-1;++r)o[r]=1,a[r]=4,n[r]=4*e[r]+2*e[r+1];for(o[t-1]=2,a[t-1]=7,n[t-1]=8*e[t-1]+e[t],r=1;r<t;++r)l=o[r]/a[r-1],a[r]-=l,n[r]-=l*n[r-1];for(o[t-1]=n[t-1]/a[t-1],r=t-2;0<=r;--r)o[r]=(n[r]-o[r+1])/a[r];for(a[t-1]=(e[t]+o[t-1])/2,r=0;r<t-1;++r)a[r]=2*e[r+1]-o[r+1];return[o,a]}function ge(e,a){this._context=e,this._t=a}function he(e,t){if(1<(d=e.length))for(var a=1,r=e[t[0]],o=r.length,l,s,d;a<d;++a)for(s=r,r=e[t[a]],l=0;l<o;++l)r[l][1]+=r[l][0]=isNaN(s[l][1])?s[l][0]:s[l][1]}function me(e){for(var t=e.length,a=Array(t);0<=--t;)a[t]=t;return a}function ye(e,t){return e[t]}function fe(){function e(e){var r=t.apply(this,arguments),l=e.length,s=r.length,d=Array(s),c,p;for(c=0;c<s;++c){for(var u=r[c],g=d[c]=Array(l),h=0,m;h<l;++h)g[h]=m=[0,+n(e[h],u,h,e)],m.data=e[h];g.key=u}for(c=0,p=a(d);c<s;++c)d[p[c]].index=c;return o(d,p),d}var t=r([]),a=me,o=he,n=ye;return e.keys=function(a){return arguments.length?(t="function"==typeof a?a:r(Me.call(a)),e):t},e.value=function(t){return arguments.length?(n="function"==typeof t?t:r(+t),e):n},e.order=function(t){return arguments.length?(a=null==t?me:"function"==typeof t?t:r(Me.call(t)),e):a},e.offset=function(t){return arguments.length?(o=null==t?he:t,e):o},e}function xe(e){var t=e.map(_e);return me(e).sort(function(e,a){return t[e]-t[a]})}function _e(e){for(var t=-1,a=0,r=e.length,o=-Infinity,n;++t<r;)(n=+e[t][1])>o&&(o=n,a=t);return a}function be(e){var t=e.map(ve);return me(e).sort(function(e,a){return t[e]-t[a]})}function ve(e){for(var t=0,a=-1,r=e.length,o;++a<r;)(o=+e[a][1])&&(t+=o);return t}var ke=_a,we=L,Te=R,Ae=va,Se=ea,Ce=De,Le=N,Ee=1e-12,Ie=Pe,ze=Ie/2,Oe=2*Ie;b.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);}}};var Re=E(v);C.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*De(e),t*-R(e))}};var Me=Array.prototype.slice,je={draw:function(e,t){var a=N(t/Ie);e.moveTo(a,0),e.arc(0,0,a,0,Oe)}},Fe={draw:function(e,t){var a=N(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},Be=N(1/3),Ne={draw:function(e,t){var a=N(t/(2*Be)),r=a*Be;e.moveTo(0,-a),e.lineTo(r,0),e.lineTo(0,a),e.lineTo(-r,0),e.closePath()}},Ve=De(Ie/10)/De(7*Ie/10),Ue=De(Oe/10)*Ve,He=-R(Oe/10)*Ve,Ge={draw:function(e,t){var o=N(t*.8908130915292852),r=Ue*o,n=He*o;e.moveTo(0,-o),e.lineTo(r,n);for(var l=1;5>l;++l){var d=Oe*l/5,a=R(d),c=De(d);e.lineTo(c*o,-a*o),e.lineTo(a*r-c*n,c*r+a*n)}e.closePath()}},qe={draw:function(e,t){var a=N(t),r=-a/2;e.rect(r,r,a,a)}},Ye=N(3),We={draw:function(e,t){var a=-N(t/(3*Ye));e.moveTo(0,2*a),e.lineTo(-Ye*a,-a),e.lineTo(Ye*a,-a),e.closePath()}},Xe=-.5,c=N(3)/2,s=1/N(12),k={draw:function(e,t){var a=N(t/(3*(s/2+1))),r=a/2,o=a*s,i=r,n=a*s+a,l=-i,d=n;e.moveTo(r,o),e.lineTo(i,n),e.lineTo(l,d),e.lineTo(Xe*r-c*o,c*r+Xe*o),e.lineTo(Xe*i-c*n,c*i+Xe*n),e.lineTo(Xe*l-c*d,c*l+Xe*d),e.lineTo(Xe*r+c*o,Xe*o-c*r),e.lineTo(Xe*i+c*n,Xe*n-c*i),e.lineTo(Xe*l+c*d,Xe*d-c*l),e.closePath()}};q.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:G(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:G(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Y.prototype={areaStart:H,areaEnd:H,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:G(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},W.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,r):this._context.moveTo(a,r);break;case 3:this._point=4;default:G(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},X.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,a=this._y,r=e.length-1;if(0<r)for(var o=e[0],n=a[0],l=e[r]-o,s=a[r]-n,d=-1,c;++d<=r;)c=d/r,this._basis.point(this._beta*e[d]+(1-this._beta)*(o+c*l),this._beta*a[d]+(1-this._beta)*(n+c*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Ze=function e(t){function a(e){return 1===t?new q(e):new X(e,t)}return a.beta=function(t){return e(+t)},a}(.85);K.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Z(this,this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Z(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ke=function e(t){function a(e){return new K(e,t)}return a.tension=function(t){return e(+t)},a}(0);J.prototype={areaStart:H,areaEnd:H,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Z(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Je=function e(t){function a(e){return new J(e,t)}return a.tension=function(t){return e(+t)},a}(0);Q.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Z(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Qe=function e(t){function a(e){return new Q(e,t)}return a.tension=function(t){return e(+t)},a}(0);ee.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,r=this._y2-t;this._l23_a=N(this._l23_2a=ya(a*a+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:$(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var $e=function e(t){function a(e){return t?new ee(e,t):new K(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);te.prototype={areaStart:H,areaEnd:H,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,r=this._y2-t;this._l23_a=N(this._l23_2a=ya(a*a+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:$(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var et=function e(t){function a(e){return t?new te(e,t):new J(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,r=this._y2-t;this._l23_a=N(this._l23_2a=ya(a*a+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var tt=function e(t){function a(e){return t?new ae(e,t):new Q(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);re.prototype={areaStart:H,areaEnd:H,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},se.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:le(this,this._t0,ne(this,this._t0));}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(e=+e,t=+t,e!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,le(this,ne(this,a=ie(this,e,t)),a);break;default:le(this,this._t0,a=ie(this,e,t));}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}},(de.prototype=Object.create(se.prototype)).point=function(e,t){se.prototype.point.call(this,t,e)},ce.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,r,o,i){this._context.bezierCurveTo(t,e,r,a,i,o)}},pe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===a)this._context.lineTo(e[1],t[1]);else for(var r=ue(e),o=ue(t),i=0,n=1;n<a;++i,++n)this._context.bezierCurveTo(r[0][i],o[0][i],r[1][i],o[1][i],e[n],t[n]);(this._line||0!==this._line&&1===a)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&1>this._t&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(0>=this._t)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}break}}this._x=e,this._y=t}},e.arc=_,e.area=x,e.line=y,e.pie=S,e.areaRadial=P,e.radialArea=P,e.lineRadial=z,e.radialLine=z,e.pointRadial=D,e.linkHorizontal=function(){return j(F)},e.linkVertical=function(){return j(B)},e.linkRadial=function(){var e=j(V);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e},e.symbol=U,e.symbols=[je,Fe,Ne,qe,Ge,We,k],e.symbolCircle=je,e.symbolCross=Fe,e.symbolDiamond=Ne,e.symbolSquare=qe,e.symbolStar=Ge,e.symbolTriangle=We,e.symbolWye=k,e.curveBasisClosed=function(e){return new Y(e)},e.curveBasisOpen=function(e){return new W(e)},e.curveBasis=function(e){return new q(e)},e.curveBundle=Ze,e.curveCardinalClosed=Je,e.curveCardinalOpen=Qe,e.curveCardinal=Ke,e.curveCatmullRomClosed=et,e.curveCatmullRomOpen=tt,e.curveCatmullRom=$e,e.curveLinearClosed=function(e){return new re(e)},e.curveLinear=v,e.curveMonotoneX=function(e){return new se(e)},e.curveMonotoneY=function(e){return new de(e)},e.curveNatural=function(e){return new pe(e)},e.curveStep=function(e){return new ge(e,.5)},e.curveStepAfter=function(e){return new ge(e,1)},e.curveStepBefore=function(e){return new ge(e,0)},e.stack=fe,e.stackOffsetExpand=function(e,t){if(0<(l=e.length)){for(var a=0,r=e[0].length,o,l,s;a<r;++a){for(s=o=0;o<l;++o)s+=e[o][a][1]||0;if(s)for(o=0;o<l;++o)e[o][a][1]/=s}he(e,t)}},e.stackOffsetDiverging=function(e,t){if(1<(u=e.length))for(var a=0,r=e[t[0]].length,o,l,s,c,p,u;a<r;++a)for(c=p=0,o=0;o<u;++o)0<=(s=(l=e[t[o]][a])[1]-l[0])?(l[0]=c,l[1]=c+=s):0>s?(l[1]=p,l[0]=p+=s):l[0]=c},e.stackOffsetNone=he,e.stackOffsetSilhouette=function(e,t){if(0<(l=e.length)){for(var a=0,r=e[t[0]],o=r.length,l;a<o;++a){for(var s=0,d=0;s<l;++s)d+=e[s][a][1]||0;r[a][1]+=r[a][0]=-d/2}he(e,t)}},e.stackOffsetWiggle=function(e,t){if(0<(s=e.length)&&0<(l=(o=e[t[0]]).length)){for(var a=0,r=1,o,l,s;r<l;++r){for(var d=0,c=0,p=0;d<s;++d){for(var u=e[t[d]],g=u[r][1]||0,h=u[r-1][1]||0,f=(g-h)/2,x=0;x<d;++x){var _=e[t[x]],b=_[r][1]||0,v=_[r-1][1]||0;f+=b-v}c+=g,p+=f*g}o[r-1][1]+=o[r-1][0]=a,c&&(a-=p/c)}o[r-1][1]+=o[r-1][0]=a,he(e,t)}},e.stackOrderAppearance=xe,e.stackOrderAscending=be,e.stackOrderDescending=function(e){return be(e).reverse()},e.stackOrderInsideOut=function(e){var t=e.length,a=e.map(ve),r=xe(e),o=0,n=0,l=[],s=[],d,c;for(d=0;d<t;++d)c=r[d],o<n?(o+=a[c],l.push(c)):(n+=a[c],s.push(c));return s.reverse().concat(l)},e.stackOrderNone=me,e.stackOrderReverse=function(e){return me(e).reverse()},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-path":159}],162:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.d3=e.d3||{})})(this,function(e){"use strict";function a(){return m||(x(r),m=f.now()+y)}function r(){m=0}function o(){this._call=this._time=this._next=null}function i(e,a,r){var i=new o;return i.restart(e,a,r),i}function n(){a(),++p;for(var r=_,o;r;)0<=(o=m-r._time)&&r._call.call(null,o),r=r._next;--p}function l(){m=(h=f.now())+y,p=u=0;try{n()}finally{p=0,d(),m=0}}function s(){var e=f.now(),t=e-h;t>1000&&(y-=t,h=e)}function d(){for(var e=_,t=1/0,a,r;e;)e._call?(t>e._time&&(t=e._time),a=e,e=e._next):(r=e._next,e._next=null,e=a?a._next=r:_=r);b=a,c(t)}function c(e){if(!p){u&&(u=clearTimeout(u));var t=e-m;24<t?(e<1/0&&(u=setTimeout(l,e-f.now()-y)),g&&(g=clearInterval(g))):(!g&&(h=f.now(),g=setInterval(s,1000)),p=1,x(l))}}var p=0,u=0,g=0,h=0,m=0,y=0,f="object"==typeof performance&&performance.now?performance:Date,x="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)},_,b;o.prototype=i.prototype={constructor:o,restart:function(e,t,r){if("function"!=typeof e)throw new TypeError("callback is not a function");r=(null==r?a():+r)+(null==t?0:+t),this._next||b===this||(b?b._next=this:_=this,b=this),this._call=e,this._time=r,c()},stop:function(){this._call&&(this._call=null,this._time=1/0,c())}};e.now=a,e.timer=i,e.timerFlush=n,e.timeout=function(e,a,r){var i=new o;return a=null==a?0:+a,i.restart(function(t){i.stop(),e(t+a)},a,r),i},e.interval=function(e,r,i){var n=new o,t=r;return null==r?(n.restart(e,r,i),n):(r=+r,i=null==i?a():+i,n.restart(function a(o){o+=t,n.restart(a,t+=r,i),e(o)},r,i),n)},Object.defineProperty(e,"__esModule",{value:!0})})},{}],163:[function(e,t){!function(){function e(e){return e&&(e.ownerDocument||e.document||e).documentElement}function r(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function l(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function s(e){return null===e?NaN:+e}function p(e){return!isNaN(e)}function u(e){return{left:function(t,a,r,o){for(3>arguments.length&&(r=0),4>arguments.length&&(o=t.length);r<o;){var i=r+o>>>1;0>e(t[i],a)?r=i+1:o=i}return r},right:function(t,a,r,o){for(3>arguments.length&&(r=0),4>arguments.length&&(o=t.length);r<o;){var i=r+o>>>1;0<e(t[i],a)?o=i:r=i+1}return r}}}function g(e){return e.length}function h(e){for(var t=1;e*t%1;)t*=10;return t}function y(e,t){for(var a in t)Object.defineProperty(e.prototype,a,{value:t[a],enumerable:!1})}function _(){this._=Object.create(null)}function b(e){return"__proto__"===(e+="")||"\0"===e[0]?"\0"+e:e}function v(e){return"\0"===(e+="")[0]?e.slice(1):e}function k(e){return b(e)in this._}function w(e){return(e=b(e))in this._&&delete this._[e]}function T(){var e=[];for(var t in this._)e.push(v(t));return e}function A(){var e=0;for(var t in this._)++e;return e}function S(){for(var e in this._)return!1;return!0}function C(){this._=Object.create(null)}function z(e){return e}function O(e,t,a){return function(){var r=a.apply(t,arguments);return r===t?e:r}}function j(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var a=0,r=Cn.length,o;a<r;++a)if(o=Cn[a]+t,o in e)return o}function F(){}function B(){}function U(e){function t(){for(var t=a,r=-1,o=t.length,n;++r<o;)(n=t[r].on)&&n.apply(this,arguments);return e}var a=[],r=new _;return t.on=function(t,o){var n=r.get(t),l;return 2>arguments.length?n&&n.on:(n&&(n.on=null,a=a.slice(0,l=a.indexOf(n)).concat(a.slice(l+1)),r.remove(t)),o&&a.push(r.set(t,{on:o})),e)},t}function H(){_n.event.preventDefault()}function G(){for(var t=_n.event,a;a=t.sourceEvent;)t=a;return t}function q(e){for(var t=new B,a=0,r=arguments.length;++a<r;)t[arguments[a]]=U(t);return t.of=function(a,r){return function(o){try{var i=o.sourceEvent=_n.event;o.target=e,_n.event=o,t[o.type].apply(a,r)}finally{_n.event=i}}},t}function Y(e){return En(e,Dn),e}function W(e){return"function"==typeof e?e:function(){return In(e,this)}}function X(e){return"function"==typeof e?e:function(){return zn(e,this)}}function Z(e,t){function a(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function o(){this.setAttribute(e,t)}function i(){this.setAttributeNS(e.space,e.local,t)}function n(){var a=t.apply(this,arguments);null==a?this.removeAttribute(e):this.setAttribute(e,a)}function l(){var a=t.apply(this,arguments);null==a?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,a)}return e=_n.ns.qualify(e),null==t?e.local?r:a:"function"==typeof t?e.local?l:n:e.local?i:o}function K(e){return e.trim().replace(/\s+/g," ")}function J(e){return new RegExp("(?:^|\\s+)"+_n.requote(e)+"(?:\\s+|$)","g")}function Q(e){return(e+"").trim().split(/^|\s+/)}function $(e,t){function a(){for(var a=-1;++a<o;)e[a](this,t)}function r(){for(var a=-1,r=t.apply(this,arguments);++a<o;)e[a](this,r)}e=Q(e).map(ee);var o=e.length;return"function"==typeof t?r:a}function ee(e){var t=J(e);return function(a,r){if(o=a.classList)return r?o.add(e):o.remove(e);var o=a.getAttribute("class")||"";r?(t.lastIndex=0,!t.test(o)&&a.setAttribute("class",K(o+" "+e))):a.setAttribute("class",K(o.replace(t," ")))}}function te(e,t,a){return null==t?function(){this.style.removeProperty(e)}:"function"==typeof t?function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,a)}:function(){this.style.setProperty(e,t,a)}}function ae(e,t){return null==t?function(){delete this[e]}:"function"==typeof t?function(){var a=t.apply(this,arguments);null==a?delete this[e]:this[e]=a}:function(){this[e]=t}}function re(e){function t(){var t=this.ownerDocument,a=this.namespaceURI;return"http://www.w3.org/1999/xhtml"===a&&"http://www.w3.org/1999/xhtml"===t.documentElement.namespaceURI?t.createElement(e):t.createElementNS(a,e)}function a(){return this.ownerDocument.createElementNS(e.space,e.local)}return"function"==typeof e?e:(e=_n.ns.qualify(e)).local?a:t}function oe(){var e=this.parentNode;e&&e.removeChild(this)}function ie(e){return{__data__:e}}function ne(e){return function(){return Pn(this,e)}}function le(e){return arguments.length||(e=l),function(t,a){return t&&a?e(t.__data__,a.__data__):!t-!a}}function se(e,t){for(var a=0,r=e.length;a<r;a++)for(var o=e[a],l=0,s=o.length,n;l<s;l++)(n=o[l])&&t(n,l,a);return e}function de(e){return En(e,Rn),e}function ce(e){var t,a;return function(r,o,i){var l=e[i].update,s=l.length,n;for(i!=a&&(a=i,t=0),o>=t&&(t=o+1);!(n=l[t])&&++t<s;);return n}}function pe(e,t,a){function r(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function o(){var o=i(t,f(arguments));r.call(this),this.addEventListener(e,this[s]=o,o.$=a),o._=t}function n(){var t=new RegExp("^__on([^.]+)"+_n.requote(e)+"$"),a;for(var r in this)if(a=r.match(t)){var o=this[r];this.removeEventListener(a[1],o,o.$),delete this[r]}}var s="__on"+e,d=e.indexOf("."),i=ue;0<d&&(e=e.slice(0,d));var l=Mn.get(e);return l&&(e=l,i=ge),d?t?o:r:t?F:n}function ue(e,t){return function(a){var r=_n.event;_n.event=a,t[0]=this.__data__;try{e.apply(this,t)}finally{_n.event=r}}}function ge(e,t){var a=ue(e,t);return function(t){var e=this,r=t.relatedTarget;r&&(r===e||8&r.compareDocumentPosition(e))||a.call(e,t)}}function he(t){var a=".dragsuppress-"+ ++jn,o="click"+a,i=_n.select(r(t)).on("touchmove"+a,H).on("dragstart"+a,H).on("selectstart"+a,H);if(null==Fn&&(Fn=!("onselectstart"in t)&&j(t.style,"userSelect")),Fn){var n=e(t).style,l=n[Fn];n[Fn]="none"}return function(e){if(i.on(a,null),Fn&&(n[Fn]=l),e){var t=function(){i.on(o,null)};i.on(o,function(){H(),t()},!0),setTimeout(t,0)}}}function me(t,a){a.changedTouches&&(a=a.changedTouches[0]);var o=t.ownerSVGElement||t;if(o.createSVGPoint){var i=o.createSVGPoint();if(0>Bn){var n=r(t);if(n.scrollX||n.scrollY){o=_n.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var l=o[0][0].getScreenCTM();Bn=!(l.f||l.e),o.remove()}}return Bn?(i.x=a.pageX,i.y=a.pageY):(i.x=a.clientX,i.y=a.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var s=t.getBoundingClientRect();return[a.clientX-s.left-t.clientLeft,a.clientY-s.top-t.clientTop]}function ye(){return _n.event.changedTouches[0].identifier}function fe(e){return 0<e?1:0>e?-1:0}function xe(e,t,a){return(t[0]-e[0])*(a[1]-e[1])-(t[1]-e[1])*(a[0]-e[0])}function _e(e){return 1<e?0:-1>e?i:d(e)}function be(e){return 1<e?Un:-1>e?-Un:o(e)}function ve(e){return((e=m(e))-1/e)/2}function ke(e){return((e=m(e))+1/e)/2}function we(e){return((e=m(2*e))-1)/(e+1)}function Te(e){return(e=De(e/2))*e}function Ae(){}function Se(e,t,a){return this instanceof Se?void(this.h=+e,this.s=+t,this.l=+a):2>arguments.length?e instanceof Se?new Se(e.h,e.s,e.l):Ue(""+e,He,Se):new Se(e,t,a)}function Ce(e,t,a){function r(e){return 360<e?e-=360:0>e&&(e+=360),60>e?i+(n-i)*e/60:180>e?n:240>e?i+(n-i)*(240-e)/60:i}function o(e){return V(255*r(e))}var i,n;return e=isNaN(e)?0:0>(e%=360)?e+360:e,t=isNaN(t)?0:0>t?0:1<t?1:t,a=0>a?0:1<a?1:a,n=.5>=a?a*(1+t):a+t-a*t,i=2*a-n,new Fe(o(e+120),o(e),o(e-120))}function Le(e,t,a){return this instanceof Le?void(this.h=+e,this.c=+t,this.l=+a):2>arguments.length?e instanceof Le?new Le(e.h,e.c,e.l):e instanceof Ie?Oe(e.l,e.a,e.b):Oe((e=Ge((e=_n.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new Le(e,t,a)}function Ee(e,t,a){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new Ie(a,R(e*=Hn)*t,De(e)*t)}function Ie(e,t,a){return this instanceof Ie?void(this.l=+e,this.a=+t,this.b=+a):2>arguments.length?e instanceof Ie?new Ie(e.l,e.a,e.b):e instanceof Le?Ee(e.h,e.c,e.l):Ge((e=Fe(e)).r,e.g,e.b):new Ie(e,t,a)}function ze(e,t,a){var r=(e+16)/116,o=r+t/500,i=r-a/200;return o=Re(o)*el,r=1*Re(r),i=Re(i)*tl,new Fe(je(3.2404542*o-1.5371385*r-.4985314*i),je(-.969266*o+1.8760108*r+.041556*i),je(.0556434*o-.2040259*r+1.0572252*i))}function Oe(e,t,a){return 0<e?new Le(L(a,t)*Gn,N(t*t+a*a),e):new Le(NaN,NaN,e)}function Re(e){return .206893034<e?e*e*e:(e-4/29)/7.787037}function Me(e){return .008856<e?ya(e,1/3):7.787037*e+4/29}function je(e){return V(255*(.00304>=e?12.92*e:1.055*ya(e,1/2.4)-.055))}function Fe(e,t,a){return this instanceof Fe?void(this.r=~~e,this.g=~~t,this.b=~~a):2>arguments.length?e instanceof Fe?new Fe(e.r,e.g,e.b):Ue(""+e,Fe,Ce):new Fe(e,t,a)}function Be(e){return new Fe(e>>16,255&e>>8,255&e)}function Ne(e){return Be(e)+""}function Ve(e){return 16>e?"0"+va(0,e).toString(16):ea(255,e).toString(16)}function Ue(e,t,a){var o=0,i=0,n=0,l,s,d;if(l=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase()),l)switch(s=l[2].split(","),l[1]){case"hsl":return a(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100);case"rgb":return t(Ye(s[0]),Ye(s[1]),Ye(s[2]));}return(d=ol.get(e))?t(d.r,d.g,d.b):(null==e||"#"!==e.charAt(0)||isNaN(d=parseInt(e.slice(1),16))||(4===e.length?(o=(3840&d)>>4,o=o>>4|o,i=240&d,i=i>>4|i,n=15&d,n=n<<4|n):7===e.length&&(o=(16711680&d)>>16,i=(65280&d)>>8,n=255&d)),t(o,i,n))}function He(e,t,a){var o=ea(e/=255,t/=255,a/=255),i=va(e,t,a),n=i-o,d=(i+o)/2,l,c;return n?(c=.5>d?n/(i+o):n/(2-i-o),l=e==i?(t-a)/n+(t<a?6:0):t==i?(a-e)/n+2:(e-t)/n+4,l*=60):(l=NaN,c=0<d&&1>d?0:l),new Se(l,c,d)}function Ge(e,t,a){e=qe(e),t=qe(t),a=qe(a);var o=Me((.4124564*e+.3575761*t+.1804375*a)/el),i=Me((.2126729*e+.7151522*t+.072175*a)/1),n=Me((.0193339*e+.119192*t+.9503041*a)/tl);return Ie(116*i-16,500*(o-i),200*(i-n))}function qe(e){return .04045>=(e/=255)?e/12.92:ya((e+.055)/1.055,2.4)}function Ye(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?V(2.55*t):t}function We(e){return"function"==typeof e?e:function(){return e}}function Xe(e){return function(t,a,r){return 2===arguments.length&&"function"==typeof a&&(r=a,a=null),Ze(t,a,e,r)}}function Ze(e,t,a,r){function o(){var e=s.status,t;if(!e&&Je(s)||200<=e&&300>e||304===e){try{t=a.call(i,s)}catch(t){return void n.error.call(i,t)}n.load.call(i,t)}else n.error.call(i,s)}var i={},n=_n.dispatch("beforesend","progress","load","error"),l={},s=new XMLHttpRequest,d=null;return this.XDomainRequest&&!("withCredentials"in s)&&/^(http(s)?:)?\/\//.test(e)&&(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=o:s.onreadystatechange=function(){3<s.readyState&&o()},s.onprogress=function(e){var t=_n.event;_n.event=e;try{n.progress.call(i,s)}finally{_n.event=t}},i.header=function(e,t){return(e=(e+"").toLowerCase(),2>arguments.length)?l[e]:(null==t?delete l[e]:l[e]=t+"",i)},i.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",i):t},i.responseType=function(e){return arguments.length?(d=e,i):d},i.response=function(e){return a=e,i},["get","post"].forEach(function(e){i[e]=function(){return i.send.apply(i,[e].concat(f(arguments)))}}),i.send=function(a,r,o){if(2===arguments.length&&"function"==typeof r&&(o=r,r=null),s.open(a,e,!0),null==t||"accept"in l||(l.accept=t+",*/*"),s.setRequestHeader)for(var c in l)s.setRequestHeader(c,l[c]);return null!=t&&s.overrideMimeType&&s.overrideMimeType(t),null!=d&&(s.responseType=d),null!=o&&i.on("error",o).on("load",function(e){o(null,e)}),n.beforesend.call(i,s),s.send(null==r?null:r),i},i.abort=function(){return s.abort(),i},_n.rebind(i,n,"on"),null==r?i:i.get(Ke(r))}function Ke(e){return 1===e.length?function(t,a){e(null==t?a:null)}:e}function Je(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function Qe(e,t,a){var r=arguments.length;2>r&&(t=0),3>r&&(a=Date.now());var o=a+t,i={c:e,t:o,n:null};return ll?ll.n=i:nl=i,ll=i,sl||(dl=clearTimeout(dl),sl=1,il($e)),i}function $e(){var e=et(),t=tt()-e;24<t?(isFinite(t)&&(clearTimeout(dl),dl=setTimeout($e,t)),sl=0):(sl=1,il($e))}function et(){for(var e=Date.now(),t=nl;t;)e>=t.t&&t.c(e-t.t)&&(t.c=null),t=t.n;return e}function tt(){for(var e=nl,t=1/0,a;e;)e.c?(e.t<t&&(t=e.t),e=(a=e).n):e=a?a.n=e.n:nl=e.n;return ll=a,t}function at(e,t){return t-(e?M(P(e)/I):1)}function rt(e){var t=e.decimal,a=e.thousands,r=e.grouping,o=e.currency,n=r&&a?function(e,o){for(var n=e.length,l=[],t=0,s=r[0],d=0;0<n&&0<s&&(d+s+1>o&&(s=va(1,o-d)),l.push(e.substring(n-=s,n+s)),!((d+=s+1)>o));)s=r[t=(t+1)%r.length];return l.reverse().join(a)}:z;return function(e){var a=pl.exec(e),r=a[1]||" ",l=a[2]||">",s=a[3]||"-",d=a[4]||"",c=a[5],p=+a[6],u=a[7],g=a[8],h=a[9],m=1,y="",f="",x=!1,_=!0;switch(g&&(g=+g.substring(1)),(c||"0"===r&&"="===l)&&(c=r="0",l="="),h){case"n":u=!0,h="g";break;case"%":m=100,f="%",h="f";break;case"p":m=100,f="%",h="r";break;case"b":case"o":case"x":case"X":"#"===d&&(y="0"+h.toLowerCase());case"c":_=!1;case"d":x=!0,g=0;break;case"s":m=-1,h="r";}"$"===d&&(y=o[0],f=o[1]),"r"!=h||g||(h="g"),null!=g&&("g"==h?g=va(1,ea(21,g)):("e"==h||"f"==h)&&(g=va(0,ea(20,g)))),h=ul.get(h)||ot;var b=c&&u;return function(e){var a=f;if(x&&e%1)return"";var o=0>e||0===e&&0>1/e?(e=-e,"-"):"-"===s?"":s;if(0>m){var d=_n.formatPrefix(e,g);e=d.scale(e),a=d.symbol+f}else e*=m;e=h(e,g);var v=e.lastIndexOf("."),i,k;if(0>v){var w=_?e.lastIndexOf("e"):-1;0>w?(i=e,k=""):(i=e.substring(0,w),k=e.substring(w))}else i=e.substring(0,v),k=t+e.substring(v+1);!c&&u&&(i=n(i,1/0));var T=y.length+i.length+k.length+(b?0:o.length),A=T<p?Array(T=p-T+1).join(r):"";return b&&(i=n(A+i,A.length?p-k.length:1/0)),o+=y,e=i+k,("<"===l?o+e+A:">"===l?A+o+e:"^"===l?A.substring(0,T>>=1)+o+e+A.substring(T):o+(b?e:A+e))+a}}}function ot(e){return e+""}function it(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function nt(e,t,a){function r(t){var a=e(t),r=i(a,1);return t-a<r-t?a:r}function o(a){return t(a=e(new ml(a-1)),1),a}function i(e,a){return t(e=new ml(+e),a),e}function n(e,r,i){var n=o(e),l=[];if(1<i)for(;n<r;)a(n)%i||l.push(new Date(+n)),t(n,1);else for(;n<r;)l.push(new Date(+n)),t(n,1);return l}e.floor=e,e.round=r,e.ceil=o,e.offset=i,e.range=n;var l=e.utc=lt(e);return l.floor=l,l.round=lt(r),l.ceil=lt(o),l.offset=lt(i),l.range=function(e,t,a){try{ml=it;var r=new it;return r._=e,n(r,t,a)}finally{ml=Date}},e}function lt(e){return function(t,a){try{ml=it;var r=new it;return r._=t,e(r,a)._}finally{ml=Date}}}function st(e){function t(e){function t(t){for(var a=[],o=-1,n=0,l,s,d;++o<r;)37===e.charCodeAt(o)&&(a.push(e.slice(n,o)),null!=(s=fl[l=e.charAt(++o)])&&(l=e.charAt(++o)),(d=v[l])&&(l=d(t,null==s?"e"===l?" ":"0":s)),a.push(l),n=o+1);return a.push(e.slice(n,o)),a.join("")}var r=e.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},o=a(r,e,t,0);if(o!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&ml!==it,n=new(i?it:ml);return"j"in r?n.setFullYear(r.y,0,r.j):"W"in r||"U"in r?(!("w"in r)&&(r.w="W"in r?1:0),n.setFullYear(r.y,0,1),n.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(n.getDay()+5)%7:r.w+7*r.U-(n.getDay()+6)%7)):n.setFullYear(r.y,r.m,r.d),n.setHours(r.H+(0|r.Z/100),r.M+r.Z%100,r.S,r.L),i?n._:n},t.toString=function(){return e},t}function a(e,a,r,o){for(var l=0,s=a.length,n=r.length,d,u,g;l<s;){if(o>=n)return-1;if(d=a.charCodeAt(l++),37===d){if(g=a.charAt(l++),u=k[g in fl?a.charAt(l++):g],!u||0>(o=u(e,r,o)))return-1;}else if(d!=r.charCodeAt(o++))return-1}return o}var r=e.dateTime,o=e.date,i=e.time,n=e.periods,l=e.days,s=e.shortDays,c=e.months,p=e.shortMonths;t.utc=function(e){function a(e){try{ml=it;var t=new ml;return t._=e,r(t)}finally{ml=Date}}var r=t(e);return a.parse=function(e){try{ml=it;var t=r.parse(e);return t&&t._}finally{ml=Date}},a.toString=r.toString,a},t.multi=t.utc.multi=Lt;var u=_n.map(),g=ct(l),h=pt(l),m=ct(s),y=pt(s),f=ct(c),x=pt(c),_=ct(p),b=pt(p);n.forEach(function(e,t){u.set(e.toLowerCase(),t)});var v={a:function(e){return s[e.getDay()]},A:function(e){return l[e.getDay()]},b:function(e){return p[e.getMonth()]},B:function(e){return c[e.getMonth()]},c:t(r),d:function(e,t){return dt(e.getDate(),t,2)},e:function(e,t){return dt(e.getDate(),t,2)},H:function(e,t){return dt(e.getHours(),t,2)},I:function(e,t){return dt(e.getHours()%12||12,t,2)},j:function(e,t){return dt(1+hl.dayOfYear(e),t,3)},L:function(e,t){return dt(e.getMilliseconds(),t,3)},m:function(e,t){return dt(e.getMonth()+1,t,2)},M:function(e,t){return dt(e.getMinutes(),t,2)},p:function(e){return n[+(12<=e.getHours())]},S:function(e,t){return dt(e.getSeconds(),t,2)},U:function(e,t){return dt(hl.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return dt(hl.mondayOfYear(e),t,2)},x:t(o),X:t(i),y:function(e,t){return dt(e.getFullYear()%100,t,2)},Y:function(e,t){return dt(e.getFullYear()%1e4,t,4)},Z:St,"%":function(){return"%"}},k={a:function(e,t,a){m.lastIndex=0;var r=m.exec(t.slice(a));return r?(e.w=y.get(r[0].toLowerCase()),a+r[0].length):-1},A:function(e,t,a){g.lastIndex=0;var r=g.exec(t.slice(a));return r?(e.w=h.get(r[0].toLowerCase()),a+r[0].length):-1},b:function(e,t,a){_.lastIndex=0;var r=_.exec(t.slice(a));return r?(e.m=b.get(r[0].toLowerCase()),a+r[0].length):-1},B:function(e,t,a){f.lastIndex=0;var r=f.exec(t.slice(a));return r?(e.m=x.get(r[0].toLowerCase()),a+r[0].length):-1},c:function(e,t,r){return a(e,v.c.toString(),t,r)},d:bt,e:bt,H:kt,I:kt,j:vt,L:At,m:_t,M:wt,p:function(e,t,a){var r=u.get(t.slice(a,a+=2).toLowerCase());return null==r?-1:(e.p=r,a)},S:Tt,U:gt,w:ut,W:ht,x:function(e,t,r){return a(e,v.x.toString(),t,r)},X:function(e,t,r){return a(e,v.X.toString(),t,r)},y:yt,Y:mt,Z:ft,"%":Ct};return t}function dt(e,t,a){var r=0>e?"-":"",o=(r?-e:e)+"",i=o.length;return r+(i<a?Array(a-i+1).join(t)+o:o)}function ct(e){return new RegExp("^(?:"+e.map(_n.requote).join("|")+")","i")}function pt(e){for(var t=new _,a=-1,r=e.length;++a<r;)t.set(e[a].toLowerCase(),a);return t}function ut(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+1));return r?(e.w=+r[0],a+r[0].length):-1}function gt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a));return r?(e.U=+r[0],a+r[0].length):-1}function ht(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a));return r?(e.W=+r[0],a+r[0].length):-1}function mt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+4));return r?(e.y=+r[0],a+r[0].length):-1}function yt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+2));return r?(e.y=xt(+r[0]),a+r[0].length):-1}function ft(e,t,a){return /^[+-]\d{4}$/.test(t=t.slice(a,a+5))?(e.Z=-t,a+5):-1}function xt(e){return e+(68<e?1900:2e3)}function _t(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+2));return r?(e.m=r[0]-1,a+r[0].length):-1}function bt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+2));return r?(e.d=+r[0],a+r[0].length):-1}function vt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+3));return r?(e.j=+r[0],a+r[0].length):-1}function kt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+2));return r?(e.H=+r[0],a+r[0].length):-1}function wt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+2));return r?(e.M=+r[0],a+r[0].length):-1}function Tt(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+2));return r?(e.S=+r[0],a+r[0].length):-1}function At(e,t,a){xl.lastIndex=0;var r=xl.exec(t.slice(a,a+3));return r?(e.L=+r[0],a+r[0].length):-1}function St(e){var t=e.getTimezoneOffset(),a=0<t?"-":"+",r=0|Sn(t)/60,o=Sn(t)%60;return a+dt(r,"0",2)+dt(o,"0",2)}function Ct(e,t,a){_l.lastIndex=0;var r=_l.exec(t.slice(a,a+1));return r?a+r[0].length:-1}function Lt(e){for(var t=e.length,a=-1;++a<t;)e[a][0]=this(e[a][0]);return function(t){for(var a=0,r=e[a];!r[1](t);)r=e[++a];return r[0](t)}}function Et(){}function It(e,t,a){var r=a.s=e+t,o=r-e;a.t=e-(r-o)+(t-o)}function zt(e,t){e&&wl.hasOwnProperty(e.type)&&wl[e.type](e,t)}function Pt(e,t,a){var r=-1,o=e.length-a,n;for(t.lineStart();++r<o;)n=e[r],t.point(n[0],n[1],n[2]);t.lineEnd()}function Dt(e,t){var a=-1,r=e.length;for(t.polygonStart();++a<r;)Pt(e[a],t,1);t.polygonEnd()}function Ot(){function e(e,t){e*=Hn,t=t*Hn/2+i/4;var a=e-r,l=0<=a?1:-1,s=l*a,d=R(t),c=De(t),p=n*c,g=o*d+p*R(s),u=p*l*De(s);Tl.add(L(u,g)),r=e,o=d,n=c}var t,a,r,o,n;Al.point=function(l,s){Al.point=e,r=(t=l)*Hn,o=R(s=(a=s)*Hn/2+i/4),n=De(s)},Al.lineEnd=function(){e(t,a)}}function Rt(e){var t=e[0],a=e[1],r=R(a);return[r*R(t),r*De(t),De(a)]}function Mt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function jt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ft(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Bt(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Nt(e){var t=N(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Vt(e){return[L(e[1],e[0]),be(e[2])]}function Ut(e,t){return Sn(e[0]-t[0])<Nn&&Sn(e[1]-t[1])<Nn}function Ht(e,t){e*=Hn;var a=R(t*=Hn);Gt(a*R(e),a*De(e),De(t))}function Gt(e,t,a){++El,zl+=(e-zl)/El,Pl+=(t-Pl)/El,Dl+=(a-Dl)/El}function qt(){function e(e,o){e*=Hn;var i=R(o*=Hn),n=i*R(e),l=i*De(e),s=De(o),d=L(N((d=a*s-r*l)*d+(d=r*n-t*s)*d+(d=t*l-a*n)*d),t*n+a*l+r*s);Il+=d,Ol+=d*(t+(t=n)),Rl+=d*(a+(a=l)),Ml+=d*(r+(r=s)),Gt(t,a,r)}var t,a,r;Cl.point=function(o,i){o*=Hn;var n=R(i*=Hn);t=n*R(o),a=n*De(o),r=De(i),Cl.point=e,Gt(t,a,r)}}function Yt(){Cl.point=Ht}function Wt(){function e(e,t){e*=Hn;var a=R(t*=Hn),n=a*R(e),l=a*De(e),s=De(t),d=o*s-i*l,c=i*n-r*s,p=r*l-o*n,g=N(d*d+c*c+p*p),h=r*n+o*l+i*s,u=g&&-_e(h)/g,m=L(g,h);jl+=u*d,Fl+=u*c,Bl+=u*p,Il+=m,Ol+=m*(r+(r=n)),Rl+=m*(o+(o=l)),Ml+=m*(i+(i=s)),Gt(r,o,i)}var t,a,r,o,i;Cl.point=function(n,l){t=n,a=l,Cl.point=e,n*=Hn;var s=R(l*=Hn);r=s*R(n),o=s*De(n),i=De(l),Gt(r,o,i)},Cl.lineEnd=function(){e(t,a),Cl.lineEnd=Yt,Cl.point=Ht}}function Xt(e,t){function a(a,r){return a=e(a,r),t(a[0],a[1])}return e.invert&&t.invert&&(a.invert=function(a,r){return a=t.invert(a,r),a&&e.invert(a[0],a[1])}),a}function Zt(){return!0}function Kt(e,t,a,r,o){var l=[],s=[];if(e.forEach(function(e){if(!(0>=(d=e.length-1))){var t=e[0],r=e[d],d;if(Ut(t,r)){o.lineStart();for(var c=0;c<d;++c)o.point((t=e[c])[0],t[1]);return void o.lineEnd()}var p=new Qt(t,e,null,!0),u=new Qt(t,null,p,!1);p.o=u,l.push(p),s.push(u),p=new Qt(r,e,null,!1),u=new Qt(r,null,p,!0),p.o=u,l.push(p),s.push(u)}}),s.sort(t),Jt(l),Jt(s),!!l.length){for(var d=0,c=a,p=s.length;d<p;++d)s[d].e=c=!c;for(var u=l[0],g,h;;){for(var m=u,y=!0;m.v;)if((m=m.n)===u)return;g=m.z,o.lineStart();do{if(m.v=m.o.v=!0,m.e){if(y)for(var d=0,p=g.length;d<p;++d)o.point((h=g[d])[0],h[1]);else r(m.x,m.n.x,1,o);m=m.n}else{if(y){g=m.p.z;for(var d=g.length-1;0<=d;--d)o.point((h=g[d])[0],h[1])}else r(m.x,m.p.x,-1,o);m=m.p}m=m.o,g=m.z,y=!y}while(!m.v);o.lineEnd()}}}function Jt(e){if(o=e.length){for(var t=0,r=e[0],o,l;++t<o;)r.n=l=e[t],l.p=r,r=l;r.n=l=e[0],l.p=r}}function Qt(e,t,a,r){this.x=e,this.z=t,this.o=a,this.e=r,this.v=!1,this.n=this.p=null}function $t(e,t,a,r){return function(o,l){function s(t,a){var r=o(t,a);e(t=r[0],a=r[1])&&l.point(t,a)}function d(e,t){var a=o(e,t);m.point(a[0],a[1])}function c(){f.point=d,m.lineStart()}function p(){f.point=s,m.lineEnd()}function u(e,t){w.push([e,t]);var a=o(e,t);_.point(a[0],a[1])}function g(){_.lineStart(),w=[]}function h(){u(w[0][0],w[0][1]),_.lineEnd();var e=_.clean(),t=x.buffer(),a=t.length,r;if(w.pop(),k.push(w),w=null,!!a){if(1&e){r=t[0];var a=r.length-1,o=-1,s;if(0<a){for(b||(l.polygonStart(),b=!0),l.lineStart();++o<a;)l.point((s=r[o])[0],s[1]);l.lineEnd()}return}1<a&&2&e&&t.push(t.pop().concat(t.shift())),v.push(t.filter(ta))}}var m=t(l),y=o.invert(r[0],r[1]),f={point:s,lineStart:c,lineEnd:p,polygonStart:function(){f.point=u,f.lineStart=g,f.lineEnd=h,v=[],k=[]},polygonEnd:function(){f.point=s,f.lineStart=c,f.lineEnd=p,v=_n.merge(v);var e=ia(y,k);v.length?(!b&&(l.polygonStart(),b=!0),Kt(v,ra,e,a,l)):e&&(!b&&(l.polygonStart(),b=!0),l.lineStart(),a(null,null,1,l),l.lineEnd()),b&&(l.polygonEnd(),b=!1),v=k=null},sphere:function(){l.polygonStart(),l.lineStart(),a(null,null,1,l),l.lineEnd(),l.polygonEnd()}},x=aa(),_=t(x),b=!1,v,k,w;return f}}function ta(e){return 1<e.length}function aa(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,a){t.push([e,a])},lineEnd:F,buffer:function(){var a=e;return e=[],t=null,a},rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))}}}function ra(e,t){return(0>(e=e.x)[0]?e[1]-Un-Nn:Un-e[1])-(0>(t=t.x)[0]?t[1]-Un-Nn:Un-t[1])}function oa(e,t,a,r){var o=De(e-a),i,n;return Sn(o)>Nn?xa((De(t)*(n=R(r))*De(a)-De(r)*(i=R(t))*De(e))/(i*n*o)):(t+r)/2}function ia(e,t){var a=e[0],r=e[1],o=[De(a),-R(a),0],l=0,s=0;Tl.reset();for(var d=0,c=t.length;d<c;++d){var n=t[d],p=n.length;if(p)for(var u=n[0],g=u[0],h=u[1]/2+i/4,m=De(h),y=R(h),f=1;;){f===p&&(f=0),e=n[f];var x=e[0],_=e[1]/2+i/4,b=De(_),v=R(_),w=x-g,T=0<=w?1:-1,A=T*w,S=A>i,C=m*b;if(Tl.add(L(C*T*De(A),y*v+C*R(A))),l+=S?w+T*Vn:w,S^g>=a^x>=a){var k=jt(Rt(u),Rt(e));Nt(k);var E=jt(o,k);Nt(E);var I=(S^0<=w?-1:1)*be(E[2]);(r>I||r===I&&(k[0]||k[1]))&&(s+=S^0<=w?1:-1)}if(!f++)break;g=x,m=b,y=v,u=e}}return(l<-Nn||l<Nn&&Tl<-Nn)^1&s}function na(e){function a(e,t){return R(e)*R(t)>n}function r(e,a,r){var o=Rt(e),l=Rt(a),s=[1,0,0],d=jt(o,l),c=Mt(d,d),p=d[0],g=c-p*p;if(!g)return!r&&e;var h=jt(s,d),m=Bt(s,n*c/g),y=Bt(d,-n*p/g);Ft(m,y);var f=h,u=Mt(m,f),x=Mt(f,f),_=u*u-x*(Mt(m,m)-1);if(!(0>_)){var b=N(_),t=Bt(f,(-u-b)/x);if(Ft(t,m),t=Vt(t),!r)return t;var v=e[0],k=a[0],w=e[1],T=a[1],A;k<v&&(A=v,v=k,k=A);var S=k-v,C=Sn(S-i)<Nn;if(!C&&T<w&&(A=w,w=T,T=A),C||S<Nn?C?0<w+T^t[1]<(Sn(t[0]-v)<Nn?w:T):w<=t[1]&&t[1]<=T:S>i^(v<=t[0]&&t[0]<=k)){var L=Bt(f,(-u+b)/x);return Ft(L,m),[t,Vt(L)]}}}function o(t,a){var o=l?e:i-e,r=0;return t<-o?r|=1:t>o&&(r|=2),a<-o?r|=4:a>o&&(r|=8),r}var n=R(e),l=0<n,s=Sn(n)>Nn,d=Na(e,6*Hn);return $t(a,function(e){var n,d,p,u,g;return{lineStart:function(){u=p=!1,g=1},point:function(h,m){var y=[h,m],f=a(h,m),x=l?f?0:o(h,m):f?o(h+(0>h?i:-i),m):0,c;if(!n&&(u=p=f)&&e.lineStart(),f!==p&&(c=r(n,y),(Ut(n,c)||Ut(y,c))&&(y[0]+=Nn,y[1]+=Nn,f=a(y[0],y[1]))),f!==p)g=0,f?(e.lineStart(),c=r(y,n),e.point(c[0],c[1])):(c=r(n,y),e.point(c[0],c[1]),e.lineEnd()),n=c;else if(s&&n&&l^f){var _;!(x&d)&&(_=r(y,n,!0))&&(g=0,l?(e.lineStart(),e.point(_[0][0],_[0][1]),e.point(_[1][0],_[1][1]),e.lineEnd()):(e.point(_[1][0],_[1][1]),e.lineEnd(),e.lineStart(),e.point(_[0][0],_[0][1])))}!f||n&&Ut(n,y)||e.point(y[0],y[1]),n=y,p=f,d=x},lineEnd:function(){p&&e.lineEnd(),n=null},clean:function(){return g|(u&&p)<<1}}},d,l?[0,-e]:[-i,e-i])}function la(e,t,a,o){return function(i){var n=i.a,l=i.b,s=n.x,d=n.y,c=l.x,p=l.y,u=0,g=1,h=c-s,m=p-d,y;if(y=e-s,h||!(0<y)){if(y/=h,0>h){if(y<u)return;y<g&&(g=y)}else if(0<h){if(y>g)return;y>u&&(u=y)}if(y=a-s,h||!(0>y)){if(y/=h,0>h){if(y>g)return;y>u&&(u=y)}else if(0<h){if(y<u)return;y<g&&(g=y)}if(y=t-d,m||!(0<y)){if(y/=m,0>m){if(y<u)return;y<g&&(g=y)}else if(0<m){if(y>g)return;y>u&&(u=y)}if(y=o-d,m||!(0>y)){if(y/=m,0>m){if(y>g)return;y>u&&(u=y)}else if(0<m){if(y<u)return;y<g&&(g=y)}return 0<u&&(i.a={x:s+u*h,y:d+u*m}),1>g&&(i.b={x:s+g*h,y:d+g*m}),i}}}}}}function sa(e,t,r,o){function i(a,o){return Sn(a[0]-e)<Nn?0<o?0:3:Sn(a[0]-r)<Nn?0<o?2:1:Sn(a[1]-t)<Nn?0<o?1:0:0<o?3:2}function n(e,t){return l(e.x,t.x)}function l(e,t){var a=i(e,1),r=i(t,1);return a===r?0===a?t[1]-e[1]:1===a?e[0]-t[0]:2===a?e[1]-t[1]:t[0]-e[0]:a-r}return function(a){function s(e){for(var t=0,r=k.length,o=e[1],n=0;n<r;++n)for(var l=1,s=k[n],d=s.length,c=s[0],p;l<d;++l)p=s[l],c[1]<=o?p[1]>o&&0<xe(c,p,e)&&++t:p[1]<=o&&0>xe(c,p,e)&&--t,c=p;return 0!==t}function d(n,s,d,c){var p=0,u=0;if(null==n||(p=i(n,d))!==(u=i(s,d))||0>l(n,s)^0<d)do c.point(0===p||3===p?e:r,1<p?o:t);while((p=(p+d+4)%4)!==u);else c.point(s[0],s[1])}function c(a,i){return e<=a&&a<=r&&t<=i&&i<=o}function p(e,t){c(e,t)&&a.point(e,t)}function u(){x.point=h,k&&k.push(w=[]),E=!0,L=!1,C=b=NaN}function g(){_&&(h(T,A),S&&L&&y.rejoin(),_.push(y.buffer())),x.point=p,L&&a.lineEnd()}function h(e,t){e=va(-1000000000,ea(1000000000,e)),t=va(-1000000000,ea(1000000000,t));var r=c(e,t);if(k&&w.push([e,t]),E)T=e,A=t,S=r,E=!1,r&&(a.lineStart(),a.point(e,t));else if(r&&L)a.point(e,t);else{var o={a:{x:C,y:b},b:{x:e,y:t}};f(o)?(!L&&(a.lineStart(),a.point(o.a.x,o.a.y)),a.point(o.b.x,o.b.y),!r&&a.lineEnd(),I=!1):r&&(a.lineStart(),a.point(e,t),I=!1)}C=e,b=t,L=r}var m=a,y=aa(),f=la(e,t,r,o),x={point:p,lineStart:u,lineEnd:g,polygonStart:function(){a=y,_=[],k=[],I=!0},polygonEnd:function(){a=m,_=_n.merge(_);var t=s([e,o]),r=I&&t,i=_.length;(r||i)&&(a.polygonStart(),r&&(a.lineStart(),d(null,null,1,a),a.lineEnd()),i&&Kt(_,n,t,d,a),a.polygonEnd()),_=k=w=null}},_,k,w,T,A,S,C,b,L,E,I;return x}}function da(e){var t=0,a=i/3,r=Pa(e),o=r(t,a);return o.parallels=function(e){return arguments.length?r(t=e[0]*i/180,a=e[1]*i/180):[180*(t/i),180*(a/i)]},o}function ca(e,t){function a(e,t){var a=N(i-2*o*De(t))/o;return[a*De(e*=o),n-a*R(e)]}var r=De(e),o=(r+De(t))/2,i=1+r*(2*o-r),n=N(i)/o;return a.invert=function(e,t){var a=n-t;return[L(e,a)/o,be((i-(e*e+a*a)*o*o)/(2*o))]},a}function pa(){function e(e,t){Gl+=o*e-r*t,r=e,o=t}var t,a,r,o;Nl.point=function(i,n){Nl.point=e,t=r=i,a=o=n},Nl.lineEnd=function(){e(t,a)}}function ua(e,t){e<ql&&(ql=e),e>Wl&&(Wl=e),t<Yl&&(Yl=t),t>Xl&&(Xl=t)}function ga(){function e(e,t){n.push("M",e,",",t,i)}function t(e,t){n.push("M",e,",",t),l.point=a}function a(e,t){n.push("L",e,",",t)}function r(){l.point=e}function o(){n.push("Z")}var i=ha(4.5),n=[],l={point:e,lineStart:function(){l.point=t},lineEnd:r,polygonStart:function(){l.lineEnd=o},polygonEnd:function(){l.lineEnd=r,l.point=e},pointRadius:function(e){return i=ha(e),l},result:function(){if(n.length){var e=n.join("");return n=[],e}}};return l}function ha(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function ma(e,t){zl+=e,Pl+=t,++Dl}function wa(){function e(e,r){var o=e-t,i=r-a,n=N(o*o+i*i);Ol+=n*(t+e)/2,Rl+=n*(a+r)/2,Ml+=n,ma(t=e,a=r)}var t,a;Ul.point=function(r,o){Ul.point=e,ma(t=r,a=o)}}function Ta(){Ul.point=ma}function Aa(){function e(e,t){var a=e-r,i=t-o,n=N(a*a+i*i);Ol+=n*(r+e)/2,Rl+=n*(o+t)/2,Ml+=n,n=o*e-r*t,jl+=n*(r+e),Fl+=n*(o+t),Bl+=3*n,ma(r=e,o=t)}var t,a,r,o;Ul.point=function(i,n){Ul.point=e,ma(t=r=i,a=o=n)},Ul.lineEnd=function(){e(t,a)}}function Sa(e){function t(t,a){e.moveTo(t+n,a),e.arc(t,a,n,0,Vn)}function a(t,a){e.moveTo(t,a),l.point=r}function r(t,a){e.lineTo(t,a)}function o(){l.point=t}function i(){e.closePath()}var n=4.5,l={point:t,lineStart:function(){l.point=a},lineEnd:o,polygonStart:function(){l.lineEnd=i},polygonEnd:function(){l.lineEnd=o,l.point=t},pointRadius:function(e){return n=e,l},result:F};return l}function Ca(e){function t(e){return(s?r:a)(e)}function a(t){return Ia(t,function(a,r){a=e(a,r),t.point(a[0],a[1])})}function r(t){function a(a,r){a=e(a,r),t.point(a[0],a[1])}function r(){b=NaN,p.point=o,t.lineStart()}function o(a,r){var o=Rt([a,r]),n=e(a,r);i(b,v,_,k,w,T,b=n[0],v=n[1],_=a,k=o[0],w=o[1],T=o[2],s,t),t.point(b,v)}function n(){p.point=a,t.lineEnd()}function l(){r(),p.point=d,p.lineEnd=c}function d(e,t){o(u=e,g=t),h=b,m=v,y=k,f=w,x=T,p.point=o}function c(){i(b,v,_,k,w,T,h,m,u,y,f,x,s,t),p.lineEnd=n,n()}var p={point:a,lineStart:r,lineEnd:n,polygonStart:function(){t.polygonStart(),p.lineStart=l},polygonEnd:function(){t.polygonEnd(),p.lineStart=r}},u,g,h,m,y,f,x,_,b,v,k,w,T;return p}function i(t,r,s,d,u,g,h,y,f,x,_,v,k,w){var T=h-t,A=y-r,S=T*T+A*A;if(S>4*n&&k--){var C=d+x,E=u+_,I=g+v,z=N(C*C+E*E+I*I),m=o(I/=z),P=Sn(Sn(I)-1)<Nn||Sn(s-f)<Nn?(s+f)/2:L(E,C),D=e(P,m),p=D[0],O=D[1],R=p-t,M=O-r,j=A*R-T*M;(j*j/S>n||.3<Sn((T*R+A*M)/S-.5)||d*x+u*_+g*v<l)&&(i(t,r,s,d,u,g,p,O,P,C/=z,E/=z,I,k,w),w.point(p,O),i(p,O,P,C,E,I,h,y,f,x,_,v,k,w))}}var n=.5,l=R(30*Hn),s=16;return t.precision=function(e){return arguments.length?(s=0<(n=e*e)&&16,t):N(n)},t}function La(e){var t=Ca(function(t,a){return e([t*Gn,a*Gn])});return function(e){return Da(t(e))}}function Ea(e){this.stream=e}function Ia(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function za(e){return Pa(function(){return e})()}function Pa(e){function t(e){return e=T(e[0]*Hn,e[1]*Hn),[e[0]*n+A,_-e[1]*n]}function a(e){return e=T.invert((e[0]-A)/n,(_-e[1])/n),e&&[e[0]*Gn,e[1]*Gn]}function r(){T=Xt(w=Ma(p,u,g),v);var e=v(d,c);return A=l-e[0]*n,_=s+e[1]*n,o()}function o(){return S&&(S.valid=!1,S=null),t}var i=Ca(function(e,t){return e=v(e,t),[e[0]*n+A,_-e[1]*n]}),n=150,l=480,s=250,d=0,c=0,p=0,u=0,g=0,h=Ll,m=z,f=null,b=null,v,w,T,A,_,S;return t.stream=function(e){return S&&(S.valid=!1),S=Da(h(w,i(m(e)))),S.valid=!0,S},t.clipAngle=function(e){return arguments.length?(h=null==e?(f=e,Ll):na((f=+e)*Hn),o()):f},t.clipExtent=function(e){return arguments.length?(b=e,m=e?sa(e[0][0],e[0][1],e[1][0],e[1][1]):z,o()):b},t.scale=function(e){return arguments.length?(n=+e,r()):n},t.translate=function(e){return arguments.length?(l=+e[0],s=+e[1],r()):[l,s]},t.center=function(e){return arguments.length?(d=e[0]%360*Hn,c=e[1]%360*Hn,r()):[d*Gn,c*Gn]},t.rotate=function(e){return arguments.length?(p=e[0]%360*Hn,u=e[1]%360*Hn,g=2<e.length?e[2]%360*Hn:0,r()):[p*Gn,u*Gn,g*Gn]},_n.rebind(t,i,"precision"),function(){return v=e.apply(this,arguments),t.invert=v.invert&&a,r()}}function Da(e){return Ia(e,function(t,a){e.point(t*Hn,a*Hn)})}function Oa(e,t){return[e,t]}function Ra(e,t){return[e>i?e-Vn:e<-i?e+Vn:e,t]}function Ma(e,t,a){return e?t||a?Xt(Fa(e),Ba(t,a)):Fa(e):t||a?Ba(t,a):Ra}function ja(e){return function(t,a){return t+=e,[t>i?t-Vn:t<-i?t+Vn:t,a]}}function Fa(e){var t=ja(e);return t.invert=ja(-e),t}function Ba(e,t){function a(e,t){var a=R(t),l=R(e)*a,s=De(e)*a,d=De(t),c=d*r+l*o;return[L(s*i-c*n,l*r-d*o),be(c*i+s*n)]}var r=R(e),o=De(e),i=R(t),n=De(t);return a.invert=function(e,t){var a=R(t),l=R(e)*a,s=De(e)*a,d=De(t),c=d*i-s*n;return[L(s*i+d*n,l*r+c*o),be(c*r-l*o)]},a}function Na(e,a){var r=R(e),o=De(e);return function(i,n,l,s){var d=l*a;null==i?(i=e+l*Vn,n=e-.5*d):(i=Va(r,i),n=Va(r,n),(0<l?i<n:i>n)&&(i+=l*Vn));for(var c=i,p;0<l?c>n:c<n;c-=d)s.point((p=Vt([r,-o*R(c),-o*De(c)]))[0],p[1])}}function Va(e,t){var r=Rt(t);r[0]-=e,Nt(r);var a=_e(-r[1]);return((0>-r[2]?-a:a)+2*Pe-Nn)%(2*Pe)}function Ua(e,t,a){var r=_n.range(e,t-Nn,a).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function Ha(e,t,a){var r=_n.range(e,t-Nn,a).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function Ga(e){return e.source}function qa(e){return e.target}function Ya(e,t,a,r){var i=R(t),n=De(t),l=R(r),s=De(r),c=i*R(e),p=i*De(e),u=l*R(a),g=l*De(a),h=2*o(N(Te(r-t)+i*l*Te(a-e))),d=1/De(h),m=h?function(e){var a=De(e*=h)*d,r=De(h-e)*d,o=r*c+a*u,i=r*p+a*g;return[L(i,o)*Gn,L(r*n+a*s,N(o*o+i*i))*Gn]}:function(){return[e*Gn,t*Gn]};return m.distance=h,m}function Wa(e,t){function a(t,a){var r=R(t),o=R(a),i=e(r*o);return[i*o*De(t),i*De(a)]}return a.invert=function(e,a){var r=N(e*e+a*a),i=t(r),n=De(i),l=R(i);return[L(e*n,r*l),o(r&&a*n/r)]},a}function Xa(e,a){function r(e,a){0<n?a<-Un+Nn&&(a=-Un+Nn):a>Un-Nn&&(a=Un-Nn);var r=n/ya(l(a),t);return[r*De(t*e),n-r*R(t*e)]}var o=R(e),l=function(e){return fa(i/4+e/2)},t=e===a?De(e):P(o/R(a))/P(l(a)/l(e)),n=o*ya(l(e),t)/t;return t?(r.invert=function(e,a){var r=n-a,o=fe(t)*N(e*e+r*r);return[L(e,r)/t,2*xa(ya(n/o,1/t))-Un]},r):Ka}function Za(e,t){function a(e,t){var a=i-t;return[a*De(o*e),i-a*R(o*e)]}var r=R(e),o=e===t?De(e):(r-R(t))/(t-e),i=r/o+e;return Sn(o)<Nn?Oa:(a.invert=function(e,t){var a=i-t;return[L(e,a)/o,i-fe(o)*N(e*e+a*a)]},a)}function Ka(e,t){return[e,P(fa(i/4+t/2))]}function Ja(e){var a=za(e),r=a.scale,o=a.translate,n=a.clipExtent,l;return a.scale=function(){var e=r.apply(a,arguments);return e===a?l?a.clipExtent(null):a:e},a.translate=function(){var e=o.apply(a,arguments);return e===a?l?a.clipExtent(null):a:e},a.clipExtent=function(e){var s=n.apply(a,arguments);if(s!==a)l&&(s=null);else if(l=null==e){var d=i*r(),c=o();n([[c[0]-d,c[1]-d],[c[0]+d,c[1]+d]])}return s},a.clipExtent(null)}function Qa(e,t){return[P(fa(i/4+t/2)),-e]}function $a(e){return e[0]}function er(e){return e[1]}function tr(e){for(var t=e.length,a=[0,1],r=2,o=2;o<t;o++){for(;1<r&&0>=xe(e[a[r-2]],e[a[r-1]],e[o]);)--r;a[r++]=o}return a.slice(0,r)}function ar(e,t){return e[0]-t[0]||e[1]-t[1]}function rr(e,t,a){return(a[0]-t[0])*(e[1]-t[1])<(a[1]-t[1])*(e[0]-t[0])}function or(e,t,r,a){var o=e[0],i=r[0],n=t[0]-o,l=a[0]-i,s=e[1],d=r[1],c=t[1]-s,p=a[1]-d,u=(l*(s-d)-p*(o-i))/(p*n-l*c);return[o+u*n,s+u*c]}function ir(e){var t=e[0],a=e[e.length-1];return!(t[0]-a[0]||t[1]-a[1])}function nr(){Cr(this),this.edge=this.site=this.circle=null}function lr(e){var t=rs.pop()||new nr;return t.site=e,t}function sr(e){xr(e),ls.remove(e),rs.push(e),Cr(e)}function dr(e){var t=e.circle,a=t.x,r=t.cy,o={x:a,y:r},i=e.P,n=e.N,l=[e];sr(e);for(var s=i;s.circle&&Sn(a-s.circle.x)<Nn&&Sn(r-s.circle.cy)<Nn;)i=s.P,l.unshift(s),sr(s),s=i;l.unshift(s),xr(s);for(var d=n;d.circle&&Sn(a-d.circle.x)<Nn&&Sn(r-d.circle.cy)<Nn;)n=d.N,l.push(d),sr(d),d=n;l.push(d),xr(d);var c=l.length,p;for(p=1;p<c;++p)d=l[p],s=l[p-1],Tr(d.edge,s.site,d.site,o);s=l[0],d=l[c-1],d.edge=kr(s.site,d.site,null,o),fr(s),fr(d)}function cr(e){for(var t=e.x,a=e.y,r=ls._,o,i,n,l;r;)if(n=pr(r,a)-t,n>Nn)r=r.L;else if(l=t-ur(r,a),l>Nn){if(!r.R){o=r;break}r=r.R}else{n>-Nn?(o=r.P,i=r):l>-Nn?(o=r,i=r.N):o=i=r;break}var s=lr(e);if(ls.insert(o,s),o||i){if(o===i)return xr(o),i=lr(o.site),ls.insert(s,i),s.edge=i.edge=kr(o.site,s.site),fr(o),void fr(i);if(!i)return void(s.edge=kr(o.site,s.site));xr(o),xr(i);var c=o.site,p=c.x,u=c.y,g=e.x-p,h=e.y-u,m=i.site,y=m.x-p,f=m.y-u,x=2*(g*f-h*y),d=g*g+h*h,_=y*y+f*f,b={x:(f*d-h*_)/x+p,y:(g*_-y*d)/x+u};Tr(i.edge,c,m,b),s.edge=kr(c,e,null,b),i.edge=kr(e,m,null,b),fr(o),fr(i)}}function pr(e,t){var a=e.site,r=a.x,o=a.y,i=o-t;if(!i)return r;var n=e.P;if(!n)return-Infinity;a=n.site;var l=a.x,s=a.y,d=s-t;if(!d)return l;var c=l-r,p=1/i-1/d,u=c/d;return p?(-u+N(u*u-2*p*(c*c/(-2*d)-s+d/2+o-i/2)))/p+r:(r+l)/2}function ur(e,t){var a=e.N;if(a)return pr(a,t);var r=e.site;return r.y===t?r.x:1/0}function gr(e){this.site=e,this.edges=[]}function hr(e){for(var t=e[0][0],a=e[1][0],r=e[0][1],o=e[1][1],i=ns,n=i.length,l,s,d,c,p,u,g,h,m,y;n--;)if(p=i[n],p&&p.prepare())for(g=p.edges,h=g.length,u=0;u<h;)y=g[u].end(),d=y.x,c=y.y,m=g[++u%h].start(),l=m.x,s=m.y,(Sn(d-l)>Nn||Sn(c-s)>Nn)&&(g.splice(u,0,new Ar(wr(p.site,y,Sn(d-t)<Nn&&o-c>Nn?{x:t,y:Sn(l-t)<Nn?s:o}:Sn(c-o)<Nn&&a-d>Nn?{x:Sn(s-o)<Nn?l:a,y:o}:Sn(d-a)<Nn&&c-r>Nn?{x:a,y:Sn(l-a)<Nn?s:r}:Sn(c-r)<Nn&&d-t>Nn?{x:Sn(s-r)<Nn?l:t,y:r}:null),p.site,null)),++h)}function mr(e,t){return t.angle-e.angle}function yr(){Cr(this),this.x=this.y=this.arc=this.site=this.cy=null}function fr(e){var t=e.P,a=e.N;if(t&&a){var r=t.site,o=e.site,i=a.site;if(r!==i){var l=o.x,s=o.y,c=r.x-l,p=r.y-s,u=i.x-l,g=i.y-s,h=2*(c*g-p*u);if(!(h>=-n)){var d=c*c+p*p,m=u*u+g*g,f=(g*d-p*m)/h,x=(c*m-u*d)/h,g=x+s,y=os.pop()||new yr;y.arc=e,y.site=o,y.x=f+l,y.y=g+N(f*f+x*x),y.cy=g,e.circle=y;for(var _=null,b=ds._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(b.L)b=b.L;else{_=b.P;break}}else if(b.R)b=b.R;else{_=b;break}ds.insert(_,y),_||(ss=y)}}}}function xr(e){var t=e.circle;t&&(!t.P&&(ss=t.N),ds.remove(t),os.push(t),Cr(t),e.circle=null)}function _r(t){for(var a=is,r=la(t[0][0],t[0][1],t[1][0],t[1][1]),o=a.length,n;o--;)n=a[o],(!br(n,t)||!r(n)||Sn(n.a.x-n.b.x)<Nn&&Sn(n.a.y-n.b.y)<Nn)&&(n.a=n.b=null,a.splice(o,1))}function br(e,t){var a=e.b;if(a)return!0;var r=e.a,o=t[0][0],i=t[1][0],n=t[0][1],l=t[1][1],s=e.l,d=e.r,c=s.x,p=s.y,u=d.x,g=d.y,h=(c+u)/2,m,y;if(g===p){if(h<o||h>=i)return;if(c>u){if(!r)r={x:h,y:n};else if(r.y>=l)return;a={x:h,y:l}}else{if(!r)r={x:h,y:l};else if(r.y<n)return;a={x:h,y:n}}}else if(m=(c-u)/(g-p),y=(p+g)/2-m*h,-1>m||1<m){if(c>u){if(!r)r={x:(n-y)/m,y:n};else if(r.y>=l)return;a={x:(l-y)/m,y:l}}else{if(!r)r={x:(l-y)/m,y:l};else if(r.y<n)return;a={x:(n-y)/m,y:n}}}else if(p<g){if(!r)r={x:o,y:m*o+y};else if(r.x>=i)return;a={x:i,y:m*i+y}}else{if(!r)r={x:i,y:m*i+y};else if(r.x<o)return;a={x:o,y:m*o+y}}return e.a=r,e.b=a,!0}function vr(e,t){this.l=e,this.r=t,this.a=this.b=null}function kr(e,t,a,r){var o=new vr(e,t);return is.push(o),a&&Tr(o,e,t,a),r&&Tr(o,t,e,r),ns[e.i].edges.push(new Ar(o,e,t)),ns[t.i].edges.push(new Ar(o,t,e)),o}function wr(e,t,a){var r=new vr(e,null);return r.a=t,r.b=a,is.push(r),r}function Tr(e,t,a,r){e.a||e.b?e.l===a?e.b=r:e.a=r:(e.a=r,e.l=t,e.r=a)}function Ar(e,t,a){var r=e.a,o=e.b;this.edge=e,this.site=t,this.angle=a?L(a.y-t.y,a.x-t.x):e.l===t?L(o.x-r.x,r.y-o.y):L(r.x-o.x,o.y-r.y)}function Sr(){this._=null}function Cr(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function Lr(e,t){var a=t,r=t.R,o=a.U;o?o.L===a?o.L=r:o.R=r:e._=r,r.U=o,a.U=r,a.R=r.L,a.R&&(a.R.U=a),r.L=a}function Er(e,t){var a=t,r=t.L,o=a.U;o?o.L===a?o.L=r:o.R=r:e._=r,r.U=o,a.U=r,a.L=r.R,a.L&&(a.L.U=a),r.R=a}function Ir(e){for(;e.L;)e=e.L;return e}function zr(e,t){var a=e.sort(Pr).pop(),r,o,i;for(is=[],ns=Array(e.length),ls=new Sr,ds=new Sr;;)if(i=ss,a&&(!i||a.y<i.y||a.y===i.y&&a.x<i.x))(a.x!==r||a.y!==o)&&(ns[a.i]=new gr(a),cr(a),r=a.x,o=a.y),a=e.pop();else if(i)dr(i.arc);else break;t&&(_r(t),hr(t));var n={cells:ns,edges:is};return ls=ds=is=ns=null,n}function Pr(e,t){return t.y-e.y||t.x-e.x}function Dr(e,t,a){return(e.x-a.x)*(t.y-e.y)-(e.x-t.x)*(a.y-e.y)}function Or(e){return e.x}function Rr(e){return e.y}function Mr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function jr(e,t,a,r,o,i){if(!e(t,a,r,o,i)){var n=.5*(a+o),l=.5*(r+i),s=t.nodes;s[0]&&jr(e,s[0],a,r,n,l),s[1]&&jr(e,s[1],n,r,o,l),s[2]&&jr(e,s[2],a,l,n,i),s[3]&&jr(e,s[3],n,l,o,i)}}function Fr(e,t,a,r,o,n,l){var i=1/0,s;return function e(d,c,p,u,g){if(!(c>n||p>l||u<r||g<o)){if(f=d.point){var h=t-d.x,m=a-d.y,y=h*h+m*m,f;if(y<i){var x=N(i=y);r=t-x,o=a-x,n=t+x,l=a+x,s=f}}for(var _=d.nodes,b=.5*(c+u),v=.5*(p+g),k=(a>=v)<<1|t>=b;void 0>k;++k)if(d=_[3&k])switch(3&k){case 0:e(d,c,p,b,v);break;case 1:e(d,b,p,u,v);break;case 2:e(d,c,v,b,g);break;case 3:e(d,b,v,u,g);}}}(e,r,o,n,l),s}function Br(e,t){e=_n.rgb(e),t=_n.rgb(t);var r=e.r,o=e.g,i=e.b,n=t.r-r,l=t.g-o,s=t.b-i;return function(e){return"#"+Ve(V(r+n*e))+Ve(V(o+l*e))+Ve(V(i+s*e))}}function Nr(e,t){var a={},r={},o;for(o in e)o in t?a[o]=Hr(e[o],t[o]):r[o]=e[o];for(o in t)o in e||(r[o]=t[o]);return function(e){for(o in a)r[o]=a[o](e);return r}}function Vr(e,r){return e=+e,r=+r,function(a){return e*(1-a)+r*a}}function Ur(e,r){var t=ps.lastIndex=us.lastIndex=0,o=-1,n=[],l=[],s,d,c;for(e+="",r+="";(s=ps.exec(e))&&(d=us.exec(r));)(c=d.index)>t&&(c=r.slice(t,c),n[o]?n[o]+=c:n[++o]=c),(s=s[0])===(d=d[0])?n[o]?n[o]+=d:n[++o]=d:(n[++o]=null,l.push({i:o,x:Vr(s,d)})),t=us.lastIndex;return t<r.length&&(c=r.slice(t),n[o]?n[o]+=c:n[++o]=c),2>n.length?l[0]?(r=l[0].x,function(e){return r(e)+""}):function(){return r}:(r=l.length,function(e){for(var t=0,a;t<r;++t)n[(a=l[t]).i]=a.x(e);return n.join("")})}function Hr(e,t){for(var a=_n.interpolators.length,r;0<=--a&&!(r=_n.interpolators[a](e,t)););return r}function Gr(e,t){var a=[],r=[],o=e.length,n=t.length,l=ea(e.length,t.length),s;for(s=0;s<l;++s)a.push(Hr(e[s],t[s]));for(;s<o;++s)r[s]=e[s];for(;s<n;++s)r[s]=t[s];return function(e){for(s=0;s<l;++s)r[s]=a[s](e);return r}}function qr(e){return function(a){return 0>=a?0:1<=a?1:e(a)}}function Yr(e){return function(a){return 1-e(1-a)}}function Wr(e){return function(a){return .5*(.5>a?e(2*a):2-e(2-2*a))}}function Xr(e){return e*e}function Zr(e){return e*e*e}function Kr(e){if(0>=e)return 0;if(1<=e)return 1;var t=e*e,a=t*e;return 4*(.5>e?a:3*(e-t)+a-.75)}function Jr(e){return 1-R(e*Un)}function Qr(e){return ya(2,10*(e-1))}function $r(e){return 1-N(1-e*e)}function eo(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function to(e,a){return a-=e,function(r){return V(e+a*r)}}function ao(e){var t=[e.a,e.b],a=[e.c,e.d],r=oo(t),o=ro(t,a),i=oo(io(a,t,-o))||0;t[0]*a[1]<a[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,o*=-1),this.rotate=(r?L(t[1],t[0]):L(-a[0],a[1]))*Gn,this.translate=[e.e,e.f],this.scale=[r,i],this.skew=i?L(o,i)*Gn:0}function ro(e,t){return e[0]*t[0]+e[1]*t[1]}function oo(e){var t=N(ro(e,e));return t&&(e[0]/=t,e[1]/=t),t}function io(e,t,a){return e[0]+=a*t[0],e[1]+=a*t[1],e}function no(e){return e.length?e.pop()+",":""}function lo(e,t,a,r){if(e[0]!==t[0]||e[1]!==t[1]){var o=a.push("translate(",null,",",null,")");r.push({i:o-4,x:Vr(e[0],t[0])},{i:o-2,x:Vr(e[1],t[1])})}else(t[0]||t[1])&&a.push("translate("+t+")")}function so(e,t,a,r){e===t?t&&a.push(no(a)+"rotate("+t+")"):(180<e-t?t+=360:180<t-e&&(e+=360),r.push({i:a.push(no(a)+"rotate(",null,")")-2,x:Vr(e,t)}))}function co(e,t,a,r){e===t?t&&a.push(no(a)+"skewX("+t+")"):r.push({i:a.push(no(a)+"skewX(",null,")")-2,x:Vr(e,t)})}function po(e,t,a,r){if(e[0]!==t[0]||e[1]!==t[1]){var o=a.push(no(a)+"scale(",null,",",null,")");r.push({i:o-4,x:Vr(e[0],t[0])},{i:o-2,x:Vr(e[1],t[1])})}else(1!==t[0]||1!==t[1])&&a.push(no(a)+"scale("+t+")")}function uo(e,t){var r=[],l=[];return e=_n.transform(e),t=_n.transform(t),lo(e.translate,t.translate,r,l),so(e.rotate,t.rotate,r,l),co(e.skew,t.skew,r,l),po(e.scale,t.scale,r,l),e=t=null,function(e){for(var t=-1,a=l.length,n;++t<a;)r[(n=l[t]).i]=n.x(e);return r.join("")}}function go(e,t){return t=(t-=e=+e)||1/t,function(a){return(a-e)/t}}function ho(e,t){return t=(t-=e=+e)||1/t,function(a){return va(0,ea(1,(a-e)/t))}}function mo(e){for(var t=e.source,a=e.target,r=fo(t,a),o=[t];t!==r;)t=t.parent,o.push(t);for(var i=o.length;a!==r;)o.splice(i,0,a),a=a.parent;return o}function yo(e){for(var t=[],a=e.parent;null!=a;)t.push(e),e=a,a=a.parent;return t.push(e),t}function fo(e,t){if(e===t)return e;for(var a=yo(e),r=yo(t),o=a.pop(),i=r.pop(),n=null;o===i;)n=o,o=a.pop(),i=r.pop();return n}function xo(e){e.fixed|=2}function _o(e){e.fixed&=-7}function bo(e){e.fixed|=4,e.px=e.x,e.py=e.y}function vo(e){e.fixed&=-5}function ko(e,t,a){var r=0,o=0;if(e.charge=0,!e.leaf)for(var l=e.nodes,s=l.length,n=-1,d;++n<s;)d=l[n],null==d||(ko(d,t,a),e.charge+=d.charge,r+=d.charge*d.cx,o+=d.charge*d.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var p=t*a[e.point.index];e.charge+=e.pointCharge=p,r+=p*e.point.x,o+=p*e.point.y}e.cx=r/e.charge,e.cy=o/e.charge}function wo(e,t){return _n.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=Eo,e}function To(e,t){for(var a=[e];null!=(e=a.pop());)if(t(e),(o=e.children)&&(r=o.length))for(var r,o;0<=--r;)a.push(o[r])}function Ao(e,t){for(var a=[e],r=[];null!=(e=a.pop());)if(r.push(e),(s=e.children)&&(l=s.length))for(var o=-1,l,s;++o<l;)a.push(s[o]);for(;null!=(e=r.pop());)t(e)}function So(e){return e.children}function Co(e){return e.value}function Lo(e,t){return t.value-e.value}function Eo(e){return _n.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function Io(e){return e.x}function zo(e){return e.y}function Po(e,t,a){e.y0=t,e.y=a}function Do(e){return _n.range(e.length)}function Oo(e){for(var t=-1,a=e[0].length,r=[];++t<a;)r[t]=0;return r}function Ro(e){for(var t=1,a=0,r=e[0][1],o=e.length,n;t<o;++t)(n=e[t][1])>r&&(a=t,r=n);return a}function Mo(e){return e.reduce(jo,0)}function jo(e,t){return e+t[1]}function Fo(e,t){return Bo(e,M(P(t.length)/E+1))}function Bo(e,t){for(var a=-1,r=+e[0],o=(e[1]-r)/t,i=[];++a<=t;)i[a]=o*a+r;return i}function No(e){return[_n.min(e),_n.max(e)]}function Vo(e,t){return e.value-t.value}function Uo(e,t){var a=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=a,a._pack_prev=t}function Ho(e,t){e._pack_next=t,t._pack_prev=e}function Go(e,t){var a=t.x-e.x,r=t.y-e.y,o=e.r+t.r;return .999*o*o>a*a+r*r}function qo(e){function t(e){r=ea(e.x-e.r,r),o=va(e.x+e.r,o),l=ea(e.y-e.r,l),s=va(e.y+e.r,s)}if((d=e.children)&&(f=d.length)){var r=1/0,o=-Infinity,l=1/0,s=-Infinity,d,p,u,g,h,m,y,f;if(d.forEach(Yo),p=d[0],p.x=-p.r,p.y=0,t(p),1<f&&(u=d[1],u.x=u.r,u.y=0,t(u),2<f))for(g=d[2],Zo(p,u,g),t(g),Uo(p,g),p._pack_prev=g,Uo(g,u),u=p._pack_next,h=3;h<f;h++){Zo(p,u,g=d[h]);var x=0,_=1,v=1;for(m=u._pack_next;m!==u;m=m._pack_next,_++)if(Go(m,g)){x=1;break}if(1==x)for(y=p._pack_prev;y!==m._pack_prev&&!Go(y,g);y=y._pack_prev,v++);x?(_<v||_==v&&u.r<p.r?Ho(p,u=m):Ho(p=y,u),h--):(Uo(p,g),u=g,t(g))}var w=(r+o)/2,T=(l+s)/2,A=0;for(h=0;h<f;h++)g=d[h],g.x-=w,g.y-=T,A=va(A,g.r+N(g.x*g.x+g.y*g.y));e.r=A,d.forEach(Wo)}}function Yo(e){e._pack_next=e._pack_prev=e}function Wo(e){delete e._pack_next,delete e._pack_prev}function Xo(e,t,a,r){var o=e.children;if(e.x=t+=r*e.x,e.y=a+=r*e.y,e.r*=r,o)for(var l=-1,s=o.length;++l<s;)Xo(o[l],t,a,r)}function Zo(e,t,a){var r=e.r+a.r,o=t.x-e.x,i=t.y-e.y;if(r&&(o||i)){var n=t.r+a.r,l=o*o+i*i;n*=n,r*=r;var s=.5+(r-n)/(2*l),d=N(va(0,2*n*(r+l)-(r-=l)*r-n*n))/(2*l);a.x=e.x+s*o+d*i,a.y=e.y+s*i-d*o}else a.x=e.x+r,a.y=e.y}function Ko(e,t){return e.parent==t.parent?1:2}function Jo(e){var t=e.children;return t.length?t[0]:e.t}function Qo(e){var t=e.children,a;return(a=t.length)?t[a-1]:e.t}function $o(e,t,a){var r=a/(t.i-e.i);t.c-=r,t.s+=a,e.c+=r,t.z+=a,t.m+=a}function ei(e){for(var t=0,a=0,r=e.children,o=r.length,n;0<=--o;)n=r[o],n.z+=t,n.m+=t,t+=n.s+(a+=n.c)}function ti(e,t,a){return e.a.parent===t.parent?e.a:a}function ai(e){return 1+_n.max(e,function(e){return e.y})}function ri(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function oi(e){var t=e.children;return t&&t.length?oi(t[0]):e}function ii(e){var t=e.children,a;return t&&(a=t.length)?ii(t[a-1]):e}function ni(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function li(e,t){var a=e.x+t[3],r=e.y+t[0],o=e.dx-t[1]-t[3],i=e.dy-t[0]-t[2];return 0>o&&(a+=o/2,o=0),0>i&&(r+=i/2,i=0),{x:a,y:r,dx:o,dy:i}}function si(e){var t=e[0],a=e[e.length-1];return t<a?[t,a]:[a,t]}function di(e){return e.rangeExtent?e.rangeExtent():si(e.range())}function ci(e,t,a,r){var o=a(e[0],e[1]),n=r(t[0],t[1]);return function(e){return n(o(e))}}function pi(e,t){var a=0,r=e.length-1,o=e[a],i=e[r],n;return i<o&&(n=a,a=r,r=n,n=o,o=i,i=n),e[a]=t.floor(o),e[r]=t.ceil(i),e}function ui(e){return e?{floor:function(t){return ba(t/e)*e},ceil:function(t){return M(t/e)*e}}:ws}function gi(e,t,a,r){var o=[],n=[],i=0,l=ea(e.length,t.length)-1;for(e[l]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<=l;)o.push(a(e[i-1],e[i])),n.push(r(t[i-1],t[i]));return function(t){var a=_n.bisect(e,t,1,l)-1;return n[a](o[a](t))}}function hi(e,t,a,r){function o(){var o=2<ea(e.length,t.length)?gi:ci,s=r?ho:go;return n=o(e,t,s,a),l=o(t,e,s,Hr),i}function i(e){return n(e)}var n,l;return i.invert=function(e){return l(e)},i.domain=function(t){return arguments.length?(e=t.map(Number),o()):e},i.range=function(e){return arguments.length?(t=e,o()):t},i.rangeRound=function(e){return i.range(e).interpolate(to)},i.clamp=function(e){return arguments.length?(r=e,o()):r},i.interpolate=function(e){return arguments.length?(a=e,o()):a},i.ticks=function(t){return xi(e,t)},i.tickFormat=function(t,a){return _i(e,t,a)},i.nice=function(t){return yi(e,t),o()},i.copy=function(){return hi(e,t,a,r)},o()}function mi(e,t){return _n.rebind(e,t,"range","rangeRound","interpolate","clamp")}function yi(e,t){return pi(e,ui(fi(e,t)[2])),pi(e,ui(fi(e,t)[2])),e}function fi(e,t){null==t&&(t=10);var a=si(e),r=a[1]-a[0],o=ya(10,ba(P(r/t)/I)),i=t/r*o;return .15>=i?o*=10:.35>=i?o*=5:.75>=i&&(o*=2),a[0]=M(a[0]/o)*o,a[1]=ba(a[1]/o)*o+.5*o,a[2]=o,a}function xi(e,t){return _n.range.apply(_n,fi(e,t))}function _i(e,t,a){var r=fi(e,t);if(a){var o=pl.exec(a);if(o.shift(),"s"===o[8]){var i=_n.formatPrefix(va(Sn(r[0]),Sn(r[1])));return o[7]||(o[7]="."+bi(i.scale(r[2]))),o[8]="f",a=_n.format(o.join("")),function(e){return a(i.scale(e))+i.symbol}}o[7]||(o[7]="."+vi(o[8],r)),a=o.join("")}else a=",."+bi(r[2])+"f";return _n.format(a)}function bi(e){return-ba(P(e)/I+.01)}function vi(e,t){var a=bi(t[2]);return e in Ts?_a(a-bi(va(Sn(t[0]),Sn(t[1]))))+ +("e"!==e):a-2*("%"===e)}function ki(e,t,a,r){function o(e){return(a?P(0>e?0:e):-P(0<e?0:-e))/P(t)}function l(e){return a?ya(t,e):-ya(t,-e)}function s(t){return e(o(t))}return s.invert=function(t){return l(e.invert(t))},s.domain=function(t){return arguments.length?(a=0<=t[0],e.domain((r=t.map(Number)).map(o)),s):r},s.base=function(a){return arguments.length?(t=+a,e.domain(r.map(o)),s):t},s.nice=function(){var t=pi(r.map(o),a?Math:Ss);return e.domain(t),r=t.map(l),s},s.ticks=function(){var e=si(r),s=[],d=e[0],c=e[1],p=ba(o(d)),u=M(o(c)),g=t%1?2:t;if(isFinite(u-p)){if(a){for(;p<u;p++)for(var n=1;n<g;n++)s.push(l(p)*n);s.push(l(p))}else for(s.push(l(p));p++<u;)for(var n=g-1;0<n;n--)s.push(l(p)*n);for(p=0;s[p]<d;p++);for(u=s.length;s[u-1]>c;u--);s=s.slice(p,u)}return s},s.tickFormat=function(e,a){if(!arguments.length)return As;2>arguments.length?a=As:"function"!=typeof a&&(a=_n.format(a));var r=va(1,t*e/s.ticks().length);return function(e){var n=e/l(V(o(e)));return n*t<t-.5&&(n*=t),n<=r?a(e):""}},s.copy=function(){return ki(e.copy(),t,a,r)},mi(s,e)}function wi(e,t,a){function r(t){return e(o(t))}var o=Ti(t),i=Ti(1/t);return r.invert=function(t){return i(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain((a=t.map(Number)).map(o)),r):a},r.ticks=function(e){return xi(a,e)},r.tickFormat=function(e,t){return _i(a,e,t)},r.nice=function(e){return r.domain(yi(a,e))},r.exponent=function(n){return arguments.length?(o=Ti(t=n),i=Ti(1/t),e.domain(a.map(o)),r):t},r.copy=function(){return wi(e.copy(),t,a)},mi(r,e)}function Ti(t){return function(e){return 0>e?-ya(-e,t):ya(e,t)}}function Ai(e,t){function a(a){return i[((o.get(a)||("range"===t.t?o.set(a,e.push(a)):NaN))-1)%i.length]}function r(t,a){return _n.range(e.length).map(function(e){return t+a*e})}var o,i,n;return a.domain=function(r){if(!arguments.length)return e;e=[],o=new _;for(var l=-1,s=r.length,n;++l<s;)o.has(n=r[l])||o.set(n,e.push(n));return a[t.t].apply(a,t.a)},a.range=function(e){return arguments.length?(i=e,n=0,t={t:"range",a:arguments},a):i},a.rangePoints=function(o,l){2>arguments.length&&(l=0);var s=o[0],d=o[1],c=2>e.length?(s=(s+d)/2,0):(d-s)/(e.length-1+l);return i=r(s+c*l/2,c),n=0,t={t:"rangePoints",a:arguments},a},a.rangeRoundPoints=function(o,l){2>arguments.length&&(l=0);var s=o[0],d=o[1],c=2>e.length?(s=d=V((s+d)/2),0):0|(d-s)/(e.length-1+l);return i=r(s+V(c*l/2+(d-s-(e.length-1+l)*c)/2),c),n=0,t={t:"rangeRoundPoints",a:arguments},a},a.rangeBands=function(o,l,s){2>arguments.length&&(l=0),3>arguments.length&&(s=l);var d=o[1]<o[0],c=o[d-0],p=o[1-d],u=(p-c)/(e.length-l+2*s);return i=r(c+u*s,u),d&&i.reverse(),n=u*(1-l),t={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(o,l,s){2>arguments.length&&(l=0),3>arguments.length&&(s=l);var d=o[1]<o[0],c=o[d-0],p=o[1-d],u=ba((p-c)/(e.length-l+2*s));return i=r(c+V((p-c-(e.length-l)*u)/2),u),d&&i.reverse(),n=V(u*(1-l)),t={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return n},a.rangeExtent=function(){return si(t.a[0])},a.copy=function(){return Ai(e,t)},a.domain(e)}function Si(e,t){function a(){var a=0,i=t.length;for(o=[];++a<i;)o[a-1]=_n.quantile(e,a/i);return r}function r(e){if(!isNaN(e=+e))return t[_n.bisect(o,e)]}var o;return r.domain=function(t){return arguments.length?(e=t.map(s).filter(p).sort(l),a()):e},r.range=function(e){return arguments.length?(t=e,a()):t},r.quantiles=function(){return o},r.invertExtent=function(a){return a=t.indexOf(a),0>a?[NaN,NaN]:[0<a?o[a-1]:e[0],a<o.length?o[a]:e[e.length-1]]},r.copy=function(){return Si(e,t)},a()}function Ci(e,t,a){function r(t){return a[va(0,ea(l,ba(n*(t-e))))]}function o(){return n=a.length/(t-e),l=a.length-1,r}var n,l;return r.domain=function(a){return arguments.length?(e=+a[0],t=+a[a.length-1],o()):[e,t]},r.range=function(e){return arguments.length?(a=e,o()):a},r.invertExtent=function(t){return t=a.indexOf(t),t=0>t?NaN:t/n+e,[t,t+1/n]},r.copy=function(){return Ci(e,t,a)},o()}function Li(e,t){function a(a){if(a<=a)return t[_n.bisect(e,a)]}return a.domain=function(t){return arguments.length?(e=t,a):e},a.range=function(e){return arguments.length?(t=e,a):t},a.invertExtent=function(a){return a=t.indexOf(a),[e[a-1],e[a]]},a.copy=function(){return Li(e,t)},a}function Ei(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(a){return arguments.length?(e=a.map(t),t):e},t.ticks=function(t){return xi(e,t)},t.tickFormat=function(t,a){return _i(e,t,a)},t.copy=function(){return Ei(e)},t}function Ii(){return 0}function zi(e){return e.innerRadius}function Pi(e){return e.outerRadius}function Di(e){return e.startAngle}function Oi(e){return e.endAngle}function Ri(e){return e&&e.padAngle}function Mi(e,t,a,r){return 0<(e-a)*t-(t-r)*e?0:1}function ji(e,t,a,o,i){var n=e[0]-t[0],l=e[1]-t[1],s=(i?o:-o)/N(n*n+l*l),c=s*l,p=-s*n,u=e[0]+c,g=e[1]+p,h=t[0]+c,m=t[1]+p,y=(u+h)/2,f=(g+m)/2,x=h-u,_=m-g,b=x*x+_*_,v=a-o,r=u*m-h*g,k=(0>_?-1:1)*N(va(0,v*v*b-r*r)),d=(r*_-x*k)/b,w=(-r*x-_*k)/b,T=(r*_+x*k)/b,A=(-r*x+_*k)/b,S=d-y,C=w-f,L=T-y,E=A-f;return S*S+C*C>L*L+E*E&&(d=T,w=A),[[d-c,w-p],[d*a/v,w*a/v]]}function Fi(e){function t(t){function s(){c.push("M",i(e(p),l))}for(var c=[],p=[],u=-1,g=t.length,n=We(a),h=We(r),m;++u<g;)o.call(this,m=t[u],u)?p.push([+n.call(this,m,u),+h.call(this,m,u)]):p.length&&(s(),p=[]);return p.length&&s(),c.length?c.join(""):null}var a=$a,r=er,o=Zt,i=Bi,n=i.key,l=.7;return t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(o=e,t):o},t.interpolate=function(e){return arguments.length?(n="function"==typeof e?i=e:(i=Ps.get(e)||Bi).key,t):n},t.tension=function(e){return arguments.length?(l=e,t):l},t}function Bi(e){return 1<e.length?e.join("L"):e+"Z"}function Ni(e){return e.join("L")+"Z"}function Vi(e){for(var t=0,a=e.length,r=e[0],o=[r[0],",",r[1]];++t<a;)o.push("V",(r=e[t])[1],"H",r[0]);return o.join("")}function Ui(e){for(var t=0,a=e.length,r=e[0],o=[r[0],",",r[1]];++t<a;)o.push("H",(r=e[t])[0],"V",r[1]);return o.join("")}function Hi(e,a){if(1>a.length||e.length!=a.length&&e.length!=a.length+2)return Bi(e);var r=e.length!=a.length,o="",n=e[0],l=e[1],s=a[0],d=s,c=1;if(r&&(o+="Q"+(l[0]-2*s[0]/3)+","+(l[1]-2*s[1]/3)+","+l[0]+","+l[1],n=e[1],c=2),1<a.length){d=a[1],l=e[c],c++,o+="C"+(n[0]+s[0])+","+(n[1]+s[1])+","+(l[0]-d[0])+","+(l[1]-d[1])+","+l[0]+","+l[1];for(var u=2;u<a.length;u++,c++)l=e[c],d=a[u],o+="S"+(l[0]-d[0])+","+(l[1]-d[1])+","+l[0]+","+l[1]}if(r){var g=e[c];o+="Q"+(l[0]+2*d[0]/3)+","+(l[1]+2*d[1]/3)+","+g[0]+","+g[1]}return o}function Gi(e,t){for(var r=[],o=(1-t)/2,a=e[0],l=e[1],s=1,d=e.length,n;++s<d;)n=a,a=l,l=e[s],r.push([o*(l[0]-n[0]),o*(l[1]-n[1])]);return r}function qi(e){if(3>e.length)return Bi(e);var t=1,a=e.length,r=e[0],o=r[0],n=r[1],l=[o,o,o,(r=e[1])[0]],s=[n,n,n,r[1]],d=[o,",",n,"L",Yi(Rs,l),",",Yi(Rs,s)];for(e.push(e[a-1]);++t<=a;)r=e[t],l.shift(),l.push(r[0]),s.shift(),s.push(r[1]),Wi(d,l,s);return e.pop(),d.push("L",r),d.join("")}function Yi(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Wi(e,t,a){e.push("C",Yi(Ds,t),",",Yi(Ds,a),",",Yi(Os,t),",",Yi(Os,a),",",Yi(Rs,t),",",Yi(Rs,a))}function Xi(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Zi(e){for(var t=0,a=e.length-1,r=[],o=e[0],n=e[1],l=r[0]=Xi(o,n);++t<a;)r[t]=(l+(l=Xi(o=n,n=e[t+1])))/2;return r[t]=l,r}function Ki(e){for(var t=[],r=Zi(e),o=-1,n=e.length-1,l,c,p,u;++o<n;)l=Xi(e[o],e[o+1]),Sn(l)<Nn?r[o]=r[o+1]=0:(c=r[o]/l,p=r[o+1]/l,u=c*c+p*p,9<u&&(u=3*l/N(u),r[o]=u*c,r[o+1]=u*p));for(o=-1;++o<=n;)u=(e[ea(n,o+1)][0]-e[va(0,o-1)][0])/(6*(1+r[o]*r[o])),t.push([u||0,r[o]*u||0]);return t}function Ji(e){for(var t=-1,o=e.length,n,l,s;++t<o;)n=e[t],l=n[0],s=n[1]-Un,n[0]=l*R(s),n[1]=l*De(s);return e}function Qi(e){function t(t){function c(){g.push("M",d(e(m),i),u,p(e(h.reverse()),i),"Z")}for(var g=[],h=[],m=[],f=-1,_=t.length,n=We(a),b=We(o),v=a===r?function(){return T}:We(r),k=o===l?function(){return A}:We(l),w,T,A;++f<_;)s.call(this,w=t[f],f)?(h.push([T=+n.call(this,w,f),A=+b.call(this,w,f)]),m.push([+v.call(this,w,f),+k.call(this,w,f)])):h.length&&(c(),h=[],m=[]);return h.length&&c(),g.length?g.join(""):null}var a=$a,r=$a,o=0,l=er,s=Zt,d=Bi,c=d.key,p=d,u="L",i=.7;return t.x=function(e){return arguments.length?(a=r=e,t):r},t.x0=function(e){return arguments.length?(a=e,t):a},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(o=l=e,t):l},t.y0=function(e){return arguments.length?(o=e,t):o},t.y1=function(e){return arguments.length?(l=e,t):l},t.defined=function(e){return arguments.length?(s=e,t):s},t.interpolate=function(e){return arguments.length?(c="function"==typeof e?d=e:(d=Ps.get(e)||Bi).key,p=d.reverse||d,u=d.closed?"M":"L",t):c},t.tension=function(e){return arguments.length?(i=e,t):i},t}function $i(e){return e.radius}function en(e){return[e.x,e.y]}function tn(e){return function(){var t=e.apply(this,arguments),o=t[0],r=t[1]-Un;return[o*R(r),o*De(r)]}}function an(){return 64}function rn(){return"circle"}function on(e){var t=N(e/i);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function nn(e){return function(){var t,a,r;(t=this[e])&&(r=t[a=t.active])&&(r.timer.c=null,r.timer.t=NaN,--t.count?delete t[a]:delete this[e],t.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function ln(e,t,a){return En(e,Ns),e.namespace=t,e.id=a,e}function sn(e,t,a,r){var o=e.id,n=e.namespace;return se(e,"function"==typeof a?function(e,l,i){e[n][o].tween.set(t,r(a.call(e,e.__data__,l,i)))}:(a=r(a),function(e){e[n][o].tween.set(t,a)}))}function dn(e){return null==e&&(e=""),function(){this.textContent=e}}function cn(e){return null==e?"__transition__":"__transition_"+e+"__"}function pn(a,r,o,i,e){function t(e){var t=d.delay;return p.t=t+c,t<=e?n(e-t):void(p.c=n)}function n(e){var t=s.active,o=s[t];for(var n in o&&(o.timer.c=null,o.timer.t=NaN,--s.count,delete s[t],o.event&&o.event.interrupt.call(a,a.__data__,o.index)),s)if(+n<i){var m=s[n];m.timer.c=null,m.timer.t=NaN,--s.count,delete s[n]}p.c=l,Qe(function(){return p.c&&l(e||1)&&(p.c=null,p.t=NaN),1},0,c),s.active=i,d.event&&d.event.start.call(a,a.__data__,r),h=[],d.tween.forEach(function(e,t){(t=t.call(a,a.__data__,r))&&h.push(t)}),g=d.ease,u=d.duration}function l(l){for(var c=l/u,t=g(c),e=h.length;0<e;)h[--e].call(a,t);if(1<=c)return d.event&&d.event.end.call(a,a.__data__,r),--s.count?delete s[i]:delete a[o],1}var s=a[o]||(a[o]={active:0,count:0}),d=s[i],c,p,u,g,h;d||(c=e.time,p=Qe(t,0,c),d=s[i]={tween:new _,time:c,timer:p,delay:e.delay,duration:e.duration,ease:e.ease,index:r},e=null,++s.count)}function un(e,t,a){e.attr("transform",function(e){var r=t(e);return"translate("+(isFinite(r)?r:a(e))+",0)"})}function gn(e,t,a){e.attr("transform",function(e){var r=t(e);return"translate(0,"+(isFinite(r)?r:a(e))+")"})}function hn(e){return e.toISOString()}function mn(e,t,a){function r(t){return e(t)}function o(e,a){var r=e[1]-e[0],o=r/a,n=_n.bisect(Js,o);return n==Js.length?[t.year,fi(e.map(function(e){return e/31536e6}),a)[2]]:n?t[o/Js[n-1]<Js[n]/o?n-1:n]:[ed,fi(e,a)[2]]}return r.invert=function(t){return yn(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(yn)},r.nice=function(e,t){function a(a){return!isNaN(a)&&!e.range(a,yn(+a+1),t).length}var i=r.domain(),n=si(i),l=null==e?o(n,10):"number"==typeof e&&o(n,e);return l&&(e=l[0],t=l[1]),r.domain(pi(i,1<t?{floor:function(t){for(;a(t=e.floor(t));)t=yn(t-1);return t},ceil:function(t){for(;a(t=e.ceil(t));)t=yn(+t+1);return t}}:e))},r.ticks=function(e,t){var a=si(r.domain()),i=null==e?o(a,10):"number"==typeof e?o(a,e):!e.range&&[{range:e},t];return i&&(e=i[0],t=i[1]),e.range(a[0],yn(+a[1]+1),1>t?1:t)},r.tickFormat=function(){return a},r.copy=function(){return mn(e.copy(),t,a)},mi(r,e)}function yn(e){return new Date(e)}function fn(e){return JSON.parse(e.responseText)}function xn(e){var t=x.createRange();return t.selectNode(x.body),t.createContextualFragment(e.responseText)}var _n={version:"3.5.17"},a=[].slice,f=function(e){return a.call(e)},x=this.document;if(x)try{f(x.documentElement.childNodes)[0].nodeType}catch(t){f=function(e){for(var t=e.length,a=Array(t);t--;)a[t]=e[t];return a}}if(Date.now||(Date.now=function(){return+new Date}),x)try{x.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var bn=this.Element.prototype,vn=bn.setAttribute,kn=bn.setAttributeNS,wn=this.CSSStyleDeclaration.prototype,Tn=wn.setProperty;bn.setAttribute=function(e,t){vn.call(this,e,t+"")},bn.setAttributeNS=function(e,t,a){kn.call(this,e,t,a+"")},wn.setProperty=function(e,t,a){Tn.call(this,e,t+"",a)}}_n.ascending=l,_n.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},_n.min=function(e,t){var r=-1,o=e.length,n,l;if(1===arguments.length){for(;++r<o;)if(null!=(l=e[r])&&l>=l){n=l;break}for(;++r<o;)null!=(l=e[r])&&n>l&&(n=l)}else{for(;++r<o;)if(null!=(l=t.call(e,e[r],r))&&l>=l){n=l;break}for(;++r<o;)null!=(l=t.call(e,e[r],r))&&n>l&&(n=l)}return n},_n.max=function(e,t){var r=-1,o=e.length,n,l;if(1===arguments.length){for(;++r<o;)if(null!=(l=e[r])&&l>=l){n=l;break}for(;++r<o;)null!=(l=e[r])&&l>n&&(n=l)}else{for(;++r<o;)if(null!=(l=t.call(e,e[r],r))&&l>=l){n=l;break}for(;++r<o;)null!=(l=t.call(e,e[r],r))&&l>n&&(n=l)}return n},_n.extent=function(e,t){var r=-1,o=e.length,n,l,s;if(1===arguments.length){for(;++r<o;)if(null!=(l=e[r])&&l>=l){n=s=l;break}for(;++r<o;)null!=(l=e[r])&&(n>l&&(n=l),s<l&&(s=l))}else{for(;++r<o;)if(null!=(l=t.call(e,e[r],r))&&l>=l){n=s=l;break}for(;++r<o;)null!=(l=t.call(e,e[r],r))&&(n>l&&(n=l),s<l&&(s=l))}return[n,s]},_n.sum=function(e,t){var r=0,o=e.length,n=-1,l;if(1===arguments.length)for(;++n<o;)p(l=+e[n])&&(r+=l);else for(;++n<o;)p(l=+t.call(e,e[n],n))&&(r+=l);return r},_n.mean=function(e,t){var r=0,o=e.length,n=-1,l=o,d;if(1===arguments.length)for(;++n<o;)p(d=s(e[n]))?r+=d:--l;else for(;++n<o;)p(d=s(t.call(e,e[n],n)))?r+=d:--l;return l?r/l:void 0},_n.quantile=function(t,a){var r=(t.length-1)*a+1,o=ba(r),i=+t[o-1],n=r-o;return n?i+n*(t[o]-i):i},_n.median=function(e,t){var r=[],o=e.length,n=-1,d;if(1===arguments.length)for(;++n<o;)p(d=s(e[n]))&&r.push(d);else for(;++n<o;)p(d=s(t.call(e,e[n],n)))&&r.push(d);return r.length?_n.quantile(r.sort(l),.5):void 0},_n.variance=function(e,t){var r=e.length,o=0,n=0,l=-1,c=0,u,g;if(1===arguments.length)for(;++l<r;)p(u=s(e[l]))&&(g=u-o,o+=g/++c,n+=g*(u-o));else for(;++l<r;)p(u=s(t.call(e,e[l],l)))&&(g=u-o,o+=g/++c,n+=g*(u-o));return 1<c?n/(c-1):void 0},_n.deviation=function(){var e=_n.variance.apply(this,arguments);return e?N(e):e};var An=u(l);_n.bisectLeft=An.left,_n.bisect=_n.bisectRight=An.right,_n.bisector=function(e){return u(1===e.length?function(t,a){return l(e(t),a)}:e)},_n.shuffle=function(e,a,r){3>(o=arguments.length)&&(r=e.length,2>o&&(a=0));for(var o=r-a,n,l;o;)l=0|Math.random()*o--,n=e[o+a],e[o+a]=e[l+a],e[l+a]=n;return e},_n.permute=function(e,t){for(var a=t.length,r=Array(a);a--;)r[a]=e[t[a]];return r},_n.pairs=function(e){for(var t=0,a=e.length-1,r=e[0],o=Array(0>a?0:a),n;t<a;)o[t]=[n=r,r=e[++t]];return o},_n.transpose=function(e){if(!(s=e.length))return[];for(var t=-1,a=_n.min(e,g),r=Array(a);++t<a;)for(var o=-1,l=r[t]=Array(s),s;++o<s;)l[o]=e[o][t];return r},_n.zip=function(){return _n.transpose(arguments)},_n.keys=function(e){var t=[];for(var a in e)t.push(a);return t},_n.values=function(e){var t=[];for(var a in e)t.push(e[a]);return t},_n.entries=function(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t},_n.merge=function(e){for(var t=e.length,a=-1,r=0,o,l,s;++a<t;)r+=e[a].length;for(l=Array(r);0<=--t;)for(s=e[t],o=s.length;0<=--o;)l[--r]=s[o];return l};var Sn=_a;_n.range=function(e,t,a){if(3>arguments.length&&(a=1,2>arguments.length&&(t=e,e=0)),(t-e)/a==1/0)throw new Error("infinite range");var r=[],o=h(Sn(a)),n=-1,l;if(e*=o,t*=o,a*=o,0>a)for(;(l=e+a*++n)>t;)r.push(l/o);else for(;(l=e+a*++n)<t;)r.push(l/o);return r},_n.map=function(e,t){var a=new _;if(e instanceof _)e.forEach(function(e,t){a.set(e,t)});else if(Array.isArray(e)){var r=-1,l=e.length,n;if(1===arguments.length)for(;++r<l;)a.set(r,e[r]);else for(;++r<l;)a.set(t.call(e,n=e[r],r),n)}else for(var s in e)a.set(s,e[s]);return a};y(_,{has:k,get:function(e){return this._[b(e)]},set:function(e,t){return this._[b(e)]=t},remove:w,keys:T,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:v(t),value:this._[t]});return e},size:A,empty:S,forEach:function(e){for(var t in this._)e.call(this,v(t),this._[t])}}),_n.nest=function(){function e(t,o,d){if(d>=r.length)return s?s.call(a,o):l?o.sort(l):o;for(var c=-1,p=o.length,n=r[d++],u=new _,g,h,m,y;++c<p;)(y=u.get(g=n(h=o[c])))?y.push(h):u.set(g,[h]);return t?(h=t(),m=function(a,r){h.set(a,e(t,r,d))}):(h={},m=function(a,r){h[a]=e(t,r,d)}),u.forEach(m),h}function t(e,a){if(a>=r.length)return e;var i=[],n=o[a++];return e.forEach(function(e,r){i.push({key:e,values:t(r,a)})}),n?i.sort(function(e,t){return n(e.key,t.key)}):i}var a={},r=[],o=[],l,s;return a.map=function(t,a){return e(a,t,0)},a.entries=function(a){return t(e(_n.map,a,0),0)},a.key=function(e){return r.push(e),a},a.sortKeys=function(e){return o[r.length-1]=e,a},a.sortValues=function(e){return l=e,a},a.rollup=function(e){return s=e,a},a},_n.set=function(e){var t=new C;if(e)for(var a=0,r=e.length;a<r;++a)t.add(e[a]);return t},y(C,{has:k,add:function(e){return this._[b(e+="")]=!0,e},remove:w,values:T,size:A,empty:S,forEach:function(e){for(var t in this._)e.call(this,v(t))}}),_n.behavior={},_n.rebind=function(e,t){for(var a=1,r=arguments.length,o;++a<r;)e[o=arguments[a]]=O(e,t,t[o]);return e};var Cn=["webkit","ms","moz","Moz","o","O"];_n.dispatch=function(){for(var e=new B,t=-1,a=arguments.length;++t<a;)e[arguments[t]]=U(e);return e},B.prototype.on=function(e,t){var a=e.indexOf("."),r="";if(0<=a&&(r=e.slice(a+1),e=e.slice(0,a)),e)return 2>arguments.length?this[e].on(r):this[e].on(r,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(r,null);return this}},_n.event=null,_n.requote=function(e){return e.replace(Ln,"\\$&")};var Ln=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,En={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var a in t)e[a]=t[a]},In=function(e,t){return t.querySelector(e)},zn=function(e,t){return t.querySelectorAll(e)},Pn=function(e,t){var a=e.matches||e[j(e,"matchesSelector")];return Pn=function(e,t){return a.call(e,t)},Pn(e,t)};"function"==typeof Sizzle&&(In=function(e,t){return Sizzle(e,t)[0]||null},zn=Sizzle,Pn=Sizzle.matchesSelector),_n.selection=function(){return _n.select(x.documentElement)};var Dn=_n.selection.prototype=[];Dn.select=function(e){var t=[],a,r,o,l;e=W(e);for(var s=-1,d=this.length;++s<d;){t.push(a=[]),a.parentNode=(o=this[s]).parentNode;for(var c=-1,p=o.length;++c<p;)(l=o[c])?(a.push(r=e.call(l,l.__data__,c,s)),r&&"__data__"in l&&(r.__data__=l.__data__)):a.push(null)}return Y(t)},Dn.selectAll=function(e){var t=[],a,r;e=X(e);for(var o=-1,l=this.length;++o<l;)for(var s=this[o],d=-1,c=s.length;++d<c;)(r=s[d])&&(t.push(a=f(e.call(r,r.__data__,d,o))),a.parentNode=r);return Y(t)};var On={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};_n.ns={prefix:On,qualify:function(e){var t=e.indexOf(":"),a=e;return 0<=t&&"xmlns"!==(a=e.slice(0,t))&&(e=e.slice(t+1)),On.hasOwnProperty(a)?{space:On[a],local:e}:e}},Dn.attr=function(e,t){if(2>arguments.length){if("string"==typeof e){var a=this.node();return e=_n.ns.qualify(e),e.local?a.getAttributeNS(e.space,e.local):a.getAttribute(e)}for(t in e)this.each(Z(t,e[t]));return this}return this.each(Z(e,t))},Dn.classed=function(e,t){if(2>arguments.length){if("string"==typeof e){var a=this.node(),r=(e=Q(e)).length,o=-1;if(t=a.classList){for(;++o<r;)if(!t.contains(e[o]))return!1;}else for(t=a.getAttribute("class");++o<r;)if(!J(e[o]).test(t))return!1;return!0}for(t in e)this.each($(t,e[t]));return this}return this.each($(e,t))},Dn.style=function(e,t,a){var o=arguments.length;if(3>o){if("string"!=typeof e){for(a in 2>o&&(t=""),e)this.each(te(a,e[a],t));return this}if(2>o){var i=this.node();return r(i).getComputedStyle(i,null).getPropertyValue(e)}a=""}return this.each(te(e,t,a))},Dn.property=function(e,t){if(2>arguments.length){if("string"==typeof e)return this.node()[e];for(t in e)this.each(ae(t,e[t]));return this}return this.each(ae(e,t))},Dn.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Dn.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Dn.append=function(e){return e=re(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},Dn.insert=function(e,t){return e=re(e),t=W(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},Dn.remove=function(){return this.each(oe)},Dn.data=function(e,t){function a(e,a){var r=e.length,o=a.length,n=ea(r,o),l=Array(o),s=Array(o),u=Array(r),g,h,m;if(t){var y=new _,f=Array(r),x;for(g=-1;++g<r;)(h=e[g])&&(y.has(x=t.call(h,h.__data__,g))?u[g]=h:y.set(x,h),f[g]=x);for(g=-1;++g<o;)(h=y.get(x=t.call(a,m=a[g],g)))?!0!==h&&(l[g]=h,h.__data__=m):s[g]=ie(m),y.set(x,!0);for(g=-1;++g<r;)g in f&&!0!==y.get(f[g])&&(u[g]=e[g])}else{for(g=-1;++g<n;)h=e[g],m=a[g],h?(h.__data__=m,l[g]=h):s[g]=ie(m);for(;g<o;++g)s[g]=ie(a[g]);for(;g<r;++g)u[g]=e[g]}s.update=l,s.parentNode=l.parentNode=u.parentNode=e.parentNode,d.push(s),c.push(l),p.push(u)}var r=-1,o=this.length,l,s;if(!arguments.length){for(e=Array(o=(l=this[0]).length);++r<o;)(s=l[r])&&(e[r]=s.__data__);return e}var d=de([]),c=Y([]),p=Y([]);if("function"==typeof e)for(;++r<o;)a(l=this[r],e.call(l,l.parentNode.__data__,r));else for(;++r<o;)a(l=this[r],e);return c.enter=function(){return d},c.exit=function(){return p},c},Dn.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},Dn.filter=function(e){var t=[],a,r,o;"function"!=typeof e&&(e=ne(e));for(var l=0,s=this.length;l<s;l++){t.push(a=[]),a.parentNode=(r=this[l]).parentNode;for(var d=0,c=r.length;d<c;d++)(o=r[d])&&e.call(o,o.__data__,d,l)&&a.push(o)}return Y(t)},Dn.order=function(){for(var e=-1,t=this.length;++e<t;)for(var a=this[e],r=a.length-1,o=a[r],n;0<=--r;)(n=a[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},Dn.sort=function(e){e=le.apply(this,arguments);for(var t=-1,a=this.length;++t<a;)this[t].sort(e);return this.order()},Dn.each=function(e){return se(this,function(t,a,r){e.call(t,t.__data__,a,r)})},Dn.call=function(e){var t=f(arguments);return e.apply(t[0]=this,t),this},Dn.empty=function(){return!this.node()},Dn.node=function(){for(var e=0,t=this.length;e<t;e++)for(var a=this[e],r=0,o=a.length,n;r<o;r++)if(n=a[r],n)return n;return null},Dn.size=function(){var e=0;return se(this,function(){++e}),e};var Rn=[];_n.selection.enter=de,_n.selection.enter.prototype=Rn,Rn.append=Dn.append,Rn.empty=Dn.empty,Rn.node=Dn.node,Rn.call=Dn.call,Rn.size=Dn.size,Rn.select=function(e){for(var t=[],a=-1,r=this.length,o,l,s,d,c;++a<r;){s=(d=this[a]).update,t.push(o=[]),o.parentNode=d.parentNode;for(var p=-1,u=d.length;++p<u;)(c=d[p])?(o.push(s[p]=l=e.call(d.parentNode,c.__data__,p,a)),l.__data__=c.__data__):o.push(null)}return Y(t)},Rn.insert=function(e,t){return 2>arguments.length&&(t=ce(this)),Dn.insert.call(this,e,t)},_n.select=function(t){var a;return"string"==typeof t?(a=[In(t,x)],a.parentNode=x.documentElement):(a=[t],a.parentNode=e(t)),Y([a])},_n.selectAll=function(e){var t;return"string"==typeof e?(t=f(zn(e,x)),t.parentNode=x.documentElement):(t=f(e),t.parentNode=null),Y([t])},Dn.on=function(e,t,a){var r=arguments.length;if(3>r){if("string"!=typeof e){for(a in 2>r&&(t=!1),e)this.each(pe(a,e[a],t));return this}if(2>r)return(r=this.node()["__on"+e])&&r._;a=!1}return this.each(pe(e,t,a))};var Mn=_n.map({mouseenter:"mouseover",mouseleave:"mouseout"});x&&Mn.forEach(function(e){"on"+e in x&&Mn.remove(e)});var jn=0,Fn;_n.mouse=function(e){return me(e,G())};var Bn=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;_n.touch=function(e,t,a){if(3>arguments.length&&(a=t,t=G().changedTouches),t)for(var r=0,o=t.length,n;r<o;++r)if((n=t[r]).identifier===a)return me(e,n)},_n.behavior.drag=function(){function e(){this.on("mousedown.drag",i).on("touchstart.drag",n)}function t(e,t,r,i,n){return function(){function l(){var e=t(p,h),a,r;e&&(a=e[0]-x[0],r=e[1]-x[1],g|=a|r,x=e,u({type:"drag",x:e[0]+_[0],y:e[1]+_[1],dx:a,dy:r}))}function s(){t(p,h)&&(y.on(i+m,null).on(n+m,null),f(g),u({type:"dragend"}))}var d=this,c=_n.event.target.correspondingElement||_n.event.target,p=d.parentNode,u=a.of(d,arguments),g=0,h=e(),m=".drag"+(null==h?"":"-"+h),y=_n.select(r(c)).on(i+m,l).on(n+m,s),f=he(c),x=t(p,h),_;o?(_=o.apply(d,arguments),_=[_.x-x[0],_.y-x[1]]):_=[0,0],u({type:"dragstart"})}}var a=q(e,"drag","dragstart","dragend"),o=null,i=t(F,_n.mouse,r,"mousemove","mouseup"),n=t(ye,_n.touch,z,"touchmove","touchend");return e.origin=function(t){return arguments.length?(o=t,e):o},_n.rebind(e,a,"on")},_n.touches=function(e,t){return 2>arguments.length&&(t=G().touches),t?f(t).map(function(t){var a=me(e,t);return a.identifier=t.identifier,a}):[]};var Nn=1e-6,n=Nn*Nn,i=Pe,Vn=2*i,Un=i/2,Hn=i/180,Gn=180/i,qn=c,Yn=2,Wn=4;_n.interpolateZoom=function(e,t){var a=e[0],r=e[1],o=e[2],l=t[0],s=t[1],d=t[2],c=l-a,p=s-r,u=c*c+p*p,g,h;if(u<n)h=P(d/o)/qn,g=function(e){return[a+e*c,r+e*p,o*m(qn*e*h)]};else{var y=N(u),f=(d*d-o*o+Wn*u)/(2*o*Yn*y),x=(d*d-o*o-Wn*u)/(2*d*Yn*y),_=P(N(f*f+1)-f),b=P(N(x*x+1)-x);h=(b-_)/qn,g=function(e){var t=e*h,i=ke(_),n=o/(Yn*y)*(i*we(qn*t+_)-ve(_));return[a+n*c,r+n*p,o*i/ke(qn*t+_)]}}return g.duration=1e3*h,g},_n.behavior.zoom=function(){function e(e){e.on("mousedown.zoom",h).on(Kn+".zoom",y).on("dblclick.zoom",f).on("touchstart.zoom",m)}function a(e){return[(e[0]-b.x)/b.k,(e[1]-b.y)/b.k]}function o(e){return[e[0]*b.k+b.x,e[1]*b.k+b.y]}function i(e){b.k=va(k[0],ea(k[1],e))}function s(e,t){t=o(t),b.x+=e[0]-t[0],b.y+=e[1]-t[1]}function d(t,a,r,o){t.__chart__={x:b.x,y:b.y,k:b.k},i(ya(2,o)),s(C=a,r),t=_n.select(t),0<w&&(t=t.transition().duration(w)),t.call(e.event)}function c(){t&&t.domain(D.range().map(function(e){return(e-b.x)/b.k}).map(D.invert)),l&&l.domain(n.range().map(function(e){return(e-b.y)/b.k}).map(n.invert))}function p(e){T++||e({type:"zoomstart"})}function u(e){c(),e({type:"zoom",scale:b.k,translate:[b.x,b.y]})}function g(e){--T||(e({type:"zoomend"}),C=null)}function h(){function e(){n.on("mousemove.zoom",null).on("mouseup.zoom",null),d(i),g(o)}var t=this,o=A.of(t,arguments),i=0,n=_n.select(r(t)).on("mousemove.zoom",function(){i=1,s(_n.mouse(t),l),u(o)}).on("mouseup.zoom",e),l=a(_n.mouse(t)),d=he(t);Bs.call(t),p(o)}function m(){function e(){var e=_n.touches(l);return S=b.k,e.forEach(function(e){e.identifier in y&&(y[e.identifier]=a(e))}),e}function t(){var t=_n.event.target;_n.select(t).on(_,r).on(v,o),k.push(t);for(var a=_n.event.changedTouches,s=0,c=a.length;s<c;++s)y[a[s].identifier]=null;var n=e(),u=Date.now();if(1===n.length){if(500>u-z){var g=n[0];d(l,g,y[g.identifier],ba(P(b.k)/E)+1),H()}z=u}else if(1<n.length){var g=n[0],h=n[1],m=g[0]-h[0],x=g[1]-h[1];f=m*m+x*x}}function r(){var e=_n.touches(l),t,a,r,o;Bs.call(l);for(var d=0,p=e.length;d<p;++d,o=null)if(r=e[d],o=y[r.identifier]){if(a)break;t=r,a=o}if(o){var n=(n=r[0]-t[0])*n+(n=r[1]-t[1])*n,g=f&&N(n/f);t=[(t[0]+r[0])/2,(t[1]+r[1])/2],a=[(a[0]+o[0])/2,(a[1]+o[1])/2],i(g*S)}z=null,s(t,a),u(c)}function o(){if(_n.event.touches.length){for(var t=_n.event.changedTouches,a=0,r=t.length;a<r;++a)delete y[t[a].identifier];for(var o in y)return void e()}_n.selectAll(k).on(x,null),w.on("mousedown.zoom",h).on("touchstart.zoom",m),T(),g(c)}var l=this,c=A.of(l,arguments),y={},f=0,x=".zoom-"+_n.event.changedTouches[0].identifier,_="touchmove"+x,v="touchend"+x,k=[],w=_n.select(l),T=he(l),S;t(),p(c),w.on("mousedown.zoom",null).on("touchstart.zoom",t)}function y(){var e=A.of(this,arguments);I?clearTimeout(I):(Bs.call(this),S=a(C=L||_n.mouse(this)),p(e)),I=setTimeout(function(){I=null,g(e)},50),H(),i(ya(2,.002*Zn())*b.k),s(C,S),u(e)}function f(){var e=_n.mouse(this),t=P(b.k)/E;d(this,e,a(e),_n.event.shiftKey?M(t)-1:ba(t)+1)}var b={x:0,y:0,k:1},v=[960,500],k=Xn,w=250,T=0,A=q(e,"zoomstart","zoom","zoomend"),S,C,L,I,z,D,t,n,l;return Kn||(Kn="onwheel"in x?(Zn=function(){return-_n.event.deltaY*(_n.event.deltaMode?120:1)},"wheel"):"onmousewheel"in x?(Zn=function(){return _n.event.wheelDelta},"mousewheel"):(Zn=function(){return-_n.event.detail},"MozMousePixelScroll")),e.event=function(e){e.each(function(){var e=A.of(this,arguments),t=b;Us?_n.select(this).transition().each("start.zoom",function(){b=this.__chart__||{x:0,y:0,k:1},p(e)}).tween("zoom:zoom",function(){var a=v[0],r=v[1],o=C?C[0]:a/2,n=C?C[1]:r/2,s=_n.interpolateZoom([(o-b.x)/b.k,(n-b.y)/b.k,a/b.k],[(o-t.x)/t.k,(n-t.y)/t.k,a/t.k]);return function(r){var t=s(r),i=a/t[2];this.__chart__=b={x:o-t[0]*i,y:n-t[1]*i,k:i},u(e)}}).each("interrupt.zoom",function(){g(e)}).each("end.zoom",function(){g(e)}):(this.__chart__=b,p(e),u(e),g(e))})},e.translate=function(t){return arguments.length?(b={x:+t[0],y:+t[1],k:b.k},c(),e):[b.x,b.y]},e.scale=function(t){return arguments.length?(b={x:b.x,y:b.y,k:null},i(+t),c(),e):b.k},e.scaleExtent=function(t){return arguments.length?(k=null==t?Xn:[+t[0],+t[1]],e):k},e.center=function(t){return arguments.length?(L=t&&[+t[0],+t[1]],e):L},e.size=function(t){return arguments.length?(v=t&&[+t[0],+t[1]],e):v},e.duration=function(t){return arguments.length?(w=+t,e):w},e.x=function(a){return arguments.length?(t=a,D=a.copy(),b={x:0,y:0,k:1},e):t},e.y=function(t){return arguments.length?(l=t,n=t.copy(),b={x:0,y:0,k:1},e):l},_n.rebind(e,A,"on")};var Xn=[0,1/0],Zn,Kn;_n.color=Ae,Ae.prototype.toString=function(){return this.rgb()+""},_n.hsl=Se;var Jn=Se.prototype=new Ae;Jn.brighter=function(e){return e=ya(.7,arguments.length?e:1),new Se(this.h,this.s,this.l/e)},Jn.darker=function(e){return e=ya(.7,arguments.length?e:1),new Se(this.h,this.s,e*this.l)},Jn.rgb=function(){return Ce(this.h,this.s,this.l)},_n.hcl=Le;var Qn=Le.prototype=new Ae;Qn.brighter=function(e){return new Le(this.h,this.c,ea(100,this.l+$n*(arguments.length?e:1)))},Qn.darker=function(e){return new Le(this.h,this.c,va(0,this.l-$n*(arguments.length?e:1)))},Qn.rgb=function(){return Ee(this.h,this.c,this.l).rgb()},_n.lab=Ie;var $n=18,el=.95047,tl=1.08883,al=Ie.prototype=new Ae;al.brighter=function(e){return new Ie(ea(100,this.l+18*(arguments.length?e:1)),this.a,this.b)},al.darker=function(e){return new Ie(va(0,this.l-18*(arguments.length?e:1)),this.a,this.b)},al.rgb=function(){return ze(this.l,this.a,this.b)},_n.rgb=Fe;var rl=Fe.prototype=new Ae;rl.brighter=function(e){e=ya(.7,arguments.length?e:1);var t=this.r,a=this.g,o=this.b;return t||a||o?(t&&30>t&&(t=30),a&&30>a&&(a=30),o&&30>o&&(o=30),new Fe(ea(255,t/e),ea(255,a/e),ea(255,o/e))):new Fe(30,30,30)},rl.darker=function(e){return e=ya(.7,arguments.length?e:1),new Fe(e*this.r,e*this.g,e*this.b)},rl.hsl=function(){return He(this.r,this.g,this.b)},rl.toString=function(){return"#"+Ve(this.r)+Ve(this.g)+Ve(this.b)};var ol=_n.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ol.forEach(function(e,t){ol.set(e,Be(t))}),_n.functor=We,_n.xhr=Xe(z),_n.dsv=function(e,t){function a(e,a,i){3>arguments.length&&(i=a,a=null);var n=Ze(e,t,null==a?r:o(a),i);return n.row=function(e){return arguments.length?n.response(null==(a=e)?r:o(e)):a},n}function r(e){return a.parse(e.responseText)}function o(e){return function(t){return a.parse(t.responseText,e)}}function i(t){return t.map(n).join(e)}function n(e){return l.test(e)?"\""+e.replace(/\"/g,"\"\"")+"\"":e}var l=new RegExp("[\""+e+"\n]"),s=e.charCodeAt(0);return a.parse=function(e,t){var r;return a.parseRows(e,function(e,o){if(r)return r(e,o-1);var n=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,a){return t(n(e),a)}:n})},a.parseRows=function(e,r){function o(){if(u>=p)return d;if(h)return h=!1,l;var t=u;if(34===e.charCodeAt(t)){for(var a=t;a++<p;)if(34===e.charCodeAt(a)){if(34!==e.charCodeAt(a+1))break;++a}u=a+2;var r=e.charCodeAt(a+1);return 13===r?(h=!0,10===e.charCodeAt(a+2)&&++u):10===r&&(h=!0),e.slice(t+1,a).replace(/""/g,"\"")}for(;u<p;){var r=e.charCodeAt(u++),o=1;if(10===r)h=!0;else if(13===r)h=!0,10===e.charCodeAt(u)&&(++u,++o);else if(r!==s)continue;return e.slice(t,u-o)}return e.slice(t)}for(var l={},d={},c=[],p=e.length,u=0,i=0,g,h;(g=o())!==d;){for(var m=[];g!==l&&g!==d;)m.push(g),g=o();r&&null==(m=r(m,i++))||c.push(m)}return c},a.format=function(t){if(Array.isArray(t[0]))return a.formatRows(t);var r=new C,o=[];return t.forEach(function(e){for(var t in e)r.has(t)||o.push(r.add(t))}),[o.map(n).join(e)].concat(t.map(function(t){return o.map(function(e){return n(t[e])}).join(e)})).join("\n")},a.formatRows=function(e){return e.map(i).join("\n")},a},_n.csv=_n.dsv(",","text/csv"),_n.tsv=_n.dsv("\t","text/tab-separated-values");var il=this[j(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)},nl,ll,sl,dl;_n.timer=function(){Qe.apply(this,arguments)},_n.timer.flush=function(){et(),tt()},_n.round=function(e,t){return t?V(e*(t=ya(10,t)))/t:V(e)};var cl=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"].map(function(e,t){var a=ya(10,3*Sn(8-t));return{scale:8<t?function(e){return e/a}:function(e){return e*a},symbol:e}});_n.formatPrefix=function(e,t){var a=0;return(e=+e)&&(0>e&&(e*=-1),t&&(e=_n.round(e,at(e,t))),a=1+ba(1e-12+P(e)/I),a=va(-24,ea(24,3*ba((a-1)/3)))),cl[8+a/3]};var pl=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ul=_n.map({b:function(e){return e.toString(2)},c:function(e){return D(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=_n.round(e,at(e,t))).toFixed(va(0,ea(20,at(e*(1+1e-15),t))))}}),hl=_n.time={},ml=Date;it.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){yl.setUTCDate.apply(this._,arguments)},setDay:function(){yl.setUTCDay.apply(this._,arguments)},setFullYear:function(){yl.setUTCFullYear.apply(this._,arguments)},setHours:function(){yl.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){yl.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){yl.setUTCMinutes.apply(this._,arguments)},setMonth:function(){yl.setUTCMonth.apply(this._,arguments)},setSeconds:function(){yl.setUTCSeconds.apply(this._,arguments)},setTime:function(){yl.setTime.apply(this._,arguments)}};var yl=Date.prototype;hl.year=nt(function(e){return e=hl.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),hl.years=hl.year.range,hl.years.utc=hl.year.utc.range,hl.day=nt(function(e){var t=new ml(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),hl.days=hl.day.range,hl.days.utc=hl.day.utc.range,hl.dayOfYear=function(e){var t=hl.year(e);return ba((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var a=hl[e]=nt(function(e){return(e=hl.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*ba(t))},function(e){var a=hl.year(e).getDay();return ba((hl.dayOfYear(e)+(a+t)%7)/7)-(a!==t)});hl[e+"s"]=a.range,hl[e+"s"].utc=a.utc.range,hl[e+"OfYear"]=function(e){var a=hl.year(e).getDay();return ba((hl.dayOfYear(e)+(a+t)%7)/7)}}),hl.week=hl.sunday,hl.weeks=hl.sunday.range,hl.weeks.utc=hl.sunday.utc.range,hl.weekOfYear=hl.sundayOfYear;var fl={"-":"",_:" ",0:"0"},xl=/^\s*\d+/,_l=/^%/;_n.locale=function(e){return{numberFormat:rt(e),timeFormat:st(e)}};var bl=_n.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});_n.format=bl.numberFormat,_n.geo={},Et.prototype={s:0,t:0,add:function(e){It(e,this.t,vl),It(vl.s,this.s,this),this.s?this.t+=vl.t:this.s=vl.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var vl=new Et;_n.geo.stream=function(e,t){e&&kl.hasOwnProperty(e.type)?kl[e.type](e,t):zt(e,t)};var kl={Feature:function(e,t){zt(e.geometry,t)},FeatureCollection:function(e,t){for(var a=e.features,r=-1,o=a.length;++r<o;)zt(a[r].geometry,t)}},wl={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var a=e.coordinates,r=-1,o=a.length;++r<o;)e=a[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Pt(e.coordinates,t,0)},MultiLineString:function(e,t){for(var a=e.coordinates,r=-1,o=a.length;++r<o;)Pt(a[r],t,0)},Polygon:function(e,t){Dt(e.coordinates,t)},MultiPolygon:function(e,t){for(var a=e.coordinates,r=-1,o=a.length;++r<o;)Dt(a[r],t)},GeometryCollection:function(e,t){for(var a=e.geometries,r=-1,o=a.length;++r<o;)zt(a[r],t)}};_n.geo.area=function(e){return Sl=0,_n.geo.stream(e,Al),Sl};var Tl=new Et,Al={sphere:function(){Sl+=4*i},point:F,lineStart:F,lineEnd:F,polygonStart:function(){Tl.reset(),Al.lineStart=Ot},polygonEnd:function(){var e=2*Tl;Sl+=0>e?4*i+e:e,Al.lineStart=Al.lineEnd=Al.point=F}},Sl;_n.geo.bounds=function(){function e(e,t){v.push(k=[u=e,h=e]),t<g&&(g=t),t>m&&(m=t)}function t(t,a){var r=Rt([t*Hn,a*Hn]);if(x){var o=jt(x,r),i=[o[1],-o[0],0],n=jt(i,o);Nt(n),n=Vt(n);var d=t-y,c=0<d?1:-1,s=n[0]*Gn*c,p=180<Sn(d);if(p^(c*y<s&&s<c*t)){var f=n[1]*Gn;f>m&&(m=f)}else if(s=(s+360)%360-180,p^(c*y<s&&s<c*t)){var f=-n[1]*Gn;f<g&&(g=f)}else a<g&&(g=a),a>m&&(m=a);p?t<y?l(u,t)>l(u,h)&&(h=t):l(t,h)>l(u,h)&&(u=t):h>=u?(t<u&&(u=t),t>h&&(h=t)):t>y?l(u,t)>l(u,h)&&(h=t):l(t,h)>l(u,h)&&(u=t)}else e(t,a);x=r,y=t}function a(){c.point=t}function r(){k[0]=u,k[1]=h,c.point=e,x=null}function o(e,a){if(x){var r=e-y;_+=180<Sn(r)?r+(0<r?360:-360):r}else p=e,f=a;Al.point(e,a),t(e,a)}function i(){Al.lineStart()}function n(){o(p,f),Al.lineEnd(),Sn(_)>Nn&&(u=-(h=180)),k[0]=u,k[1]=h,x=null}function l(e,t){return 0>(t-=e)?t+360:t}function s(e,t){return e[0]-t[0]}function d(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var c={point:e,lineStart:a,lineEnd:r,polygonStart:function(){c.point=o,c.lineStart=i,c.lineEnd=n,_=0,Al.polygonStart()},polygonEnd:function(){Al.polygonEnd(),c.point=e,c.lineStart=a,c.lineEnd=r,0>Tl?(u=-(h=180),g=-(m=90)):_>Nn?m=90:_<-Nn&&(g=-90),k[0]=u,k[1]=h}},u,g,h,m,y,p,f,x,_,v,k;return function(e){m=h=-(u=g=1/0),v=[],_n.geo.stream(e,c);var t=v.length;if(t){v.sort(s);for(var r=1,o=v[0],p=[o],y;r<t;++r)y=v[r],d(y[0],o)||d(y[1],o)?(l(o[0],y[1])>l(o[0],o[1])&&(o[1]=y[1]),l(y[0],o[1])>l(o[0],o[1])&&(o[0]=y[0])):p.push(o=y);for(var f=-Infinity,t=p.length-1,r=0,o=p[t],x,y;r<=t;o=y,++r)y=p[r],(x=l(o[1],y[0]))>f&&(f=x,u=y[0],h=o[1])}return v=k=null,u===1/0||g===1/0?[[NaN,NaN],[NaN,NaN]]:[[u,g],[h,m]]}}(),_n.geo.centroid=function(e){El=Il=zl=Pl=Dl=Ol=Rl=Ml=jl=Fl=Bl=0,_n.geo.stream(e,Cl);var t=jl,a=Fl,r=Bl,o=t*t+a*a+r*r;return o<n&&(t=Ol,a=Rl,r=Ml,Il<Nn&&(t=zl,a=Pl,r=Dl),o=t*t+a*a+r*r,o<n)?[NaN,NaN]:[L(a,t)*Gn,be(r/N(o))*Gn]};var Cl={sphere:F,point:Ht,lineStart:qt,lineEnd:Yt,polygonStart:function(){Cl.lineStart=Wt},polygonEnd:function(){Cl.lineStart=qt}},Ll=$t(Zt,function(e){var t=NaN,a=NaN,r=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(n,l){var s=0<n?i:-i,d=Sn(n-t);Sn(d-i)<Nn?(e.point(t,a=0<(a+l)/2?Un:-Un),e.point(r,a),e.lineEnd(),e.lineStart(),e.point(s,a),e.point(n,a),o=0):r!==s&&d>=i&&(Sn(t-r)<Nn&&(t-=r*Nn),Sn(n-s)<Nn&&(n-=s*Nn),a=oa(t,a,n,l),e.point(r,a),e.lineEnd(),e.lineStart(),e.point(s,a),o=0),e.point(t=n,a=l),r=s},lineEnd:function(){e.lineEnd(),t=a=NaN},clean:function(){return 2-o}}},function(e,t,a,r){var o;if(null==e)o=a*Un,r.point(-i,o),r.point(0,o),r.point(i,o),r.point(i,0),r.point(i,-o),r.point(0,-o),r.point(-i,-o),r.point(-i,0),r.point(-i,o);else if(Sn(e[0]-t[0])>Nn){var n=e[0]<t[0]?i:-i;o=a*n/2,r.point(-n,o),r.point(0,o),r.point(n,o)}else r.point(t[0],t[1])},[-i,-i/2]),El,Il,zl,Pl,Dl,Ol,Rl,Ml,jl,Fl,Bl;_n.geo.clipExtent=function(){var e={stream:function(e){return i&&(i.valid=!1),i=n(e),i.valid=!0,i},extent:function(l){return arguments.length?(n=sa(t=+l[0][0],a=+l[0][1],r=+l[1][0],o=+l[1][1]),i&&(i.valid=!1,i=null),e):[[t,a],[r,o]]}},t,a,r,o,i,n;return e.extent([[0,0],[960,500]])},(_n.geo.conicEqualArea=function(){return da(ca)}).raw=ca,_n.geo.albers=function(){return _n.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},_n.geo.albersUsa=function(){function e(e){var t=e[0],a=e[1];return n=null,(l(t,a),n)||(s(t,a),n)||d(t,a),n}var a=_n.geo.albers(),r=_n.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=_n.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(e,t){n=[e,t]}},n,l,s,d;return e.invert=function(e){var i=a.scale(),n=a.translate(),t=(e[0]-n[0])/i,l=(e[1]-n[1])/i;return(.12<=l&&.234>l&&-.425<=t&&-.214>t?r:.166<=l&&.234>l&&-.214<=t&&-.115>t?o:a).invert(e)},e.stream=function(e){var t=a.stream(e),i=r.stream(e),n=o.stream(e);return{point:function(e,a){t.point(e,a),i.point(e,a),n.point(e,a)},sphere:function(){t.sphere(),i.sphere(),n.sphere()},lineStart:function(){t.lineStart(),i.lineStart(),n.lineStart()},lineEnd:function(){t.lineEnd(),i.lineEnd(),n.lineEnd()},polygonStart:function(){t.polygonStart(),i.polygonStart(),n.polygonStart()},polygonEnd:function(){t.polygonEnd(),i.polygonEnd(),n.polygonEnd()}}},e.precision=function(t){return arguments.length?(a.precision(t),r.precision(t),o.precision(t),e):a.precision()},e.scale=function(t){return arguments.length?(a.scale(t),r.scale(.35*t),o.scale(t),e.translate(a.translate())):a.scale()},e.translate=function(t){if(!arguments.length)return a.translate();var n=a.scale(),c=+t[0],p=+t[1];return l=a.translate(t).clipExtent([[c-.455*n,p-.238*n],[c+.455*n,p+.238*n]]).stream(i).point,s=r.translate([c-.307*n,p+.201*n]).clipExtent([[c-.425*n+Nn,p+.12*n+Nn],[c-.214*n-Nn,p+.234*n-Nn]]).stream(i).point,d=o.translate([c-.205*n,p+.212*n]).clipExtent([[c-.214*n+Nn,p+.166*n+Nn],[c-.115*n-Nn,p+.234*n-Nn]]).stream(i).point,e},e.scale(1070)};var Nl={point:F,lineStart:F,lineEnd:F,polygonStart:function(){Gl=0,Nl.lineStart=pa},polygonEnd:function(){Nl.lineStart=Nl.lineEnd=Nl.point=F,Hl+=Sn(Gl/2)}},Vl={point:ua,lineStart:F,lineEnd:F,polygonStart:F,polygonEnd:F},Ul={point:ma,lineStart:wa,lineEnd:Ta,polygonStart:function(){Ul.lineStart=Aa},polygonEnd:function(){Ul.point=ma,Ul.lineStart=wa,Ul.lineEnd=Ta}},Hl,Gl,ql,Yl,Wl,Xl;_n.geo.path=function(){function e(e){return e&&("function"==typeof a&&n.pointRadius(+a.apply(this,arguments)),(!l||!l.valid)&&(l=i(n)),_n.geo.stream(e,l)),n.result()}function t(){return l=null,e}var a=4.5,r,o,i,n,l;return e.area=function(e){return Hl=0,_n.geo.stream(e,i(Nl)),Hl},e.centroid=function(e){return zl=Pl=Dl=Ol=Rl=Ml=jl=Fl=Bl=0,_n.geo.stream(e,i(Ul)),Bl?[jl/Bl,Fl/Bl]:Ml?[Ol/Ml,Rl/Ml]:Dl?[zl/Dl,Pl/Dl]:[NaN,NaN]},e.bounds=function(e){return Wl=Xl=-(ql=Yl=1/0),_n.geo.stream(e,i(Vl)),[[ql,Yl],[Wl,Xl]]},e.projection=function(e){return arguments.length?(i=(r=e)?e.stream||La(e):z,t()):r},e.context=function(e){return arguments.length?(n=null==(o=e)?new ga:new Sa(e),"function"!=typeof a&&n.pointRadius(a),t()):o},e.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(n.pointRadius(+t),+t),e):a},e.projection(_n.geo.albersUsa()).context(null)},_n.geo.transform=function(e){return{stream:function(t){var a=new Ea(t);for(var r in e)a[r]=e[r];return a}}},Ea.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},_n.geo.projection=za,_n.geo.projectionMutator=Pa,(_n.geo.equirectangular=function(){return za(Oa)}).raw=Oa.invert=Oa,_n.geo.rotation=function(e){function t(t){return t=e(t[0]*Hn,t[1]*Hn),t[0]*=Gn,t[1]*=Gn,t}return e=Ma(e[0]%360*Hn,e[1]*Hn,2<e.length?e[2]*Hn:0),t.invert=function(t){return t=e.invert(t[0]*Hn,t[1]*Hn),t[0]*=Gn,t[1]*=Gn,t},t},Ra.invert=Oa,_n.geo.circle=function(){function e(){var e="function"==typeof t?t.apply(this,arguments):t,a=Ma(-e[0]*Hn,-e[1]*Hn,0).invert,r=[];return o(null,null,1,{point:function(e,t){r.push(e=a(e,t)),e[0]*=Gn,e[1]*=Gn}}),{type:"Polygon",coordinates:[r]}}var t=[0,0],a=6,r,o;return e.origin=function(a){return arguments.length?(t=a,e):t},e.angle=function(t){return arguments.length?(o=Na((r=+t)*Hn,a*Hn),e):r},e.precision=function(t){return arguments.length?(o=Na(r*Hn,(a=+t)*Hn),e):a},e.angle(90)},_n.geo.distance=function(e,a){var r=(a[0]-e[0])*Hn,o=e[1]*Hn,i=a[1]*Hn,n=De(r),l=R(r),s=De(o),d=R(o),c=De(i),p=R(i),u;return L(N((u=p*n)*u+(u=d*c-s*p*l)*u),s*c+d*p*l)},_n.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return _n.range(M(c/o)*o,d,o).map(b).concat(_n.range(M(h/i)*i,g,i).map(v)).concat(_n.range(M(s/a)*a,l,a).filter(function(e){return Sn(e%o)>Nn}).map(m)).concat(_n.range(M(u/r)*r,p,r).filter(function(e){return Sn(e%i)>Nn}).map(f))}var a=10,r=a,o=90,i=360,n=2.5,l,s,d,c,p,u,g,h,m,f,b,v;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[b(c).concat(v(g).slice(1),b(d).reverse().slice(1),v(h).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(c=+t[0][0],d=+t[1][0],h=+t[0][1],g=+t[1][1],c>d&&(t=c,c=d,d=t),h>g&&(t=h,h=g,g=t),e.precision(n)):[[c,h],[d,g]]},e.minorExtent=function(t){return arguments.length?(s=+t[0][0],l=+t[1][0],u=+t[0][1],p=+t[1][1],s>l&&(t=s,s=l,l=t),u>p&&(t=u,u=p,p=t),e.precision(n)):[[s,u],[l,p]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(o=+t[0],i=+t[1],e):[o,i]},e.minorStep=function(t){return arguments.length?(a=+t[0],r=+t[1],e):[a,r]},e.precision=function(t){return arguments.length?(n=+t,m=Ua(u,p,90),f=Ha(s,l,n),b=Ua(h,g,90),v=Ha(c,d,n),e):n},e.majorExtent([[-180,-90+Nn],[180,90-Nn]]).minorExtent([[-180,-80-Nn],[180,80+Nn]])},_n.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[r||t.apply(this,arguments),o||a.apply(this,arguments)]}}var t=Ga,a=qa,r,o;return e.distance=function(){return _n.geo.distance(r||t.apply(this,arguments),o||a.apply(this,arguments))},e.source=function(a){return arguments.length?(t=a,r="function"==typeof a?null:a,e):t},e.target=function(t){return arguments.length?(a=t,o="function"==typeof t?null:t,e):a},e.precision=function(){return arguments.length?e:0},e},_n.geo.interpolate=function(e,t){return Ya(e[0]*Hn,e[1]*Hn,t[0]*Hn,t[1]*Hn)},_n.geo.length=function(e){return Jl=0,_n.geo.stream(e,Zl),Jl};var Zl={sphere:F,point:F,lineStart:function(){function e(e,i){var n=De(i*=Hn),l=R(i),s=Sn((e*=Hn)-a),d=R(s);Jl+=L(N((s=l*De(s))*s+(s=o*n-r*l*d)*s),r*n+o*l*d),a=e,r=n,o=l}var a,r,o;Zl.point=function(t,i){a=t*Hn,r=De(i*=Hn),o=R(i),Zl.point=e},Zl.lineEnd=function(){Zl.point=Zl.lineEnd=F}},lineEnd:F,polygonStart:F,polygonEnd:F},Kl=Wa(function(e){return N(2/(1+e))},function(e){return 2*o(e/2)}),Jl;(_n.geo.azimuthalEqualArea=function(){return za(Kl)}).raw=Kl;var Ql=Wa(function(e){var t=d(e);return t&&t/De(t)},z);(_n.geo.azimuthalEquidistant=function(){return za(Ql)}).raw=Ql,(_n.geo.conicConformal=function(){return da(Xa)}).raw=Xa,(_n.geo.conicEquidistant=function(){return da(Za)}).raw=Za;var $l=Wa(function(e){return 1/e},Math.atan);(_n.geo.gnomonic=function(){return za($l)}).raw=$l,Ka.invert=function(e,t){return[e,2*xa(m(t))-Un]},(_n.geo.mercator=function(){return Ja(Ka)}).raw=Ka;var es=Wa(function(){return 1},Math.asin);(_n.geo.orthographic=function(){return za(es)}).raw=es;var ts=Wa(function(e){return 1/(1+e)},function(e){return 2*xa(e)});(_n.geo.stereographic=function(){return za(ts)}).raw=ts,Qa.invert=function(e,t){return[-t,2*xa(m(e))-Un]},(_n.geo.transverseMercator=function(){var e=Ja(Qa),t=e.center,a=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?a([e[0],e[1],2<e.length?e[2]+90:90]):(e=a(),[e[0],e[1],e[2]-90])},a([0,0,90])}).raw=Qa,_n.geom={},_n.geom.hull=function(e){function t(e){if(3>e.length)return[];var t=We(a),o=We(r),l=e.length,n=[],s=[],d;for(d=0;d<l;d++)n.push([+t.call(this,e[d],d),+o.call(this,e[d],d),d]);for(n.sort(ar),d=0;d<l;d++)s.push([n[d][0],-n[d][1]]);var c=tr(n),p=tr(s),u=p[0]===c[0],g=p[p.length-1]===c[c.length-1],h=[];for(d=c.length-1;0<=d;--d)h.push(e[n[c[d]][2]]);for(d=+u;d<p.length-g;++d)h.push(e[n[p[d]][2]]);return h}var a=$a,r=er;return arguments.length?t(e):(t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(r=e,t):r},t)},_n.geom.polygon=function(e){return En(e,as),e};var as=_n.geom.polygon.prototype=[];as.area=function(){for(var e=-1,t=this.length,r=this[t-1],o=0,n;++e<t;)n=r,r=this[e],o+=n[1]*r[0]-n[0]*r[1];return .5*o},as.centroid=function(e){var t=-1,r=this.length,o=0,n=0,l=this[r-1],s,d;for(arguments.length||(e=-1/(6*this.area()));++t<r;)s=l,l=this[t],d=s[0]*l[1]-l[0]*s[1],o+=(s[0]+l[0])*d,n+=(s[1]+l[1])*d;return[o*e,n*e]},as.clip=function(e){for(var t=ir(e),r=-1,o=this.length-ir(this),n=this[o-1],l,s,p,u,g,h;++r<o;){for(l=e.slice(),e.length=0,u=this[r],g=l[(p=l.length-t)-1],s=-1;++s<p;)h=l[s],rr(h,n,u)?(!rr(g,n,u)&&e.push(or(g,h,n,u)),e.push(h)):rr(g,n,u)&&e.push(or(g,h,n,u)),g=h;t&&e.push(e[0]),n=u}return e};var rs=[],os=[],is,ns,ls,ss,ds;gr.prototype.prepare=function(){for(var e=this.edges,t=e.length,a;t--;)a=e[t].edge,a.b&&a.a||e.splice(t,1);return e.sort(mr),e.length},Ar.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Sr.prototype={insert:function(e,t){var a,r,o;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;a=e}else this._?(e=Ir(this._),t.P=null,t.N=e,e.P=e.L=t,a=e):(t.P=t.N=null,this._=t,a=null);for(t.L=t.R=null,t.U=a,t.C=!0,e=t;a&&a.C;)r=a.U,a===r.L?(o=r.R,o&&o.C?(a.C=o.C=!1,r.C=!0,e=r):(e===a.R&&(Lr(this,a),e=a,a=e.U),a.C=!1,r.C=!0,Er(this,r))):(o=r.L,o&&o.C?(a.C=o.C=!1,r.C=!0,e=r):(e===a.L&&(Er(this,a),e=a,a=e.U),a.C=!1,r.C=!0,Lr(this,r))),a=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,a=e.L,r=e.R,o,i,n;if(i=a?r?Ir(r):a:r,t?t.L===e?t.L=i:t.R=i:this._=i,a&&r?(n=i.C,i.C=e.C,i.L=a,a.U=i,i===r?(i.U=t,t=i,e=i.R):(t=i.U,i.U=e.U,e=i.R,t.L=e,i.R=r,r.U=i)):(n=e.C,e=i),e&&(e.U=t),!n){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===t.L){if(o=t.R,o.C&&(o.C=!1,t.C=!0,Lr(this,t),o=t.R),o.L&&o.L.C||o.R&&o.R.C){o.R&&o.R.C||(o.L.C=!1,o.C=!0,Er(this,o),o=t.R),o.C=t.C,t.C=o.R.C=!1,Lr(this,t),e=this._;break}}else if(o=t.L,o.C&&(o.C=!1,t.C=!0,Er(this,t),o=t.L),o.L&&o.L.C||o.R&&o.R.C){o.L&&o.L.C||(o.R.C=!1,o.C=!0,Lr(this,o),o=t.L),o.C=t.C,t.C=o.L.C=!1,Er(this,t),e=this._;break}o.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}},_n.geom.voronoi=function(e){function t(e){var t=Array(e.length),r=i[0][0],o=i[0][1],n=i[1][0],l=i[1][1];return zr(a(e),i).cells.forEach(function(a,s){var i=a.edges,d=a.site,c=t[s]=i.length?i.map(function(t){var e=t.start();return[e.x,e.y]}):d.x>=r&&d.x<=n&&d.y>=o&&d.y<=l?[[r,l],[n,l],[n,o],[r,o]]:[];c.point=e[s]}),t}function a(e){return e.map(function(e,t){return{x:V(n(e,t)/Nn)*Nn,y:V(l(e,t)/Nn)*Nn,i:t}})}var r=$a,o=er,n=r,l=o,i=cs;return e?t(e):(t.links=function(e){return zr(a(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return zr(a(e)).cells.forEach(function(a,r){for(var o=a.site,i=a.edges.sort(mr),n=-1,l=i.length,s=i[l-1].edge,d=s.l===o?s.r:s.l,c,p;++n<l;)c=s,p=d,s=i[n].edge,d=s.l===o?s.r:s.l,r<p.i&&r<d.i&&0>Dr(o,p,d)&&t.push([e[r],e[p.i],e[d.i]])}),t},t.x=function(e){return arguments.length?(n=We(r=e),t):r},t.y=function(e){return arguments.length?(l=We(o=e),t):o},t.clipExtent=function(e){return arguments.length?(i=null==e?cs:e,t):i===cs?null:i},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):i===cs?null:i&&i[1]},t)};var cs=[[-1e6,-1e6],[1e6,1e6]];_n.geom.delaunay=function(e){return _n.geom.voronoi().triangles(e)},_n.geom.quadtree=function(e,t,a,r,o){function i(e){function p(e,t,a,r,o,i,n,l){if(!(isNaN(a)||isNaN(r)))if(e.leaf){var s=e.x,d=e.y;if(null==s)e.x=a,e.y=r,e.point=t;else if(.01>Sn(s-a)+Sn(d-r))u(e,t,a,r,o,i,n,l);else{var c=e.point;e.x=e.y=e.point=null,u(e,c,s,d,o,i,n,l),u(e,t,a,r,o,i,n,l)}}else u(e,t,a,r,o,i,n,l)}function u(e,t,a,r,o,l,s,d){var c=.5*(o+s),u=.5*(l+d),g=a>=c,h=r>=u,m=h<<1|g;e.leaf=!1,e=e.nodes[m]||(e.nodes[m]=Mr()),g?o=c:s=c,h?l=u:d=u,p(e,t,a,r,o,l,s,d)}var g=We(l),h=We(s),m,y,f,x,_,b,v,k,w;if(null!=t)b=t,v=a,k=r,w=o;else if(k=w=-(b=v=1/0),y=[],f=[],_=e.length,c)for(x=0;x<_;++x)m=e[x],m.x<b&&(b=m.x),m.y<v&&(v=m.y),m.x>k&&(k=m.x),m.y>w&&(w=m.y),y.push(m.x),f.push(m.y);else for(x=0;x<_;++x){var T=+g(m=e[x],x),A=+h(m,x);T<b&&(b=T),A<v&&(v=A),T>k&&(k=T),A>w&&(w=A),y.push(T),f.push(A)}var S=k-b,C=w-v;S>C?w=v+S:k=b+C;var L=Mr();if(L.add=function(e){p(L,e,+g(e,++x),+h(e,x),b,v,k,w)},L.visit=function(e){jr(e,L,b,v,k,w)},L.find=function(e){return Fr(L,e[0],e[1],b,v,k,w)},x=-1,null==t){for(;++x<_;)p(L,e[x],y[x],f[x],b,v,k,w);--x}else e.forEach(L.add);return y=f=e=m=null,L}var l=$a,s=er,c;return(c=arguments.length)?(l=Or,s=Rr,3===c&&(o=a,r=t,a=t=0),i(e)):(i.x=function(e){return arguments.length?(l=e,i):l},i.y=function(e){return arguments.length?(s=e,i):s},i.extent=function(e){return arguments.length?(null==e?t=a=r=o=null:(t=+e[0][0],a=+e[0][1],r=+e[1][0],o=+e[1][1]),i):null==t?null:[[t,a],[r,o]]},i.size=function(e){return arguments.length?(null==e?t=a=r=o=null:(t=a=0,r=+e[0],o=+e[1]),i):null==t?null:[r-t,o-a]},i)},_n.interpolateRgb=Br,_n.interpolateObject=Nr,_n.interpolateNumber=Vr,_n.interpolateString=Ur;var ps=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,us=new RegExp(ps.source,"g");_n.interpolate=Hr,_n.interpolators=[function(e,a){var r=typeof a;return("string"==r?ol.has(a.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(a)?Br:Ur:a instanceof Ae?Br:Array.isArray(a)?Gr:"object"==r&&isNaN(a)?Nr:Vr)(e,a)}],_n.interpolateArray=Gr;var gs=function(){return z},hs=_n.map({linear:gs,poly:function(a){return function(e){return ya(e,a)}},quad:function(){return Xr},cubic:function(){return Zr},sin:function(){return Jr},exp:function(){return Qr},circle:function(){return $r},elastic:function(e,r){var i;return 2>arguments.length&&(r=.45),arguments.length?i=r/Vn*o(1/e):(e=1,i=r/4),function(a){return 1+e*ya(2,-10*a)*De((a-i)*Vn/r)}},back:function(e){return e||(e=1.70158),function(a){return a*a*((e+1)*a-e)}},bounce:function(){return eo}}),ms=_n.map({in:z,out:Yr,"in-out":Wr,"out-in":function(e){return Wr(Yr(e))}});_n.ease=function(e){var r=e.indexOf("-"),o=0<=r?e.slice(0,r):e,i=0<=r?e.slice(r+1):"in";return o=hs.get(o)||gs,i=ms.get(i)||z,qr(i(o.apply(null,a.call(arguments,1))))},_n.interpolateHcl=function(e,t){e=_n.hcl(e),t=_n.hcl(t);var r=e.h,o=e.c,i=e.l,n=t.h-r,l=t.c-o,s=t.l-i;return isNaN(l)&&(l=0,o=isNaN(o)?t.c:o),isNaN(n)?(n=0,r=isNaN(r)?t.h:r):180<n?n-=360:-180>n&&(n+=360),function(e){return Ee(r+n*e,o+l*e,i+s*e)+""}},_n.interpolateHsl=function(e,t){e=_n.hsl(e),t=_n.hsl(t);var r=e.h,o=e.s,i=e.l,n=t.h-r,l=t.s-o,s=t.l-i;return isNaN(l)&&(l=0,o=isNaN(o)?t.s:o),isNaN(n)?(n=0,r=isNaN(r)?t.h:r):180<n?n-=360:-180>n&&(n+=360),function(e){return Ce(r+n*e,o+l*e,i+s*e)+""}},_n.interpolateLab=function(e,t){e=_n.lab(e),t=_n.lab(t);var r=e.l,o=e.a,i=e.b,n=t.l-r,l=t.a-o,s=t.b-i;return function(e){return ze(r+n*e,o+l*e,i+s*e)+""}},_n.interpolateRound=to,_n.transform=function(e){var t=x.createElementNS(_n.ns.prefix.svg,"g");return(_n.transform=function(e){if(null!=e){t.setAttribute("transform",e);var a=t.transform.baseVal.consolidate()}return new ao(a?a.matrix:ys)})(e)},ao.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ys={a:1,b:0,c:0,d:1,e:0,f:0};_n.interpolateTransform=uo,_n.layout={},_n.layout.bundle=function(){return function(e){for(var t=[],a=-1,r=e.length;++a<r;)t.push(mo(e[a]));return t}},_n.layout.chord=function(){function e(){var e={},n=[],g=_n.range(d),h=[],m,a,y,f,_;for(o=[],l=[],m=0,f=-1;++f<d;){for(a=0,_=-1;++_<d;)a+=s[f][_];n.push(a),h.push(_n.range(d)),m+=a}for(c&&g.sort(function(e,t){return c(n[e],n[t])}),p&&h.forEach(function(e,t){e.sort(function(e,a){return p(s[t][e],s[t][a])})}),m=(Vn-r*d)/m,a=0,f=-1;++f<d;){for(y=a,_=-1;++_<d;){var b=g[f],w=h[b][_],T=s[b][w],v=a,A=a+=T*m;e[b+"-"+w]={index:b,subindex:w,startAngle:v,endAngle:A,value:T}}l[b]={index:b,startAngle:y,endAngle:a,value:n[b]},a+=r}for(f=-1;++f<d;)for(_=f-1;++_<d;){var S=e[f+"-"+_],C=e[_+"-"+f];(S.value||C.value)&&o.push(S.value<C.value?{source:C,target:S}:{source:S,target:C})}u&&t()}function t(){o.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var a={},r=0,o,l,s,d,c,p,u;return a.matrix=function(e){return arguments.length?(d=(s=e)&&s.length,o=l=null,a):s},a.padding=function(e){return arguments.length?(r=e,o=l=null,a):r},a.sortGroups=function(e){return arguments.length?(c=e,o=l=null,a):c},a.sortSubgroups=function(e){return arguments.length?(p=e,o=null,a):p},a.sortChords=function(e){return arguments.length?(u=e,o&&t(),a):u},a.chords=function(){return o||e(),o},a.groups=function(){return l||e(),l},a},_n.layout.force=function(){function e(e){return function(t,a,r,o){if(t.point!==e){var i=t.cx-e.x,n=t.cy-e.y,l=o-a,s=i*i+n*n;if(l*l/_<s){if(s<h){var d=t.charge/s;e.px-=i*d,e.py-=n*d}return!0}if(t.point&&s&&s<h){var d=t.pointCharge/s;e.px-=i*d,e.py-=n*d}}return!t.charge}}function t(e){e.px=_n.event.x,e.py=_n.event.y,a.resume()}var a={},r=_n.dispatch("start","tick","end"),d=[1,1],c=.9,p=fs,u=xs,g=-30,h=_s,f=.1,_=.64,b=[],v=[],w,T,A,S,C,L;return a.tick=function(){if(.005>(A*=.99))return w=null,r.end({type:"end",alpha:A=0}),!0;var a=b.length,n=v.length,p,u,h,m,_,T,E,I,z;for(u=0;u<n;++u)h=v[u],m=h.source,_=h.target,I=_.x-m.x,z=_.y-m.y,(T=I*I+z*z)&&(T=A*C[u]*((T=N(T))-S[u])/T,I*=T,z*=T,_.x-=I*(E=m.weight+_.weight?m.weight/(m.weight+_.weight):.5),_.y-=z*E,m.x+=I*(E=1-E),m.y+=z*E);if((E=A*f)&&(I=d[0]/2,z=d[1]/2,u=-1,E))for(;++u<a;)h=b[u],h.x+=(I-h.x)*E,h.y+=(z-h.y)*E;if(g)for(ko(p=_n.geom.quadtree(b),A,L),u=-1;++u<a;)(h=b[u]).fixed||p.visit(e(h));for(u=-1;++u<a;)h=b[u],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*c,h.y-=(h.py-(h.py=h.y))*c);r.tick({type:"tick",alpha:A})},a.nodes=function(e){return arguments.length?(b=e,a):b},a.links=function(e){return arguments.length?(v=e,a):v},a.size=function(e){return arguments.length?(d=e,a):d},a.linkDistance=function(e){return arguments.length?(p="function"==typeof e?e:+e,a):p},a.distance=a.linkDistance,a.linkStrength=function(e){return arguments.length?(u="function"==typeof e?e:+e,a):u},a.friction=function(e){return arguments.length?(c=+e,a):c},a.charge=function(e){return arguments.length?(g="function"==typeof e?e:+e,a):g},a.chargeDistance=function(e){return arguments.length?(h=e*e,a):N(h)},a.gravity=function(e){return arguments.length?(f=+e,a):f},a.theta=function(e){return arguments.length?(_=e*e,a):N(_)},a.alpha=function(e){return arguments.length?(e=+e,A?0<e?A=e:(w.c=null,w.t=NaN,w=null,r.end({type:"end",alpha:A=0})):0<e&&(r.start({type:"start",alpha:A=e}),w=Qe(a.tick)),a):A},a.start=function(){function e(e,a){if(!c){for(c=Array(t),n=0;n<t;++n)c[n]=[];for(n=0;n<r;++n){var i=v[n];c[i.source.index].push(i.target),c[i.target.index].push(i.source)}}for(var o=c[s],n=-1,d=o.length,l;++n<d;)if(!isNaN(l=o[n][e]))return l;return Math.random()*a}var t=b.length,r=v.length,n=d[0],l=d[1],s,c,h;for(s=0;s<t;++s)(h=b[s]).index=s,h.weight=0;for(s=0;s<r;++s)h=v[s],"number"==typeof h.source&&(h.source=b[h.source]),"number"==typeof h.target&&(h.target=b[h.target]),++h.source.weight,++h.target.weight;for(s=0;s<t;++s)h=b[s],isNaN(h.x)&&(h.x=e("x",n)),isNaN(h.y)&&(h.y=e("y",l)),isNaN(h.px)&&(h.px=h.x),isNaN(h.py)&&(h.py=h.y);if(S=[],"function"==typeof p)for(s=0;s<r;++s)S[s]=+p.call(this,v[s],s);else for(s=0;s<r;++s)S[s]=p;if(C=[],"function"==typeof u)for(s=0;s<r;++s)C[s]=+u.call(this,v[s],s);else for(s=0;s<r;++s)C[s]=u;if(L=[],"function"==typeof g)for(s=0;s<t;++s)L[s]=+g.call(this,b[s],s);else for(s=0;s<t;++s)L[s]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return T||(T=_n.behavior.drag().origin(z).on("dragstart.force",xo).on("drag.force",t).on("dragend.force",_o)),arguments.length?void this.on("mouseover.force",bo).on("mouseout.force",vo).call(T):T},_n.rebind(a,r,"on")};var fs=20,xs=1,_s=1/0;_n.layout.hierarchy=function(){function e(o){var i=[o],l=[],s;for(o.depth=0;null!=(s=i.pop());)if(l.push(s),(c=a.call(e,s,s.depth))&&(d=c.length)){for(var d,c,p;0<=--d;)i.push(p=c[d]),p.parent=s,p.depth=s.depth+1;r&&(s.value=0),s.children=c}else r&&(s.value=+r.call(e,s,s.depth)||0),delete s.children;return Ao(o,function(e){var a,o;t&&(a=e.children)&&a.sort(t),r&&(o=e.parent)&&(o.value+=e.value)}),l}var t=Lo,a=So,r=Co;return e.sort=function(a){return arguments.length?(t=a,e):t},e.children=function(t){return arguments.length?(a=t,e):a},e.value=function(t){return arguments.length?(r=t,e):r},e.revalue=function(t){return r&&(To(t,function(e){e.children&&(e.value=0)}),Ao(t,function(t){var a;t.children||(t.value=+r.call(e,t,t.depth)||0),(a=t.parent)&&(a.value+=t.value)})),t},e},_n.layout.partition=function(){function e(t,a,r,o){var l=t.children;if(t.x=a,t.y=t.depth*o,t.dx=r,t.dy=o,l&&(p=l.length)){var s=-1,p,u,g;for(r=t.value?r/t.value:0;++s<p;)e(u=l[s],a,g=u.value*r,o),a+=g}}function t(e){var a=e.children,r=0;if(a&&(l=a.length))for(var o=-1,l;++o<l;)r=va(r,t(a[o]));return 1+r}function a(a,n){var i=r.call(this,a,n);return e(i[0],0,o[0],o[1]/t(i[0])),i}var r=_n.layout.hierarchy(),o=[1,1];return a.size=function(e){return arguments.length?(o=e,a):o},wo(a,r)},_n.layout.pie=function(){function e(s){var d=s.length,n=s.map(function(a,r){return+t.call(e,a,r)}),c=+("function"==typeof o?o.apply(this,arguments):o),u=("function"==typeof i?i.apply(this,arguments):i)-c,g=ea(_a(u)/d,+("function"==typeof l?l.apply(this,arguments):l)),p=g*(0>u?-1:1),h=_n.sum(n),m=h?(u-d*p)/h:0,y=_n.range(d),f=[],x;return null!=r&&y.sort(r===bs?function(e,t){return n[t]-n[e]}:function(e,t){return r(s[e],s[t])}),y.forEach(function(e){f[e]={data:s[e],value:x=n[e],startAngle:c,endAngle:c+=x*m+p,padAngle:g}}),f}var t=Number,r=bs,o=0,i=Vn,l=0;return e.value=function(a){return arguments.length?(t=a,e):t},e.sort=function(t){return arguments.length?(r=t,e):r},e.startAngle=function(t){return arguments.length?(o=t,e):o},e.endAngle=function(t){return arguments.length?(i=t,e):i},e.padAngle=function(t){return arguments.length?(l=t,e):l},e};var bs={};_n.layout.stack=function(){function e(s,d){if(!(m=s.length))return s;var c=s.map(function(a,r){return t.call(e,a,r)}),p=c.map(function(t){return t.map(function(t,a){return[n.call(e,t,a),l.call(e,t,a)]})}),u=a.call(e,p,d);c=_n.permute(c,u),p=_n.permute(p,u);var g=r.call(e,p,d),h=c[0].length,m,y,f,x;for(f=0;f<h;++f)for(o.call(e,c[0][f],x=g[f],p[0][f][1]),y=1;y<m;++y)o.call(e,c[y][f],x+=p[y-1][f][1],p[y][f][1]);return s}var t=z,a=Do,r=Oo,o=Po,n=Io,l=zo;return e.values=function(a){return arguments.length?(t=a,e):t},e.order=function(t){return arguments.length?(a="function"==typeof t?t:vs.get(t)||Do,e):a},e.offset=function(t){return arguments.length?(r="function"==typeof t?t:ks.get(t)||Oo,e):r},e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(l=t,e):l},e.out=function(t){return arguments.length?(o=t,e):o},e};var vs=_n.map({"inside-out":function(e){var t=e.length,r=e.map(Ro),o=e.map(Mo),n=_n.range(t).sort(function(e,t){return r[e]-r[t]}),l=0,s=0,d=[],c=[],p,a;for(p=0;p<t;++p)a=n[p],l<s?(l+=o[a],d.push(a)):(s+=o[a],c.push(a));return c.reverse().concat(d)},reverse:function(e){return _n.range(e.length).reverse()},default:Do}),ks=_n.map({silhouette:function(e){var t=e.length,a=e[0].length,r=[],n=0,l=[],s,d,c;for(d=0;d<a;++d){for(s=0,c=0;s<t;s++)c+=e[s][d][1];c>n&&(n=c),r.push(c)}for(d=0;d<a;++d)l[d]=(n-r[d])/2;return l},wiggle:function(e){var t=e.length,a=e[0],r=a.length,n=[],l,s,d,c,p,u,g,h,m;for(n[0]=h=m=0,s=1;s<r;++s){for(l=0,c=0;l<t;++l)c+=e[l][s][1];for(l=0,p=0,g=a[s][0]-a[s-1][0];l<t;++l){for(d=0,u=(e[l][s][1]-e[l][s-1][1])/(2*g);d<l;++d)u+=(e[d][s][1]-e[d][s-1][1])/g;p+=u*e[l][s][1]}n[s]=h-=c?p/c*g:0,h<m&&(m=h)}for(s=0;s<r;++s)n[s]-=m;return n},expand:function(e){var t=e.length,a=e[0].length,r=[],n,l,s;for(l=0;l<a;++l){for(n=0,s=0;n<t;n++)s+=e[n][l][1];if(s)for(n=0;n<t;n++)e[n][l][1]/=s;else for(n=0;n<t;n++)e[n][l][1]=1/t}for(l=0;l<a;++l)r[l]=0;return r},zero:Oo});_n.layout.histogram=function(){function e(e,l){for(var s=[],d=e.map(a,this),c=r.call(this,d,l),p=o.call(this,c,d,l),l=-1,u=d.length,n=p.length-1,g=t?1:1/u,h,m;++l<n;)h=s[l]=[],h.dx=p[l+1]-(h.x=p[l]),h.y=0;if(0<n)for(l=-1;++l<u;)m=d[l],m>=c[0]&&m<=c[1]&&(h=s[_n.bisect(p,m,1,n)-1],h.y+=g,h.push(e[l]));return s}var t=!0,a=Number,r=No,o=Fo;return e.value=function(t){return arguments.length?(a=t,e):a},e.range=function(t){return arguments.length?(r=We(t),e):r},e.bins=function(t){return arguments.length?(o="number"==typeof t?function(e){return Bo(e,t)}:We(t),e):o},e.frequency=function(a){return arguments.length?(t=!!a,e):t},e},_n.layout.pack=function(){function e(e,l){var i=t.call(this,e,l),s=i[0],d=o[0],c=o[1],p=null==n?N:"function"==typeof n?n:function(){return n};if(s.x=s.y=0,Ao(s,function(e){e.r=+p(e.value)}),Ao(s,qo),a){var r=a*(n?1:va(2*s.r/d,2*s.r/c))/2;Ao(s,function(e){e.r+=r}),Ao(s,qo),Ao(s,function(e){e.r-=r})}return Xo(s,d/2,c/2,n?1:1/va(2*s.r/d,2*s.r/c)),i}var t=_n.layout.hierarchy().sort(Vo),a=0,o=[1,1],n;return e.size=function(t){return arguments.length?(o=t,e):o},e.radius=function(t){return arguments.length?(n=null==t||"function"==typeof t?t:+t,e):n},e.padding=function(t){return arguments.length?(a=+t,e):a},wo(e,t)},_n.layout.tree=function(){function e(e,o){var i=l.call(this,e,o),p=i[0],u=t(p);if(Ao(u,a),u.parent.m=-u.z,To(u,r),c)To(p,n);else{var g=p,h=p,m=p;To(p,function(e){e.x<g.x&&(g=e),e.x>h.x&&(h=e),e.depth>m.depth&&(m=e)});var y=s(g,h)/2-g.x,f=d[0]/(h.x+s(h,g)/2+y),x=d[1]/(m.depth||1);To(p,function(e){e.x=(e.x+y)*f,e.y=e.depth*x})}return i}function t(e){for(var t={A:null,children:[e]},a=[t],r;null!=(r=a.pop());)for(var o=r.children,l=0,s=o.length,n;l<s;++l)a.push((o[l]=n={_:o[l],parent:r,children:(n=o[l].children)&&n.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:l}).a=n);return t.children[0]}function a(e){var t=e.children,a=e.parent.children,r=e.i?a[e.i-1]:null;if(t.length){ei(e);var i=(t[0].z+t[t.length-1].z)/2;r?(e.z=r.z+s(e._,r._),e.m=e.z-i):e.z=i}else r&&(e.z=r.z+s(e._,r._));e.parent.A=o(e,r,e.parent.A||a[0])}function r(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function o(e,t,a){if(t){for(var r=e,o=e,i=t,n=r.parent.children[0],l=r.m,d=o.m,c=i.m,p=n.m,u;i=Qo(i),r=Jo(r),i&&r;)n=Jo(n),o=Qo(o),o.a=e,u=i.z+c-r.z-l+s(i._,r._),0<u&&($o(ti(i,e,a),e,u),l+=u,d+=u),c+=i.m,l+=r.m,p+=n.m,d+=o.m;i&&!Qo(o)&&(o.t=i,o.m+=c-d),r&&!Jo(n)&&(n.t=r,n.m+=l-p,a=e)}return a}function n(e){e.x*=d[0],e.y=e.depth*d[1]}var l=_n.layout.hierarchy().sort(null).value(null),s=Ko,d=[1,1],c=null;return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(c=null==(d=t)?n:null,e):c?null:d},e.nodeSize=function(t){return arguments.length?(c=null==(d=t)?null:n,e):c?d:null},wo(e,l)},_n.layout.cluster=function(){function e(e,n){var i=t.call(this,e,n),l=i[0],s=0,d;Ao(l,function(e){var t=e.children;t&&t.length?(e.x=ri(t),e.y=ai(t)):(e.x=d?s+=a(e,d):0,e.y=0,d=e)});var c=oi(l),p=ii(l),u=c.x-a(c,p)/2,g=p.x+a(p,c)/2;return Ao(l,o?function(e){e.x=(e.x-l.x)*r[0],e.y=(l.y-e.y)*r[1]}:function(e){e.x=(e.x-u)/(g-u)*r[0],e.y=(1-(l.y?e.y/l.y:1))*r[1]}),i}var t=_n.layout.hierarchy().sort(null).value(null),a=Ko,r=[1,1],o=!1;return e.separation=function(t){return arguments.length?(a=t,e):a},e.size=function(t){return arguments.length?(o=null==(r=t),e):o?null:r},e.nodeSize=function(t){return arguments.length?(o=null!=(r=t),e):o?r:null},wo(e,t)},_n.layout.treemap=function(){function e(e,t){for(var a=-1,r=e.length,o,n;++a<r;)n=(o=e[a]).value*(0>t?0:t),o.area=isNaN(n)||0>=n?0:n}function t(a){var i=a.children;if(i&&i.length){var l=c(a),s=[],d=i.slice(),p=1/0,h="slice"===g?l.dx:"dice"===g?l.dy:"slice-dice"===g?1&a.depth?l.dy:l.dx:ea(l.dx,l.dy),m,y,f;for(e(d,l.dx*l.dy/a.value),s.area=0;0<(f=d.length);)s.push(m=d[f-1]),s.area+=m.area,"squarify"!==g||(y=r(s,h))<=p?(d.pop(),p=y):(s.area-=s.pop().area,o(s,h,l,!1),h=ea(l.dx,l.dy),s.length=s.area=0,p=1/0);s.length&&(o(s,h,l,!0),s.length=s.area=0),i.forEach(t)}}function a(t){var r=t.children;if(r&&r.length){var i=c(t),n=r.slice(),l=[],s;for(e(n,i.dx*i.dy/t.value),l.area=0;s=n.pop();)l.push(s),l.area+=s.area,null!=s.z&&(o(l,s.z?i.dx:i.dy,i,!n.length),l.length=l.area=0);r.forEach(a)}}function r(e,t){for(var a=e.area,o=0,l=1/0,d=-1,c=e.length,n;++d<c;)(n=e[d].area)&&(n<l&&(l=n),n>o&&(o=n));return a*=a,t*=t,a?va(t*o*h/a,a/(t*l*h)):1/0}function o(e,t,a,r){var s=-1,d=e.length,n=a.x,c=a.y,p=t?l(e.area/t):0,u;if(t==a.dx){for((r||p>a.dy)&&(p=a.dy);++s<d;)u=e[s],u.x=n,u.y=c,u.dy=p,n+=u.dx=ea(a.x+a.dx-n,p?l(u.area/p):0);u.z=!0,u.dx+=a.x+a.dx-n,a.y+=p,a.dy-=p}else{for((r||p>a.dx)&&(p=a.dx);++s<d;)u=e[s],u.x=n,u.y=c,u.dx=p,c+=u.dy=ea(a.y+a.dy-c,p?l(u.area/p):0);u.z=!1,u.dy+=a.y+a.dy-c,a.x+=p,a.dx-=p}}function i(r){var o=m||n(r),i=o[0];return i.x=i.y=0,i.value?(i.dx=s[0],i.dy=s[1]):i.dx=i.dy=0,m&&n.revalue(i),e([i],i.dx*i.dy/i.value),(m?a:t)(i),p&&(m=o),o}var n=_n.layout.hierarchy(),l=V,s=[1,1],d=null,c=ni,p=!1,g="squarify",h=.5*(1+N(5)),m;return i.size=function(e){return arguments.length?(s=e,i):s},i.padding=function(e){function t(t){var a=e.call(i,t,t.depth);return null==a?ni(t):li(t,"number"==typeof a?[a,a,a,a]:a)}function a(t){return li(t,e)}if(!arguments.length)return d;var r;return c=null==(d=e)?ni:"function"==(r=typeof e)?t:"number"===r?(e=[e,e,e,e],a):a,i},i.round=function(e){return arguments.length?(l=e?V:Number,i):l!=Number},i.sticky=function(e){return arguments.length?(p=e,m=null,i):p},i.ratio=function(e){return arguments.length?(h=e,i):h},i.mode=function(e){return arguments.length?(g=e+"",i):g},wo(i,n)},_n.random={normal:function(e,t){var a=arguments.length;return 2>a&&(t=1),1>a&&(e=0),function(){var a,o,i;do a=2*Math.random()-1,o=2*Math.random()-1,i=a*a+o*o;while(!i||1<i);return e+t*a*N(-2*P(i)/i)}},logNormal:function(){var e=_n.random.normal.apply(_n,arguments);return function(){return m(e())}},bates:function(e){var t=_n.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,a=0;a<e;a++)t+=Math.random();return t}}},_n.scale={};var ws={floor:z,ceil:z};_n.scale.linear=function(){return hi([0,1],[0,1],Hr,!1)};var Ts={s:1,g:1,p:1,r:1,e:1};_n.scale.log=function(){return ki(_n.scale.linear().domain([0,1]),10,!0,[1,10])};var As=_n.format(".0e"),Ss={floor:function(e){return-M(-e)},ceil:function(e){return-ba(-e)}};_n.scale.pow=function(){return wi(_n.scale.linear(),1,[0,1])},_n.scale.sqrt=function(){return _n.scale.pow().exponent(.5)},_n.scale.ordinal=function(){return Ai([],{t:"range",a:[[]]})},_n.scale.category10=function(){return _n.scale.ordinal().range(Cs)},_n.scale.category20=function(){return _n.scale.ordinal().range(Ls)},_n.scale.category20b=function(){return _n.scale.ordinal().range(Es)},_n.scale.category20c=function(){return _n.scale.ordinal().range(Is)};var Cs=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Ne),Ls=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Ne),Es=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Ne),Is=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Ne);_n.scale.quantile=function(){return Si([],[])},_n.scale.quantize=function(){return Ci(0,1,[0,1])},_n.scale.threshold=function(){return Li([.5],[0,1])},_n.scale.identity=function(){return Ei([0,1])},_n.svg={},_n.svg.arc=function(){function e(){var e=va(0,+o.apply(this,arguments)),a=va(0,+n.apply(this,arguments)),r=c.apply(this,arguments)-Un,g=p.apply(this,arguments)-Un,h=_a(g-r),m=r>g?0:1;if(a<e&&(_=a,a=e,e=_),h>=Vn-Nn)return t(a,m)+(e?t(e,1-m):"")+"Z";var y=0,f=0,x=[],_,b,v,k,w,T,A,S,C,L,E,I;if((k=(+u.apply(this,arguments)||0)/2)&&(v=s===zs?N(e*e+a*a):+s.apply(this,arguments),!m&&(f*=-1),a&&(f=be(v/a*De(k))),e&&(y=be(v/e*De(k)))),a){w=a*R(r+f),T=a*De(r+f),A=a*R(g-f),S=a*De(g-f);var z=_a(g-r-2*f)<=i?0:1;if(f&&Mi(w,T,A,S)===m^z){var P=(r+g)/2;w=a*R(P),T=a*De(P),A=S=null}}else w=T=0;if(e){C=e*R(g-y),L=e*De(g-y),E=e*R(r+y),I=e*De(r+y);var D=_a(r-g+2*y)<=i?0:1;if(y&&Mi(C,L,E,I)===1-m^D){var O=(r+g)/2;C=e*R(O),L=e*De(O),E=I=null}}else C=L=0;if(h>Nn&&.001<(_=ea(_a(a-e)/2,+l.apply(this,arguments)))){b=e<a^m?0:1;var M=_,j=_;if(h<i){var F=null==E?[C,L]:null==A?[w,T]:or([w,T],[E,I],[A,S],[C,L]),B=w-F[0],V=T-F[1],U=A-F[0],H=S-F[1],G=1/De(d((B*U+V*H)/(N(B*B+V*V)*N(U*U+H*H)))/2),q=N(F[0]*F[0]+F[1]*F[1]);j=ea(_,(e-q)/(G-1)),M=ea(_,(a-q)/(G+1))}if(null!=A){var Y=ji(null==E?[C,L]:[E,I],[w,T],a,M,m),W=ji([A,S],[C,L],a,M,m);_===M?x.push("M",Y[0],"A",M,",",M," 0 0,",b," ",Y[1],"A",a,",",a," 0 ",1-m^Mi(Y[1][0],Y[1][1],W[1][0],W[1][1]),",",m," ",W[1],"A",M,",",M," 0 0,",b," ",W[0]):x.push("M",Y[0],"A",M,",",M," 0 1,",b," ",W[0])}else x.push("M",w,",",T);if(null!=E){var X=ji([w,T],[E,I],e,-j,m),Z=ji([C,L],null==A?[w,T]:[A,S],e,-j,m);_===j?x.push("L",Z[0],"A",j,",",j," 0 0,",b," ",Z[1],"A",e,",",e," 0 ",m^Mi(Z[1][0],Z[1][1],X[1][0],X[1][1]),",",1-m," ",X[1],"A",j,",",j," 0 0,",b," ",X[0]):x.push("L",Z[0],"A",j,",",j," 0 0,",b," ",X[0])}else x.push("L",C,",",L)}else x.push("M",w,",",T),null!=A&&x.push("A",a,",",a," 0 ",z,",",m," ",A,",",S),x.push("L",C,",",L),null!=E&&x.push("A",e,",",e," 0 ",D,",",1-m," ",E,",",I);return x.push("Z"),x.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var o=zi,n=Pi,l=Ii,s=zs,c=Di,p=Oi,u=Ri;return e.innerRadius=function(t){return arguments.length?(o=We(t),e):o},e.outerRadius=function(t){return arguments.length?(n=We(t),e):n},e.cornerRadius=function(t){return arguments.length?(l=We(t),e):l},e.padRadius=function(t){return arguments.length?(s=t==zs?zs:We(t),e):s},e.startAngle=function(t){return arguments.length?(c=We(t),e):c},e.endAngle=function(t){return arguments.length?(p=We(t),e):p},e.padAngle=function(t){return arguments.length?(u=We(t),e):u},e.centroid=function(){var e=(+o.apply(this,arguments)+ +n.apply(this,arguments))/2,t=(+c.apply(this,arguments)+ +p.apply(this,arguments))/2-Un;return[R(t)*e,De(t)*e]},e};var zs="auto";_n.svg.line=function(){return Fi(z)};var Ps=_n.map({linear:Bi,"linear-closed":Ni,step:function(e){for(var t=0,a=e.length,r=e[0],o=[r[0],",",r[1]];++t<a;)o.push("H",(r[0]+(r=e[t])[0])/2,"V",r[1]);return 1<a&&o.push("H",r[0]),o.join("")},"step-before":Vi,"step-after":Ui,basis:qi,"basis-open":function(e){if(4>e.length)return Bi(e);for(var t=[],a=-1,r=e.length,o=[0],n=[0],l;3>++a;)l=e[a],o.push(l[0]),n.push(l[1]);for(t.push(Yi(Rs,o)+","+Yi(Rs,n)),--a;++a<r;)l=e[a],o.shift(),o.push(l[0]),n.shift(),n.push(l[1]),Wi(t,o,n);return t.join("")},"basis-closed":function(e){for(var t=-1,a=e.length,r=a+4,o=[],n=[],l,s;4>++t;)s=e[t%a],o.push(s[0]),n.push(s[1]);for(l=[Yi(Rs,o),",",Yi(Rs,n)],--t;++t<r;)s=e[t%a],o.shift(),o.push(s[0]),n.shift(),n.push(s[1]),Wi(l,o,n);return l.join("")},bundle:function(e,a){var r=e.length-1;if(r)for(var o=e[0][0],n=e[0][1],l=e[r][0]-o,s=e[r][1]-n,d=-1,c,u;++d<=r;)c=e[d],u=d/r,c[0]=a*c[0]+(1-a)*(o+u*l),c[1]=a*c[1]+(1-a)*(n+u*s);return qi(e)},cardinal:function(e,t){return 3>e.length?Bi(e):e[0]+Hi(e,Gi(e,t))},"cardinal-open":function(e,t){return 4>e.length?Bi(e):e[1]+Hi(e.slice(1,-1),Gi(e,t))},"cardinal-closed":function(e,t){return 3>e.length?Ni(e):e[0]+Hi((e.push(e[0]),e),Gi([e[e.length-2]].concat(e,[e[1]]),t))},monotone:function(e){return 3>e.length?Bi(e):e[0]+Hi(e,Ki(e))}});Ps.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Ds=[0,2/3,1/3,0],Os=[0,1/3,2/3,0],Rs=[0,1/6,2/3,1/6];_n.svg.line.radial=function(){var e=Fi(Ji);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Vi.reverse=Ui,Ui.reverse=Vi,_n.svg.area=function(){return Qi(z)},_n.svg.area.radial=function(){var e=Qi(Ji);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},_n.svg.chord=function(){function e(e,d){var i=a(this,l,e,d),s=a(this,c,e,d);return"M"+i.p0+o(i.r,i.p1,i.a1-i.a0)+(r(i,s)?n(i.r,i.p1,i.r,i.p0):n(i.r,i.p1,s.r,s.p0)+o(s.r,s.p1,s.a1-s.a0)+n(s.r,s.p1,i.r,i.p0))+"Z"}function a(e,t,a,o){var i=t.call(e,a,o),n=p.call(e,i,o),r=u.call(e,i,o)-Un,l=g.call(e,i,o)-Un;return{r:n,a0:r,a1:l,p0:[n*R(r),n*De(r)],p1:[n*R(l),n*De(l)]}}function r(e,t){return e.a0==t.a0&&e.a1==t.a1}function o(e,t,r){return"A"+e+","+e+" 0 "+ +(r>i)+",1 "+t}function n(e,t,a,r){return"Q 0,0 "+r}var l=Ga,c=qa,p=$i,u=Di,g=Oi;return e.radius=function(t){return arguments.length?(p=We(t),e):p},e.source=function(t){return arguments.length?(l=We(t),e):l},e.target=function(t){return arguments.length?(c=We(t),e):c},e.startAngle=function(t){return arguments.length?(u=We(t),e):u},e.endAngle=function(t){return arguments.length?(g=We(t),e):g},e},_n.svg.diagonal=function(){function e(e,o){var i=t.call(this,e,o),n=a.call(this,e,o),l=(i.y+n.y)/2,s=[i,{x:i.x,y:l},{x:n.x,y:l},n];return s=s.map(r),"M"+s[0]+"C"+s[1]+" "+s[2]+" "+s[3]}var t=Ga,a=qa,r=en;return e.source=function(a){return arguments.length?(t=We(a),e):t},e.target=function(t){return arguments.length?(a=We(t),e):a},e.projection=function(t){return arguments.length?(r=t,e):r},e},_n.svg.diagonal.radial=function(){var e=_n.svg.diagonal(),t=en,a=e.projection;return e.projection=function(e){return arguments.length?a(tn(t=e)):t},e},_n.svg.symbol=function(){function e(e,r){return(Ms.get(t.call(this,e,r))||on)(a.call(this,e,r))}var t=rn,a=an;return e.type=function(a){return arguments.length?(t=We(a),e):t},e.size=function(t){return arguments.length?(a=We(t),e):a},e};var Ms=_n.map({circle:on,cross:function(e){var t=N(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=N(e/(2*Fs)),a=t*Fs;return"M0,"+-t+"L"+a+",0 0,"+t+" "+-a+",0Z"},square:function(e){var t=N(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=N(e/js),a=t*js/2;return"M0,"+a+"L"+t+","+-a+" "+-t+","+-a+"Z"},"triangle-up":function(e){var t=N(e/js),a=t*js/2;return"M0,"+-a+"L"+t+","+a+" "+-t+","+a+"Z"}});_n.svg.symbolTypes=Ms.keys();var js=N(3),Fs=fa(30*Hn);Dn.transition=function(e){for(var t=Us||++Vs,a=cn(e),r=[],o=Hs||{time:Date.now(),ease:Kr,delay:0,duration:250},l=-1,s=this.length,d,c;++l<s;){r.push(d=[]);for(var p=this[l],u=-1,g=p.length;++u<g;)(c=p[u])&&pn(c,u,a,t,o),d.push(c)}return ln(r,a,t)},Dn.interrupt=function(e){return this.each(null==e?Bs:nn(cn(e)))};var Bs=nn(cn()),Ns=[],Vs=0,Us,Hs;Ns.call=Dn.call,Ns.empty=Dn.empty,Ns.node=Dn.node,Ns.size=Dn.size,_n.transition=function(e,t){return e&&e.transition?Us?e.transition(t):e:_n.selection().transition(e)},_n.transition.prototype=Ns,Ns.select=function(e){var t=this.id,a=this.namespace,r=[],o,l,s;e=W(e);for(var d=-1,c=this.length;++d<c;){r.push(o=[]);for(var p=this[d],u=-1,g=p.length;++u<g;)(s=p[u])&&(l=e.call(s,s.__data__,u,d))?("__data__"in s&&(l.__data__=s.__data__),pn(l,u,a,t,s[a][t]),o.push(l)):o.push(null)}return ln(r,a,t)},Ns.selectAll=function(e){var t=this.id,a=this.namespace,r=[],l,s,d,c,p;e=X(e);for(var u=-1,g=this.length;++u<g;)for(var h=this[u],m=-1,y=h.length;++m<y;)if(d=h[m]){p=d[a][t],s=e.call(d,d.__data__,m,u),r.push(l=[]);for(var n=-1,f=s.length;++n<f;)(c=s[n])&&pn(c,n,a,t,p),l.push(c)}return ln(r,a,t)},Ns.filter=function(e){var t=[],a,r,o;"function"!=typeof e&&(e=ne(e));for(var l=0,s=this.length;l<s;l++){t.push(a=[]);for(var r=this[l],d=0,c=r.length;d<c;d++)(o=r[d])&&e.call(o,o.__data__,d,l)&&a.push(o)}return ln(t,this.namespace,this.id)},Ns.tween=function(e,t){var a=this.id,r=this.namespace;return 2>arguments.length?this.node()[r][a].tween.get(e):se(this,null==t?function(t){t[r][a].tween.remove(e)}:function(o){o[r][a].tween.set(e,t)})},Ns.attr=function(e,t){function a(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}if(2>arguments.length){for(t in e)this.attr(t,e[t]);return this}var o="transform"==e?uo:Hr,n=_n.ns.qualify(e);return sn(this,"attr."+e,t,n.local?function(e){return null==e?r:(e+="",function(){var t=this.getAttributeNS(n.space,n.local),a;return t!==e&&(a=o(t,e),function(e){this.setAttributeNS(n.space,n.local,a(e))})})}:function(e){return null==e?a:(e+="",function(){var t=this.getAttribute(n),a;return t!==e&&(a=o(t,e),function(e){this.setAttribute(n,a(e))})})})},Ns.attrTween=function(e,t){var a=_n.ns.qualify(e);return this.tween("attr."+e,a.local?function(e,r){var o=t.call(this,e,r,this.getAttributeNS(a.space,a.local));return o&&function(e){this.setAttributeNS(a.space,a.local,o(e))}}:function(e,r){var o=t.call(this,e,r,this.getAttribute(a));return o&&function(e){this.setAttribute(a,o(e))}})},Ns.style=function(e,t,a){function o(){this.style.removeProperty(e)}var i=arguments.length;if(3>i){if("string"!=typeof e){for(a in 2>i&&(t=""),e)this.style(a,e[a],t);return this}a=""}return sn(this,"style."+e,t,function(t){return null==t?o:(t+="",function(){var o=r(this).getComputedStyle(this,null).getPropertyValue(e),n;return o!==t&&(n=Hr(o,t),function(r){this.style.setProperty(e,n(r),a)})})})},Ns.styleTween=function(e,t,a){return 3>arguments.length&&(a=""),this.tween("style."+e,function(o,n){var i=t.call(this,o,n,r(this).getComputedStyle(this,null).getPropertyValue(e));return i&&function(r){this.style.setProperty(e,i(r),a)}})},Ns.text=function(e){return sn(this,"text",e,dn)},Ns.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;2>this[e].count&&(t=this.parentNode)&&t.removeChild(this)})},Ns.ease=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].ease:("function"!=typeof e&&(e=_n.ease.apply(_n,arguments)),se(this,function(r){r[a][t].ease=e}))},Ns.delay=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].delay:se(this,"function"==typeof e?function(r,o,i){r[a][t].delay=+e.call(r,r.__data__,o,i)}:(e=+e,function(r){r[a][t].delay=e}))},Ns.duration=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].duration:se(this,"function"==typeof e?function(r,o,i){r[a][t].duration=va(1,e.call(r,r.__data__,o,i))}:(e=va(1,e),function(r){r[a][t].duration=e}))},Ns.each=function(e,t){var a=this.id,r=this.namespace;if(2>arguments.length){var o=Hs,i=Us;try{Us=a,se(this,function(t,o,i){Hs=t[r][a],e.call(t,t.__data__,o,i)})}finally{Hs=o,Us=i}}else se(this,function(o){var i=o[r][a];(i.event||(i.event=_n.dispatch("start","end","interrupt"))).on(e,t)});return this},Ns.transition=function(){for(var e=this.id,t=++Vs,a=this.namespace,r=[],o=0,l=this.length,s,d,c,p;o<l;o++){r.push(s=[]);for(var d=this[o],u=0,g=d.length;u<g;u++)(c=d[u])&&(p=c[a][e],pn(c,u,a,t,{time:p.time,ease:p.ease,delay:p.delay+p.duration,duration:p.duration})),s.push(c)}return ln(r,a,t)},_n.svg.axis=function(){function e(e){e.each(function(){var e=_n.select(this),d=this.__chart__||t,c=this.__chart__=t.copy(),p=null==l?c.ticks?c.ticks.apply(c,n):c.domain():l,u=null==s?c.tickFormat?c.tickFormat.apply(c,n):z:s,g=e.selectAll(".tick").data(p,c),h=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Nn),m=_n.transition(g.exit()).style("opacity",Nn).remove(),y=_n.transition(g.order()).style("opacity",1),f=va(r,0)+i,_=di(c),b=e.selectAll(".domain").data([0]),v=(b.enter().append("path").attr("class","domain"),_n.transition(b)),k;h.append("line"),h.append("text");var w=h.select("line"),T=y.select("line"),A=g.select("text").text(u),S=h.select("text"),C=y.select("text"),L="top"===a||"left"===a?-1:1,E,I,P,D;if("bottom"===a||"top"===a?(k=un,E="x",P="y",I="x2",D="y2",A.attr("dy",0>L?"0em":".71em").style("text-anchor","middle"),v.attr("d","M"+_[0]+","+L*o+"V0H"+_[1]+"V"+L*o)):(k=gn,E="y",P="x",I="y2",D="x2",A.attr("dy",".32em").style("text-anchor",0>L?"end":"start"),v.attr("d","M"+L*o+","+_[0]+"H0V"+_[1]+"H"+L*o)),w.attr(D,L*r),S.attr(P,L*f),T.attr(I,0).attr(D,L*r),C.attr(E,0).attr(P,L*f),c.rangeBand){var O=c,x=O.rangeBand()/2;d=c=function(e){return O(e)+x}}else d.rangeBand?d=c:m.call(k,c,d);h.call(k,d,c),y.call(k,c,c)})}var t=_n.scale.linear(),a=Gs,r=6,o=6,i=3,n=[10],l=null,s;return e.scale=function(a){return arguments.length?(t=a,e):t},e.orient=function(t){return arguments.length?(a=t in qs?t+"":Gs,e):a},e.ticks=function(){return arguments.length?(n=f(arguments),e):n},e.tickValues=function(t){return arguments.length?(l=t,e):l},e.tickFormat=function(t){return arguments.length?(s=t,e):s},e.tickSize=function(t){var a=arguments.length;return a?(r=+t,o=+arguments[a-1],e):r},e.innerTickSize=function(t){return arguments.length?(r=+t,e):r},e.outerTickSize=function(t){return arguments.length?(o=+t,e):o},e.tickPadding=function(t){return arguments.length?(i=+t,e):i},e.tickSubdivide=function(){return arguments.length&&e},e};var Gs="bottom",qs={top:1,right:1,bottom:1,left:1};_n.svg.brush=function(){function e(r){r.each(function(){var r=_n.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",i).on("touchstart.brush",i),n=r.selectAll(".background").data([0]);n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),r.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var d=r.selectAll(".resize").data(h,z);d.exit().remove(),d.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Ys[e]}).append("rect").attr("x",function(e){return /[ew]$/.test(e)?-3:null}).attr("y",function(e){return /^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),d.style("display",e.empty()?"none":null);var c=_n.transition(r),p=_n.transition(n),u;l&&(u=di(l),p.attr("x",u[0]).attr("width",u[1]-u[0]),a(c)),s&&(u=di(s),p.attr("y",u[0]).attr("height",u[1]-u[0]),o(c)),t(c)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+c[+/e$/.test(e)]+","+p[+/^s/.test(e)]+")"})}function a(e){e.select(".extent").attr("x",c[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function o(e){e.select(".extent").attr("y",p[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",p[1]-p[0])}function i(){function i(){32==_n.event.keyCode&&(!C&&(w=null,E[0]-=c[1],E[1]-=p[1],C=2),H())}function d(){32==_n.event.keyCode&&2==C&&(E[0]+=c[1],E[1]+=p[1],C=0,H())}function h(){var e=_n.mouse(_),r=!1;z&&(e[0]+=z[0],e[1]+=z[1]),C||(_n.event.altKey?(!w&&(w=[(c[0]+c[1])/2,(p[0]+p[1])/2]),E[0]=c[+(e[0]<w[0])],E[1]=p[+(e[1]<w[1])]):w=null),A&&y(e,l,0)&&(a(k),r=!0),S&&y(e,s,1)&&(o(k),r=!0),r&&(t(k),v({type:"brush",mode:C?"move":"resize"}))}function y(e,t,a){var r=di(t),o=r[0],i=r[1],n=E[a],l=a?p:c,s=l[1]-l[0],d,h;if(C&&(o-=n,i-=s+n),d=(a?g:u)?va(o,ea(i,e[a])):e[a],C?h=(d+=n)+s:(w&&(n=va(o,ea(i,2*w[a]-d))),n<d?(h=d,d=n):h=n),l[0]!=d||l[1]!=h)return a?f=null:m=null,l[0]=d,l[1]=h,!0}function x(){h(),k.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),_n.select("body").style("cursor",null),I.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),L(),v({type:"brushend"})}var _=this,b=_n.select(_n.event.target),v=n.of(_,arguments),k=_n.select(_),T=b.datum(),A=!/^(n|s)$/.test(T)&&l,S=!/^(e|w)$/.test(T)&&s,C=b.classed("extent"),L=he(_),E=_n.mouse(_),I=_n.select(r(_)).on("keydown.brush",i).on("keyup.brush",d),w,z;if(_n.event.changedTouches?I.on("touchmove.brush",h).on("touchend.brush",x):I.on("mousemove.brush",h).on("mouseup.brush",x),k.interrupt().selectAll("*").interrupt(),C)E[0]=c[0]-E[0],E[1]=p[0]-E[1];else if(T){var P=+/w$/.test(T),D=+/^n/.test(T);z=[c[1-P]-E[0],p[1-D]-E[1]],E[0]=c[P],E[1]=p[D]}else _n.event.altKey&&(w=E.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),_n.select("body").style("cursor",b.style("cursor")),v({type:"brushstart"}),h()}var n=q(e,"brushstart","brush","brushend"),l=null,s=null,c=[0,0],p=[0,0],u=!0,g=!0,h=Ws[0],m,f;return e.event=function(e){e.each(function(){var e=n.of(this,arguments),a={x:c,y:p,i:m,j:f},r=this.__chart__||a;this.__chart__=a,Us?_n.select(this).transition().each("start.brush",function(){m=r.i,f=r.j,c=r.x,p=r.y,e({type:"brushstart"})}).tween("brush:brush",function(){var r=Gr(c,a.x),o=Gr(p,a.y);return m=f=null,function(i){c=a.x=r(i),p=a.y=o(i),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){m=a.i,f=a.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(l=t,h=Ws[!l<<1|!s],e):l},e.y=function(t){return arguments.length?(s=t,h=Ws[!l<<1|!s],e):s},e.clamp=function(t){return arguments.length?(l&&s?(u=!!t[0],g=!!t[1]):l?u=!!t:s&&(g=!!t),e):l&&s?[u,g]:l?u:s?g:null},e.extent=function(a){var r,o,i,n,d;return arguments.length?(l&&(r=a[0],o=a[1],s&&(r=r[0],o=o[0]),m=[r,o],l.invert&&(r=l(r),o=l(o)),o<r&&(d=r,r=o,o=d),(r!=c[0]||o!=c[1])&&(c=[r,o])),s&&(i=a[0],n=a[1],l&&(i=i[1],n=n[1]),f=[i,n],s.invert&&(i=s(i),n=s(n)),n<i&&(d=i,i=n,n=d),(i!=p[0]||n!=p[1])&&(p=[i,n])),e):(l&&(m?(r=m[0],o=m[1]):(r=c[0],o=c[1],l.invert&&(r=l.invert(r),o=l.invert(o)),o<r&&(d=r,r=o,o=d))),s&&(f?(i=f[0],n=f[1]):(i=p[0],n=p[1],s.invert&&(i=s.invert(i),n=s.invert(n)),n<i&&(d=i,i=n,n=d))),l&&s?[[r,i],[o,n]]:l?[r,o]:s&&[i,n])},e.clear=function(){return e.empty()||(c=[0,0],p=[0,0],m=f=null),e},e.empty=function(){return!!l&&c[0]==c[1]||!!s&&p[0]==p[1]},_n.rebind(e,n,"on")};var Ys={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ws=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Xs=hl.format=bl.timeFormat,Zs=Xs.utc,Ks=Zs("%Y-%m-%dT%H:%M:%S.%LZ");Xs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?hn:Ks,hn.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},hn.toString=Ks.toString,hl.second=nt(function(e){return new ml(1e3*ba(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*ba(t))},function(e){return e.getSeconds()}),hl.seconds=hl.second.range,hl.seconds.utc=hl.second.utc.range,hl.minute=nt(function(e){return new ml(6e4*ba(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*ba(t))},function(e){return e.getMinutes()}),hl.minutes=hl.minute.range,hl.minutes.utc=hl.minute.utc.range,hl.hour=nt(function(e){var t=e.getTimezoneOffset()/60;return new ml(36e5*(ba(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*ba(t))},function(e){return e.getHours()}),hl.hours=hl.hour.range,hl.hours.utc=hl.hour.utc.range,hl.month=nt(function(e){return e=hl.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),hl.months=hl.month.range,hl.months.utc=hl.month.utc.range;var Js=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Qs=[[hl.second,1],[hl.second,5],[hl.second,15],[hl.second,30],[hl.minute,1],[hl.minute,5],[hl.minute,15],[hl.minute,30],[hl.hour,1],[hl.hour,3],[hl.hour,6],[hl.hour,12],[hl.day,1],[hl.day,2],[hl.week,1],[hl.month,1],[hl.month,3],[hl.year,1]],$s=Xs.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",Zt]]),ed={range:function(e,t,a){return _n.range(M(e/a)*a,+t,a).map(yn)},floor:z,ceil:z};Qs.year=hl.year,hl.scale=function(){return mn(_n.scale.linear(),Qs,$s)};var td=Qs.map(function(e){return[e[0].utc,e[1]]}),ad=Zs.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",Zt]]);td.year=hl.year.utc,hl.scale.utc=function(){return mn(_n.scale.linear(),td,ad)},_n.text=Xe(function(e){return e.responseText}),_n.json=function(e,t){return Ze(e,"application/json",fn,t)},_n.html=function(e,t){return Ze(e,"text/html",xn,t)},_n.xml=Xe(function(e){return e.responseXML}),"function"==typeof ka&&ka.amd?(this.d3=_n,ka(_n)):"object"==typeof t&&t.exports?t.exports=_n:this.d3=_n}()},{}],164:[function(e,t){t.exports=function(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==void 0)return arguments[e]}},{}],165:[function(e,t){"use strict";function a(e,t){this.point=e,this.index=t}function r(e,t){for(var a=e.point,r=t.point,o=a.length,n=0,l;n<o;++n)if(l=r[n]-a[n],l)return l;return 0}function o(e,t,r){if(1===e)return r?[[-1,0]]:[];var o=t.map(function(e,t){return[e[0],t]});o.sort(function(e,t){return e[0]-t[0]});for(var n=Array(e-1),l=1;l<e;++l){var s=o[l-1],a=o[l];n[l-1]=[s[1],a[1]]}return r&&n.push([-1,n[0][1]],[n[e-1][1],-1]),n}var s=e("incremental-convex-hull"),c=e("uniq");t.exports=function(e,t){var g=e.length;if(0===g)return[];var m=e[0].length;if(1>m)return[];if(1===m)return o(g,e,t);for(var d=Array(g),f=1,_=0;_<g;++_){for(var b=e[_],p=Array(m+1),k=0,w=0,T;w<m;++w)T=b[w],p[w]=T,k+=T*T;p[m]=k,d[_]=new a(p,_),f=va(k,f)}c(d,r),g=d.length;for(var A=Array(g+m+1),S=Array(g+m+1),C=(m+1)*(m+1)*f,u=Array(m+1),_=0;_<=m;++_)u[_]=0;u[m]=C,A[0]=u.slice(),S[0]=-1;for(var _=0,p;_<=m;++_)p=u.slice(),p[_]=1,A[_+1]=p,S[_+1]=-1;for(var _=0,y;_<g;++_)y=d[_],A[_+m+1]=y.point,S[_+m+1]=y.index;var L=s(A,!1);if(L=t?L.filter(function(e){for(var t=0,a=0,r;a<=m;++a){if(r=S[e[a]],0>r&&2<=++t)return!1;e[a]=r}return!0}):L.filter(function(e){for(var t=0,a;t<=m;++t){if(a=S[e[t]],0>a)return!1;e[t]=a}return!0}),1&m)for(var _=0;_<L.length;++_){var y=L[_],p=y[0];y[0]=y[1],y[1]=p}return L}},{"incremental-convex-hull":413,uniq:547}],166:[function(e,t){"use strict";function a(e,t){Array.isArray(e)&&(e=e.join(", "));var a={},o=16,s=.05,d;t&&(2===t.length&&"number"==typeof t[0]?d=r(t):Array.isArray(t)?d=t:(t.o?d=r(t.o):t.pairs&&(d=t.pairs),t.fontSize&&(o=t.fontSize),null!=t.threshold&&(s=t.threshold))),d||(d=l),n.font=o+"px "+e;for(var c=0;c<d.length;c++){var p=d[c],u=n.measureText(p[0]).width+n.measureText(p[1]).width,g=n.measureText(p).width;if(_a(u-g)>o*s){var h=(g-u)/o;a[p]=1e3*h}}return a}function r(e){for(var t=[],a=e[0],r;a<=e[1];a++){r=D(a);for(var o=e[0];o<e[1];o++){var n=D(o),l=r+n;t.push(l)}}return t}t.exports=a;var o=a.canvas=document.createElement("canvas"),n=o.getContext("2d"),l=r([32,126]);a.createPairs=r,a.ascii=l},{}],167:[function(e,t){(function(e){var a=!1;if("undefined"!=typeof Float64Array){var r=new Float64Array(1),o=new Uint32Array(r.buffer);if(r[0]=1,a=!0,1072693248===o[1]){t.exports=function(e){return r[0]=e,[o[0],o[1]]},t.exports.pack=function(e,t){return o[0]=e,o[1]=t,r[0]},t.exports.lo=function(e){return r[0]=e,o[0]},t.exports.hi=function(e){return r[0]=e,o[1]}}else if(1072693248===o[0]){t.exports=function(e){return r[0]=e,[o[1],o[0]]},t.exports.pack=function(e,t){return o[1]=e,o[0]=t,r[0]},t.exports.lo=function(e){return r[0]=e,o[1]},t.exports.hi=function(e){return r[0]=e,o[0]}}else a=!1}if(!a){var i=new e(8);t.exports=function(e){return i.writeDoubleLE(e,0,!0),[i.readUInt32LE(0,!0),i.readUInt32LE(4,!0)]},t.exports.pack=function(e,t){return i.writeUInt32LE(e,0,!0),i.writeUInt32LE(t,4,!0),i.readDoubleLE(0,!0)},t.exports.lo=function(e){return i.writeDoubleLE(e,0,!0),i.readUInt32LE(0,!0)},t.exports.hi=function(e){return i.writeDoubleLE(e,0,!0),i.readUInt32LE(4,!0)}}t.exports.sign=function(e){return t.exports.hi(e)>>>31},t.exports.exponent=function(e){var a=t.exports.hi(e);return(a<<1>>>21)-1023},t.exports.fraction=function(e){var a=t.exports.lo(e),r=t.exports.hi(e),o=1048575&r;return 2146435072&r&&(o+=1048576),[a,o]},t.exports.denormalized=function(e){var a=t.exports.hi(e);return!(2146435072&a)}}).call(this,e("buffer").Buffer)},{buffer:105}],168:[function(e,t){var a=e("abs-svg-path"),r=e("normalize-svg-path"),o={M:"moveTo",C:"bezierCurveTo"};t.exports=function(e,t){e.beginPath(),r(a(t)).forEach(function(t){var a=t[0],r=t.slice(1);e[o[a]].apply(e,r)}),e.closePath()}},{"abs-svg-path":60,"normalize-svg-path":452}],169:[function(e,t){t.exports=function(e){return"int8"===e?Int8Array:"int16"===e?Int16Array:"int32"===e?Int32Array:"uint8"===e?Uint8Array:"uint16"===e?Uint16Array:"uint32"===e?Uint32Array:"float32"===e?Float32Array:"float64"===e?Float64Array:"array"===e?Array:"uint8_clamped"===e?Uint8ClampedArray:void 0}},{}],170:[function(e,t){"use strict";function a(e,t,r){var o=0|e[r];if(0>=o)return[];var i=Array(o),n;if(r===e.length-1)for(n=0;n<o;++n)i[n]=t;else for(n=0;n<o;++n)i[n]=a(e,t,r+1);return i}function r(e,t){var a,r;for(a=Array(e),r=0;r<e;++r)a[r]=t;return a}t.exports=function(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(0<e)return r(0|e,t);break;case"object":if("number"==typeof e.length)return a(e,t,0);}return[]}},{}],171:[function(e,t){"use strict";t.exports=function(t,r){var o=t.length;if("number"!=typeof r){r=0;for(var n=0,l;n<o;++n)l=t[n],r=va(r,l[0],l[1]);r=(0|r)+1}r|=0;for(var s=Array(r),n=0;n<r;++n)s[n]=[];for(var n=0,l;n<o;++n)l=t[n],s[l[0]].push(l[1]),s[l[1]].push(l[0]);for(var d=0;d<r;++d)a(s[d],function(e,t){return e-t});return s};var a=e("uniq")},{uniq:547}],172:[function(e,t){var a=e("strongly-connected-components");t.exports=function(e){function t(e){g[e]=!1,h.hasOwnProperty(e)&&Object.keys(h[e]).forEach(function(a){delete h[e][a],g[a]&&t(a)})}function r(e){var a=!1;u.push(e),g[e]=!0;var n,l;for(n=0;n<m[e].length;n++)l=m[e][n],l===y?(o(y,u),a=!0):!g[l]&&(a=r(l));if(a)t(e);else for(n=0;n<m[e].length;n++){l=m[e][n];var s=h[l];s||(s={},h[l]=s),s[l]=!0}return u.pop(),a}function o(e,t){var a=[].concat(t).concat(e);c.push(a)}function l(t){for(var a=0;a<e.length;a++)a<t&&(e[a]=[]),e[a]=e[a].filter(function(e){return e>=t})}function d(t){l(t);for(var r=a(e),o=r.components.filter(function(e){return 1<e.length}),n=1/0,s=0,d;s<o.length;s++)for(var c=0;c<o[s].length;c++)o[s][c]<n&&(n=o[s][c],d=s);var p=o[d];if(!p)return!1;var u=e.map(function(e,t){return-1===p.indexOf(t)?[]:e.filter(function(e){return-1!==p.indexOf(e)})});return{leastVertex:n,adjList:u}}var c=[],u=[],g=[],h={},m=[],y;y=0;for(var f=e.length,n;y<f;)if(n=d(y),y=n.leastVertex,m=n.adjList,m){for(var x=0;x<m.length;x++)for(var _=0,b;_<m[x].length;_++)b=m[x][_],g[+b]=!1,h[b]={};r(y),++y}else y=f;return c}},{"strongly-connected-components":530}],173:[function(e,t){"use strict";var a=e("../../object/valid-value");t.exports=function(){return a(this).length=0,this}},{"../../object/valid-value":205}],174:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Array.from:e("./shim")},{"./is-implemented":175,"./shim":176}],175:[function(e,t){"use strict";t.exports=function(){var e=Array.from,t,a;return!("function"!=typeof e)&&(t=["raz","dwa"],a=e(t),!!(a&&a!==t&&"dwa"===a[1]))}},{}],176:[function(e,t){"use strict";var a=e("es6-symbol").iterator,r=e("../../function/is-arguments"),o=e("../../function/is-function"),n=e("../../number/to-pos-integer"),l=e("../../object/valid-callable"),s=e("../../object/valid-value"),d=e("../../object/is-value"),c=e("../../string/is-string"),p=Array.isArray,u=Function.prototype.call,g={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;t.exports=function(e){var t=arguments[1],m=arguments[2],y,f,x,_,b,v,k,w,T,A;if(e=Object(s(e)),d(t)&&l(t),!this||this===Array||!o(this)){if(!t){if(r(e))return(b=e.length,1!==b)?Array.apply(null,e):(_=[,],_[0]=e[0],_);if(p(e)){for(_=Array(b=e.length),f=0;f<b;++f)_[f]=e[f];return _}}_=[]}else y=this;if(!p(e))if(void 0!==(T=e[a])){for(k=l(T).call(e),y&&(_=new y),w=k.next(),f=0;!w.done;)A=t?u.call(t,m,w.value,f):w.value,y?(g.value=A,h(_,f,g)):_[f]=A,w=k.next(),++f;b=f}else if(c(e)){for(b=e.length,y&&(_=new y),(f=0,x=0);f<b;++f)A=e[f],f+1<b&&(v=A.charCodeAt(0),55296<=v&&56319>=v&&(A+=e[++f])),A=t?u.call(t,m,A,x):A,y?(g.value=A,h(_,x,g)):_[x]=A,++x;b=x}if(void 0===b)for(b=n(e.length),y&&(_=new y(b)),f=0;f<b;++f)A=t?u.call(t,m,e[f],f):e[f],y?(g.value=A,h(_,f,g)):_[f]=A;return y&&(g.value=null,_.length=b),_}},{"../../function/is-arguments":177,"../../function/is-function":178,"../../number/to-pos-integer":184,"../../object/is-value":194,"../../object/valid-callable":203,"../../object/valid-value":205,"../../string/is-string":209,"es6-symbol":219}],177:[function(e,t){"use strict";var a=Object.prototype.toString,r=a.call(function(){return arguments}());t.exports=function(e){return a.call(e)===r}},{}],178:[function(e,t){"use strict";var a=Object.prototype.toString,r=a.call(e("./noop"));t.exports=function(e){return"function"==typeof e&&a.call(e)===r}},{"./noop":179}],179:[function(e,t){"use strict";t.exports=function(){}},{}],180:[function(e,a){"use strict";a.exports=e("./is-implemented")()?t:e("./shim")},{"./is-implemented":181,"./shim":182}],181:[function(e,a){"use strict";a.exports=function(){var e=t;return!("function"!=typeof e)&&1===e(10)&&-1===e(-20)}},{}],182:[function(e,t){"use strict";t.exports=function(e){return e=+e,isNaN(e)||0===e?e:0<e?1:-1}},{}],183:[function(e,t){"use strict";var a=e("../math/sign");t.exports=function(e){return isNaN(e)?0:(e=+e,0!==e&&isFinite(e)?a(e)*ba(_a(e)):e)}},{"../math/sign":180}],184:[function(e,t){"use strict";var a=e("./to-integer");t.exports=function(e){return va(0,a(e))}},{"./to-integer":183}],185:[function(e,t){"use strict";var a=e("./valid-callable"),r=e("./valid-value"),o=Function.prototype.bind,i=Function.prototype.call,n=Object.keys,l=Object.prototype.propertyIsEnumerable;t.exports=function(e,t){return function(s,d){var c=arguments[2],p=arguments[3],u;return s=Object(r(s)),a(d),u=n(s),p&&u.sort("function"==typeof p?o.call(p,s):void 0),"function"!=typeof e&&(e=u[e]),i.call(e,u,function(e,a){return l.call(s,e)?i.call(d,c,s[e],e,s,a):t})}}},{"./valid-callable":203,"./valid-value":205}],186:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":187,"./shim":188}],187:[function(e,t){"use strict";t.exports=function(){var e=Object.assign,t;return!("function"!=typeof e)&&(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),"razdwatrzy"===t.foo+t.bar+t.trzy)}},{}],188:[function(e,t){"use strict";var a=e("../keys"),r=e("../valid-value");t.exports=function(e,t){var o=va(arguments.length,2),n,l,s;for(e=Object(r(e)),s=function(a){try{e[a]=t[a]}catch(t){n||(n=t)}},l=1;l<o;++l)t=arguments[l],a(t).forEach(s);if(n!==void 0)throw n;return e}},{"../keys":195,"../valid-value":205}],189:[function(e,t){"use strict";var a=e("../array/from"),r=e("./assign"),o=e("./valid-value");t.exports=function(e){var t=Object(o(e)),i=arguments[1],n=Object(arguments[2]);if(t!==e&&!i)return t;var l={};return i?a(i,function(t){(n.ensure||t in e)&&(l[t]=e[t])}):r(l,e),l}},{"../array/from":174,"./assign":186,"./valid-value":205}],190:[function(e,t){"use strict";var a=Object.create,r;e("./set-prototype-of/is-implemented")()||(r=e("./set-prototype-of/shim")),t.exports=function(){var e,t,o;return r?1===r.level?(e={},t={},o={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){return"__proto__"===e?void(t[e]={configurable:!0,enumerable:!1,writable:!0,value:void 0}):void(t[e]=o)}),Object.defineProperties(e,t),Object.defineProperty(r,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(t,r){return a(null===t?e:t,r)}):a:a}()},{"./set-prototype-of/is-implemented":201,"./set-prototype-of/shim":202}],191:[function(e,t){"use strict";t.exports=e("./_iterate")("forEach")},{"./_iterate":185}],192:[function(e,t){"use strict";t.exports=function(e){return"function"==typeof e}},{}],193:[function(e,t){"use strict";var a=e("./is-value"),r={function:!0,object:!0};t.exports=function(e){return a(e)&&r[typeof e]||!1}},{"./is-value":194}],194:[function(e,t){"use strict";var a=e("../function/noop")();t.exports=function(e){return e!==a&&null!==e}},{"../function/noop":179}],195:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":196,"./shim":197}],196:[function(e,t){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],197:[function(e,t){"use strict";var a=e("../is-value"),r=Object.keys;t.exports=function(e){return r(a(e)?Object(e):e)}},{"../is-value":194}],198:[function(e,t){"use strict";var a=e("./valid-callable"),r=e("./for-each"),o=Function.prototype.call;t.exports=function(e,t){var i={},n=arguments[2];return a(t),r(e,function(e,a,r,l){i[a]=o.call(t,n,e,a,r,l)}),i}},{"./for-each":191,"./valid-callable":203}],199:[function(e,t){"use strict";var a=e("./is-value"),r=Array.prototype.forEach,o=Object.create,i=function(e,t){for(var a in e)t[a]=e[a]};t.exports=function(){var e=o(null);return r.call(arguments,function(t){a(t)&&i(Object(t),e)}),e}},{"./is-value":194}],200:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.setPrototypeOf:e("./shim")},{"./is-implemented":201,"./shim":202}],201:[function(e,t){"use strict";var a=Object.create,r=Object.getPrototypeOf,o={};t.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||a;return!("function"!=typeof e)&&r(e(t(null),o))===o}},{}],202:[function(e,t){"use strict";var a=e("../is-object"),r=e("../valid-value"),o=Object.prototype.isPrototypeOf,i=Object.defineProperty,n={configurable:!0,enumerable:!1,writable:!0,value:void 0},l;l=function(e,t){if(r(e),null===t||a(t))return e;throw new TypeError("Prototype must be null or an object")},t.exports=function(e){var t,a;return e?(2===e.level?e.set?(a=e.set,t=function(e,t){return a.call(l(e,t),t),e}):t=function(e,t){return l(e,t).__proto__=t,e}:t=function e(t,a){var r;return l(t,a),r=o.call(e.nullPolyfill,t),r&&delete e.nullPolyfill.__proto__,null===a&&(a=e.nullPolyfill),t.__proto__=a,r&&i(e.nullPolyfill,"__proto__",n),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e=Object.create(null),t={},a=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__"),r;if(a){try{r=a.set,r.call(e,t)}catch(e){}if(Object.getPrototypeOf(e)===t)return{set:r,level:2}}return(e.__proto__=t,Object.getPrototypeOf(e)===t)?{level:2}:(e={},e.__proto__=t,Object.getPrototypeOf(e)===t&&{level:1})}()),e("../create")},{"../create":190,"../is-object":193,"../valid-value":205}],203:[function(e,t){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],204:[function(e,t){"use strict";var a=e("./is-object");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not an Object");return e}},{"./is-object":193}],205:[function(e,t){"use strict";var a=e("./is-value");t.exports=function(e){if(!a(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":194}],206:[function(t,a){"use strict";a.exports=t("./is-implemented")()?e.contains:t("./shim")},{"./is-implemented":207,"./shim":208}],207:[function(e,t){"use strict";t.exports=function(){return!1}},{}],208:[function(t,a){"use strict";var r=e.indexOf;a.exports=function(e){return-1<r.call(this,e,arguments[1])}},{}],209:[function(e,t){"use strict";var a=Object.prototype.toString,r=a.call("");t.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||a.call(e)===r)||!1}},{}],210:[function(e,t){"use strict";var a=Object.create(null),r=Math.random;t.exports=function(){var e;do e=r().toString(36).slice(2);while(a[e]);return e}},{}],211:[function(e,t){"use strict";var a=e("es5-ext/object/set-prototype-of"),r=e("es5-ext/string/#/contains"),o=e("d"),i=e("es6-symbol"),n=e("./"),l=Object.defineProperty,s;s=t.exports=function(e,t){if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");n.call(this,e),t=t?r.call(t,"key+value")?"key+value":r.call(t,"key")?"key":"value":"value",l(this,"__kind__",o("",t))},a&&a(s,n),delete s.prototype.constructor,s.prototype=Object.create(n.prototype,{_resolve:o(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),l(s.prototype,i.toStringTag,o("c","Array Iterator"))},{"./":214,d:151,"es5-ext/object/set-prototype-of":200,"es5-ext/string/#/contains":206,"es6-symbol":219}],212:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),r=e("es5-ext/object/valid-callable"),o=e("es5-ext/string/is-string"),n=e("./get"),l=Array.isArray,s=Function.prototype.call,d=Array.prototype.some;t.exports=function(e,t){var c=arguments[2],p,u,g,h,m,y,f,x;if(l(e)||a(e)?p="array":o(e)?p="string":e=n(e),r(t),g=function(){h=!0},"array"===p)return void d.call(e,function(e){return s.call(t,c,e,g),h});if("string"===p){for(y=e.length,m=0;m<y&&(f=e[m],m+1<y&&(x=f.charCodeAt(0),55296<=x&&56319>=x&&(f+=e[++m])),s.call(t,c,f,g),!h);++m);return}for(u=e.next();!u.done;){if(s.call(t,c,u.value,g),h)return;u=e.next()}}},{"./get":213,"es5-ext/function/is-arguments":177,"es5-ext/object/valid-callable":203,"es5-ext/string/is-string":209}],213:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),r=e("es5-ext/string/is-string"),o=e("./array"),i=e("./string"),n=e("./valid-iterable"),l=e("es6-symbol").iterator;t.exports=function(e){return"function"==typeof n(e)[l]?e[l]():a(e)?new o(e):r(e)?new i(e):new o(e)}},{"./array":211,"./string":216,"./valid-iterable":217,"es5-ext/function/is-arguments":177,"es5-ext/string/is-string":209,"es6-symbol":219}],214:[function(e,t){"use strict";var a=e("es5-ext/array/#/clear"),r=e("es5-ext/object/assign"),o=e("es5-ext/object/valid-callable"),i=e("es5-ext/object/valid-value"),n=e("d"),l=e("d/auto-bind"),s=e("es6-symbol"),d=Object.defineProperty,c=Object.defineProperties,p;t.exports=p=function(e,t){if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");c(this,{__list__:n("w",i(e)),__context__:n("w",t),__nextIndex__:n("w",0)});t&&(o(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete p.prototype.constructor,c(p.prototype,r({_next:n(function(){var e;if(this.__list__){if(this.__redo__&&(e=this.__redo__.shift(),void 0!==e))return e;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:n(function(){return this._createResult(this._next())}),_createResult:n(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:n(function(e){return this.__list__[e]}),_unBind:n(function(){this.__list__=null,delete this.__redo__;this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:n(function(){return"[object "+(this[s.toStringTag]||"Object")+"]"})},l({_onAdd:n(function(e){if(!(e>=this.__nextIndex__))return++this.__nextIndex__,this.__redo__?void(this.__redo__.forEach(function(t,a){t>=e&&(this.__redo__[a]=++t)},this),this.__redo__.push(e)):void d(this,"__redo__",n("c",[e]))}),_onDelete:n(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(t=this.__redo__.indexOf(e),-1!==t&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,a){t>e&&(this.__redo__[a]=--t)},this)))}),_onClear:n(function(){this.__redo__&&a.call(this.__redo__),this.__nextIndex__=0})}))),d(p.prototype,s.iterator,n(function(){return this}))},{d:151,"d/auto-bind":150,"es5-ext/array/#/clear":173,"es5-ext/object/assign":186,"es5-ext/object/valid-callable":203,"es5-ext/object/valid-value":205,"es6-symbol":219}],215:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),r=e("es5-ext/object/is-value"),o=e("es5-ext/string/is-string"),i=e("es6-symbol").iterator,n=Array.isArray;t.exports=function(e){return!!r(e)&&(!!n(e)||!!o(e)||!!a(e)||"function"==typeof e[i])}},{"es5-ext/function/is-arguments":177,"es5-ext/object/is-value":194,"es5-ext/string/is-string":209,"es6-symbol":219}],216:[function(e,t){"use strict";var a=e("es5-ext/object/set-prototype-of"),r=e("d"),o=e("es6-symbol"),i=e("./"),n=Object.defineProperty,l;l=t.exports=function(e){if(!(this instanceof l))throw new TypeError("Constructor requires 'new'");e=e+"",i.call(this,e),n(this,"__length__",r("",e.length))},a&&a(l,i),delete l.prototype.constructor,l.prototype=Object.create(i.prototype,{_next:r(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:r(function(e){var t=this.__list__[e],a;return this.__nextIndex__===this.__length__?t:(a=t.charCodeAt(0),55296<=a&&56319>=a?t+this.__list__[this.__nextIndex__++]:t)})}),n(l.prototype,o.toStringTag,r("c","String Iterator"))},{"./":214,d:151,"es5-ext/object/set-prototype-of":200,"es6-symbol":219}],217:[function(e,t){"use strict";var a=e("./is-iterable");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not iterable");return e}},{"./is-iterable":215}],218:[function(e,t,a){(function(r,o){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   3.3.1
 */(function(e,r){"object"==typeof a&&"undefined"!=typeof t?t.exports=r():"function"==typeof ka&&ka.amd?ka(r):e.ES6Promise=r()})(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function a(e){return"function"==typeof e}function i(){return function(){N(l)}}function n(){var e=setTimeout;return function(){return e(l,1)}}function l(){for(var e=0;e<B;e+=2){var t=X[e],a=X[e+1];t(a),X[e]=void 0,X[e+1]=void 0}B=0}function s(e,t){var a=arguments,r=this,o=new this.constructor(p);void 0===o[K]&&I(o);var i=r._state;return i?function(){var e=a[i-1];U(function(){return C(i,o,e,r._result)})}():w(r,o,e,t),o}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var a=new t(p);return _(a,e),a}function p(){}function u(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function h(e){try{return e.then}catch(e){return $.error=e,$}}function m(e,t,a,r){try{e.call(t,a,r)}catch(t){return t}}function y(e,t,a){U(function(e){var r=!1,o=m(a,t,function(a){r||(r=!0,t===a?v(e,a):_(e,a))},function(t){r||(r=!0,k(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,k(e,o))},e)}function f(e,t){1===t._state?v(e,t._result):2===t._state?k(e,t._result):w(t,void 0,function(t){return _(e,t)},function(t){return k(e,t)})}function x(e,t,r){t.constructor===e.constructor&&r===s&&t.constructor.resolve===d?f(e,t):r===$?k(e,$.error):void 0===r?v(e,t):a(r)?y(e,t,r):v(e,t)}function _(e,a){e===a?k(e,u()):t(a)?x(e,a,h(a)):v(e,a)}function b(e){e._onerror&&e._onerror(e._result),T(e)}function v(e,t){void 0!==e._state||(e._result=t,e._state=1,0!==e._subscribers.length&&U(T,e))}function k(e,t){void 0!==e._state||(e._state=2,e._result=t,U(b,e))}function w(e,t,a,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+1]=a,o[i+2]=r,0===i&&e._state&&U(T,e)}function T(e){var t=e._subscribers,a=e._state;if(0!==t.length){for(var r=void 0,o=void 0,n=e._result,l=0;l<t.length;l+=3)r=t[l],o=t[l+a],r?C(a,r,o,n):o(n);e._subscribers.length=0}}function A(){this.error=null}function S(e,t){try{return e(t)}catch(t){return ee.error=t,ee}}function C(e,t,r,o){var i=a(r),n,l,s,d;if(!i)n=o,s=!0;else if(n=S(r,o),n===ee?(d=!0,l=n.error,n=null):s=!0,t===n)return void k(t,g());void 0!==t._state||(i&&s?_(t,n):d?k(t,l):1===e?v(t,n):2===e&&k(t,n))}function L(t,a){try{a(function(e){_(t,e)},function(e){k(t,e)})}catch(a){k(t,a)}}function E(){return te++}function I(e){e[K]=te++,e._state=void 0,e._result=void 0,e._subscribers=[]}function z(e,t){this._instanceConstructor=e,this.promise=new e(p),this.promise[K]||I(this.promise),F(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=Array(this.length),0===this.length?v(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&v(this.promise,this._result))):k(this.promise,P())}function P(){return new Error("Array Methods must be provided an Array")}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function O(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(e){this[K]=E(),this._result=this._state=void 0,this._subscribers=[],p!==e&&("function"!=typeof e&&D(),this instanceof R?L(this,e):O())}function M(){var e;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var a=null;try{a=Object.prototype.toString.call(t.resolve())}catch(t){}if("[object Promise]"===a&&!t.cast)return}e.Promise=R}var j=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var F=j,B=0,N=void 0,V=void 0,U=function(e,t){X[B]=e,X[B+1]=t,B+=2,2===B&&(V?V(l):Z())},H="undefined"==typeof window?void 0:window,G=H||{},q=G.MutationObserver||G.WebKitMutationObserver,Y="undefined"==typeof self&&"undefined"!=typeof r&&"[object process]"==={}.toString.call(r),W="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,X=Array(1e3),Z=void 0;Z=Y?function(){return function(){return r.nextTick(l)}}():q?function(){var e=0,t=new q(l),a=document.createTextNode("");return t.observe(a,{characterData:!0}),function(){a.data=e=++e%2}}():W?function(){var e=new MessageChannel;return e.port1.onmessage=l,function(){return e.port2.postMessage(0)}}():void 0===H&&"function"==typeof e?function(){try{var t=e("vertx");return N=t.runOnLoop||t.runOnContext,i()}catch(t){return n()}}():n();var K=Math.random().toString(36).substring(16),J=void 0,Q=2,$=new A,ee=new A,te=0;return z.prototype._enumerate=function(){for(var e=this.length,t=this._input,a=0;this._state===J&&a<e;a++)this._eachEntry(t[a],a)},z.prototype._eachEntry=function(e,t){var a=this._instanceConstructor,r=a.resolve;if(r===d){var o=h(e);if(o===s&&e._state!==J)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(a===R){var i=new a(p);x(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new a(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},z.prototype._settledAt=function(e,t,a){var r=this.promise;r._state===J&&(this._remaining--,e===Q?k(r,a):this._result[t]=a),0===this._remaining&&v(r,this._result)},z.prototype._willSettleAt=function(e,t){var a=this;w(e,void 0,function(e){return a._settledAt(1,t,e)},function(e){return a._settledAt(Q,t,e)})},R.all=function(e){return new z(this,e).promise},R.race=function(e){var t=this;return F(e)?new t(function(a,r){for(var o=e.length,n=0;n<o;n++)t.resolve(e[n]).then(a,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},R.resolve=d,R.reject=function(e){var t=this,a=new t(p);return k(a,e),a},R._setScheduler=function(e){V=e},R._setAsap=function(e){U=e},R._asap=U,R.prototype={constructor:R,then:s,catch:function(e){return this.then(null,e)}},M(),R.polyfill=M,R.Promise=R,R})}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{_process:482}],219:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Symbol:e("./polyfill")},{"./is-implemented":220,"./polyfill":222}],220:[function(e,t){"use strict";var a={object:!0,symbol:!0};t.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{}catch(t){return!1}return!!a[typeof Symbol.iterator]&&!!a[typeof Symbol.toPrimitive]&&!!a[typeof Symbol.toStringTag]}},{}],221:[function(e,t){"use strict";t.exports=function(e){return!!e&&(!("symbol"!=typeof e)||!!e.constructor&&!("Symbol"!==e.constructor.name)&&"Symbol"===e[e.constructor.toStringTag])}},{}],222:[function(e,t){"use strict";var a=e("d"),r=e("./validate-symbol"),o=Object.create,i=Object.defineProperties,n=Object.defineProperty,l=Object.prototype,d=o(null),c,p,u,g;if("function"==typeof Symbol){c=Symbol;try{c()+"",g=!0}catch(e){}}var h=function(){var e=o(null);return function(t){for(var r=0,o,i;e[t+(r||"")];)++r;return t+=r||"",e[t]=!0,o="@@"+t,n(l,o,a.gs(null,function(e){i||(i=!0,n(this,o,a(e)),i=!1)})),o}}();u=function(e){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return p(e)},t.exports=p=function e(t){var r;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return g?c(t):(r=o(u.prototype),t=void 0===t?"":t+"",i(r,{__description__:a("",t),__name__:a("",h(t))}))},i(p,{for:a(function(e){return d[e]?d[e]:d[e]=p(e+"")}),keyFor:a(function(e){for(var t in r(e),d)if(d[t]===e)return t}),hasInstance:a("",c&&c.hasInstance||p("hasInstance")),isConcatSpreadable:a("",c&&c.isConcatSpreadable||p("isConcatSpreadable")),iterator:a("",c&&c.iterator||p("iterator")),match:a("",c&&c.match||p("match")),replace:a("",c&&c.replace||p("replace")),search:a("",c&&c.search||p("search")),species:a("",c&&c.species||p("species")),split:a("",c&&c.split||p("split")),toPrimitive:a("",c&&c.toPrimitive||p("toPrimitive")),toStringTag:a("",c&&c.toStringTag||p("toStringTag")),unscopables:a("",c&&c.unscopables||p("unscopables"))}),i(u.prototype,{constructor:a(p),toString:a("",function(){return this.__name__})}),i(p.prototype,{toString:a(function(){return"Symbol ("+r(this).__description__+")"}),valueOf:a(function(){return r(this)})}),n(p.prototype,p.toPrimitive,a("",function(){var e=r(this);return"symbol"==typeof e?e:e.toString()})),n(p.prototype,p.toStringTag,a("c","Symbol")),n(u.prototype,p.toStringTag,a("c",p.prototype[p.toStringTag])),n(u.prototype,p.toPrimitive,a("c",p.prototype[p.toPrimitive]))},{"./validate-symbol":223,d:151}],223:[function(e,t){"use strict";var a=e("./is-symbol");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not a symbol");return e}},{"./is-symbol":221}],224:[function(e,t){"use strict";t.exports=function(e,t,a){var r=t||0,o=a||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[r*e[12]+e[8],r*e[13]+e[9],r*e[14]+e[10],r*e[15]+e[11]],[o*e[12]-e[8],o*e[13]-e[9],o*e[14]-e[10],o*e[15]-e[11]]]}},{}],225:[function(e,t){"use strict";var a=e("is-string-blank");t.exports=function(e){var t=typeof e;if("string"==t){var r=e;if(e=+e,0===e&&a(r))return!1}else if("number"!=t)return!1;return 1>e-e}},{"is-string-blank":423}],226:[function(e,t){"use strict";function a(e,t,a){return ea(t,va(e,a))}function r(e,t,a){this.dimension=e.length,this.bounds=[Array(this.dimension),Array(this.dimension)];for(var r=0;r<this.dimension;++r)this.bounds[0][r]=-Infinity,this.bounds[1][r]=1/0;this._state=e.slice().reverse(),this._velocity=t.slice().reverse(),this._time=[a],this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}function o(e){for(var t=Array(e),a=0;a<e;++a)t[a]=0;return t}t.exports=function(e,t,a){switch(arguments.length){case 0:return new r([0],[0],0);case 1:if("number"==typeof e){var i=o(e);return new r(i,i,0)}return new r(e,o(e.length),0);case 2:if("number"==typeof t){var i=o(e.length);return new r(e,i,+t)}a=0;case 3:if(e.length!==t.length)throw new Error("state and velocity lengths must match");return new r(e,t,a);}};var n=e("cubic-hermite"),l=e("binary-search-bounds"),s=r.prototype;s.flush=function(e){var t=l.gt(this._time,e)-1;0>=t||(this._time.splice(0,t),this._state.splice(0,t*this.dimension),this._velocity.splice(0,t*this.dimension))},s.curve=function(e){var t=this._time,r=t.length,o=l.le(t,e),s=this._scratch[0],c=this._state,p=this._velocity,u=this.dimension,d=this.bounds;if(0>o)for(var g=u-1,h=0;h<u;++h,--g)s[h]=c[g];else if(o>=r-1)for(var g=c.length-1,m=e-t[r-1],h=0;h<u;++h,--g)s[h]=c[g]+m*p[g];else{for(var g=u*(o+1)-1,y=t[o],f=t[o+1],x=f-y||1,_=this._scratch[1],b=this._scratch[2],v=this._scratch[3],k=this._scratch[4],w=!0,h=0;h<u;++h,--g)_[h]=c[g],v[h]=p[g]*x,b[h]=c[g+u],k[h]=p[g+u]*x,w=w&&_[h]===b[h]&&v[h]===k[h]&&0===v[h];if(w)for(var h=0;h<u;++h)s[h]=_[h];else n(_,v,b,k,(e-y)/x,s)}for(var T=d[0],A=d[1],h=0;h<u;++h)s[h]=a(T[h],A[h],s[h]);return s},s.dcurve=function(e){var t=this._time,a=t.length,r=l.le(t,e),o=this._scratch[0],s=this._state,c=this._velocity,p=this.dimension;if(r>=a-1)for(var d=s.length-1,u=e-t[a-1],g=0;g<p;++g,--d)o[g]=c[d];else{for(var d=p*(r+1)-1,h=t[r],m=t[r+1],y=m-h||1,f=this._scratch[1],x=this._scratch[2],_=this._scratch[3],b=this._scratch[4],v=!0,g=0;g<p;++g,--d)f[g]=s[d],_[g]=c[d]*y,x[g]=s[d+p],b[g]=c[d+p]*y,v=v&&f[g]===x[g]&&_[g]===b[g]&&0===_[g];if(v)for(var g=0;g<p;++g)o[g]=0;else{n.derivative(f,_,x,b,(e-h)/y,o);for(var g=0;g<p;++g)o[g]/=y}}return o},s.lastT=function(){var e=this._time;return e[e.length-1]},s.stable=function(){for(var e=this._velocity,t=e.length,a=this.dimension-1;0<=a;--a)if(e[--t])return!1;return!0},s.jump=function(e){var t=this.lastT(),r=this.dimension;if(!(e<t||arguments.length!==r+1)){var o=this._state,n=this._velocity,l=o.length-this.dimension,s=this.bounds,d=s[0],c=s[1];this._time.push(t,e);for(var p=0;2>p;++p)for(var u=0;u<r;++u)o.push(o[l++]),n.push(0);this._time.push(e);for(var u=r;0<u;--u)o.push(a(d[u-1],c[u-1],arguments[u])),n.push(0)}},s.push=function(e){var t=this.lastT(),r=this.dimension;if(!(e<t||arguments.length!==r+1)){var o=this._state,n=this._velocity,l=o.length-this.dimension,s=e-t,d=this.bounds,c=d[0],p=d[1],u=1e-6<s?1/s:0;this._time.push(e);for(var g=r,h;0<g;--g)h=a(c[g-1],p[g-1],arguments[g]),o.push(h),n.push((h-o[l++])*u)}},s.set=function(e){var t=this.dimension;if(!(e<this.lastT()||arguments.length!==t+1)){var r=this._state,o=this._velocity,n=this.bounds,l=n[0],s=n[1];this._time.push(e);for(var d=t;0<d;--d)r.push(a(l[d-1],s[d-1],arguments[d])),o.push(0)}},s.move=function(e){var t=this.lastT(),r=this.dimension;if(!(e<=t||arguments.length!==r+1)){var o=this._state,n=this._velocity,l=o.length-this.dimension,s=this.bounds,d=s[0],c=s[1],p=e-t,u=1e-6<p?1/p:0;this._time.push(e);for(var g=r,h;0<g;--g)h=arguments[g],o.push(a(d[g-1],c[g-1],o[l++]+h)),n.push(h*u)}},s.idle=function(e){var t=this.lastT();if(!(e<t)){var r=this.dimension,o=this._state,n=this._velocity,l=o.length-r,s=this.bounds,d=s[0],c=s[1];this._time.push(e);for(var p=r-1;0<=p;--p)o.push(a(d[p],c[p],o[l]+(e-t)*n[l])),n.push(0),l+=1}}},{"binary-search-bounds":91,"cubic-hermite":145}],227:[function(e,t){var a=e("dtype");t.exports=function(e,t,r){if(!e)throw new TypeError("must specify data as first parameter");if(r=0|+(r||0),Array.isArray(e)&&e[0]&&"number"==typeof e[0][0]){var o=e[0].length,n=e.length*o,s,d,c,p;t&&"string"!=typeof t||(t=new(a(t||"float32"))(n+r));var u=t.length-r;if(n!==u)throw new Error("source length "+n+" ("+o+"x"+e.length+") does not match destination length "+u);for(s=0,c=r;s<e.length;s++)for(d=0;d<o;d++)t[c++]=null===e[s][d]?NaN:e[s][d]}else if(!t||"string"==typeof t){var g=a(t||"float32");if(Array.isArray(e)||"array"===t)for(t=new g(e.length+r),s=0,c=r,p=t.length;c<p;c++,s++)t[c]=null===e[s]?NaN:e[s];else 0===r?t=new g(e):(t=new g(e.length+r),t.set(e,r))}else t.set(e,r);return t}},{dtype:169}],228:[function(e,t){"use strict";var a=e("css-font/stringify"),r=[32,126];t.exports=function(e){e=e||{};var t=e.shape?e.shape:e.canvas?[e.canvas.width,e.canvas.height]:[512,512],o=e.canvas||document.createElement("canvas"),n=e.font,l="number"==typeof e.step?[e.step,e.step]:e.step||[32,32],s=e.chars||r;if(n&&"string"!=typeof n&&(n=a(n)),!Array.isArray(s))s=(s+"").split("");else if(2===s.length&&"number"==typeof s[0]&&"number"==typeof s[1]){for(var d=[],c=s[0],p=0;c<=s[1];c++)d[p++]=D(c);s=d}t=t.slice(),o.width=t[0],o.height=t[1];var u=o.getContext("2d");u.fillStyle="#000",u.fillRect(0,0,o.width,o.height),u.font=n,u.textAlign="center",u.textBaseline="middle",u.fillStyle="#fff";for(var g=l[0]/2,h=l[1]/2,c=0;c<s.length;c++)u.fillText(s[c],g,h),(g+=l[0])>t[0]-l[0]/2&&(g=l[0]/2,h+=l[1]);return o}},{"css-font/stringify":142}],229:[function(e,t){"use strict";function a(e,t){t||(t={}),("string"==typeof e||Array.isArray(e))&&(t.family=e);var s=Array.isArray(t.family)?t.family.join(", "):t.family;if(!s)throw Error("`family` must be defined");var d=t.size||t.fontSize||t.em||48,c=t.weight||t.fontWeight||"",p=t.style||t.fontStyle||"",e=[p,c,d].join(" ")+"px "+s,u=t.origin||"top";if(a.cache[s]&&d<=a.cache[s].em)return r(a.cache[s],u);var g=t.canvas||a.canvas,h=g.getContext("2d"),m={upper:void 0===t.upper?"H":t.upper,lower:void 0===t.lower?"x":t.lower,descent:void 0===t.descent?"p":t.descent,ascent:void 0===t.ascent?"h":t.ascent,tittle:void 0===t.tittle?"i":t.tittle,overshoot:void 0===t.overshoot?"O":t.overshoot},y=M(1.5*d);g.height=y,g.width=.5*y,h.font=e;var l={top:0};h.clearRect(0,0,y,y),h.textBaseline="top",h.fillStyle="black",h.fillText("H",0,0);var f=i(h.getImageData(0,0,y,y));h.clearRect(0,0,y,y),h.textBaseline="bottom",h.fillText("H",0,y);var x=i(h.getImageData(0,0,y,y));l.lineHeight=l.bottom=y-x+f,h.clearRect(0,0,y,y),h.textBaseline="alphabetic",h.fillText("H",0,y);var _=i(h.getImageData(0,0,y,y)),b=y-_-1+f;l.baseline=l.alphabetic=b,h.clearRect(0,0,y,y),h.textBaseline="middle",h.fillText("H",0,.5*y);var v=i(h.getImageData(0,0,y,y));l.median=l.middle=y-v-1+f-.5*y,h.clearRect(0,0,y,y),h.textBaseline="hanging",h.fillText("H",0,.5*y);var k=i(h.getImageData(0,0,y,y));l.hanging=y-k-1+f-.5*y,h.clearRect(0,0,y,y),h.textBaseline="ideographic",h.fillText("H",0,y);var w=i(h.getImageData(0,0,y,y));if(l.ideographic=y-w-1+f,m.upper&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.upper,0,0),l.upper=i(h.getImageData(0,0,y,y)),l.capHeight=l.baseline-l.upper),m.lower&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.lower,0,0),l.lower=i(h.getImageData(0,0,y,y)),l.xHeight=l.baseline-l.lower),m.tittle&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.tittle,0,0),l.tittle=i(h.getImageData(0,0,y,y))),m.ascent&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.ascent,0,0),l.ascent=i(h.getImageData(0,0,y,y))),m.descent&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.descent,0,0),l.descent=n(h.getImageData(0,0,y,y))),m.overshoot){h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.overshoot,0,0);var T=n(h.getImageData(0,0,y,y));l.overshoot=T-b}for(var A in l)l[A]/=d;return l.em=d,a.cache[s]=l,r(l,u)}function r(e,t){var a={};for(var r in"string"==typeof t&&(t=e[t]),e)"em"!=r&&(a[r]=e[r]-t);return a}function i(e){for(var t=e.height,a=e.data,r=3;r<a.length;r+=4)if(0!==a[r])return ba(.25*(r-3)/t)}function n(e){for(var t=e.height,a=e.data,r=a.length-1;0<r;r-=4)if(0!==a[r])return ba(.25*(r-3)/t)}t.exports=a,a.canvas=document.createElement("canvas"),a.cache={}},{}],230:[function(e,t){"use strict";function a(e,t,a,r,o,i){this._color=e,this.key=t,this.value=a,this.left=r,this.right=o,this._count=i}function r(e){return new a(e._color,e.key,e.value,e.left,e.right,e._count)}function o(e,t){return new a(e,t.key,t.value,t.left,t.right,t._count)}function l(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function c(e,t){this._compare=e,this.root=t}function p(e,t){if(t.left){var a=p(e,t.left);if(a)return a}var a=e(t.key,t.value);return a?a:t.right?p(e,t.right):void 0}function u(e,t,a,r){var o=t(e,r.key);if(0>=o){if(r.left){var i=u(e,t,a,r.left);if(i)return i}var i=a(r.key,r.value);if(i)return i}return r.right?u(e,t,a,r.right):void 0}function g(e,t,a,r,o){var i=a(e,o.key),n=a(t,o.key),l;if(0>=i){if(o.left&&(l=g(e,t,a,r,o.left),l))return l;if(0<n&&(l=r(o.key,o.value),l))return l}return 0<n&&o.right?g(e,t,a,r,o.right):void 0}function h(e,t){this.tree=e,this._stack=t}function m(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e._color=t._color,e._count=t._count}function y(e){for(var t=e.length-1,a,d,c,u;0<=t;--t){if(a=e[t],0==t)return void(a._color=1);if(d=e[t-1],d.left===a){if(c=d.right,c.right&&0===c.right._color){if(c=d.right=r(c),u=c.right=r(c.right),d.right=c.left,c.left=d,c.right=u,c._color=d._color,a._color=1,d._color=1,u._color=1,l(d),l(c),1<t){var g=e[t-2];g.left===d?g.left=c:g.right=c}return void(e[t-1]=c)}if(c.left&&0===c.left._color){if(c=d.right=r(c),u=c.left=r(c.left),d.right=u.left,c.left=u.right,u.left=d,u.right=c,u._color=d._color,d._color=1,c._color=1,a._color=1,l(d),l(c),l(u),1<t){var g=e[t-2];g.left===d?g.left=u:g.right=u}return void(e[t-1]=u)}if(1===c._color){if(0===d._color)return d._color=1,void(d.right=o(0,c));d.right=o(0,c);continue}else{if(c=r(c),d.right=c.left,c.left=d,c._color=d._color,d._color=0,l(d),l(c),1<t){var g=e[t-2];g.left===d?g.left=c:g.right=c}e[t-1]=c,e[t]=d,t+1<e.length?e[t+1]=a:e.push(a),t+=2}}else{if(c=d.left,c.left&&0===c.left._color){if(c=d.left=r(c),u=c.left=r(c.left),d.left=c.right,c.right=d,c.left=u,c._color=d._color,a._color=1,d._color=1,u._color=1,l(d),l(c),1<t){var g=e[t-2];g.right===d?g.right=c:g.left=c}return void(e[t-1]=c)}if(c.right&&0===c.right._color){if(c=d.left=r(c),u=c.right=r(c.right),d.left=u.right,c.right=u.left,u.right=d,u.left=c,u._color=d._color,d._color=1,c._color=1,a._color=1,l(d),l(c),l(u),1<t){var g=e[t-2];g.right===d?g.right=u:g.left=u}return void(e[t-1]=u)}if(1===c._color){if(0===d._color)return d._color=1,void(d.left=o(0,c));d.left=o(0,c);continue}else{if(c=r(c),d.left=c.right,c.right=d,c._color=d._color,d._color=0,l(d),l(c),1<t){var g=e[t-2];g.right===d?g.right=c:g.left=c}e[t-1]=c,e[t]=d,t+1<e.length?e[t+1]=a:e.push(a),t+=2}}}}function f(e,t){return e<t?-1:e>t?1:0}t.exports=function(e){return new c(e||f,null)};var x=1,_=c.prototype;Object.defineProperty(_,"keys",{get:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}}),Object.defineProperty(_,"values",{get:function(){var e=[];return this.forEach(function(t,a){e.push(a)}),e}}),Object.defineProperty(_,"length",{get:function(){return this.root?this.root._count:0}}),_.insert=function(e,t){for(var r=this._compare,i=this.root,u=[],g=[],h;i;)h=r(e,i.key),u.push(i),g.push(h),i=0>=h?i.left:i.right;u.push(new a(0,e,t,null,null,1));for(var m=u.length-2,i;0<=m;--m)i=u[m],u[m]=0>=g[m]?new a(i._color,i.key,i.value,u[m+1],i.right,i._count+1):new a(i._color,i.key,i.value,i.left,u[m+1],i._count+1);for(var m=u.length-1;1<m;--m){var f=u[m-1],i=u[m];if(f._color===x||i._color===x)break;var p=u[m-2];if(p.left===f){if(f.left===i){var _=p.right;if(_&&0===_._color)f._color=x,p.right=o(x,_),p._color=0,m-=1;else{if(p._color=0,p.left=f.right,f._color=x,f.right=p,u[m-2]=f,u[m-1]=i,l(p),l(f),3<=m){var b=u[m-3];b.left===p?b.left=f:b.right=f}break}}else{var _=p.right;if(_&&0===_._color)f._color=x,p.right=o(x,_),p._color=0,m-=1;else{if(f.right=i.left,p._color=0,p.left=i.right,i._color=x,i.left=f,i.right=p,u[m-2]=i,u[m-1]=f,l(p),l(f),l(i),3<=m){var b=u[m-3];b.left===p?b.left=i:b.right=i}break}}}else if(f.right===i){var _=p.left;if(_&&0===_._color)f._color=x,p.left=o(x,_),p._color=0,m-=1;else{if(p._color=0,p.right=f.left,f._color=x,f.left=p,u[m-2]=f,u[m-1]=i,l(p),l(f),3<=m){var b=u[m-3];b.right===p?b.right=f:b.left=f}break}}else{var _=p.left;if(_&&0===_._color)f._color=x,p.left=o(x,_),p._color=0,m-=1;else{if(f.left=i.right,p._color=0,p.right=i.left,i._color=x,i.right=f,i.left=p,u[m-2]=i,u[m-1]=f,l(p),l(f),l(i),3<=m){var b=u[m-3];b.right===p?b.right=i:b.left=i}break}}}return u[0]._color=x,new c(r,u[0])},_.forEach=function(e,t,a){if(this.root)switch(arguments.length){case 1:return p(e,this.root);break;case 2:return u(t,this._compare,e,this.root);break;case 3:return 0<=this._compare(t,a)?void 0:g(t,a,this._compare,e,this.root);}},Object.defineProperty(_,"begin",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.left;return new h(this,e)}}),Object.defineProperty(_,"end",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.right;return new h(this,e)}}),_.at=function(e){if(0>e)return new h(this,[]);for(var t=this.root,a=[];;){if(a.push(t),t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e)return new h(this,a);if(e-=1,t.right){if(e>=t.right._count)break;t=t.right}else break}return new h(this,[])},_.ge=function(e){for(var t=this._compare,a=this.root,r=[],o=0,i;a;)i=t(e,a.key),r.push(a),0>=i&&(o=r.length),a=0>=i?a.left:a.right;return r.length=o,new h(this,r)},_.gt=function(e){for(var t=this._compare,a=this.root,r=[],o=0,i;a;)i=t(e,a.key),r.push(a),0>i&&(o=r.length),a=0>i?a.left:a.right;return r.length=o,new h(this,r)},_.lt=function(e){for(var t=this._compare,a=this.root,r=[],o=0,i;a;)i=t(e,a.key),r.push(a),0<i&&(o=r.length),a=0>=i?a.left:a.right;return r.length=o,new h(this,r)},_.le=function(e){for(var t=this._compare,a=this.root,r=[],o=0,i;a;)i=t(e,a.key),r.push(a),0<=i&&(o=r.length),a=0>i?a.left:a.right;return r.length=o,new h(this,r)},_.find=function(e){for(var t=this._compare,a=this.root,r=[],o;a;){if(o=t(e,a.key),r.push(a),0===o)return new h(this,r);a=0>=o?a.left:a.right}return new h(this,[])},_.remove=function(e){var t=this.find(e);return t?t.remove():this},_.get=function(e){for(var t=this._compare,a=this.root;a;){var r=t(e,a.key);if(0===r)return a.value;a=0>=r?a.left:a.right}};var b=h.prototype;Object.defineProperty(b,"valid",{get:function(){return 0<this._stack.length}}),Object.defineProperty(b,"node",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1]:null},enumerable:!0}),b.clone=function(){return new h(this.tree,this._stack.slice())},b.remove=function(){var e=this._stack;if(0===e.length)return this.tree;var t=Array(e.length),r=e[e.length-1];t[t.length-1]=new a(r._color,r.key,r.value,r.left,r.right,r._count);for(var o=e.length-2,r;0<=o;--o)r=e[o],t[o]=r.left===e[o+1]?new a(r._color,r.key,r.value,t[o+1],r.right,r._count):new a(r._color,r.key,r.value,r.left,t[o+1],r._count);if(r=t[t.length-1],r.left&&r.right){var l=t.length;for(r=r.left;r.right;)t.push(r),r=r.right;var s=t[l-1];t.push(new a(r._color,s.key,s.value,r.left,r.right,r._count)),t[l-1].key=r.key,t[l-1].value=r.value;for(var o=t.length-2;o>=l;--o)r=t[o],t[o]=new a(r._color,r.key,r.value,r.left,t[o+1],r._count);t[l-1].left=t[l]}if(r=t[t.length-1],0===r._color){var d=t[t.length-2];d.left===r?d.left=null:d.right===r&&(d.right=null),t.pop();for(var o=0;o<t.length;++o)t[o]._count--;return new c(this.tree._compare,t[0])}if(r.left||r.right){r.left?m(r,r.left):r.right&&m(r,r.right),r._color=x;for(var o=0;o<t.length-1;++o)t[o]._count--;return new c(this.tree._compare,t[0])}if(1===t.length)return new c(this.tree._compare,null);for(var o=0;o<t.length;++o)t[o]._count--;var p=t[t.length-2];return y(t),p.left===r?p.left=null:p.right=null,new c(this.tree._compare,t[0])},Object.defineProperty(b,"key",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1].key:void 0},enumerable:!0}),Object.defineProperty(b,"value",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1].value:void 0},enumerable:!0}),Object.defineProperty(b,"index",{get:function(){var e=0,t=this._stack;if(0===t.length){var a=this.tree.root;return a?a._count:0}t[t.length-1].left&&(e=t[t.length-1].left._count);for(var r=t.length-2;0<=r;--r)t[r+1]===t[r].right&&(++e,t[r].left&&(e+=t[r].left._count));return e},enumerable:!0}),b.next=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.right)for(t=t.right;t;)e.push(t),t=t.left;else for(e.pop();0<e.length&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(b,"hasNext",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].right)return!0;for(var t=e.length-1;0<t;--t)if(e[t-1].left===e[t])return!0;return!1}}),b.update=function(e){var t=this._stack;if(0===t.length)throw new Error("Can't update empty node!");var r=Array(t.length),o=t[t.length-1];r[r.length-1]=new a(o._color,o.key,e,o.left,o.right,o._count);for(var l=t.length-2;0<=l;--l)o=t[l],r[l]=o.left===t[l+1]?new a(o._color,o.key,o.value,r[l+1],o.right,o._count):new a(o._color,o.key,o.value,o.left,r[l+1],o._count);return new c(this.tree._compare,r[0])},b.prev=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.left)for(t=t.left;t;)e.push(t),t=t.right;else for(e.pop();0<e.length&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(b,"hasPrev",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].left)return!0;for(var t=e.length-1;0<t;--t)if(e[t-1].right===e[t])return!0;return!1}})},{}],231:[function(e,t){function a(e){if(0>e)return+"0/0";for(var a=n[0],r=n.length-1;0<r;--r)a+=n[r]/(e+r);var l=e+o+.5;return .5*P(2*Pe)+(e+.5)*P(l)-l+P(a)-P(e)}var r=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],o=607/128,n=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];t.exports=function e(o){if(.5>o)return Pe/(De(Pe*o)*e(1-o));if(100<o)return m(a(o));o-=1;for(var n=r[0],l=1;9>l;l++)n+=r[l]/(o+l);var s=o+7+.5;return N(2*Pe)*ya(s,o+.5)*m(-s)*n},t.exports.log=a},{}],232:[function(e,t){t.exports=function(e,t){if("string"!=typeof e)throw new TypeError("must specify type string");if(t=t||{},"undefined"==typeof document&&!t.canvas)return null;var a=t.canvas||document.createElement("canvas");"number"==typeof t.width&&(a.width=t.width),"number"==typeof t.height&&(a.height=t.height);var r=t,o;try{var n=[e];0===e.indexOf("webgl")&&n.push("experimental-"+e);for(var l=0;l<n.length;l++)if(o=a.getContext(n[l],r),o)return o}catch(t){o=null}return o||null}},{}],233:[function(e,t){"use strict";function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function r(e){this.gl=e,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=d(e)}function o(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}function n(t,r,o,i,n){for(var l=t.primalOffset,s=t.primalMinor,p=t.mirrorOffset,u=t.mirrorMinor,g=i[r],e=0;3>e;++e)if(r!==e){var h=l,m=p,y=s,f=u;g&1<<e&&(h=p,m=l,y=u,f=s),h[e]=o[0][e],m[e]=o[1][e],0<n[e]?(y[e]=-1,f[e]=0):(y[e]=0,f[e]=1)}}t.exports=function(e,t){var a=new r(e);return a.update(t),a};var l=e("./lib/text.js"),s=e("./lib/lines.js"),d=e("./lib/background.js"),c=e("./lib/cube.js"),p=e("./lib/ticks.js"),u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),g=r.prototype;g.update=function(e){function t(t,a,r){if(r in e){var o=e[r],n=this[r],l;this[r]=(t?Array.isArray(o)&&Array.isArray(o[0]):Array.isArray(o))?l=[a(o[0]),a(o[1]),a(o[2])]:l=[a(o),a(o),a(o)];for(var s=0;3>s;++s)if(l[s]!==n[s])return!0}return!1}e=e||{};var a=t.bind(this,!1,Number),r=t.bind(this,!1,Boolean),o=t.bind(this,!1,String),n=t.bind(this,!0,function(e){if(Array.isArray(e)){if(3===e.length)return[+e[0],+e[1],+e[2],1];if(4===e.length)return[+e[0],+e[1],+e[2],+e[3]]}return[0,0,0,1]}),d=!1,c=!1,u;if("bounds"in e){var g=e.bounds;i_loop:for(var h=0;2>h;++h)for(var m=0;3>m;++m)g[h][m]!==this.bounds[h][m]&&(c=!0),this.bounds[h][m]=g[h][m]}if("ticks"in e){u=e.ticks,d=!0,this.autoTicks=!1;for(var h=0;3>h;++h)this.tickSpacing[h]=0}else a("tickSpacing")&&(this.autoTicks=!0,c=!0);if(this._firstInit&&(!("ticks"in e||"tickSpacing"in e)&&(this.autoTicks=!0),c=!0,d=!0,this._firstInit=!1),c&&this.autoTicks&&(u=p.create(this.bounds,this.tickSpacing),d=!0),d){for(var h=0;3>h;++h)u[h].sort(function(e,t){return e.x-t.x});p.equal(u,this.ticks)?d=!1:this.ticks=u}r("tickEnable"),o("tickFont")&&(d=!0),a("tickSize"),a("tickAngle"),a("tickPad"),n("tickColor");var y=o("labels");o("labelFont")&&(y=!0),r("labelEnable"),a("labelSize"),a("labelPad"),n("labelColor"),r("lineEnable"),r("lineMirror"),a("lineWidth"),n("lineColor"),r("lineTickEnable"),r("lineTickMirror"),a("lineTickLength"),a("lineTickWidth"),n("lineTickColor"),r("gridEnable"),a("gridWidth"),n("gridColor"),r("zeroEnable"),n("zeroLineColor"),a("zeroLineWidth"),r("backgroundEnable"),n("backgroundColor"),this._text?this._text&&(y||d)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=l(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&d&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=s(this.gl,this.bounds,this.ticks))};var h=[new o,new o,new o],m=[0,0,0],y={model:u,view:u,projection:u,_ortho:!1};g.isOpaque=function(){return!0},g.isTransparent=function(){return!1},g.drawTransparent=function(){};var f=[0,0,0],x=[0,0,0],_=[0,0,0];g.draw=function(e){function t(e){q=[0,0,0],q[e]=1}function r(e,a,r){var o=(e+1)%3,i=(e+2)%3,n=a[o],l=a[i],s=r[o],d=r[i];return 0<n&&0<d?void t(o):0<n&&0>d?void t(o):0>n&&0<d?void t(o):0>n&&0>d?void t(o):0<l&&0<s?void t(i):0<l&&0>s?void t(i):0>l&&0<s?void t(i):0>l&&0>s?void t(i):void 0}e=e||y;for(var o=this.gl,l=e.model||u,s=e.view||u,d=e.projection||u,p=this.bounds,g=e._ortho||!1,b=c(l,s,d,p,g),k=b.cubeEdges,w=b.axis,T=s[12],A=s[13],S=s[14],C=s[15],L=g?2:1,E=L*this.pixelRatio*(d[3]*T+d[7]*A+d[11]*S+d[15]*C)/o.drawingBufferHeight,I=0;3>I;++I)this.lastCubeProps.cubeEdges[I]=k[I],this.lastCubeProps.axis[I]=w[I];for(var z=h,I=0;3>I;++I)n(h[I],I,this.bounds,k,w);for(var o=this.gl,P=m,I=0;3>I;++I)P[I]=this.backgroundEnable[I]?w[I]:0;this._background.draw(l,s,d,p,P,this.backgroundColor),this._lines.bind(l,s,d,this);for(var I=0,D;3>I;++I){D=[0,0,0],D[I]=0<w[I]?p[1][I]:p[0][I];for(var O=0;2>O;++O){var R=(I+1+O)%3,M=(I+1+(1^O))%3;this.gridEnable[R]&&this._lines.drawGrid(R,M,this.bounds,D,this.gridColor[R],this.gridWidth[R]*this.pixelRatio)}for(var O=0;2>O;++O){var R=(I+1+O)%3,M=(I+1+(1^O))%3;this.zeroEnable[M]&&0>=ea(p[0][M],p[1][M])&&0<=va(p[0][M],p[1][M])&&this._lines.drawZero(R,M,this.bounds,D,this.zeroLineColor[M],this.zeroLineWidth[M]*this.pixelRatio)}}for(var I=0;3>I;++I){this.lineEnable[I]&&this._lines.drawAxisLine(I,this.bounds,z[I].primalOffset,this.lineColor[I],this.lineWidth[I]*this.pixelRatio),this.lineMirror[I]&&this._lines.drawAxisLine(I,this.bounds,z[I].mirrorOffset,this.lineColor[I],this.lineWidth[I]*this.pixelRatio);for(var F=a(f,z[I].primalMinor),B=a(x,z[I].mirrorMinor),N=this.lineTickLength,O=0,V;3>O;++O)V=E/l[5*O],F[O]*=N[O]*V,B[O]*=N[O]*V;this.lineTickEnable[I]&&this._lines.drawAxisTicks(I,z[I].primalOffset,F,this.lineTickColor[I],this.lineTickWidth[I]*this.pixelRatio),this.lineTickMirror[I]&&this._lines.drawAxisTicks(I,z[I].mirrorOffset,B,this.lineTickColor[I],this.lineTickWidth[I]*this.pixelRatio)}this._lines.unbind(),this._text.bind(l,s,d,this.pixelRatio);for(var U=.5,I=0,H,G,q;3>I;++I){for(var Y=z[I].primalMinor,W=z[I].mirrorMinor,X=a(_,z[I].primalOffset),O=0;3>O;++O)this.lineTickEnable[I]&&(X[O]+=E*Y[O]*va(this.lineTickLength[O],0)/l[5*O]);var Z=[0,0,0];if(Z[I]=1,this.tickEnable[I]){-3600===this.tickAngle[I]?(this.tickAngle[I]=0,this.tickAlign[I]="auto"):this.tickAlign[I]=-1,G=1,H=[this.tickAlign[I],U,G],H[0]="auto"===H[0]?0:parseInt(""+H[0]),q=[0,0,0],r(I,Y,W);for(var O=0;3>O;++O)X[O]+=E*Y[O]*this.tickPad[O]/l[5*O];this._text.drawTicks(I,this.tickSize[I],this.tickAngle[I],X,this.tickColor[I],Z,q,H)}if(this.labelEnable[I]){G=0,q=[0,0,0],4<this.labels[I].length&&(t(I),G=1),H=[this.labelAlign[I],U,G],H[0]="auto"===H[0]?0:parseInt(""+H[0]);for(var O=0;3>O;++O)X[O]+=E*Y[O]*this.labelPad[O]/l[5*O];X[I]+=.5*(p[0][I]+p[1][I]),this._text.drawLabel(I,this.labelSize[I],this.labelAngle[I],X,this.labelColor[I],[0,0,0],q,H)}}this._text.unbind()},g.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":234,"./lib/cube.js":235,"./lib/lines.js":236,"./lib/text.js":238,"./lib/ticks.js":239}],234:[function(e,t){"use strict";function a(e,t,a,r){this.gl=e,this.buffer=t,this.vao=a,this.shader=r}t.exports=function(e){for(var t=[],l=[],p=0,g=0;3>g;++g)for(var h=(g+1)%3,m=(g+2)%3,y=[0,0,0],f=[0,0,0],c=-1;1>=c;c+=2){l.push(p,p+2,p+1,p+1,p+2,p+3),y[g]=c,f[g]=c;for(var x=-1;1>=x;x+=2){y[h]=x;for(var _=-1;1>=_;_+=2)y[m]=_,t.push(y[0],y[1],y[2],f[0],f[1],f[2]),p+=1}var b=h;h=m,m=b}var k=r(e,new Float32Array(t)),w=r(e,new Uint16Array(l),e.ELEMENT_ARRAY_BUFFER),T=o(e,[{buffer:k,type:e.FLOAT,size:3,offset:0,stride:24},{buffer:k,type:e.FLOAT,size:3,offset:12,stride:24}],w),A=n(e);return A.attributes.position.location=0,A.attributes.normal.location=1,new a(e,k,T,A)};var r=e("gl-buffer"),o=e("gl-vao"),n=e("./shaders").bg,l=a.prototype;l.draw=function(e,t,a,r,o,n){for(var l=!1,s=0;3>s;++s)l=l||o[s];if(l){var d=this.gl;d.enable(d.POLYGON_OFFSET_FILL),d.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:e,view:t,projection:a,bounds:r,enable:o,colors:n},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),d.disable(d.POLYGON_OFFSET_FILL)}},l.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":237,"gl-buffer":241,"gl-vao":327}],235:[function(e,t){"use strict";function a(e,t,a){for(var r=0;4>r;++r){e[r]=a[12+r];for(var o=0;3>o;++o)e[r]+=t[o]*a[4*o+r]}}function r(e){for(var t=0;t<l.length;++t)if(e=u.positive(e,l[t]),3>e.length)return 0;for(var a=e[0],r=a[0]/a[3],o=a[1]/a[3],n=0,t=1;t+1<e.length;++t){var s=e[t],d=e[t+1],c=s[0]/s[3],g=s[1]/s[3],h=d[0]/d[3],m=d[1]/d[3];n+=_a((c-r)*(m-o)-(g-o)*(h-r))}return n}t.exports=function(e,t,b,T,A){c(h,t,e),c(h,b,h);for(var S=0,C=0;2>C;++C){f[2]=T[C][2];for(var L=0;2>L;++L){f[1]=T[L][1];for(var E=0;2>E;++E)f[0]=T[E][0],a(m[S],f,h),S+=1}}for(var I=-1,C=0,z;8>C;++C){z=m[C][3];for(var P=0;3>P;++P)y[C][P]=m[C][P]/z;A&&(y[C][2]*=-1),0>z&&(0>I?I=C:y[C][2]<y[I][2]&&(I=C))}if(0>I){I=0;for(var D=0;3>D;++D){for(var O=(D+2)%3,u=(D+1)%3,R=-1,M=-1,F=0;2>F;++F){var B=F<<D,N=B+(F<<O)+(1-F<<u),V=B+(1-F<<O)+(F<<u);0>g(y[B],y[N],y[V],o)||(F?R=1:M=1)}if(0>R||0>M){M>R&&(I|=1<<D);continue}for(var F=0;2>F;++F){var B=F<<D,N=B+(F<<O)+(1-F<<u),V=B+(1-F<<O)+(F<<u),U=r([m[B],m[N],m[V],m[B+(1<<O)+(1<<u)]]);F?R=U:M=U}if(M>R){I|=1<<D;continue}}}for(var H=7^I,G=-1,C=0;8>C;++C)C!==I&&C!==H&&(0>G?G=C:y[G][1]>y[C][1]&&(G=C));for(var q=-1,C=0,Y;3>C;++C)if(Y=G^1<<C,Y!==I&&Y!==H){0>q&&(q=Y);var u=y[Y];u[0]<y[q][0]&&(q=Y)}for(var W=-1,C=0,Y;3>C;++C)if(Y=G^1<<C,Y!==I&&Y!==H&&Y!==q){0>W&&(W=Y);var u=y[Y];u[0]>y[W][0]&&(W=Y)}var X=p;X[0]=X[1]=X[2]=0,X[n.log2(q^G)]=G&q,X[n.log2(G^W)]=G&W;var Z=7^W;Z===I||Z===H?(Z=7^q,X[n.log2(W^Z)]=Z&W):X[n.log2(q^Z)]=Z&q;for(var K=I,D=0;3>D;++D)x[D]=K&1<<D?-1:1;return _};var n=e("bit-twiddle"),c=e("gl-mat4/multiply"),u=e("split-polygon"),g=e("robust-orientation"),h=Array(16),m=Array(8),y=Array(8),f=[,,,],o=[0,0,0];(function(){for(var e=0;8>e;++e)m[e]=[1,1,1,1],y[e]=[1,1,1]})();var l=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]],p=[1,1,1],x=[0,0,0],_={cubeEdges:p,axis:x}},{"bit-twiddle":92,"gl-mat4/multiply":267,"robust-orientation":510,"split-polygon":527}],236:[function(e,t){"use strict";function a(e){return e[0]=e[1]=e[2]=0,e}function r(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function o(e,t,a,r,o,i,n,l){this.gl=e,this.vertBuffer=t,this.vao=a,this.shader=r,this.tickCount=o,this.tickOffset=i,this.gridCount=n,this.gridOffset=l}t.exports=function(e,t,a){var r=[],d=[0,0,0],c=[0,0,0],p=[0,0,0],u=[0,0,0];r.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var g=0,h;3>g;++g){h=0|r.length/3;for(var m=0,y;m<a[g].length;++m)y=+a[g][m].x,r.push(y,0,1,y,1,1,y,0,-1,y,0,-1,y,1,1,y,1,-1);var f=0|r.length/3;d[g]=h,c[g]=f-h;for(var h=0|r.length/3,_=0,y;_<a[g].length;++_)y=+a[g][_].x,r.push(y,0,1,y,1,1,y,0,-1,y,0,-1,y,1,1,y,1,-1);var f=0|r.length/3;p[g]=h,u[g]=f-h}var b=n(e,new Float32Array(r)),v=l(e,[{buffer:b,type:e.FLOAT,size:3,stride:0,offset:0}]),w=s(e);return w.attributes.position.location=0,new o(e,b,v,w,c,d,u,p)};var n=e("gl-buffer"),l=e("gl-vao"),s=e("./shaders").line,d=[0,0,0],c=[0,0,0],p=[0,0,0],u=[0,0,0],g=[1,1],h=o.prototype;h.bind=function(e,t,a){this.shader.bind(),this.shader.uniforms.model=e,this.shader.uniforms.view=t,this.shader.uniforms.projection=a,g[0]=this.gl.drawingBufferWidth,g[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=g,this.vao.bind()},h.unbind=function(){this.vao.unbind()},h.drawAxisLine=function(e,t,o,i,n){var l=a(c);this.shader.uniforms.majorAxis=c,l[e]=t[1][e]-t[0][e],this.shader.uniforms.minorAxis=l;var s=r(u,o);s[e]+=t[0][e],this.shader.uniforms.offset=s,this.shader.uniforms.lineWidth=n,this.shader.uniforms.color=i;var d=a(p);d[(e+2)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6);var d=a(p);d[(e+1)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6)},h.drawAxisTicks=function(e,t,r,o,i){if(this.tickCount[e]){var n=a(d);n[e]=1,this.shader.uniforms.majorAxis=n,this.shader.uniforms.offset=t,this.shader.uniforms.minorAxis=r,this.shader.uniforms.color=o,this.shader.uniforms.lineWidth=i;var l=a(p);l[e]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])}},h.drawGrid=function(e,t,o,i,n,l){if(this.gridCount[e]){var s=a(c);s[t]=o[1][t]-o[0][t],this.shader.uniforms.minorAxis=s;var g=r(u,i);g[t]+=o[0][t],this.shader.uniforms.offset=g;var h=a(d);h[e]=1,this.shader.uniforms.majorAxis=h;var m=a(p);m[e]=1,this.shader.uniforms.screenAxis=m,this.shader.uniforms.lineWidth=l,this.shader.uniforms.color=n,this.vao.draw(this.gl.TRIANGLES,this.gridCount[e],this.gridOffset[e])}},h.drawZero=function(e,t,o,i,n,l){var s=a(c);this.shader.uniforms.majorAxis=s,s[e]=o[1][e]-o[0][e],this.shader.uniforms.minorAxis=s;var d=r(u,i);d[e]+=o[0][e],this.shader.uniforms.offset=d;var g=a(p);g[t]=1,this.shader.uniforms.screenAxis=g,this.shader.uniforms.lineWidth=l,this.shader.uniforms.color=n,this.vao.draw(this.gl.TRIANGLES,6)},h.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":237,"gl-buffer":241,"gl-vao":327}],237:[function(e,t,a){"use strict";var r=e("glslify"),o=e("gl-shader"),i=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),n=r(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);a.line=function(e){return o(e,i,n,null,[{name:"position",type:"vec3"}])};var l=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),s=r(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);a.text=function(e){return o(e,l,s,null,[{name:"position",type:"vec3"}])};var d=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),c=r(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);a.bg=function(e){return o(e,d,c,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":301,glslify:409}],238:[function(e,t){(function(a){"use strict";function r(e,t,a,r){this.gl=e,this.shader=t,this.buffer=a,this.vao=r,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}function o(t,a){try{return l(t,a)}catch(a){return console.warn("error vectorizing text:\""+t+"\" error:",a),{cells:[],positions:[]}}}t.exports=function(e,t,a,o,l,d){var c=i(e),p=n(e,[{buffer:c,size:3}]),u=s(e);u.attributes.position.location=0;var g=new r(e,u,c,p);return g.update(t,a,o,l,d),g};var i=e("gl-buffer"),n=e("gl-vao"),l=e("vectorize-text"),s=e("./shaders").text,d=window||a.global||{},u=d.__TEXT_CACHE||{};d.__TEXT_CACHE={};var g=r.prototype,h=[0,0];g.bind=function(e,t,a,r){this.vao.bind(),this.shader.bind();var o=this.shader.uniforms;o.model=e,o.view=t,o.projection=a,o.pixelScale=r,h[0]=this.gl.drawingBufferWidth,h[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=h},g.unbind=function(){this.vao.unbind()},g.update=function(e,t,a,r,n){function l(e,t,a,r,n,l){var d=u[a];d||(d=u[a]={});var g=d[t];g||(g=d[t]=o(t,{triangles:!0,font:a,textAlign:"center",textBaseline:"middle",lineSpacing:n,styletags:l}));for(var h=(r||12)/12,m=g.positions,y=g.cells,f=0,x=y.length,_;f<x;++f){_=y[f];for(var b=2,v;0<=b;--b)v=m[_[b]],s.push(h*v[0],-h*v[1],e)}}for(var s=[],c=[0,0,0],p=[0,0,0],g=[0,0,0],h=[0,0,0],m=1.25,y={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},f=0;3>f;++f){g[f]=0|s.length/3,l(.5*(e[0][f]+e[1][f]),t[f],a[f],12,m,y),h[f]=(0|s.length/3)-g[f],c[f]=0|s.length/3;for(var x=0;x<r[f].length;++x)r[f][x].text&&l(r[f][x].x,r[f][x].text,r[f][x].font||n,r[f][x].fontSize||12,m,y);p[f]=(0|s.length/3)-c[f]}this.buffer.update(s),this.tickOffset=c,this.tickCount=p,this.labelOffset=g,this.labelCount=h},g.drawTicks=function(e,t,a,r,o,i,n,l){this.tickCount[e]&&(this.shader.uniforms.axis=i,this.shader.uniforms.color=o,this.shader.uniforms.angle=a,this.shader.uniforms.scale=t,this.shader.uniforms.offset=r,this.shader.uniforms.alignDir=n,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e]))},g.drawLabel=function(e,t,a,r,o,i,n,l){this.labelCount[e]&&(this.shader.uniforms.axis=i,this.shader.uniforms.color=o,this.shader.uniforms.angle=a,this.shader.uniforms.scale=t,this.shader.uniforms.offset=r,this.shader.uniforms.alignDir=n,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.labelCount[e],this.labelOffset[e]))},g.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this,e("_process"))},{"./shaders":237,_process:482,"gl-buffer":241,"gl-vao":327,"vectorize-text":550}],239:[function(e,t,a){"use strict";function r(e,t){var a=e+"",r=a.indexOf("."),o=0;0<=r&&(o=a.length-r-1);var i=ya(10,o),n=V(e*t*i),l=n+"";if(0<=l.indexOf("e"))return l;var s=n/i,d=n%i;0>n?(s=0|-M(s),d=0|-d):(s=0|ba(s),d|=0);var c=""+s;if(0>n&&(c="-"+c),o){for(var p=""+d;p.length<o;)p="0"+p;return c+"."+p}return c}a.create=function(e,a){for(var o=[],i=0;3>i;++i){for(var n=[],l=.5*(e[0][i]+e[1][i]),s=0;s*a[i]<=e[1][i];++s)n.push({x:s*a[i],text:r(a[i],s)});for(var s=-1;s*a[i]>=e[0][i];--s)n.push({x:s*a[i],text:r(a[i],s)});o.push(n)}return o},a.equal=function(e,t){for(var r=0;3>r;++r){if(e[r].length!==t[r].length)return!1;for(var o=0;o<e[r].length;++o){var n=e[r][o],a=t[r][o];if(n.x!==a.x||n.text!==a.text||n.font!==a.font||n.fontColor!==a.fontColor||n.fontSize!==a.fontSize||n.dx!==a.dx||n.dy!==a.dy)return!1}}return!0}},{}],240:[function(e,t){"use strict";function a(e,t,a){this.lo=e,this.hi=t,this.pixelsPerDataUnit=a}function r(e,t,a,r,o){for(var n=0;3>n;++n){for(var l=u,s=g,c=0;3>c;++c)s[c]=l[c]=a[c];s[3]=l[3]=1,s[n]+=1,d(s,s,t),0>s[3]&&(e[n]=1/0),l[n]-=1,d(l,l,t),0>l[3]&&(e[n]=1/0);var p=(l[0]/l[3]-s[0]/s[3])*r,h=(l[1]/l[3]-s[1]/s[3])*o;e[n]=.25*N(p*p+h*h)}return e}t.exports=function(e,t,a,g,y){var f=t.model||c,_=t.view||c,b=t.projection||c,w=t._ortho||!1,T=e.bounds,y=y||n(f,_,b,T,w),A=y.axis;l(p,_,f),l(p,b,p);for(var S=h,C=0;3>C;++C)S[C].lo=1/0,S[C].hi=-Infinity,S[C].pixelsPerDataUnit=1/0;var L=o(s(p,p));s(p,p);for(var E=0;3>E;++E){var I=(E+1)%3,u=(E+2)%3,z=m;i_loop:for(var C=0,x;2>C;++C)if(x=[],0>A[E]!=!!C){z[E]=T[C][E];for(var P=0;2>P;++P){z[I]=T[P^C][I];for(var D=0;2>D;++D)z[u]=T[D^P^C][u],x.push(z.slice())}for(var O=w?5:4,P=O;P===O;++P){if(0===x.length)continue i_loop;x=i.positive(x,L[P])}for(var P=0;P<x.length;++P)for(var u=x[P],R=r(m,p,u,a,g),D=0;3>D;++D)S[D].lo=ea(S[D].lo,u[D]),S[D].hi=va(S[D].hi,u[D]),D!=E&&(S[D].pixelsPerDataUnit=ea(S[D].pixelsPerDataUnit,_a(R[D])))}}return S};var o=e("extract-frustum-planes"),i=e("split-polygon"),n=e("./lib/cube.js"),l=e("gl-mat4/multiply"),s=e("gl-mat4/transpose"),d=e("gl-vec4/transformMat4"),c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),p=new Float32Array(16),u=[0,0,0,1],g=[0,0,0,1],h=[new a(1/0,-Infinity,1/0),new a(1/0,-Infinity,1/0),new a(1/0,-Infinity,1/0)],m=[0,0,0]},{"./lib/cube.js":235,"extract-frustum-planes":224,"gl-mat4/multiply":267,"gl-mat4/transpose":276,"gl-vec4/transformMat4":398,"split-polygon":527}],241:[function(e,t){"use strict";function a(e,t,a,r,o){this.gl=e,this.type=t,this.handle=a,this.length=r,this.usage=o}function r(e,t,a,r,o,i){var n=o.length*o.BYTES_PER_ELEMENT;if(0>i)return e.bufferData(t,o,r),n;if(n+i>a)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return e.bufferSubData(t,i,o),a}function o(e,t){for(var a=l.malloc(e.length,t),r=e.length,o=0;o<r;++o)a[o]=e[o];return a}function i(e,t){for(var a=1,r=t.length-1;0<=r;--r){if(t[r]!==a)return!1;a*=e[r]}return!0}var l=e("typedarray-pool"),s=e("ndarray-ops"),d=e("ndarray"),c=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],p=a.prototype;p.bind=function(){this.gl.bindBuffer(this.type,this.handle)},p.unbind=function(){this.gl.bindBuffer(this.type,null)},p.dispose=function(){this.gl.deleteBuffer(this.handle)},p.update=function(e,a){if("number"!=typeof a&&(a=-1),this.bind(),"object"==typeof e&&"undefined"!=typeof e.shape){var n=e.dtype;if(0>c.indexOf(n)&&(n="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var p=gl.getExtension("OES_element_index_uint");n=p&&"uint16"!==n?"uint32":"uint16"}if(n===e.dtype&&i(e.shape,e.stride))this.length=0===e.offset&&e.data.length===e.shape[0]?r(this.gl,this.type,this.length,this.usage,e.data,a):r(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),a);else{var u=l.malloc(e.size,n),g=d(u,e.shape);s.assign(g,e),this.length=0>a?r(this.gl,this.type,this.length,this.usage,u,a):r(this.gl,this.type,this.length,this.usage,u.subarray(0,e.size),a),l.free(u)}}else if(Array.isArray(e)){var h;h=this.type===this.gl.ELEMENT_ARRAY_BUFFER?o(e,"uint16"):o(e,"float32"),this.length=0>a?r(this.gl,this.type,this.length,this.usage,h,a):r(this.gl,this.type,this.length,this.usage,h.subarray(0,e.length),a),l.free(h)}else if("object"==typeof e&&"number"==typeof e.length)this.length=r(this.gl,this.type,this.length,this.usage,e,a);else if("number"==typeof e||void 0===e){if(0<=a)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");e|=0,0>=e&&(e=1),this.gl.bufferData(this.type,0|e,this.usage),this.length=e}else throw new Error("gl-buffer: Invalid data type")},t.exports=function(e,t,r,o){if(r=r||e.ARRAY_BUFFER,o=o||e.DYNAMIC_DRAW,r!==e.ARRAY_BUFFER&&r!==e.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(o!==e.DYNAMIC_DRAW&&o!==e.STATIC_DRAW&&o!==e.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var i=e.createBuffer(),n=new a(e,r,i,0,o);return n.update(t),n}},{ndarray:450,"ndarray-ops":444,"typedarray-pool":545}],242:[function(e,t){"use strict";var a=e("gl-vec3"),r=function(e,t,r){var o=a.create();return void 0!==e&&a.set(o,e,t,r),o},o=function(e){for(var t=e[0],a=e[1],r=e[2],o=[],i=0;i<r.length;i++)for(var n=0;n<a.length;n++)for(var l=0;l<t.length;l++)o.push([r[i],a[n],t[l]]);return o},i=function(e,t){for(var a=0;a<e.length;a++)if(e[a]>=t)return a-1;return a},n=a.create(),l=a.create(),s=function(e,t,a){return e<t?t:e>a?a:e},d=function(e,t,r,o){var c=e[0],p=e[1],u=e[2],g=r[0].length,m=r[1].length,h=r[2].length,d=i(r[0],c),y=i(r[1],p),f=i(r[2],u),x=d+1,_=y+1,b=f+1;if(o&&(d=s(d,0,g-1),x=s(x,0,g-1),y=s(y,0,m-1),_=s(_,0,m-1),f=s(f,0,h-1),b=s(b,0,h-1)),0>d||0>y||0>f||x>=g||_>=m||b>=h)return a.create();var v=(c-r[0][d])/(r[0][x]-r[0][d]),k=(p-r[1][y])/(r[1][_]-r[1][y]),w=(u-r[2][f])/(r[2][b]-r[2][f]);(0>v||1<v||isNaN(v))&&(v=0),(0>k||1<k||isNaN(k))&&(k=0),(0>w||1<w||isNaN(w))&&(w=0);var T=f*g*m,A=b*g*m,S=y*g,C=_*g,L=d,E=x,I=t[S+T+L],z=t[S+T+E],P=t[C+T+L],D=t[C+T+E],O=t[S+A+L],R=t[S+A+E],M=t[C+A+L],j=t[C+A+E],F=a.create();return a.lerp(F,I,z,v),a.lerp(n,P,D,v),a.lerp(F,F,n,k),a.lerp(n,O,R,v),a.lerp(l,M,j,v),a.lerp(n,n,l,k),a.lerp(F,F,n,w),F};t.exports=function(e,t){var n=e.positions?e.positions:o(e.meshgrid);var l=e.meshgrid,s=e.vectors,c={positions:[],vertexIntensity:[],vertexIntensityBounds:e.vertexIntensityBounds,vertexNormals:[],vectors:[],cells:[],coneOffset:e.coneOffset,colormap:e.colormap};if(0===e.positions.length)return t&&(t[0]=[0,0,0],t[1]=[0,0,0]),c;for(var g=0,h=1/0,f=-1/0,_=1/0,b=-1/0,v=1/0,w=-1/0,T=null,A=null,S=[],C=1/0,L=0,E;L<n.length;L++){E=n[L],h=ea(E[0],h),f=va(E[0],f),_=ea(E[1],_),b=va(E[1],b),v=ea(E[2],v),w=va(E[2],w);var I;I=l?d(E,s,l,!0):s[L],a.length(I)>g&&(g=a.length(I)),L&&(C=ea(C,2*a.distance(T,E)/(a.length(A)+a.length(I)))),T=E,A=I,S.push(I)}var P=[h,_,v],D=[f,b,w];t&&(t[0]=P,t[1]=D),0===g&&(g=1);var O=1/g;(!isFinite(C)||isNaN(C))&&(C=1),c.vectorScale=C;var R=r(0,1,0),M=e.coneSize||.5;e.absoluteConeSize&&(M=e.absoluteConeSize*O),c.coneScale=M;for(var L=0,F=0;L<n.length;L++)for(var E=n[L],B=E[0],x=E[1],y=E[2],z=S[L],N=a.length(z)*O,V=0;V<8;V++){c.positions.push([B,x,y,F++]),c.positions.push([B,x,y,F++]),c.positions.push([B,x,y,F++]),c.positions.push([B,x,y,F++]),c.positions.push([B,x,y,F++]),c.positions.push([B,x,y,F++]),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vertexIntensity.push(N,N,N),c.vertexIntensity.push(N,N,N),c.vertexNormals.push(R,R,R),c.vertexNormals.push(R,R,R);var U=c.positions.length;c.cells.push([U-6,U-5,U-4],[U-3,U-2,U-1])}return c},t.exports.createConeMesh=e("./lib/conemesh")},{"./lib/conemesh":243,"gl-vec3":346}],243:[function(e,t){"use strict";function a(e,t,a,r,o,i,n,l,s,d,c,p,u,g,h,m,y,f,x,_,b,v,k,w){this.gl=e,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.pickShader=r,this.trianglePositions=o,this.triangleVectors=i,this.triangleColors=l,this.triangleNormals=d,this.triangleUVs=s,this.triangleIds=n,this.triangleVAO=c,this.triangleCount=0,this.lineWidth=1,this.edgePositions=p,this.edgeColors=g,this.edgeUVs=h,this.edgeIds=u,this.edgeVAO=m,this.edgeCount=0,this.pointPositions=y,this.pointColors=x,this.pointUVs=_,this.pointSizes=b,this.pointIds=f,this.pointVAO=v,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=k,this.contourVAO=w,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=1/4,this._model=T,this._view=T,this._projection=T,this._resolution=[1,1]}function r(e){for(var t=f({colormap:e,nshades:256,format:"rgba"}),a=new Uint8Array(1024),r=0,o;256>r;++r){o=t[r];for(var n=0;3>n;++n)a[4*r+n]=o[n];a[4*r+3]=255*o[3]}return y(a,[256,256,4],[4,0,1])}function o(e,t,a){for(var r=Array(t),o=0;o<t;++o)r[o]=0;for(var n=e.length,o=0,l;o<n;++o){l=e[o];for(var s=0;s<l.length;++s)r[l[s]]=a[o]}return r}function n(e){for(var t=e.length,a=Array(t),r=0;r<t;++r)a[r]=e[r][2];return a}function l(e){var t=d(e,v.vertex,v.fragment,null,v.attributes);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.vector.location=5,t}function s(e){var t=d(e,k.vertex,k.fragment,null,k.attributes);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.vector.location=5,t}var d=e("gl-shader"),c=e("gl-buffer"),p=e("gl-vao"),u=e("gl-texture2d"),g=e("normals"),h=e("gl-mat4/multiply"),m=e("gl-mat4/invert"),y=e("ndarray"),f=e("colormap"),x=e("simplicial-complex-contour"),_=e("typedarray-pool"),b=e("./shaders"),v=b.meshShader,k=b.pickShader,T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],A=a.prototype;A.isOpaque=function(){return 1<=this.opacity},A.isTransparent=function(){return 1>this.opacity},A.pickSlots=1,A.setPickBase=function(e){this.pickId=e},A.highlight=function(e){if(!e||!this.contourEnable)return void(this.contourCount=0);for(var t=x(this.cells,this.intensity,e.intensity),r=t.cells,o=t.vertexIds,n=t.vertexWeights,l=r.length,s=_.mallocFloat32(6*l),d=0,p=0,u;p<l;++p){u=r[p];for(var g=0,h;2>g;++g){h=u[0],2===u.length&&(h=u[g]);for(var m=o[h][0],a=o[h][1],y=n[h],f=this.positions[m],b=this.positions[a],w=0;3>w;++w)s[d++]=y*f[w]+(1-y)*b[w]}}this.contourCount=0|d/3,this.contourPositions.update(s.subarray(0,d)),_.free(s)},A.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"contourEnable"in e&&(this.contourEnable=e.contourEnable),"contourColor"in e&&(this.contourColor=e.contourColor),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"lightPosition"in e&&(this.lightPosition=e.lightPosition),"opacity"in e&&(this.opacity=e.opacity),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.vectorScale!==void 0&&(this.vectorScale=e.vectorScale),e.coneScale!==void 0&&(this.coneScale=e.coneScale),e.coneOffset!==void 0&&(this.coneOffset=e.coneOffset),e.texture?(this.texture.dispose(),this.texture=u(t,e.texture)):e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(r(e.colormap)),this.texture.generateMipmap());var a=e.cells,l=e.positions,s=e.vectors;if(l&&a&&s){var d=[],h=[],m=[],y=[],x=[],_=[],b=[],T=[],A=[],S=[],C=[],L=[],E=[],I=[],z=[];this.cells=a,this.positions=l;var P=e.vertexNormals,D=e.cellNormals,O=void 0===e.vertexNormalsEpsilon?1e-6:e.vertexNormalsEpsilon,R=void 0===e.faceNormalsEpsilon?1e-6:e.faceNormalsEpsilon;e.useFacetNormals&&!D&&(D=g.faceNormals(a,l,R)),D||P||(P=g.vertexNormals(a,l,O));var M=e.vertexColors,F=e.cellColors,B=e.meshColor||[1,1,1,1],N=e.vertexUVs,V=e.vertexIntensity,U=e.cellUVs,H=e.cellIntensity,G=1/0,Y=-Infinity;if(!N&&!U)if(V){if(e.vertexIntensityBounds)G=+e.vertexIntensityBounds[0],Y=+e.vertexIntensityBounds[1];else for(var W=0,X;W<V.length;++W)X=V[W],G=ea(G,X),Y=va(Y,X);}else if(H)for(var W=0,X;W<H.length;++W)X=H[W],G=ea(G,X),Y=va(Y,X);else for(var W=0,X;W<l.length;++W)X=l[W][2],G=ea(G,X),Y=va(Y,X);this.intensity=V?V:H?o(a,l.length,H):n(l);var Z=e.pointSizes,K=e.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var W=0,J;W<l.length;++W){J=l[W];for(var Q=0;3>Q;++Q)!isNaN(J[Q])&&isFinite(J[Q])&&(this.bounds[0][Q]=ea(this.bounds[0][Q],J[Q]),this.bounds[1][Q]=va(this.bounds[1][Q],J[Q]))}var $=0,ee=0,te=0;fill_loop:for(var W=0,ae;W<a.length;++W)switch(ae=a[W],ae.length){case 1:for(var re=ae[0],J=l[re],Q=0;3>Q;++Q)if(isNaN(J[Q])||!isFinite(J[Q]))continue fill_loop;C.push(J[0],J[1],J[2],J[3]);var oe;oe=M?M[re]:F?F[W]:B,3===oe.length?L.push(oe[0],oe[1],oe[2],1):L.push(oe[0],oe[1],oe[2],oe[3]);var ie;ie=N?N[re]:V?[(V[re]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],E.push(ie[0],ie[1]),Z?I.push(Z[re]):I.push(K),z.push(W),te+=1;break;case 2:for(var Q=0;2>Q;++Q)for(var re=ae[Q],J=l[re],ne=0;3>ne;++ne)if(isNaN(J[ne])||!isFinite(J[ne]))continue fill_loop;for(var Q=0;2>Q;++Q){var re=ae[Q],J=l[re];b.push(J[0],J[1],J[2]);var oe;oe=M?M[re]:F?F[W]:B,3===oe.length?T.push(oe[0],oe[1],oe[2],1):T.push(oe[0],oe[1],oe[2],oe[3]);var ie;ie=N?N[re]:V?[(V[re]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],A.push(ie[0],ie[1]),S.push(W)}ee+=1;break;case 3:for(var Q=0;3>Q;++Q)for(var re=ae[Q],J=l[re],ne=0;3>ne;++ne)if(isNaN(J[ne])||!isFinite(J[ne]))continue fill_loop;for(var Q=0;3>Q;++Q){var re=ae[2-Q],J=l[re];d.push(J[0],J[1],J[2],J[3]);var le=s[re];h.push(le[0],le[1],le[2]);var oe;oe=M?M[re]:F?F[W]:B,3===oe.length?m.push(oe[0],oe[1],oe[2],1):m.push(oe[0],oe[1],oe[2],oe[3]);var ie;ie=N?N[re]:V?[(V[re]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],x.push(ie[0],ie[1]);var w;w=P?P[re]:D[W],y.push(w[0],w[1],w[2]),_.push(W)}$+=1;break;default:}this.pointCount=te,this.edgeCount=ee,this.triangleCount=$,this.pointPositions.update(C),this.pointColors.update(L),this.pointUVs.update(E),this.pointSizes.update(I),this.pointIds.update(new Uint32Array(z)),this.edgePositions.update(b),this.edgeColors.update(T),this.edgeUVs.update(A),this.edgeIds.update(new Uint32Array(S)),this.trianglePositions.update(d),this.triangleVectors.update(h),this.triangleColors.update(m),this.triangleUVs.update(x),this.triangleNormals.update(y),this.triangleIds.update(new Uint32Array(_))}},A.drawTransparent=A.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||T,r=e.view||T,o=e.projection||T,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ea(n[1][l],this.clipBounds[1][l]);var d={model:a,view:r,projection:o,inverseModel:T.slice(),clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,contourColor:this.contourColor,texture:0};d.inverseModel=m(d.inverseModel,d.model),t.disable(t.CULL_FACE),this.texture.bind(0);var c=Array(16);h(c,d.view,d.model),h(c,d.projection,c),m(c,c);for(var l=0;3>l;++l)d.eyePosition[l]=c[12+l]/c[15];for(var p=c[15],l=0;3>l;++l)p+=this.lightPosition[l]*c[4*l+3];for(var l=0,u;3>l;++l){u=c[12+l];for(var g=0;3>g;++g)u+=c[4*g+l]*this.lightPosition[g];d.lightPosition[l]=u/p}if(0<this.triangleCount){var y=this.triShader;y.bind(),y.uniforms=d,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},A.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||T,r=e.view||T,o=e.projection||T,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ea(n[1][l],this.clipBounds[1][l]);this._model=[].slice.call(a),this._view=[].slice.call(r),this._projection=[].slice.call(o),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:a,view:r,projection:o,clipBounds:n,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},d=this.pickShader;d.bind(),d.uniforms=s,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),0<this.edgeCount&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth*this.pixelRatio),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind())},A.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],r=this.positions[a[1]].slice(0,3);return{index:ba(a[1]/48),position:r,dataCoordinate:r}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose()},t.exports=function(e,t){1===arguments.length&&(t=e,e=t.gl);var r=t.triShader||l(e),o=s(e),i=u(e,y(new Uint8Array([255,255,255,255]),[1,1,4]));i.generateMipmap(),i.minFilter=e.LINEAR_MIPMAP_LINEAR,i.magFilter=e.LINEAR;var n=c(e),d=c(e),g=c(e),h=c(e),m=c(e),f=c(e),x=p(e,[{buffer:n,type:e.FLOAT,size:4},{buffer:f,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:g,type:e.FLOAT,size:4},{buffer:h,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:3},{buffer:d,type:e.FLOAT,size:3}]),_=c(e),b=c(e),v=c(e),k=c(e),w=p(e,[{buffer:_,type:e.FLOAT,size:3},{buffer:k,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:b,type:e.FLOAT,size:4},{buffer:v,type:e.FLOAT,size:2}]),T=c(e),A=c(e),S=c(e),C=c(e),L=c(e),E=p(e,[{buffer:T,type:e.FLOAT,size:3},{buffer:L,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:e.FLOAT,size:4},{buffer:S,type:e.FLOAT,size:2},{buffer:C,type:e.FLOAT,size:1}]),I=c(e),z=p(e,[{buffer:I,type:e.FLOAT,size:3}]),P=new a(e,i,r,o,n,d,f,g,h,m,x,_,k,b,v,w,T,L,A,S,C,E,I,z);return P.update(t),P}},{"./shaders":244,colormap:126,"gl-buffer":241,"gl-mat4/invert":265,"gl-mat4/multiply":267,"gl-shader":301,"gl-texture2d":322,"gl-vao":327,ndarray:450,normals:453,"simplicial-complex-contour":518,"typedarray-pool":545}],244:[function(e,t,a){var r=e("glslify"),o=r(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float vectorScale;\nuniform float coneScale;\n\nuniform float coneOffset;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal,0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),i=r(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),n=r(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nuniform float vectorScale;\nuniform float coneScale;\nuniform float coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),l=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);a.meshShader={vertex:o,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},a.pickShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:409}],245:[function(e,t){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],246:[function(e,t){var a=e("./1.0/numbers");t.exports=function(e){return a[e]}},{"./1.0/numbers":245}],247:[function(e,t){"use strict";function a(e,t,a,r){this.gl=e,this.shader=r,this.buffer=t,this.vao=a,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}function r(e,t){for(var a=0;3>a;++a)e[0][a]=ea(e[0][a],t[a]),e[1][a]=va(e[1][a],t[a])}function o(e,t,a,r){for(var n=p[r],l=0,s;l<n.length;++l)s=n[l],e.push(t[0],t[1],t[2],a[0],a[1],a[2],a[3],s[0],s[1],s[2]);return n.length}t.exports=function(e){var t=e.gl,r=i(t),o=n(t,[{buffer:r,type:t.FLOAT,size:3,offset:0,stride:40},{buffer:r,type:t.FLOAT,size:4,offset:12,stride:40},{buffer:r,type:t.FLOAT,size:3,offset:28,stride:40}]),s=l(t);s.attributes.position.location=0,s.attributes.color.location=1,s.attributes.offset.location=2;var d=new a(t,r,o,s);return d.update(e),d};var i=e("gl-buffer"),n=e("gl-vao"),l=e("./shaders/index"),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],d=a.prototype;d.isOpaque=function(){return!this.hasAlpha},d.isTransparent=function(){return this.hasAlpha},d.drawTransparent=d.draw=function(e){var t=this.gl,a=this.shader.uniforms;this.shader.bind();var r=a.view=e.view||s,o=a.projection=e.projection||s;a.model=e.model||s,a.clipBounds=this.clipBounds,a.opacity=this.opacity;var n=r[12],l=r[13],d=r[14],c=r[15],p=e._ortho||!1,u=p?2:1,g=u*this.pixelRatio*(o[3]*n+o[7]*l+o[11]*d+o[15]*c)/t.drawingBufferHeight;this.vao.bind();for(var h=0;3>h;++h)t.lineWidth(this.lineWidth[h]*this.pixelRatio),a.capSize=this.capSize[h]*g,this.lineCount[h]&&t.drawArrays(t.LINES,this.lineOffset[h],this.lineCount[h]);this.vao.unbind()};var p=function(){for(var e=[,,,],t=0,a;3>t;++t){a=[];for(var r=1;2>=r;++r)for(var o=-1;1>=o;o+=2){var i=(r+t)%3,n=[0,0,0];n[i]=o,a.push(n)}e[t]=a}return e}();d.update=function(t){t=t||{},"lineWidth"in t&&(this.lineWidth=t.lineWidth,!Array.isArray(this.lineWidth)&&(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in t&&(this.capSize=t.capSize,!Array.isArray(this.capSize)&&(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in t&&(this.opacity=+t.opacity,1>this.opacity&&(this.hasAlpha=!0));var a=t.color||[[0,0,0],[0,0,0],[0,0,0]],l=t.position,s=t.error;if(Array.isArray(a[0])||(a=[a,a,a]),l&&s){var d=[],u=l.length,n=0;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.lineCount=[0,0,0];for(var g=0;3>g;++g){this.lineOffset[g]=n;i_loop:for(var h=0,m;h<u;++h){m=l[h];for(var y=0;3>y;++y)if(isNaN(m[y])||!isFinite(m[y]))continue i_loop;var f=s[h],e=a[g];if(Array.isArray(e[0])&&(e=a[h]),3===e.length?e=[e[0],e[1],e[2],1]:4===e.length&&(e=[e[0],e[1],e[2],e[3]],!this.hasAlpha&&1>e[3]&&(this.hasAlpha=!0)),!(isNaN(f[0][g])||isNaN(f[1][g]))){if(0>f[0][g]){var _=m.slice();_[g]+=f[0][g],d.push(m[0],m[1],m[2],e[0],e[1],e[2],e[3],0,0,0,_[0],_[1],_[2],e[0],e[1],e[2],e[3],0,0,0),r(this.bounds,_),n+=2+o(d,_,e,g)}if(0<f[1][g]){var _=m.slice();_[g]+=f[1][g],d.push(m[0],m[1],m[2],e[0],e[1],e[2],e[3],0,0,0,_[0],_[1],_[2],e[0],e[1],e[2],e[3],0,0,0),r(this.bounds,_),n+=2+o(d,_,e,g)}}}this.lineCount[g]=n-this.lineOffset[g]}this.buffer.update(d)}},d.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":248,"gl-buffer":241,"gl-vao":327}],248:[function(e,t){"use strict";var a=e("glslify"),r=e("gl-shader"),o=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),i=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);t.exports=function(e){return r(e,o,i,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":301,glslify:409}],249:[function(e,t){"use strict";function a(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING),a=e.getParameter(e.RENDERBUFFER_BINDING),r=e.getParameter(e.TEXTURE_BINDING_2D);return[t,a,r]}function r(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]),e.bindRenderbuffer(e.RENDERBUFFER,t[1]),e.bindTexture(e.TEXTURE_2D,t[2])}function o(e,t){var a=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);h=Array(a+1);for(var r=0,o;r<=a;++r){o=Array(a);for(var n=0;n<r;++n)o[n]=e.COLOR_ATTACHMENT0+n;for(var n=r;n<a;++n)o[n]=e.NONE;h[r]=o}}function n(e){switch(e){case y:throw new Error("gl-fbo: Framebuffer unsupported");case f:throw new Error("gl-fbo: Framebuffer incomplete attachment");case x:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case _:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason");}}function l(e,t,a,r,o,i){if(!r)return null;var n=g(e,t,a,o,r);return n.magFilter=e.NEAREST,n.minFilter=e.NEAREST,n.mipSamples=1,n.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,i,e.TEXTURE_2D,n.handle,0),n}function s(e,t,a,r,o){var i=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,r,t,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,o,e.RENDERBUFFER,i),i}function d(e){var t=a(e.gl),o=e.gl,d=e.handle=o.createFramebuffer(),c=e._shape[0],p=e._shape[1],u=e.color.length,g=e._ext,m=e._useStencil,y=e._useDepth,f=e._colorType;o.bindFramebuffer(o.FRAMEBUFFER,d);for(var x=0;x<u;++x)e.color[x]=l(o,c,p,f,o.RGBA,o.COLOR_ATTACHMENT0+x);0===u?(e._color_rb=s(o,c,p,o.RGBA4,o.COLOR_ATTACHMENT0),g&&g.drawBuffersWEBGL(h[0])):1<u&&g.drawBuffersWEBGL(h[u]);var _=o.getExtension("WEBGL_depth_texture");_?m?e.depth=l(o,c,p,_.UNSIGNED_INT_24_8_WEBGL,o.DEPTH_STENCIL,o.DEPTH_STENCIL_ATTACHMENT):y&&(e.depth=l(o,c,p,o.UNSIGNED_SHORT,o.DEPTH_COMPONENT,o.DEPTH_ATTACHMENT)):y&&m?e._depth_rb=s(o,c,p,o.DEPTH_STENCIL,o.DEPTH_STENCIL_ATTACHMENT):y?e._depth_rb=s(o,c,p,o.DEPTH_COMPONENT16,o.DEPTH_ATTACHMENT):m&&(e._depth_rb=s(o,c,p,o.STENCIL_INDEX,o.STENCIL_ATTACHMENT));var b=o.checkFramebufferStatus(o.FRAMEBUFFER);if(b!==o.FRAMEBUFFER_COMPLETE){e._destroyed=!0,o.bindFramebuffer(o.FRAMEBUFFER,null),o.deleteFramebuffer(e.handle),e.handle=null,e.depth&&(e.depth.dispose(),e.depth=null),e._depth_rb&&(o.deleteRenderbuffer(e._depth_rb),e._depth_rb=null);for(var x=0;x<e.color.length;++x)e.color[x].dispose(),e.color[x]=null;e._color_rb&&(o.deleteRenderbuffer(e._color_rb),e._color_rb=null),r(o,t),n(b)}r(o,t)}function c(e,t,a,r,o,n,l,s){this.gl=e,this._shape=[0|t,0|a],this._destroyed=!1,this._ext=s,this.color=Array(o);for(var c=0;c<o;++c)this.color[c]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=r,this._useDepth=n,this._useStencil=l;var p=this,u=[0|t,0|a];Object.defineProperties(u,{0:{get:function(){return p._shape[0]},set:function(e){return p.width=e}},1:{get:function(){return p._shape[1]},set:function(e){return p.height=e}}}),this._shapeVector=u,d(this)}function p(e,t,o){if(e._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(e._shape[0]!==t||e._shape[1]!==o){var l=e.gl,s=l.getParameter(l.MAX_RENDERBUFFER_SIZE);if(0>t||t>s||0>o||o>s)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");e._shape[0]=t,e._shape[1]=o;for(var d=a(l),c=0;c<e.color.length;++c)e.color[c].shape=e._shape;e._color_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,e._color_rb),l.renderbufferStorage(l.RENDERBUFFER,l.RGBA4,e._shape[0],e._shape[1])),e.depth&&(e.depth.shape=e._shape),e._depth_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,e._depth_rb),e._useDepth&&e._useStencil?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,e._shape[0],e._shape[1]):e._useDepth?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,e._shape[0],e._shape[1]):e._useStencil&&l.renderbufferStorage(l.RENDERBUFFER,l.STENCIL_INDEX,e._shape[0],e._shape[1])),l.bindFramebuffer(l.FRAMEBUFFER,e.handle);var p=l.checkFramebufferStatus(l.FRAMEBUFFER);p!==l.FRAMEBUFFER_COMPLETE&&(e.dispose(),r(l,d),n(p)),r(l,d)}}function u(e,t,a,r){y||(y=e.FRAMEBUFFER_UNSUPPORTED,f=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,x=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,_=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var i=e.getExtension("WEBGL_draw_buffers");if(!h&&i&&o(e,i),Array.isArray(t)&&(r=a,a=0|t[1],t=0|t[0]),"number"!=typeof t)throw new Error("gl-fbo: Missing shape parameter");var n=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(0>t||t>n||0>a||a>n)throw new Error("gl-fbo: Parameters are too large for FBO");r=r||{};var l=1;if("color"in r){if(l=va(0|r.color,0),0>l)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(1<l)if(!i)throw new Error("gl-fbo: Multiple draw buffer extension not supported");else if(l>e.getParameter(i.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+l+" draw buffers")}var s=e.UNSIGNED_BYTE,d=e.getExtension("OES_texture_float");if(r.float&&0<l){if(!d)throw new Error("gl-fbo: Context does not support floating point textures");s=e.FLOAT}else r.preferFloat&&0<l&&d&&(s=e.FLOAT);var p=!0;"depth"in r&&(p=!!r.depth);var u=!1;return"stencil"in r&&(u=!!r.stencil),new c(e,t,a,s,l,p,u,i)}var g=e("gl-texture2d");t.exports=u;var h=null,m=c.prototype,y,f,x,_;Object.defineProperties(m,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(e){if(Array.isArray(e)||(e=[0|e,0|e]),2!==e.length)throw new Error("gl-fbo: Shape vector must be length 2");var t=0|e[0],a=0|e[1];return p(this,t,a),[t,a]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(e){return e|=0,p(this,e,this._shape[1]),e},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(e){return e|=0,p(this,this._shape[0],e),e},enumerable:!1}}),m.bind=function(){if(!this._destroyed){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle),e.viewport(0,0,this._shape[0],this._shape[1])}},m.dispose=function(){if(!this._destroyed){this._destroyed=!0;var e=this.gl;e.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(e.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var t=0;t<this.color.length;++t)this.color[t].dispose(),this.color[t]=null;this._color_rb&&(e.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":322}],250:[function(e,t){var a=e("sprintf-js").sprintf,r=e("gl-constants/lookup"),o=e("glsl-shader-name"),n=e("add-line-numbers");t.exports=function(t,l,s){"use strict";var d=o(l)||"of unknown name (see npm glsl-shader-name)",c="unknown type";s!==void 0&&(c=s===r.FRAGMENT_SHADER?"fragment":"vertex");for(var p=a("Error compiling %s shader %s:\n",c,d),u=a("%s%s",p,t),g=t.split("\n"),h={},m=0,y;m<g.length;m++)if(y=g[m],""!==y&&"\0"!==y){var f=parseInt(y.split(":")[2]);if(isNaN(f))throw new Error(a("Could not parse error: %s",y));h[f]=y}for(var x=n(l).split("\n"),m=0;m<x.length;m++)if(h[m+3]||h[m+2]||h[m+1]){var _=x[m];if(p+=_+"\n",h[m+1]){var b=h[m+1];b=b.substr(b.split(":",3).join(":").length+1).trim(),p+=a("^^^ %s\n\n",b)}}return{long:p.trim(),short:u.trim()}}},{"add-line-numbers":61,"gl-constants/lookup":246,"glsl-shader-name":401,"sprintf-js":528}],251:[function(e,t){"use strict";function a(e,t,a,r,o,i,n){this.plot=e,this.shader=t,this.pickShader=a,this.positionBuffer=r,this.weightBuffer=o,this.colorBuffer=i,this.idBuffer=n,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-Infinity,-Infinity],this.pickOffset=0}t.exports=function(e,t){var r=e.gl,o=s(r,c.vertex,c.fragment),i=s(r,c.pickVertex,c.pickFragment),n=d(r),l=d(r),p=d(r),u=d(r),g=new a(e,o,i,n,l,p,u);return g.update(t),e.addObject(g),g};var o=e("binary-search-bounds"),n=e("iota-array"),l=e("typedarray-pool"),s=e("gl-shader"),d=e("gl-buffer"),c=e("./lib/shaders"),p=a.prototype,u=[0,0,1,0,0,1,1,0,1,1,0,1];p.draw=function(){var e=[1,0,0,0,1,0,0,0,1];return function(){var t=this.plot,a=this.shader,r=this.bounds,o=this.numVertices;if(!(0>=o)){var i=t.gl,n=t.dataBox,l=r[2]-r[0],s=r[3]-r[1],d=n[2]-n[0],c=n[3]-n[1];e[0]=2*l/d,e[4]=2*s/c,e[6]=2*(r[0]-n[0])/d-1,e[7]=2*(r[1]-n[1])/c-1,a.bind();var p=a.uniforms;p.viewTransform=e,p.shape=this.shape;var u=a.attributes;this.positionBuffer.bind(),u.position.pointer(),this.weightBuffer.bind(),u.weight.pointer(i.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),u.color.pointer(i.UNSIGNED_BYTE,!0),i.drawArrays(i.TRIANGLES,0,o)}}}(),p.drawPick=function(){var e=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(a){var r=this.plot,o=this.pickShader,n=this.bounds,l=this.numVertices;if(!(0>=l)){var s=r.gl,d=r.dataBox,c=n[2]-n[0],p=n[3]-n[1],u=d[2]-d[0],g=d[3]-d[1];e[0]=2*c/u,e[4]=2*p/g,e[6]=2*(n[0]-d[0])/u-1,e[7]=2*(n[1]-d[1])/g-1;for(var h=0;4>h;++h)t[h]=255&a>>8*h;this.pickOffset=a,o.bind();var m=o.uniforms;m.viewTransform=e,m.pickOffset=t,m.shape=this.shape;var y=o.attributes;return this.positionBuffer.bind(),y.position.pointer(),this.weightBuffer.bind(),y.weight.pointer(s.UNSIGNED_BYTE,!1),this.idBuffer.bind(),y.pickId.pointer(s.UNSIGNED_BYTE,!1),s.drawArrays(s.TRIANGLES,0,l),a+this.shape[0]*this.shape[1]}}}(),p.pick=function(e,t,a){var r=this.pickOffset,o=this.shape[0]*this.shape[1];if(a<r||a>=r+o)return null;var i=a-r,n=this.xData,l=this.yData;return{object:this,pointId:i,dataCoord:[n[i%this.shape[0]],l[0|i/this.shape[0]]]}},p.update=function(e){e=e||{};var s=e.shape||[0,0],d=e.x||n(s[0]),c=e.y||n(s[1]),p=e.z||new Float32Array(s[0]*s[1]);this.xData=d,this.yData=c;var h=e.colorLevels||[0],m=e.colorValues||[0,0,0,1],y=h.length,f=this.bounds,x=f[0]=d[0],_=f[1]=c[0],v=f[2]=d[d.length-1],k=f[3]=c[c.length-1],w=1/(v-x),T=1/(k-_),A=s[0],S=s[1];this.shape=[A,S];var C=(A-1)*(S-1)*(u.length>>>1);this.numVertices=C;for(var L=l.mallocUint8(4*C),E=l.mallocFloat32(2*C),I=l.mallocUint8(2*C),z=l.mallocUint32(C),P=0,D=0;D<S-1;++D)for(var O=T*(c[D]-_),R=T*(c[D+1]-_),M=0;M<A-1;++M)for(var F=w*(d[M]-x),B=w*(d[M+1]-x),N=0;N<u.length;N+=2){var V=u[N],U=u[N+1],H=(D+U)*A+(M+V),G=p[H],q=o.le(h,G),Y,W,X,Z;if(0>q)Y=m[0],W=m[1],X=m[2],Z=m[3];else if(q===y-1)Y=m[4*y-4],W=m[4*y-3],X=m[4*y-2],Z=m[4*y-1];else{var K=(G-h[q])/(h[q+1]-h[q]),t=1-K,J=4*q,Q=4*(q+1);Y=t*m[J]+K*m[Q],W=t*m[J+1]+K*m[Q+1],X=t*m[J+2]+K*m[Q+2],Z=t*m[J+3]+K*m[Q+3]}L[4*P]=255*Y,L[4*P+1]=255*W,L[4*P+2]=255*X,L[4*P+3]=255*Z,E[2*P]=.5*F+.5*B,E[2*P+1]=.5*O+.5*R,I[2*P]=V,I[2*P+1]=U,z[P]=D*A+M,P+=1}this.positionBuffer.update(E),this.weightBuffer.update(I),this.colorBuffer.update(L),this.idBuffer.update(z),l.free(E),l.free(L),l.free(I),l.free(z)},p.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":252,"binary-search-bounds":253,"gl-buffer":241,"gl-shader":301,"iota-array":416,"typedarray-pool":545}],252:[function(e,t){"use strict";var a=e("glslify");t.exports={fragment:a(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:409}],253:[function(e,t,a){arguments[4][111][0].apply(a,arguments)},{dup:111}],254:[function(e,t,a){var r=e("glslify"),o=e("gl-shader"),i=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),n=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),l=r(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1540259130(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, encode_float_1540259130(pixelArcLength).xyz);\n}"]),s=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];a.createShader=function(e){return o(e,i,n,null,s)},a.createPickShader=function(e){return o(e,i,l,null,s)}},{"gl-shader":301,glslify:409}],255:[function(e,t){"use strict";function r(e,t){for(var a=0,r=0,o;3>r;++r)o=e[r]-t[r],a+=o*o;return N(a)}function o(e){for(var t=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],a=0;3>a;++a)t[0][a]=va(e[0][a],t[0][a]),t[1][a]=ea(e[1][a],t[1][a]);return t}function n(e,t,a,r){this.arcLength=e,this.position=t,this.index=a,this.dataCoordinate=r}function l(e,t,a,r,o,i){this.gl=e,this.shader=t,this.pickShader=a,this.buffer=r,this.vao=o,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=i,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}t.exports=function(e){var t=e.gl||e.scene&&e.scene.gl,a=m(t);a.attributes.position.location=0,a.attributes.nextPosition.location=1,a.attributes.arcLength.location=2,a.attributes.lineWidth.location=3,a.attributes.color.location=4;var r=y(t);r.attributes.position.location=0,r.attributes.nextPosition.location=1,r.attributes.arcLength.location=2,r.attributes.lineWidth.location=3,r.attributes.color.location=4;for(var o=s(t),n=d(t,[{buffer:o,size:3,offset:0,stride:48},{buffer:o,size:3,offset:12,stride:48},{buffer:o,size:1,offset:24,stride:48},{buffer:o,size:1,offset:28,stride:48},{buffer:o,size:4,offset:32,stride:48}]),p=g(Array(1024),[256,1,4]),u=0;1024>u;++u)p.data[u]=255;var h=c(t,p);h.wrap=t.REPEAT;var f=new l(t,a,r,o,n,h);return f.update(e),f};var s=e("gl-buffer"),d=e("gl-vao"),c=e("gl-texture2d"),p=e("glsl-read-float"),u=e("binary-search-bounds"),g=e("ndarray"),h=e("./lib/shaders"),m=h.createShader,y=h.createPickShader,f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x=l.prototype;x.isTransparent=function(){return this.hasAlpha},x.isOpaque=function(){return!this.hasAlpha},x.pickSlots=1,x.setPickBase=function(e){this.pickId=e},x.drawTransparent=x.draw=function(e){if(this.vertexCount){var t=this.gl,a=this.shader,r=this.vao;a.bind(),a.uniforms={model:e.model||f,view:e.view||f,projection:e.projection||f,clipBounds:o(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio},r.bind(),r.draw(t.TRIANGLE_STRIP,this.vertexCount),r.unbind()}},x.drawPick=function(e){if(this.vertexCount){var t=this.gl,a=this.pickShader,r=this.vao;a.bind(),a.uniforms={model:e.model||f,view:e.view||f,projection:e.projection||f,pickId:this.pickId,clipBounds:o(this.clipBounds),screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio},r.bind(),r.draw(t.TRIANGLE_STRIP,this.vertexCount),r.unbind()}},x.update=function(e){var t,o;this.dirty=!0;var n=!!e.connectGaps;"dashScale"in e&&(this.dashScale=e.dashScale),this.hasAlpha=!1,"opacity"in e&&(this.opacity=+e.opacity,1>this.opacity&&(this.hasAlpha=!0));var l=[],s=[],d=[],c=0,p=0,h=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],m=e.position||e.positions;if(m){var y=e.color||e.colors||[0,0,0,1],f=e.lineWidth||1,x=!1;fill_loop:for(t=1;t<m.length;++t){var _=m[t-1],a=m[t];for(s.push(c),d.push(_.slice()),o=0;3>o;++o){if(isNaN(_[o])||isNaN(a[o])||!isFinite(_[o])||!isFinite(a[o])){if(!n&&0<l.length){for(var b=0;24>b;++b)l.push(l[l.length-12]);p+=2,x=!0}continue fill_loop}h[0][o]=ea(h[0][o],_[o],a[o]),h[1][o]=va(h[1][o],_[o],a[o])}var v,w;Array.isArray(y[0])?(v=y.length>t-1?y[t-1]:0<y.length?y[y.length-1]:[0,0,0,1],w=y.length>t?y[t]:0<y.length?y[y.length-1]:[0,0,0,1]):v=w=y,3===v.length&&(v=[v[0],v[1],v[2],1]),3===w.length&&(w=[w[0],w[1],w[2],1]),!this.hasAlpha&&1>v[3]&&(this.hasAlpha=!0);var T=Array.isArray(f)?f.length>t-1?f[t-1]:0<f.length?f[f.length-1]:[0,0,0,1]:f;var A=c;if(c+=r(_,a),x){for(o=0;2>o;++o)l.push(_[0],_[1],_[2],a[0],a[1],a[2],A,T,v[0],v[1],v[2],v[3]);p+=2,x=!1}l.push(_[0],_[1],_[2],a[0],a[1],a[2],A,T,v[0],v[1],v[2],v[3],_[0],_[1],_[2],a[0],a[1],a[2],A,-T,v[0],v[1],v[2],v[3],a[0],a[1],a[2],_[0],_[1],_[2],c,-T,w[0],w[1],w[2],w[3],a[0],a[1],a[2],_[0],_[1],_[2],c,T,w[0],w[1],w[2],w[3]),p+=4}}if(this.buffer.update(l),s.push(c),d.push(m[m.length-1].slice()),this.bounds=h,this.vertexCount=p,this.points=d,this.arcLength=s,"dashes"in e){var S=e.dashes,C=S.slice();for(C.unshift(0),t=1;t<C.length;++t)C[t]=C[t-1]+C[t];var L=g(Array(1024),[256,1,4]);for(t=0;256>t;++t){for(o=0;4>o;++o)L.set(t,0,o,0);1&u.le(C,C[C.length-1]*t/255)?L.set(t,0,0,0):L.set(t,0,0,255)}this.texture.setPixels(L)}},x.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},x.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var r=p(e.value[0],e.value[1],e.value[2],0),o=u.le(this.arcLength,r);if(0>o)return null;if(o===this.arcLength.length-1)return new n(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),o);for(var l=this.points[o],a=this.points[ea(o+1,this.points.length-1)],s=(r-this.arcLength[o])/(this.arcLength[o+1]-this.arcLength[o]),t=[0,0,0],d=0;3>d;++d)t[d]=(1-s)*l[d]+s*a[d];var c=ea(.5>s?o:o+1,this.points.length-1);return new n(r,t,c,this.points[c])}},{"./lib/shaders":254,"binary-search-bounds":256,"gl-buffer":241,"gl-texture2d":322,"gl-vao":327,"glsl-read-float":400,ndarray:450}],256:[function(e,t,a){arguments[4][111][0].apply(a,arguments)},{dup:111}],257:[function(e,t){t.exports=function(e,t){var a=t[0],r=t[1],o=t[2],i=t[3],n=a*i-o*r;return n?(n=1/n,e[0]=i*n,e[1]=-r*n,e[2]=-o*n,e[3]=a*n,e):null}},{}],258:[function(e,t){t.exports=function(e,t){var a=t[0],r=t[1],o=t[2],i=t[3],n=t[4],l=t[5],s=t[6],d=t[7],c=t[8],p=c*n-l*d,u=-c*i+l*s,g=d*i-n*s,h=a*p+r*u+o*g;return h?(h=1/h,e[0]=p*h,e[1]=(-c*r+o*d)*h,e[2]=(l*r-o*n)*h,e[3]=u*h,e[4]=(c*a-o*s)*h,e[5]=(-l*a+o*i)*h,e[6]=g*h,e[7]=(-d*a+r*s)*h,e[8]=(n*a-r*i)*h,e):null}},{}],259:[function(e,t){t.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],260:[function(e,t){t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],261:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],r=e[2],o=e[3],i=e[4],n=e[5],l=e[6],s=e[7],d=e[8],c=e[9],p=e[10],u=e[11],g=e[12],h=e[13],m=e[14],y=e[15];return(t*n-a*i)*(p*y-u*m)-(t*l-r*i)*(c*y-u*h)+(t*s-o*i)*(c*m-p*h)+(a*l-r*n)*(d*y-u*g)-(a*s-o*n)*(d*m-p*g)+(r*s-o*l)*(d*h-c*g)}},{}],262:[function(e,t){t.exports=function(e,t){var a=t[0],r=t[1],o=t[2],i=t[3],n=a+a,l=r+r,s=o+o,d=a*n,c=r*n,p=r*l,u=o*n,g=o*l,h=o*s,m=i*n,y=i*l,f=i*s;return e[0]=1-p-h,e[1]=c+f,e[2]=u-y,e[3]=0,e[4]=c-f,e[5]=1-d-h,e[6]=g+m,e[7]=0,e[8]=u+y,e[9]=g-m,e[10]=1-d-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],263:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2],n=t[3],l=r+r,s=o+o,d=i+i,c=r*l,p=r*s,u=r*d,g=o*s,h=o*d,m=i*d,y=n*l,f=n*s,x=n*d;return e[0]=1-(g+m),e[1]=p+x,e[2]=u-f,e[3]=0,e[4]=p-x,e[5]=1-(c+m),e[6]=h+y,e[7]=0,e[8]=u+f,e[9]=h-y,e[10]=1-(c+g),e[11]=0,e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=1,e}},{}],264:[function(e,t){t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],265:[function(e,t){t.exports=function(e,t){var a=t[0],r=t[1],o=t[2],i=t[3],n=t[4],l=t[5],s=t[6],d=t[7],c=t[8],p=t[9],u=t[10],g=t[11],h=t[12],m=t[13],y=t[14],f=t[15],x=a*l-r*n,_=a*s-o*n,b=a*d-i*n,v=r*s-o*l,k=r*d-i*l,w=o*d-i*s,T=c*m-p*h,A=c*y-u*h,S=c*f-g*h,C=p*y-u*m,L=p*f-g*m,E=u*f-g*y,I=x*E-_*L+b*C+v*S-k*A+w*T;return I?(I=1/I,e[0]=(l*E-s*L+d*C)*I,e[1]=(o*L-r*E-i*C)*I,e[2]=(m*w-y*k+f*v)*I,e[3]=(u*k-p*w-g*v)*I,e[4]=(s*S-n*E-d*A)*I,e[5]=(a*E-o*S+i*A)*I,e[6]=(y*b-h*w-f*_)*I,e[7]=(c*w-u*b+g*_)*I,e[8]=(n*L-l*S+d*T)*I,e[9]=(r*S-a*L-i*T)*I,e[10]=(h*k-m*b+f*x)*I,e[11]=(p*b-c*k-g*x)*I,e[12]=(l*A-n*C-s*T)*I,e[13]=(a*C-r*A+o*T)*I,e[14]=(m*_-h*v-y*x)*I,e[15]=(c*v-p*_+u*x)*I,e):null}},{}],266:[function(e,t){var a=e("./identity");t.exports=function(e,t,r,o){var i=t[0],n=t[1],l=t[2],s=o[0],d=o[1],c=o[2],p=r[0],u=r[1],g=r[2],h,m,y,f,x,_,b,v,k,w;return 1e-6>_a(i-p)&&1e-6>_a(n-u)&&1e-6>_a(l-g)?a(e):(b=i-p,v=n-u,k=l-g,w=1/N(b*b+v*v+k*k),b*=w,v*=w,k*=w,h=d*k-c*v,m=c*b-s*k,y=s*v-d*b,w=N(h*h+m*m+y*y),w?(w=1/w,h*=w,m*=w,y*=w):(h=0,m=0,y=0),f=v*y-k*m,x=k*h-b*y,_=b*m-v*h,w=N(f*f+x*x+_*_),w?(w=1/w,f*=w,x*=w,_*=w):(f=0,x=0,_=0),e[0]=h,e[1]=f,e[2]=b,e[3]=0,e[4]=m,e[5]=x,e[6]=v,e[7]=0,e[8]=y,e[9]=_,e[10]=k,e[11]=0,e[12]=-(h*i+m*n+y*l),e[13]=-(f*i+x*n+_*l),e[14]=-(b*i+v*n+k*l),e[15]=1,e)}},{"./identity":264}],267:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2],n=t[3],l=t[4],s=t[5],d=t[6],c=t[7],p=t[8],u=t[9],g=t[10],h=t[11],m=t[12],y=t[13],f=t[14],x=t[15],_=a[0],b=a[1],v=a[2],k=a[3];return e[0]=_*r+b*l+v*p+k*m,e[1]=_*o+b*s+v*u+k*y,e[2]=_*i+b*d+v*g+k*f,e[3]=_*n+b*c+v*h+k*x,_=a[4],b=a[5],v=a[6],k=a[7],e[4]=_*r+b*l+v*p+k*m,e[5]=_*o+b*s+v*u+k*y,e[6]=_*i+b*d+v*g+k*f,e[7]=_*n+b*c+v*h+k*x,_=a[8],b=a[9],v=a[10],k=a[11],e[8]=_*r+b*l+v*p+k*m,e[9]=_*o+b*s+v*u+k*y,e[10]=_*i+b*d+v*g+k*f,e[11]=_*n+b*c+v*h+k*x,_=a[12],b=a[13],v=a[14],k=a[15],e[12]=_*r+b*l+v*p+k*m,e[13]=_*o+b*s+v*u+k*y,e[14]=_*i+b*d+v*g+k*f,e[15]=_*n+b*c+v*h+k*x,e}},{}],268:[function(e,t){t.exports=function(e,t,a,r,o,i,n){var l=1/(t-a),s=1/(r-o),d=1/(i-n);return e[0]=-2*l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+a)*l,e[13]=(o+r)*s,e[14]=(n+i)*d,e[15]=1,e}},{}],269:[function(e,t){t.exports=function(e,t,a,r,o){var i=1/fa(t/2),n=1/(r-o);return e[0]=i/a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(o+r)*n,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*o*r*n,e[15]=0,e}},{}],270:[function(e,t){t.exports=function(e,r,a,o){var i=o[0],n=o[1],l=o[2],d=N(i*i+n*n+l*l),p,u,g,h,m,f,_,b,v,k,w,T,A,S,C,L,E,I,P,D,O,M,j,F;return 1e-6>_a(d)?null:(d=1/d,i*=d,n*=d,l*=d,p=De(a),u=R(a),g=1-u,h=r[0],m=r[1],f=r[2],_=r[3],b=r[4],v=r[5],k=r[6],w=r[7],T=r[8],A=r[9],S=r[10],C=r[11],L=i*i*g+u,E=n*i*g+l*p,I=l*i*g-n*p,P=i*n*g-l*p,D=n*n*g+u,O=l*n*g+i*p,M=i*l*g+n*p,j=n*l*g-i*p,F=l*l*g+u,e[0]=h*L+b*E+T*I,e[1]=m*L+v*E+A*I,e[2]=f*L+k*E+S*I,e[3]=_*L+w*E+C*I,e[4]=h*P+b*D+T*O,e[5]=m*P+v*D+A*O,e[6]=f*P+k*D+S*O,e[7]=_*P+w*D+C*O,e[8]=h*M+b*j+T*F,e[9]=m*M+v*j+A*F,e[10]=f*M+k*j+S*F,e[11]=_*M+w*j+C*F,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}},{}],271:[function(e,t){t.exports=function(e,t,a){var r=De(a),o=R(a),i=t[4],n=t[5],l=t[6],s=t[7],d=t[8],c=t[9],p=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*o+d*r,e[5]=n*o+c*r,e[6]=l*o+p*r,e[7]=s*o+u*r,e[8]=d*o-i*r,e[9]=c*o-n*r,e[10]=p*o-l*r,e[11]=u*o-s*r,e}},{}],272:[function(e,t){t.exports=function(e,t,a){var r=De(a),o=R(a),i=t[0],n=t[1],l=t[2],s=t[3],d=t[8],c=t[9],p=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o-d*r,e[1]=n*o-c*r,e[2]=l*o-p*r,e[3]=s*o-u*r,e[8]=i*r+d*o,e[9]=n*r+c*o,e[10]=l*r+p*o,e[11]=s*r+u*o,e}},{}],273:[function(e,t){t.exports=function(e,t,a){var r=De(a),o=R(a),i=t[0],n=t[1],l=t[2],s=t[3],d=t[4],c=t[5],p=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o+d*r,e[1]=n*o+c*r,e[2]=l*o+p*r,e[3]=s*o+u*r,e[4]=d*o-i*r,e[5]=c*o-n*r,e[6]=p*o-l*r,e[7]=u*o-s*r,e}},{}],274:[function(e,t){t.exports=function(e,t,a){var r=a[0],o=a[1],i=a[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],275:[function(e,t){t.exports=function(e,t,a){var r=a[0],o=a[1],i=a[2],n,l,s,d,c,p,u,g,h,m,y,f;return t===e?(e[12]=t[0]*r+t[4]*o+t[8]*i+t[12],e[13]=t[1]*r+t[5]*o+t[9]*i+t[13],e[14]=t[2]*r+t[6]*o+t[10]*i+t[14],e[15]=t[3]*r+t[7]*o+t[11]*i+t[15]):(n=t[0],l=t[1],s=t[2],d=t[3],c=t[4],p=t[5],u=t[6],g=t[7],h=t[8],m=t[9],y=t[10],f=t[11],e[0]=n,e[1]=l,e[2]=s,e[3]=d,e[4]=c,e[5]=p,e[6]=u,e[7]=g,e[8]=h,e[9]=m,e[10]=y,e[11]=f,e[12]=n*r+c*o+h*i+t[12],e[13]=l*r+p*o+m*i+t[13],e[14]=s*r+u*o+y*i+t[14],e[15]=d*r+g*o+f*i+t[15]),e}},{}],276:[function(e,t){t.exports=function(e,t){if(e===t){var a=t[1],r=t[2],o=t[3],i=t[6],n=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=a,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[11]=t[14],e[12]=o,e[13]=n,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],277:[function(e,t){"use strict";t.exports=function(e,t){switch(t.length){case 0:break;case 1:e[0]=1/t[0];break;case 4:a(e,t);break;case 9:r(e,t);break;case 16:o(e,t);break;default:throw new Error("currently supports matrices up to 4x4");}return e};var a=e("gl-mat2/invert"),r=e("gl-mat3/invert"),o=e("gl-mat4/invert")},{"gl-mat2/invert":257,"gl-mat3/invert":258,"gl-mat4/invert":265}],278:[function(e,t){"use strict";function a(e,t){for(var a=[0,0,0,0],r=0;4>r;++r)for(var o=0;4>o;++o)a[o]+=e[4*r+o]*t[r];return a}function r(e,t,r,o,n){for(var l=a(o,a(r,a(t,[e[0],e[1],e[2],1]))),s=0;3>s;++s)l[s]/=l[3];return[.5*n[0]*(1+l[0]),.5*n[1]*(1-l[1])]}function o(e,t){if(2===e.length){for(var a=0,r=0,o=0;2>o;++o)a+=ya(t[o]-e[0][o],2),r+=ya(t[o]-e[1][o],2);return a=N(a),r=N(r),1e-6>a+r?[1,0]:[r/(a+r),a/(r+a)]}if(3===e.length){var n=[0,0];return s(e[0],e[1],e[2],t,n),l(e,n)}return[]}function n(e,t){for(var a=[0,0,0],r=0;r<e.length;++r)for(var o=e[r],n=t[r],l=0;3>l;++l)a[l]+=n*o[l];return a}var l=e("barycentric"),s=e("polytope-closest-point/lib/closest_point_2d.js");t.exports=function(e,t,a,l,d,c){if(1===e.length)return[0,e[0].slice()];for(var p=Array(e.length),u=0;u<e.length;++u)p[u]=r(e[u],a,l,d,c);for(var g=0,h=1/0,u=0,m;u<p.length;++u){m=0;for(var y=0;2>y;++y)m+=ya(p[u][y]-t[y],2);m<h&&(h=m,g=u)}for(var f=o(p,t),x=0,u=0;3>u;++u){if(-.001>f[u]||1.0001<f[u])return null;x+=f[u]}return .001<_a(x-1)?null:[g,n(e,f),f]}},{barycentric:73,"polytope-closest-point/lib/closest_point_2d.js":481}],279:[function(e,t,a){var r=e("glslify"),o=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),i=r(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),n=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),l=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),s=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),d=r(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),c=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),p=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),u=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),g=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),h=r(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);a.meshShader={vertex:o,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},a.wireShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},a.pointShader={vertex:s,fragment:d,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},a.pickShader={vertex:c,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},a.pointPickShader={vertex:u,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},a.contourShader={vertex:g,fragment:h,attributes:[{name:"position",type:"vec3"}]}},{glslify:409}],280:[function(e,t){"use strict";function a(e,t,a,r,o,i,n,l,s,d,c,p,u,g,h,m,y,f,x,_,b,v,k,w,T,A,S){this.gl=e,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.lineShader=r,this.pointShader=o,this.pickShader=i,this.pointPickShader=n,this.contourShader=l,this.trianglePositions=s,this.triangleColors=c,this.triangleNormals=u,this.triangleUVs=p,this.triangleIds=d,this.triangleVAO=g,this.triangleCount=0,this.lineWidth=1,this.edgePositions=h,this.edgeColors=y,this.edgeUVs=f,this.edgeIds=m,this.edgeVAO=x,this.edgeCount=0,this.pointPositions=_,this.pointColors=v,this.pointUVs=k,this.pointSizes=w,this.pointIds=b,this.pointVAO=T,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=A,this.contourVAO=S,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=O,this._view=O,this._projection=O,this._resolution=[1,1]}function r(e,t){if(!t)return 1;if(!t.length)return 1;for(var a=0;a<t.length;++a){if(2>t.length)return 1;if(t[a][0]===e)return t[a][1];if(t[a][0]>e&&0<a){var r=(t[a][0]-e)/(t[a][0]-t[a-1][0]);return t[a][1]*(1-r)+r*t[a-1][1]}}return 1}function o(e,t){for(var a=w({colormap:e,nshades:256,format:"rgba"}),o=new Uint8Array(1024),n=0,l;256>n;++n){l=a[n];for(var s=0;3>s;++s)o[4*n+s]=l[s];o[4*n+3]=t?255*r(n/255,t):255*l[3]}return k(o,[256,256,4],[4,0,1])}function n(e,t,a){for(var r=Array(t),o=0;o<t;++o)r[o]=0;for(var n=e.length,o=0,l;o<n;++o){l=e[o];for(var s=0;s<l.length;++s)r[l[s]]=a[o]}return r}function l(e){for(var t=e.length,a=Array(t),r=0;r<t;++r)a[r]=e[r][2];return a}function s(e){var t=h(e,L.vertex,L.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.normal.location=4,t}function d(e){var t=h(e,E.vertex,E.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t}function c(e){var t=h(e,I.vertex,I.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.pointSize.location=4,t}function p(e){var t=h(e,z.vertex,z.fragment);return t.attributes.position.location=0,t.attributes.id.location=1,t}function u(e){var t=h(e,P.vertex,P.fragment);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.pointSize.location=4,t}function g(e){var t=h(e,D.vertex,D.fragment);return t.attributes.position.location=0,t}var h=e("gl-shader"),m=e("gl-buffer"),y=e("gl-vao"),x=e("gl-texture2d"),_=e("normals"),b=e("gl-mat4/multiply"),v=e("gl-mat4/invert"),k=e("ndarray"),w=e("colormap"),T=e("simplicial-complex-contour"),A=e("typedarray-pool"),S=e("./lib/shaders"),C=e("./lib/closest-point"),L=S.meshShader,E=S.wireShader,I=S.pointShader,z=S.pickShader,P=S.pointPickShader,D=S.contourShader,O=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],R=a.prototype;R.isOpaque=function(){return!this.hasAlpha},R.isTransparent=function(){return this.hasAlpha},R.pickSlots=1,R.setPickBase=function(e){this.pickId=e},R.highlight=function(e){if(!e||!this.contourEnable)return void(this.contourCount=0);for(var t=T(this.cells,this.intensity,e.intensity),r=t.cells,o=t.vertexIds,n=t.vertexWeights,l=r.length,s=A.mallocFloat32(6*l),d=0,p=0,u;p<l;++p){u=r[p];for(var g=0,h;2>g;++g){h=u[0],2===u.length&&(h=u[g]);for(var m=o[h][0],a=o[h][1],y=n[h],f=this.positions[m],x=this.positions[a],_=0;3>_;++_)s[d++]=y*f[_]+(1-y)*x[_]}}this.contourCount=0|d/3,this.contourPositions.update(s.subarray(0,d)),A.free(s)},R.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"contourEnable"in e&&(this.contourEnable=e.contourEnable),"contourColor"in e&&(this.contourColor=e.contourColor),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"lightPosition"in e&&(this.lightPosition=e.lightPosition),this.hasAlpha=!1,"opacity"in e&&(this.opacity=e.opacity,1>this.opacity&&(this.hasAlpha=!0)),"opacityscale"in e&&(this.opacityscale=e.opacityscale,this.hasAlpha=!0),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.texture?(this.texture.dispose(),this.texture=x(t,e.texture)):e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(o(e.colormap,this.opacityscale)),this.texture.generateMipmap());var a=e.cells,s=e.positions;if(s&&a){var d=[],u=[],g=[],h=[],m=[],y=[],b=[],w=[],T=[],A=[],S=[],C=[],L=[],E=[];this.cells=a,this.positions=s;var I=e.vertexNormals,z=e.cellNormals,P=void 0===e.vertexNormalsEpsilon?1e-6:e.vertexNormalsEpsilon,D=void 0===e.faceNormalsEpsilon?1e-6:e.faceNormalsEpsilon;e.useFacetNormals&&!z&&(z=_.faceNormals(a,s,D)),z||I||(I=_.vertexNormals(a,s,P));var O=e.vertexColors,R=e.cellColors,M=e.meshColor||[1,1,1,1],F=e.vertexUVs,B=e.vertexIntensity,N=e.cellUVs,V=e.cellIntensity,U=1/0,H=-Infinity;if(!F&&!N)if(B){if(e.vertexIntensityBounds)U=+e.vertexIntensityBounds[0],H=+e.vertexIntensityBounds[1];else for(var G=0,Y;G<B.length;++G)Y=B[G],U=ea(U,Y),H=va(H,Y);}else if(V)for(var G=0,Y;G<V.length;++G)Y=V[G],U=ea(U,Y),H=va(H,Y);else for(var G=0,Y;G<s.length;++G)Y=s[G][2],U=ea(U,Y),H=va(H,Y);this.intensity=B?B:V?n(a,s.length,V):l(s);var W=e.pointSizes,X=e.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var G=0,Z;G<s.length;++G){Z=s[G];for(var K=0;3>K;++K)!isNaN(Z[K])&&isFinite(Z[K])&&(this.bounds[0][K]=ea(this.bounds[0][K],Z[K]),this.bounds[1][K]=va(this.bounds[1][K],Z[K]))}var J=0,Q=0,$=0;fill_loop:for(var G=0,ee;G<a.length;++G)switch(ee=a[G],ee.length){case 1:for(var te=ee[0],Z=s[te],K=0;3>K;++K)if(isNaN(Z[K])||!isFinite(Z[K]))continue fill_loop;A.push(Z[0],Z[1],Z[2]);var ae;ae=O?O[te]:R?R[G]:M,this.opacityscale&&B?u.push(ae[0],ae[1],ae[2],this.opacity*r((B[te]-U)/(H-U),this.opacityscale)):3===ae.length?S.push(ae[0],ae[1],ae[2],this.opacity):(S.push(ae[0],ae[1],ae[2],ae[3]*this.opacity),!this.hasAlpha&&1>ae[3]&&(this.hasAlpha=!0));var re;re=F?F[te]:B?[(B[te]-U)/(H-U),0]:N?N[G]:V?[(V[G]-U)/(H-U),0]:[(Z[2]-U)/(H-U),0],C.push(re[0],re[1]),W?L.push(W[te]):L.push(X),E.push(G),$+=1;break;case 2:for(var K=0;2>K;++K)for(var te=ee[K],Z=s[te],oe=0;3>oe;++oe)if(isNaN(Z[oe])||!isFinite(Z[oe]))continue fill_loop;for(var K=0;2>K;++K){var te=ee[K],Z=s[te];y.push(Z[0],Z[1],Z[2]);var ae;ae=O?O[te]:R?R[G]:M,this.opacityscale&&B?u.push(ae[0],ae[1],ae[2],this.opacity*r((B[te]-U)/(H-U),this.opacityscale)):3===ae.length?b.push(ae[0],ae[1],ae[2],this.opacity):(b.push(ae[0],ae[1],ae[2],ae[3]*this.opacity),!this.hasAlpha&&1>ae[3]&&(this.hasAlpha=!0));var re;re=F?F[te]:B?[(B[te]-U)/(H-U),0]:N?N[G]:V?[(V[G]-U)/(H-U),0]:[(Z[2]-U)/(H-U),0],w.push(re[0],re[1]),T.push(G)}Q+=1;break;case 3:for(var K=0;3>K;++K)for(var te=ee[K],Z=s[te],oe=0;3>oe;++oe)if(isNaN(Z[oe])||!isFinite(Z[oe]))continue fill_loop;for(var K=0;3>K;++K){var te=ee[2-K],Z=s[te];d.push(Z[0],Z[1],Z[2]);var ae;ae=O?O[te]:R?R[G]:M,this.opacityscale&&B?u.push(ae[0],ae[1],ae[2],this.opacity*r((B[te]-U)/(H-U),this.opacityscale)):3===ae.length?u.push(ae[0],ae[1],ae[2],this.opacity):(u.push(ae[0],ae[1],ae[2],ae[3]*this.opacity),!this.hasAlpha&&1>ae[3]&&(this.hasAlpha=!0));var re;re=F?F[te]:B?[(B[te]-U)/(H-U),0]:N?N[G]:V?[(V[G]-U)/(H-U),0]:[(Z[2]-U)/(H-U),0],h.push(re[0],re[1]);var ie;ie=I?I[te]:z[G],g.push(ie[0],ie[1],ie[2]),m.push(G)}J+=1;break;default:}this.pointCount=$,this.edgeCount=Q,this.triangleCount=J,this.pointPositions.update(A),this.pointColors.update(S),this.pointUVs.update(C),this.pointSizes.update(L),this.pointIds.update(new Uint32Array(E)),this.edgePositions.update(y),this.edgeColors.update(b),this.edgeUVs.update(w),this.edgeIds.update(new Uint32Array(T)),this.trianglePositions.update(d),this.triangleColors.update(u),this.triangleUVs.update(h),this.triangleNormals.update(g),this.triangleIds.update(new Uint32Array(m))}},R.drawTransparent=R.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||O,r=e.view||O,o=e.projection||O,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ea(n[1][l],this.clipBounds[1][l]);var d={model:a,view:r,projection:o,inverseModel:O.slice(),clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};d.inverseModel=v(d.inverseModel,d.model),t.disable(t.CULL_FACE),this.texture.bind(0);var c=Array(16);b(c,d.view,d.model),b(c,d.projection,c),v(c,c);for(var l=0;3>l;++l)d.eyePosition[l]=c[12+l]/c[15];for(var p=c[15],l=0;3>l;++l)p+=this.lightPosition[l]*c[4*l+3];for(var l=0,u;3>l;++l){u=c[12+l];for(var g=0;3>g;++g)u+=c[4*g+l]*this.lightPosition[g];d.lightPosition[l]=u/p}if(0<this.triangleCount){var h=this.triShader;h.bind(),h.uniforms=d,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}if(0<this.edgeCount&&0<this.lineWidth){var h=this.lineShader;h.bind(),h.uniforms=d,this.edgeVAO.bind(),t.lineWidth(this.lineWidth*this.pixelRatio),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()}if(0<this.pointCount){var h=this.pointShader;h.bind(),h.uniforms=d,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&0<this.contourCount&&0<this.contourLineWidth){var h=this.contourShader;h.bind(),h.uniforms=d,this.contourVAO.bind(),t.drawArrays(t.LINES,0,this.contourCount),this.contourVAO.unbind()}},R.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||O,r=e.view||O,o=e.projection||O,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ea(n[1][l],this.clipBounds[1][l]);this._model=[].slice.call(a),this._view=[].slice.call(r),this._projection=[].slice.call(o),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:a,view:r,projection:o,clipBounds:n,pickId:this.pickId/255},d=this.pickShader;if(d.bind(),d.uniforms=s,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),0<this.edgeCount&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth*this.pixelRatio),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),0<this.pointCount){var d=this.pointPickShader;d.bind(),d.uniforms=s,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}},R.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;for(var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],r=this.positions,o=Array(a.length),n=0;n<a.length;++n)o[n]=r[a[n]];var l=C(o,[e.coord[0],this._resolution[1]-e.coord[1]],this._model,this._view,this._projection,this._resolution);if(!l)return null;for(var s=l[2],d=0,n=0;n<a.length;++n)d+=s[n]*this.intensity[a[n]];return{position:l[1],index:a[l[0]],cell:a,cellId:t,intensity:d,dataCoordinate:this.positions[a[l[0]]]}},R.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},t.exports=function(e,t){1===arguments.length&&(t=e,e=t.gl);var r=e.getExtension("OES_standard_derivatives")||e.getExtension("MOZ_OES_standard_derivatives")||e.getExtension("WEBKIT_OES_standard_derivatives");if(!r)throw new Error("derivatives not supported");var o=s(e),i=d(e),n=c(e),l=p(e),h=u(e),f=g(e),_=x(e,k(new Uint8Array([255,255,255,255]),[1,1,4]));_.generateMipmap(),_.minFilter=e.LINEAR_MIPMAP_LINEAR,_.magFilter=e.LINEAR;var b=m(e),v=m(e),w=m(e),T=m(e),A=m(e),S=y(e,[{buffer:b,type:e.FLOAT,size:3},{buffer:A,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:v,type:e.FLOAT,size:4},{buffer:w,type:e.FLOAT,size:2},{buffer:T,type:e.FLOAT,size:3}]),C=m(e),L=m(e),E=m(e),I=m(e),z=y(e,[{buffer:C,type:e.FLOAT,size:3},{buffer:I,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:L,type:e.FLOAT,size:4},{buffer:E,type:e.FLOAT,size:2}]),P=m(e),D=m(e),O=m(e),R=m(e),M=m(e),j=y(e,[{buffer:P,type:e.FLOAT,size:3},{buffer:M,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:D,type:e.FLOAT,size:4},{buffer:O,type:e.FLOAT,size:2},{buffer:R,type:e.FLOAT,size:1}]),F=m(e),B=y(e,[{buffer:F,type:e.FLOAT,size:3}]),N=new a(e,_,o,i,n,l,h,f,b,A,v,w,T,S,C,I,L,E,z,P,M,D,O,R,j,F,B);return N.update(t),N}},{"./lib/closest-point":278,"./lib/shaders":279,colormap:126,"gl-buffer":241,"gl-mat4/invert":265,"gl-mat4/multiply":267,"gl-shader":301,"gl-texture2d":322,"gl-vao":327,ndarray:450,normals:453,"simplicial-complex-contour":518,"typedarray-pool":545}],281:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a}t.exports=function(e){var t=e.gl,n=r(t,[0,0,0,1,1,0,1,1]),l=o(t,i.boxVert,i.lineFrag);return new a(e,n,l)};var r=e("gl-buffer"),o=e("gl-shader"),i=e("./shaders"),n=a.prototype;n.bind=function(){var e=this.shader;this.vbo.bind(),this.shader.bind(),e.attributes.coord.pointer(),e.uniforms.screenBox=this.plot.screenBox},n.drawBox=function(){var e=[0,0],t=[0,0];return function(a,r,o,i,n){var l=this.plot,s=this.shader,d=l.gl;e[0]=a,e[1]=r,t[0]=o,t[1]=i,s.uniforms.lo=e,s.uniforms.hi=t,s.uniforms.color=n,d.drawArrays(d.TRIANGLE_STRIP,0,4)}}(),n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":284,"gl-buffer":241,"gl-shader":301}],282:[function(e,t){"use strict";function a(e,t,a,r){this.plot=e,this.vbo=t,this.shader=a,this.tickShader=r,this.ticks=[[],[]]}function r(e,t){return e-t}t.exports=function(e){var t=e.gl,r=o(t),n=i(t,l.gridVert,l.gridFrag),s=i(t,l.tickVert,l.gridFrag),d=new a(e,r,n,s);return d};var o=e("gl-buffer"),i=e("gl-shader"),n=e("binary-search-bounds"),l=e("./shaders"),s=a.prototype;s.draw=function(){var e=[0,0],t=[0,0],a=[0,0];return function(){for(var r=this.plot,o=this.vbo,n=this.shader,l=this.ticks,s=r.gl,d=r._tickBounds,c=r.dataBox,p=r.viewBox,u=r.gridLineWidth,g=r.gridLineColor,h=r.gridLineEnable,m=r.pixelRatio,y=0;2>y;++y){var f=d[y],x=d[y+2],_=.5*(c[y+2]+c[y]),b=c[y+2]-c[y];t[y]=2*(x-f)/b,e[y]=2*(f-_)/b}n.bind(),o.bind(),n.attributes.dataCoord.pointer(),n.uniforms.dataShift=e,n.uniforms.dataScale=t;for(var v=0,y=0;2>y;++y){a[0]=a[1]=0,a[y]=1,n.uniforms.dataAxis=a,n.uniforms.lineWidth=u[y]/(p[y+2]-p[y])*m,n.uniforms.color=g[y];var k=6*l[y].length;h[y]&&k&&s.drawArrays(s.TRIANGLES,v,k),v+=k}}}(),s.drawTickMarks=function(){var e=[0,0],t=[0,0],a=[1,0],o=[0,1],l=[0,0],s=[0,0];return function(){for(var d=this.plot,c=this.vbo,p=this.tickShader,u=this.ticks,g=d.gl,h=d._tickBounds,m=d.dataBox,y=d.viewBox,f=d.pixelRatio,x=d.screenBox,_=x[2]-x[0],b=x[3]-x[1],v=y[2]-y[0],k=y[3]-y[1],w=0;2>w;++w){var T=h[w],A=h[w+2],S=.5*(m[w+2]+m[w]),C=m[w+2]-m[w];t[w]=2*(A-T)/C,e[w]=2*(T-S)/C}t[0]*=v/_,e[0]*=v/_,t[1]*=k/b,e[1]*=k/b,p.bind(),c.bind(),p.attributes.dataCoord.pointer();var L=p.uniforms;L.dataShift=e,L.dataScale=t;var E=d.tickMarkLength,I=d.tickMarkWidth,z=d.tickMarkColor,P=6*u[0].length,D=ea(n.ge(u[0],(m[0]-h[0])/(h[2]-h[0]),r),u[0].length),O=ea(n.gt(u[0],(m[2]-h[0])/(h[2]-h[0]),r),u[0].length),R=0+6*D,M=6*va(0,O-D),j=ea(n.ge(u[1],(m[1]-h[1])/(h[3]-h[1]),r),u[1].length),F=ea(n.gt(u[1],(m[3]-h[1])/(h[3]-h[1]),r),u[1].length),B=P+6*j,N=6*va(0,F-j);l[0]=2*(y[0]-E[1])/_-1,l[1]=(y[3]+y[1])/b-1,s[0]=E[1]*f/_,s[1]=I[1]*f/b,N&&(L.color=z[1],L.tickScale=s,L.dataAxis=o,L.screenOffset=l,g.drawArrays(g.TRIANGLES,B,N)),l[0]=(y[2]+y[0])/_-1,l[1]=2*(y[1]-E[0])/b-1,s[0]=I[0]*f/_,s[1]=E[0]*f/b,M&&(L.color=z[0],L.tickScale=s,L.dataAxis=a,L.screenOffset=l,g.drawArrays(g.TRIANGLES,R,M)),l[0]=2*(y[2]+E[3])/_-1,l[1]=(y[3]+y[1])/b-1,s[0]=E[3]*f/_,s[1]=I[3]*f/b,N&&(L.color=z[3],L.tickScale=s,L.dataAxis=o,L.screenOffset=l,g.drawArrays(g.TRIANGLES,B,N)),l[0]=(y[2]+y[0])/_-1,l[1]=2*(y[3]+E[2])/b-1,s[0]=I[2]*f/_,s[1]=E[2]*f/b,M&&(L.color=z[2],L.tickScale=s,L.dataAxis=a,L.screenOffset=l,g.drawArrays(g.TRIANGLES,R,M))}}(),s.update=function(){var e=[1,1,-1,-1,1,-1],t=[1,-1,1,1,-1,-1];return function(a){for(var r=a.ticks,o=a.bounds,n=new Float32Array(18*(r[0].length+r[1].length)),l=this.plot.zeroLineEnable,s=0,d=[[],[]],c=0;2>c;++c)for(var p=d[c],u=r[c],g=o[c],h=o[c+2],m=0,y;m<u.length;++m){y=(u[m].x-g)/(h-g),p.push(y);for(var f=0;6>f;++f)n[s++]=y,n[s++]=e[f],n[s++]=t[f]}this.ticks=d,this.vbo.update(n)}}(),s.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":284,"binary-search-bounds":286,"gl-buffer":241,"gl-shader":301}],283:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a}t.exports=function(e){var t=e.gl,n=r(t,[-1,-1,-1,1,1,-1,1,1]),l=o(t,i.lineVert,i.lineFrag),s=new a(e,n,l);return s};var r=e("gl-buffer"),o=e("gl-shader"),i=e("./shaders"),n=a.prototype;n.bind=function(){var e=this.shader;this.vbo.bind(),this.shader.bind(),e.attributes.coord.pointer(),e.uniforms.screenBox=this.plot.screenBox},n.drawLine=function(){var e=[0,0],t=[0,0];return function(a,r,o,i,n,l){var s=this.plot,d=this.shader,c=s.gl;e[0]=a,e[1]=r,t[0]=o,t[1]=i,d.uniforms.start=e,d.uniforms.end=t,d.uniforms.width=n*s.pixelRatio,d.uniforms.color=l,c.drawArrays(c.TRIANGLE_STRIP,0,4)}}(),n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":284,"gl-buffer":241,"gl-shader":301}],284:[function(e,t){"use strict";var a=e("glslify"),r=a(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);t.exports={lineVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:r,textVert:a(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:r,gridVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:r,boxVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:409}],285:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}t.exports=function(e){var t=e.gl,i=r(t),n=o(t,s.textVert,s.textFrag),l=new a(e,i,n);return l};var r=e("gl-buffer"),o=e("gl-shader"),n=e("text-cache"),l=e("binary-search-bounds"),s=e("./shaders"),d=a.prototype;d.drawTicks=function(){var e=[0,0],t=[0,0],a=[0,0];return function(r){var o=this.plot,i=this.shader,n=this.tickX[r],s=this.tickOffset[r],d=o.gl,c=o.viewBox,p=o.dataBox,u=o.screenBox,g=o.pixelRatio,h=o.tickEnable,m=o.tickPad,y=o.tickColor,f=o.tickAngle,x=o.labelEnable,_=o.labelPad,b=o.labelColor,v=o.labelAngle,k=this.labelOffset[r],w=this.labelCount[r],T=l.lt(n,p[r]),A=l.le(n,p[r+2]);e[0]=e[1]=0,e[r]=1,t[r]=(c[2+r]+c[r])/(u[2+r]-u[r])-1;var S=2/u[2+(1^r)]-u[1^r];t[1^r]=S*c[1^r]-1,h[r]&&(t[1^r]-=S*g*m[r],T<A&&s[A]>s[T]&&(i.uniforms.dataAxis=e,i.uniforms.screenOffset=t,i.uniforms.color=y[r],i.uniforms.angle=f[r],d.drawArrays(d.TRIANGLES,s[T],s[A]-s[T]))),x[r]&&w&&(t[1^r]-=S*g*_[r],i.uniforms.dataAxis=a,i.uniforms.screenOffset=t,i.uniforms.color=b[r],i.uniforms.angle=v[r],d.drawArrays(d.TRIANGLES,k,w)),t[1^r]=S*c[2+(1^r)]-1,h[r+2]&&(t[1^r]+=S*g*m[r+2],T<A&&s[A]>s[T]&&(i.uniforms.dataAxis=e,i.uniforms.screenOffset=t,i.uniforms.color=y[r+2],i.uniforms.angle=f[r+2],d.drawArrays(d.TRIANGLES,s[T],s[A]-s[T]))),x[r+2]&&w&&(t[1^r]+=S*g*_[r+2],i.uniforms.dataAxis=a,i.uniforms.screenOffset=t,i.uniforms.color=b[r+2],i.uniforms.angle=v[r+2],d.drawArrays(d.TRIANGLES,k,w))}}(),d.drawTitle=function(){var e=[0,0],t=[0,0];return function(){var a=this.plot,r=this.shader,o=a.gl,n=a.screenBox,l=a.titleCenter,s=a.titleAngle,d=a.titleColor,c=a.pixelRatio;if(this.titleCount){for(var p=0;2>p;++p)t[p]=2*(l[p]*c-n[p])/(n[2+p]-n[p])-1;r.bind(),r.uniforms.dataAxis=e,r.uniforms.screenOffset=t,r.uniforms.angle=s,r.uniforms.color=d,o.drawArrays(o.TRIANGLES,this.titleOffset,this.titleCount)}}}(),d.bind=function(){var e=[0,0],t=[0,0],a=[0,0];return function(){var r=this.plot,o=this.shader,n=r._tickBounds,l=r.dataBox,s=r.screenBox,d=r.viewBox;o.bind();for(var c=0;2>c;++c){var p=n[c],u=n[c+2],g=.5*(l[c+2]+l[c]),h=l[c+2]-l[c],m=d[c],y=d[c+2],f=y-m,x=s[c],_=s[c+2],b=_-x;t[c]=2*(u-p)/h*f/b,e[c]=2*(p-g)/h*f/b}a[1]=2*r.pixelRatio/(s[3]-s[1]),a[0]=a[1]*(s[3]-s[1])/(s[2]-s[0]),o.uniforms.dataScale=t,o.uniforms.dataShift=e,o.uniforms.textScale=a,this.vbo.bind(),o.attributes.textCoordinate.pointer()}}(),d.update=function(e){var t=[],a=e.ticks,o=e.bounds,l,s,d,c,p;for(p=0;2>p;++p){var u=[ba(t.length/3)],g=[-Infinity],h=a[p];for(l=0;l<h.length;++l){var m=h[l],y=m.x,f=m.text,x=m.font||"sans-serif";c=m.fontSize||12;for(var _=1/(o[p+2]-o[p]),b=o[p],v=f.split("\n"),k=0;k<v.length;k++)for(d=n(x,v[k]).data,s=0;s<d.length;s+=2)t.push(d[s]*c,-d[s+1]*c-1.2*(k*c),(y-b)*_);u.push(ba(t.length/3)),g.push(y)}this.tickOffset[p]=u,this.tickX[p]=g}for(p=0;2>p;++p){for(this.labelOffset[p]=ba(t.length/3),d=n(e.labelFont[p],e.labels[p],{textAlign:"center"}).data,c=e.labelSize[p],l=0;l<d.length;l+=2)t.push(d[l]*c,-d[l+1]*c,0);this.labelCount[p]=ba(t.length/3)-this.labelOffset[p]}for(this.titleOffset=ba(t.length/3),d=n(e.titleFont,e.title).data,c=e.titleSize,l=0;l<d.length;l+=2)t.push(d[l]*c,-d[l+1]*c,0);this.titleCount=ba(t.length/3)-this.titleOffset,this.vbo.update(t)},d.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":284,"binary-search-bounds":286,"gl-buffer":241,"gl-shader":301,"text-cache":536}],286:[function(e,t,a){arguments[4][111][0].apply(a,arguments)},{dup:111}],287:[function(e,t){"use strict";function a(e,t){this.gl=e,this.pickBuffer=t,this.screenBox=[0,0,e.drawingBufferWidth,e.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Pe/2,0,3*Pe/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-Infinity,-Infinity],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}function r(e){for(var t=e.slice(),a=0;a<t.length;++a)t[a]=t[a].slice();return t}function o(e,t){return e.x-t.x}t.exports=function(e){var t=e.gl,r=i(t,[t.drawingBufferWidth,t.drawingBufferHeight]),o=new a(t,r);return o.grid=n(o),o.text=l(o),o.line=s(o),o.box=d(o),o.update(e),o};var i=e("gl-select-static"),n=e("./lib/grid"),l=e("./lib/text"),s=e("./lib/line"),d=e("./lib/box"),c=a.prototype;c.setDirty=function(){this.dirty=this.pickDirty=!0},c.setOverlayDirty=function(){this.dirty=!0},c.nextDepthValue=function(){return this._depthCounter++/65536},c.draw=function(){return function(){var e=this.gl,t=this.screenBox,a=this.viewBox,r=this.dataBox,o=this.pixelRatio,n=this.grid,l=this.line,s=this.text,d=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,e.bindFramebuffer(e.FRAMEBUFFER,null),e.enable(e.SCISSOR_TEST),e.disable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!1),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD,e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.borderColor){e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]);var c=this.borderColor;e.clearColor(c[0]*c[3],c[1]*c[3],c[2]*c[3],c[3]),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}e.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]),e.viewport(a[0],a[1],a[2]-a[0],a[3]-a[1]);var p=this.backgroundColor;e.clearColor(p[0]*p[3],p[1]*p[3],p[2]*p[3],p[3]),e.clear(e.COLOR_BUFFER_BIT),n.draw();var u=this.zeroLineEnable,g=this.zeroLineColor,h=this.zeroLineWidth;if(u[0]||u[1]){l.bind();for(var m=0;2>m;++m)if(u[m]&&0>=r[m]&&0<=r[m+2]){var y=t[m]-r[m]*(t[m+2]-t[m])/(r[m+2]-r[m]);0==m?l.drawLine(y,t[1],y,t[3],h[m],g[m]):l.drawLine(t[0],y,t[2],y,h[m],g[m])}}for(var m=0;m<d.length;++m)d[m].draw();e.viewport(t[0],t[1],t[2]-t[0],t[3]-t[1]),e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]),this.grid.drawTickMarks(),l.bind();var f=this.borderLineEnable,x=this.borderLineWidth,_=this.borderLineColor;f[1]&&l.drawLine(a[0],a[1]-.5*x[1]*o,a[0],a[3]+.5*x[3]*o,x[1],_[1]),f[0]&&l.drawLine(a[0]-.5*x[0]*o,a[1],a[2]+.5*x[2]*o,a[1],x[0],_[0]),f[3]&&l.drawLine(a[2],a[1]-.5*x[1]*o,a[2],a[3]+.5*x[3]*o,x[3],_[3]),f[2]&&l.drawLine(a[0]-.5*x[0]*o,a[3],a[2]+.5*x[2]*o,a[3],x[2],_[2]),s.bind();for(var m=0;2>m;++m)s.drawTicks(m);this.titleEnable&&s.drawTitle();for(var b=this.overlays,m=0;m<b.length;++m)b[m].draw();e.disable(e.SCISSOR_TEST),e.disable(e.BLEND),e.depthMask(!0)}}}(),c.drawPick=function(){return function(){if(!this.static){var e=this.pickBuffer,t=this.gl;this._pickTimeout=null,e.begin();for(var a=1,r=this.objects,o=0;o<r.length;++o)a=r[o].drawPick(a);e.end()}}}(),c.pick=function(){return function(e,t){if(!this.static){var a=this.pixelRatio,r=this.pickPixelRatio,o=this.viewBox,n=0|V((e-o[0]/a)*r),l=0|V((t-o[1]/a)*r),s=this.pickBuffer.query(n,l,this.pickRadius);if(!s)return null;for(var d=s.id+(s.value[0]<<8)+(s.value[1]<<16)+(s.value[2]<<24),c=this.objects,p=0,u;p<c.length;++p)if(u=c[p].pick(n,l,d),u)return u;return null}}}(),c.setScreenBox=function(e){var t=this.screenBox,a=this.pixelRatio;t[0]=0|V(e[0]*a),t[1]=0|V(e[1]*a),t[2]=0|V(e[2]*a),t[3]=0|V(e[3]*a),this.setDirty()},c.setDataBox=function(e){var t=this.dataBox,a=t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3];a&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this.setDirty())},c.setViewBox=function(e){var t=this.pixelRatio,a=this.viewBox;a[0]=0|V(e[0]*t),a[1]=0|V(e[1]*t),a[2]=0|V(e[2]*t),a[3]=0|V(e[3]*t);var r=this.pickPixelRatio;this.pickBuffer.shape=[0|V((e[2]-e[0])*r),0|V((e[3]-e[1])*r)],this.setDirty()},c.update=function(e){e=e||{};var t=this.gl;this.pixelRatio=e.pixelRatio||1;var a=this.pixelRatio;this.pickPixelRatio=va(a,1),this.setScreenBox(e.screenBox||[0,0,t.drawingBufferWidth/a,t.drawingBufferHeight/a]);this.screenBox;this.setViewBox(e.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/a,.125*(this.screenBox[3]-this.screenBox[1])/a,.875*(this.screenBox[2]-this.screenBox[0])/a,.875*(this.screenBox[3]-this.screenBox[1])/a]);var n=this.viewBox,l=(n[2]-n[0])/(n[3]-n[1]);this.setDataBox(e.dataBox||[-10,-10/l,10,10/l]),this.borderColor=!1!==e.borderColor&&(e.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(e.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(e.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(e.gridLineWidth||[1,1]).slice(),this.gridLineColor=r(e.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(e.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(e.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=r(e.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(e.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(e.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=r(e.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(e.titleCenter||[.5*(n[0]+n[2])/a,(n[3]+120)/a]).slice(),this.titleEnable=!("titleEnable"in e)||!!e.titleEnable,this.titleAngle=e.titleAngle||0,this.titleColor=(e.titleColor||[0,0,0,1]).slice(),this.labelPad=(e.labelPad||[15,15,15,15]).slice(),this.labelAngle=(e.labelAngle||[0,Pe/2,0,3*Pe/2]).slice(),this.labelEnable=(e.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=r(e.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(e.tickPad||[15,15,15,15]).slice(),this.tickAngle=(e.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(e.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=r(e.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(e.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(e.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=r(e.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var s=e.ticks||[[],[]],d=this._tickBounds;d[0]=d[1]=1/0,d[2]=d[3]=-Infinity;for(var c=0,p;2>c;++c)(p=s[c].slice(0),0!==p.length)&&(p.sort(o),d[c]=ea(d[c],p[0].x),d[c+2]=va(d[c+2],p[p.length-1].x));this.grid.update({bounds:d,ticks:s}),this.text.update({bounds:d,ticks:s,labels:e.labels||["x","y"],labelSize:e.labelSize||[12,12],labelFont:e.labelFont||["sans-serif","sans-serif"],title:e.title||"",titleSize:e.titleSize||18,titleFont:e.titleFont||"sans-serif"}),this.static=!!e.static,this.setDirty()},c.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var e=this.objects.length-1;0<=e;--e)this.objects[e].dispose();this.objects.length=0;for(var e=this.overlays.length-1;0<=e;--e)this.overlays[e].dispose();this.overlays.length=0,this.gl=null},c.addObject=function(e){0>this.objects.indexOf(e)&&(this.objects.push(e),this.setDirty())},c.removeObject=function(e){for(var t=this.objects,a=0;a<t.length;++a)if(t[a]===e){t.splice(a,1),this.setDirty();break}},c.addOverlay=function(e){0>this.overlays.indexOf(e)&&(this.overlays.push(e),this.setOverlayDirty())},c.removeOverlay=function(e){for(var t=this.overlays,a=0;a<t.length;++a)if(t[a]===e){t.splice(a,1),this.setOverlayDirty();break}}},{"./lib/box":281,"./lib/grid":282,"./lib/line":283,"./lib/text":285,"gl-select-static":300}],288:[function(e,t){"use strict";function a(e,t){e=e||document.body,t=t||{};var a=[.01,1/0];"distanceLimits"in t&&(a[0]=t.distanceLimits[0],a[1]=t.distanceLimits[1]),"zoomMin"in t&&(a[0]=t.zoomMin),"zoomMax"in t&&(a[1]=t.zoomMax);var c=o({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:a}),p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u=0,g=e.clientWidth,h=e.clientHeight,f={keyBindingMode:"rotate",enableWheel:!0,view:c,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:c.modes,_ortho:t._ortho||t.projection&&"orthographic"===t.projection.type||!1,tick:function(){var a=r(),t=this.delay;c.idle(a-t),c.recalcMatrix(a-2*t),c.flush(a-(100+2*t));for(var o=!0,n=c.computedMatrix,l=0;16>l;++l)o=o&&p[l]===n[l],p[l]=n[l];var s=e.clientWidth===g&&e.clientHeight===h;return(g=e.clientWidth,h=e.clientHeight,o)?!s:(u=m(c.computedRadius[0]),!0)},lookAt:function(e,t,a){c.lookAt(c.lastT(),e,t,a)},rotate:function(e,t,a){c.rotate(c.lastT(),e,t,a)},pan:function(e,t,a){c.pan(c.lastT(),e,t,a)},translate:function(e,t,a){c.translate(c.lastT(),e,t,a)}};return Object.defineProperties(f,{matrix:{get:function(){return c.computedMatrix},set:function(e){return c.setMatrix(c.lastT(),e),c.computedMatrix},enumerable:!0},mode:{get:function(){return c.getMode()},set:function(e){var t=c.computedUp.slice(),a=c.computedEye.slice(),o=c.computedCenter.slice();if(c.setMode(e),"turntable"===e){var i=r();c._active.lookAt(i,a,o,t),c._active.lookAt(i+500,a,o,[0,0,1]),c._active.flush(i)}return c.getMode()},enumerable:!0},center:{get:function(){return c.computedCenter},set:function(e){return c.lookAt(c.lastT(),null,e),c.computedCenter},enumerable:!0},eye:{get:function(){return c.computedEye},set:function(e){return c.lookAt(c.lastT(),e),c.computedEye},enumerable:!0},up:{get:function(){return c.computedUp},set:function(e){return c.lookAt(c.lastT(),null,null,e),c.computedUp},enumerable:!0},distance:{get:function(){return u},set:function(e){return c.setDistance(c.lastT(),e),e},enumerable:!0},distanceLimits:{get:function(){return c.getDistanceLimits(a)},set:function(e){return c.setDistanceLimits(e),e},enumerable:!0}}),e.addEventListener("contextmenu",function(e){return e.preventDefault(),!1}),f._lastX=-1,f._lastY=-1,f._lastMods={shift:!1,control:!1,alt:!1,meta:!1},f.enableMouseListeners=function(){function t(a,o,i,n){var l=f.keyBindingMode;if(!1!==l){var s=!!n.control,d=!!n.alt,p=!!n.shift,g=!!(1&a),h=1/e.clientHeight,y=h*(o-f._lastX),x=h*(i-f._lastY),_=f.flipX?1:-1,b=f.flipY?1:-1,v=Pe*f.rotateSpeed,k=r();if(-1!==f._lastX&&-1!==f._lastY&&((!("rotate"===l)||!g||s||d||p)&&(!g||s||d||!p)||c.rotate(k,_*v*y,-b*v*x,0),("pan"===l&&g&&!s&&!d&&!p||!!(2&a)||g&&s&&!d&&!p)&&c.pan(k,-f.translateSpeed*y*u,f.translateSpeed*x*u,0),"zoom"===l&&g&&!s&&!d&&!p||!!(4&a)||g&&!s&&d&&!p)){var t=100*(-f.zoomSpeed*x/window.innerHeight*(k-c.lastT()));c.pan(k,0,0,u*(m(t)-1))}return f._lastX=o,f._lastY=i,f._lastMods=n,!0}}f.mouseListener=i(e,t),e.addEventListener("touchstart",function(a){var r=l(a.changedTouches[0],e);t(0,r[0],r[1],f._lastMods),t(1,r[0],r[1],f._lastMods),a.preventDefault()},!!s&&{passive:!1}),e.addEventListener("touchmove",function(a){var r=l(a.changedTouches[0],e);t(1,r[0],r[1],f._lastMods),a.preventDefault()},!!s&&{passive:!1}),e.addEventListener("touchend",function(e){t(0,f._lastX,f._lastY,f._lastMods),e.preventDefault()},!!s&&{passive:!1}),f.wheelListener=n(e,function(e,a){if(!1!==f.keyBindingMode&&f.enableWheel){var o=f.flipX?1:-1,i=f.flipY?1:-1,n=r();if(_a(e)>_a(a))c.rotate(n,0,0,-e*o*Pe*f.rotateSpeed/window.innerWidth);else if(!f._ortho){var t=-f.zoomSpeed*i*a/window.innerHeight*(n-c.lastT())/20;c.pan(n,0,0,u*(m(t)-1))}}},!0)},f.enableMouseListeners(),f}t.exports=a;var r=e("right-now"),o=e("3d-view"),i=e("mouse-change"),n=e("mouse-wheel"),l=e("mouse-event-offset"),s=e("has-passive-events")},{"3d-view":52,"has-passive-events":411,"mouse-change":435,"mouse-event-offset":436,"mouse-wheel":438,"right-now":504}],289:[function(e,t){var a=e("glslify"),r=e("gl-shader"),o=a(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),i=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);t.exports=function(e){return r(e,o,i,null,[{name:"position",type:"vec2"}])}},{"gl-shader":301,glslify:409}],290:[function(e,t){"use strict";function a(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function r(e,t){var a=null;try{a=e.getContext("webgl",t),a||(a=e.getContext("experimental-webgl",t))}catch(t){return null}return a}function o(e){var t=V(P(_a(e))/P(10));if(0>t){var a=V(ya(10,-t));return M(e*a)/a}if(0<t){var a=V(ya(10,t));return M(e/a)*a}return M(e)}function i(e){return"boolean"!=typeof e||e}var n=e("./camera.js"),l=e("gl-axes3d"),s=e("gl-axes3d/properties"),d=e("gl-spikes3d"),c=e("gl-select-static"),p=e("gl-fbo"),u=e("a-big-triangle"),g=e("mouse-change"),h=e("mouse-wheel"),m=e("gl-mat4/perspective"),y=e("gl-mat4/ortho"),f=e("./lib/shader"),x=e("is-mobile")({tablet:!0});t.exports={createScene:function(e){function t(){if(!K._stopped&&K.autoResize){var e=T.parentNode,t=1,a=1;e&&e!==document.body?(t=e.clientWidth,a=e.clientHeight):(t=window.innerWidth,a=window.innerHeight);var r=0|M(t*K.pixelRatio),o=0|M(a*K.pixelRatio);if(r!==T.width||o!==T.height){T.width=r,T.height=o;var i=T.style;i.position=i.position||"absolute",i.left="0px",i.top="0px",i.width=t+"px",i.height=a+"px",H=!0}}}function _(){for(var e=B.length,t=U.length,a=0;a<t;++a)V[a]=0;obj_loop:for(var a=0;a<e;++a){var r=B[a],o=r.pickSlots;if(!o){N[a]=-1;continue}for(var n=0;n<t;++n)if(255>V[n]+o){N[a]=n,r.setPickBase(V[n]+1),V[n]+=o;continue obj_loop}var l=c(S,X);N[a]=t,U.push(l),V.push(o),r.setPickBase(1),t+=1}for(;0<t&&0===V[t-1];)V.pop(),U.pop().dispose()}function b(){return!!K.contextLost||void(S.isContextLost()&&(K.contextLost=!0,K.mouseListener.enabled=!1,K.selection.object=null,K.oncontextloss&&K.oncontextloss()))}function v(){if(!b()){S.colorMask(!0,!0,!0,!0),S.depthMask(!0),S.disable(S.BLEND),S.enable(S.DEPTH_TEST),S.depthFunc(S.LEQUAL);for(var e=B.length,t=U.length,a=0,r;a<t;++a){r=U[a],r.shape=J,r.begin();for(var o=0;o<e;++o)if(N[o]===a){var n=B[o];n.drawPick&&(n.pixelRatio=1,n.drawPick(W))}r.end()}}}function k(){if(!b()){t();var e=K.camera.tick();W.view=K.camera.matrix,H=H||e,G=G||e,O.pixelRatio=K.pixelRatio,F.pixelRatio=K.pixelRatio;var a=B.length,r=Q[0],n=Q[1];r[0]=r[1]=r[2]=1/0,n[0]=n[1]=n[2]=-Infinity;for(var l=0,d;l<a;++l){d=B[l],d.pixelRatio=K.pixelRatio,d.axes=K.axes,H=H||!!d.dirty,G=G||!!d.dirty;var c=d.bounds;if(c)for(var p=c[0],g=c[1],h=0;3>h;++h)r[h]=ea(r[h],p[h]),n[h]=va(n[h],g[h])}var f=K.bounds;if(K.autoBounds)for(var h=0;3>h;++h){if(n[h]<r[h])r[h]=-1,n[h]=1;else{r[h]===n[h]&&(r[h]-=1,n[h]+=1);var x=.05*(n[h]-r[h]);r[h]-=x,n[h]+=x}f[0][h]=r[h],f[1][h]=n[h]}for(var _=!1,h=0;3>h;++h)_=_||$[0][h]!==f[0][h]||$[1][h]!==f[1][h],$[0][h]=f[0][h],$[1][h]=f[1][h];if(G=G||_,H=H||_,!!H){if(_){for(var k=[0,0,0],l=0;3>l;++l)k[l]=o((f[1][l]-f[0][l])/10);O.autoTicks?O.update({bounds:f,tickSpacing:k}):O.update({bounds:f})}var w=S.drawingBufferWidth,T=S.drawingBufferHeight;X[0]=w,X[1]=T,J[0]=0|va(w/K.pixelRatio,1),J[1]=0|va(T/K.pixelRatio,1),z?(y(q,-w/T,w/T,-1,1,K.zNear,K.zFar),W._ortho=!0):(m(q,K.fovy,w/T,K.zNear,K.zFar),W._ortho=!1);for(var l=0;16>l;++l)Y[l]=0;Y[15]=1;for(var A=0,l=0;3>l;++l)A=va(A,f[1][l]-f[0][l]);for(var l=0;3>l;++l)Y[5*l]=K.autoScale?K.aspect[l]/(f[1][l]-f[0][l]):1/A,K.autoCenter&&(Y[12+l]=.5*-Y[5*l]*(f[0][l]+f[1][l]));for(var l=0,d;l<a;++l)d=B[l],d.axesBounds=f,K.clipToBounds&&(d.clipBounds=f);L.object&&(F.position=K.snapToData?L.dataCoordinate:L.dataPosition,F.bounds=f),G&&(G=!1,v()),K.axesPixels=s(K.axes,W,w,T),K.onrender&&K.onrender(),S.bindFramebuffer(S.FRAMEBUFFER,null),S.viewport(0,0,w,T);var C=K.clearColor;S.clearColor(C[0],C[1],C[2],C[3]),S.clear(S.COLOR_BUFFER_BIT|S.DEPTH_BUFFER_BIT),S.depthMask(!0),S.colorMask(!0,!0,!0,!0),S.enable(S.DEPTH_TEST),S.depthFunc(S.LEQUAL),S.disable(S.BLEND),S.disable(S.CULL_FACE);var P=!1;O.enable&&(P=P||O.isTransparent(),O.draw(W)),F.axes=O,L.object&&F.draw(W),S.disable(S.CULL_FACE);for(var l=0,d;l<a;++l)d=B[l],d.axes=O,d.pixelRatio=K.pixelRatio,d.isOpaque&&d.isOpaque()&&d.draw(W),d.isTransparent&&d.isTransparent()&&(P=!0);if(P){E.shape=X,E.bind(),S.clear(S.DEPTH_BUFFER_BIT),S.colorMask(!1,!1,!1,!1),S.depthMask(!0),S.depthFunc(S.LESS),O.enable&&O.isTransparent()&&O.drawTransparent(W);for(var l=0,d;l<a;++l)d=B[l],d.isOpaque&&d.isOpaque()&&d.draw(W);S.enable(S.BLEND),S.blendEquation(S.FUNC_ADD),S.blendFunc(S.ONE,S.ONE_MINUS_SRC_ALPHA),S.colorMask(!0,!0,!0,!0),S.depthMask(!1),S.clearColor(0,0,0,0),S.clear(S.COLOR_BUFFER_BIT),O.isTransparent()&&O.drawTransparent(W);for(var l=0,d;l<a;++l)d=B[l],d.isTransparent&&d.isTransparent()&&d.drawTransparent(W);S.bindFramebuffer(S.FRAMEBUFFER,null),S.blendFunc(S.ONE,S.ONE_MINUS_SRC_ALPHA),S.disable(S.DEPTH_TEST),I.bind(),E.color[0].bind(0),I.uniforms.accumBuffer=0,u(S),S.disable(S.BLEND)}H=!1;for(var l=0;l<a;++l)B[l].dirty=!1}}}function w(){K._stopped||K.contextLost||(k(),requestAnimationFrame(w))}e=e||{},e.camera=e.camera||{};var T=e.canvas;if(!T)if(T=document.createElement("canvas"),e.container){var A=e.container;A.appendChild(T)}else document.body.appendChild(T);var S=e.gl;if(S||(S=r(T,e.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:x})),!S)throw new Error("webgl not supported");var C=e.bounds||[[-10,-10,-10],[10,10,10]],L=new a,E=p(S,[S.drawingBufferWidth,S.drawingBufferHeight],{preferFloat:!x}),I=f(S),z=e.cameraObject&&!0===e.cameraObject._ortho||e.camera.projection&&"orthographic"===e.camera.projection.type||!1,P={eye:e.camera.eye||[2,0,0],center:e.camera.center||[0,0,0],up:e.camera.up||[0,1,0],zoomMin:e.camera.zoomMax||.1,zoomMax:e.camera.zoomMin||100,mode:e.camera.mode||"turntable",_ortho:z},D=e.axes||{},O=l(S,D);O.enable=!D.disable;var R=e.spikes||{},F=d(S,R),B=[],N=[],V=[],U=[],H=!0,G=!0,q=Array(16),Y=Array(16),W={view:null,projection:q,model:Y,_ortho:!1},G=!0,X=[S.drawingBufferWidth,S.drawingBufferHeight],Z=e.cameraObject||n(T,P),K={gl:S,contextLost:!1,pixelRatio:e.pixelRatio||1,canvas:T,selection:L,camera:Z,axes:O,axesPixels:null,spikes:F,bounds:C,objects:B,shape:X,aspect:e.aspectRatio||[1,1,1],pickRadius:e.pickRadius||10,zNear:e.zNear||.01,zFar:e.zFar||1e3,fovy:e.fovy||Pe/4,clearColor:e.clearColor||[0,0,0,0],autoResize:i(e.autoResize),autoBounds:i(e.autoBounds),autoScale:!!e.autoScale,autoCenter:i(e.autoCenter),clipToBounds:i(e.clipToBounds),snapToData:!!e.snapToData,onselect:e.onselect||null,onrender:e.onrender||null,onclick:e.onclick||null,cameraParams:W,oncontextloss:null,mouseListener:null,_stopped:!1},J=[0|S.drawingBufferWidth/K.pixelRatio,0|S.drawingBufferHeight/K.pixelRatio];K.autoResize&&t(),window.addEventListener("resize",t),K.update=function(e){K._stopped||(e=e||{},H=!0,G=!0)},K.add=function(e){K._stopped||(e.axes=O,B.push(e),N.push(-1),H=!0,G=!0,_())},K.remove=function(e){if(!K._stopped){var t=B.indexOf(e);0>t||(B.splice(t,1),N.pop(),H=!0,G=!0,_())}},K.dispose=function(){if(!K._stopped&&(K._stopped=!0,window.removeEventListener("resize",t),T.removeEventListener("webglcontextlost",b),K.mouseListener.enabled=!1,!K.contextLost)){O.dispose(),F.dispose();for(var e=0;e<B.length;++e)B[e].dispose();E.dispose();for(var e=0;e<U.length;++e)U[e].dispose();I.dispose(),S=null,O=null,F=null,B=[]}},K.wheelListener=h(T,function(e,t){if(!1!==Z.keyBindingMode&&Z.enableWheel&&Z._ortho){var a=e>t?1.1:1/1.1;K.aspect[0]*=a,K.aspect[1]*=a,K.aspect[2]*=a,K.redraw()}},!0),K._mouseRotating=!1,K._prevButtons=0,K.enableMouseListeners=function(){K.mouseListener=g(T,function(e,t,a){if(!K._stopped){var r=U.length,o=B.length,n=L.object;L.distance=1/0,L.mouse[0]=t,L.mouse[1]=a,L.object=null,L.screen=null,L.dataCoordinate=L.dataPosition=null;var l=!1;if(e&&K._prevButtons)K._mouseRotating=!0;else{K._mouseRotating&&(G=!0),K._mouseRotating=!1;for(var s=0,d;s<r;++s)if(d=U[s].query(t,J[1]-a-1,K.pickRadius),d){if(d.distance>L.distance)continue;for(var c=0,p;c<o;++c)if(p=B[c],N[c]===s){var u=p.pick(d);u&&(L.buttons=e,L.screen=d.coord,L.distance=d.distance,L.object=p,L.index=u.distance,L.dataPosition=u.position,L.dataCoordinate=u.dataCoordinate,L.data=u,l=!0)}}}n&&n!==L.object&&(n.highlight&&n.highlight(null),H=!0),L.object&&(L.object.highlight&&L.object.highlight(L.data),H=!0),l=l||L.object!==n,l&&K.onselect&&K.onselect(L),1&e&&!(1&K._prevButtons)&&K.onclick&&K.onclick(L),K._prevButtons=e}})},T.addEventListener("webglcontextlost",b);var Q=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],$=[Q[0].slice(),Q[1].slice()];return K.enableMouseListeners(),w(),K.redraw=function(){K._stopped||(H=!0,k())},K},createCamera:n}},{"./camera.js":288,"./lib/shader":289,"a-big-triangle":59,"gl-axes3d":233,"gl-axes3d/properties":240,"gl-fbo":249,"gl-mat4/ortho":268,"gl-mat4/perspective":269,"gl-select-static":300,"gl-spikes3d":310,"is-mobile":420,"mouse-change":435,"mouse-wheel":438}],291:[function(e,t,a){var r=e("glslify");a.pointVertex=r(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),a.pointFragment=r(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),a.pickVertex=r(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),a.pickFragment=r(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:409}],292:[function(e,t){"use strict";function a(e,t,a,r,o){this.plot=e,this.offsetBuffer=t,this.pickBuffer=a,this.shader=r,this.pickShader=o,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}function r(e,t){var a=0,r=e.length>>>1,o;for(o=0;o<r;o++){var n=e[2*o],l=e[2*o+1];n>=t[0]&&n<=t[2]&&l>=t[1]&&l<=t[3]&&a++}return a}var o=e("gl-shader"),i=e("gl-buffer"),n=e("typedarray-pool"),l=e("./lib/shader");t.exports=function(e,t){var r=e.gl,n=i(r),s=i(r),d=o(r,l.pointVertex,l.pointFragment),c=o(r,l.pickVertex,l.pickFragment),p=new a(e,n,s,d,c);return p.update(t),e.addObject(p),p};var s=a.prototype;s.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},s.update=function(e){function t(t,a){return t in e?e[t]:a}var a;e=e||{},this.sizeMin=t("sizeMin",.5),this.sizeMax=t("sizeMax",20),this.color=t("color",[1,0,0,1]).slice(),this.areaRatio=t("areaRatio",1),this.borderColor=t("borderColor",[0,0,0,1]).slice(),this.blend=t("blend",!1);var r=e.positions.length>>>1,o=e.positions instanceof Float32Array,l=e.idToIndex instanceof Int32Array&&e.idToIndex.length>=r,s=e.positions,d=o?s:n.mallocFloat32(s.length),c=l?e.idToIndex:n.mallocInt32(r);if(o||d.set(s),!l)for(d.set(s),a=0;a<r;a++)c[a]=a;this.points=s,this.offsetBuffer.update(d),this.pickBuffer.update(c),o||n.free(d),l||n.free(c),this.pointCount=r,this.pickOffset=0},s.unifiedDraw=function(){var e=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(a){var o=void 0!==a,i=o?this.pickShader:this.shader,n=this.plot.gl,l=this.plot.dataBox;if(0===this.pointCount)return a;var s=l[2]-l[0],d=l[3]-l[1],c=r(this.points,l),p=this.plot.pickPixelRatio*va(ea(this.sizeMinCap,this.sizeMin),ea(this.sizeMax,this.sizeMax/ya(c,.33333)));e[0]=2/s,e[4]=2/d,e[6]=-2*l[0]/s-1,e[7]=-2*l[1]/d-1,this.offsetBuffer.bind(),i.bind(),i.attributes.position.pointer(),i.uniforms.matrix=e,i.uniforms.color=this.color,i.uniforms.borderColor=this.borderColor,i.uniforms.pointCloud=5>p,i.uniforms.pointSize=p,i.uniforms.centerFraction=ea(1,va(0,N(1-this.areaRatio))),o&&(t[0]=255&a,t[1]=255&a>>8,t[2]=255&a>>16,t[3]=255&a>>24,this.pickBuffer.bind(),i.attributes.pickId.pointer(n.UNSIGNED_BYTE),i.uniforms.pickOffset=t,this.pickOffset=a);var u=n.getParameter(n.BLEND),g=n.getParameter(n.DITHER);return u&&!this.blend&&n.disable(n.BLEND),g&&n.disable(n.DITHER),n.drawArrays(n.POINTS,0,this.pointCount),u&&!this.blend&&n.enable(n.BLEND),g&&n.enable(n.DITHER),a+this.pointCount}}(),s.draw=s.unifiedDraw,s.drawPick=s.unifiedDraw,s.pick=function(e,t,a){var r=this.pickOffset,o=this.pointCount;if(a<r||a>=r+o)return null;var i=a-r,n=this.points;return{object:this,pointId:i,dataCoord:[n[2*i],n[2*i+1]]}}},{"./lib/shader":291,"gl-buffer":241,"gl-shader":301,"typedarray-pool":545}],293:[function(e,t){t.exports=function(e,r,a,o){var t=r[0],i=r[1],n=r[2],l=r[3],s=a[0],c=a[1],p=a[2],u=a[3],g,h,m,y,f;return h=t*s+i*c+n*p+l*u,0>h&&(h=-h,s=-s,c=-c,p=-p,u=-u),1e-6<1-h?(g=d(h),m=De(g),y=De((1-o)*g)/m,f=De(o*g)/m):(y=1-o,f=o),e[0]=y*t+f*s,e[1]=y*i+f*c,e[2]=y*n+f*p,e[3]=y*l+f*u,e}},{}],294:[function(e,t){"use strict";t.exports=function(e){return e||0===e?e.toString():""}},{}],295:[function(e,t){"use strict";function a(e,t,a){var l=o[t];if(l||(l=o[t]={}),e in l)return l[e];var s={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},d=r(e,s);s.triangles=!1;var c=r(e,s),u,g;if(a&&1!==a){for(u=0;u<d.positions.length;++u)for(g=0;g<d.positions[u].length;++g)d.positions[u][g]/=a;for(u=0;u<c.positions.length;++u)for(g=0;g<c.positions[u].length;++g)c.positions[u][g]/=a}var h=[[1/0,1/0],[-Infinity,-Infinity]],m=c.positions.length;for(u=0;u<m;++u){var n=c.positions[u];for(g=0;2>g;++g)h[0][g]=ea(h[0][g],n[g]),h[1][g]=va(h[1][g],n[g])}return l[e]=[d,c,h]}var r=e("vectorize-text");t.exports=a;var o={}},{"vectorize-text":550}],296:[function(e,t,a){function r(e,t){var a=o(e,t),r=a.attributes;return r.position.location=0,r.color.location=1,r.glyph.location=2,r.id.location=3,a}var o=e("gl-shader"),i=e("glslify"),n=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),l=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),s=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),d=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),c=i(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),p=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],u={vertex:n,fragment:d,attributes:p},g={vertex:l,fragment:d,attributes:p},h={vertex:s,fragment:d,attributes:p},m={vertex:n,fragment:c,attributes:p},y={vertex:l,fragment:c,attributes:p},f={vertex:s,fragment:c,attributes:p};a.createPerspective=function(e){return r(e,u)},a.createOrtho=function(e){return r(e,g)},a.createProject=function(e){return r(e,h)},a.createPickPerspective=function(e){return r(e,m)},a.createPickOrtho=function(e){return r(e,y)},a.createPickProject=function(e){return r(e,f)}},{"gl-shader":301,glslify:409}],297:[function(e,t){"use strict";function a(e,t){var a=e[0],r=e[1],o=e[2],i=e[3];return e[0]=t[0]*a+t[4]*r+t[8]*o+t[12]*i,e[1]=t[1]*a+t[5]*r+t[9]*o+t[13]*i,e[2]=t[2]*a+t[6]*r+t[10]*o+t[14]*i,e[3]=t[3]*a+t[7]*r+t[11]*o+t[15]*i,e}function r(e,t,r,o){return a(o,o,r),a(o,o,t),a(o,o,e)}function o(e,t){this.index=e,this.dataCoordinate=this.position=t}function n(e){return!0===e?1:1<e?1:e}function l(e,t,a,r,i,n,l,s,d,c,p,u){this.gl=e,this.pixelRatio=1,this.shader=t,this.orthoShader=a,this.projectShader=r,this.pointBuffer=i,this.colorBuffer=n,this.glyphBuffer=l,this.idBuffer=s,this.vao=d,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=c,this.pickOrthoShader=p,this.pickProjectShader=u,this.points=[],this._selectResult=new o(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.dirty=!0}function s(e){return e[0]=e[1]=e[2]=0,e}function d(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1,e}function c(e,t,a,r){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[a]=r,e}function p(e){for(var t=D,a=0;2>a;++a)for(var r=0;3>r;++r)t[a][r]=va(ea(e[a][r],1e8),-1e8);return t}function u(e,a,o,n){var l=a.axesProject,g=a.gl,h=e.uniforms,m=o.model||T,y=o.view||T,f=o.projection||T,x=a.axesBounds,_=p(a.clipBounds),k;k=a.axes&&a.axes.lastCubeProps?a.axes.lastCubeProps.axis:[1,1,1],S[0]=2/g.drawingBufferWidth,S[1]=2/g.drawingBufferHeight,e.bind(),h.view=y,h.projection=f,h.screenSize=S,h.highlightId=a.highlightId,h.highlightScale=a.highlightScale,h.clipBounds=_,h.pickGroup=a.pickId/255,h.pixelRatio=n;for(var w=0;3>w;++w)if(l[w]){h.scale=a.projectScale[w],h.opacity=a.projectOpacity[w];for(var A=z,D=0;16>D;++D)A[D]=0;for(var D=0;4>D;++D)A[5*D]=1;A[5*w]=0,A[12+w]=0>k[w]?x[0][w]:x[1][w],b(A,m,A),h.model=A;var O=(w+1)%3,R=(w+2)%3,M=s(C),F=s(L);M[O]=1,F[R]=1;var B=r(f,y,m,d(E,M)),V=r(f,y,m,d(I,F));if(_a(B[1])>_a(V[1])){var U=B;B=V,V=U,U=M,M=F,F=U;var H=O;O=R,R=H}0>B[0]&&(M[O]=-1),0<V[1]&&(F[R]=-1);for(var t=0,G=0,D=0;4>D;++D)t+=ya(m[4*O+D],2),G+=ya(m[4*R+D],2);M[O]/=N(t),F[R]/=N(G),h.axes[0]=M,h.axes[1]=F,h.fragClipBounds[0]=c(P,_[0],w,-1e8),h.fragClipBounds[1]=c(P,_[1],w,1e8),a.vao.bind(),a.vao.draw(g.TRIANGLES,a.vertexCount),0<a.lineWidth&&(g.lineWidth(a.lineWidth*n),a.vao.draw(g.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}function g(e,t,a,r,o,i,n){var l=a.gl;if((i===a.projectHasAlpha||n)&&u(t,a,r,o),i===a.hasAlpha||n){e.bind();var s=e.uniforms;s.model=r.model||T,s.view=r.view||T,s.projection=r.projection||T,S[0]=2/l.drawingBufferWidth,S[1]=2/l.drawingBufferHeight,s.screenSize=S,s.highlightId=a.highlightId,s.highlightScale=a.highlightScale,s.fragClipBounds=O,s.clipBounds=a.axes.bounds,s.opacity=a.opacity,s.pickGroup=a.pickId/255,s.pixelRatio=o,a.vao.bind(),a.vao.draw(l.TRIANGLES,a.vertexCount),0<a.lineWidth&&(l.lineWidth(a.lineWidth*o),a.vao.draw(l.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}function h(e,t,a,r){var o;o=Array.isArray(e)?t<e.length?e[t]:void 0:e,o=w(o);var i=!0;m(o)&&(o="\u25BC",i=!1);var n=k(o,a,r);return{mesh:n[0],lines:n[1],bounds:n[2],visible:i}}var m=e("is-string-blank"),y=e("gl-buffer"),f=e("gl-vao"),_=e("typedarray-pool"),b=e("gl-mat4/multiply"),v=e("./lib/shaders"),k=e("./lib/glyphs"),w=e("./lib/get-simple-string"),T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.exports=function(e){var t=e.gl,a=v.createPerspective(t),r=v.createOrtho(t),o=v.createProject(t),i=v.createPickPerspective(t),n=v.createPickOrtho(t),s=v.createPickProject(t),d=y(t),c=y(t),p=y(t),u=y(t),g=f(t,[{buffer:d,size:3,type:t.FLOAT},{buffer:c,size:4,type:t.FLOAT},{buffer:p,size:2,type:t.FLOAT},{buffer:u,size:4,type:t.UNSIGNED_BYTE,normalized:!0}]),h=new l(t,a,r,o,d,c,p,u,g,i,n,s);return h.update(e),h};var A=l.prototype;A.pickSlots=1,A.setPickBase=function(e){this.pickId=e},A.isTransparent=function(){if(this.hasAlpha)return!0;for(var e=0;3>e;++e)if(this.axesProject[e]&&this.projectHasAlpha)return!0;return!1},A.isOpaque=function(){if(!this.hasAlpha)return!0;for(var e=0;3>e;++e)if(this.axesProject[e]&&!this.projectHasAlpha)return!0;return!1};var S=[0,0],C=[0,0,0],L=[0,0,0],E=[0,0,0,1],I=[0,0,0,1],z=T.slice(),P=[0,0,0],D=[[0,0,0],[0,0,0]],O=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];A.draw=function(e){var t=this.useOrtho?this.orthoShader:this.shader;g(t,this.projectShader,this,e,this.pixelRatio,!1,!1)},A.drawTransparent=function(e){var t=this.useOrtho?this.orthoShader:this.shader;g(t,this.projectShader,this,e,this.pixelRatio,!0,!1)},A.drawPick=function(e){var t=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;g(t,this.pickProjectShader,this,e,1,!0,!0)},A.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[2]+(e.value[1]<<8)+(e.value[0]<<16);if(t>=this.pointCount||0>t)return null;var a=this.points[t],r=this._selectResult;r.index=t;for(var o=0;3>o;++o)r.position[o]=r.dataCoordinate[o]=a[o];return r},A.highlight=function(e){if(!e)this.highlightId=[1,1,1,1];else{var t=e.index;this.highlightId=[(255&t)/255,(255&t>>8)/255,(255&t>>16)/255,0]}},A.update=function(e){if(e=e||{},"perspective"in e&&(this.useOrtho=!e.perspective),"orthographic"in e&&(this.useOrtho=!!e.orthographic),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"project"in e)if(Array.isArray(e.project))this.axesProject=e.project;else{var t=!!e.project;this.axesProject=[t,t,t]}if("projectScale"in e)if(Array.isArray(e.projectScale))this.projectScale=e.projectScale.slice();else{var a=+e.projectScale;this.projectScale=[a,a,a]}if(this.projectHasAlpha=!1,"projectOpacity"in e){if(Array.isArray(e.projectOpacity))this.projectOpacity=e.projectOpacity.slice();else{var a=+e.projectOpacity;this.projectOpacity=[a,a,a]}for(var r=0;3>r;++r)this.projectOpacity[r]=n(this.projectOpacity[r]),1>this.projectOpacity[r]&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in e&&(this.opacity=n(e.opacity),1>this.opacity&&(this.hasAlpha=!0)),this.dirty=!0;var o=e.position,d=e.font||"normal",u=e.alignment||[0,0],g,m;if(2===u.length)g=u[0],m=u[1];else{g=[],m=[];for(var r=0;r<u.length;++r)g[r]=u[r][0],m[r]=u[r][1]}var y=[1/0,1/0,1/0],f=[-Infinity,-Infinity,-Infinity],b=e.glyph,v=e.color,w=e.size,T=e.angle,A=e.lineColor,S=-1,C=0,L=0,E=0;if(o.length){E=o.length;count_loop:for(var r=0,I;r<E;++r){I=o[r];for(var z=0;3>z;++z)if(isNaN(I[z])||!isFinite(I[z]))continue count_loop;var P=h(b,r,d,this.pixelRatio),D=P.mesh,O=P.lines,M=P.bounds;C+=3*D.cells.length,L+=2*O.edges.length}}var F=C+L,B=_.mallocFloat(3*F),N=_.mallocFloat(4*F),V=_.mallocFloat(2*F),U=_.mallocUint32(F);if(0<F){var H=0,G=C,q=[0,0,0,1],Y=[0,0,0,1],W=Array.isArray(v)&&Array.isArray(v[0]),X=Array.isArray(A)&&Array.isArray(A[0]);fill_loop:for(var r=0;r<E;++r){S+=1;for(var I=o[r],z=0;3>z;++z){if(isNaN(I[z])||!isFinite(I[z]))continue fill_loop;f[z]=va(f[z],I[z]),y[z]=ea(y[z],I[z])}var P=h(b,r,d,this.pixelRatio),D=P.mesh,O=P.lines,M=P.bounds,Z=P.visible;if(!Z)q=[1,1,1,0];else if(Array.isArray(v)){var K;if(K=W?r<v.length?v[r]:[0,0,0,0]:v,3===K.length){for(var z=0;3>z;++z)q[z]=K[z];q[3]=1}else if(4===K.length){for(var z=0;4>z;++z)q[z]=K[z];!this.hasAlpha&&1>K[3]&&(this.hasAlpha=!0)}}else q[0]=q[1]=q[2]=0,q[3]=1;if(!Z)Y=[1,1,1,0];else if(Array.isArray(A)){var K;if(K=X?r<A.length?A[r]:[0,0,0,0]:A,3===K.length){for(var z=0;3>z;++z)Y[z]=K[z];Y[z]=1}else if(4===K.length){for(var z=0;4>z;++z)Y[z]=K[z];!this.hasAlpha&&1>K[3]&&(this.hasAlpha=!0)}}else Y[0]=Y[1]=Y[2]=0,Y[3]=1;var J=.5;Z?Array.isArray(w)?r<w.length?J=+w[r]:J=12:w?J=+w:this.useOrtho&&(J=12):J=0;var Q=0;Array.isArray(T)?r<T.length?Q=+T[r]:Q=0:T&&(Q=+T);for(var $=R(Q),ee=De(Q),I=o[r],z=0;3>z;++z)f[z]=va(f[z],I[z]),y[z]=ea(y[z],I[z]);var te=g,ae=m,te=0;Array.isArray(g)?r<g.length?te=g[r]:te=0:g&&(te=g);var ae=0;Array.isArray(m)?r<m.length?ae=m[r]:ae=0:m&&(ae=m),te*=0<te?1-M[0][0]:0>te?1+M[1][0]:1,ae*=0<ae?1-M[0][1]:0>ae?1+M[1][1]:1;for(var re=[te,ae],oe=D.cells||[],ie=D.positions||[],z=0,ne;z<oe.length;++z){ne=oe[z];for(var le=0;3>le;++le){for(var se=0;3>se;++se)B[3*H+se]=I[se];for(var se=0;4>se;++se)N[4*H+se]=q[se];U[H]=S;var de=ie[ne[le]];V[2*H]=J*($*de[0]-ee*de[1]+re[0]),V[2*H+1]=J*(ee*de[0]+$*de[1]+re[1]),H+=1}}for(var oe=O.edges,ie=O.positions,z=0,ne;z<oe.length;++z){ne=oe[z];for(var le=0;2>le;++le){for(var se=0;3>se;++se)B[3*G+se]=I[se];for(var se=0;4>se;++se)N[4*G+se]=Y[se];U[G]=S;var de=ie[ne[le]];V[2*G]=J*($*de[0]-ee*de[1]+re[0]),V[2*G+1]=J*(ee*de[0]+$*de[1]+re[1]),G+=1}}}}this.bounds=[y,f],this.points=o,this.pointCount=o.length,this.vertexCount=C,this.lineVertexCount=L,this.pointBuffer.update(B),this.colorBuffer.update(N),this.glyphBuffer.update(V),this.idBuffer.update(U),_.free(B),_.free(N),_.free(V),_.free(U)},A.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":294,"./lib/glyphs":295,"./lib/shaders":296,"gl-buffer":241,"gl-mat4/multiply":267,"gl-vao":327,"is-string-blank":423,"typedarray-pool":545}],298:[function(e,t,a){"use strict";var r=e("glslify");a.boxVertex=r(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),a.boxFragment=r(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:409}],299:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.boxBuffer=t,this.boxShader=a,this.enabled=!0,this.selectBox=[1/0,1/0,-Infinity,-Infinity],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var r=e("gl-shader"),o=e("gl-buffer"),i=e("./lib/shaders");t.exports=function(e,t){var n=e.gl,l=o(n,[0,0,0,1,1,0,1,1]),s=r(n,i.boxVertex,i.boxFragment),d=new a(e,l,s);return d.update(t),e.addOverlay(d),d};var n=a.prototype;n.draw=function(){if(this.enabled){var e=this.plot,t=this.selectBox,a=this.borderWidth,r=this.innerFill,o=this.innerColor,i=this.outerFill,n=this.outerColor,l=this.borderColor,s=e.box,d=e.screenBox,c=e.dataBox,p=e.viewBox,u=e.pixelRatio,g=(t[0]-c[0])*(p[2]-p[0])/(c[2]-c[0])+p[0],h=(t[1]-c[1])*(p[3]-p[1])/(c[3]-c[1])+p[1],m=(t[2]-c[0])*(p[2]-p[0])/(c[2]-c[0])+p[0],y=(t[3]-c[1])*(p[3]-p[1])/(c[3]-c[1])+p[1];if(g=va(g,p[0]),h=va(h,p[1]),m=ea(m,p[2]),y=ea(y,p[3]),!(m<g||y<h)){s.bind();var f=d[2]-d[0],x=d[3]-d[1];if(this.outerFill&&(s.drawBox(0,0,f,h,n),s.drawBox(0,h,g,y,n),s.drawBox(0,y,f,x,n),s.drawBox(m,h,f,y,n)),this.innerFill&&s.drawBox(g,h,m,y,o),0<a){var _=a*u;s.drawBox(g-_,h-_,m+_,h+_,l),s.drawBox(g-_,y-_,m+_,y+_,l),s.drawBox(g-_,h-_,g+_,y+_,l),s.drawBox(m-_,h-_,m+_,y+_,l)}}}},n.update=function(e){e=e||{},this.innerFill=!!e.innerFill,this.outerFill=!!e.outerFill,this.innerColor=(e.innerColor||[0,0,0,.5]).slice(),this.outerColor=(e.outerColor||[0,0,0,.5]).slice(),this.borderColor=(e.borderColor||[0,0,0,1]).slice(),this.borderWidth=e.borderWidth||0,this.selectBox=(e.selectBox||this.selectBox).slice()},n.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":298,"gl-buffer":241,"gl-shader":301}],300:[function(e,t){"use strict";function a(e,t,a,r,o){this.coord=[e,t],this.id=a,this.value=r,this.distance=o}function r(e,t,a){this.gl=e,this.fbo=t,this.buffer=a,this._readTimeout=null;var r=this;this._readCallback=function(){r.gl&&(t.bind(),e.readPixels(0,0,t.shape[0],t.shape[1],e.RGBA,e.UNSIGNED_BYTE,r.buffer),r._readTimeout=null)}}t.exports=function(e,t){var a=o(e,t),i=n.mallocUint8(4*(t[0]*t[1]));return new r(e,a,i)};var o=e("gl-fbo"),n=e("typedarray-pool"),l=e("ndarray"),s=e("bit-twiddle").nextPow2,d=e("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(_inline_16_arg0_<255||_inline_16_arg1_<255||_inline_16_arg2_<255||_inline_16_arg3_<255){var _inline_16_l=_inline_16_arg4_-_inline_16_arg6_[0],_inline_16_a=_inline_16_arg5_-_inline_16_arg6_[1],_inline_16_f=_inline_16_l*_inline_16_l+_inline_16_a*_inline_16_a;_inline_16_f<this_closestD2&&(this_closestD2=_inline_16_f,this_closestX=_inline_16_arg6_[0],this_closestY=_inline_16_arg6_[1])}}",args:[{name:"_inline_16_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg4_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg5_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg6_",lvalue:!1,rvalue:!0,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_16_a","_inline_16_f","_inline_16_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:!1,funcName:"cwise",blockSize:64}),c=r.prototype;Object.defineProperty(c,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(e){if(this.gl){this.fbo.shape=e;var t=this.fbo.shape[0],a=this.fbo.shape[1];if(4*(a*t)>this.buffer.length){n.free(this.buffer);for(var r=this.buffer=n.mallocUint8(s(4*(a*t))),o=0;o<4*(a*t);++o)r[o]=255}return e}}}),c.begin=function(){var e=this.gl,t=this.shape;e&&(this.fbo.bind(),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT))},c.end=function(){var e=this.gl;e&&(e.bindFramebuffer(e.FRAMEBUFFER,null),!this._readTimeout&&clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},c.query=function(e,t,r){if(!this.gl)return null;var o=this.fbo.shape.slice();e|=0,t|=0,"number"!=typeof r&&(r=1);var i=0|ea(va(e-r,0),o[0]),n=0|ea(va(e+r,0),o[0]),s=0|ea(va(t-r,0),o[1]),c=0|ea(va(t+r,0),o[1]);if(n<=i||c<=s)return null;var p=[n-i,c-s],u=l(this.buffer,[p[0],p[1],4],[4,4*o[0],1],4*(i+o[0]*s)),g=d(u.hi(p[0],p[1],1),r,r),h=g[0],m=g[1];if(0>h||ya(this.radius,2)<g[2])return null;var f=u.get(h,m,0),_=u.get(h,m,1),b=u.get(h,m,2),v=u.get(h,m,3);return new a(0|h+i,0|m+s,f,[_,b,v],N(g[2]))},c.dispose=function(){this.gl&&(this.fbo.dispose(),n.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":92,"cwise/lib/wrapper":149,"gl-fbo":249,ndarray:450,"typedarray-pool":545}],301:[function(e,t){"use strict";function a(e){this.gl=e,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function r(e,t){return e.name<t.name?-1:1}var o=e("./lib/create-uniforms"),n=e("./lib/create-attributes"),l=e("./lib/reflect"),s=e("./lib/shader-cache"),d=e("./lib/runtime-reflect"),c=e("./lib/GLError"),p=a.prototype;p.bind=function(){this.program||this._relink();var e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),t=this.gl.lastAttribCount,a;if(e>t)for(a=t;a<e;a++)this.gl.enableVertexAttribArray(a);else if(t>e)for(a=e;a<t;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=e,this.gl.useProgram(this.program)},p.dispose=function(){for(var e=this.gl.lastAttribCount,t=0;t<e;t++)this.gl.disableVertexAttribArray(t);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},p.update=function(e,t,a,p){function u(){h.program=s.program(m,h._vref,h._fref,v,k);for(var e=0;e<a.length;++e)E[e]=m.getUniformLocation(h.program,a[e].name)}if(!t||1===arguments.length){var g=e;e=g.vertex,t=g.fragment,a=g.uniforms,p=g.attributes}var h=this,m=h.gl,y=h._vref;h._vref=s.shader(m,m.VERTEX_SHADER,e),y&&y.dispose(),h.vertShader=h._vref.shader;var f=this._fref;if(h._fref=s.shader(m,m.FRAGMENT_SHADER,t),f&&f.dispose(),h.fragShader=h._fref.shader,!a||!p){var x=m.createProgram();if(m.attachShader(x,h.fragShader),m.attachShader(x,h.vertShader),m.linkProgram(x),!m.getProgramParameter(x,m.LINK_STATUS)){var _=m.getProgramInfoLog(x);throw new c(_,"Error linking program:"+_)}a=a||d.uniforms(m,x),p=p||d.attributes(m,x),m.deleteProgram(x)}p=p.slice(),p.sort(r);var b=[],v=[],k=[],w;for(w=0;w<p.length;++w){var T=p[w];if(0<=T.type.indexOf("mat")){for(var A=0|T.type.charAt(T.type.length-1),S=Array(A),C=0;C<A;++C)S[C]=k.length,v.push(T.name+"["+C+"]"),"number"==typeof T.location?k.push(T.location+C):Array.isArray(T.location)&&T.location.length===A&&"number"==typeof T.location[C]?k.push(0|T.location[C]):k.push(-1);b.push({name:T.name,type:T.type,locations:S})}else b.push({name:T.name,type:T.type,locations:[k.length]}),v.push(T.name),"number"==typeof T.location?k.push(0|T.location):k.push(-1)}var L=0;for(w=0;w<k.length;++w)if(0>k[w]){for(;0<=k.indexOf(L);)L+=1;k[w]=L}var E=Array(a.length);u(),h._relink=u,h.types={uniforms:l(a),attributes:l(p)},h.attributes=n(m,h,b,k),Object.defineProperty(h,"uniforms",o(m,h,a,E))},t.exports=function(e,t,r,o,i){var n=new a(e);return n.update(t,r,o,i),n}},{"./lib/GLError":302,"./lib/create-attributes":303,"./lib/create-uniforms":304,"./lib/reflect":305,"./lib/runtime-reflect":306,"./lib/shader-cache":307}],302:[function(e,t){function a(e,t,a){this.shortMessage=t||"",this.longMessage=a||"",this.rawError=e||"",this.message="gl-shader: "+(t||e||"")+(a?"\n"+a:""),this.stack=new Error().stack}a.prototype=new Error,a.prototype.name="GLError",a.prototype.constructor=a,t.exports=a},{}],303:[function(e,t){"use strict";function a(e,t,a,r,o,i){this._gl=e,this._wrapper=t,this._index=a,this._locations=r,this._dimension=o,this._constFunc=i}function r(e,t,r,o,n,l,s){for(var d=["gl","v"],c=[],p=0;p<n;++p)d.push("x"+p),c.push("x"+p);d.push("if(x0.length===void 0){return gl.vertexAttrib"+n+"f(v,"+c.join()+")}else{return gl.vertexAttrib"+n+"fv(v,x0)}");var u=Function.apply(null,d),g=new a(e,t,r,o,n,u);Object.defineProperty(l,s,{set:function(t){return e.disableVertexAttribArray(o[r]),u(e,o[r],t),t},get:function(){return g},enumerable:!0})}function o(e,t,a,o,n,l,s){for(var d=Array(n),c=Array(n),p=0;p<n;++p)r(e,t,a[p],o,n,d,p),c[p]=d[p];Object.defineProperty(d,"location",{set:function(e){if(Array.isArray(e))for(var t=0;t<n;++t)c[t].location=e[t];else for(var t=0;t<n;++t)c[t].location=e+t;return e},get:function(){for(var e=Array(n),t=0;t<n;++t)e[t]=o[a[t]];return e},enumerable:!0}),d.pointer=function(t,r,l,s){t=t||e.FLOAT,r=!!r,l=l||n*n,s=s||0;for(var d=0,c;d<n;++d)c=o[a[d]],e.vertexAttribPointer(c,n,t,r,l,s+d*n),e.enableVertexAttribArray(c)};var u=Array(n),g=e["vertexAttrib"+n+"fv"];Object.defineProperty(l,s,{set:function(t){for(var r=0,l;r<n;++r)if(l=o[a[r]],e.disableVertexAttribArray(l),Array.isArray(t[0]))g.call(e,l,t[r]);else{for(var s=0;s<n;++s)u[s]=t[n*r+s];g.call(e,l,u)}return t},get:function(){return d},enumerable:!0})}t.exports=function(e,t,l,s){for(var c={},p=0,u=l.length;p<u;++p){var n=l[p],a=n.name,g=n.type,h=n.locations;switch(g){case"bool":case"int":case"float":r(e,t,h[0],s,1,c,a);break;default:if(0<=g.indexOf("vec")){var m=g.charCodeAt(g.length-1)-48;if(2>m||4<m)throw new i("","Invalid data type for attribute "+a+": "+g);r(e,t,h[0],s,m,c,a)}else if(0<=g.indexOf("mat")){var m=g.charCodeAt(g.length-1)-48;if(2>m||4<m)throw new i("","Invalid data type for attribute "+a+": "+g);o(e,t,h,s,m,c,a)}else throw new i("","Unknown data type for attribute "+a+": "+g);}}return c};var i=e("./GLError"),n=a.prototype;n.pointer=function(e,t,a,r){var o=this,i=o._gl,n=o._locations[o._index];i.vertexAttribPointer(n,o._dimension,e||i.FLOAT,!!t,a||0,r||0),i.enableVertexAttribArray(n)},n.set=function(e,t,a,r){return this._constFunc(this._locations[this._index],e,t,a,r)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(e){return e!==this._locations[this._index]&&(this._locations[this._index]=0|e,this._wrapper.program=null),0|e}})},{"./GLError":302}],304:[function(e,t){"use strict";function a(e){var t=new Function("y","return function(){return y}");return t(e)}function r(e,t){for(var a=Array(e),r=0;r<e;++r)a[r]=t;return a}var o=e("./reflect"),i=e("./GLError");t.exports=function(e,t,n,l){function s(a){var r=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+a+"])}");return r(e,t,l)}function d(e,t,a){switch(a){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var r=a.indexOf("vec");if(0<=r&&1>=r&&a.length===4+r){var o=a.charCodeAt(a.length-1)-48;if(2>o||4<o)throw new i("","Invalid data type");switch(a.charAt(0)){case"b":case"i":return"gl.uniform"+o+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+o+"fv(locations["+t+"],obj"+e+")";default:throw new i("","Unrecognized data type for vector "+name+": "+a);}}else{if(0===a.indexOf("mat")&&4===a.length){var o=a.charCodeAt(a.length-1)-48;if(2>o||4<o)throw new i("","Invalid uniform dimension type for matrix "+name+": "+a);return"gl.uniformMatrix"+o+"fv(locations["+t+"],false,obj"+e+")"}throw new i("","Unknown uniform data type for "+name+": "+a)}}}function c(e,t){if("object"!=typeof t)return[[e,t]];var a=[];for(var r in t){var o=t[r],i=e;i+=parseInt(r)+""==r?"["+r+"]":"."+r,"object"==typeof o?a.push.apply(a,c(i,o)):a.push([i,o])}return a}function p(t){for(var a=["return function updateProperty(obj){"],r=c("",t),o=0;o<r.length;++o){var s=r[o],p=s[0],u=s[1];l[u]&&a.push(d(p,u,n[u].type))}a.push("return obj}");var g=new Function("gl","locations",a.join("\n"));return g(e,l)}function u(e){switch(e){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&1>=t&&e.length===4+t){var a=e.charCodeAt(e.length-1)-48;if(2>a||4<a)throw new i("","Invalid data type");return"b"===e.charAt(0)?r(a,!1):r(a,0)}if(0===e.indexOf("mat")&&4===e.length){var a=e.charCodeAt(e.length-1)-48;if(2>a||4<a)throw new i("","Invalid uniform dimension type for matrix "+name+": "+e);return r(a*a,0)}throw new i("","Unknown uniform data type for "+name+": "+e);}}function g(e,t,r){if("object"==typeof r){var o=h(r);Object.defineProperty(e,t,{get:a(o),set:p(r),enumerable:!0,configurable:!1})}else l[r]?Object.defineProperty(e,t,{get:s(r),set:p(r),enumerable:!0,configurable:!1}):e[t]=u(n[r].type)}function h(e){var t;if(Array.isArray(e)){t=Array(e.length);for(var a=0;a<e.length;++a)g(t,a,e[a])}else for(var r in t={},e)g(t,r,e[r]);return t}var m=o(n,!0);return{get:a(h(m)),set:p(m),enumerable:!0,configurable:!0}}},{"./GLError":302,"./reflect":305}],305:[function(e,t){"use strict";function a(e,t){for(var a={},r=0;r<e.length;++r)for(var l=e[r].name,n=l.split("."),s=a,d=0,c;d<n.length;++d)if(c=n[d].split("["),1<c.length){c[0]in s||(s[c[0]]=[]),s=s[c[0]];for(var p=1,u;p<c.length;++p)u=parseInt(c[p]),p<c.length-1||d<n.length-1?(!(u in s)&&(p<c.length-1?s[u]=[]:s[u]={}),s=s[u]):t?s[u]=r:s[u]=e[r].type}else d<n.length-1?(c[0]in s||(s[c[0]]={}),s=s[c[0]]):s[c[0]]=t?r:e[r].type;return a}t.exports=a},{}],306:[function(e,t,a){"use strict";function r(e,t){if(!n){var a=Object.keys(o);n={};for(var r=0,l;r<a.length;++r)l=a[r],n[e[l]]=o[l]}return n[t]}a.uniforms=function(e,t){for(var a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o=[],n=0,l;n<a;++n)if(l=e.getActiveUniform(t,n),l){var s=r(e,l.type);if(1<l.size)for(var d=0;d<l.size;++d)o.push({name:l.name.replace("[0]","["+d+"]"),type:s});else o.push({name:l.name,type:s})}return o},a.attributes=function(e,t){for(var a=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=[],n=0,l;n<a;++n)l=e.getActiveAttrib(t,n),l&&o.push({name:l.name,type:r(e,l.type)});return o};var o={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},n=null},{}],307:[function(e,t,a){"use strict";function r(e,t,a,r,o,i,n){this.id=e,this.src=t,this.type=a,this.shader=r,this.count=i,this.programs=[],this.cache=n}function o(e){this.gl=e,this.shaders=[{},{}],this.programs={}}function i(e,t,a){var r=e.createShader(t);if(e.shaderSource(r,a),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(r);try{var i=d(o,a,t)}catch(t){throw console.warn("Failed to format compiler error: "+t),new s(o,"Error compiling shader:\n"+o)}throw new s(o,i.short,i.long)}return r}function n(e,t,a,r,o){var n=e.createProgram();e.attachShader(n,t),e.attachShader(n,a);for(var l=0;l<r.length;++l)e.bindAttribLocation(n,o[l],r[l]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var d=e.getProgramInfoLog(n);throw new s(d,"Error linking program: "+d)}return n}function l(e){var t=p.get(e);return t||(t=new o(e),p.set(e,t)),t}a.shader=function(e,t,a){return l(e).getShaderReference(t,a)},a.program=function(e,t,a,r,o){return l(e).getProgram(t,a,r,o)};var s=e("./GLError"),d=e("gl-format-compiler-error"),c="undefined"==typeof WeakMap?e("weakmap-shim"):WeakMap,p=new c,u=0;r.prototype.dispose=function(){if(0==--this.count){for(var e=this.cache,t=e.gl,a=this.programs,r=0,o=a.length,n;r<o;++r)n=e.programs[a[r]],n&&(delete e.programs[r],t.deleteProgram(n));t.deleteShader(this.shader),delete e.shaders[0|this.type===t.FRAGMENT_SHADER][this.src]}};var g=o.prototype;g.getShaderReference=function(e,t){var a=this.gl,o=this.shaders[0|e===a.FRAGMENT_SHADER],n=o[t];if(!n||!a.isShader(n.shader)){var l=i(a,e,t);n=o[t]=new r(u++,t,e,l,[],1,this)}else n.count+=1;return n},g.getProgram=function(e,t,a,r){var o=[e.id,t.id,a.join(":"),r.join(":")].join("@"),i=this.programs[o];return i&&this.gl.isProgram(i)||(this.programs[o]=i=n(this.gl,e.shader,t.shader,a,r),e.programs.push(o),t.programs.push(o)),i}},{"./GLError":302,"gl-format-compiler-error":250,"weakmap-shim":555}],308:[function(e,t){"use strict";function a(e){this.plot=e,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}t.exports=function(e,t){var r=new a(e);return r.update(t),e.addOverlay(r),r};var r=a.prototype;r.update=function(e){e=e||{},this.enable=(e.enable||[!0,!0,!1,!1]).slice(),this.width=(e.width||[1,1,1,1]).slice(),this.color=(e.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(e){return e.slice()}),this.center=(e.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},r.draw=function(){var e=this.enable,t=this.width,a=this.color,r=this.center,o=this.plot,i=o.line,n=o.dataBox,l=o.viewBox;if(i.bind(),n[0]<=r[0]&&r[0]<=n[2]&&n[1]<=r[1]&&r[1]<=n[3]){var s=l[0]+(r[0]-n[0])/(n[2]-n[0])*(l[2]-l[0]),d=l[1]+(r[1]-n[1])/(n[3]-n[1])*(l[3]-l[1]);e[0]&&i.drawLine(s,d,l[0],d,t[0],a[0]),e[1]&&i.drawLine(s,d,s,l[1],t[1],a[1]),e[2]&&i.drawLine(s,d,l[2],d,t[2],a[2]),e[3]&&i.drawLine(s,d,s,l[3],t[3],a[3])}},r.dispose=function(){this.plot.removeOverlay(this)}},{}],309:[function(e,t){"use strict";var a=e("glslify"),r=e("gl-shader"),o=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),i=a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);t.exports=function(e){return r(e,o,i,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":301,glslify:409}],310:[function(e,t){"use strict";function a(e,t,a,r){this.gl=e,this.buffer=t,this.vao=a,this.shader=r,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var r=e("gl-buffer"),o=e("gl-vao"),i=e("./shaders/index");t.exports=function(e,t){function n(e,t,a,r,o,i){var n=[e,t,a,0,0,0,1];n[r+3]=1,n[r]=o,s.push.apply(s,n),n[6]=-1,s.push.apply(s,n),n[r]=i,s.push.apply(s,n),s.push.apply(s,n),n[6]=1,s.push.apply(s,n),n[r]=o,s.push.apply(s,n)}var s=[];n(0,0,0,0,0,1),n(0,0,0,1,0,1),n(0,0,0,2,0,1),n(1,0,0,1,-1,1),n(1,0,0,2,-1,1),n(0,1,0,0,-1,1),n(0,1,0,2,-1,1),n(0,0,1,0,-1,1),n(0,0,1,1,-1,1);var d=r(e,s),c=o(e,[{type:e.FLOAT,buffer:d,size:3,offset:0,stride:28},{type:e.FLOAT,buffer:d,size:3,offset:12,stride:28},{type:e.FLOAT,buffer:d,size:1,offset:24,stride:28}]),p=i(e);p.attributes.position.location=0,p.attributes.color.location=1,p.attributes.weight.location=2;var u=new a(e,d,c,p);return u.update(t),u};var n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=a.prototype,s=[0,0,0],d=[0,0,0],c=[0,0];l.isTransparent=function(){return!1},l.drawTransparent=function(){},l.draw=function(e){var t=this.gl,a=this.vao,r=this.shader;a.bind(),r.bind();var o=e.model||n,l=e.view||n,p=e.projection||n,u;this.axes&&(u=this.axes.lastCubeProps.axis);for(var g=s,h=d,m=0;3>m;++m)u&&0>u[m]?(g[m]=this.bounds[0][m],h[m]=this.bounds[1][m]):(g[m]=this.bounds[1][m],h[m]=this.bounds[0][m]);c[0]=t.drawingBufferWidth,c[1]=t.drawingBufferHeight,r.uniforms.model=o,r.uniforms.view=l,r.uniforms.projection=p,r.uniforms.coordinates=[this.position,g,h],r.uniforms.colors=this.colors,r.uniforms.screenShape=c;for(var m=0;3>m;++m)r.uniforms.lineWidth=this.lineWidth[m]*this.pixelRatio,this.enabled[m]&&(a.draw(t.TRIANGLES,6,6*m),this.drawSides[m]&&a.draw(t.TRIANGLES,12,18+12*m));a.unbind()},l.update=function(e){e&&("bounds"in e&&(this.bounds=e.bounds),"position"in e&&(this.position=e.position),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"colors"in e&&(this.colors=e.colors),"enabled"in e&&(this.enabled=e.enabled),"drawSides"in e&&(this.drawSides=e.drawSides))},l.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":309,"gl-buffer":241,"gl-vao":327}],311:[function(e,t,a){var r=e("glslify"),o=r(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float vectorScale;\nuniform float tubeScale;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal,0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),i=r(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),n=r(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),l=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);a.meshShader={vertex:o,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},a.pickShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:409}],312:[function(e,t){"use strict";function a(e,t,a,r,o,i,n,l,s,d,c,p,u,g,h,m,y,f,x,_,b,v,k,w){this.gl=e,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.pickShader=r,this.trianglePositions=o,this.triangleVectors=i,this.triangleColors=l,this.triangleNormals=d,this.triangleUVs=s,this.triangleIds=n,this.triangleVAO=c,this.triangleCount=0,this.lineWidth=1,this.edgePositions=p,this.edgeColors=g,this.edgeUVs=h,this.edgeIds=u,this.edgeVAO=m,this.edgeCount=0,this.pointPositions=y,this.pointColors=x,this.pointUVs=_,this.pointSizes=b,this.pointIds=f,this.pointVAO=v,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=k,this.contourVAO=w,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!1,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.tubeScale=1,this._model=T,this._view=T,this._projection=T,this._resolution=[1,1],this.pixelRatio=1}function r(e){for(var t=f({colormap:e,nshades:256,format:"rgba"}),a=new Uint8Array(1024),r=0,o;256>r;++r){o=t[r];for(var n=0;3>n;++n)a[4*r+n]=o[n];a[4*r+3]=255*o[3]}return y(a,[256,256,4],[4,0,1])}function o(e,t,a){for(var r=Array(t),o=0;o<t;++o)r[o]=0;for(var n=e.length,o=0,l;o<n;++o){l=e[o];for(var s=0;s<l.length;++s)r[l[s]]=a[o]}return r}function n(e){for(var t=e.length,a=Array(t),r=0;r<t;++r)a[r]=e[r][2];return a}function l(e){var t=d(e,v.vertex,v.fragment,null,v.attributes);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.vector.location=5,t}function s(e){var t=d(e,k.vertex,k.fragment,null,k.attributes);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.vector.location=5,t}var d=e("gl-shader"),c=e("gl-buffer"),p=e("gl-vao"),u=e("gl-texture2d"),g=e("normals"),h=e("gl-mat4/multiply"),m=e("gl-mat4/invert"),y=e("ndarray"),f=e("colormap"),x=e("simplicial-complex-contour"),_=e("typedarray-pool"),b=e("./shaders"),v=b.meshShader,k=b.pickShader,T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],A=a.prototype;A.isOpaque=function(){return 1<=this.opacity},A.isTransparent=function(){return 1>this.opacity},A.pickSlots=1,A.setPickBase=function(e){this.pickId=e},A.highlight=function(e){if(!e||!this.contourEnable)return void(this.contourCount=0);for(var t=x(this.cells,this.intensity,e.intensity),r=t.cells,o=t.vertexIds,n=t.vertexWeights,l=r.length,s=_.mallocFloat32(6*l),d=0,p=0,u;p<l;++p){u=r[p];for(var g=0,h;2>g;++g){h=u[0],2===u.length&&(h=u[g]);for(var m=o[h][0],a=o[h][1],y=n[h],f=this.positions[m],b=this.positions[a],w=0;3>w;++w)s[d++]=y*f[w]+(1-y)*b[w]}}this.contourCount=0|d/3,this.contourPositions.update(s.subarray(0,d)),_.free(s)},A.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"contourEnable"in e&&(this.contourEnable=e.contourEnable),"contourColor"in e&&(this.contourColor=e.contourColor),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"lightPosition"in e&&(this.lightPosition=e.lightPosition),"opacity"in e&&(this.opacity=e.opacity),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.texture?(this.texture.dispose(),this.texture=u(t,e.texture)):e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(r(e.colormap)),this.texture.generateMipmap());var a=e.cells,l=e.positions,s=e.vectors;if(l&&a&&s){void 0!==e.tubeScale&&(this.tubeScale=e.tubeScale);var d=[],h=[],m=[],y=[],x=[],_=[],b=[],T=[],A=[],S=[],C=[],L=[],E=[],I=[],z=[];this.cells=a,this.positions=l,this.vectors=s;var P=e.vertexNormals,D=e.cellNormals,O=void 0===e.vertexNormalsEpsilon?1e-6:e.vertexNormalsEpsilon,R=void 0===e.faceNormalsEpsilon?1e-6:e.faceNormalsEpsilon;e.useFacetNormals&&!D&&(D=g.faceNormals(a,l,R)),D||P||(P=g.vertexNormals(a,l,O));var M=e.vertexColors,F=e.cellColors,B=e.meshColor||[1,1,1,1],N=e.vertexUVs,V=e.vertexIntensity,U=e.cellUVs,H=e.cellIntensity,G=1/0,Y=-Infinity;if(!N&&!U)if(V){if(e.vertexIntensityBounds)G=+e.vertexIntensityBounds[0],Y=+e.vertexIntensityBounds[1];else for(var W=0,X;W<V.length;++W)X=V[W],G=ea(G,X),Y=va(Y,X);}else if(H)for(var W=0,X;W<H.length;++W)X=H[W],G=ea(G,X),Y=va(Y,X);else for(var W=0,X;W<l.length;++W)X=l[W][2],G=ea(G,X),Y=va(Y,X);this.intensity=V?V:H?o(a,l.length,H):n(l);var Z=e.pointSizes,K=e.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var W=0,J;W<l.length;++W){J=l[W];for(var Q=0;3>Q;++Q)!isNaN(J[Q])&&isFinite(J[Q])&&(this.bounds[0][Q]=ea(this.bounds[0][Q],J[Q]),this.bounds[1][Q]=va(this.bounds[1][Q],J[Q]))}var $=0,ee=0,te=0;fill_loop:for(var W=0,ae;W<a.length;++W)switch(ae=a[W],ae.length){case 1:for(var re=ae[0],J=l[re],Q=0;3>Q;++Q)if(isNaN(J[Q])||!isFinite(J[Q]))continue fill_loop;C.push(J[0],J[1],J[2],J[3]);var oe;oe=M?M[re]:F?F[W]:B,3===oe.length?L.push(oe[0],oe[1],oe[2],1):L.push(oe[0],oe[1],oe[2],oe[3]);var ie;ie=N?N[re]:V?[(V[re]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],E.push(ie[0],ie[1]),Z?I.push(Z[re]):I.push(K),z.push(W),te+=1;break;case 2:for(var Q=0;2>Q;++Q)for(var re=ae[Q],J=l[re],ne=0;3>ne;++ne)if(isNaN(J[ne])||!isFinite(J[ne]))continue fill_loop;for(var Q=0;2>Q;++Q){var re=ae[Q],J=l[re];b.push(J[0],J[1],J[2]);var oe;oe=M?M[re]:F?F[W]:B,3===oe.length?T.push(oe[0],oe[1],oe[2],1):T.push(oe[0],oe[1],oe[2],oe[3]);var ie;ie=N?N[re]:V?[(V[re]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],A.push(ie[0],ie[1]),S.push(W)}ee+=1;break;case 3:for(var Q=0;3>Q;++Q)for(var re=ae[Q],J=l[re],ne=0;3>ne;++ne)if(isNaN(J[ne])||!isFinite(J[ne]))continue fill_loop;for(var Q=0;3>Q;++Q){var re=ae[2-Q],J=l[re];d.push(J[0],J[1],J[2],J[3]);var le=s[re];h.push(le[0],le[1],le[2],le[3]);var oe;oe=M?M[re]:F?F[W]:B,3===oe.length?m.push(oe[0],oe[1],oe[2],1):m.push(oe[0],oe[1],oe[2],oe[3]);var ie;ie=N?N[re]:V?[(V[re]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],x.push(ie[0],ie[1]);var w;w=P?P[re]:D[W],y.push(w[0],w[1],w[2]),_.push(W)}$+=1;break;default:}this.pointCount=te,this.edgeCount=ee,this.triangleCount=$,this.pointPositions.update(C),this.pointColors.update(L),this.pointUVs.update(E),this.pointSizes.update(I),this.pointIds.update(new Uint32Array(z)),this.edgePositions.update(b),this.edgeColors.update(T),this.edgeUVs.update(A),this.edgeIds.update(new Uint32Array(S)),this.trianglePositions.update(d),this.triangleVectors.update(h),this.triangleColors.update(m),this.triangleUVs.update(x),this.triangleNormals.update(y),this.triangleIds.update(new Uint32Array(_))}},A.drawTransparent=A.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||T,r=e.view||T,o=e.projection||T,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ea(n[1][l],this.clipBounds[1][l]);var d={model:a,view:r,projection:o,inverseModel:T.slice(),clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,contourColor:this.contourColor,texture:0};d.inverseModel=m(d.inverseModel,d.model),t.disable(t.CULL_FACE),this.texture.bind(0);var c=Array(16);h(c,d.view,d.model),h(c,d.projection,c),m(c,c);for(var l=0;3>l;++l)d.eyePosition[l]=c[12+l]/c[15];for(var p=c[15],l=0;3>l;++l)p+=this.lightPosition[l]*c[4*l+3];for(var l=0,u;3>l;++l){u=c[12+l];for(var g=0;3>g;++g)u+=c[4*g+l]*this.lightPosition[g];d.lightPosition[l]=u/p}if(0<this.triangleCount){var y=this.triShader;y.bind(),y.uniforms=d,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},A.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||T,r=e.view||T,o=e.projection||T,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ea(n[1][l],this.clipBounds[1][l]);this._model=[].slice.call(a),this._view=[].slice.call(r),this._projection=[].slice.call(o),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:a,view:r,projection:o,clipBounds:n,tubeScale:this.tubeScale,pickId:this.pickId/255},d=this.pickShader;d.bind(),d.uniforms=s,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),0<this.edgeCount&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth*this.pixelRatio),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind())},A.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],r=this.positions[a[1]].slice(0,3),o=this.intensity[a[1]],i=this.vectors[a[1]].slice(0,3),n=this.vectors[a[1]][3];return{index:t,position:r,intensity:o,velocity:i,divergence:n,dataCoordinate:r}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose()},t.exports=function(e,t){1===arguments.length&&(t=e,e=t.gl);var r=t.triShader||l(e),o=s(e),i=u(e,y(new Uint8Array([255,255,255,255]),[1,1,4]));i.generateMipmap(),i.minFilter=e.LINEAR_MIPMAP_LINEAR,i.magFilter=e.LINEAR;var n=c(e),d=c(e),g=c(e),h=c(e),m=c(e),f=c(e),x=p(e,[{buffer:n,type:e.FLOAT,size:4},{buffer:f,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:g,type:e.FLOAT,size:4},{buffer:h,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:3},{buffer:d,type:e.FLOAT,size:4}]),_=c(e),b=c(e),v=c(e),k=c(e),w=p(e,[{buffer:_,type:e.FLOAT,size:3},{buffer:k,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:b,type:e.FLOAT,size:4},{buffer:v,type:e.FLOAT,size:2}]),T=c(e),A=c(e),S=c(e),C=c(e),L=c(e),E=p(e,[{buffer:T,type:e.FLOAT,size:3},{buffer:L,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:e.FLOAT,size:4},{buffer:S,type:e.FLOAT,size:2},{buffer:C,type:e.FLOAT,size:1}]),I=c(e),z=p(e,[{buffer:I,type:e.FLOAT,size:3}]),P=new a(e,i,r,o,n,d,f,g,h,m,x,_,k,b,v,w,T,L,A,S,C,E,I,z);return P.update(t),P}},{"./shaders":311,colormap:126,"gl-buffer":241,"gl-mat4/invert":265,"gl-mat4/multiply":267,"gl-shader":301,"gl-texture2d":322,"gl-vao":327,ndarray:450,normals:453,"simplicial-complex-contour":518,"typedarray-pool":545}],313:[function(e,t){"use strict";var o=e("gl-vec3"),n=e("gl-vec4"),l=function(e,t,l,s){var d=e.points,c=e.velocities,g=e.divergences,h,m,y,f,x,_;_=o.set(o.create(),0,1,0),f=o.create(),x=o.create();for(var b=o.create(),k=[],w=[],T=[],A=[],S=[],C=[],L=0,E=0,I=n.create(),z=n.create(),P=8,D=0;D<d.length;D++){h=d[D],m=c[D],y=g[D],0===t&&(y=.05*l),E=o.length(m)/s,I=n.create(),o.copy(I,m),I[3]=y;for(var O=0;O<P;O++)S[O]=[h[0],h[1],h[2],O];if(0<A.length)for(var O=0,R;O<P;O++)R=(O+1)%P,k.push(A[O],S[O],S[R],S[R],A[R],A[O]),T.push(z,I,I,I,z,z),C.push(L,E,E,E,L,L),w.push([k.length-6,k.length-5,k.length-4],[k.length-3,k.length-2,k.length-1]);var M=A;A=S,S=M,M=z,z=I,I=M,M=L,L=E,E=M}return{positions:k,cells:w,vectors:T,vertexIntensity:C}},s=function(e,t,a,r){for(var n=0,s=0,d;s<e.length;s++){d=e[s].velocities;for(var c=0,p;c<d.length;c++)p=o.length(d[c]),p>n&&(n=p)}for(var u=e.map(function(e){return l(e,a,r,n)}),g=[],h=[],m=[],y=[],s=0;s<u.length;s++){var f=u[s],x=g.length;g=g.concat(f.positions),m=m.concat(f.vectors),y=y.concat(f.vertexIntensity);for(var c=0;c<f.cells.length;c++){var _=f.cells[c],b=[];h.push(b);for(var v=0;v<_.length;v++)b.push(_[v]+x)}}return{positions:g,cells:h,vectors:m,vertexIntensity:y,colormap:t}},d=function(t,a){var r=o.create(),i=1/1e4;o.add(r,t,[i,0,0]);var e=this.getVelocity(r);o.subtract(e,e,a),o.scale(e,e,1/i),o.add(r,t,[0,i,0]);var n=this.getVelocity(r);o.subtract(n,n,a),o.scale(n,n,1/i),o.add(r,t,[0,0,i]);var l=this.getVelocity(r);return o.subtract(l,l,a),o.scale(l,l,1/i),o.add(r,e,n),o.add(r,r,l),r},c=function(e){var t=y(e,this.vectors,this.meshgrid,this.clampBorders);return t},p=function(e,t){for(var a=0,r;a<e.length;a++){if(r=e[a],r===t)return a;if(r>t)return a-1}return a},u=o.create(),g=o.create(),m=function(e,t,a){return e<t?t:e>a?a:e},y=function(e,t,a,r){var i=e[0],n=e[1],l=e[2],s=a[0].length,c=a[1].length,h=a[2].length,d=p(a[0],i),y=p(a[1],n),f=p(a[2],l),x=d+1,_=y+1,b=f+1;if(a[0][d]===i&&(x=d),a[1][y]===n&&(_=y),a[2][f]===l&&(b=f),r&&(d=m(d,0,s-1),x=m(x,0,s-1),y=m(y,0,c-1),_=m(_,0,c-1),f=m(f,0,h-1),b=m(b,0,h-1)),0>d||0>y||0>f||x>=s||_>=c||b>=h)return o.create();var v=(i-a[0][d])/(a[0][x]-a[0][d]),k=(n-a[1][y])/(a[1][_]-a[1][y]),w=(l-a[2][f])/(a[2][b]-a[2][f]);(0>v||1<v||isNaN(v))&&(v=0),(0>k||1<k||isNaN(k))&&(k=0),(0>w||1<w||isNaN(w))&&(w=0);var T=f*s*c,A=b*s*c,S=y*s,C=_*s,L=d,E=x,I=t[S+T+L],z=t[S+T+E],P=t[C+T+L],D=t[C+T+E],O=t[S+A+L],R=t[S+A+E],M=t[C+A+L],j=t[C+A+E],F=o.create();return o.lerp(F,I,z,v),o.lerp(u,P,D,v),o.lerp(F,F,u,k),o.lerp(u,O,R,v),o.lerp(g,M,j,v),o.lerp(u,u,g,k),o.lerp(F,F,u,w),F},f=function(e){var t=1/0;e.sort(function(e,t){return e-t});for(var a=1,r;a<e.length;a++)r=_a(e[a]-e[a-1]),r<t&&(t=r);return t},x=function(e){for(var t=[],a=[],r=[],o={},n={},l={},s=0;s<e.length;s++){var d=e[s],c=d[0],p=d[1],u=d[2];o[c]||(t.push(c),o[c]=!0),n[p]||(a.push(p),n[p]=!0),l[u]||(r.push(u),l[u]=!0)}var g=f(t),h=f(a),m=f(r),y=ea(g,h,m);return isFinite(y)?y:1};t.exports=function(e,t){var a=e.startingPositions,r=e.maxLength||1e3,n=e.tubeSize||1,l=e.absoluteTubeSize;e.getDivergence||(e.getDivergence=d),e.getVelocity||(e.getVelocity=c),void 0===e.clampBorders&&(e.clampBorders=!0);var u=[],g=t[0][0],h=t[0][1],m=t[0][2],f=t[1][0],_=t[1][1],b=t[1][2],k=function(e,t){var a=t[0],r=t[1],o=t[2];return a>=g&&a<=f&&r>=h&&r<=_&&o>=m&&o<=b},w=o.distance(t[0],t[1]),T=10*w/r,A=T*T,S=1,C=0,L=o.create();2<=a.length&&(S=x(a));for(var E=0,y;E<a.length;E++){y=o.create(),o.copy(y,a[E]);var I=[y],z=[],P=e.getVelocity(y),D=y;z.push(P);var O=[],R=e.getDivergence(y,P),M=o.length(R);M>C&&!isNaN(M)&&isFinite(M)&&(C=M),O.push(M),u.push({points:I,velocities:z,divergences:O});for(var F=0;F<100*r&&I.length<r&&k(t,y);){F++;var B=o.clone(P),V=o.squaredLength(B);if(0===V)break;else V>A&&o.scale(B,B,T/N(V));if(o.add(B,B,y),P=e.getVelocity(B),o.squaredDistance(D,B)-A>-1e-4*A){I.push(B),D=B,z.push(P);var R=e.getDivergence(B,P),M=o.length(R);M>C&&!isNaN(M)&&isFinite(M)&&(C=M),O.push(M)}y=B}}for(var E=0,M;E<O.length;E++)M=O[E],(isNaN(M)||!isFinite(M))&&(O[E]=C);var U=s(u,e.colormap,C,S);return l?U.tubeScale=l:(0===C&&(C=1),U.tubeScale=.5*n*S/C),U},t.exports.createTubeMesh=e("./lib/tubemesh")},{"./lib/tubemesh":312,"gl-vec3":346,"gl-vec4":382}],314:[function(e,t,a){var r=e("gl-shader"),o=e("glslify"),i=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),n=o(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),l=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),s=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);a.createShader=function(e){var t=r(e,i,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t},a.createPickShader=function(e){var t=r(e,i,s,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t},a.createContourShader=function(e){var t=r(e,l,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t},a.createPickContourShader=function(e){var t=r(e,l,s,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t}},{"gl-shader":301,glslify:409}],315:[function(e,t,a){arguments[4][111][0].apply(a,arguments)},{dup:111}],316:[function(e,t){"use strict";function a(e,t,a,r,o){this.position=e,this.index=t,this.uv=a,this.level=r,this.dataCoordinate=o}function o(e){var t=k([b({colormap:e,nshades:256,format:"rgba"}).map(function(e){return[e[0],e[1],e[2],255*e[3]]})]);return v.divseq(t,255),t}function i(e,t,r,o,i,n,l,s,d,c,p,u,g,h,m){this.gl=e,this.shape=t,this.bounds=r,this.objectOffset=m,this.intensityBounds=[],this._shader=o,this._pickShader=i,this._coordinateBuffer=n,this._vao=l,this._colorMap=s,this._contourShader=d,this._contourPickShader=c,this._contourBuffer=p,this._contourVAO=u,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new a([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=g,this._dynamicVAO=h,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[w(_.mallocFloat(1024),[0,0]),w(_.mallocFloat(1024),[0,0]),w(_.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}function n(e,t){var a=t.axes&&t.axes.lastCubeProps.axis||F,r=t.showSurface,o=t.showContour,n,l,s;for(n=0;3>n;++n)for(r=r||t.surfaceProject[n],l=0;3>l;++l)o=o||t.contourProject[n][l];for(n=0;3>n;++n){var d=B.projections[n];for(l=0;16>l;++l)d[l]=0;for(l=0;4>l;++l)d[5*l]=1;d[5*n]=0,d[12+n]=t.axesBounds[+(0<a[n])][n],A(d,e.model,d);var c=B.clipBounds[n];for(s=0;2>s;++s)for(l=0;3>l;++l)c[s][l]=e.clipBounds[s][l];c[0][n]=-1e8,c[1][n]=1e8}return B.showSurface=r,B.showContour=o,B}function l(e,t){e=e||{};var a=this.gl;a.disable(a.CULL_FACE),this._colorMap.bind(0);var r=V;r.model=e.model||O,r.view=e.view||O,r.projection=e.projection||O,r.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],r.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],r.objectOffset=this.objectOffset,r.contourColor=this.contourColor[0],r.inverseModel=S(r.inverseModel,r.model);for(var o=0,l;2>o;++o){l=r.clipBounds[o];for(var d=0;3>d;++d)l[d]=ea(va(this.clipBounds[o][d],-1e8),1e8)}r.kambient=this.ambientLight,r.kdiffuse=this.diffuseLight,r.kspecular=this.specularLight,r.roughness=this.roughness,r.fresnel=this.fresnel,r.opacity=this.opacity,r.height=0,r.permutation=H,r.vertexColor=this.vertexColor;var c=U;for(A(c,r.view,r.model),A(c,r.projection,c),S(c,c),o=0;3>o;++o)r.eyePosition[o]=c[12+o]/c[15];var p=c[15];for(o=0;3>o;++o)p+=this.lightPosition[o]*c[4*o+3];for(o=0;3>o;++o){var u=c[12+o];for(d=0;3>d;++d)u+=c[4*d+o]*this.lightPosition[d];r.lightPosition[o]=u/p}var g=n(r,this);if(g.showSurface&&t===1>this.opacity){for(this._shader.bind(),this._shader.uniforms=r,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(a.TRIANGLES,this._vertexCount),o=0;3>o;++o)this.surfaceProject[o]&&this.vertexCount&&(this._shader.uniforms.model=g.projections[o],this._shader.uniforms.clipBounds=g.clipBounds[o],this._vao.draw(a.TRIANGLES,this._vertexCount));this._vao.unbind()}if(g.showContour&&!t){var h=this._contourShader;r.kambient=1,r.kdiffuse=0,r.kspecular=0,r.opacity=1,h.bind(),h.uniforms=r;var m=this._contourVAO;for(m.bind(),o=0;3>o;++o)for(h.uniforms.permutation=M[o],a.lineWidth(this.contourWidth[o]*this.pixelRatio),d=0;d<this.contourLevels[o].length;++d)(d===this.highlightLevel[o]?(h.uniforms.contourColor=this.highlightColor[o],h.uniforms.contourTint=this.highlightTint[o]):(0===d||d-1===this.highlightLevel[o])&&(h.uniforms.contourColor=this.contourColor[o],h.uniforms.contourTint=this.contourTint[o]),!!this._contourCounts[o][d])&&(h.uniforms.height=this.contourLevels[o][d],m.draw(a.LINES,this._contourCounts[o][d],this._contourOffsets[o][d]));for(o=0;3>o;++o)for(h.uniforms.model=g.projections[o],h.uniforms.clipBounds=g.clipBounds[o],d=0;3>d;++d)if(this.contourProject[o][d]){h.uniforms.permutation=M[d],a.lineWidth(this.contourWidth[d]*this.pixelRatio);for(var y=0;y<this.contourLevels[d].length;++y)(y===this.highlightLevel[d]?(h.uniforms.contourColor=this.highlightColor[d],h.uniforms.contourTint=this.highlightTint[d]):(0===y||y-1===this.highlightLevel[d])&&(h.uniforms.contourColor=this.contourColor[d],h.uniforms.contourTint=this.contourTint[d]),!!this._contourCounts[d][y])&&(h.uniforms.height=this.contourLevels[d][y],m.draw(a.LINES,this._contourCounts[d][y],this._contourOffsets[d][y]))}for(m.unbind(),m=this._dynamicVAO,m.bind(),o=0;3>o;++o)if(0!==this._dynamicCounts[o])for(h.uniforms.model=r.model,h.uniforms.clipBounds=r.clipBounds,h.uniforms.permutation=M[o],a.lineWidth(this.dynamicWidth[o]*this.pixelRatio),h.uniforms.contourColor=this.dynamicColor[o],h.uniforms.contourTint=this.dynamicTint[o],h.uniforms.height=this.dynamicLevel[o],m.draw(a.LINES,this._dynamicCounts[o],this._dynamicOffsets[o]),d=0;3>d;++d)this.contourProject[d][o]&&(h.uniforms.model=g.projections[d],h.uniforms.clipBounds=g.clipBounds[d],m.draw(a.LINES,this._dynamicCounts[o],this._dynamicOffsets[o]));m.unbind()}}function d(e,t){return Array.isArray(e)?[t(e[0]),t(e[1]),t(e[2])]:[t(e),t(e),t(e)]}function p(e){return Array.isArray(e)?3===e.length?[e[0],e[1],e[2],1]:[e[0],e[1],e[2],e[3]]:[0,0,0,1]}function u(e){if(Array.isArray(e)){if(Array.isArray(e))return[p(e[0]),p(e[1]),p(e[2])];var t=p(e);return[t.slice(),t.slice(),t.slice()]}}t.exports=function(e){var t=e.gl,a=I(t),r=P(t),o=z(t),n=D(t),l=h(t),s=m(t,[{buffer:l,size:4,stride:40,offset:0},{buffer:l,size:3,stride:40,offset:16},{buffer:l,size:3,stride:40,offset:28}]),d=h(t),c=m(t,[{buffer:d,size:4,stride:20,offset:0},{buffer:d,size:1,stride:20,offset:16}]),p=h(t),u=m(t,[{buffer:p,size:2,type:t.FLOAT}]),g=y(t,1,256,t.RGBA,t.UNSIGNED_BYTE);g.minFilter=t.LINEAR,g.magFilter=t.LINEAR;var f=new i(t,[0,0],[[0,0,0],[0,0,0]],a,r,l,s,g,o,n,d,c,p,u,[0,0,0]),x={levels:[[],[],[]]};for(var _ in e)x[_]=e[_];return x.colormap=x.colormap||"jet",f.update(x),f};var g=e("bit-twiddle"),h=e("gl-buffer"),m=e("gl-vao"),y=e("gl-texture2d"),_=e("typedarray-pool"),b=e("colormap"),v=e("ndarray-ops"),k=e("ndarray-pack"),w=e("ndarray"),T=e("surface-nets"),A=e("gl-mat4/multiply"),S=e("gl-mat4/invert"),C=e("binary-search-bounds"),L=e("ndarray-gradient"),E=e("./lib/shaders"),I=E.createShader,z=E.createContourShader,P=E.createPickShader,D=E.createPickContourShader,O=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],R=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],M=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var e=0;3>e;++e){var t=M[e],a=(e+1)%3,r=(e+2)%3;t[a+0]=1,t[r+3]=1,t[e+6]=1}})();var j=i.prototype;j.isTransparent=function(){return 1>this.opacity},j.isOpaque=function(){if(1<=this.opacity)return!0;for(var e=0;3>e;++e)if(0<this._contourCounts[e].length||0<this._dynamicCounts[e])return!0;return!1},j.pickSlots=1,j.setPickBase=function(e){this.pickId=e};var F=[0,0,0],B={showSurface:!1,showContour:!1,projections:[O.slice(),O.slice(),O.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]},V={model:O,view:O,projection:O,inverseModel:O.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},U=O.slice(),H=[1,0,0,0,1,0,0,0,1];j.draw=function(e){return l.call(this,e,!1)},j.drawTransparent=function(e){return l.call(this,e,!0)};var G={model:O,view:O,projection:O,inverseModel:O,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};j.drawPick=function(e){e=e||{};var t=this.gl;t.disable(t.CULL_FACE);var a=G;a.model=e.model||O,a.view=e.view||O,a.projection=e.projection||O,a.shape=this._field[2].shape,a.pickId=this.pickId/255,a.lowerBound=this.bounds[0],a.upperBound=this.bounds[1],a.objectOffset=this.objectOffset,a.permutation=H;for(var r=0,o;2>r;++r){o=a.clipBounds[r];for(var l=0;3>l;++l)o[l]=ea(va(this.clipBounds[r][l],-1e8),1e8)}var s=n(a,this);if(s.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=a,this._vao.bind(),this._vao.draw(t.TRIANGLES,this._vertexCount),r=0;3>r;++r)this.surfaceProject[r]&&(this._pickShader.uniforms.model=s.projections[r],this._pickShader.uniforms.clipBounds=s.clipBounds[r],this._vao.draw(t.TRIANGLES,this._vertexCount));this._vao.unbind()}if(s.showContour){var d=this._contourPickShader;d.bind(),d.uniforms=a;var c=this._contourVAO;for(c.bind(),l=0;3>l;++l)for(t.lineWidth(this.contourWidth[l]*this.pixelRatio),d.uniforms.permutation=M[l],r=0;r<this.contourLevels[l].length;++r)this._contourCounts[l][r]&&(d.uniforms.height=this.contourLevels[l][r],c.draw(t.LINES,this._contourCounts[l][r],this._contourOffsets[l][r]));for(r=0;3>r;++r)for(d.uniforms.model=s.projections[r],d.uniforms.clipBounds=s.clipBounds[r],l=0;3>l;++l)if(this.contourProject[r][l]){d.uniforms.permutation=M[l],t.lineWidth(this.contourWidth[l]*this.pixelRatio);for(var p=0;p<this.contourLevels[l].length;++p)this._contourCounts[l][p]&&(d.uniforms.height=this.contourLevels[l][p],c.draw(t.LINES,this._contourCounts[l][p],this._contourOffsets[l][p]))}c.unbind()}},j.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var o=this._field[2].shape,n=this._pickResult,l=o[0]*(e.value[0]+(e.value[2]>>4)/16)/255,d=ba(l),p=l-d,u=o[1]*(e.value[1]+(15&e.value[2])/16)/255,g=ba(u),h=u-g;d+=1,g+=1;var m=n.position;m[0]=m[1]=m[2]=0;for(var y=0,f;2>y;++y){f=y?p:1-p;for(var x=0;2>x;++x)for(var _=x?h:1-h,t=d+y,r=g+x,c=f*_,v=0;3>v;++v)m[v]+=this._field[v].get(t,r)*c}for(var k=this._pickResult.level,w=0;3>w;++w)if(k[w]=C.le(this.contourLevels[w],m[w]),0>k[w])0<this.contourLevels[w].length&&(k[w]=0);else if(k[w]<this.contourLevels[w].length-1){var T=this.contourLevels[w][k[w]],a=this.contourLevels[w][k[w]+1];_a(T-m[w])>_a(a-m[w])&&(k[w]+=1)}for(n.index[0]=.5>p?d:d+1,n.index[1]=.5>h?g:g+1,n.uv[0]=l/o[0],n.uv[1]=u/o[1],v=0;3>v;++v)n.dataCoordinate[v]=this._field[v].get(n.index[0],n.index[1]);return n},j.padField=function(e,t){var a=t.shape.slice(),r=e.shape.slice();v.assign(e.lo(1,1).hi(a[0],a[1]),t),v.assign(e.lo(1).hi(a[0],1),t.hi(a[0],1)),v.assign(e.lo(1,r[1]-1).hi(a[0],1),t.lo(0,a[1]-1).hi(a[0],1)),v.assign(e.lo(0,1).hi(1,a[1]),t.hi(1)),v.assign(e.lo(r[0]-1,1).hi(1,a[1]),t.lo(a[0]-1)),e.set(0,0,t.get(0,0)),e.set(0,r[1]-1,t.get(0,a[1]-1)),e.set(r[0]-1,0,t.get(a[0]-1,0)),e.set(r[0]-1,r[1]-1,t.get(a[0]-1,a[1]-1))},j.update=function(a){a=a||{},this.objectOffset=a.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in a&&(this.contourWidth=d(a.contourWidth,Number)),"showContour"in a&&(this.showContour=d(a.showContour,Boolean)),"showSurface"in a&&(this.showSurface=!!a.showSurface),"contourTint"in a&&(this.contourTint=d(a.contourTint,Boolean)),"contourColor"in a&&(this.contourColor=u(a.contourColor)),"contourProject"in a&&(this.contourProject=d(a.contourProject,function(e){return d(e,Boolean)})),"surfaceProject"in a&&(this.surfaceProject=a.surfaceProject),"dynamicColor"in a&&(this.dynamicColor=u(a.dynamicColor)),"dynamicTint"in a&&(this.dynamicTint=d(a.dynamicTint,Number)),"dynamicWidth"in a&&(this.dynamicWidth=d(a.dynamicWidth,Number)),"opacity"in a&&(this.opacity=a.opacity),"colorBounds"in a&&(this.colorBounds=a.colorBounds),"vertexColor"in a&&(this.vertexColor=a.vertexColor?1:0);var n=a.field||a.coords&&a.coords[2]||null,h=!1;if(n||(this._field[2].shape[0]||this._field[2].shape[2]?n=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):n=this._field[2].hi(0,0)),"field"in a||"coords"in a){var m=(n.shape[0]+2)*(n.shape[1]+2);m>this._field[2].data.length&&(_.freeFloat(this._field[2].data),this._field[2].data=_.mallocFloat(g.nextPow2(m))),this._field[2]=w(this._field[2].data,[n.shape[0]+2,n.shape[1]+2]),this.padField(this._field[2],n),this.shape=n.shape.slice();for(var b=this.shape,v=0;2>v;++v)this._field[2].size>this._field[v].data.length&&(_.freeFloat(this._field[v].data),this._field[v].data=_.mallocFloat(this._field[2].size)),this._field[v]=w(this._field[v].data,[b[0]+2,b[1]+2]);if(a.coords){var A=a.coords;if(!Array.isArray(A)||3!==A.length)throw new Error("gl-surface: invalid coordinates for x/y");for(v=0;2>v;++v){var S=A[v];for(P=0;2>P;++P)if(S.shape[P]!==b[P])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[v],S)}}else if(a.ticks){var C=a.ticks;if(!Array.isArray(C)||2!==C.length)throw new Error("gl-surface: invalid ticks");for(v=0;2>v;++v){var E=C[v];if((Array.isArray(E)||E.length)&&(E=w(E)),E.shape[0]!==b[v])throw new Error("gl-surface: invalid tick length");var I=w(E.data,b);I.stride[v]=E.stride[0],I.stride[1^v]=0,this.padField(this._field[v],I)}}else{for(v=0;2>v;++v){var z=[0,0];z[v]=1,this._field[v]=w(this._field[v].data,[b[0]+2,b[1]+2],z,0)}this._field[0].set(0,0,0);for(var P=0;P<b[0];++P)this._field[0].set(P+1,0,P);for(this._field[0].set(b[0]+1,0,b[0]-1),this._field[1].set(0,0,0),P=0;P<b[1];++P)this._field[1].set(0,P+1,P);this._field[1].set(0,b[1]+1,b[1]-1)}var D=this._field,O=w(_.mallocFloat(2*(3*D[2].size)),[3,b[0]+2,b[1]+2,2]);for(v=0;3>v;++v)L(O.pick(v),D[v],"mirror");var M=w(_.mallocFloat(3*D[2].size),[b[0]+2,b[1]+2,3]);for(v=0;v<b[0]+2;++v)for(P=0;P<b[1]+2;++P){var F=O.get(0,v,P,0),B=O.get(0,v,P,1),V=O.get(1,v,P,0),U=O.get(1,v,P,1),H=O.get(2,v,P,0),G=O.get(2,v,P,1),q=V*G-U*H,Y=H*B-G*F,W=F*U-B*V,X=N(q*q+Y*Y+W*W);1e-8>X?(X=va(_a(q),_a(Y),_a(W)),1e-8>X?(W=1,Y=q=0,X=1):X=1/X):X=1/N(X),M.set(v,P,0,q*X),M.set(v,P,1,Y*X),M.set(v,P,2,W*X)}_.free(O.data);var Z=[1/0,1/0,1/0],K=[-Infinity,-Infinity,-Infinity],J=1/0,Q=-Infinity,$=6*((b[0]-1)*(b[1]-1)),ee=_.mallocFloat(g.nextPow2(10*$)),te=0,ae=0;for(v=0;v<b[0]-1;++v)j_loop:for(P=0;P<b[1]-1;++P){for(var re=0;2>re;++re)for(var oe=0;2>oe;++oe)for(var ie=0,ne;3>ie;++ie)if(ne=this._field[ie].get(1+v+re,1+P+oe),isNaN(ne)||!isFinite(ne))continue j_loop;for(ie=0;6>ie;++ie){var le=v+R[ie][0],se=P+R[ie][1],de=this._field[0].get(le+1,se+1),ce=this._field[1].get(le+1,se+1);ne=this._field[2].get(le+1,se+1),q=M.get(le+1,se+1,0),Y=M.get(le+1,se+1,1),W=M.get(le+1,se+1,2),a.intensity&&(pe=a.intensity.get(le,se));var pe=a.intensity?a.intensity.get(le,se):ne+this.objectOffset[2];ee[te++]=le,ee[te++]=se,ee[te++]=de,ee[te++]=ce,ee[te++]=ne,ee[te++]=0,ee[te++]=pe,ee[te++]=q,ee[te++]=Y,ee[te++]=W,Z[0]=ea(Z[0],de+this.objectOffset[0]),Z[1]=ea(Z[1],ce+this.objectOffset[1]),Z[2]=ea(Z[2],ne+this.objectOffset[2]),J=ea(J,pe),K[0]=va(K[0],de+this.objectOffset[0]),K[1]=va(K[1],ce+this.objectOffset[1]),K[2]=va(K[2],ne+this.objectOffset[2]),Q=va(Q,pe),ae+=1}}for(a.intensityBounds&&(J=+a.intensityBounds[0],Q=+a.intensityBounds[1]),v=6;v<te;v+=10)ee[v]=(ee[v]-J)/(Q-J);this._vertexCount=ae,this._coordinateBuffer.update(ee.subarray(0,te)),_.freeFloat(ee),_.free(M.data),this.bounds=[Z,K],this.intensity=a.intensity||this._field[2],(this.intensityBounds[0]!==J||this.intensityBounds[1]!==Q)&&(h=!0),this.intensityBounds=[J,Q]}if("levels"in a){var ue=a.levels;for(ue=Array.isArray(ue[0])?ue.slice():[[],[],ue],v=0;3>v;++v)ue[v]=ue[v].slice(),ue[v].sort(function(e,t){return e-t});for(v=0;3>v;++v)for(P=0;P<ue[v].length;++P)ue[v][P]-=this.objectOffset[v];change_test:for(v=0;3>v;++v){if(ue[v].length!==this.contourLevels[v].length){h=!0;break}for(P=0;P<ue[v].length;++P)if(ue[v][P]!==this.contourLevels[v][P]){h=!0;break change_test}}this.contourLevels=ue}if(h){D=this._field,b=this.shape;for(var ge=[],he=0;3>he;++he){var me=this.contourLevels[he],ye=[],fe=[],xe=[0,0,0];for(v=0;v<me.length;++v){var _e=T(this._field[he],me[v]);ye.push(0|ge.length/5),ae=0;edge_loop:for(P=0;P<_e.cells.length;++P){var be=_e.cells[P];for(ie=0;2>ie;++ie){var e=_e.positions[be[ie]],p=e[0],x=0|ba(p),ve=p-x,ke=e[1],y=0|ba(ke),we=ke-y,Te=!1;axis_loop:for(var Ae=0;3>Ae;++Ae){xe[Ae]=0;var Se=(he+Ae+1)%3;for(re=0;2>re;++re){var Ce=re?ve:1-ve;for(le=0|ea(va(x+re,0),b[0]),oe=0;2>oe;++oe){var s=oe?we:1-we;if(se=0|ea(va(y+oe,0),b[1]),ne=2>Ae?this._field[Se].get(le,se):(this.intensity.get(le,se)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(ne)||isNaN(ne)){Te=!0;break axis_loop}xe[Ae]+=Ce*s*ne}}}if(!Te)ge.push(xe[0],xe[1],e[0],e[1],xe[2]),ae+=1;else{if(0<ie){for(var t=0;5>t;++t)ge.pop();ae-=1}continue edge_loop}}}fe.push(ae)}this._contourOffsets[he]=ye,this._contourCounts[he]=fe}var Le=_.mallocFloat(ge.length);for(v=0;v<ge.length;++v)Le[v]=ge[v];this._contourBuffer.update(Le),_.freeFloat(Le)}a.colormap&&this._colorMap.setPixels(o(a.colormap))},j.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var e=0;3>e;++e)_.freeFloat(this._field[e].data)},j.highlight=function(t){var a;if(!t)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(a=0;3>a;++a)this.highlightLevel[a]=this.enableHighlight[a]?t.level[a]:-1;var r;for(r=this.snapToData?t.dataCoordinate:t.position,a=0;3>a;++a)r[a]-=this.objectOffset[a];if(this.enableDynamic[0]&&r[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&r[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&r[2]!==this.dynamicLevel[2]){for(var o=0,n=this.shape,l=_.mallocFloat(12*n[0]*n[1]),s=0;3>s;++s){if(!this.enableDynamic[s]){this.dynamicLevel[s]=NaN,this._dynamicCounts[s]=0;continue}this.dynamicLevel[s]=r[s];var c=(s+1)%3,u=(s+2)%3,m=this._field[s],f=this._field[c],g=this._field[u],h=T(m,r[s]),b=h.cells,v=h.positions;for(this._dynamicOffsets[s]=o,a=0;a<b.length;++a)for(var k=b[a],e=0;2>e;++e){var w=v[k[e]],p=+w[0],x=0|p,A=0|ea(x+1,n[0]),S=p-x,C=1-S,L=+w[1],y=0|L,E=0|ea(y+1,n[1]),I=L-y,z=1-I,P=C*z,D=C*I,O=S*z,R=S*I,M=P*f.get(x,y)+D*f.get(x,E)+O*f.get(A,y)+R*f.get(A,E),F=P*g.get(x,y)+D*g.get(x,E)+O*g.get(A,y)+R*g.get(A,E);if(isNaN(M)||isNaN(F)){e&&(o-=1);break}l[2*o+0]=M,l[2*o+1]=F,o+=1}this._dynamicCounts[s]=o-this._dynamicOffsets[s]}this._dynamicBuffer.update(l.subarray(0,2*o)),_.freeFloat(l)}}},{"./lib/shaders":314,"binary-search-bounds":315,"bit-twiddle":92,colormap:126,"gl-buffer":241,"gl-mat4/invert":265,"gl-mat4/multiply":267,"gl-texture2d":322,"gl-vao":327,ndarray:450,"ndarray-gradient":441,"ndarray-ops":444,"ndarray-pack":445,"surface-nets":531,"typedarray-pool":545}],317:[function(e,t){"use strict";function a(e){return"function"==typeof e&&e._gl&&e.prop&&e.texture&&e.buffer}var r=e("css-font"),n=e("pick-by-alias"),l=e("regl"),s=e("gl-util/context"),d=e("es6-weak-map"),c=e("color-normalize"),p=e("font-atlas"),u=e("typedarray-pool"),g=e("parse-rect"),h=e("is-plain-obj"),m=e("parse-unit"),y=e("to-px"),o=e("detect-kerning"),i=e("object-assign"),f=e("font-measure"),x=e("flatten-vertex-data"),_=e("bit-twiddle"),b=_.nextPow2,v=new d,k=!1;if(document.body){var w=document.body.appendChild(document.createElement("div"));w.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(w).fontStretch&&(k=!0),document.body.removeChild(w)}var T=function(e){a(e)?(e={regl:e},this.gl=e.regl._gl):this.gl=s(e),this.shader=v.get(this.gl),this.regl=this.shader?this.shader.regl:e.regl||l({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),v.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(h(e)?e:{})};T.prototype.createShader=function(){var e=this.regl,t=e({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:e.prop("count"),offset:e.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:e.this("sizeBuffer")},width:{offset:0,stride:8,buffer:e.this("sizeBuffer")},char:e.this("charBuffer"),position:e.this("position")},uniforms:{atlasSize:function(e,t){return[t.atlas.width,t.atlas.height]},atlasDim:function(e,t){return[t.atlas.cols,t.atlas.rows]},atlas:function(e,t){return t.atlas.texture},charStep:function(e,t){return t.atlas.step},em:function(e,t){return t.atlas.em},color:e.prop("color"),opacity:e.prop("opacity"),viewport:e.this("viewportArray"),scale:e.this("scale"),align:e.prop("align"),baseline:e.prop("baseline"),translate:e.this("translate"),positionOffset:e.prop("positionOffset")},primitive:"points",viewport:e.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\t"+(T.normalViewport?"":"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);")+"\n\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ positionOffset))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\t"+(T.normalViewport?"position.y = 1. - position.y;":"")+"\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform sampler2D atlas;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});return{regl:e,draw:t,atlas:{}}},T.prototype.update=function(e){var t=this;if("string"==typeof e)e={text:e};else if(!e)return;e=n(e,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),null!=e.opacity&&(Array.isArray(e.opacity)?this.opacity=e.opacity.map(function(e){return parseFloat(e)}):this.opacity=parseFloat(e.opacity)),null!=e.viewport&&(this.viewport=g(e.viewport),T.normalViewport&&(this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=e.kerning&&(this.kerning=e.kerning),null!=e.offset&&("number"==typeof e.offset&&(e.offset=[e.offset,0]),this.positionOffset=x(e.offset)),e.direction&&(this.direction=e.direction),e.range&&(this.range=e.range,this.scale=[1/(e.range[2]-e.range[0]),1/(e.range[3]-e.range[1])],this.translate=[-e.range[0],-e.range[1]]),e.scale&&(this.scale=e.scale),e.translate&&(this.translate=e.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||e.font||(e.font=T.baseFontSize+"px sans-serif");var a=!1,s=!1;if(e.font&&(Array.isArray(e.font)?e.font:[e.font]).forEach(function(o,n){if("string"==typeof o)try{o=r.parse(o)}catch(t){o=r.parse(T.baseFontSize+"px "+o)}else o=r.parse(r.stringify(o));var e=r.stringify({size:T.baseFontSize,family:o.family,stretch:k?o.stretch:void 0,variant:o.variant,weight:o.weight,style:o.style}),i=m(o.size),l=V(i[0]*y(i[1]));if(l!==t.fontSize[n]&&(s=!0,t.fontSize[n]=l),(!t.font[n]||e!=t.font[n].baseString)&&(a=!0,t.font[n]=T.fonts[e],!t.font[n])){var d=o.family.join(", "),c=[o.style];o.style!=o.variant&&c.push(o.variant),o.variant!=o.weight&&c.push(o.weight),k&&o.weight!=o.stretch&&c.push(o.stretch),t.font[n]={baseString:e,family:d,weight:o.weight,stretch:o.stretch,style:o.style,variant:o.variant,width:{},kerning:{},metrics:f(d,{origin:"top",fontSize:T.baseFontSize,fontStyle:c.join(" ")})},T.fonts[e]=t.font[n]}}),(a||s)&&this.font.forEach(function(a,o){var i=r.stringify({size:t.fontSize[o],family:a.family,stretch:k?a.stretch:void 0,variant:a.variant,weight:a.weight,style:a.style});if(t.fontAtlas[o]=t.shader.atlas[i],!t.fontAtlas[o]){var n=a.metrics;t.shader.atlas[i]=t.fontAtlas[o]={fontString:i,step:2*M(.5*(t.fontSize[o]*n.bottom)),em:t.fontSize[o],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:t.regl.texture()}}null==e.text&&(e.text=t.text)}),"string"==typeof e.text&&e.position&&2<e.position.length){for(var d=Array(.5*e.position.length),h=0;h<d.length;h++)d[h]=e.text;e.text=d}var _;if(null!=e.text||a){if(this.textOffsets=[0],Array.isArray(e.text)){this.count=e.text[0].length,this.counts=[this.count];for(var v=1;v<e.text.length;v++)this.textOffsets[v]=this.textOffsets[v-1]+e.text[v-1].length,this.count+=e.text[v].length,this.counts.push(e.text[v].length);this.text=e.text.join("")}else this.text=e.text,this.count=this.text.length,this.counts=[this.count];_=[],this.font.forEach(function(e,a){T.atlasContext.font=e.baseString;for(var r=t.fontAtlas[a],n=0,l;n<t.text.length;n++)if(l=t.text.charAt(n),null==r.ids[l]&&(r.ids[l]=r.chars.length,r.chars.push(l),_.push(l)),null==e.width[l]&&(e.width[l]=T.atlasContext.measureText(l).width/T.baseFontSize,t.kerning)){var s=[];for(var d in e.width)s.push(d+l,l+d);i(e.kerning,o(e.family,{pairs:s}))}})}if(e.position)if(2<e.position.length){for(var w=!e.position[0].length,A=u.mallocFloat(2*this.count),S=0,C=0,L;S<this.counts.length;S++)if(L=this.counts[S],w)for(var E=0;E<L;E++)A[C++]=e.position[2*S],A[C++]=e.position[2*S+1];else for(var I=0;I<L;I++)A[C++]=e.position[S][0],A[C++]=e.position[S][1];this.position.call?this.position({type:"float",data:A}):this.position=this.regl.buffer({type:"float",data:A}),u.freeFloat(A)}else this.position.destroy&&this.position.destroy(),this.position={constant:e.position};if(e.text||a){var z=u.mallocUint8(this.count),P=u.mallocFloat(2*this.count);this.textWidth=[];for(var D=0,O=0;D<this.counts.length;D++){for(var R=this.counts[D],F=this.font[D]||this.font[0],B=this.fontAtlas[D]||this.fontAtlas[0],N=0;N<R;N++){var U=this.text.charAt(O),H=this.text.charAt(O-1);if(z[O]=B.ids[U],P[2*O]=F.width[U],N){var G=P[2*O-2],q=P[2*O],Y=P[2*O-1],W=Y+.5*G+.5*q;if(this.kerning){var X=F.kerning[H+U];X&&(W+=1e-3*X)}P[2*O+1]=W}else P[2*O+1]=.5*P[2*O];O++}this.textWidth.push(P.length?.5*P[2*O-2]+P[2*O-1]:0)}e.align||(e.align=this.align),this.charBuffer({data:z,type:"uint8",usage:"stream"}),this.sizeBuffer({data:P,type:"float",usage:"stream"}),u.freeUint8(z),u.freeFloat(P),_.length&&this.font.forEach(function(e,a){var r=t.fontAtlas[a],o=r.step,i=ba(T.maxAtlasSize/o),n=ea(i,r.chars.length),l=M(r.chars.length/n),s=b(n*o),d=b(l*o);r.width=s,r.height=d,r.rows=l,r.cols=n,r.em&&r.texture({data:p({canvas:T.atlasCanvas,font:r.fontString,chars:r.chars,shape:[s,d],step:[o,o]})})})}if(e.align&&(this.align=e.align,this.alignOffset=this.textWidth.map(function(e,a){var r=Array.isArray(t.align)?1<t.align.length?t.align[a]:t.align[0]:t.align;return"number"==typeof r?r:"right"===r||"end"===r?-e:"center"===r||"centre"===r||"middle"===r?.5*-e:0})),null==this.baseline&&null==e.baseline&&(e.baseline=0),null!=e.baseline&&(this.baseline=e.baseline,!Array.isArray(this.baseline)&&(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(e,a){var r=(t.font[a]||t.font[0]).metrics,o=0;return o+=.5*r.bottom,o+="number"==typeof e?e-r.baseline:-r[e],T.normalViewport||(o*=-1),o})),null!=e.color)if(e.color||(e.color="transparent"),"string"==typeof e.color||!isNaN(e.color))this.color=c(e.color,"uint8");else{var Z;if("number"==typeof e.color[0]&&e.color.length>this.counts.length){var K=e.color.length;Z=u.mallocUint8(K);for(var l=(e.color.subarray||e.color.slice).bind(e.color),J=0;J<K;J+=4)Z.set(c(l(J,J+4),"uint8"),J)}else{var Q=e.color.length;Z=u.mallocUint8(4*Q);for(var $=0;$<Q;$++)Z.set(c(e.color[$]||0,"uint8"),4*$)}this.color=Z}if(e.position||e.text||e.color||e.baseline||e.align||e.font||e.offset||e.opacity){var ee=4<this.color.length||1<this.baselineOffset.length||this.align&&1<this.align.length||1<this.fontAtlas.length||2<this.positionOffset.length;if(ee){var te=va(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(te);for(var ae=0;ae<this.batch.length;ae++)this.batch[ae]={count:1<this.counts.length?this.counts[ae]:this.counts[0],offset:1<this.textOffsets.length?this.textOffsets[ae]:this.textOffsets[0],color:this.color?4>=this.color.length?this.color:this.color.subarray(4*ae,4*ae+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[ae]:this.opacity,baseline:null==this.baselineOffset[ae]?this.baselineOffset[0]:this.baselineOffset[ae],align:this.align?null==this.alignOffset[ae]?this.alignOffset[0]:this.alignOffset[ae]:0,atlas:this.fontAtlas[ae]||this.fontAtlas[0],positionOffset:2<this.positionOffset.length?this.positionOffset.subarray(2*ae,2*ae+2):this.positionOffset}}else this.batch=this.count?[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:[]}},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.normalViewport=!1,T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={},t.exports=T},{"bit-twiddle":92,"color-normalize":120,"css-font":139,"detect-kerning":166,"es6-weak-map":318,"flatten-vertex-data":227,"font-atlas":228,"font-measure":229,"gl-util/context":323,"is-plain-obj":422,"object-assign":454,"parse-rect":459,"parse-unit":461,"pick-by-alias":465,regl:502,"to-px":539,"typedarray-pool":545}],318:[function(e,t){"use strict";t.exports=e("./is-implemented")()?WeakMap:e("./polyfill")},{"./is-implemented":319,"./polyfill":321}],319:[function(e,t){"use strict";t.exports=function(){var e,t;if("function"!=typeof WeakMap)return!1;try{e=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(t){return!1}return!("[object WeakMap]"!==e+"")&&!("function"!=typeof e.set)&&!(e.set({},1)!==e)&&!("function"!=typeof e.delete)&&!("function"!=typeof e.has)&&!("one"!==e.get(t))}},{}],320:[function(e,t){"use strict";t.exports=function(){return!("function"!=typeof WeakMap)&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)}()},{}],321:[function(e,t){"use strict";var a=e("es5-ext/object/is-value"),r=e("es5-ext/object/set-prototype-of"),o=e("es5-ext/object/valid-object"),i=e("es5-ext/object/valid-value"),n=e("es5-ext/string/random-uniq"),l=e("d"),s=e("es6-iterator/get"),d=e("es6-iterator/for-of"),c=e("es6-symbol").toStringTag,p=e("./is-native-implemented"),u=Array.isArray,g=Object.defineProperty,h=Object.prototype.hasOwnProperty,m=Object.getPrototypeOf,y;t.exports=y=function(){var e=arguments[0],t;if(!(this instanceof y))throw new TypeError("Constructor requires 'new'");return(t=p&&r&&WeakMap!==y?r(new WeakMap,m(this)):this,a(e)&&!u(e)&&(e=s(e)),g(t,"__weakMapData__",l("c","$weakMap$"+n())),!e)?t:(d(e,function(e){i(e),t.set(e[0],e[1])}),t)},p&&(r&&r(y,WeakMap),y.prototype=Object.create(WeakMap.prototype,{constructor:l(y)})),Object.defineProperties(y.prototype,{delete:l(function(e){return!!h.call(o(e),this.__weakMapData__)&&(delete e[this.__weakMapData__],!0)}),get:l(function(e){return h.call(o(e),this.__weakMapData__)?e[this.__weakMapData__]:void 0}),has:l(function(e){return h.call(o(e),this.__weakMapData__)}),set:l(function(e,t){return g(o(e),this.__weakMapData__,l("c",t)),this}),toString:l(function(){return"[object WeakMap]"})}),g(y.prototype,c,l("c","WeakMap"))},{"./is-native-implemented":320,d:151,"es5-ext/object/is-value":194,"es5-ext/object/set-prototype-of":200,"es5-ext/object/valid-object":204,"es5-ext/object/valid-value":205,"es5-ext/string/random-uniq":210,"es6-iterator/for-of":212,"es6-iterator/get":213,"es6-symbol":219}],322:[function(e,t){"use strict";function a(e){y=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST],f=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],x=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function r(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&e instanceof ImageData}function o(e,t,a){var r=e.gl,o=r.getParameter(r.MAX_TEXTURE_SIZE);if(0>t||t>o||0>a||a>o)throw new Error("gl-texture2d: Invalid texture size");return e._shape=[t,a],e.bind(),r.texImage2D(r.TEXTURE_2D,0,e.format,t,a,0,e.format,e.type,null),e._mipLevels=[0],e}function i(e,t,a,r,o,i){this.gl=e,this.handle=t,this.format=o,this.type=i,this._shape=[a,r],this._mipLevels=[0],this._magFilter=e.NEAREST,this._minFilter=e.NEAREST,this._wrapS=e.CLAMP_TO_EDGE,this._wrapT=e.CLAMP_TO_EDGE,this._anisoSamples=1;var n=this,l=[this._wrapS,this._wrapT];Object.defineProperties(l,[{get:function(){return n._wrapS},set:function(e){return n.wrapS=e}},{get:function(){return n._wrapT},set:function(e){return n.wrapT=e}}]),this._wrapVector=l;var s=[this._shape[0],this._shape[1]];Object.defineProperties(s,[{get:function(){return n._shape[0]},set:function(e){return n.width=e}},{get:function(){return n._shape[1]},set:function(e){return n.height=e}}]),this._shapeVector=s}function n(e,t){return 3===e.length?1===t[2]&&t[1]===e[0]*e[2]&&t[0]===e[2]:1===t[0]&&t[1]===e[0]}function l(e,t,a,r,o,i,l,s){var d=s.dtype,c=s.shape.slice();if(2>c.length||3<c.length)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var p=0,u=0,y=n(c,s.stride.slice());"float32"===d?p=e.FLOAT:"float64"===d?(p=e.FLOAT,y=!1,d="float32"):"uint8"===d?p=e.UNSIGNED_BYTE:(p=e.UNSIGNED_BYTE,y=!1,d="uint8");if(2===c.length)u=e.LUMINANCE,c=[c[0],c[1],1],s=g(s.data,c,[s.stride[0],s.stride[1],1],s.offset);else if(3===c.length){if(1===c[2])u=e.ALPHA;else if(2===c[2])u=e.LUMINANCE_ALPHA;else if(3===c[2])u=e.RGB;else if(4===c[2])u=e.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");c[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((u===e.LUMINANCE||u===e.ALPHA)&&(o===e.LUMINANCE||o===e.ALPHA)&&(u=o),u!==o)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var f=s.size,x=0>l.indexOf(r);if(x&&l.push(r),p===i&&y)0===s.offset&&s.data.length===f?x?e.texImage2D(e.TEXTURE_2D,r,o,c[0],c[1],0,o,i,s.data):e.texSubImage2D(e.TEXTURE_2D,r,t,a,c[0],c[1],o,i,s.data):x?e.texImage2D(e.TEXTURE_2D,r,o,c[0],c[1],0,o,i,s.data.subarray(s.offset,s.offset+f)):e.texSubImage2D(e.TEXTURE_2D,r,t,a,c[0],c[1],o,i,s.data.subarray(s.offset,s.offset+f));else{var b=i===e.FLOAT?m.mallocFloat32(f):m.mallocUint8(f);var v=g(b,c,[c[2],c[2]*c[0],1]);p===e.FLOAT&&i===e.UNSIGNED_BYTE?_(v,s):h.assign(v,s),x?e.texImage2D(e.TEXTURE_2D,r,o,c[0],c[1],0,o,i,b.subarray(0,f)):e.texSubImage2D(e.TEXTURE_2D,r,t,a,c[0],c[1],o,i,b.subarray(0,f)),i===e.FLOAT?m.freeFloat32(b):m.freeUint8(b)}}function s(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function d(e,t,a,r,o){var n=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>t||t>n||0>a||a>n)throw new Error("gl-texture2d: Invalid texture shape");if(o===e.FLOAT&&!e.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var l=s(e);return e.texImage2D(e.TEXTURE_2D,0,r,t,a,0,r,o,null),new i(e,l,t,a,r,o)}function c(e,t,a,r,o,n){var l=s(e);return e.texImage2D(e.TEXTURE_2D,0,o,o,n,t),new i(e,l,a,r,o,n)}function p(e,t){var a=t.dtype,r=t.shape.slice(),o=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>r[0]||r[0]>o||0>r[1]||r[1]>o)throw new Error("gl-texture2d: Invalid texture size");var l=n(r,t.stride.slice()),d=0;"float32"===a?d=e.FLOAT:"float64"===a?(d=e.FLOAT,l=!1,a="float32"):"uint8"===a?d=e.UNSIGNED_BYTE:(d=e.UNSIGNED_BYTE,l=!1,a="uint8");var c=0;if(2===r.length)c=e.LUMINANCE,r=[r[0],r[1],1],t=g(t.data,r,[t.stride[0],t.stride[1],1],t.offset);else if(3!==r.length)throw new Error("gl-texture2d: Invalid shape for texture");else if(1===r[2])c=e.ALPHA;else if(2===r[2])c=e.LUMINANCE_ALPHA;else if(3===r[2])c=e.RGB;else if(4===r[2])c=e.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");d!==e.FLOAT||e.getExtension("OES_texture_float")||(d=e.UNSIGNED_BYTE,l=!1);var p=t.size,u,y;if(!l){var f=[r[2],r[2]*r[0],1];y=m.malloc(p,a);var x=g(y,r,f,0);("float32"===a||"float64"===a)&&d===e.UNSIGNED_BYTE?_(x,t):h.assign(x,t),u=y.subarray(0,p)}else u=0===t.offset&&t.data.length===p?t.data:t.data.subarray(t.offset,t.offset+p);var b=s(e);return e.texImage2D(e.TEXTURE_2D,0,c,r[0],r[1],0,c,d,u),l||m.free(y),new i(e,b,r[0],r[1],c,d)}function u(e){if(1>=arguments.length)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(y||a(e),"number"==typeof arguments[1])return d(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return d(e,0|arguments[1][0],0|arguments[1][1],arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var t=arguments[1],o=r(t)?t:t.raw;if(o)return c(e,o,0|t.width,0|t.height,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return p(e,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var g=e("ndarray"),h=e("ndarray-ops"),m=e("typedarray-pool");t.exports=u;var y=null,f=null,x=null,_=function(e,t){h.muls(e,t,255)},b=i.prototype;Object.defineProperties(b,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&0<=y.indexOf(e)&&!t.getExtension("OES_texture_float_linear")&&(e=t.NEAREST),0>f.indexOf(e))throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&0<=y.indexOf(e)&&!t.getExtension("OES_texture_float_linear")&&(e=t.NEAREST),0>f.indexOf(e))throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;if(this._anisoSamples=0|va(e,1),t!==this._anisoSamples){var a=this.gl.getExtension("EXT_texture_filter_anisotropic");a&&this.gl.texParameterf(this.gl.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){if(this.bind(),0>x.indexOf(e))throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e),this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){if(this.bind(),0>x.indexOf(e))throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e),this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(Array.isArray(e)||(e=[e,e]),2!==e.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var t=0;2>t;++t)if(0>x.indexOf(e[t]))throw new Error("gl-texture2d: Unknown wrap mode "+e);this._wrapS=e[0],this._wrapT=e[1];var a=this.gl;return this.bind(),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,this._wrapS),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,this._wrapT),e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e))e=[0|e,0|e];else if(2!==e.length)throw new Error("gl-texture2d: Invalid texture shape");return o(this,0|e[0],0|e[1]),[0|e[0],0|e[1]]}},width:{get:function(){return this._shape[0]},set:function(e){return e|=0,o(this,e,this._shape[1]),e}},height:{get:function(){return this._shape[1]},set:function(e){return e|=0,o(this,this._shape[0],e),e}}}),b.bind=function(e){var t=this.gl;return void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(t.TEXTURE_2D,this.handle),void 0===e?t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0:0|e},b.dispose=function(){this.gl.deleteTexture(this.handle)},b.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var e=ea(this._shape[0],this._shape[1]),t=0;0<e;++t,e>>>=1)0>this._mipLevels.indexOf(t)&&this._mipLevels.push(t)},b.setPixels=function(e,t,a,o){var i=this.gl;this.bind(),Array.isArray(t)?(o=a,a=0|t[1],t=0|t[0]):(t=t||0,a=a||0),o=o||0;var n=r(e)?e:e.raw;if(n){var s=0>this._mipLevels.indexOf(o);s?(i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,n),this._mipLevels.push(o)):i.texSubImage2D(i.TEXTURE_2D,o,t,a,this.format,this.type,n)}else if(e.shape&&e.stride&&e.data){if(2>e.shape.length||t+e.shape[1]>this._shape[1]>>>o||a+e.shape[0]>this._shape[0]>>>o||0>t||0>a)throw new Error("gl-texture2d: Texture dimensions are out of bounds");l(i,t,a,o,this.format,this.type,this._mipLevels,e)}else throw new Error("gl-texture2d: Unsupported data type")}},{ndarray:450,"ndarray-ops":444,"typedarray-pool":545}],323:[function(e,t){(function(a){"use strict";function r(e){if(e.container)if(e.container==document.body)document.body.style.width||(e.canvas.width=e.width||e.pixelRatio*a.innerWidth),document.body.style.height||(e.canvas.height=e.height||e.pixelRatio*a.innerHeight);else{var t=e.container.getBoundingClientRect();e.canvas.width=e.width||t.right-t.left,e.canvas.height=e.height||t.bottom-t.top}}function i(t){return"function"==typeof t.getContext&&"width"in t&&"height"in t}function n(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function l(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function s(){var e=document.createElement("canvas");return e.style.position="absolute",e.style.top=0,e.style.left=0,e}var d=e("pick-by-alias");t.exports=function(t){if(t?"string"==typeof t&&(t={container:t}):t={},t=i(t)?{container:t}:n(t)?{container:t}:l(t)?{gl:t}:d(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=a.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if("string"==typeof t.container){var e=document.querySelector(t.container);if(!e)throw Error("Element "+t.container+" is not found");t.container=e}i(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):!t.canvas&&(t.canvas=s(),t.container.appendChild(t.canvas),r(t))}else if(!t.canvas)if("undefined"!=typeof document)t.container=document.body||document.documentElement,t.canvas=s(),t.container.appendChild(t.canvas),r(t);else throw Error("Not DOM environment. Use headless-gl.");if(!t.gl)try{t.gl=t.canvas.getContext("webgl",t.attrs)}catch(a){try{t.gl=t.canvas.getContext("experimental-webgl",t.attrs)}catch(a){t.gl=t.canvas.getContext("webgl-experimental",t.attrs)}}return t.gl}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"pick-by-alias":465}],324:[function(e,t){"use strict";t.exports=function(e,t,a){t?t.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var r=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(a){if(a.length>r)throw new Error("gl-vao: Too many vertex attributes");for(var o=0,n;o<a.length;++o)if(n=a[o],n.buffer){var l=n.buffer,s=n.size||4,d=n.type||e.FLOAT,c=!!n.normalized,p=n.stride||0,u=n.offset||0;l.bind(),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,s,d,c,p,u)}else{if("number"==typeof n)e.vertexAttrib1f(o,n);else if(1===n.length)e.vertexAttrib1f(o,n[0]);else if(2===n.length)e.vertexAttrib2f(o,n[0],n[1]);else if(3===n.length)e.vertexAttrib3f(o,n[0],n[1],n[2]);else if(4===n.length)e.vertexAttrib4f(o,n[0],n[1],n[2],n[3]);else throw new Error("gl-vao: Invalid vertex attribute");e.disableVertexAttribArray(o)}for(;o<r;++o)e.disableVertexAttribArray(o)}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var o=0;o<r;++o)e.disableVertexAttribArray(o)}}},{}],325:[function(e,t){"use strict";function a(e){this.gl=e,this._elements=null,this._attributes=null,this._elementsType=e.UNSIGNED_SHORT}var r=e("./do-bind.js");a.prototype.bind=function(){r(this.gl,this._elements,this._attributes)},a.prototype.update=function(e,t,a){this._elements=t,this._attributes=e,this._elementsType=a||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(e,t,a){a=a||0;var r=this.gl;this._elements?r.drawElements(e,t,this._elementsType,a):r.drawArrays(e,a,t)},t.exports=function(e){return new a(e)}},{"./do-bind.js":324}],326:[function(e,t){"use strict";function r(e,t,r,a,o,i){this.location=e,this.dimension=t,this.a=r,this.b=a,this.c=o,this.d=i}function o(e,t,a){this.gl=e,this._ext=t,this.handle=a,this._attribs=[],this._useElements=!1,this._elementsType=e.UNSIGNED_SHORT}var n=e("./do-bind.js");r.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);}},o.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e)this._attribs[e].bind(this.gl)},o.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},o.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},o.prototype.update=function(e,t,o){if(this.bind(),n(this.gl,t,e),this.unbind(),this._attribs.length=0,e)for(var l=0,s;l<e.length;++l)s=e[l],"number"==typeof s?this._attribs.push(new r(l,1,s)):Array.isArray(s)&&this._attribs.push(new r(l,s.length,s[0],s[1],s[2],s[3]));this._useElements=!!t,this._elementsType=o||this.gl.UNSIGNED_SHORT},o.prototype.draw=function(e,t,a){a=a||0;var r=this.gl;this._useElements?r.drawElements(e,t,this._elementsType,a):r.drawArrays(e,a,t)},t.exports=function(e,t){return new o(e,t,t.createVertexArrayOES())}},{"./do-bind.js":324}],327:[function(e,t){"use strict";function a(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e),this.createVertexArrayOES=e.createVertexArray.bind(e),this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}var r=e("./lib/vao-native.js"),o=e("./lib/vao-emulated.js");t.exports=function(e,t,i,n){var l=e.createVertexArray?new a(e):e.getExtension("OES_vertex_array_object"),s;return s=l?r(e,l):o(e),s.update(t,i,n),s}},{"./lib/vao-emulated.js":325,"./lib/vao-native.js":326}],328:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e}},{}],329:[function(e,t){t.exports=function(e,t){var a=r(e[0],e[1],e[2]),n=r(t[0],t[1],t[2]);o(a,a),o(n,n);var l=i(a,n);return 1<l?0:d(l)};var r=e("./fromValues"),o=e("./normalize"),i=e("./dot")},{"./dot":339,"./fromValues":345,"./normalize":356}],330:[function(e,t){t.exports=function(e,t){return e[0]=M(t[0]),e[1]=M(t[1]),e[2]=M(t[2]),e}},{}],331:[function(e,t){t.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],332:[function(e,t){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],333:[function(e,t){t.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],334:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2],n=a[0],l=a[1],s=a[2];return e[0]=o*s-i*l,e[1]=i*n-r*s,e[2]=r*l-o*n,e}},{}],335:[function(e,t){t.exports=e("./distance")},{"./distance":336}],336:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return N(a*a+r*r+o*o)}},{}],337:[function(e,t){t.exports=e("./divide")},{"./divide":338}],338:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e}},{}],339:[function(e,t){t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],340:[function(e,t){t.exports=1e-6},{}],341:[function(e,t){t.exports=function(e,t){var a=e[0],o=e[1],i=e[2],n=t[0],l=t[1],s=t[2];return _a(a-n)<=r*va(1,_a(a),_a(n))&&_a(o-l)<=r*va(1,_a(o),_a(l))&&_a(i-s)<=r*va(1,_a(i),_a(s))};var r=e("./epsilon")},{"./epsilon":340}],342:[function(e,t){t.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],343:[function(e,t){t.exports=function(e,t){return e[0]=ba(t[0]),e[1]=ba(t[1]),e[2]=ba(t[2]),e}},{}],344:[function(e,t){t.exports=function(e,t,a,o,n,s){var d,c;for(t||(t=3),a||(a=0),c=o?ea(o*t+a,e.length):e.length,d=a;d<c;d+=t)r[0]=e[d],r[1]=e[d+1],r[2]=e[d+2],n(r,r,s),e[d]=r[0],e[d+1]=r[1],e[d+2]=r[2];return e};var r=e("./create")()},{"./create":333}],345:[function(e,t){t.exports=function(e,t,a){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=a,r}},{}],346:[function(e,t){t.exports={EPSILON:e("./epsilon"),create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),equals:e("./equals"),exactEquals:e("./exactEquals"),add:e("./add"),subtract:e("./subtract"),sub:e("./sub"),multiply:e("./multiply"),mul:e("./mul"),divide:e("./divide"),div:e("./div"),min:e("./min"),max:e("./max"),floor:e("./floor"),ceil:e("./ceil"),round:e("./round"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),dist:e("./dist"),squaredDistance:e("./squaredDistance"),sqrDist:e("./sqrDist"),length:e("./length"),len:e("./len"),squaredLength:e("./squaredLength"),sqrLen:e("./sqrLen"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":328,"./angle":329,"./ceil":330,"./clone":331,"./copy":332,"./create":333,"./cross":334,"./dist":335,"./distance":336,"./div":337,"./divide":338,"./dot":339,"./epsilon":340,"./equals":341,"./exactEquals":342,"./floor":343,"./forEach":344,"./fromValues":345,"./inverse":347,"./len":348,"./length":349,"./lerp":350,"./max":351,"./min":352,"./mul":353,"./multiply":354,"./negate":355,"./normalize":356,"./random":357,"./rotateX":358,"./rotateY":359,"./rotateZ":360,"./round":361,"./scale":362,"./scaleAndAdd":363,"./set":364,"./sqrDist":365,"./sqrLen":366,"./squaredDistance":367,"./squaredLength":368,"./sub":369,"./subtract":370,"./transformMat3":371,"./transformMat4":372,"./transformQuat":373}],347:[function(e,t){t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],348:[function(e,t){t.exports=e("./length")},{"./length":349}],349:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],r=e[2];return N(t*t+a*a+r*r)}},{}],350:[function(e,t){t.exports=function(e,r,a,o){var t=r[0],i=r[1],n=r[2];return e[0]=t+o*(a[0]-t),e[1]=i+o*(a[1]-i),e[2]=n+o*(a[2]-n),e}},{}],351:[function(e,t){t.exports=function(e,t,a){return e[0]=va(t[0],a[0]),e[1]=va(t[1],a[1]),e[2]=va(t[2],a[2]),e}},{}],352:[function(e,t){t.exports=function(e,t,a){return e[0]=ea(t[0],a[0]),e[1]=ea(t[1],a[1]),e[2]=ea(t[2],a[2]),e}},{}],353:[function(e,t){t.exports=e("./multiply")},{"./multiply":354}],354:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e}},{}],355:[function(e,t){t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],356:[function(e,t){t.exports=function(e,t){var a=t[0],r=t[1],o=t[2],i=a*a+r*r+o*o;return 0<i&&(i=1/N(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i),e}},{}],357:[function(e,t){t.exports=function(e,t){t=t||1;var a=2*Math.random()*Pe,r=2*Math.random()-1,o=N(1-r*r)*t;return e[0]=R(a)*o,e[1]=De(a)*o,e[2]=r*t,e}},{}],358:[function(e,t){t.exports=function(e,t,a,r){var o=a[1],i=a[2],n=t[1]-o,l=t[2]-i,s=De(r),d=R(r);return e[0]=t[0],e[1]=o+n*d-l*s,e[2]=i+n*s+l*d,e}},{}],359:[function(e,t){t.exports=function(e,t,a,r){var o=a[0],i=a[2],n=t[0]-o,l=t[2]-i,s=De(r),d=R(r);return e[0]=o+l*s+n*d,e[1]=t[1],e[2]=i+l*d-n*s,e}},{}],360:[function(e,t){t.exports=function(e,t,a,r){var o=a[0],i=a[1],n=t[0]-o,l=t[1]-i,s=De(r),d=R(r);return e[0]=o+n*d-l*s,e[1]=i+n*s+l*d,e[2]=t[2],e}},{}],361:[function(e,t){t.exports=function(e,t){return e[0]=V(t[0]),e[1]=V(t[1]),e[2]=V(t[2]),e}},{}],362:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}},{}],363:[function(e,t){t.exports=function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e}},{}],364:[function(e,t){t.exports=function(e,t,a,r){return e[0]=t,e[1]=a,e[2]=r,e}},{}],365:[function(e,t){t.exports=e("./squaredDistance")},{"./squaredDistance":367}],366:[function(e,t){t.exports=e("./squaredLength")},{"./squaredLength":368}],367:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return a*a+r*r+o*o}},{}],368:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],r=e[2];return t*t+a*a+r*r}},{}],369:[function(e,t){t.exports=e("./subtract")},{"./subtract":370}],370:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e}},{}],371:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2];return e[0]=r*a[0]+o*a[3]+i*a[6],e[1]=r*a[1]+o*a[4]+i*a[7],e[2]=r*a[2]+o*a[5]+i*a[8],e}},{}],372:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2],n=a[3]*r+a[7]*o+a[11]*i+a[15];return n=n||1,e[0]=(a[0]*r+a[4]*o+a[8]*i+a[12])/n,e[1]=(a[1]*r+a[5]*o+a[9]*i+a[13])/n,e[2]=(a[2]*r+a[6]*o+a[10]*i+a[14])/n,e}},{}],373:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2],n=a[0],l=a[1],s=a[2],d=a[3],c=d*r+l*i-s*o,p=d*o+s*r-n*i,u=d*i+n*o-l*r,g=-n*r-l*o-s*i;return e[0]=c*d+g*-n+p*-s-u*-l,e[1]=p*d+g*-l+u*-n-c*-s,e[2]=u*d+g*-s+c*-l-p*-n,e}},{}],374:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e}},{}],375:[function(e,t){t.exports=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},{}],376:[function(e,t){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},{}],377:[function(e,t){t.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],378:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],i=t[3]-e[3];return N(a*a+r*r+o*o+i*i)}},{}],379:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e[3]=t[3]/a[3],e}},{}],380:[function(e,t){t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],381:[function(e,t){t.exports=function(e,t,a,r){var o=new Float32Array(4);return o[0]=e,o[1]=t,o[2]=a,o[3]=r,o}},{}],382:[function(e,t){t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformQuat:e("./transformQuat")}},{"./add":374,"./clone":375,"./copy":376,"./create":377,"./distance":378,"./divide":379,"./dot":380,"./fromValues":381,"./inverse":383,"./length":384,"./lerp":385,"./max":386,"./min":387,"./multiply":388,"./negate":389,"./normalize":390,"./random":391,"./scale":392,"./scaleAndAdd":393,"./set":394,"./squaredDistance":395,"./squaredLength":396,"./subtract":397,"./transformMat4":398,"./transformQuat":399}],383:[function(e,t){t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}},{}],384:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],r=e[2],o=e[3];return N(t*t+a*a+r*r+o*o)}},{}],385:[function(e,t){t.exports=function(e,r,a,o){var t=r[0],i=r[1],n=r[2],l=r[3];return e[0]=t+o*(a[0]-t),e[1]=i+o*(a[1]-i),e[2]=n+o*(a[2]-n),e[3]=l+o*(a[3]-l),e}},{}],386:[function(e,t){t.exports=function(e,t,a){return e[0]=va(t[0],a[0]),e[1]=va(t[1],a[1]),e[2]=va(t[2],a[2]),e[3]=va(t[3],a[3]),e}},{}],387:[function(e,t){t.exports=function(e,t,a){return e[0]=ea(t[0],a[0]),e[1]=ea(t[1],a[1]),e[2]=ea(t[2],a[2]),e[3]=ea(t[3],a[3]),e}},{}],388:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e[3]=t[3]*a[3],e}},{}],389:[function(e,t){t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}},{}],390:[function(e,t){t.exports=function(e,t){var a=t[0],r=t[1],o=t[2],i=t[3],n=a*a+r*r+o*o+i*i;return 0<n&&(n=1/N(n),e[0]=a*n,e[1]=r*n,e[2]=o*n,e[3]=i*n),e}},{}],391:[function(e,t){var a=e("./normalize"),r=e("./scale");t.exports=function(e,t){return t=t||1,e[0]=Math.random(),e[1]=Math.random(),e[2]=Math.random(),e[3]=Math.random(),a(e,e),r(e,e,t),e}},{"./normalize":390,"./scale":392}],392:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e}},{}],393:[function(e,t){t.exports=function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e}},{}],394:[function(e,t){t.exports=function(e,t,a,r,o){return e[0]=t,e[1]=a,e[2]=r,e[3]=o,e}},{}],395:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],i=t[3]-e[3];return a*a+r*r+o*o+i*i}},{}],396:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],r=e[2],o=e[3];return t*t+a*a+r*r+o*o}},{}],397:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e}},{}],398:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2],n=t[3];return e[0]=a[0]*r+a[4]*o+a[8]*i+a[12]*n,e[1]=a[1]*r+a[5]*o+a[9]*i+a[13]*n,e[2]=a[2]*r+a[6]*o+a[10]*i+a[14]*n,e[3]=a[3]*r+a[7]*o+a[11]*i+a[15]*n,e}},{}],399:[function(e,t){t.exports=function(e,t,a){var r=t[0],o=t[1],i=t[2],n=a[0],l=a[1],s=a[2],d=a[3],c=d*r+l*i-s*o,p=d*o+s*r-n*i,u=d*i+n*o-l*r,g=-n*r-l*o-s*i;return e[0]=c*d+g*-n+p*-s-u*-l,e[1]=p*d+g*-l+u*-n-c*-s,e[2]=u*d+g*-s+c*-l-p*-n,e[3]=t[3],e}},{}],400:[function(e,t){t.exports=function(e,t,o,i){return a[0]=i,a[1]=o,a[2]=t,a[3]=e,r[0]};var a=new Uint8Array(4),r=new Float32Array(a.buffer)},{}],401:[function(e,t){var a=e("glsl-tokenizer"),r=e("atob-lite");t.exports=function(e){for(var t=Array.isArray(e)?e:a(e),o=0,n;o<t.length;o++)if(n=t[o],"preprocessor"===n.type){var l=n.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(l&&l[2]){var s=l[1],d=l[2];return(s?r(d):d).trim()}}}},{"atob-lite":72,"glsl-tokenizer":408}],402:[function(e,t){t.exports=function(e){function t(e){e.length&&C.push({type:s[A],data:e,position:I,line:L,column:E})}function d(e){w=0,D+=e,M=D.length;for(var t;O=D[w],w<M;)if(t=w,0===A?w=y():1===A?w=m():2===A?w=h():3===A?w=f():4===A?w=b():11===A?w=_():5===A?w=v():9999===A?w=k():9===A?w=g():999===A?w=u():void 0,t!==w)switch(D[t]){case"\n":E=0,++L;break;default:++E;}return T+=w,D=D.slice(w),C}function p(){return S.length&&t(S.join("")),A=10,t("(eof)"),C}function u(){return(S=S.length?[]:S,"/"===R&&"*"===O)?(I=T+w-1,A=0,R=O,w+1):"/"===R&&"/"===O?(I=T+w-1,A=1,R=O,w+1):"#"===O?(A=2,I=T+w,w):/\s/.test(O)?(A=9,I=T+w,w):(z=/\d/.test(O),P=/[^\w_]/.test(O),I=T+w,A=z?4:P?3:9999,w)}function g(){return /[^\s]/g.test(O)?(t(S.join("")),A=999,w):(S.push(O),R=O,w+1)}function h(){return("\r"===O||"\n"===O)&&"\\"!==R?(t(S.join("")),A=999,w):(S.push(O),R=O,w+1)}function m(){return h()}function y(){return"/"===O&&"*"===R?(S.push(O),t(S.join("")),A=999,w+1):(S.push(O),R=O,w+1)}function f(){if("."===R&&/\d/.test(O))return A=5,w;if("/"===R&&"*"===O)return A=0,w;if("/"===R&&"/"===O)return A=1,w;if("."===O&&S.length){for(;x(S););return A=5,w}if(";"===O||")"===O||"("===O){if(S.length)for(;x(S););return t(O),A=999,w+1}var e=2===S.length&&"="!==O;if(/[\w_\d\s]/.test(O)||e){for(;x(S););return A=999,w}return S.push(O),R=O,w+1}function x(e){var a=0,o,i;do{if(o=r.indexOf(e.slice(0,e.length+a).join("")),i=r[o],-1===o){if(0<a--+e.length)continue;i=e.slice(0,1).join("")}return t(i),I+=i.length,S=S.slice(i.length),S.length}while(1)}function _(){return /[^a-fA-F0-9]/.test(O)?(t(S.join("")),A=999,w):(S.push(O),R=O,w+1)}function b(){return"."===O?(S.push(O),A=5,R=O,w+1):/[eE]/.test(O)?(S.push(O),A=5,R=O,w+1):"x"===O&&1===S.length&&"0"===S[0]?(A=11,S.push(O),R=O,w+1):/[^\d]/.test(O)?(t(S.join("")),A=999,w):(S.push(O),R=O,w+1)}function v(){return("f"===O&&(S.push(O),R=O,w+=1),/[eE]/.test(O))?(S.push(O),R=O,w+1):"-"===O&&/[eE]/.test(R)?(S.push(O),R=O,w+1):/[^\d]/.test(O)?(t(S.join("")),A=999,w):(S.push(O),R=O,w+1)}function k(){if(/[^\d\w_]/.test(O)){var e=S.join("");return A=-1<F.indexOf(e)?8:-1<j.indexOf(e)?7:6,t(S.join("")),A=999,w}return S.push(O),R=O,w+1}var w=0,T=0,A=999,S=[],C=[],L=1,E=0,I=0,z=!1,P=!1,D="",O,R,M;e=e||{};var j=o,F=a;return"300 es"===e.version&&(j=l,F=n),function(e){return C=[],null===e?p():d(e.replace?e.replace(/\r\n/g,"\n"):e)}};var a=e("./lib/literals"),r=e("./lib/operators"),o=e("./lib/builtins"),n=e("./lib/literals-300es"),l=e("./lib/builtins-300es"),s=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":404,"./lib/builtins-300es":403,"./lib/literals":406,"./lib/literals-300es":405,"./lib/operators":407}],403:[function(e,t){var a=e("./builtins");a=a.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),t.exports=a.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":404}],404:[function(e,t){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],405:[function(e,t){var a=e("./literals");t.exports=a.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":406}],406:[function(e,t){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],407:[function(e,t){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],408:[function(e,t){var a=e("./index");t.exports=function(e,t){var r=a(t),o=[];return o=o.concat(r(e)),o=o.concat(r(null)),o}},{"./index":402}],409:[function(e,t){t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),a=[],r=0;r<e.length-1;r++)a.push(e[r],t[r]||"");return a.push(e[r]),a.join("")}},{}],410:[function(e,t){(function(a){"use strict";var r=e("is-browser"),o;o="function"==typeof a.matchMedia?!a.matchMedia("(hover: none)").matches:r,t.exports=o}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"is-browser":417}],411:[function(e,t){"use strict";var a=e("is-browser");t.exports=a&&function(){var t=!1;try{var a=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,a),window.removeEventListener("test",null,a)}catch(a){t=!1}return t}()},{"is-browser":417}],412:[function(e,t,a){a.read=function(t,a,r,o,n){var l=8*n-o-1,c=(1<<l)-1,p=c>>1,u=-7,g=r?n-1:0,h=r?-1:1,d=t[a+g],y,f;for(g+=h,y=d&(1<<-u)-1,d>>=-u,u+=l;0<u;y=256*y+t[a+g],g+=h,u-=8);for(f=y&(1<<-u)-1,y>>=-u,u+=o;0<u;f=256*f+t[a+g],g+=h,u-=8);if(0===y)y=1-p;else{if(y===c)return f?NaN:(d?-1:1)*(1/0);f+=ya(2,o),y-=p}return(d?-1:1)*f*ya(2,y-o)},a.write=function(t,a,r,o,n,l){var p=8*l-n-1,u=(1<<p)-1,g=u>>1,h=23===n?ya(2,-24)-ya(2,-77):0,y=o?0:l-1,f=o?1:-1,d=0>a||0===a&&0>1/a?1:0,s,x,_;for(a=_a(a),isNaN(a)||a===1/0?(x=isNaN(a)?1:0,s=u):(s=ba(P(a)/E),1>a*(_=ya(2,-s))&&(s--,_*=2),a+=1<=s+g?h/_:h*ya(2,1-g),2<=a*_&&(s++,_/=2),s+g>=u?(x=0,s=u):1<=s+g?(x=(a*_-1)*ya(2,n),s+=g):(x=a*ya(2,g-1)*ya(2,n),s=0));8<=n;t[r+y]=255&x,y+=f,x/=256,n-=8);for(s=s<<n|x,p+=n;0<p;t[r+y]=255&s,y+=f,s/=256,p-=8);t[r+y-f]|=128*d}},{}],413:[function(e,t){"use strict";function a(e,t,a){this.vertices=e,this.adjacent=t,this.boundary=a,this.lastVisited=-1}function r(e,t,a){this.vertices=e,this.cell=t,this.index=a}function l(e,t){return u(e.vertices,t.vertices)}function s(e){for(var t=["function orient(){var tuple=this.tuple;return test("],a=0;a<=e;++a)0<a&&t.push(","),t.push("tuple[",a,"]");t.push(")}return orient");var r=new Function("test",t.join("")),o=p[e+1];return o||(o=p),r(o)}function c(e,t,a){this.dimension=e,this.vertices=t,this.simplices=a,this.interior=a.filter(function(e){return!e.boundary}),this.tuple=Array(e+1);for(var r=0;r<=e;++r)this.tuple[r]=this.vertices[r];var n=g[e];n||(n=g[e]=s(e)),this.orient=n}t.exports=function(e,r){var l=e.length;if(0===l)throw new Error("Must have at least d+1 points");var n=e[0].length;if(l<=n)throw new Error("Must input at least d+1 points");var s=e.slice(0,n+1),d=p.apply(void 0,s);if(0===d)throw new Error("Input not in general position");for(var o=Array(n+1),u=0;u<=n;++u)o[u]=u;0>d&&(o[0]=1,o[1]=0);for(var g=new a(o,Array(n+1),!1),h=g.adjacent,m=Array(n+2),u=0,y;u<=n;++u){y=o.slice();for(var f=0;f<=n;++f)f==u&&(y[f]=-1);var x=y[0];y[0]=y[1],y[1]=x;var t=new a(y,Array(n+1),!0);h[u]=t,m[u]=t}m[n+1]=g;for(var u=0;u<=n;++u)for(var y=h[u].vertices,_=h[u].adjacent,f=0,b;f<=n;++f){if(b=y[f],0>b){_[f]=g;continue}for(var w=0;w<=n;++w)0>h[w].vertices.indexOf(b)&&(_[f]=h[w])}for(var T=new c(n,s,m),u=n+1;u<l;++u)T.insert(e[u],!!r);return T.boundary()};var p=e("robust-orientation"),u=e("simplicial-complex").compareCells;a.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=t};var g=[],h=c.prototype;h.handleBoundaryDegeneracy=function(e,t){var a=this.dimension,r=this.vertices.length-1,n=this.tuple,l=this.vertices,s=[e];for(e.lastVisited=-r;0<s.length;){e=s.pop();for(var d=e.vertices,c=e.adjacent,p=0,u;p<=a;++p)if(u=c[p],u.boundary&&!(u.lastVisited<=-r)){for(var g=u.vertices,h=0,m;h<=a;++h)m=g[h],n[h]=0>m?t:l[m];var y=this.orient();if(0<y)return u;u.lastVisited=-r,0===y&&s.push(u)}}return null},h.walk=function(e,t){var a=this.vertices.length-1,r=this.dimension,n=this.vertices,l=this.tuple,s=t?0|this.interior.length*Math.random():this.interior.length-1,d=this.interior[s];outerLoop:for(;!d.boundary;){for(var c=d.vertices,p=d.adjacent,u=0;u<=r;++u)l[u]=n[c[u]];d.lastVisited=a;for(var u=0,g;u<=r;++u)if(g=p[u],!(g.lastVisited>=a)){var h=l[u];l[u]=e;var m=this.orient();if(l[u]=h,0>m){d=g;continue outerLoop}else g.lastVisited=g.boundary?-a:a}return}return d},h.addPeaks=function(e,t){var s=this.vertices.length-1,n=this.dimension,d=this.vertices,c=this.tuple,p=this.interior,u=this.simplices,g=[t];t.lastVisited=s,t.vertices[t.vertices.indexOf(-1)]=s,t.boundary=!1,p.push(t);for(var h=[];0<g.length;){var t=g.pop(),m=t.vertices,y=t.adjacent,f=m.indexOf(s);if(!(0>f))for(var x=0;x<=n;++x)if(x!==f){var _=y[x];if(_.boundary&&!(_.lastVisited>=s)){var v=_.vertices;if(_.lastVisited!==-s){for(var w=0,T=0;T<=n;++T)0>v[T]?(w=T,c[T]=e):c[T]=d[v[T]];var A=this.orient();if(0<A){v[w]=s,_.boundary=!1,p.push(_),g.push(_),_.lastVisited=s;continue}else _.lastVisited=-s}var o=_.adjacent,S=m.slice(),C=y.slice(),L=new a(S,C,!0);u.push(L);var E=o.indexOf(t);if(!(0>E)){o[E]=L,C[f]=_,S[x]=-1,C[x]=t,y[x]=L,L.flip();for(var T=0,I;T<=n;++T)if(I=S[T],!(0>I||I===s)){for(var z=Array(n-1),P=0,D=0,O;D<=n;++D)(O=S[D],!(0>O||D==T))&&(z[P++]=O);h.push(new r(z,L,T))}}}}}h.sort(l);for(var x=0;x+1<h.length;x+=2){var R=h[x],M=h[x+1],b=R.index,F=M.index;0>b||0>F||(R.cell.adjacent[R.index]=M.cell,M.cell.adjacent[M.index]=R.cell)}},h.insert=function(e,t){var a=this.vertices;a.push(e);var r=this.walk(e,t);if(r){for(var n=this.dimension,l=this.tuple,s=0,d;s<=n;++s)d=r.vertices[s],l[s]=0>d?e:a[d];var c=this.orient(l);0>c||0===c&&(r=this.handleBoundaryDegeneracy(r,e),!r)||this.addPeaks(e,r)}},h.boundary=function(){for(var e=this.dimension,a=[],r=this.simplices,o=r.length,n=0,l;n<o;++n)if(l=r[n],l.boundary){for(var s=Array(e),d=l.vertices,p=0,u=0,g=0;g<=e;++g)0<=d[g]?s[p++]=d[g]:u=1&g;if(u===(1&e)){var h=s[0];s[0]=s[1],s[1]=h}a.push(s)}return a}},{"robust-orientation":510,"simplicial-complex":520}],414:[function(e,t){"use strict";function a(e,t,a,r,o){this.mid=e,this.left=t,this.right=a,this.leftPoints=r,this.rightPoints=o,this.count=(t?t.count:0)+(a?a.count:0)+r.length}function o(e,t){e.mid=t.mid,e.left=t.left,e.right=t.right,e.leftPoints=t.leftPoints,e.rightPoints=t.rightPoints,e.count=t.count}function i(e,t){var a=h(t);e.mid=a.mid,e.left=a.left,e.right=a.right,e.leftPoints=a.leftPoints,e.rightPoints=a.rightPoints,e.count=a.count}function n(e,t){var a=e.intervals([]);a.push(t),i(e,a)}function l(e,t){var a=e.intervals([]),r=a.indexOf(t);return 0>r?0:(a.splice(r,1),i(e,a),1)}function s(e,t,a){for(var o=0,n;o<e.length&&e[o][0]<=t;++o)if(n=a(e[o]),n)return n}function d(e,t,a){for(var o=e.length-1,n;0<=o&&e[o][1]>=t;--o)if(n=a(e[o]),n)return n}function c(e,t){for(var a=0,o;a<e.length;++a)if(o=t(e[a]),o)return o}function p(e,t){return e-t}function u(e,t){var a=e[0]-t[0];return a?a:e[1]-t[1]}function g(e,t){var a=e[1]-t[1];return a?a:e[0]-t[0]}function h(e){if(0===e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e[r][0],e[r][1]);t.sort(p);for(var o=t[t.length>>1],n=[],l=[],d=[],r=0,c;r<e.length;++r)c=e[r],c[1]<o?n.push(c):o<c[0]?l.push(c):d.push(c);var m=d,y=d.slice();return m.sort(u),y.sort(g),new a(o,h(n),h(l),m,y)}function m(e){this.root=e}var y=e("binary-search-bounds"),f=0,x=1,_=2;t.exports=function(e){return e&&0!==e.length?new m(h(e)):new m(null)};var b=a.prototype;b.intervals=function(e){return e.push.apply(e,this.leftPoints),this.left&&this.left.intervals(e),this.right&&this.right.intervals(e),e},b.insert=function(e){var t=this.count-this.leftPoints.length;if(this.count+=1,e[1]<this.mid)this.left?4*(this.left.count+1)>3*(t+1)?n(this,e):this.left.insert(e):this.left=h([e]);else if(e[0]>this.mid)this.right?4*(this.right.count+1)>3*(t+1)?n(this,e):this.right.insert(e):this.right=h([e]);else{var a=y.ge(this.leftPoints,e,u),o=y.ge(this.rightPoints,e,g);this.leftPoints.splice(a,0,e),this.rightPoints.splice(o,0,e)}},b.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left)return f;var a=this.right?this.right.count:0;if(4*a>3*(t-1))return l(this,e);var i=this.left.remove(e);return i===_?(this.left=null,this.count-=1,x):(i===x&&(this.count-=1),i)}if(e[0]>this.mid){if(!this.right)return f;var s=this.left?this.left.count:0;if(4*s>3*(t-1))return l(this,e);var i=this.right.remove(e);return i===_?(this.right=null,this.count-=1,x):(i===x&&(this.count-=1),i)}if(1===this.count)return this.leftPoints[0]===e?_:f;if(1===this.leftPoints.length&&this.leftPoints[0]===e){if(this.left&&this.right){for(var d=this,c=this.left;c.right;)d=c,c=c.right;if(d===this)c.right=this.right;else{var h=this.left,i=this.right;d.count-=c.count,d.right=c.left,c.left=h,c.right=i}o(this,c),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return x}for(var h=y.ge(this.leftPoints,e,u);h<this.leftPoints.length&&this.leftPoints[h][0]===e[0];++h)if(this.leftPoints[h]===e){this.count-=1,this.leftPoints.splice(h,1);for(var i=y.ge(this.rightPoints,e,g);i<this.rightPoints.length&&this.rightPoints[i][1]===e[1];++i)if(this.rightPoints[i]===e)return this.rightPoints.splice(i,1),x}return f},b.queryPoint=function(e,t){if(e<this.mid){if(this.left){var a=this.left.queryPoint(e,t);if(a)return a}return s(this.leftPoints,e,t)}if(e>this.mid){if(this.right){var a=this.right.queryPoint(e,t);if(a)return a}return d(this.rightPoints,e,t)}return c(this.leftPoints,t)},b.queryInterval=function(e,t,a){if(e<this.mid&&this.left){var o=this.left.queryInterval(e,t,a);if(o)return o}if(t>this.mid&&this.right){var o=this.right.queryInterval(e,t,a);if(o)return o}return t<this.mid?s(this.leftPoints,t,a):e>this.mid?d(this.rightPoints,e,a):c(this.leftPoints,a)};var v=m.prototype;v.insert=function(e){this.root?this.root.insert(e):this.root=new a(e[0],null,null,[e],[e])},v.remove=function(e){if(this.root){var t=this.root.remove(e);return t===_&&(this.root=null),t!==f}return!1},v.queryPoint=function(e,t){if(this.root)return this.root.queryPoint(e,t)},v.queryInterval=function(e,t,a){if(e<=t&&this.root)return this.root.queryInterval(e,t,a)},Object.defineProperty(v,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(v,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":91}],415:[function(e,t){"use strict";t.exports=function(e,t){t=t||Array(e.length);for(var a=0;a<e.length;++a)t[e[a]]=a;return t}},{}],416:[function(e,t){"use strict";t.exports=function(e){for(var t=Array(e),a=0;a<e;++a)t[a]=a;return t}},{}],417:[function(e,t){t.exports=!0},{}],418:[function(e,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function r(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */t.exports=function(e){return null!=e&&(a(e)||r(e)||!!e._isBuffer)}},{}],419:[function(e,t){"use strict";t.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],420:[function(e,t){"use strict";function a(e){e||(e={});var t=e.ua;return t||"undefined"==typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"==typeof t&&(e.tablet?o.test(t):r.test(t))}t.exports=a,t.exports.isMobile=a,t.exports.default=a;var r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i},{}],421:[function(e,t){"use strict";t.exports=function(e){var t=typeof e;return null!==e&&("object"==t||"function"==t)}},{}],422:[function(e,t){"use strict";var a=Object.prototype.toString;t.exports=function(e){var t;return"[object Object]"===a.call(e)&&(t=Object.getPrototypeOf(e),null===t||t===Object.getPrototypeOf({}))}},{}],423:[function(e,t){"use strict";t.exports=function(e){for(var t=e.length,r=0,o;r<t;r++)if(o=e.charCodeAt(r),(9>o||13<o)&&32!==o&&133!==o&&160!==o&&5760!==o&&6158!==o&&(8192>o||8205<o)&&8232!==o&&8233!==o&&8239!==o&&8287!==o&&8288!==o&&12288!==o&&65279!==o)return!1;return!0}},{}],424:[function(e,t){"use strict";t.exports=function(e){return!("string"!=typeof e)&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&4<e.length))}},{}],425:[function(e,t){t.exports=function(e,a,r){return e*(1-r)+a*r}},{}],426:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?t.exports=r():"function"==typeof ka&&ka.amd?ka(r):(e=e||self,e.mapboxgl=r())})(this,function(){"use strict";function e(e,o){if(!t)t=o;else if(!a)a=o;else{var i="var sharedChunk = {}; ("+t+")(sharedChunk); ("+a+")(sharedChunk);",n={};t(n),r=o(n),r.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"}))}}var t,a,r;return e(["exports"],function(j){function t(a,t){return a(t={exports:{}},t.exports),t.exports}function e(a,t,e,r){this.cx=3*a,this.bx=3*(e-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=r,this.p2x=e,this.p2y=r}function n(a,t){this.x=a,this.y=t}function Re(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(var e=0;e<a.length;e++)if(!Re(a[e],t[e]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(a).length!==Object.keys(t).length)return!1;for(var o in a)if(!Re(a[o],t[o]))return!1;return!0}return a===t}function a(r,t,e,o){var i=new Zl(r,t,e,o);return function(e){return i.solve(e)}}function Ue(a,t,e){return ea(e,va(t,a))}function l(a,t,e){var r=e-t,o=((a-t)%r+r)%r+t;return o===t?e:o}function dt(l){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];for(var s=0,d=t,i;s<d.length;s+=1)for(var c in i=d[s],i)l[c]=i[c];return l}function s(){return i++}function p(){return function a(t){return t?(t^16*Math.random()>>t/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a)}()}function y(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function f(a,r){a.forEach(function(e){r[e]&&(r[e]=r[e].bind(r))})}function ht(a,t){return-1!==a.indexOf(t,a.length-t.length)}function v(a,t,e){var r={};for(var o in a)r[o]=t.call(e||this,a[o],o,a);return r}function g(a,t,e){var r={};for(var o in a)t.call(e||this,a[o],o,a)&&(r[o]=a[o]);return r}function x(e){return Array.isArray(e)?e.map(x):"object"==typeof e&&e?v(e,x):e}function Fa(e){u[e]||("undefined"!=typeof console&&console.warn(e),u[e]=!0)}function b(a,t,e){return(e.y-a.y)*(t.x-a.x)>(t.y-a.y)*(e.x-a.x)}function w(l){for(var t=0,s=0,d=l.length,n=d-1,c=void 0,p=void 0;s<d;n=s++)c=l[s],t+=((p=l[n]).x-c.x)*(c.y+p.y);return t}function A(a){var o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(e,t,r,n){var i=r||n;return o[t]=!i||i.toLowerCase(),""}),o["max-age"]){var e=parseInt(o["max-age"],10);isNaN(e)?delete o["max-age"]:o["max-age"]=e}return o}function k(a){try{var t=self[a];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function S(a){var t=a.createTexture();a.bindTexture(a.TEXTURE_2D,t);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,bd),a.isContextLost())return;yd.supported=!0}catch(e){}a.deleteTexture(t),F=!0}function z(a,t){var o=K(md.API_URL);if(a.protocol=o.protocol,a.authority=o.authority,"/"!==o.path&&(a.path=""+o.path+a.path),!md.REQUIRE_ACCESS_TOKEN)return rt(a);if(!(t=t||md.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes");if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes");return a.params.push("access_token="+t),rt(a)}function O(e){return 0===e.indexOf("mapbox:")}function q(e){return U.test(e)}function K(a){var t=a.match(tt);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function rt(a){var t=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+t}function nt(a){if(!a)return null;var t=a.split("."),r;if(!t||3!==t.length)return null;try{return JSON.parse((r=t[1],decodeURIComponent(self.atob(r).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(e){return null}}function it(a,t,e){if(self.caches){var o={status:t.status,statusText:t.statusText,headers:new self.Headers};t.headers.forEach(function(a,t){return o.headers.set(t,a)});var r=A(t.headers.get("Cache-Control")||"");r["no-store"]||(r["max-age"]&&o.headers.set("Expires",new Date(e+1e3*r["max-age"]).toUTCString()),420000>new Date(o.headers.get("Expires")).getTime()-e||function(a,t){if(void 0===bt)try{new Response(new ReadableStream()),bt=!0}catch(e){bt=!1}bt?t(a.body):a.blob().then(t)}(t,function(t){var i=new self.Response(t,o);self.caches.open("mapbox-tiles").then(function(t){return t.put(mt(a.url),i)})}))}}function mt(a){var t=a.indexOf("?");return 0>t?a:a.slice(0,t)}function vt(a,o){if(!self.caches)return o(null);var e=mt(a.url);self.caches.open("mapbox-tiles").catch(o).then(function(a){a.match(e).catch(o).then(function(t){var r=function(a){if(!a)return!1;var t=new Date(a.headers.get("Expires")),e=A(a.headers.get("Cache-Control")||"");return t>Date.now()&&!e["no-cache"]}(t);a.delete(e),r&&a.put(e,t.clone()),o(null,t,r)})})}function gt(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function wt(d,c){var e=new self.AbortController,p=new self.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:_t(),signal:e.signal}),i=!1,g=!1,t=0<(n=p.url).indexOf("sku=")&&q(n),n;"json"===d.type&&p.headers.set("Accept","application/json");var s=function(e,r,o){if(!g){if(e&&"SecurityError"!==e.message&&Fa(e),r&&o)return h(r);var a=Date.now();self.fetch(p).then(function(e){if(e.ok){var r=t?e.clone():null;return h(e,r,a)}return c(new Ad(e.statusText,e.status,d.url))}).catch(function(e){20!==e.code&&c(new Error(e.message))})}},h=function(e,a,r){("arrayBuffer"===d.type?e.arrayBuffer():"json"===d.type?e.json():e.text()).then(function(o){g||(a&&r&&it(p,a,r),i=!0,c(null,o,e.headers.get("Cache-Control"),e.headers.get("Expires")))}).catch(function(e){return c(new Error(e.message))})};return t?vt(p,s):s(null,null),{cancel:function(){g=!0,i||e.abort()}}}function St(a,t,e){e[a]&&-1!==e[a].indexOf(t)||(e[a]=e[a]||[],e[a].push(t))}function Mt(a,t,e){if(e&&e[a]){var r=e[a].indexOf(t);-1!==r&&e[a].splice(r,1)}}function Tt(a){var t=a.key,e=a.value;return e?[new Lt(t,e,"constants have been deprecated as of v8")]:[]}function Ot(l){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];for(var s=0,d=t,i;s<d.length;s+=1)for(var c in i=d[s],i)l[c]=i[c];return l}function Rt(e){return e instanceof Number||e instanceof String||e instanceof Boolean}function Ut(e){return Rt(e)?e.valueOf():e}function jt(a){if(Array.isArray(a))return a.map(jt);if(a instanceof Object&&!Rt(a)){var t={};for(var e in a)t[e]=jt(a[e]);return t}return Ut(a)}function qt(a,t){return{kind:"array",itemType:a,N:t}}function te(a){if("array"===a.kind){var t=te(a.itemType);return"number"==typeof a.N?"array<"+t+", "+a.N+">":"value"===a.itemType.kind?"array":"array<"+t+">"}return a.kind}function ee(a,t){if("error"===t.kind)return null;if("array"!==a.kind){if(a.kind===t.kind)return null;if("value"===a.kind)for(var e=0,o=Qt;e<o.length;e+=1)if(!ee(o[e],t))return null}else if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!ee(a.itemType,t.itemType))&&("number"!=typeof a.N||a.N===t.N))return null;return"Expected "+te(a)+" but found "+te(t)+" instead."}function ne(a,t,e,r){return"number"==typeof a&&0<=a&&255>=a&&"number"==typeof t&&0<=t&&255>=t&&"number"==typeof e&&0<=e&&255>=e?void 0===r||"number"==typeof r&&0<=r&&1>=r?null:"Invalid rgba value ["+[a,t,e,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[a,t,e,r]:[a,t,e]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function le(o){if(null===o)return Zt;if("string"==typeof o)return Gt;if("boolean"==typeof o)return Xt;if("number"==typeof o)return Kt;if(o instanceof ie)return Jt;if(o instanceof ae)return $t;if(o instanceof se)return Wt;if(Array.isArray(o)){for(var t=o.length,r=0,l=o,i,s;r<l.length;r+=1){if(s=le(l[r]),i){if(i===s)continue;i=Yt;break}i=s}return qt(i||Yt,t)}return Ht}function pe(a){var t=typeof a;return null===a?"":"string"==t||"number"==t||"boolean"==t?a+"":a instanceof ie||a instanceof se?a.toString():JSON.stringify(a)}function ce(a){if(a instanceof be){if("get"===a.name&&1===a.args.length)return!1;if("feature-state"===a.name)return!1;if("has"===a.name&&1===a.args.length)return!1;if("properties"===a.name||"geometry-type"===a.name||"id"===a.name)return!1;if(/^filter-/.test(a.name))return!1}var r=!0;return a.eachChild(function(e){r&&!ce(e)&&(r=!1)}),r}function Ae(a){if(a instanceof be&&"feature-state"===a.name)return!1;var r=!0;return a.eachChild(function(e){r&&!Ae(e)&&(r=!1)}),r}function Se(a,o){if(a instanceof be&&0<=o.indexOf(a.name))return!1;var e=!0;return a.eachChild(function(a){e&&!Se(a,o)&&(e=!1)}),e}function ke(l,t){for(var e=l.length-1,i=0,d=e,c=0,p,u;i<=d;)if(p=l[c=ba((i+d)/2)],u=l[c+1],p<=t){if(c===e||t<u)return c;i=c+1}else{if(!(p>t))throw new he("Input is not a number.");d=c-1}return 0}function Be(a,t,e){return a*(1-e)+t*e}function Ee(e){return e>Ld?ya(e,1/3):e/Le+Ve}function je(e){return e>Fe?e*e*e:Le*(e-Ve)}function qe(e){return 255*(.0031308>=e?12.92*e:1.055*ya(e,1/2.4)-.055)}function Ne(e){return .04045>=(e/=255)?e/12.92:ya((e+.055)/1.055,2.4)}function Ze(o){var t=Ne(o.r),e=Ne(o.g),r=Ne(o.b),n=Ee((.4124564*t+.3575761*e+.1804375*r)/Me),i=Ee((.2126729*t+.7151522*e+.072175*r)/1);return{l:116*i-16,a:500*(n-i),b:200*(i-Ee((.0193339*t+.119192*e+.9503041*r)/Te)),alpha:o.a}}function Ke(a){var t=(a.l+16)/116,o=isNaN(a.a)?t:t+a.a/500,i=isNaN(a.b)?t:t-a.b/200;return t=1*je(t),o=Me*je(o),i=Te*je(i),new ie(qe(3.2404542*o-1.5371385*t-.4985314*i),qe(-.969266*o+1.8760108*t+.041556*i),qe(.0556434*o-.2040259*t+1.0572252*i),a.alpha)}function Ge(a,t,e){var r=t-a;return a+e*(180<r||-180>r?r-360*V(r/360):r)}function Xe(o,t,e,r){var n=r-e,i=o-e;return 0==n?0:1===t?i/n:(ya(t,i)-1)/(ya(t,n)-1)}function We(a,t){return"=="===a||"!="===a?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Ua(a,t,e,r){return 0===r.compare(t,e)}function qa(i,t,e){var d="=="!==i&&"!="!==i;return function(){function n(a,t,e){this.type=Xt,this.lhs=a,this.rhs=t,this.collator=e,this.hasUntypedArgument="value"===a.type.kind||"value"===t.type.kind}return n.parse=function(i,t){if(3!==i.length&&4!==i.length)return t.error("Expected two or three arguments.");var e=i[0],r=t.parse(i[1],1,Yt);if(!r)return null;if(!We(e,r.type))return t.concat(1).error("\""+e+"\" comparisons are not supported for type '"+te(r.type)+"'.");var l=t.parse(i[2],2,Yt);if(!l)return null;if(!We(e,l.type))return t.concat(2).error("\""+e+"\" comparisons are not supported for type '"+te(l.type)+"'.");if(r.type.kind!==l.type.kind&&"value"!==r.type.kind&&"value"!==l.type.kind)return t.error("Cannot compare types '"+te(r.type)+"' and '"+te(l.type)+"'.");d&&("value"===r.type.kind&&"value"!==l.type.kind?r=new ye(l.type,[r]):"value"!==r.type.kind&&"value"===l.type.kind&&(l=new ye(r.type,[l])));var c=null;if(4===i.length){if("string"!==r.type.kind&&"string"!==l.type.kind&&"value"!==r.type.kind&&"value"!==l.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(c=t.parse(i[3],3,$t)))return null}return new n(r,l,c)},n.prototype.evaluate=function(r){var n=this.lhs.evaluate(r),a=this.rhs.evaluate(r);if(d&&this.hasUntypedArgument){var o=le(n),s=le(a);if(o.kind!==s.kind||"string"!==o.kind&&"number"!==o.kind)throw new he("Expected arguments for \""+i+"\" to be (string, string) or (number, number), but found ("+o.kind+", "+s.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){var c=le(n),l=le(a);if("string"!==c.kind||"string"!==l.kind)return t(r,n,a)}return this.collator?e(r,n,a,this.collator.evaluate(r)):t(r,n,a)},n.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},n.prototype.possibleOutputs=function(){return[!0,!1]},n.prototype.serialize=function(){var a=[i];return this.eachChild(function(e){a.push(e.serialize())}),a},n}()}function Wa(l,t){var e=t[0],d=t[1],c=t[2],p=t[3];e=e.evaluate(l),d=d.evaluate(l),c=c.evaluate(l);var a=p?p.evaluate(l):1,o=ne(e,d,c,a);if(o)throw new he(o);return new ie(e/255*a,d/255*a,c/255*a,a)}function Ka(a,t){return a in t}function ar(a,t){var e=t[a];return void 0===e?null:e}function or(e){return{type:e}}function ir(e){return{result:"success",value:e}}function gr(e){return{result:"error",value:e}}function mr(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function xr(e){return!!e.expression&&-1<e.expression.parameters.indexOf("zoom")}function _r(e){return!!e.expression&&e.expression.interpolated}function br(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function vr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function kr(e){return e}function wr(a,t,e){return void 0===a?void 0===t?void 0===e?void 0:e:t:a}function Ar(a,t,e,r,o){return wr(typeof e===o?r[e]:void 0,a.default,t.default)}function Sr(a,t,e){if("number"!==br(e))return wr(a.default,t.default);var r=a.stops.length;if(1===r)return a.stops[0][1];if(e<=a.stops[0][0])return a.stops[0][1];if(e>=a.stops[r-1][0])return a.stops[r-1][1];var o=ke(a.stops.map(function(e){return e[0]}),e);return a.stops[o][1]}function Cr(d,t,e){var r=void 0===d.base?1:d.base;if("number"!==br(e))return wr(d.default,t.default);var n=d.stops.length;if(1===n)return d.stops[0][1];if(e<=d.stops[0][0])return d.stops[0][1];if(e>=d.stops[n-1][0])return d.stops[n-1][1];var i=ke(d.stops.map(function(e){return e[0]}),e),a=function(o,t,e,r){var n=r-e,i=o-e;return 0==n?0:1===t?i/n:(ya(t,i)-1)/(ya(t,n)-1)}(e,r,d.stops[i][0],d.stops[i+1][0]),o=d.stops[i][1],s=d.stops[i+1][1],c=Ce[t.type]||kr;if(d.colorSpace&&"rgb"!==d.colorSpace){var u=He[d.colorSpace];c=function(r,t){return u.reverse(u.interpolate(u.forward(r),u.forward(t),a))}}return"function"==typeof o.evaluate?{evaluate:function(){for(var i=[],t=arguments.length;t--;)i[t]=arguments[t];var l=o.evaluate.apply(void 0,i),r=s.evaluate.apply(void 0,i);if(void 0!==l&&void 0!==r)return c(l,r,a)}}:c(o,s,a)}function Er(a,t,e){return"color"===t.type?e=ie.parse(e):"formatted"===t.type?e=se.fromString(e.toString()):br(e)===t.type||"enum"===t.type&&t.values[e]||(e=void 0),wr(e,a.default,t.default)}function Tr(e){return Array.isArray(e)&&0<e.length&&"string"==typeof e[0]&&e[0]in yr}function Ir(a,t){var e=new ze(yr,[],t?function(a){var t={color:Jt,string:Gt,number:Kt,enum:Gt,boolean:Xt,formatted:Wt};return"array"===a.type?qt(t[a.value]||Yt,a.length):t[a.type]}(t):void 0),r=e.parse(a,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return r?ir(new dr(r,t)):gr(e.errors)}function zr(o,l){if("error"===(o=Ir(o,l)).result)return o;var e=o.value.expression,r=ce(e);if(!r&&!mr(l))return gr([new Dt("","data expressions not supported")]);var n=Se(e,["zoom"]);if(!n&&!xr(l))return gr([new Dt("","zoom expressions not supported")]);var i=function o(t){var l=null;if(t instanceof Qe)l=o(t.result);else if(t instanceof $e)for(var e=0,s=t.args,i;e<s.length&&(i=s[e],!(l=o(i)));e+=1);else(t instanceof Ie||t instanceof Ye)&&t.input instanceof be&&"zoom"===t.input.name&&(l=t);return l instanceof Dt?l:(t.eachChild(function(t){var e=o(t);e instanceof Dt?l=e:!l&&e?l=new Dt("","\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression."):l&&e&&l!==e&&(l=new Dt("","Only one zoom-based \"step\" or \"interpolate\" subexpression may be used in an expression."))}),l)}(e);return i||n?i instanceof Dt?gr([i]):i instanceof Ye&&!_r(l)?gr([new Dt("","\"interpolate\" expressions cannot be used with this property")]):ir(i?new Lr(r?"camera":"composite",o.value,i):new Pr(r?"constant":"source",o.value)):gr([new Dt("","\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.")])}function Or(d){var t=d.key,e=d.value,r=d.valueSpec||{},n=d.objectElementValidators||{},i=d.style,a=d.styleSpec,o=[],g=br(e);if("object"!==g)return[new Lt(t,e,"object expected, "+g+" found")];for(var u in e){var l=u.split(".")[0],p=r[l]||r["*"],c=void 0;if(n[l])c=n[l];else if(r[l])c=rn;else if(n["*"])c=n["*"];else{if(!r["*"]){o.push(new Lt(t,e[u],"unknown property \""+u+"\""));continue}c=rn}o=o.concat(c({key:(t?t+".":t)+u,value:e[u],valueSpec:p,style:i,styleSpec:a,object:e,objectKey:u},e))}for(var m in r)n[m]||r[m].required&&void 0===r[m].default&&void 0===e[m]&&o.push(new Lt(t,e,"missing required property \""+m+"\""));return o}function Mr(d){var t=d.value,e=d.valueSpec,r=d.style,n=d.styleSpec,i=d.key,a=d.arrayElementValidator||rn;if("array"!==br(t))return[new Lt(i,t,"array expected, "+br(t)+" found")];if(e.length&&t.length!==e.length)return[new Lt(i,t,"array length "+e.length+" expected, length "+t.length+" found")];if(e["min-length"]&&t.length<e["min-length"])return[new Lt(i,t,"array length at least "+e["min-length"]+" expected, length "+t.length+" found")];var o={type:e.value,values:e.values};7>n.$version&&(o.function=e.function),"object"===br(e.value)&&(o=e.value);for(var c=[],p=0;p<t.length;p++)c=c.concat(a({array:t,arrayIndex:p,value:t[p],valueSpec:o,style:r,styleSpec:n,key:i+"["+p+"]"}));return c}function jr(a){var t=a.key,e=a.value,r=a.valueSpec,o=br(e);return"number"===o?"minimum"in r&&e<r.minimum?[new Lt(t,e,e+" is less than the minimum value "+r.minimum)]:"maximum"in r&&e>r.maximum?[new Lt(t,e,e+" is greater than the maximum value "+r.maximum)]:[]:[new Lt(t,e,"number expected, "+o+" found")]}function Fr(d){function u(r){var t=[],o=r.value,a=r.key;if("array"!==br(o))return[new Lt(a,o,"array expected, "+br(o)+" found")];if(2!==o.length)return[new Lt(a,o,"array length 2 expected, length "+o.length+" found")];if(m){if("object"!==br(o[0]))return[new Lt(a,o,"object expected, "+br(o[0])+" found")];if(void 0===o[0].zoom)return[new Lt(a,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new Lt(a,o,"object stop key must have value")];if(l&&l>Ut(o[0].zoom))return[new Lt(a,o[0].zoom,"stop zoom values must appear in ascending order")];Ut(o[0].zoom)!==l&&(l=Ut(o[0].zoom),f=void 0,h={}),t=t.concat(Or({key:a+"[0]",value:o[0],valueSpec:{zoom:{}},style:r.style,styleSpec:r.styleSpec,objectElementValidators:{zoom:jr,value:c}}))}else t=t.concat(c({key:a+"[0]",value:o[0],valueSpec:{},style:r.style,styleSpec:r.styleSpec},o));return Tr(jt(o[1]))?t.concat([new Lt(a+"[1]",o[1],"expressions are not allowed in function stops.")]):t.concat(rn({key:a+"[1]",value:o[1],valueSpec:g,style:r.style,styleSpec:r.styleSpec}))}function c(e,t){var a=br(e.value),r=Ut(e.value),o=null===e.value?t:e.value;if(!y)y=a;else if(a!==y)return[new Lt(e.key,o,a+" stop domain type must match previous stop domain type "+y)];if("number"!==a&&"string"!==a&&"boolean"!==a)return[new Lt(e.key,o,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==i){var n="number expected, "+a+" found";return mr(g)&&void 0===i&&(n+="\nIf you intended to use a categorical function, specify `\"type\": \"categorical\"`."),[new Lt(e.key,o,n)]}return"categorical"!==i||"number"!==a||isFinite(r)&&ba(r)===r?"categorical"!==i&&"number"===a&&void 0!==f&&r<f?[new Lt(e.key,o,"stop domain values must appear in ascending order")]:(f=r,"categorical"===i&&r in h?[new Lt(e.key,o,"stop domain values must be unique")]:(h[r]=!0,[])):[new Lt(e.key,o,"integer expected, found "+r)]}var g=d.valueSpec,i=Ut(d.value.type),h={},t="categorical"!==i&&void 0===d.value.property,m="array"===br(d.value.stops)&&"array"===br(d.value.stops[0])&&"object"===br(d.value.stops[0][0]),a=Or({key:d.key,value:d.value,valueSpec:d.styleSpec.function,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(a){if("identity"===i)return[new Lt(a.key,a.value,"identity function may not have a \"stops\" property")];var t=[],o=a.value;return t=t.concat(Mr({key:a.key,value:o,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:u})),"array"===br(o)&&0===o.length&&t.push(new Lt(a.key,o,"array must have at least one stop")),t},default:function(e){return rn({key:e.key,value:e.value,valueSpec:g,style:e.style,styleSpec:e.styleSpec})}}}),y,f,l;return"identity"===i&&t&&a.push(new Lt(d.key,d.value,"missing required property \"property\"")),"identity"===i||d.value.stops||a.push(new Lt(d.key,d.value,"missing required property \"stops\"")),"exponential"===i&&d.valueSpec.expression&&!_r(d.valueSpec)&&a.push(new Lt(d.key,d.value,"exponential functions not supported")),8<=d.styleSpec.$version&&(!t&&!mr(d.valueSpec)?a.push(new Lt(d.key,d.value,"property functions not supported")):t&&!xr(d.valueSpec)&&a.push(new Lt(d.key,d.value,"zoom functions not supported"))),"categorical"!==i&&!m||void 0!==d.value.property||a.push(new Lt(d.key,d.value,"\"property\" property is required")),a}function Br(a){var t=("property"===a.expressionContext?zr:Ir)(jt(a.value),a.valueSpec);if("error"===t.result)return t.value.map(function(t){return new Lt(""+a.key+t.key,a.value,t.message)});var e=t.value.expression||t.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&-1!==e.possibleOutputs().indexOf(void 0))return[new Lt(a.key,a.value,"Invalid data expression for \""+a.propertyKey+"\". Output values must be contained as literals within the expression.")];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Ae(e))return[new Lt(a.key,a.value,"\"feature-state\" data expressions are not supported with layout properties.")];if("filter"===a.expressionContext&&!Ae(e))return[new Lt(a.key,a.value,"\"feature-state\" data expressions are not supported with filters.")];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!Se(e,["zoom","feature-state"]))return[new Lt(a.key,a.value,"\"zoom\" and \"feature-state\" expressions are not supported with cluster properties.")];if("cluster-initial"===a.expressionContext&&!ce(e))return[new Lt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nr(a){var t=a.key,e=a.value,r=a.valueSpec,o=[];return Array.isArray(r.values)?-1===r.values.indexOf(Ut(e))&&o.push(new Lt(t,e,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(e)+" found")):-1===Object.keys(r.values).indexOf(Ut(e))&&o.push(new Lt(t,e,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(e)+" found")),o}function Vr(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return 2<=a.length&&"$id"!==a[1]&&"$type"!==a[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var t=0,o=a.slice(1),r;t<o.length;t+=1)if(r=o[t],!Vr(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0;}}function Ur(a){if(null==a)return function(){return!0};Vr(a)||(a=Hr(a));var o=Ir(a,Rr);if("error"===o.result)throw new Error(o.value.map(function(e){return e.key+": "+e.message}).join(", "));return function(e,t){return o.value.evaluate(e,t)}}function Gr(a,t){return a<t?-1:a>t?1:0}function Hr(a){if(!a)return!0;var t=a[0],r;return 1>=a.length?"any"!==t:"=="===t?qr(a[1],a[2],"=="):"!="===t?Zr(qr(a[1],a[2],"==")):"<"===t||">"===t||"<="===t||">="===t?qr(a[1],a[2],t):"any"===t?(r=a.slice(1),["any"].concat(r.map(Hr))):"all"===t?["all"].concat(a.slice(1).map(Hr)):"none"===t?["all"].concat(a.slice(1).map(Hr).map(Zr)):"in"===t?Yr(a[1],a.slice(2)):"!in"===t?Zr(Yr(a[1],a.slice(2))):"has"===t?Wr(a[1]):"!has"!==t||Zr(Wr(a[1]))}function qr(a,t,e){return"$type"===a?["filter-type-"+e,t]:"$id"===a?["filter-id-"+e,t]:["filter-"+e,a,t]}function Yr(a,r){return 0!==r.length&&("$type"===a?["filter-type-in",["literal",r]]:"$id"===a?["filter-id-in",["literal",r]]:200<r.length&&!r.some(function(e){return typeof e!=typeof r[0]})?["filter-in-large",a,["literal",r.sort(Gr)]]:["filter-in-small",a,["literal",r]])}function Wr(e){return"$type"===e||("$id"===e?["filter-has-id"]:["filter-has",e])}function Zr(e){return["!",e]}function Kr(e){return Vr(jt(e.value))?Br(Ot({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function l(t){var e=t.value,r=t.key;if("array"!==br(e))return[new Lt(r,e,"array expected, "+br(e)+" found")];var n=t.styleSpec,i=[],d;if(1>e.length)return[new Lt(r,e,"filter array must have at least 1 element")];switch(i=i.concat(Nr({key:r+"[0]",value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),Ut(e[0])){case"<":case"<=":case">":case">=":2<=e.length&&"$type"===Ut(e[1])&&i.push(new Lt(r,e,"\"$type\" cannot be use with operator \""+e[0]+"\""));case"==":case"!=":3!==e.length&&i.push(new Lt(r,e,"filter array for operator \""+e[0]+"\" must have 3 elements"));case"in":case"!in":2<=e.length&&"string"!==(d=br(e[1]))&&i.push(new Lt(r+"[1]",e[1],"string expected, "+d+" found"));for(var c=2;c<e.length;c++)d=br(e[c]),"$type"===Ut(e[1])?i=i.concat(Nr({key:r+"["+c+"]",value:e[c],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&i.push(new Lt(r+"["+c+"]",e[c],"string, number, or boolean expected, "+d+" found"));break;case"any":case"all":case"none":for(var p=1;p<e.length;p++)i=i.concat(l({key:r+"["+p+"]",value:e[p],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":d=br(e[1]),2===e.length?"string"!==d&&i.push(new Lt(r+"[1]",e[1],"string expected, "+d+" found")):i.push(new Lt(r,e,"filter array for \""+e[0]+"\" operator must have 2 elements"));}return i}(e)}function Jr(d,t){var e=d.key,r=d.style,n=d.styleSpec,i=d.value,a=d.objectKey,o=n[t+"_"+d.layerType];if(!o)return[];var s=a.match(/^(.*)-transition$/);if("paint"===t&&s&&o[s[1]]&&o[s[1]].transition)return rn({key:e,value:i,valueSpec:n.transition,style:r,styleSpec:n});var u=d.valueSpec||o[a],p;if(!u)return[new Lt(e,i,"unknown property \""+a+"\"")];if("string"===br(i)&&mr(u)&&!u.tokens&&(p=/^{([^}]+)}$/.exec(i)))return[new Lt(e,i,"\""+a+"\" does not support interpolation syntax\nUse an identity property function instead: `{ \"type\": \"identity\", \"property\": "+JSON.stringify(p[1])+" }`.")];var g=[];return"symbol"===d.layerType&&("text-field"===a&&r&&!r.glyphs&&g.push(new Lt(e,i,"use of \"text-field\" requires a style \"glyphs\" property")),"text-font"===a&&vr(jt(i))&&"identity"===Ut(i.type)&&g.push(new Lt(e,i,"\"text-font\" does not support identity functions"))),g.concat(rn({key:d.key,value:i,valueSpec:u,style:r,styleSpec:n,expressionContext:"property",propertyType:t,propertyKey:a}))}function Qr(e){return Jr(e,"paint")}function $r(e){return Jr(e,"layout")}function yo(d){var g=[],m=d.value,r=d.key,t=d.style,i=d.styleSpec;m.type||m.ref||g.push(new Lt(r,m,"either \"type\" or \"ref\" is required"));var a=Ut(m.type),n=Ut(m.ref),u;if(m.id)for(var y=Ut(m.id),l=0,x;l<d.arrayIndex;l++)x=t.layers[l],Ut(x.id)===y&&g.push(new Lt(r,m.id,"duplicate layer id \""+m.id+"\", previously used at line "+x.id.__line__));if("ref"in m)["type","source","source-layer","filter","layout"].forEach(function(e){e in m&&g.push(new Lt(r,m[e],"\""+e+"\" is prohibited for ref layers"))}),t.layers.forEach(function(e){Ut(e.id)===n&&(u=e)}),u?u.ref?g.push(new Lt(r,m.ref,"ref cannot reference another ref layer")):a=Ut(u.type):g.push(new Lt(r,m.ref,"ref layer \""+n+"\" not found"));else if("background"!==a)if(m.source){var _=t.sources&&t.sources[m.source],h=_&&Ut(_.type);_?"vector"===h&&"raster"===a?g.push(new Lt(r,m.source,"layer \""+m.id+"\" requires a raster source")):"raster"===h&&"raster"!==a?g.push(new Lt(r,m.source,"layer \""+m.id+"\" requires a vector source")):"vector"!==h||m["source-layer"]?"raster-dem"===h&&"hillshade"!==a?g.push(new Lt(r,m.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==a||!m.paint||!m.paint["line-gradient"]||"geojson"===h&&_.lineMetrics||g.push(new Lt(r,m,"layer \""+m.id+"\" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.")):g.push(new Lt(r,m,"layer \""+m.id+"\" must specify a \"source-layer\"")):g.push(new Lt(r,m.source,"source \""+m.source+"\" not found"))}else g.push(new Lt(r,m,"missing required property \"source\""));return g=g.concat(Or({key:r,value:m,valueSpec:i.layer,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return rn({key:r+".type",value:m.type,valueSpec:i.layer.type,style:d.style,styleSpec:d.styleSpec,object:m,objectKey:"type"})},filter:Kr,layout:function(e){return Or({layer:m,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return $r(Ot({layerType:a},e))}}})},paint:function(e){return Or({layer:m,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Qr(Ot({layerType:a},e))}}})}}}))}function en(d){var t=d.value,e=d.key,r=d.styleSpec,n=d.style;if(!t.type)return[new Lt(e,t,"\"type\" is required")];var i=Ut(t.type),o;switch(i){case"vector":case"raster":case"raster-dem":if(o=Or({key:e,value:t,valueSpec:r["source_"+i.replace("-","_")],style:d.style,styleSpec:r}),"url"in t)for(var g in t)0>["type","url","tileSize"].indexOf(g)&&o.push(new Lt(e+"."+g,t[g],"a source with a \"url\" property may not include a \""+g+"\" property"));return o;case"geojson":if(o=Or({key:e,value:t,valueSpec:r.source_geojson,style:n,styleSpec:r}),t.cluster)for(var s in t.clusterProperties){var u=t.clusterProperties[s],l=u[0],p=u[1],c="string"==typeof l?[l,["accumulated"],["get",s]]:l;o.push.apply(o,Br({key:e+"."+s+".map",value:p,expressionContext:"cluster-map"})),o.push.apply(o,Br({key:e+"."+s+".reduce",value:c,expressionContext:"cluster-reduce"}))}return o;case"video":return Or({key:e,value:t,valueSpec:r.source_video,style:n,styleSpec:r});case"image":return Or({key:e,value:t,valueSpec:r.source_image,style:n,styleSpec:r});case"canvas":return[new Lt(e,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nr({key:e+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:r});}}function tn(l){var t=l.value,e=l.styleSpec,r=e.light,n=l.style,i=[],d=br(t);if(void 0===t)return i;if("object"!==d)return i=i.concat([new Lt("light",t,"object expected, "+d+" found")]);for(var o in t){var s=o.match(/^(.*)-transition$/);i=s&&r[s[1]]&&r[s[1]].transition?i.concat(rn({key:o,value:t[o],valueSpec:e.transition,style:n,styleSpec:e})):r[o]?i.concat(rn({key:o,value:t[o],valueSpec:r[o],style:n,styleSpec:e})):i.concat([new Lt(o,t[o],"unknown property \""+o+"\"")])}return i}function an(a){var t=a.value,e=a.key,r=br(t);return"string"===r?[]:[new Lt(e,t,"string expected, "+r+" found")]}function rn(a){var t=a.value,e=a.valueSpec,r=a.styleSpec;return e.expression&&vr(Ut(t))?Fr(a):e.expression&&Tr(jt(t))?Br(a):e.type&&Xr[e.type]?Xr[e.type](a):Or(Ot({},a,{valueSpec:e.type?r[e.type]:e}))}function on(a){var t=a.value,e=a.key,r=an(a);return r.length?r:(-1===t.indexOf("{fontstack}")&&r.push(new Lt(e,t,"\"glyphs\" url must include a \"{fontstack}\" token")),-1===t.indexOf("{range}")&&r.push(new Lt(e,t,"\"glyphs\" url must include a \"{range}\" token")),r)}function nn(a,t){t=t||Ft;var o=[];return o=o.concat(rn({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,objectElementValidators:{glyphs:on,"*":function(){return[]}}})),a.constants&&(o=o.concat(Tt({key:"constants",value:a.constants,style:a,styleSpec:t}))),ln(o)}function ln(e){return[].concat(e).sort(function(a,t){return a.line-t.line})}function sn(a){return function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return ln(a.apply(this,t))}}function dn(o,t){var e=!1;if(t&&t.length)for(var l=0,s=t,i;l<s.length;l+=1)i=s[l],o.fire(new Pt(new Error(i.message))),e=!0;return e}function cn(d,g,h){var m=this.cells=[];if(d instanceof ArrayBuffer){this.arrayBuffer=d;var n=new Int32Array(this.arrayBuffer);d=n[0],g=n[1],h=n[2],this.d=g+2*h;for(var i=0;i<this.d*this.d;i++){var y=n[3+i],o=n[3+i+1];m.push(y===o?null:n.subarray(y,o))}var s=n[3+m.length],u=n[3+m.length+1];this.keys=n.subarray(s,u),this.bboxes=n.subarray(u),this.insert=this._insertReadonly}else{this.d=g+2*h;for(var l=0;l<this.d*this.d;l++)m.push([]);this.keys=[],this.bboxes=[]}this.n=g,this.extent=d,this.padding=h,this.scale=g/d,this.uid=0;var f=h/g*d;this.min=-f,this.max=d+f}function un(a,t,e){void 0===e&&(e={}),Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),Sn[a]={klass:t,omit:e.omit||[],shallow:e.shallow||[]}}function hn(d,t){if(null==d||"boolean"==typeof d||"number"==typeof d||"string"==typeof d||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(d instanceof ArrayBuffer)return t&&t.push(d),d;if(ArrayBuffer.isView(d)){var e=d;return t&&t.push(e.buffer),e}if(d instanceof wn)return t&&t.push(d.data.buffer),d;if(Array.isArray(d)){for(var r=[],n=0,g=d,a;n<g.length;n+=1)a=g[n],r.push(hn(a,t));return r}if("object"==typeof d){var h=d.constructor,s=h._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var u=h.serialize?h.serialize(d,t):{};if(!h.serialize){for(var l in d)if(d.hasOwnProperty(l)&&!(0<=Sn[s].omit.indexOf(l))){var p=d[l];u[l]=0<=Sn[s].shallow.indexOf(l)?p:hn(p,t)}d instanceof Error&&(u.message=d.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof d)}function yn(l){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof ArrayBuffer||ArrayBuffer.isView(l)||l instanceof wn)return l;if(Array.isArray(l))return l.map(yn);if("object"==typeof l){var t=l.$name||"Object",e=Sn[t].klass;if(!e)throw new Error("can't deserialize unregistered class "+t);if(e.deserialize)return e.deserialize(l);for(var r=Object.create(e.prototype),n=0,d=Object.keys(l),a;n<d.length;n+=1)if(a=d[n],"$name"!==a){var c=l[a];r[a]=0<=Sn[t].shallow.indexOf(a)?c:yn(c)}return r}throw new Error("can't deserialize object of type "+typeof l)}function fn(a){for(var t=0,o=a;t<o.length;t+=1)if(An(o[t].charCodeAt(0)))return!0;return!1}function bn(a){for(var t=0,o=a;t<o.length;t+=1)if(!Tn(o[t].charCodeAt(0)))return!1;return!0}function Tn(e){return!En.Arabic(e)&&!En["Arabic Supplement"](e)&&!En["Arabic Extended-A"](e)&&!En["Arabic Presentation Forms-A"](e)&&!En["Arabic Presentation Forms-B"](e)}function An(e){return 746===e||747===e||!(4352>e)&&(!!En["Bopomofo Extended"](e)||!!En.Bopomofo(e)||!(!En["CJK Compatibility Forms"](e)||65097<=e&&65103>=e)||!!En["CJK Compatibility Ideographs"](e)||!!En["CJK Compatibility"](e)||!!En["CJK Radicals Supplement"](e)||!!En["CJK Strokes"](e)||!(!En["CJK Symbols and Punctuation"](e)||12296<=e&&12305>=e||12308<=e&&12319>=e||12336===e)||!!En["CJK Unified Ideographs Extension A"](e)||!!En["CJK Unified Ideographs"](e)||!!En["Enclosed CJK Letters and Months"](e)||!!En["Hangul Compatibility Jamo"](e)||!!En["Hangul Jamo Extended-A"](e)||!!En["Hangul Jamo Extended-B"](e)||!!En["Hangul Jamo"](e)||!!En["Hangul Syllables"](e)||!!En.Hiragana(e)||!!En["Ideographic Description Characters"](e)||!!En.Kanbun(e)||!!En["Kangxi Radicals"](e)||!!En["Katakana Phonetic Extensions"](e)||En.Katakana(e)&&12540!==e||!(!En["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||65306<=e&&65310>=e||65339===e||65341===e||65343===e||65371<=e&&65503>=e||65507===e||65512<=e&&65519>=e)||!(!En["Small Form Variants"](e)||65112<=e&&65118>=e||65123<=e&&65126>=e)||!!En["Unified Canadian Aboriginal Syllabics"](e)||!!En["Unified Canadian Aboriginal Syllabics Extended"](e)||!!En["Vertical Forms"](e)||!!En["Yijing Hexagram Symbols"](e)||!!En["Yi Syllables"](e)||!!En["Yi Radicals"](e))}function Cn(e){return!(An(e)||function(e){return!!(En["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||En["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||En["Letterlike Symbols"](e)||En["Number Forms"](e)||En["Miscellaneous Technical"](e)&&(8960<=e&&8967>=e||8972<=e&&8991>=e||8996<=e&&9e3>=e||9003===e||9085<=e&&9114>=e||9150<=e&&9165>=e||9167===e||9169<=e&&9179>=e||9186<=e&&9215>=e)||En["Control Pictures"](e)&&9251!==e||En["Optical Character Recognition"](e)||En["Enclosed Alphanumerics"](e)||En["Geometric Shapes"](e)||En["Miscellaneous Symbols"](e)&&!(9754<=e&&9759>=e)||En["Miscellaneous Symbols and Arrows"](e)&&(11026<=e&&11055>=e||11088<=e&&11097>=e||11192<=e&&11243>=e)||En["CJK Symbols and Punctuation"](e)||En.Katakana(e)||En["Private Use Area"](e)||En["CJK Compatibility Forms"](e)||En["Small Form Variants"](e)||En["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||9984<=e&&10087>=e||10102<=e&&10131>=e||65532===e||65533===e)}(e))}function Ln(a,t){return!(!t&&(1424<=a&&2303>=a||En["Arabic Presentation Forms-A"](a)||En["Arabic Presentation Forms-B"](a)))&&!(2304<=a&&3583>=a||3840<=a&&4255>=a||En.Khmer(a))}function zn(a,l){void 0===l&&(l=1);var d=0,c=0;return{members:a.map(function(e){var t=(o=e.type,ai[o].BYTES_PER_ELEMENT),a=d=li(d,va(l,t)),r=e.components||1,o;return c=va(c,t),d+=t*r,{name:e.name,type:e.type,components:r,offset:a}}),size:li(d,va(c,l)),alignment:l}}function li(a,t){return M(a/t)*t}function pi(a,r){return 256*(a=Ue(ba(a),0,255))+(r=Ue(ba(r),0,255))}function Gi(a,t,e){var r=a[t];a[t]=a[e],a[e]=r}function Ji(e){return[pi(255*e.r,255*e.g),pi(255*e.b,255*e.a)]}function ia(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[a]||[a.replace(t+"-","").replace(/-/g,"_")]}function ha(a,t,e){var r=function(e){return{"line-pattern":{source:yi,composite:yi},"fill-pattern":{source:yi,composite:yi},"fill-extrusion-pattern":{source:yi,composite:yi}}[e]}(a);return r&&r[e]||{color:{source:Ci,composite:Ei},number:{source:Ai,composite:Ci}}[t][e]}function Pn(l){for(var t=8192/l.extent,e=l.loadGeometry(),r=0;r<e.length;r++)for(var s=e[r],i=0,d;i<s.length;i++)d=s[i],d.x=V(d.x*t),d.y=V(d.y*t),(d.x<ca.min||d.x>ca.max||d.y<ca.min||d.y>ca.max)&&Fa("Geometry exceeds allowed extent, reduce your vector tile buffer size");return e}function Dn(a,t,e,r,o){a.emplaceBack(2*t+(r+1)/2,2*e+(o+1)/2)}function ga(a,t){for(var e=0;e<a.length;e++)if(Ba(t,a[e]))return!0;for(var o=0;o<t.length;o++)if(Ba(a,t[o]))return!0;return!!Aa(a,t)}function Fn(a,t,e){return!!Ba(a,t)||!!ka(t,a,e)}function Bn(l,t){if(1===l.length)return Ia(t,l[0]);for(var e=0;e<t.length;e++)for(var s=t[e],n=0;n<s.length;n++)if(Ba(l,s[n]))return!0;for(var d=0;d<l.length;d++)if(Ia(t,l[d]))return!0;for(var c=0;c<t.length;c++)if(Aa(l,t[c]))return!0;return!1}function wa(a,t,e){if(1<a.length){if(Aa(a,t))return!0;for(var r=0;r<t.length;r++)if(ka(t[r],a,e))return!0}for(var o=0;o<a.length;o++)if(ka(a[o],t,e))return!0;return!1}function Aa(o,t){if(0===o.length||0===t.length)return!1;for(var e=0;e<o.length-1;e++)for(var l=o[e],n=o[e+1],i=0;i<t.length-1;i++)if(Sa(l,n,t[i],t[i+1]))return!0;return!1}function Sa(a,t,e,r){return b(a,e,r)!==b(t,e,r)&&b(a,t,e)!==b(a,t,r)}function ka(a,t,e){var r=e*e;if(1===t.length)return a.distSqr(t[0])<r;for(var o=1;o<t.length;o++)if(za(a,t[o-1],t[o])<r)return!0;return!1}function za(a,t,e){var r=t.distSqr(e);if(0===r)return a.distSqr(t);var o=((a.x-t.x)*(e.x-t.x)+(a.y-t.y)*(e.y-t.y))/r;return 0>o?a.distSqr(t):1<o?a.distSqr(e):a.distSqr(e.sub(t)._mult(o)._add(t))}function Ia(l,t){for(var e=!1,d=0,c,p,g;d<l.length;d++)for(var h=0,m=(c=l[d]).length-1;h<c.length;m=h++)p=c[h],g=c[m],p.y>t.y!=g.y>t.y&&t.x<(g.x-p.x)*(t.y-p.y)/(g.y-p.y)+p.x&&(e=!e);return e}function Ba(l,t){for(var e=!1,s=0,d=l.length-1;s<l.length;d=s++){var c=l[s],a=l[d];c.y>t.y!=a.y>t.y&&t.x<(a.x-c.x)*(t.y-c.y)/(a.y-c.y)+c.x&&(e=!e)}return e}function Ca(o,t,e){var r=e[0],n=e[2];if(o.x<r.x&&t.x<r.x||o.x>n.x&&t.x>n.x||o.y<r.y&&t.y<r.y||o.y>n.y&&t.y>n.y)return!1;var i=b(o,t,e[0]);return i!==b(o,t,e[1])||i!==b(o,t,e[2])||i!==b(o,t,e[3])}function Ea(a,t,e){var r=t.paint.get(a).value;return"constant"===r.kind?r.value:e.programConfigurations.get(t.id).binders[a].maxValue}function Ma(e){return N(e[0]*e[0]+e[1]*e[1])}function Ta(i,t,e,r,n){if(!t[0]&&!t[1])return i;var a=ud.convert(t)._mult(n);"viewport"===e&&a._rotate(-r);for(var o=[],s=0,d;s<i.length;s++)d=i[s],o.push(d.sub(a));return o}function Pa(){var e=new Va(9);return Va!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Da(){var e=new Va(3);return Va!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Oa(a,t,e){var r=new Va(3);return r[0]=a,r[1]=t,r[2]=e,r}function Ra(l,t,e){var r=t[0],n=t[1],i=t[2],a=t[3];return l[0]=e[0]*r+e[4]*n+e[8]*i+e[12]*a,l[1]=e[1]*r+e[5]*n+e[9]*i+e[13]*a,l[2]=e[2]*r+e[6]*n+e[10]*i+e[14]*a,l[3]=e[3]*r+e[7]*n+e[11]*i+e[15]*a,l}function Na(){var e=new Va(4);return Va!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Za(a,t){var e=Ra([],[a.x,a.y,0,1],t);return new ud(e[0]/e[3],e[1]/e[3])}function to(o,t,e,r){var l=t.width,i=t.height;if(!r)r=new Uint8Array(l*i*e);else if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==l*i*e)throw new RangeError("mismatched image size");return o.width=l,o.height=i,o.data=r,o}function ro(o,t,e){var r=t.width,n=t.height;if(r!==o.width||n!==o.height){var i=to({},{width:r,height:n},e);no(o,i,{x:0,y:0},{x:0,y:0},{width:ea(o.width,r),height:ea(o.height,n)},e),o.width=r,o.height=n,o.data=i.data}}function no(d,t,e,r,n,i){if(0===n.width||0===n.height)return t;if(n.width>d.width||n.height>d.height||e.x>d.width-n.width||e.y>d.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=d.data,o=t.data,s=0;s<n.height;s++)for(var g=((e.y+s)*d.width+e.x)*i,l=((r.y+s)*t.width+r.x)*i,p=0;p<n.width*i;p++)o[l+p]=a[g+p];return t}function io(l,t){for(var e=new Uint8Array(1024),r={},n=0,s=0;256>n;n++,s+=4){r[t]=n/255;var d=l.evaluate(r);e[s+0]=ba(255*d.r/d.a),e[s+1]=ba(255*d.g/d.a),e[s+2]=ba(255*d.b/d.a),e[s+3]=ba(255*d.a)}return new ao({width:256,height:1},e)}function uo(d,t,e){e=e||2;var g=t&&t.length,p=g?t[0]*e:d.length,c=mo(d,0,p,e,!0),m=[],f,x,_,b,v,k,w;if(!c||c.next===c.prev)return m;if(g&&(c=function(d,t,e,c){var n=[],l,p,g,h,m;for(l=0,p=t.length;l<p;l++)g=t[l]*c,h=l<p-1?t[l+1]*c:d.length,(m=mo(d,g,h,c,!1))===m.next&&(m.steiner=!0),n.push(zo(m));for(n.sort(Ao),l=0;l<n.length;l++)So(n[l],e),e=vo(e,e.next);return e}(d,t,c,e)),d.length>80*e){f=_=d[0],x=b=d[1];for(var T=e;T<p;T+=e)(v=d[T])<f&&(f=v),(k=d[T+1])<x&&(x=k),v>_&&(_=v),k>b&&(b=k);w=0===(w=va(_-f,b-x))?0:1/w}return go(c,m,e,f,x,w),m}function mo(l,t,e,r,n){var i,s;if(n===0<Do(l,t,e,r))for(i=t;i<e;i+=r)s=Vo(i,l[i],l[i+1],s);else for(i=e-r;i>=t;i-=r)s=Vo(i,l[i],l[i+1],s);return s&&Eo(s,s.next)&&(Fo(s),s=s.next),s}function vo(a,t){if(!a)return a;t||(t=a);var o=a,i;do if(i=!1,o.steiner||!Eo(o,o.next)&&0!==Co(o.prev,o,o.next))o=o.next;else{if(Fo(o),(o=t=o.prev)===o.next)break;i=!0}while(i||o!==t);return t}function go(d,c,e,r,n,i,a){if(d){!a&&i&&function(a,t,e,r){var o=a;do null===o.z&&(o.z=ko(o.x,o.y,t,e,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==a);o.prevZ.nextZ=null,o.prevZ=null,function(d){var c=1,p,g,h,m,y,f,x,_;do{for(g=d,d=null,y=null,f=0;g;){for(f++,h=g,x=0,p=0;p<c&&(x++,h=h.nextZ);p++);for(_=c;0<x||0<_&&h;)0!==x&&(0===_||!h||g.z<=h.z)?(m=g,g=g.nextZ,x--):(m=h,h=h.nextZ,_--),y?y.nextZ=m:d=m,m.prevZ=y,y=m;g=h}y.nextZ=null,c*=2}while(1<f)}(o)}(d,r,n,i);for(var o=d,p,g;d.prev!==d.next;)if(p=d.prev,g=d.next,i?bo(d,r,n,i):xo(d))c.push(p.i/e),c.push(d.i/e),c.push(g.i/e),Fo(d),d=g.next,o=g.next;else if((d=g)===o){a?1===a?go(d=_o(d,c,e),c,e,r,n,i,2):2==a&&wo(d,c,e,r,n,i):go(vo(d),c,e,r,n,i,1);break}}}function xo(a){var t=a.prev,e=a,r=a.next;if(0<=Co(t,e,r))return!1;for(var o=a.next.next;o!==a.prev;){if(Io(t.x,t.y,e.x,e.y,r.x,r.y,o.x,o.y)&&0<=Co(o.prev,o,o.next))return!1;o=o.next}return!0}function bo(d,t,e,r){var n=d.prev,i=d,a=d.next;if(0<=Co(n,i,a))return!1;for(var o=n.x<i.x?n.x<a.x?n.x:a.x:i.x<a.x?i.x:a.x,s=n.y<i.y?n.y<a.y?n.y:a.y:i.y<a.y?i.y:a.y,u=n.x>i.x?n.x>a.x?n.x:a.x:i.x>a.x?i.x:a.x,l=n.y>i.y?n.y>a.y?n.y:a.y:i.y>a.y?i.y:a.y,p=ko(o,s,t,e,r),c=ko(u,l,t,e,r),g=d.prevZ,h=d.nextZ;g&&g.z>=p&&h&&h.z<=c;){if(g!==d.prev&&g!==d.next&&Io(n.x,n.y,i.x,i.y,a.x,a.y,g.x,g.y)&&0<=Co(g.prev,g,g.next))return!1;if(g=g.prevZ,h!==d.prev&&h!==d.next&&Io(n.x,n.y,i.x,i.y,a.x,a.y,h.x,h.y)&&0<=Co(h.prev,h,h.next))return!1;h=h.nextZ}for(;g&&g.z>=p;){if(g!==d.prev&&g!==d.next&&Io(n.x,n.y,i.x,i.y,a.x,a.y,g.x,g.y)&&0<=Co(g.prev,g,g.next))return!1;g=g.prevZ}for(;h&&h.z<=c;){if(h!==d.prev&&h!==d.next&&Io(n.x,n.y,i.x,i.y,a.x,a.y,h.x,h.y)&&0<=Co(h.prev,h,h.next))return!1;h=h.nextZ}return!0}function _o(o,l,e){var r=o;do{var s=r.prev,i=r.next.next;!Eo(s,i)&&Mo(s,r,r.next,i)&&To(s,i)&&To(i,s)&&(l.push(s.i/e),l.push(r.i/e),l.push(i.i/e),Fo(r),Fo(r.next),r=o=i),r=r.next}while(r!==o);return r}function wo(l,t,e,r,n,i){var a=l;do{for(var d=a.next.next;d!==a.prev;){if(a.i!==d.i&&Bo(a,d)){var c=Po(a,d);return a=vo(a,a.next),c=vo(c,c.next),go(a,t,e,r,n,i),void go(c,t,e,r,n,i)}d=d.next}a=a.next}while(a!==l)}function Ao(a,t){return a.x-t.x}function So(a,t){if(t=function(d,t){var e=t,g=d.x,i=d.y,a=-1/0,m;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var y=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(y<=g&&y>a){if(a=y,y===g){if(i===e.y)return e;if(i===e.next.y)return e.next}m=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!m)return null;if(g===a)return m.prev;var s=m,l=m.x,p=m.y,c=1/0,f;for(e=m.next;e!==s;)g>=e.x&&e.x>=l&&g!==e.x&&Io(i<p?g:a,i,l,p,i<p?a:g,i,e.x,e.y)&&((f=_a(i-e.y)/(g-e.x))<c||f===c&&e.x>m.x)&&To(e,d)&&(m=e,c=f),e=e.next;return m}(a,t)){var o=Po(t,a);vo(o,o.next)}}function ko(a,o,l,r,n){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-l)*n)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-r)*n)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function zo(a){var t=a,o=a;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==a);return o}function Io(l,t,e,r,n,i,a,o){return 0<=(n-a)*(t-o)-(l-a)*(i-o)&&0<=(l-a)*(r-o)-(e-a)*(t-o)&&0<=(e-a)*(i-o)-(n-a)*(r-o)}function Bo(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(a,t){var e=a;do{if(e.i!==a.i&&e.next.i!==a.i&&e.i!==t.i&&e.next.i!==t.i&&Mo(e,e.next,a,t))return!0;e=e.next}while(e!==a);return!1}(a,t)&&To(a,t)&&To(t,a)&&function(o,t){var e=o,l=!1,s=(o.x+t.x)/2,i=(o.y+t.y)/2;do e.y>i!=e.next.y>i&&e.next.y!==e.y&&s<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(l=!l),e=e.next;while(e!==o);return l}(a,t)}function Co(a,t,e){return(t.y-a.y)*(e.x-t.x)-(t.x-a.x)*(e.y-t.y)}function Eo(a,t){return a.x===t.x&&a.y===t.y}function Mo(a,t,e,r){return!!(Eo(a,t)&&Eo(e,r)||Eo(a,r)&&Eo(e,t))||0<Co(a,t,e)!=0<Co(a,t,r)&&0<Co(e,r,a)!=0<Co(e,r,t)}function To(a,t){return 0>Co(a.prev,a,a.next)?0<=Co(a,t,a.next)&&0<=Co(a,a.prev,t):0>Co(a,t,a.prev)||0>Co(a,a.next,t)}function Po(o,t){var e=new Lo(o.i,o.x,o.y),r=new Lo(t.i,t.x,t.y),n=o.next,i=t.prev;return o.next=t,t.prev=o,e.next=n,n.prev=e,r.next=e,e.prev=r,i.next=r,r.prev=i,r}function Vo(a,t,e,r){var o=new Lo(a,t,e);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function Fo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Lo(a,t,e){this.i=a,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Do(l,t,e,r){for(var n=0,s=t,d=e-r;s<e;s+=r)n+=(l[d]-l[s])*(l[s+1]+l[d+1]),d=s;return n}function Oo(a,t,e,r,o){!function g(t,e,r,x,_){for(;x>r;){if(600<x-r){var a=x-r+1,o=e-r+1,s=P(a),u=.5*m(2*s/3),l=.5*N(s*u*(a-u)/a)*(0>o-a/2?-1:1),p=va(r,ba(e-o*u/a+l)),c=ea(x,ba(e+(a-o)*u/a+l));g(t,e,p,c,_)}var h=t[e],f=r,b=x;for(Ro(t,r,e),0<_(t[x],h)&&Ro(t,r,x);f<b;){for(Ro(t,f,b),f++,b--;0>_(t[f],h);)f++;for(;0<_(t[b],h);)b--}0===_(t[r],h)?Ro(t,r,b):Ro(t,++b,x),b<=e&&(r=b+1),e<=b&&(x=b-1)}}(a,t,e||0,r||a.length-1,o||Uo)}function Ro(a,t,e){var r=a[t];a[t]=a[e],a[e]=r}function Uo(a,t){return a<t?-1:a>t?1:0}function jo(l,t){var e=l.length;if(1>=e)return[l];for(var r=[],a=0,d,c,p;a<e;a++)p=w(l[a]),0!==p&&(l[a].area=_a(p),null==c&&(c=0>p),c===0>p?(d&&r.push(d),d=[l[a]]):d.push(l[a]));if(d&&r.push(d),1<t)for(var g=0;g<r.length;g++)r[g].length<=t||(Oo(r[g],t,1,r[g].length-1,qo),r[g]=r[g].slice(0,t));return r}function qo(a,t){return t.area-a.area}function No(l,t,e){for(var r=e.patternDependencies,n=!1,d=0,c=t,o;d<c.length;d+=1){o=c[d].paint.get(l+"-pattern"),o.isConstant()||(n=!0);var p=o.constantOr(null);p&&(n=!0,r[p.to]=!0,r[p.from]=!0)}return n}function Zo(d,t,e,r,n){for(var i=n.patternDependencies,a=0,g=t;a<g.length;a+=1){var s=g[a],u=s.paint.get(d+"-pattern").value;if("constant"!==u.kind){var l=u.evaluate({zoom:r-1},e,{}),p=u.evaluate({zoom:r},e,{}),c=u.evaluate({zoom:r+1},e,{});i[l]=!0,i[p]=!0,i[c]=!0,e.patterns[s.id]={min:l,mid:p,max:c}}}return e}function Ko(a,t,e,r,o){this.properties={},this.extent=e,this.type=0,this._pbf=a,this._geometry=-1,this._keys=r,this._values=o,a.readFields($o,this,t)}function $o(a,t,e){1==a?t.id=e.readVarint():2==a?function(a,t){for(var e=a.readVarint()+a.pos;a.pos<e;){var r=t._keys[a.readVarint()],o=t._values[a.readVarint()];t.properties[r]=o}}(e,t):3==a?t.type=e.readVarint():4==a&&(t._geometry=e.pos)}function Wo(l){for(var t=0,s=0,d=l.length,a=d-1,c,p;s<d;a=s++)c=l[s],t+=((p=l[a]).x-c.x)*(c.y+p.y);return t}function Qo(a,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Vn,this,t),this.length=this._features.length}function Vn(a,t,e){15===a?t.version=e.readVarint():1===a?t.name=e.readString():5===a?t.extent=e.readVarint():2===a?t._features.push(e.pos):3===a?t._keys.push(e.readString()):4==a&&t._values.push(function(a){for(var t=null,o=a.readVarint()+a.pos,r;a.pos<o;)r=a.readVarint()>>3,t=1==r?a.readString():2==r?a.readFloat():3==r?a.readDouble():4==r?a.readVarint64():5==r?a.readVarint():6==r?a.readSVarint():7==r?a.readBoolean():null;return t}(e))}function sl(a,t,e){if(3===a){var r=new Yo(e,e.readVarint()+e.pos);r.length&&(t[r.name]=r)}}function Ll(l,t,e,r,n,i,a,o){l.emplaceBack(t,e,2*ba(8192*r)+a,2*(8192*n),2*(8192*i),V(o))}function Dl(a,t){return a.x===t.x&&(0>a.x||8192<a.x)||a.y===t.y&&(0>a.y||8192<a.y)}function Fl(e){return e.every(function(e){return 0>e.x})||e.every(function(e){return 8192<e.x})||e.every(function(e){return 0>e.y})||e.every(function(e){return 8192<e.y})}function Hl(a,t){return a.x*t.x+a.y*t.y}function Gl(v,t){if(1===v.length){var e=t[0],r=t[1],n=t[3],i=v[0],a=r.sub(e),o=n.sub(e),s=i.sub(e),u=Hl(a,a),l=Hl(a,o),p=Hl(o,o),c=Hl(s,a),h=Hl(s,o),f=u*p-l*l,y=(p*c-l*h)/f,d=(u*h-l*c)/f;return e.z*(1-y-d)+r.z*y+n.z*d}for(var m=1/0,k=0,w=t,b;k<w.length;k+=1)b=w[k],m=ea(m,b.z);return m}function Yl(l,t,e,r,n,i,a){l.emplaceBack((t.x<<1)+(r?1:0),(t.y<<1)+(n?1:0),V(63*e.x)+128,V(63*e.y)+128,1+(0===i?0:0>i?-1:1)|(63&a*gs)<<2,a*gs>>6)}function Wl(a,t){return 32767*(a/t.tileTotal*(t.end-t.start)+t.start)}function Xl(a,t){return 0<t?t+2*a:a}function Kl(a,o,e){return a.sections.forEach(function(a){a.text=function(a,o,e){var r=o.layout.get("text-transform").evaluate(e,{});return"uppercase"===r?a=a.toLocaleUpperCase():"lowercase"===r&&(a=a.toLocaleLowerCase()),qn.applyArabicShaping&&(a=qn.applyArabicShaping(a)),a}(a.text,o,e)}),a}function Jl(l,t){var e=t.expression;if("constant"===e.kind)return{kind:"constant",layoutSize:e.evaluate(new Nn(l+1))};if("source"===e.kind)return{kind:"source"};for(var r=e.zoomStops,n=e.interpolationType,i=0;i<r.length&&r[i]<=l;)i++;for(var d=i=va(0,i-1);d<r.length&&r[d]<l+1;)d++;d=ea(r.length-1,d);var c=r[i],s=r[d];return"composite"===e.kind?{kind:"composite",minZoom:c,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:c,maxZoom:s,minSize:e.evaluate(new Nn(c)),maxSize:e.evaluate(new Nn(s)),interpolationType:n}}function Ql(l,t,e){var r=t.uSize,n=t.uSizeT,i=e.lowerSize,a=e.upperSize;return"source"===l.kind?i/256:"composite"===l.kind?Be(i/256,a/256,n):r}function $l(l,t){var e=0,d=0;if("constant"===l.kind)d=l.layoutSize;else if("source"!==l.kind){var c=l.interpolationType,i=l.minZoom,a=l.maxZoom,o=c?Ue(Ye.interpolationFactor(c,t,i,a),0,1):0;"camera"===l.kind?d=Be(l.minSize,l.maxSize,o):e=o}return{uSizeT:e,uSize:d}}function es(l,t,e,r,n,i,a,o){l.emplaceBack(t,e,V(32*r),V(32*n),i,a,o?o[0]:0,o?o[1]:0)}function rs(a,t,e){a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e)}function ns(d){for(var t=0,g=0,m=0,x=d,i;m<x.length;m+=1)i=x[m],t+=i.w*i.h,g=va(g,i.w);d.sort(function(a,t){return t.h-a.h});for(var _=[{x:0,y:0,w:va(M(N(t/.95)),g),h:1/0}],o=0,b=0,v=0,k=d;v<k.length;v+=1)for(var p=k[v],c=_.length-1,w;0<=c;c--)if(w=_[c],!(p.w>w.w||p.h>w.h)){if(p.x=w.x,p.y=w.y,b=va(b,p.y+p.h),o=va(o,p.x+p.w),p.w===w.w&&p.h===w.h){var T=_.pop();c<_.length&&(_[c]=T)}else p.h===w.h?(w.x+=p.w,w.w-=p.w):p.w===w.w?(w.y+=p.h,w.h-=p.h):(_.push({x:w.x+p.w,y:w.y,w:w.w-p.w,h:p.h}),w.y+=p.h,w.h-=p.h);break}return{w:o,h:b,fill:t/(o*b)||0}}function ls(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}function ss(e){return e.type===ls.Bytes?e.readVarint()+e.pos:e.pos+1}function ps(a,t,e){return e?4294967296*t+(a>>>0):4294967296*(t>>>0)+(a>>>0)}function ys(a,t,e){var r=16383>=t?1:2097151>=t?2:268435455>=t?3:ba(P(t)/(7*E));e.realloc(r);for(var o=e.pos-1;o>=a;o--)e.buf[o+r]=e.buf[o]}function fs(a,t){for(var e=0;e<a.length;e++)t.writeVarint(a[e])}function _s(a,t){for(var e=0;e<a.length;e++)t.writeSVarint(a[e])}function vs(a,t){for(var e=0;e<a.length;e++)t.writeFloat(a[e])}function As(a,t){for(var e=0;e<a.length;e++)t.writeDouble(a[e])}function Ds(a,t){for(var e=0;e<a.length;e++)t.writeBoolean(a[e])}function Os(a,t){for(var e=0;e<a.length;e++)t.writeFixed32(a[e])}function Rs(a,t){for(var e=0;e<a.length;e++)t.writeSFixed32(a[e])}function Bs(a,t){for(var e=0;e<a.length;e++)t.writeFixed64(a[e])}function Vs(a,t){for(var e=0;e<a.length;e++)t.writeSFixed64(a[e])}function Us(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+16777216*a[t+3]}function Zs(a,t,e){a[e]=t,a[e+1]=t>>>8,a[e+2]=t>>>16,a[e+3]=t>>>24}function Ks(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+(a[t+3]<<24)}function ed(a,t,e){1===a&&e.readMessage(td,t)}function td(d,t,e){if(3===d){var r=e.readMessage(ad,{}),n=r.id,i=r.bitmap,a=r.width,o=r.height,s=r.left,c=r.top,l=r.advance;t.push({id:n,bitmap:new eo({width:a+6,height:o+6},i),metrics:{width:a,height:o,left:s,top:c,advance:l}})}}function ad(a,t,e){1===a?t.id=e.readVarint():2===a?t.bitmap=e.readBytes():3===a?t.width=e.readVarint():4===a?t.height=e.readVarint():5===a?t.left=e.readSVarint():6===a?t.top=e.readSVarint():7==a&&(t.advance=e.readVarint())}function rd(a,t,e){var r=6378137*(2*Pe)/256/ya(2,e);return[a*r-6378137*(2*Pe)/2,t*r-6378137*(2*Pe)/2]}function od(e){return 6378137*(2*Pe)*R(e*Pe/180)}function id(e){return(180+e)/360}function nd(e){return(180-180/Pe*P(fa(Pe/4+e*Pe/360)))/360}function ld(a,t){return a/od(t)}function sd(e){return 360/Pe*xa(m((180-360*e)*Pe/180))-90}function dd(a,o,e,r){0>(a*=2)&&(a=-1*a-1);var n=1<<o;return 32*(n*n*a+n*r+e)+o}function cd(l){for(var t=1/0,d=1/0,c=-1/0,p=-1/0,u=0,g=l,o;u<g.length;u+=1)o=g[u],t=ea(t,o.x),d=ea(d,o.y),c=va(c,o.x),p=va(p,o.y);return{minX:t,minY:d,maxX:c,maxY:p}}function il(a,t){return t-a}function al(k,t,e,r,n,i,a,o,s,u){var l=ul.fromFeature(k,e),c;u===ol.vertical&&l.verticalizePunctuation();var T=qn.processBidirectionalText,h=qn.processStyledBidirectionalText;if(T&&1===l.sections.length){c=[];for(var f=0,C=T(l.toString(),dl(l,o,r,t));f<C.length;f+=1){var d=C[f],m=new ul;m.text=d,m.sections=l.sections;for(var v=0;v<d.length;v++)m.sectionIndex.push(0);c.push(m)}}else if(h){c=[];for(var L=0,E=h(l.text,l.sectionIndex,dl(l,o,r,t));L<E.length;L+=1){var b=E[L],_=new ul;_.text=b[0],_.sectionIndex=b[1],_.sections=l.sections,c.push(_)}}else c=function(l,t){for(var e=[],r=l.text,n=0,d=0,c=t,o;d<c.length;d+=1)o=c[d],e.push(l.substring(n,o)),n=o;return n<r.length&&e.push(l.substring(n,r.length)),e}(l,dl(l,o,r,t));var w=[],A={positionedGlyphs:w,text:l.toString(),top:s[1],bottom:s[1],left:s[0],right:s[0],writingMode:u,lineCount:c.length};return function(T,t,e,r,n,i,a,o){for(var s=0,C=-17,L=0,E=T.positionedGlyphs,c="right"===i?1:"left"===i?0:.5,h=0,P=e,y;h<P.length;h+=1){y=P[h],y.trim();var D=y.getMaxScale();if(y.length()){for(var m=E.length,v=0;v<y.length();v++){var O=y.getSection(v),x=y.getCharCode(v),b=24*(D-O.scale),_=t[O.fontStack],w=_&&_[x];w&&(An(x)&&a!==ol.horizontal?(E.push({glyph:x,x:s,y:b,vertical:!0,scale:O.scale,fontStack:O.fontStack}),s+=24*O.scale+o):(E.push({glyph:x,x:s,y:C+b,vertical:!1,scale:O.scale,fontStack:O.fontStack}),s+=w.metrics.advance*O.scale+o))}if(E.length!==m){var A=s-o;L=va(A,L),vl(E,t,m,E.length-1,c)}s=0,C+=r*D}else C+=r}var S=ml(n),k=S.horizontalAlign,z=S.verticalAlign;!function(s,t,e,r,n,i,a){for(var o=0;o<s.length;o++)s[o].x+=(t-e)*n,s[o].y+=(-r*a+.5)*i}(E,c,k,z,L,r,e.length);var I=C- -17;T.top+=-z*I,T.bottom=T.top+I,T.left+=-k*L,T.right=T.left+L}(A,t,c,n,i,a,u,o),!!w.length&&A}function pl(a,t,e,r){var o=ya(a-t,2);return r?a<t?o/2:2*o:o+_a(e)*e}function fl(a,t,e){var r=0;return 10===a&&(r-=1e4),e&&(r+=150),40!==a&&65288!==a||(r+=50),41!==t&&65289!==t||(r+=50),r}function yl(d,t,e,r,n,i){for(var a=null,g=pl(t,e,n,i),h=0,m=r;h<m.length;h+=1){var l=m[h],p=pl(t-l.x,e,n,i)+l.badness;p<=g&&(a=l,g=p)}return{index:d,x:t,priorBreak:a,badness:g}}function dl(d,t,e,r){if(!e)return[];if(!d)return[];for(var n=[],a=function(l,t,e,r){for(var n=0,d=0;d<l.length();d++){var c=l.getSection(d),o=r[c.fontStack],s=o&&o[l.getCharCode(d)];s&&(n+=s.metrics.advance*c.scale+t)}return n/va(1,M(n/e))}(d,t,e,r),o=0<=d.text.indexOf("\u200B"),s=0,g=0,m;g<d.length();g++){var x=d.getSection(g),p=d.getCharCode(g),c=r[x.fontStack],h=c&&c[p];if(h&&!ll[p]&&(s+=h.metrics.advance*x.scale+t),g<d.length()-1){var f=!!(!(11904>(m=p))&&(En["Bopomofo Extended"](m)||En.Bopomofo(m)||En["CJK Compatibility Forms"](m)||En["CJK Compatibility Ideographs"](m)||En["CJK Compatibility"](m)||En["CJK Radicals Supplement"](m)||En["CJK Strokes"](m)||En["CJK Symbols and Punctuation"](m)||En["CJK Unified Ideographs Extension A"](m)||En["CJK Unified Ideographs"](m)||En["Enclosed CJK Letters and Months"](m)||En["Halfwidth and Fullwidth Forms"](m)||En.Hiragana(m)||En["Ideographic Description Characters"](m)||En["Kangxi Radicals"](m)||En["Katakana Phonetic Extensions"](m)||En.Katakana(m)||En["Vertical Forms"](m)||En["Yi Radicals"](m)||En["Yi Syllables"](m)));(cl[p]||f)&&n.push(yl(g+1,s,a,n,fl(p,d.getCharCode(g+1),f&&o),!1))}}return function a(t){return t?a(t.priorBreak).concat(t.index):[]}(yl(d.length(),s,a,n,0,!0))}function ml(a){var t=.5,o=.5;return"right"===a||"top-right"===a||"bottom-right"===a?t=1:"left"===a||"top-left"===a||"bottom-left"===a?t=0:void 0,"bottom"===a||"bottom-right"===a||"bottom-left"===a?o=1:"top"===a||"top-right"===a||"top-left"===a?o=0:void 0,{horizontalAlign:t,verticalAlign:o}}function vl(d,t,e,r,n){if(n){var i=d[r],a=t[i.fontStack],o=a&&a[i.glyph];if(o)for(var s=o.metrics.advance*i.scale,c=(d[r].x+s)*n,l=e;l<=r;l++)d[l].x-=c}}function pd(d,t,e){var r=ml(e),n=r.horizontalAlign,i=r.verticalAlign,a=t[0],o=t[1],s=a-d.displaySize[0]*n,c=s+d.displaySize[0],l=o-d.displaySize[1]*i;return{image:d,top:l,bottom:l+d.displaySize[1],left:s,right:c}}function xl(d,t,e,r,n){if(void 0===t.segment)return!0;for(var i=t,g=t.segment+1,m=0;m>-e/2;){if(0>--g)return!1;m-=d[g].dist(i),i=d[g]}m+=d[g].dist(d[g+1]),g++;for(var y=[],u=0;m<e/2;){var x=d[g-1],p=d[g],c=d[g+1];if(!c)return!1;var h=x.angleTo(p)-p.angleTo(c);for(h=_a((h+3*Pe)%(2*Pe)-Pe),y.push({distance:m,angleDelta:h}),u+=h;m-y[0].distance>r;)u-=y.shift().angleDelta;if(u>n)return!1;g++,m+=p.dist(c)}return!0}function bl(a){for(var t=0,o=0;o<a.length-1;o++)t+=a[o].dist(a[o+1]);return t}function _l(a,t,e){return a?.6*t*e:0}function wl(a,t){return va(a?a.right-a.left:0,t?t.right-t.left:0)}function Al(g,t,e,r,n,i){for(var a=_l(e,n,i),o=wl(e,r)*i,s=0,x=bl(g)/2,l=0;l<g.length-1;l++){var _=g[l],c=g[l+1],h=_.dist(c);if(s+h>x){var f=(x-s)/h,y=Be(_.x,c.x,f),d=Be(_.y,c.y,f),m=new Fs(y,d,c.angleTo(_),l);return m._round(),!a||xl(g,m,o,a,t)?m:void 0}s+=h}}function Sl(d,t,g,r,n,i,a,o,s){var u=_l(r,i,a),l=wl(r,n),p=l*a,c=0===d[0].x||d[0].x===s||0===d[0].y||d[0].y===s;return t-p<t/4&&(t=p+t/4),function k(t,e,r,n,i,a,o,s,u){for(var l=a/2,p=bl(t),c=0,T=e-r,S=[],C=0;C<t.length-1;C++){for(var L=t[C],m=t[C+1],v=L.dist(m),g=m.angleTo(L);T+r<c+v;){var x=((T+=r)-c)/v,b=Be(L.x,m.x,x),_=Be(L.y,m.y,x);if(0<=b&&b<u&&0<=_&&_<u&&0<=T-l&&T+l<=p){var w=new Fs(b,_,g,C);w._round(),n&&!xl(t,w,a,n,i)||S.push(w)}}c+=v}return s||S.length||o||(S=k(t,c/2,r,n,i,a,o,!0,u)),S}(d,c?t/2*o%t:(l/2+2*i)*a*o%t,t,u,g,p,c,!1,s)}function kl(a,t){return a<t?-1:a>t?1:0}function Bl(i,t,_){void 0===t&&(t=1),void 0===_&&(_=!1);for(var k=1/0,w=1/0,T=-1/0,A=-1/0,S=i[0],u=0,C;u<S.length;u++)C=S[u],(!u||C.x<k)&&(k=C.x),(!u||C.y<w)&&(w=C.y),(!u||C.x>T)&&(T=C.x),(!u||C.y>A)&&(A=C.y);var L=T-k,c=A-w,h=ea(L,c),f=h/2,E=new zl([],Cl);if(0===h)return new ud(k,w);for(var d=k;d<T;d+=h)for(var I=w;I<A;I+=h)E.push(new El(d+f,I+f,f,i));for(var z=function(d){for(var t=0,c=0,g=0,h=d[0],i=0,m=h.length,o=m-1;i<m;o=i++){var y=h[i],u=h[o],l=y.x*u.y-u.x*y.y;c+=(y.x+u.x)*l,g+=(y.y+u.y)*l,t+=3*l}return new El(c/t,g/t,0,d)}(i),P=E.length,D;E.length;)D=E.pop(),(D.d>z.d||!z.d)&&(z=D,_&&console.log("found best %d after %d probes",V(1e4*D.d)/1e4,P)),D.max-z.d<=t||(f=D.h/2,E.push(new El(D.p.x-f,D.p.y-f,f,i)),E.push(new El(D.p.x+f,D.p.y-f,f,i)),E.push(new El(D.p.x-f,D.p.y+f,f,i)),E.push(new El(D.p.x+f,D.p.y+f,f,i)),P+=4);return _&&(console.log("num probes: "+P),console.log("best distance: "+z.d)),z.p}function Cl(a,t){return t.max-a.max}function El(a,t,e,r){this.p=new ud(a,t),this.h=e,this.d=function(d,t){for(var e=!1,c=1/0,g=0;g<t.length;g++)for(var h=t[g],a=0,m=h.length,s=m-1;a<m;s=a++){var y=h[a],l=h[s];y.y>d.y!=l.y>d.y&&d.x<(l.x-y.x)*(d.y-y.y)/(l.y-y.y)+y.x&&(e=!e),c=ea(c,za(d,y,l))}return(e?1:-1)*N(c)}(this.p,r),this.max=this.d+this.h*c}function Ml(a,t){var e=0,o=0,l=t/N(2);return"top-right"===a||"top-left"===a?o=l-7:"bottom-right"===a||"bottom-left"===a?o=-l+7:"bottom"===a?o=-t+7:"top"===a?o=t-7:void 0,"top-right"===a||"bottom-right"===a?e=-l:"top-left"===a||"bottom-left"===a?e=l:"left"===a?e=t:"right"===a?e=-t:void 0,[e,o]}function Ol(e){return"right"===e||"top-right"===e||"bottom-right"===e?"right":"left"===e||"top-left"===e||"bottom-left"===e?"left":"center"}function Rl(i,t,e,r,n,a,o){var s=a.layoutTextSize.evaluate(t,{}),u=a.layoutIconSize.evaluate(t,{}),l=a.textMaxSize.evaluate(t,{});void 0===l&&(l=s);var y=i.layers[0].layout,c=y.get("icon-offset").evaluate(t,{}),h=ql(e.horizontal),f=i.tilePixelRatio*(s/24),d=i.tilePixelRatio*l/24,m=i.tilePixelRatio*u,v=i.tilePixelRatio*y.get("symbol-spacing"),g=y.get("text-padding")*i.tilePixelRatio,x=y.get("icon-padding")*i.tilePixelRatio,b=y.get("text-max-angle")/180*Pe,_="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement"),w="map"===y.get("icon-rotation-alignment")&&"point"!==y.get("symbol-placement"),A=y.get("symbol-placement"),k=function(s,d){0>d.x||8192<=d.x||0>d.y||8192<=d.y||function(i,t,e,r,n,a,o,s,u,l,p,c,h,f,y,d,m,v,g,x,b){var _=i.addToLineVertexArray(t,e),k=0,w=0,H=0,G={},C=Pl(""),Y=24*(a.layout.get("text-radial-offset").evaluate(g,{})||0),M,W;for(var X in r.horizontal){var T=r.horizontal[X];if(!M){C=Pl(T.text);var P=a.layout.get("text-rotate").evaluate(g,{});M=new hl(o,e,t,s,u,l,T,p,c,h,i.overscaling,P)}var V=1===T.lineCount;if(w+=Ul(i,t,T,a,h,g,f,_,r.vertical?ol.horizontal:ol.horizontalOnly,V?Object.keys(r.horizontal):[X],G,x,b),V)break}r.vertical&&(H+=Ul(i,t,r.vertical,a,h,g,f,_,ol.vertical,["vertical"],G,x,b));var F=M?M.boxStartIndex:i.collisionBoxArray.length,L=M?M.boxEndIndex:i.collisionBoxArray.length;if(n){var D=function(i,t,e,r,n,a){var o=t.image,c=e.layout,h=t.top-1/o.pixelRatio,f=t.left-1/o.pixelRatio,y=t.bottom+1/o.pixelRatio,d=t.right+1/o.pixelRatio,m,D,O,j;if("none"!==c.get("icon-text-fit")&&n){var N=d-f,v=y-h,g=c.get("text-size").evaluate(a,{})/24,x=n.left*g,b=n.right*g,_=n.top*g,w=b-x,A=n.bottom*g-_,S=c.get("icon-text-fit-padding")[0],k=c.get("icon-text-fit-padding")[1],z=c.get("icon-text-fit-padding")[2],I=c.get("icon-text-fit-padding")[3],B="width"===c.get("icon-text-fit")?.5*(A-v):0,C="height"===c.get("icon-text-fit")?.5*(w-N):0,E="width"===c.get("icon-text-fit")||"both"===c.get("icon-text-fit")?w:N,M="height"===c.get("icon-text-fit")||"both"===c.get("icon-text-fit")?A:v;m=new ud(x+C-I,_+B-S),D=new ud(x+C+k+E,_+B-S),O=new ud(x+C+k+E,_+B+z+M),j=new ud(x+C-I,_+B+z+M)}else m=new ud(f,h),D=new ud(d,h),O=new ud(d,y),j=new ud(f,y);var T=e.layout.get("icon-rotate").evaluate(a,{})*Pe/180;if(T){var P=De(T),V=R(T),F=[V,-P,P,V];m._matMult(F),D._matMult(F),j._matMult(F),O._matMult(F)}return[{tl:m,tr:D,bl:j,br:O,tex:o.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,n,a,0,ql(r.horizontal),g),O=a.layout.get("icon-rotate").evaluate(g,{});W=new hl(o,e,t,s,u,l,n,y,d,!1,i.overscaling,O),k=4*D.length;var Z=i.iconSizeData,U=null;"source"===Z.kind?(U=[256*a.layout.get("icon-size").evaluate(g,{})])[0]>Vl&&Fa(i.layerIds[0]+": Value for \"icon-size\" is >= 256. Reduce your \"icon-size\"."):"composite"===Z.kind&&((U=[256*b.compositeIconSizes[0].evaluate(g,{}),256*b.compositeIconSizes[1].evaluate(g,{})])[0]>Vl||U[1]>Vl)&&Fa(i.layerIds[0]+": Value for \"icon-size\" is >= 256. Reduce your \"icon-size\"."),i.addSymbols(i.icon,D,U,v,m,g,!1,t,_.lineStartIndex,_.lineLength)}var K=W?W.boxStartIndex:i.collisionBoxArray.length,q=W?W.boxEndIndex:i.collisionBoxArray.length;i.glyphOffsetArray.length>=Xs.MAX_GLYPHS&&Fa("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),i.symbolInstances.emplaceBack(t.x,t.y,0<=G.right?G.right:-1,0<=G.center?G.center:-1,0<=G.left?G.left:-1,G.vertical||-1,C,F,L,K,q,s,w,H,k,0,p,Y)}(i,d,s,e,r,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,f,g,_,o,m,x,w,c,t,n,a)};if("line"===A)for(var S=0,I=function(i,t,e,r,n){for(var a=[],o=0;o<i.length;o++)for(var d=i[o],u=void 0,g=0;g<d.length-1;g++){var m=d[g],y=d[g+1];m.x<t&&y.x<t||(m.x<t?m=new ud(t,m.y+(y.y-m.y)*((t-m.x)/(y.x-m.x)))._round():y.x<t&&(y=new ud(t,m.y+(y.y-m.y)*((t-m.x)/(y.x-m.x)))._round()),m.y<e&&y.y<e||(m.y<e?m=new ud(m.x+(y.x-m.x)*((e-m.y)/(y.y-m.y)),e)._round():y.y<e&&(y=new ud(m.x+(y.x-m.x)*((e-m.y)/(y.y-m.y)),e)._round()),m.x>=r&&y.x>=r||(m.x>=r?m=new ud(r,m.y+(y.y-m.y)*((r-m.x)/(y.x-m.x)))._round():y.x>=r&&(y=new ud(r,m.y+(y.y-m.y)*((r-m.x)/(y.x-m.x)))._round()),m.y>=n&&y.y>=n||(m.y>=n?m=new ud(m.x+(y.x-m.x)*((n-m.y)/(y.y-m.y)),n)._round():y.y>=n&&(y=new ud(m.x+(y.x-m.x)*((n-m.y)/(y.y-m.y)),n)._round()),u&&m.equals(u[u.length-1])||(u=[m],a.push(u)),u.push(y)))))}return a}(t.geometry,0,0,8192,8192);S<I.length;S+=1)for(var C=I[S],E=0,z=Sl(C,v,b,e.vertical||h,r,24,d,i.overscaling,8192),T;E<z.length;E+=1)T=z[E],h&&Nl(i,h.text,v/2,T)||k(C,T);else if("line-center"===A){for(var Y=0,W=t.geometry,F;Y<W.length;Y+=1)if(F=W[Y],1<F.length){var Q=Al(F,b,e.vertical||h,r,24,d);Q&&k(F,Q)}}else if("Polygon"===t.type)for(var D=0,$=jo(t.geometry,0);D<$.length;D+=1){var ee=$[D],U=Bl(ee,16);k(ee[0],new Fs(U.x,U.y,0))}else if("LineString"===t.type)for(var j=0,te=t.geometry,N;j<te.length;j+=1)N=te[j],k(N,new Fs(N[0].x,N[0].y,0));else if("Point"===t.type)for(var ae=0,re=t.geometry;ae<re.length;ae+=1)for(var G=0,oe=re[ae],J;G<oe.length;G+=1)J=oe[G],k([J],new Fs(J.x,J.y,0))}function Ul(i,t,e,r,n,a,o,s,u,l,p,c,h){var f=function(i,t,e,r,n,a,o){for(var s=r.layout.get("text-rotate").evaluate(a,{})*Pe/180,u=t.positionedGlyphs,l=[],p=0;p<u.length;p++){var m=u[p],h=o[m.fontStack],f=h&&h[m.glyph];if(f){var y=f.rect;if(y){var d=f.metrics.advance*m.scale/2,v=n?[m.x+d,m.y]:[0,0],g=n?[0,0]:[m.x+d+e[0],m.y+e[1]],x=(f.metrics.left-4)*m.scale-d+g[0],b=(-f.metrics.top-4)*m.scale+g[1],_=x+y.w*m.scale,w=b+y.h*m.scale,A=new ud(x,b),S=new ud(_,b),k=new ud(x,w),L=new ud(_,w);if(n&&m.vertical){var I=new ud(-d,d),z=-Pe/2,C=new ud(5,0);A._rotateAround(z,I)._add(C),S._rotateAround(z,I)._add(C),k._rotateAround(z,I)._add(C),L._rotateAround(z,I)._add(C)}if(s){var E=De(s),D=R(s),T=[D,-E,E,D];A._matMult(T),S._matMult(T),k._matMult(T),L._matMult(T)}l.push({tl:A,tr:S,bl:k,br:L,tex:y,writingMode:t.writingMode,glyphOffset:v})}}}return l}(0,e,o,r,n,a,c),y=i.textSizeData,d=null;"source"===y.kind?65535<(d=[256*r.layout.get("text-size").evaluate(a,{})])[0]&&Fa(i.layerIds[0]+": Value for \"text-size\" is >= 256. Reduce your \"text-size\"."):"composite"===y.kind&&(65535<(d=[256*h.compositeTextSizes[0].evaluate(a,{}),256*h.compositeTextSizes[1].evaluate(a,{})])[0]||65535<d[1])&&Fa(i.layerIds[0]+": Value for \"text-size\" is >= 256. Reduce your \"text-size\"."),i.addSymbols(i.text,f,d,o,n,a,u,t,s.lineStartIndex,s.lineLength);for(var x=0,_=l;x<_.length;x+=1)p[_[x]]=i.text.placedSymbolArray.length-1;return 4*f.length}function ql(a){for(var t in a)return a[t];return null}function Nl(l,t,e,r){var n=l.compareText;if(t in n){for(var i=n[t],a=i.length-1;0<=a;a--)if(r.dist(i[a])<e)return!0;}else n[t]=[];return n[t].push(r),!1}var Zl=e;e.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},e.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},e.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},e.prototype.solveCurveX=function(l,t){var d,c,p,u,g;for(void 0===t&&(t=1e-6),p=l,g=0;8>g;g++){if(u=this.sampleCurveX(p)-l,_a(u)<t)return p;var h=this.sampleCurveDerivativeX(p);if(1e-6>_a(h))break;p-=u/h}if((p=l)<(d=0))return d;if(p>(c=1))return c;for(;d<c;){if(u=this.sampleCurveX(p),_a(u-l)<t)return p;l>u?d=p:c=p,p=.5*(c-d)+d}return p},e.prototype.solve=function(a,t){return this.sampleCurveY(this.solveCurveX(a,t))};var ud=n;n.prototype={clone:function(){return new n(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(a,t){return this.clone()._rotateAround(a,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return N(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return N(this.distSqr(e))},distSqr:function(a){var t=a.x-this.x,e=a.y-this.y;return t*t+e*e},angle:function(){return L(this.y,this.x)},angleTo:function(e){return L(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(a,t){return L(this.x*t-this.y*a,this.x*a+this.y*t)},_matMult:function(a){var t=a[0]*this.x+a[1]*this.y,e=a[2]*this.x+a[3]*this.y;return this.x=t,this.y=e,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(a){var t=R(a),e=De(a),r=t*this.x-e*this.y,o=e*this.x+t*this.y;return this.x=r,this.y=o,this},_rotateAround:function(o,t){var e=R(o),r=De(o),n=t.x+e*(this.x-t.x)-r*(this.y-t.y),i=t.y+r*(this.x-t.x)+e*(this.y-t.y);return this.x=n,this.y=i,this},_round:function(){return this.x=V(this.x),this.y=V(this.y),this}},n.convert=function(e){return e instanceof n?e:Array.isArray(e)?new n(e[0],e[1]):e};var r=a(.25,.1,.25,1),i=1,u={},_=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),gd=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,hd=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,T={now:_,frame:function(a){var t=gd(a);return{cancel:function(){return hd(t)}}},getImageData:function(a){var t=self.document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("failed to create canvas 2d context");return t.width=a.width,t.height=a.height,e.drawImage(a,0,0,a.width,a.height),e.getImageData(0,0,a.width,a.height)},resolveURL:function(e){return xd||(xd=self.document.createElement("a")),xd.href=e,xd.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio}},md={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},yd={supported:!1,testSupport:function(e){F||!bd||(fd?S(e):_d=e)}},F=!1,fd=!1,xd,_d,bd;self.document&&((bd=self.document.createElement("img")).onload=function(){_d&&S(_d),_d=null,fd=!0},bd.onerror=function(){F=!0,_d=null},bd.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var vd=function(e){this._transformRequestFn=e,this._createSkuToken()};vd.prototype._createSkuToken=function(){var e=function(){for(var a="",r=0;10>r;r++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[ba(62*Math.random())];return{token:["1","01",a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},vd.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},vd.prototype.transformRequest=function(a,t){return this._transformRequestFn&&this._transformRequestFn(a,t)||{url:a}},vd.prototype.normalizeStyleURL=function(a,t){return Z(a,t)},vd.prototype.normalizeGlyphsURL=function(a,t){return G(a,t)},vd.prototype.normalizeSourceURL=function(a,t){return X(a,t)},vd.prototype.normalizeSpriteURL=function(a,t,e,r){return J(a,t,e,r)},vd.prototype.normalizeTileURL=function(a,t,e){return this._isSkuTokenExpired()&&this._createSkuToken(),Y(a,t,e,this._skuToken)},vd.prototype.canonicalizeTileURL=function(e){return W(e)},vd.prototype.canonicalizeTileset=function(a,t){return Q(a,t)};var U=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i,Z=function(a,t){if(!O(a))return a;var e=K(a);return e.path="/styles/v1"+e.path,z(e,t)},G=function(a,t){if(!O(a))return a;var e=K(a);return e.path="/fonts/v1"+e.path,z(e,t)},X=function(a,t){if(!O(a))return a;var e=K(a);return e.path="/v4/"+e.authority+".json",e.params.push("secure"),z(e,t)},J=function(a,t,e,r){var o=K(a);return O(a)?(o.path="/styles/v1"+o.path+"/sprite"+t+e,z(o,r)):(o.path+=""+t+e,rt(o))},H=/(\.(png|jpg)\d*)(?=$)/,Y=function(l,t,e,r){if(!t||!O(t))return l;var n=K(l),i=2<=T.devicePixelRatio||512===e?"@2x":"",a=yd.supported?".webp":"$1";return n.path=n.path.replace(H,""+i+a),n.path="/v4"+n.path,md.REQUIRE_ACCESS_TOKEN&&md.ACCESS_TOKEN&&r&&n.params.push("sku="+r),z(n)},$=/\.[\w]+$/,W=function(a){var t=K(a);if(!t.path.match(/(^\/v4\/)/)||!t.path.match($))return a;var e="mapbox://tiles/";e+=t.path.replace("/v4/","");var o=t.params.filter(function(e){return!e.match(/^access_token=/)});return o.length&&(e+="?"+o.join("&")),e},Q=function(l,t){if(!O(t))return l.tiles||[];for(var e=[],r=0,s=l.tiles;r<s.length;r+=1){var i=s[r],a=W(i);e.push(a)}return e},tt=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/,et=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};et.prototype.getStorageKey=function(a){var t=nt(md.ACCESS_TOKEN),r="",o;return t&&t.u?(o=t.u,r=self.btoa(encodeURIComponent(o).replace(/%([0-9A-F]{2})/g,function(a,t){return D(+("0x"+t))}))):r=md.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+r:"mapbox.eventData:"+r},et.prototype.fetchEventData=function(){var a=k("localStorage"),t=this.getStorageKey(),e=this.getStorageKey("uuid");if(a)try{var r=self.localStorage.getItem(t);r&&(this.eventData=JSON.parse(r));var o=self.localStorage.getItem(e);o&&(this.anonId=o)}catch(e){Fa("Unable to read from LocalStorage")}},et.prototype.saveEventData=function(){var a=k("localStorage"),t=this.getStorageKey(),e=this.getStorageKey("uuid");if(a)try{self.localStorage.setItem(e,this.anonId),1<=Object.keys(this.eventData).length&&self.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){Fa("Unable to write to LocalStorage")}},et.prototype.processRequests=function(){},et.prototype.postEvent=function(l,t,e){var r=this;if(md.EVENTS_URL){var n=K(md.EVENTS_URL);n.params.push("access_token="+(md.ACCESS_TOKEN||""));var i={event:this.type,created:new Date(l).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.1.1",skuId:"01",userId:this.anonId},a=t?dt(i,t):i,o={url:rt(n),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=zt(o,function(a){r.pendingRequest=null,e(a),r.saveEventData(),r.processRequests()})}},et.prototype.queueRequest=function(e){this.queue.push(e),this.processRequests()};var at=function(a){function t(){a.call(this,"map.load"),this.success={},this.skuToken=""}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.postMapLoadEvent=function(a,t,e){this.skuToken=e,md.EVENTS_URL&&md.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(e){return O(e)||q(e)})&&this.queueRequest({id:t,timestamp:Date.now()})},t.prototype.processRequests=function(){var a=this;if(!this.pendingRequest&&0!==this.queue.length){var t=this.queue.shift(),o=t.id,e=t.timestamp;o&&this.success[o]||(this.anonId||this.fetchEventData(),y(this.anonId)||(this.anonId=p()),this.postEvent(e,{skuToken:this.skuToken},function(t){t||o&&(a.success[o]=!0)}))}},t}(et),st=new(function(a){function t(){a.call(this,"appUserTurnstile")}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.postTurnstileEvent=function(e){md.EVENTS_URL&&md.ACCESS_TOKEN&&Array.isArray(e)&&e.some(function(e){return O(e)||q(e)})&&this.queueRequest(Date.now())},t.prototype.processRequests=function(){var l=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var t=nt(md.ACCESS_TOKEN),d=t?t.u:md.ACCESS_TOKEN,e=d!==this.eventData.tokenU;y(this.anonId)||(this.anonId=p(),e=!0);var r=this.queue.shift();if(this.eventData.lastSuccess){var i=new Date(this.eventData.lastSuccess),a=new Date(r),o=(r-this.eventData.lastSuccess)/864e5;e=e||1<=o||-1>o||i.getDate()!==a.getDate()}else e=!0;if(!e)return this.processRequests();this.postEvent(r,{"enabled.telemetry":!1},function(t){t||(l.eventData.lastSuccess=r,l.eventData.tokenU=d)})}},t}(et)),ut=st.postTurnstileEvent.bind(st),lt=new at,pt=lt.postMapLoadEvent.bind(lt),ct=500,kd=50,wd=1/0,Td={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"},bt;"function"==typeof Object.freeze&&Object.freeze(Td);var Ad=function(a){function t(t,o,r){401===o&&q(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,t),this.status=o,this.url=r,this.name=this.constructor.name,this.message=t}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),_t=gt()?function(){return self.worker&&self.worker.referrer}:function(){var e=self.location.origin;if(e&&"null"!==e&&"file://"!==e)return e+self.location.pathname},At=function(a,t){if(!/^file:/.test(a.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return wt(a,t);if(gt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,t)}return function(a,o){var e=new self.XMLHttpRequest;for(var t in e.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(e.responseType="arraybuffer"),a.headers)e.setRequestHeader(t,a.headers[t]);return"json"===a.type&&e.setRequestHeader("Accept","application/json"),e.withCredentials="include"===a.credentials,e.onerror=function(){o(new Error(e.statusText))},e.onload=function(){if((200<=e.status&&300>e.status||0===e.status)&&null!==e.response){var t=e.response;if("json"===a.type)try{t=JSON.parse(e.response)}catch(e){return o(e)}o(null,t,e.getResponseHeader("Cache-Control"),e.getResponseHeader("Expires"))}else o(new Ad(e.statusText,e.status,a.url))},e.send(a.body),{cancel:function(){return e.abort()}}}(a,t)},kt=function(a,t){return At(dt(a,{type:"arrayBuffer"}),t)},zt=function(a,t){return At(dt(a,{method:"POST"}),t)},It,Sd;It=[],Sd=0;var Cd=function(o,l){if(Sd>=md.MAX_PARALLEL_IMAGE_REQUESTS){var e={requestParameters:o,callback:l,cancelled:!1,cancel:function(){this.cancelled=!0}};return It.push(e),e}Sd++;var s=!1,d=function(){if(!s)for(s=!0,Sd--;It.length&&Sd<md.MAX_PARALLEL_IMAGE_REQUESTS;){var a=It.shift(),t=a.requestParameters,e=a.callback;a.cancelled||(a.cancel=Cd(t,e).cancel)}},t=kt(o,function(e,t,r,i){if(d(),e)l(e);else if(t){var a=new self.Image,o=self.URL||self.webkitURL;a.onload=function(){l(null,a),o.revokeObjectURL(a.src)},a.onerror=function(){return l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var n=new self.Blob([new Uint8Array(t)],{type:"image/png"});a.cacheControl=r,a.expires=i,a.src=t.byteLength?o.createObjectURL(n):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}});return{cancel:function(){t.cancel(),d()}}},Et=function(a,t){void 0===t&&(t={}),dt(this,t),this.type=a},Pt=function(a){function t(t,e){void 0===e&&(e={}),a.call(this,"error",dt({error:t},e))}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(Et),Vt=function(){};Vt.prototype.on=function(a,t){return this._listeners=this._listeners||{},St(a,t,this._listeners),this},Vt.prototype.off=function(a,t){return Mt(a,t,this._listeners),Mt(a,t,this._oneTimeListeners),this},Vt.prototype.once=function(a,t){return this._oneTimeListeners=this._oneTimeListeners||{},St(a,t,this._oneTimeListeners),this},Vt.prototype.fire=function(l,d){"string"==typeof l&&(l=new Et(l,d||{}));var e=l.type;if(this.listens(e)){l.target=this;for(var r=0,c=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];r<c.length;r+=1)c[r].call(this,l);for(var i=0,p=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[],o;i<p.length;i+=1)o=p[i],Mt(e,o,this._oneTimeListeners),o.call(this,l);var g=this._eventedParent;g&&(dt(l,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),g.fire(l))}else l instanceof Pt&&console.error(l.error);return this},Vt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&0<this._listeners[e].length||this._oneTimeListeners&&this._oneTimeListeners[e]&&0<this._oneTimeListeners[e].length||this._eventedParent&&this._eventedParent.listens(e)},Vt.prototype.setEventedParent=function(a,t){return this._eventedParent=a,this._eventedParentData=t,this};var Ft={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:[{"!":"text-offset"}],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:[{"!":"text-anchor"},{"!":"text-offset"},{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",requires:["text-field"],values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},Lt=function(a,t,e,r){this.message=(a?a+": ":"")+e,r&&(this.identifier=r),null!=t&&t.__line__&&(this.line=t.__line__)},Dt=function(a){function t(t,e){a.call(this,e),this.message=e,this.key=t}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(Error),Nt=function(l,t){void 0===t&&(t=[]),this.parent=l,this.bindings={};for(var s=0,d=t;s<d.length;s+=1){var n=d[s],i=n[0],a=n[1];this.bindings[i]=a}};Nt.prototype.concat=function(e){return new Nt(this,e)},Nt.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Nt.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Zt={kind:"null"},Kt={kind:"number"},Gt={kind:"string"},Xt={kind:"boolean"},Jt={kind:"color"},Ht={kind:"object"},Yt={kind:"value"},$t={kind:"collator"},Wt={kind:"formatted"},Qt=[Zt,Kt,Gt,Xt,Jt,Wt,Ht,qt(Yt)],re=t(function(l,t){function e(e){return 0>(e=V(e))?0:255<e?255:e}function n(e){return 0>e?0:1<e?1:e}function i(a){return"%"===a[a.length-1]?e(255*(parseFloat(a)/100)):e(parseInt(a))}function a(e){return"%"===e[e.length-1]?n(parseFloat(e)/100):n(parseFloat(e))}function o(a,t,e){return 0>e?e+=1:1<e&&(e-=1),1>6*e?a+6*((t-a)*e):1>2*e?t:2>3*e?a+6*((t-a)*(2/3-e)):a}var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{t.parseCSSColor=function(r){var t=r.replace(/ /g,"").toLowerCase(),n;if(t in s)return s[t].slice();if("#"===t[0])return 4===t.length?0<=(n=parseInt(t.substr(1),16))&&4095>=n?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:7===t.length&&0<=(n=parseInt(t.substr(1),16))&&16777215>=n?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var g=t.indexOf("("),u=t.indexOf(")");if(-1!==g&&u+1===t.length){var l=t.substr(0,g),p=t.substr(g+1,u-(g+1)).split(","),c=1;switch(l){case"rgba":if(4!==p.length)return null;c=a(p.pop());case"rgb":return 3===p.length?[i(p[0]),i(p[1]),i(p[2]),c]:null;case"hsla":if(4!==p.length)return null;c=a(p.pop());case"hsl":if(3!==p.length)return null;var x=(parseFloat(p[0])%360+360)%360/360,f=a(p[1]),y=a(p[2]),d=.5>=y?y*(f+1):y+f-y*f,m=2*y-d;return[e(255*o(m,d,x+1/3)),e(255*o(m,d,x)),e(255*o(m,d,x-1/3)),c];default:return null;}}return null}}catch(e){}}).parseCSSColor,ie=function(a,t,e,r){void 0===r&&(r=1),this.r=a,this.g=t,this.b=e,this.a=r};ie.parse=function(a){if(a){if(a instanceof ie)return a;if("string"==typeof a){var t=re(a);if(t)return new ie(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ie.prototype.toString=function(){var a=this.toArray(),t=a[0],e=a[1],r=a[2],o=a[3];return"rgba("+V(t)+","+V(e)+","+V(r)+","+o+")"},ie.prototype.toArray=function(){var a=this.r,t=this.g,e=this.b,r=this.a;return 0===r?[0,0,0,0]:[255*a/r,255*t/r,255*e/r,r]},ie.black=new ie(0,0,0,1),ie.white=new ie(1,1,1,1),ie.transparent=new ie(0,0,0,0),ie.red=new ie(1,0,0,1);var ae=function(a,t,e){this.sensitivity=a?t?"variant":"case":t?"accent":"base",this.locale=e,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ae.prototype.compare=function(a,t){return this.collator.compare(a,t)},ae.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var oe=function(a,t,e){this.text=a,this.scale=t,this.fontStack=e},se=function(e){this.sections=e};se.fromString=function(e){return new se([new oe(e,null,null)])},se.prototype.toString=function(){return this.sections.map(function(e){return e.text}).join("")},se.prototype.serialize=function(){for(var a=["format"],t=0,o=this.sections,r;t<o.length;t+=1){r=o[t],a.push(r.text);var l={};r.fontStack&&(l["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(l["font-scale"]=r.scale),a.push(l)}return a};var ue=function(a,t){this.type=a,this.value=t};ue.parse=function(a,t){if(2!==a.length)return t.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!function a(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof ie)return!0;if(t instanceof ae)return!0;if(t instanceof se)return!0;if(Array.isArray(t)){for(var e=0,o=t;e<o.length;e+=1)if(!a(o[e]))return!1;return!0}if("object"==typeof t){for(var n in t)if(!a(t[n]))return!1;return!0}return!1}(a[1]))return t.error("invalid value");var e=a[1],r=le(e),o=t.expectedType;return"array"!==r.kind||0!==r.N||!o||"array"!==o.kind||"number"==typeof o.N&&0!==o.N||(r=o),new ue(r,e)},ue.prototype.evaluate=function(){return this.value},ue.prototype.eachChild=function(){},ue.prototype.possibleOutputs=function(){return[this.value]},ue.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ie?["rgba"].concat(this.value.toArray()):this.value instanceof se?this.value.serialize():this.value};var he=function(e){this.name="ExpressionEvaluationError",this.message=e};he.prototype.toJSON=function(){return this.message};var fe={string:Gt,number:Kt,boolean:Xt,object:Ht},ye=function(a,t){this.type=a,this.args=t};ye.parse=function(d,t){if(2>d.length)return t.error("Expected at least one argument.");var e=1,c=d[0],i;if("array"===c){var p,g;if(2<d.length){var h=d[1];if("string"!=typeof h||!(h in fe)||"object"===h)return t.error("The item type argument of \"array\" must be one of string, number, boolean",1);p=fe[h],e++}else p=Yt;if(3<d.length){if(null!==d[2]&&("number"!=typeof d[2]||0>d[2]||d[2]!==ba(d[2])))return t.error("The length argument to \"array\" must be a positive integer literal",2);g=d[2],e++}i=qt(p,g)}else i=fe[c];for(var s=[],u;e<d.length;e++){if(u=t.parse(d[e],e,Yt),!u)return null;s.push(u)}return new ye(i,s)},ye.prototype.evaluate=function(a){for(var t=0,o;t<this.args.length;t++){if(o=this.args[t].evaluate(a),!ee(this.type,le(o)))return o;if(t==this.args.length-1)throw new he("Expected value to be of type "+te(this.type)+", but found "+te(le(o))+" instead.")}return null},ye.prototype.eachChild=function(e){this.args.forEach(e)},ye.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}))},ye.prototype.serialize=function(){var a=this.type,t=[a.kind];if("array"===a.kind){var e=a.itemType;if("string"===e.kind||"number"===e.kind||"boolean"===e.kind){t.push(e.kind);var r=a.N;("number"==typeof r||1<this.args.length)&&t.push(r)}}return t.concat(this.args.map(function(e){return e.serialize()}))};var de=function(e){this.type=Wt,this.sections=e};de.parse=function(l,t){if(3>l.length)return t.error("Expected at least two arguments.");if(0!=(l.length-1)%2)return t.error("Expected an even number of arguments.");for(var e=[],r=1,d;r<l.length-1;r+=2){if(d=t.parse(l[r],1,Yt),!d)return null;var c=d.type.kind;if("string"!==c&&"value"!==c&&"null"!==c)return t.error("Formatted text type must be 'string', 'value', or 'null'.");var a=l[r+1];if("object"!=typeof a||Array.isArray(a))return t.error("Format options argument must be an object.");var o=null;if(a["font-scale"]&&!(o=t.parse(a["font-scale"],1,Kt)))return null;var p=null;if(a["text-font"]&&!(p=t.parse(a["text-font"],1,qt(Gt))))return null;e.push({text:d,scale:o,font:p})}return new de(e)},de.prototype.evaluate=function(a){return new se(this.sections.map(function(t){return new oe(pe(t.text.evaluate(a)),t.scale?t.scale.evaluate(a):null,t.font?t.font.evaluate(a).join(","):null)}))},de.prototype.eachChild=function(a){for(var t=0,o=this.sections,r;t<o.length;t+=1)r=o[t],a(r.text),r.scale&&a(r.scale),r.font&&a(r.font)},de.prototype.possibleOutputs=function(){return[void 0]},de.prototype.serialize=function(){for(var a=["format"],t=0,o=this.sections,r;t<o.length;t+=1){r=o[t],a.push(r.text.serialize());var l={};r.scale&&(l["font-scale"]=r.scale.serialize()),r.font&&(l["text-font"]=r.font.serialize()),a.push(l)}return a};var me={"to-boolean":Xt,"to-color":Jt,"to-number":Kt,"to-string":Gt},ve=function(a,t){this.type=a,this.args=t};ve.parse=function(l,t){if(2>l.length)return t.error("Expected at least one argument.");var e=l[0];if(("to-boolean"===e||"to-string"===e)&&2!==l.length)return t.error("Expected one argument.");for(var r=me[e],n=[],i=1,s;i<l.length;i++){if(s=t.parse(l[i],i,Yt),!s)return null;n.push(s)}return new ve(r,n)},ve.prototype.evaluate=function(d){if("boolean"===this.type.kind)return!!this.args[0].evaluate(d);if("color"===this.type.kind){for(var t=0,c=this.args,i,p;t<c.length;t+=1){if(p=null,(i=c[t].evaluate(d))instanceof ie)return i;if("string"==typeof i){var g=d.parseColor(i);if(g)return g}else if(Array.isArray(i)&&!(p=3>i.length||4<i.length?"Invalid rbga value "+JSON.stringify(i)+": expected an array containing either three or four numeric values.":ne(i[0],i[1],i[2],i[3])))return new ie(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new he(p||"Could not parse color from value '"+("string"==typeof i?i:JSON.stringify(i)+"")+"'")}if("number"===this.type.kind){for(var a=null,h=0,m=this.args;h<m.length;h+=1){if(null===(a=m[h].evaluate(d)))return 0;var u=+a;if(!isNaN(u))return u}throw new he("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?se.fromString(pe(this.args[0].evaluate(d))):pe(this.args[0].evaluate(d))},ve.prototype.eachChild=function(e){this.args.forEach(e)},ve.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}))},ve.prototype.serialize=function(){if("formatted"===this.type.kind)return new de([{text:this.args[0],scale:null,font:null}]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(t){a.push(t.serialize())}),a};var ge=["Unknown","Point","LineString","Polygon"],xe=function(){this.globals=null,this.feature=null,this.featureState=null,this._parseColorCache={}};xe.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},xe.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ge[this.feature.type]:this.feature.type:null},xe.prototype.properties=function(){return this.feature&&this.feature.properties||{}},xe.prototype.parseColor=function(a){var t=this._parseColorCache[a];return t||(t=this._parseColorCache[a]=ie.parse(a)),t};var be=function(a,t,e,r){this.name=a,this.type=t,this._evaluate=e,this.args=r};be.prototype.evaluate=function(e){return this._evaluate(e,this.args)},be.prototype.eachChild=function(e){this.args.forEach(e)},be.prototype.possibleOutputs=function(){return[void 0]},be.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},be.parse=function(T,t){var e=T[0],n=be.definitions[e],i;if(!n)return t.error("Unknown expression \""+e+"\". If you wanted a literal array, use [\"literal\", [...]].",0);for(var C=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=a.filter(function(t){var e=t[0];return!Array.isArray(e)||e.length===T.length-1}),s=null,L=0,E=o;L<E.length;L+=1){var p=E[L],c=p[0],h=p[1];s=new ze(t.registry,t.path,null,t.scope);for(var f=[],y=!1,I=1;I<T.length;I++){var P=T[I],v=Array.isArray(c)?c[I-1]:c.type,g=s.parse(P,1+f.length,v);if(!g){y=!0;break}f.push(g)}if(!y)if(Array.isArray(c)&&c.length!==f.length)s.error("Expected "+c.length+" arguments, but found "+f.length+" instead.");else{for(var x=0;x<f.length;x++){var D=Array.isArray(c)?c[x]:c.type,_=f[x];s.concat(x+1).checkSubtype(D,_.type)}if(0===s.errors.length)return new be(e,C,h,f)}}if(1===o.length)(i=t.errors).push.apply(i,s.errors);else{for(var w=(o.length?o:a).map(function(a){var t=a[0],r;return r=t,Array.isArray(r)?"("+r.map(te).join(", ")+")":"("+te(r.type)+"...)"}).join(" | "),A=[],S=1,O;S<T.length;S++){if(O=t.parse(T[S],1+A.length),!O)return null;A.push(te(O.type))}t.error("Expected arguments of type "+w+", but found ("+A.join(", ")+") instead.")}return null},be.register=function(a,t){for(var e in be.definitions=t,t)a[e]=be};var _e=function(a,t,e){this.type=$t,this.locale=e,this.caseSensitive=a,this.diacriticSensitive=t};_e.parse=function(o,t){if(2!==o.length)return t.error("Expected one argument.");var e=o[1];if("object"!=typeof e||Array.isArray(e))return t.error("Collator options argument must be an object.");var r=t.parse(void 0!==e["case-sensitive"]&&e["case-sensitive"],1,Xt);if(!r)return null;var n=t.parse(void 0!==e["diacritic-sensitive"]&&e["diacritic-sensitive"],1,Xt);if(!n)return null;var i=null;return e.locale&&!(i=t.parse(e.locale,1,Gt))?null:new _e(r,n,i)},_e.prototype.evaluate=function(e){return new ae(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},_e.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},_e.prototype.possibleOutputs=function(){return[void 0]},_e.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var we=function(a,t){this.type=t.type,this.name=a,this.boundExpression=t};we.parse=function(a,t){if(2!==a.length||"string"!=typeof a[1])return t.error("'var' expression requires exactly one string literal argument.");var e=a[1];return t.scope.has(e)?new we(e,t.scope.get(e)):t.error("Unknown variable \""+e+"\". Make sure \""+e+"\" has been bound in an enclosing \"let\" expression before using it.",1)},we.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},we.prototype.eachChild=function(){},we.prototype.possibleOutputs=function(){return[void 0]},we.prototype.serialize=function(){return["var",this.name]};var ze=function(a,t,o,r,l){void 0===t&&(t=[]),void 0===r&&(r=new Nt),void 0===l&&(l=[]),this.registry=a,this.path=t,this.key=t.map(function(e){return"["+e+"]"}).join(""),this.scope=r,this.errors=l,this.expectedType=o};ze.prototype.parse=function(a,t,e,r,o){return void 0===o&&(o={}),t?this.concat(t,e,r)._parse(a,o):this._parse(a,o)},ze.prototype._parse=function(l,d){function e(a,t,e){return"assert"===e?new ye(t,[a]):"coerce"===e?new ve(t,[a]):a}if(null!==l&&"string"!=typeof l&&"boolean"!=typeof l&&"number"!=typeof l||(l=["literal",l]),Array.isArray(l)){if(0===l.length)return this.error("Expected an array with at least one element. If you wanted a literal array, use [\"literal\", []].");var r=l[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+" instead. If you wanted a literal array, use [\"literal\", [...]].",0),null;var n=this.registry[r];if(n){var i=n.parse(l,this);if(!i)return null;if(this.expectedType){var c=this.expectedType,o=i.type;if(("string"===c.kind||"number"===c.kind||"boolean"===c.kind||"object"===c.kind||"array"===c.kind)&&"value"===o.kind)i=e(i,c,d.typeAnnotation||"assert");else if(("color"===c.kind||"formatted"===c.kind)&&("value"===o.kind||"string"===o.kind))i=e(i,c,d.typeAnnotation||"coerce");else if(this.checkSubtype(c,o))return null}if(!(i instanceof ue)&&function a(t){if(t instanceof we)return a(t.boundExpression);if(t instanceof be&&"error"===t.name)return!1;if(t instanceof _e)return!1;var r=!0;return t.eachChild(function(t){r=t instanceof ve||t instanceof ye?r&&a(t):r&&t instanceof ue}),!!r&&ce(t)&&Se(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(i)){var s=new xe;try{i=new ue(i.type,i.evaluate(s))}catch(e){return this.error(e.message),null}}return i}return this.error("Unknown expression \""+r+"\". If you wanted a literal array, use [\"literal\", [...]].",0)}return void 0===l?this.error("'undefined' value invalid. Use null instead."):"object"==typeof l?this.error("Bare objects invalid. Use [\"literal\", {...}] instead."):this.error("Expected an array, but found "+typeof l+" instead.")},ze.prototype.concat=function(a,t,e){var r="number"==typeof a?this.path.concat(a):this.path,o=e?this.scope.concat(e):this.scope;return new ze(this.registry,r,t||null,o,this.errors)},ze.prototype.error=function(a){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];var o=""+this.key+t.map(function(e){return"["+e+"]"}).join("");this.errors.push(new Dt(o,a))},ze.prototype.checkSubtype=function(a,t){var e=ee(a,t);return e&&this.error(e),e};var Ie=function(l,t,e){this.type=l,this.input=t,this.labels=[],this.outputs=[];for(var r=0,d=e;r<d.length;r+=1){var i=d[r],a=i[0],o=i[1];this.labels.push(a),this.outputs.push(o)}};Ie.parse=function(d,t){if(4>d.length-1)return t.error("Expected at least 4 arguments, but found only "+(d.length-1)+".");if(0!=(d.length-1)%2)return t.error("Expected an even number of arguments.");var e=t.parse(d[1],1,Kt);if(!e)return null;var r=[],n=null;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var c=1;c<d.length;c+=2){var g=1==c?-1/0:d[c],o=d[c+1],s=c,u=c+1;if("number"!=typeof g)return t.error("Input/output pairs for \"step\" expressions must be defined using literal numeric values (not computed expressions) for the input values.",s);if(r.length&&r[r.length-1][0]>=g)return t.error("Input/output pairs for \"step\" expressions must be arranged with input values in strictly ascending order.",s);var l=t.parse(o,u,n);if(!l)return null;n=n||l.type,r.push([g,l])}return new Ie(n,e,r)},Ie.prototype.evaluate=function(a){var t=this.labels,e=this.outputs;if(1===t.length)return e[0].evaluate(a);var r=this.input.evaluate(a);if(r<=t[0])return e[0].evaluate(a);var o=t.length;return r>=t[o-1]?e[o-1].evaluate(a):e[ke(t,r)].evaluate(a)},Ie.prototype.eachChild=function(a){a(this.input);for(var t=0,o=this.outputs;t<o.length;t+=1)a(o[t])},Ie.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}))},Ie.prototype.serialize=function(){for(var a=["step",this.input.serialize()],t=0;t<this.labels.length;t++)0<t&&a.push(this.labels[t]),a.push(this.outputs[t].serialize());return a};var Ce=Object.freeze({number:Be,color:function(a,t,e){return new ie(Be(a.r,t.r,e),Be(a.g,t.g,e),Be(a.b,t.b,e),Be(a.a,t.a,e))},array:function(a,o,e){return a.map(function(a,t){return Be(a,o[t],e)})}}),Me=.95047,Te=1.08883,Ve=4/29,Fe=6/29,Le=3*Fe*Fe,Ld=Fe*Fe*Fe,Oe={forward:Ze,reverse:Ke,interpolate:function(a,t,e){return{l:Be(a.l,t.l,e),a:Be(a.a,t.a,e),b:Be(a.b,t.b,e),alpha:Be(a.alpha,t.alpha,e)}}},Je={forward:function(o){var t=Ze(o),e=t.l,r=t.a,n=t.b,i=L(n,r)*(180/Pe);return{h:0>i?i+360:i,c:N(r*r+n*n),l:e,alpha:o.a}},reverse:function(a){var t=a.h*(Pe/180),e=a.c;return Ke({l:a.l,a:R(t)*e,b:De(t)*e,alpha:a.alpha})},interpolate:function(a,t,e){return{h:Ge(a.h,t.h,e),c:Be(a.c,t.c,e),l:Be(a.l,t.l,e),alpha:Be(a.alpha,t.alpha,e)}}},He=Object.freeze({lab:Oe,hcl:Je}),Ye=function(d,t,e,r,n){this.type=d,this.operator=t,this.interpolation=e,this.input=r,this.labels=[],this.outputs=[];for(var i=0,c=n;i<c.length;i+=1){var o=c[i],s=o[0],p=o[1];this.labels.push(s),this.outputs.push(p)}};Ye.interpolationFactor=function(r,t,e,n){var i=0;if("exponential"===r.name)i=Xe(t,r.base,e,n);else if("linear"===r.name)i=Xe(t,1,e,n);else if("cubic-bezier"===r.name){var l=r.controlPoints;i=new Zl(l[0],l[1],l[2],l[3]).solve(Xe(t,1,e,n))}return i},Ye.parse=function(g,t){var e=g[0],r=g[1],m=g[2],x=g.slice(3);if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return t.error("Unknown interpolation type "+(r[0]+""),1,0);var o=r.slice(1);if(4!==o.length||o.some(function(e){return"number"!=typeof e||0>e||1<e}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:o}}if(4>g.length-1)return t.error("Expected at least 4 arguments, but found only "+(g.length-1)+".");if(0!=(g.length-1)%2)return t.error("Expected an even number of arguments.");if(!(m=t.parse(m,2,Kt)))return null;var s=[],u=null;"interpolate-hcl"===e||"interpolate-lab"===e?u=Jt:t.expectedType&&"value"!==t.expectedType.kind&&(u=t.expectedType);for(var _=0;_<x.length;_+=2){var b=x[_],c=x[_+1],h=_+3,f=_+4;if("number"!=typeof b)return t.error("Input/output pairs for \"interpolate\" expressions must be defined using literal numeric values (not computed expressions) for the input values.",h);if(s.length&&s[s.length-1][0]>=b)return t.error("Input/output pairs for \"interpolate\" expressions must be arranged with input values in strictly ascending order.",h);var y=t.parse(c,f,u);if(!y)return null;u=u||y.type,s.push([b,y])}return"number"===u.kind||"color"===u.kind||"array"===u.kind&&"number"===u.itemType.kind&&"number"==typeof u.N?new Ye(u,e,r,m,s):t.error("Type "+te(u)+" is not interpolatable.")},Ye.prototype.evaluate=function(d){var t=this.labels,e=this.outputs;if(1===t.length)return e[0].evaluate(d);var r=this.input.evaluate(d);if(r<=t[0])return e[0].evaluate(d);var n=t.length;if(r>=t[n-1])return e[n-1].evaluate(d);var i=ke(t,r),a=t[i],o=t[i+1],s=Ye.interpolationFactor(this.interpolation,r,a,o),c=e[i].evaluate(d),l=e[i+1].evaluate(d);return"interpolate"===this.operator?Ce[this.type.kind.toLowerCase()](c,l,s):"interpolate-hcl"===this.operator?Je.reverse(Je.interpolate(Je.forward(c),Je.forward(l),s)):Oe.reverse(Oe.interpolate(Oe.forward(c),Oe.forward(l),s))},Ye.prototype.eachChild=function(a){a(this.input);for(var t=0,o=this.outputs;t<o.length;t+=1)a(o[t])},Ye.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}))},Ye.prototype.serialize=function(){var a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,a,this.input.serialize()],e=0;e<this.labels.length;e++)t.push(this.labels[e],this.outputs[e].serialize());return t};var $e=function(a,t){this.type=a,this.args=t};$e.parse=function(d,t){if(2>d.length)return t.error("Expectected at least one argument.");var e=null,c=t.expectedType;c&&"value"!==c.kind&&(e=c);for(var n=[],i=0,p=d.slice(1);i<p.length;i+=1){var o=p[i],s=t.parse(o,1+n.length,e,void 0,{typeAnnotation:"omit"});if(!s)return null;e=e||s.type,n.push(s)}var u=c&&n.some(function(e){return ee(c,e.type)});return new $e(u?Yt:e,n)},$e.prototype.evaluate=function(a){for(var t=null,o=0,i=this.args;o<i.length&&null===(t=i[o].evaluate(a));o+=1);return t},$e.prototype.eachChild=function(e){this.args.forEach(e)},$e.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}))},$e.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(t){a.push(t.serialize())}),a};var Qe=function(a,t){this.type=t.type,this.bindings=[].concat(a),this.result=t};Qe.prototype.evaluate=function(e){return this.result.evaluate(e)},Qe.prototype.eachChild=function(a){for(var t=0,o=this.bindings;t<o.length;t+=1)a(o[t][1]);a(this.result)},Qe.parse=function(l,t){if(4>l.length)return t.error("Expected at least 3 arguments, but found "+(l.length-1)+" instead.");for(var e=[],r=1,s;r<l.length-1;r+=2){if(s=l[r],"string"!=typeof s)return t.error("Expected string, but found "+typeof s+" instead.",r);if(/[^a-zA-Z0-9_]/.test(s))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);var d=t.parse(l[r+1],r+1);if(!d)return null;e.push([s,d])}var a=t.parse(l[l.length-1],l.length-1,t.expectedType,e);return a?new Qe(e,a):null},Qe.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Qe.prototype.serialize=function(){for(var o=["let"],t=0,l=this.bindings;t<l.length;t+=1){var r=l[t],n=r[0],i=r[1];o.push(n,i.serialize())}return o.push(this.result.serialize()),o};var tr=function(a,t,e){this.type=a,this.index=t,this.input=e};tr.parse=function(a,t){if(3!==a.length)return t.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1,Kt),r=t.parse(a[2],2,qt(t.expectedType||Yt));if(!e||!r)return null;var o=r.type;return new tr(o.itemType,e,r)},tr.prototype.evaluate=function(a){var t=this.index.evaluate(a),e=this.input.evaluate(a);if(0>t)throw new he("Array index out of bounds: "+t+" < 0.");if(t>=e.length)throw new he("Array index out of bounds: "+t+" > "+(e.length-1)+".");if(t!==ba(t))throw new he("Array index must be an integer, but found "+t+" instead.");return e[t]},tr.prototype.eachChild=function(e){e(this.index),e(this.input)},tr.prototype.possibleOutputs=function(){return[void 0]},tr.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var er=function(o,t,e,r,n,i){this.inputType=o,this.type=t,this.input=e,this.cases=r,this.outputs=n,this.otherwise=i};er.parse=function(g,t){var e=Number.MAX_SAFE_INTEGER;if(5>g.length)return t.error("Expected at least 4 arguments, but found only "+(g.length-1)+".");if(1!=g.length%2)return t.error("Expected an even number of arguments.");var m,x;t.expectedType&&"value"!==t.expectedType.kind&&(x=t.expectedType);for(var _={},i=[],a=2;a<g.length-1;a+=2){var b=g[a],v=g[a+1];Array.isArray(b)||(b=[b]);var u=t.concat(a);if(0===b.length)return u.error("Expected at least one branch label.");for(var l=0,k=b,c;l<k.length;l+=1){if(c=k[l],"number"!=typeof c&&"string"!=typeof c)return u.error("Branch labels must be numbers or strings.");if("number"==typeof c&&_a(c)>e)return u.error("Branch labels must be integers no larger than "+e+".");if("number"==typeof c&&ba(c)!==c)return u.error("Numeric branch labels must be integer values.");if(!m)m=le(c);else if(u.checkSubtype(m,le(c)))return null;if(void 0!==_[c+""])return u.error("Branch labels must be unique.");_[c+""]=i.length}var w=t.parse(v,a,x);if(!w)return null;x=x||w.type,i.push(w)}var f=t.parse(g[1],1,Yt);if(!f)return null;var y=t.parse(g[g.length-1],g.length-1,x);return y?"value"!==f.type.kind&&t.concat(1).checkSubtype(m,f.type)?null:new er(m,x,f,_,i,y):null},er.prototype.evaluate=function(a){var t=this.input.evaluate(a);return(le(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(a)},er.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},er.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},er.prototype.serialize=function(){for(var d=this,t=["match",this.input.serialize()],e=[],r={},n=0,g=Object.keys(this.cases).sort(),a;n<g.length;n+=1)a=g[n],void 0===(p=r[this.cases[a]])?(r[this.cases[a]]=e.length,e.push([this.cases[a],[a]])):e[p][1].push(a);for(var m=function(t){return"number"===d.inputType.kind?+t:t},s=0,y=e;s<y.length;s+=1){var l=y[s],p=l[0],f=l[1];1===f.length?t.push(m(f[0])):t.push(f.map(m)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var rr=function(a,t,e){this.type=a,this.branches=t,this.otherwise=e};rr.parse=function(l,t){if(4>l.length)return t.error("Expected at least 3 arguments, but found only "+(l.length-1)+".");if(0!=l.length%2)return t.error("Expected an odd number of arguments.");var e;t.expectedType&&"value"!==t.expectedType.kind&&(e=t.expectedType);for(var d=[],n=1,c;n<l.length-1;n+=2){if(c=t.parse(l[n],n,Xt),!c)return null;var p=t.parse(l[n+1],n+1,e);if(!p)return null;d.push([c,p]),e=e||p.type}var o=t.parse(l[l.length-1],l.length-1,e);return o?new rr(e,d,o):null},rr.prototype.evaluate=function(o){for(var t=0,l=this.branches;t<l.length;t+=1){var r=l[t],n=r[0],i=r[1];if(n.evaluate(o))return i.evaluate(o)}return this.otherwise.evaluate(o)},rr.prototype.eachChild=function(o){for(var t=0,l=this.branches;t<l.length;t+=1){var r=l[t],n=r[0],i=r[1];o(n),o(i)}o(this.otherwise)},rr.prototype.possibleOutputs=function(){var e;return(e=[]).concat.apply(e,this.branches.map(function(e){return e[0],e[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},rr.prototype.serialize=function(){var a=["case"];return this.eachChild(function(t){a.push(t.serialize())}),a};var nr=qa("==",function(a,t,e){return t===e},Ua),sr=qa("!=",function(a,t,e){return t!==e},function(a,t,e,r){return!Ua(0,t,e,r)}),ur=qa("<",function(a,t,e){return t<e},function(a,t,e,r){return 0>r.compare(t,e)}),lr=qa(">",function(a,t,e){return t>e},function(a,t,e,r){return 0<r.compare(t,e)}),pr=qa("<=",function(a,t,e){return t<=e},function(a,t,e,r){return 0>=r.compare(t,e)}),cr=qa(">=",function(a,t,e){return t>=e},function(a,t,e,r){return 0<=r.compare(t,e)}),hr=function(a,t,e,r,o){this.type=Gt,this.number=a,this.locale=t,this.currency=e,this.minFractionDigits=r,this.maxFractionDigits=o};hr.parse=function(l,t){if(3!==l.length)return t.error("Expected two arguments.");var e=t.parse(l[1],1,Kt);if(!e)return null;var r=l[2];if("object"!=typeof r||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");var n=null;if(r.locale&&!(n=t.parse(r.locale,1,Gt)))return null;var d=null;if(r.currency&&!(d=t.parse(r.currency,1,Gt)))return null;var c=null;if(r["min-fraction-digits"]&&!(c=t.parse(r["min-fraction-digits"],1,Kt)))return null;var p=null;return r["max-fraction-digits"]&&!(p=t.parse(r["max-fraction-digits"],1,Kt))?null:new hr(e,n,d,c,p)},hr.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},hr.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},hr.prototype.possibleOutputs=function(){return[void 0]},hr.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var fr=function(e){this.type=Kt,this.input=e};fr.parse=function(a,t){if(2!==a.length)return t.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1);return e?"array"!==e.type.kind&&"string"!==e.type.kind&&"value"!==e.type.kind?t.error("Expected argument of type string or array, but found "+te(e.type)+" instead."):new fr(e):null},fr.prototype.evaluate=function(a){var t=this.input.evaluate(a);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new he("Expected value to be of type string or array, but found "+te(le(t))+" instead.")},fr.prototype.eachChild=function(e){e(this.input)},fr.prototype.possibleOutputs=function(){return[void 0]},fr.prototype.serialize=function(){var a=["length"];return this.eachChild(function(t){a.push(t.serialize())}),a};var yr={"==":nr,"!=":sr,">":lr,"<":ur,">=":cr,"<=":pr,array:ye,at:tr,boolean:ye,case:rr,coalesce:$e,collator:_e,format:de,interpolate:Ye,"interpolate-hcl":Ye,"interpolate-lab":Ye,length:fr,let:Qe,literal:ue,match:er,number:ye,"number-format":hr,object:ye,step:Ie,string:ye,"to-boolean":ve,"to-color":ve,"to-number":ve,"to-string":ve,var:we};be.register(yr,{error:[{kind:"error"},[Gt],function(a,t){var e=t[0];throw new he(e.evaluate(a))}],typeof:[Gt,[Yt],function(a,t){return te(le(t[0].evaluate(a)))}],"to-rgba":[qt(Kt,4),[Jt],function(a,t){return t[0].evaluate(a).toArray()}],rgb:[Jt,[Kt,Kt,Kt],Wa],rgba:[Jt,[Kt,Kt,Kt,Kt],Wa],has:{type:Xt,overloads:[[[Gt],function(a,t){return Ka(t[0].evaluate(a),a.properties())}],[[Gt,Ht],function(a,t){var e=t[0],r=t[1];return Ka(e.evaluate(a),r.evaluate(a))}]]},get:{type:Yt,overloads:[[[Gt],function(a,t){return ar(t[0].evaluate(a),a.properties())}],[[Gt,Ht],function(a,t){var e=t[0],r=t[1];return ar(e.evaluate(a),r.evaluate(a))}]]},"feature-state":[Yt,[Gt],function(a,t){return ar(t[0].evaluate(a),a.featureState||{})}],properties:[Ht,[],function(e){return e.properties()}],"geometry-type":[Gt,[],function(e){return e.geometryType()}],id:[Yt,[],function(e){return e.id()}],zoom:[Kt,[],function(e){return e.globals.zoom}],"heatmap-density":[Kt,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Kt,[],function(e){return e.globals.lineProgress||0}],accumulated:[Yt,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[Kt,or(Kt),function(a,t){for(var e=0,o=0,l=t;o<l.length;o+=1)e+=l[o].evaluate(a);return e}],"*":[Kt,or(Kt),function(a,t){for(var e=1,o=0,l=t;o<l.length;o+=1)e*=l[o].evaluate(a);return e}],"-":{type:Kt,overloads:[[[Kt,Kt],function(a,t){var e=t[0],r=t[1];return e.evaluate(a)-r.evaluate(a)}],[[Kt],function(a,t){return-t[0].evaluate(a)}]]},"/":[Kt,[Kt,Kt],function(a,t){var e=t[0],r=t[1];return e.evaluate(a)/r.evaluate(a)}],"%":[Kt,[Kt,Kt],function(a,t){var e=t[0],r=t[1];return e.evaluate(a)%r.evaluate(a)}],ln2:[Kt,[],function(){return E}],pi:[Kt,[],function(){return Pe}],e:[Kt,[],function(){var e=Math.E;return e}],"^":[Kt,[Kt,Kt],function(a,t){var e=t[0],r=t[1];return ya(e.evaluate(a),r.evaluate(a))}],sqrt:[Kt,[Kt],function(a,t){var e=t[0];return N(e.evaluate(a))}],log10:[Kt,[Kt],function(a,t){var e=t[0];return P(e.evaluate(a))/I}],ln:[Kt,[Kt],function(a,t){var e=t[0];return P(e.evaluate(a))}],log2:[Kt,[Kt],function(a,t){var e=t[0];return P(e.evaluate(a))/E}],sin:[Kt,[Kt],function(a,t){var e=t[0];return De(e.evaluate(a))}],cos:[Kt,[Kt],function(a,t){var e=t[0];return R(e.evaluate(a))}],tan:[Kt,[Kt],function(a,t){var e=t[0];return fa(e.evaluate(a))}],asin:[Kt,[Kt],function(a,t){var e=t[0];return o(e.evaluate(a))}],acos:[Kt,[Kt],function(a,t){var e=t[0];return d(e.evaluate(a))}],atan:[Kt,[Kt],function(a,t){var e=t[0];return xa(e.evaluate(a))}],min:[Kt,or(Kt),function(a,t){return ea.apply(Math,t.map(function(t){return t.evaluate(a)}))}],max:[Kt,or(Kt),function(a,t){return va.apply(Math,t.map(function(t){return t.evaluate(a)}))}],abs:[Kt,[Kt],function(a,t){var e=t[0];return _a(e.evaluate(a))}],round:[Kt,[Kt],function(a,t){var e=t[0].evaluate(a);return 0>e?-V(-e):V(e)}],floor:[Kt,[Kt],function(a,t){var e=t[0];return ba(e.evaluate(a))}],ceil:[Kt,[Kt],function(a,t){var e=t[0];return M(e.evaluate(a))}],"filter-==":[Xt,[Gt,Yt],function(a,t){var e=t[0],r=t[1];return a.properties()[e.value]===r.value}],"filter-id-==":[Xt,[Yt],function(a,t){var e=t[0];return a.id()===e.value}],"filter-type-==":[Xt,[Gt],function(a,t){var e=t[0];return a.geometryType()===e.value}],"filter-<":[Xt,[Gt,Yt],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[Xt,[Yt],function(a,t){var e=t[0],r=a.id(),o=e.value;return typeof r==typeof o&&r<o}],"filter->":[Xt,[Gt,Yt],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[Xt,[Yt],function(a,t){var e=t[0],r=a.id(),o=e.value;return typeof r==typeof o&&r>o}],"filter-<=":[Xt,[Gt,Yt],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[Xt,[Yt],function(a,t){var e=t[0],r=a.id(),o=e.value;return typeof r==typeof o&&r<=o}],"filter->=":[Xt,[Gt,Yt],function(o,t){var e=t[0],r=t[1],n=o.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[Xt,[Yt],function(a,t){var e=t[0],r=a.id(),o=e.value;return typeof r==typeof o&&r>=o}],"filter-has":[Xt,[Yt],function(a,t){return t[0].value in a.properties()}],"filter-has-id":[Xt,[],function(e){return null!==e.id()}],"filter-type-in":[Xt,[qt(Gt)],function(a,t){return 0<=t[0].value.indexOf(a.geometryType())}],"filter-id-in":[Xt,[qt(Yt)],function(a,t){return 0<=t[0].value.indexOf(a.id())}],"filter-in-small":[Xt,[Gt,qt(Yt)],function(a,t){var e=t[0];return 0<=t[1].value.indexOf(a.properties()[e.value])}],"filter-in-large":[Xt,[Gt,qt(Yt)],function(a,t){var e=t[0],r=t[1];return function(a,t,e,o){for(;e<=o;){var l=e+o>>1;if(t[l]===a)return!0;t[l]>a?o=l-1:e=l+1}return!1}(a.properties()[e.value],r.value,0,r.value.length-1)}],all:{type:Xt,overloads:[[[Xt,Xt],function(a,t){var e=t[0],r=t[1];return e.evaluate(a)&&r.evaluate(a)}],[or(Xt),function(a,t){for(var e=0,o=t;e<o.length;e+=1)if(!o[e].evaluate(a))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],function(a,t){var e=t[0],r=t[1];return e.evaluate(a)||r.evaluate(a)}],[or(Xt),function(a,t){for(var e=0,o=t;e<o.length;e+=1)if(o[e].evaluate(a))return!0;return!1}]]},"!":[Xt,[Xt],function(a,t){return!t[0].evaluate(a)}],"is-supported-script":[Xt,[Gt],function(a,t){var e=t[0],r=a.globals&&a.globals.isSupportedScript;return!r||r(e.evaluate(a))}],upcase:[Gt,[Gt],function(a,t){return t[0].evaluate(a).toUpperCase()}],downcase:[Gt,[Gt],function(a,t){return t[0].evaluate(a).toLowerCase()}],concat:[Gt,or(Yt),function(a,t){return t.map(function(t){return pe(t.evaluate(a))}).join("")}],"resolved-locale":[Gt,[$t],function(a,t){return t[0].evaluate(a).resolvedLocale()}]});var dr=function(a,t){var e;this.expression=a,this._warningHistory={},this._evaluator=new xe,this._defaultValue=t?"color"===(e=t).type&&vr(e.default)?new ie(0,0,0,0):"color"===e.type?ie.parse(e.default)||null:void 0===e.default?null:e.default:null,this._enumValues=t&&"enum"===t.type?t.values:null};dr.prototype.evaluateWithoutErrorHandling=function(a,t,e){return this._evaluator.globals=a,this._evaluator.feature=t,this._evaluator.featureState=e,this.expression.evaluate(this._evaluator)},dr.prototype.evaluate=function(a,t,e){this._evaluator.globals=a,this._evaluator.feature=t||null,this._evaluator.featureState=e||null;try{var r=this.expression.evaluate(this._evaluator);if(null==r)return this._defaultValue;if(this._enumValues&&!(r in this._enumValues))throw new he("Expected value to be one of "+Object.keys(this._enumValues).map(function(e){return JSON.stringify(e)}).join(", ")+", but found "+JSON.stringify(r)+" instead.");return r}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var Pr=function(a,t){this.kind=a,this._styleExpression=t,this.isStateDependent="constant"!==a&&!Ae(t.expression)};Pr.prototype.evaluateWithoutErrorHandling=function(a,t,e){return this._styleExpression.evaluateWithoutErrorHandling(a,t,e)},Pr.prototype.evaluate=function(a,t,e){return this._styleExpression.evaluate(a,t,e)};var Lr=function(a,t,e){this.kind=a,this.zoomStops=e.labels,this._styleExpression=t,this.isStateDependent="camera"!==a&&!Ae(t.expression),e instanceof Ye&&(this.interpolationType=e.interpolation)};Lr.prototype.evaluateWithoutErrorHandling=function(a,t,e){return this._styleExpression.evaluateWithoutErrorHandling(a,t,e)},Lr.prototype.evaluate=function(a,t,e){return this._styleExpression.evaluate(a,t,e)},Lr.prototype.interpolationFactor=function(a,t,e){return this.interpolationType?Ye.interpolationFactor(this.interpolationType,a,t,e):0};var Dr=function(a,t){this._parameters=a,this._specification=t,Ot(this,function l(k,T){var t="color"===T.type,r=k.stops&&"object"==typeof k.stops[0][0],o=r||void 0!==k.property,s=k.type||(_r(T)?"exponential":"interval"),p,u,C;if(t&&((k=Ot({},k)).stops&&(k.stops=k.stops.map(function(e){return[e[0],ie.parse(e[1])]})),k.default=k.default?ie.parse(k.default):ie.parse(T.default)),k.colorSpace&&"rgb"!==k.colorSpace&&!He[k.colorSpace])throw new Error("Unknown color space: "+k.colorSpace);if("exponential"===s)p=Cr;else if("interval"===s)p=Sr;else if("categorical"===s){p=Ar,u=Object.create(null);for(var L=0,E=k.stops,h;L<E.length;L+=1)h=E[L],u[h[0]]=h[1];C=typeof k.stops[0][0]}else{if("identity"!==s)throw new Error("Unknown function type \""+s+"\"");p=Er}if(r){for(var I={},y=[],d=0;d<k.stops.length;d++){var z=k.stops[d],v=z[0].zoom;void 0===I[v]&&(I[v]={zoom:v,type:k.type,property:k.property,default:k.default,stops:[]},y.push(v)),I[v].stops.push([z[0].value,z[1]])}for(var g=[],x=0,P=y,_;x<P.length;x+=1)_=P[x],g.push([I[_].zoom,l(I[_],T)]);var D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:Ye.interpolationFactor.bind(void 0,D),zoomStops:g.map(function(e){return e[0]}),evaluate:function(e,t){var a=e.zoom;return Cr({stops:g,base:k.base},T,a).evaluate(a,t)}}}if(r||!o){var A="exponential"===s?{name:"exponential",base:void 0===k.base?1:k.base}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Ye.interpolationFactor.bind(void 0,A),zoomStops:k.stops.map(function(e){return e[0]}),evaluate:function(e){var t=e.zoom;return p(k,T,t,u,C)}}}return{kind:"source",evaluate:function(e,t){var a=t&&t.properties?t.properties[k.property]:void 0;return void 0===a?wr(k.default,T.default):p(k,T,a,u,C)}}}(this._parameters,this._specification))};Dr.deserialize=function(e){return new Dr(e._parameters,e._specification)},Dr.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Rr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Xr={"*":function(){return[]},array:Mr,boolean:function(a){var t=a.value,e=a.key,r=br(t);return"boolean"===r?[]:[new Lt(e,t,"boolean expected, "+r+" found")]},number:jr,color:function(a){var t=a.key,e=a.value,r=br(e);return"string"===r?null===re(e)?[new Lt(t,e,"color expected, \""+e+"\" found")]:[]:[new Lt(t,e,"color expected, "+r+" found")]},constants:Tt,enum:Nr,filter:Kr,function:Fr,layer:yo,object:Or,source:en,light:tn,string:an,formatted:function(e){return 0===an(e).length?[]:Br(e)}};nn.source=sn(en),nn.light=sn(tn),nn.layer=sn(yo),nn.filter=sn(Kr),nn.paintProperty=sn(Qr),nn.layoutProperty=sn($r);var pn=nn,mn=pn.light,vn=pn.paintProperty,gn=pn.layoutProperty,xn=cn,_n=3;cn.prototype.insert=function(a,t,e,r,o){this._forEachCell(t,e,r,o,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(o)},cn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},cn.prototype._insertCell=function(o,t,e,r,n,i){this.cells[n].push(i)},cn.prototype.query=function(l,t,e,r,n){var i=this.min,a=this.max;if(l<=i&&t<=i&&a<=e&&a<=r&&!n)return Array.prototype.slice.call(this.keys);var o=[];return this._forEachCell(l,t,e,r,this._queryCell,o,{},n),o},cn.prototype._queryCell=function(d,t,e,r,n,i,a,o){var s=this.cells[n];if(null!==s)for(var u=this.keys,l=this.bboxes,p=0,g;p<s.length;p++)if(g=s[p],void 0===a[g]){var m=4*g;(o?o(l[m+0],l[m+1],l[m+2],l[m+3]):d<=l[m+2]&&t<=l[m+3]&&e>=l[m+0]&&r>=l[m+1])?(a[g]=!0,i.push(u[g])):a[g]=!1}},cn.prototype._forEachCell=function(d,t,e,r,n,i,a,o){for(var s=this._convertToCellCoord(d),u=this._convertToCellCoord(t),l=this._convertToCellCoord(e),p=this._convertToCellCoord(r),c=s;c<=l;c++)for(var g=u,m;g<=p;g++)if(m=this.d*g+c,(!o||o(this._convertFromCellCoord(c),this._convertFromCellCoord(g),this._convertFromCellCoord(c+1),this._convertFromCellCoord(g+1)))&&n.call(this,d,t,e,r,m,i,a,o))return},cn.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},cn.prototype._convertToCellCoord=function(e){return va(0,ea(this.d-1,ba(e*this.scale)+this.padding))},cn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,t=_n+this.cells.length+1+1,e=0,d=0;d<this.cells.length;d++)e+=this.cells[d].length;var c=new Int32Array(t+e+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var i=t,p=0,u;p<l.length;p++)u=l[p],c[_n+p]=i,c.set(u,i),i+=u.length;return c[_n+l.length]=i,c.set(this.keys,i),i+=this.keys.length,c[_n+l.length+1]=i,c.set(this.bboxes,i),i+=this.bboxes.length,c.buffer};var wn=self.ImageData,Sn={};for(var kn in un("Object",Object),xn.serialize=function(a,t){var e=a.toArrayBuffer();return t&&t.push(e),{buffer:e}},xn.deserialize=function(e){return new xn(e.buffer)},un("Grid",xn),un("Color",ie),un("Error",Error),un("StylePropertyFunction",Dr),un("StyleExpression",dr,{omit:["_evaluator"]}),un("ZoomDependentExpression",Lr),un("ZoomConstantExpression",Pr),un("CompoundExpression",be,{omit:["_evaluate"]}),yr)yr[kn]._classRegistryKey||un("Expression_"+kn,yr[kn]);var In=function(){this.first=!0};In.prototype.update=function(a,t){var e=ba(a);return this.first?(this.first=!1,this.lastIntegerZoom=e,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=e,!0):(this.lastFloorZoom>e?(this.lastIntegerZoom=e+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<e&&(this.lastIntegerZoom=e,this.lastIntegerZoomTime=t),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=e,!0))};var En={"Latin-1 Supplement":function(e){return 128<=e&&255>=e},Arabic:function(e){return 1536<=e&&1791>=e},"Arabic Supplement":function(e){return 1872<=e&&1919>=e},"Arabic Extended-A":function(e){return 2208<=e&&2303>=e},"Hangul Jamo":function(e){return 4352<=e&&4607>=e},"Unified Canadian Aboriginal Syllabics":function(e){return 5120<=e&&5759>=e},Khmer:function(e){return 6016<=e&&6143>=e},"Unified Canadian Aboriginal Syllabics Extended":function(e){return 6320<=e&&6399>=e},"General Punctuation":function(e){return 8192<=e&&8303>=e},"Letterlike Symbols":function(e){return 8448<=e&&8527>=e},"Number Forms":function(e){return 8528<=e&&8591>=e},"Miscellaneous Technical":function(e){return 8960<=e&&9215>=e},"Control Pictures":function(e){return 9216<=e&&9279>=e},"Optical Character Recognition":function(e){return 9280<=e&&9311>=e},"Enclosed Alphanumerics":function(e){return 9312<=e&&9471>=e},"Geometric Shapes":function(e){return 9632<=e&&9727>=e},"Miscellaneous Symbols":function(e){return 9728<=e&&9983>=e},"Miscellaneous Symbols and Arrows":function(e){return 11008<=e&&11263>=e},"CJK Radicals Supplement":function(e){return 11904<=e&&12031>=e},"Kangxi Radicals":function(e){return 12032<=e&&12255>=e},"Ideographic Description Characters":function(e){return 12272<=e&&12287>=e},"CJK Symbols and Punctuation":function(e){return 12288<=e&&12351>=e},Hiragana:function(e){return 12352<=e&&12447>=e},Katakana:function(e){return 12448<=e&&12543>=e},Bopomofo:function(e){return 12544<=e&&12591>=e},"Hangul Compatibility Jamo":function(e){return 12592<=e&&12687>=e},Kanbun:function(e){return 12688<=e&&12703>=e},"Bopomofo Extended":function(e){return 12704<=e&&12735>=e},"CJK Strokes":function(e){return 12736<=e&&12783>=e},"Katakana Phonetic Extensions":function(e){return 12784<=e&&12799>=e},"Enclosed CJK Letters and Months":function(e){return 12800<=e&&13055>=e},"CJK Compatibility":function(e){return 13056<=e&&13311>=e},"CJK Unified Ideographs Extension A":function(e){return 13312<=e&&19903>=e},"Yijing Hexagram Symbols":function(e){return 19904<=e&&19967>=e},"CJK Unified Ideographs":function(e){return 19968<=e&&40959>=e},"Yi Syllables":function(e){return 40960<=e&&42127>=e},"Yi Radicals":function(e){return 42128<=e&&42191>=e},"Hangul Jamo Extended-A":function(e){return 43360<=e&&43391>=e},"Hangul Syllables":function(e){return 44032<=e&&55215>=e},"Hangul Jamo Extended-B":function(e){return 55216<=e&&55295>=e},"Private Use Area":function(e){return 57344<=e&&63743>=e},"CJK Compatibility Ideographs":function(e){return 63744<=e&&64255>=e},"Arabic Presentation Forms-A":function(e){return 64336<=e&&65023>=e},"Vertical Forms":function(e){return 65040<=e&&65055>=e},"CJK Compatibility Forms":function(e){return 65072<=e&&65103>=e},"Small Form Variants":function(e){return 65104<=e&&65135>=e},"Arabic Presentation Forms-B":function(e){return 65136<=e&&65279>=e},"Halfwidth and Fullwidth Forms":function(e){return 65280<=e&&65519>=e}},Mn=!1,Ed=null,Id=!1,zd=new Vt,qn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Id||null!=qn.applyArabicShaping}},Nn=function(a,t){this.zoom=a,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new In,this.transition={})},Zn;Nn.prototype.isSupportedScript=function(e){return function(a,t){for(var e=0,o=a;e<o.length;e+=1)if(!Ln(o[e].charCodeAt(0),t))return!1;return!0}(e,qn.isLoaded())},Nn.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:ea((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Nn.prototype.getCrossfadeParameters=function(){var a=this.zoom,t=a-ba(a),e=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*e}:{fromScale:.5,toScale:1,t:1-(1-e)*t}};var Pd=function(a,t){this.property=a,this.value=t,this.expression=function(a,t){if(vr(a))return new Dr(a,t);if(Tr(a)){var e=zr(a,t);if("error"===e.result)throw new Error(e.value.map(function(e){return e.key+": "+e.message}).join(", "));return e.value}var r=a;return"string"==typeof a&&"color"===t.type&&(r=ie.parse(a)),{kind:"constant",evaluate:function(){return r}}}(void 0===t?a.specification.default:t,a.specification)};Pd.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Pd.prototype.possiblyEvaluate=function(e){return this.property.possiblyEvaluate(this,e)};var Kn=function(e){this.property=e,this.value=new Pd(e,void 0)};Kn.prototype.transitioned=function(a,t){return new Xn(this.property,this.value,t,dt({},a.transition,this.transition),a.now)},Kn.prototype.untransitioned=function(){return new Xn(this.property,this.value,null,{},0)};var Gn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Gn.prototype.getValue=function(e){return x(this._values[e].value.value)},Gn.prototype.setValue=function(a,t){this._values.hasOwnProperty(a)||(this._values[a]=new Kn(this._values[a].property)),this._values[a].value=new Pd(this._values[a].property,null===t?void 0:x(t))},Gn.prototype.getTransition=function(e){return x(this._values[e].transition)},Gn.prototype.setTransition=function(a,t){this._values.hasOwnProperty(a)||(this._values[a]=new Kn(this._values[a].property)),this._values[a].transition=x(t)||void 0},Gn.prototype.serialize=function(){for(var o={},t=0,l=Object.keys(this._values);t<l.length;t+=1){var r=l[t],n=this.getValue(r);void 0!==n&&(o[r]=n);var i=this.getTransition(r);void 0!==i&&(o[r+"-transition"]=i)}return o},Gn.prototype.transitioned=function(o,t){for(var e=new Jn(this._properties),r=0,l=Object.keys(this._values),i;r<l.length;r+=1)i=l[r],e._values[i]=this._values[i].transitioned(o,t._values[i]);return e},Gn.prototype.untransitioned=function(){for(var a=new Jn(this._properties),t=0,o=Object.keys(this._values),r;t<o.length;t+=1)r=o[t],a._values[r]=this._values[r].untransitioned();return a};var Xn=function(a,t,e,r,o){this.property=a,this.value=t,this.begin=o+r.delay||0,this.end=this.begin+r.duration||0,a.specification.transition&&(r.delay||r.duration)&&(this.prior=e)};Xn.prototype.possiblyEvaluate=function(a){var t=a.now||0,e=this.value.possiblyEvaluate(a),r=this.prior;if(r){if(t>this.end)return this.prior=null,e;if(this.value.isDataDriven())return this.prior=null,e;if(t<this.begin)return r.possiblyEvaluate(a);var o=(t-this.begin)/(this.end-this.begin);return this.property.interpolate(r.possiblyEvaluate(a),e,function(a){if(0>=a)return 0;if(1<=a)return 1;var t=a*a,e=t*a;return 4*(.5>a?e:3*(a-t)+e-.75)}(o))}return e};var Jn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Jn.prototype.possiblyEvaluate=function(a){for(var t=new $n(this._properties),e=0,o=Object.keys(this._values),n;e<o.length;e+=1)n=o[e],t._values[n]=this._values[n].possiblyEvaluate(a);return t},Jn.prototype.hasTransition=function(){for(var a=0,o=Object.keys(this._values),e;a<o.length;a+=1)if(e=o[a],this._values[e].prior)return!0;return!1};var Hn=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Hn.prototype.getValue=function(e){return x(this._values[e].value)},Hn.prototype.setValue=function(a,t){this._values[a]=new Pd(this._values[a].property,null===t?void 0:x(t))},Hn.prototype.serialize=function(){for(var a={},t=0,o=Object.keys(this._values);t<o.length;t+=1){var r=o[t],n=this.getValue(r);void 0!==n&&(a[r]=n)}return a},Hn.prototype.possiblyEvaluate=function(a){for(var t=new $n(this._properties),e=0,o=Object.keys(this._values),n;e<o.length;e+=1)n=o[e],t._values[n]=this._values[n].possiblyEvaluate(a);return t};var Yn=function(a,t,e){this.property=a,this.value=t,this.parameters=e};Yn.prototype.isConstant=function(){return"constant"===this.value.kind},Yn.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},Yn.prototype.evaluate=function(a,t){return this.property.evaluate(this.value,this.parameters,a,t)};var $n=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};$n.prototype.get=function(e){return this._values[e]};var Wn=function(e){this.specification=e};Wn.prototype.possiblyEvaluate=function(a,t){return a.expression.evaluate(t)},Wn.prototype.interpolate=function(a,t,e){var r=Ce[this.specification.type];return r?r(a,t,e):a};var Qn=function(e){this.specification=e};Qn.prototype.possiblyEvaluate=function(a,t){return"constant"===a.expression.kind||"camera"===a.expression.kind?new Yn(this,{kind:"constant",value:a.expression.evaluate(t)},t):new Yn(this,a.expression,t)},Qn.prototype.interpolate=function(a,t,e){if("constant"!==a.value.kind||"constant"!==t.value.kind)return a;if(void 0===a.value.value||void 0===t.value.value)return new Yn(this,{kind:"constant",value:void 0},a.parameters);var r=Ce[this.specification.type];return r?new Yn(this,{kind:"constant",value:r(a.value.value,t.value.value,e)},a.parameters):a},Qn.prototype.evaluate=function(a,t,e,r){return"constant"===a.kind?a.value:a.evaluate(t,e,r)};var ti=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.possiblyEvaluate=function(a,t){if(void 0===a.value)return new Yn(this,{kind:"constant",value:void 0},t);if("constant"===a.expression.kind){var e=a.expression.evaluate(t),r=this._calculate(e,e,e,t);return new Yn(this,{kind:"constant",value:r},t)}if("camera"===a.expression.kind){var o=this._calculate(a.expression.evaluate({zoom:t.zoom-1}),a.expression.evaluate({zoom:t.zoom}),a.expression.evaluate({zoom:t.zoom+1}),t);return new Yn(this,{kind:"constant",value:o},t)}return new Yn(this,a.expression,t)},t.prototype.evaluate=function(a,t,e,r){if("source"===a.kind){var o=a.evaluate(t,e,r);return this._calculate(o,o,o,t)}return"composite"===a.kind?this._calculate(a.evaluate({zoom:ba(t.zoom)-1},e,r),a.evaluate({zoom:ba(t.zoom)},e,r),a.evaluate({zoom:ba(t.zoom)+1},e,r),t):a.value},t.prototype._calculate=function(a,t,e,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:a,to:t}:{from:e,to:t}},t.prototype.interpolate=function(e){return e},t}(Qn),ei=function(e){this.specification=e};ei.prototype.possiblyEvaluate=function(a,t){if(void 0!==a.value){if("constant"===a.expression.kind){var e=a.expression.evaluate(t);return this._calculate(e,e,e,t)}return this._calculate(a.expression.evaluate(new Nn(ba(t.zoom-1),t)),a.expression.evaluate(new Nn(ba(t.zoom),t)),a.expression.evaluate(new Nn(ba(t.zoom+1),t)),t)}},ei.prototype._calculate=function(a,t,e,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:a,to:t}:{from:e,to:t}},ei.prototype.interpolate=function(e){return e};var ri=function(e){this.specification=e};ri.prototype.possiblyEvaluate=function(a,t){return!!a.expression.evaluate(t)},ri.prototype.interpolate=function(){return!1};var ni=function(a){for(var t in this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},a){var e=a[t],r=this.defaultPropertyValues[t]=new Pd(e,void 0),o=this.defaultTransitionablePropertyValues[t]=new Kn(e);this.defaultTransitioningPropertyValues[t]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=r.possiblyEvaluate({})}};un("DataDrivenProperty",Qn),un("DataConstantProperty",Wn),un("CrossFadedDataDrivenProperty",ti),un("CrossFadedProperty",ei),un("ColorRampProperty",ri);var ii=function(a){function t(t,o){if(a.call(this),this.id=t.id,this.type=t.type,this._featureFilter=function(){return!0},"custom"!==t.type&&(t=t,this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new Hn(o.layout)),o.paint)){for(var r in this._transitionablePaint=new Gn(o.paint),t.paint)this.setPaintProperty(r,t.paint[r],{validate:!1});for(var n in t.layout)this.setLayoutProperty(n,t.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},t.prototype.setLayoutProperty=function(a,t,e){if(void 0===e&&(e={}),null!=t){var o="layers."+this.id+".layout."+a;if(this._validate(gn,o,a,t,e))return}"visibility"===a?this.visibility=t:this._unevaluatedLayout.setValue(a,t)},t.prototype.getPaintProperty=function(e){return ht(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)},t.prototype.setPaintProperty=function(l,t,e){if(void 0===e&&(e={}),null!=t){var s="layers."+this.id+".paint."+l;if(this._validate(vn,s,l,t,e))return!1}if(ht(l,"-transition"))return this._transitionablePaint.setTransition(l.slice(0,-11),t||void 0),!1;var n=this._transitionablePaint._values[l],i="cross-faded-data-driven"===n.property.specification["property-type"],a=n.value.isDataDriven();return this._transitionablePaint.setValue(l,t),this._handleSpecialPaintPropertyUpdate(l),this._transitionablePaint._values[l].value.isDataDriven()||a||i},t.prototype._handleSpecialPaintPropertyUpdate=function(){},t.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(e){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e)),this.paint=this._transitioningPaint.possiblyEvaluate(e)},t.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),g(e,function(a,t){return void 0!==a&&("layout"!==t||Object.keys(a).length)&&("paint"!==t||Object.keys(a).length)})},t.prototype._validate=function(a,t,e,r,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&dn(this,a.call(pn,{key:t,layerType:this.type,objectKey:e,value:r,styleSpec:Ft,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var a in this.paint._values){var t=this.paint.get(a);if(t instanceof Yn&&mr(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1},t}(Vt),ai={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},oi=function(a,t){this._structArray=a,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},si=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};si.serialize=function(a,t){return a._trim(),t&&(a.isTransferred=!0,t.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},si.deserialize=function(a){var t=Object.create(this.prototype);return t.arrayBuffer=a.arrayBuffer,t.length=a.length,t.capacity=a.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},si.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},si.prototype.clear=function(){this.length=0},si.prototype.resize=function(e){this.reserve(e),this.length=e},si.prototype.reserve=function(a){if(a>this.capacity){this.capacity=va(a,ba(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},si.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ui=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;return this.resize(e+1),this.emplace(e,a,t)},t.prototype.emplace=function(a,t,e){var r=2*a;return this.int16[r+0]=t,this.int16[r+1]=e,a},t}(si);ui.prototype.bytesPerElement=4,un("StructArrayLayout2i4",ui);var ci=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,r){var o=this.length;return this.resize(o+1),this.emplace(o,a,t,e,r)},t.prototype.emplace=function(o,t,e,r,n){var i=4*o;return this.int16[i+0]=t,this.int16[i+1]=e,this.int16[i+2]=r,this.int16[i+3]=n,o},t}(si);ci.prototype.bytesPerElement=8,un("StructArrayLayout4i8",ci);var hi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,l,t,e,r,n,i)},t.prototype.emplace=function(l,t,e,r,n,i,a){var o=6*l;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=r,this.int16[o+3]=n,this.int16[o+4]=i,this.int16[o+5]=a,l},t}(si);hi.prototype.bytesPerElement=12,un("StructArrayLayout2i4i12",hi);var fi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,l,t,e,r,n,i)},t.prototype.emplace=function(l,t,e,r,n,i,a){var o=4*l,s=8*l;return this.int16[o+0]=t,this.int16[o+1]=e,this.uint8[s+4]=r,this.uint8[s+5]=n,this.uint8[s+6]=i,this.uint8[s+7]=a,l},t}(si);fi.prototype.bytesPerElement=8,un("StructArrayLayout2i4ub8",fi);var yi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,l,t,e,r,n,i,a,o)},t.prototype.emplace=function(d,t,e,r,n,i,a,o,s){var c=8*d;return this.uint16[c+0]=t,this.uint16[c+1]=e,this.uint16[c+2]=r,this.uint16[c+3]=n,this.uint16[c+4]=i,this.uint16[c+5]=a,this.uint16[c+6]=o,this.uint16[c+7]=s,d},t}(si);yi.prototype.bytesPerElement=16,un("StructArrayLayout8ui16",yi);var di=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,l,t,e,r,n,i,a,o)},t.prototype.emplace=function(d,t,e,r,n,i,a,o,s){var c=8*d;return this.int16[c+0]=t,this.int16[c+1]=e,this.int16[c+2]=r,this.int16[c+3]=n,this.uint16[c+4]=i,this.uint16[c+5]=a,this.uint16[c+6]=o,this.uint16[c+7]=s,d},t}(si);di.prototype.bytesPerElement=16,un("StructArrayLayout4i4ui16",di);var mi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var r=this.length;return this.resize(r+1),this.emplace(r,a,t,e)},t.prototype.emplace=function(a,t,e,r){var o=3*a;return this.float32[o+0]=t,this.float32[o+1]=e,this.float32[o+2]=r,a},t}(si);mi.prototype.bytesPerElement=12,un("StructArrayLayout3f12",mi);var vi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;return this.resize(t+1),this.emplace(t,a)},t.prototype.emplace=function(a,t){return this.uint32[1*a+0]=t,a},t}(si);vi.prototype.bytesPerElement=4,un("StructArrayLayout1ul4",vi);var gi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(d,t,e,r,n,i,a,o,s,u,l){var p=this.length;return this.resize(p+1),this.emplace(p,d,t,e,r,n,i,a,o,s,u,l)},t.prototype.emplace=function(d,t,e,r,n,i,a,o,s,u,l,p){var c=12*d;return this.int16[c+0]=t,this.int16[c+1]=e,this.int16[c+2]=r,this.int16[c+3]=n,this.int16[c+4]=i,this.int16[c+5]=a,this.uint32[6*d+3]=o,this.uint16[c+8]=s,this.uint16[c+9]=u,this.int16[c+10]=l,this.int16[c+11]=p,d},t}(si);gi.prototype.bytesPerElement=24,un("StructArrayLayout6i1ul2ui2i24",gi);var xi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,l,t,e,r,n,i)},t.prototype.emplace=function(l,t,e,r,n,i,a){var o=6*l;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=r,this.int16[o+3]=n,this.int16[o+4]=i,this.int16[o+5]=a,l},t}(si);xi.prototype.bytesPerElement=12,un("StructArrayLayout2i2i2i12",xi);var bi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,r){var o=this.length;return this.resize(o+1),this.emplace(o,a,t,e,r)},t.prototype.emplace=function(l,t,e,r,n){var i=12*l,a=3*l;return this.uint8[i+0]=t,this.uint8[i+1]=e,this.float32[a+1]=r,this.float32[a+2]=n,l},t}(si);bi.prototype.bytesPerElement=12,un("StructArrayLayout2ub2f12",bi);var _i=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(g,t,e,r,n,i,a,o,s,u,l,p,c,h,m){var y=this.length;return this.resize(y+1),this.emplace(y,g,t,e,r,n,i,a,o,s,u,l,p,c,h,m)},t.prototype.emplace=function(x,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y){var d=22*x,m=11*x,_=44*x;return this.int16[d+0]=t,this.int16[d+1]=e,this.uint16[d+2]=r,this.uint16[d+3]=n,this.uint32[m+2]=i,this.uint32[m+3]=a,this.uint32[m+4]=o,this.uint16[d+10]=s,this.uint16[d+11]=u,this.uint16[d+12]=l,this.float32[m+7]=p,this.float32[m+8]=c,this.uint8[_+36]=h,this.uint8[_+37]=f,this.uint32[m+10]=y,x},t}(si);_i.prototype.bytesPerElement=44,un("StructArrayLayout2i2ui3ul3ui2f2ub1ul44",_i);var wi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(x,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m){var _=this.length;return this.resize(_+1),this.emplace(_,x,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m)},t.prototype.emplace=function(_,t,e,r,n,i,a,o,s,u,l,p,c,h,f,y,d,m,v){var g=22*_,x=11*_;return this.int16[g+0]=t,this.int16[g+1]=e,this.int16[g+2]=r,this.int16[g+3]=n,this.int16[g+4]=i,this.int16[g+5]=a,this.uint16[g+6]=o,this.uint16[g+7]=s,this.uint16[g+8]=u,this.uint16[g+9]=l,this.uint16[g+10]=p,this.uint16[g+11]=c,this.uint16[g+12]=h,this.uint16[g+13]=f,this.uint16[g+14]=y,this.uint32[x+8]=d,this.float32[x+9]=m,this.float32[x+10]=v,_},t}(si);wi.prototype.bytesPerElement=44,un("StructArrayLayout6i9ui1ul2f44",wi);var Ai=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;return this.resize(t+1),this.emplace(t,a)},t.prototype.emplace=function(a,t){return this.float32[1*a+0]=t,a},t}(si);Ai.prototype.bytesPerElement=4,un("StructArrayLayout1f4",Ai);var Si=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var r=this.length;return this.resize(r+1),this.emplace(r,a,t,e)},t.prototype.emplace=function(a,t,e,r){var o=3*a;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=r,a},t}(si);Si.prototype.bytesPerElement=6,un("StructArrayLayout3i6",Si);var ki=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var r=this.length;return this.resize(r+1),this.emplace(r,a,t,e)},t.prototype.emplace=function(o,t,e,r){var i=4*o;return this.uint32[2*o+0]=t,this.uint16[i+2]=e,this.uint16[i+3]=r,o},t}(si);ki.prototype.bytesPerElement=8,un("StructArrayLayout1ul2ui8",ki);var zi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var r=this.length;return this.resize(r+1),this.emplace(r,a,t,e)},t.prototype.emplace=function(a,t,e,r){var o=3*a;return this.uint16[o+0]=t,this.uint16[o+1]=e,this.uint16[o+2]=r,a},t}(si);zi.prototype.bytesPerElement=6,un("StructArrayLayout3ui6",zi);var Ii=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;return this.resize(e+1),this.emplace(e,a,t)},t.prototype.emplace=function(a,t,e){var r=2*a;return this.uint16[r+0]=t,this.uint16[r+1]=e,a},t}(si);Ii.prototype.bytesPerElement=4,un("StructArrayLayout2ui4",Ii);var Bi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;return this.resize(t+1),this.emplace(t,a)},t.prototype.emplace=function(a,t){return this.uint16[1*a+0]=t,a},t}(si);Bi.prototype.bytesPerElement=2,un("StructArrayLayout1ui2",Bi);var Ci=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;return this.resize(e+1),this.emplace(e,a,t)},t.prototype.emplace=function(a,t,e){var r=2*a;return this.float32[r+0]=t,this.float32[r+1]=e,a},t}(si);Ci.prototype.bytesPerElement=8,un("StructArrayLayout2f8",Ci);var Ei=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,r){var o=this.length;return this.resize(o+1),this.emplace(o,a,t,e,r)},t.prototype.emplace=function(o,t,e,r,n){var i=4*o;return this.float32[i+0]=t,this.float32[i+1]=e,this.float32[i+2]=r,this.float32[i+3]=n,o},t}(si);Ei.prototype.bytesPerElement=16,un("StructArrayLayout4f16",Ei);var Mi=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return e.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorPointX.set=function(e){this._structArray.int16[this._pos2+0]=e},e.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},e.anchorPointY.set=function(e){this._structArray.int16[this._pos2+1]=e},e.x1.get=function(){return this._structArray.int16[this._pos2+2]},e.x1.set=function(e){this._structArray.int16[this._pos2+2]=e},e.y1.get=function(){return this._structArray.int16[this._pos2+3]},e.y1.set=function(e){this._structArray.int16[this._pos2+3]=e},e.x2.get=function(){return this._structArray.int16[this._pos2+4]},e.x2.set=function(e){this._structArray.int16[this._pos2+4]=e},e.y2.get=function(){return this._structArray.int16[this._pos2+5]},e.y2.set=function(e){this._structArray.int16[this._pos2+5]=e},e.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},e.featureIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e},e.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},e.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+8]=e},e.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},e.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+9]=e},e.radius.get=function(){return this._structArray.int16[this._pos2+10]},e.radius.set=function(e){this._structArray.int16[this._pos2+10]=e},e.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},e.signedDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+11]=e},e.anchorPoint.get=function(){return new ud(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,e),t}(oi);Mi.prototype.size=24;var Ti=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new Mi(this,e)},t}(gi);un("CollisionBoxArray",Ti);var Pi=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0}};return e.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorX.set=function(e){this._structArray.int16[this._pos2+0]=e},e.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},e.anchorY.set=function(e){this._structArray.int16[this._pos2+1]=e},e.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},e.glyphStartIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e},e.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},e.numGlyphs.set=function(e){this._structArray.uint16[this._pos2+3]=e},e.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},e.vertexStartIndex.set=function(e){this._structArray.uint32[this._pos4+2]=e},e.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},e.lineStartIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e},e.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},e.lineLength.set=function(e){this._structArray.uint32[this._pos4+4]=e},e.segment.get=function(){return this._structArray.uint16[this._pos2+10]},e.segment.set=function(e){this._structArray.uint16[this._pos2+10]=e},e.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},e.lowerSize.set=function(e){this._structArray.uint16[this._pos2+11]=e},e.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},e.upperSize.set=function(e){this._structArray.uint16[this._pos2+12]=e},e.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},e.lineOffsetX.set=function(e){this._structArray.float32[this._pos4+7]=e},e.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},e.lineOffsetY.set=function(e){this._structArray.float32[this._pos4+8]=e},e.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},e.writingMode.set=function(e){this._structArray.uint8[this._pos1+36]=e},e.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},e.hidden.set=function(e){this._structArray.uint8[this._pos1+37]=e},e.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},e.crossTileID.set=function(e){this._structArray.uint32[this._pos4+10]=e},Object.defineProperties(t.prototype,e),t}(oi);Pi.prototype.size=44;var Vi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new Pi(this,e)},t}(_i);un("PlacedSymbolArray",Vi);var Fi=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},radialTextOffset:{configurable:!0}};return e.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorX.set=function(e){this._structArray.int16[this._pos2+0]=e},e.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},e.anchorY.set=function(e){this._structArray.int16[this._pos2+1]=e},e.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},e.rightJustifiedTextSymbolIndex.set=function(e){this._structArray.int16[this._pos2+2]=e},e.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},e.centerJustifiedTextSymbolIndex.set=function(e){this._structArray.int16[this._pos2+3]=e},e.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},e.leftJustifiedTextSymbolIndex.set=function(e){this._structArray.int16[this._pos2+4]=e},e.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},e.verticalPlacedTextSymbolIndex.set=function(e){this._structArray.int16[this._pos2+5]=e},e.key.get=function(){return this._structArray.uint16[this._pos2+6]},e.key.set=function(e){this._structArray.uint16[this._pos2+6]=e},e.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]},e.textBoxStartIndex.set=function(e){this._structArray.uint16[this._pos2+7]=e},e.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]},e.textBoxEndIndex.set=function(e){this._structArray.uint16[this._pos2+8]=e},e.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},e.iconBoxStartIndex.set=function(e){this._structArray.uint16[this._pos2+9]=e},e.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},e.iconBoxEndIndex.set=function(e){this._structArray.uint16[this._pos2+10]=e},e.featureIndex.get=function(){return this._structArray.uint16[this._pos2+11]},e.featureIndex.set=function(e){this._structArray.uint16[this._pos2+11]=e},e.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+12]},e.numHorizontalGlyphVertices.set=function(e){this._structArray.uint16[this._pos2+12]=e},e.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+13]},e.numVerticalGlyphVertices.set=function(e){this._structArray.uint16[this._pos2+13]=e},e.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+14]},e.numIconVertices.set=function(e){this._structArray.uint16[this._pos2+14]=e},e.crossTileID.get=function(){return this._structArray.uint32[this._pos4+8]},e.crossTileID.set=function(e){this._structArray.uint32[this._pos4+8]=e},e.textBoxScale.get=function(){return this._structArray.float32[this._pos4+9]},e.textBoxScale.set=function(e){this._structArray.float32[this._pos4+9]=e},e.radialTextOffset.get=function(){return this._structArray.float32[this._pos4+10]},e.radialTextOffset.set=function(e){this._structArray.float32[this._pos4+10]=e},Object.defineProperties(t.prototype,e),t}(oi);Fi.prototype.size=44;var Li=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new Fi(this,e)},t}(wi);un("SymbolInstanceArray",Li);var Di=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={offsetX:{configurable:!0}};return e.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},e.offsetX.set=function(e){this._structArray.float32[this._pos4+0]=e},Object.defineProperties(t.prototype,e),t}(oi);Di.prototype.size=4;var Oi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getoffsetX=function(e){return this.float32[1*e+0]},t.prototype.get=function(e){return new Di(this,e)},t}(Ai);un("GlyphOffsetArray",Oi);var Ri=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return e.x.get=function(){return this._structArray.int16[this._pos2+0]},e.x.set=function(e){this._structArray.int16[this._pos2+0]=e},e.y.get=function(){return this._structArray.int16[this._pos2+1]},e.y.set=function(e){this._structArray.int16[this._pos2+1]=e},e.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},e.tileUnitDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+2]=e},Object.defineProperties(t.prototype,e),t}(oi);Ri.prototype.size=6;var Ui=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getx=function(e){return this.int16[3*e+0]},t.prototype.gety=function(e){return this.int16[3*e+1]},t.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},t.prototype.get=function(e){return new Ri(this,e)},t}(Si);un("SymbolLineVertexArray",Ui);var ji=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return e.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},e.featureIndex.set=function(e){this._structArray.uint32[this._pos4+0]=e},e.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},e.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e},e.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},e.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+3]=e},Object.defineProperties(t.prototype,e),t}(oi);ji.prototype.size=8;var qi=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new ji(this,e)},t}(ki);un("FeatureIndexArray",qi);var Ni=zn([{name:"a_pos",components:2,type:"Int16"}],4).members,Zi=function(e){void 0===e&&(e=[]),this.segments=e};Zi.prototype.prepareSegment=function(a,t,e,r){var o=this.segments[this.segments.length-1];return a>Zi.MAX_VERTEX_ARRAY_LENGTH&&Fa("Max vertices per segment is "+Zi.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!o||o.vertexLength+a>Zi.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==r)&&(o={vertexOffset:t.length,primitiveOffset:e.length,vertexLength:0,primitiveLength:0},void 0!==r&&(o.sortKey=r),this.segments.push(o)),o},Zi.prototype.get=function(){return this.segments},Zi.prototype.destroy=function(){for(var a=0,o=this.segments,e;a<o.length;a+=1)for(var i in e=o[a],e.vaos)e.vaos[i].destroy()},Zi.simpleSegment=function(a,t,e,r){return new Zi([{vertexOffset:a,primitiveOffset:t,vertexLength:e,primitiveLength:r,vaos:{},sortKey:0}])},Zi.MAX_VERTEX_ARRAY_LENGTH=ya(2,16)-1,un("SegmentVector",Zi);var Ki=function(){this.ids=[],this.positions=[],this.indexed=!1};Ki.prototype.add=function(a,t,e,r){this.ids.push(a),this.positions.push(t,e,r)},Ki.prototype.getPositions=function(l){for(var t=0,d=this.ids.length-1,c;t<d;)c=t+d>>1,this.ids[c]>=l?d=c:t=c+1;for(var p=[];this.ids[t]===l;){var i=this.positions[3*t],a=this.positions[3*t+1],o=this.positions[3*t+2];p.push({index:i,start:a,end:o}),t++}return p},Ki.serialize=function(a,t){var e=new Float64Array(a.ids),r=new Uint32Array(a.positions);return function l(t,e,r,n){if(!(r>=n)){for(var i=t[r+n>>1],a=r-1,d=n+1;;){do a++;while(t[a]<i);do d--;while(t[d]>i);if(a>=d)break;Gi(t,a,d),Gi(e,3*a,3*d),Gi(e,3*a+1,3*d+1),Gi(e,3*a+2,3*d+2)}l(t,e,r,d),l(t,e,d+1,n)}}(e,r,0,e.length-1),t.push(e.buffer,r.buffer),{ids:e,positions:r}},Ki.deserialize=function(a){var t=new Ki;return t.ids=a.ids,t.positions=a.positions,t.indexed=!0,t},un("FeaturePositionMap",Ki);var Xi=function(a,t){this.gl=a.gl,this.location=t},Hi=function(a){function t(t,e){a.call(this,t,e),this.current=0}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))},t}(Xi),Yi=function(a){function t(t,e){a.call(this,t,e),this.current=0}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))},t}(Xi),$i=function(a){function t(t,e){a.call(this,t,e),this.current=[0,0]}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))},t}(Xi),Wi=function(a){function t(t,e){a.call(this,t,e),this.current=[0,0,0]}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))},t}(Xi),Qi=function(a){function t(t,e){a.call(this,t,e),this.current=[0,0,0,0]}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))},t}(Xi),ta=function(a){function t(t,e){a.call(this,t,e),this.current=ie.transparent}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))},t}(Xi),Dd=new Float32Array(16),ra=function(a){function t(t,e){a.call(this,t,e),this.current=Dd}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(var t=1;16>t;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}},t}(Xi),na=function(a,t,e){this.value=a,this.names=t,this.uniformNames=this.names.map(function(e){return"u_"+e}),this.type=e,this.maxValue=-1/0};na.prototype.defines=function(){return this.names.map(function(e){return"#define HAS_UNIFORM_u_"+e})},na.prototype.setConstantPatternPositions=function(){},na.prototype.populatePaintArray=function(){},na.prototype.updatePaintArray=function(){},na.prototype.upload=function(){},na.prototype.destroy=function(){},na.prototype.setUniforms=function(a,t,e,r){t.set(r.constantOr(this.value))},na.prototype.getBinding=function(a,t){return"color"===this.type?new ta(a,t):new Yi(a,t)},na.serialize=function(a){var t=a.value,e=a.names,r=a.type;return{value:hn(t),names:e,type:r}},na.deserialize=function(a){var t=a.value,e=a.names,r=a.type;return new na(yn(t),e,r)};var aa=function(a,t,e){this.value=a,this.names=t,this.uniformNames=this.names.map(function(e){return"u_"+e}),this.type=e,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};aa.prototype.defines=function(){return this.names.map(function(e){return"#define HAS_UNIFORM_u_"+e})},aa.prototype.populatePaintArray=function(){},aa.prototype.updatePaintArray=function(){},aa.prototype.upload=function(){},aa.prototype.destroy=function(){},aa.prototype.setConstantPatternPositions=function(a,t){this.patternPositions.patternTo=a.tlbr,this.patternPositions.patternFrom=t.tlbr},aa.prototype.setUniforms=function(o,t,e,r,n){var i=this.patternPositions;"u_pattern_to"===n&&i.patternTo&&t.set(i.patternTo),"u_pattern_from"===n&&i.patternFrom&&t.set(i.patternFrom)},aa.prototype.getBinding=function(a,t){return new Qi(a,t)};var oa=function(a,t,e,r){this.expression=a,this.names=t,this.type=e,this.uniformNames=this.names.map(function(e){return"a_"+e}),this.maxValue=-1/0,this.paintVertexAttributes=t.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===e?2:1,offset:0}}),this.paintVertexArray=new r};oa.prototype.defines=function(){return[]},oa.prototype.setConstantPatternPositions=function(){},oa.prototype.populatePaintArray=function(l,t){var e=this.paintVertexArray,r=e.length;e.reserve(l);var n=this.expression.evaluate(new Nn(0),t,{});if("color"===this.type)for(var i=Ji(n),a=r;a<l;a++)e.emplaceBack(i[0],i[1]);else{for(var d=r;d<l;d++)e.emplaceBack(n);this.maxValue=va(this.maxValue,n)}},oa.prototype.updatePaintArray=function(l,t,e,r){var n=this.paintVertexArray,i=this.expression.evaluate({zoom:0},e,r);if("color"===this.type)for(var a=Ji(i),o=l;o<t;o++)n.emplace(o,a[0],a[1]);else{for(var d=l;d<t;d++)n.emplace(d,i);this.maxValue=va(this.maxValue,i)}},oa.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},oa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},oa.prototype.setUniforms=function(a,t){t.set(0)},oa.prototype.getBinding=function(a,t){return new Yi(a,t)};var sa=function(o,t,e,r,n,i){this.expression=o,this.names=t,this.uniformNames=this.names.map(function(e){return"u_"+e+"_t"}),this.type=e,this.useIntegerZoom=r,this.zoom=n,this.maxValue=-1/0;this.paintVertexAttributes=t.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===e?4:2,offset:0}}),this.paintVertexArray=new i};sa.prototype.defines=function(){return[]},sa.prototype.setConstantPatternPositions=function(){},sa.prototype.populatePaintArray=function(d,t){var e=this.paintVertexArray,r=e.length;e.reserve(d);var n=this.expression.evaluate(new Nn(this.zoom),t,{}),i=this.expression.evaluate(new Nn(this.zoom+1),t,{});if("color"===this.type)for(var a=Ji(n),o=Ji(i),s=r;s<d;s++)e.emplaceBack(a[0],a[1],o[0],o[1]);else{for(var c=r;c<d;c++)e.emplaceBack(n,i);this.maxValue=va(this.maxValue,n,i)}},sa.prototype.updatePaintArray=function(d,t,e,r){var n=this.paintVertexArray,i=this.expression.evaluate({zoom:this.zoom},e,r),a=this.expression.evaluate({zoom:this.zoom+1},e,r);if("color"===this.type)for(var o=Ji(i),s=Ji(a),c=d;c<t;c++)n.emplace(c,o[0],o[1],s[0],s[1]);else{for(var u=d;u<t;u++)n.emplace(u,i,a);this.maxValue=va(this.maxValue,i,a)}},sa.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},sa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},sa.prototype.interpolationFactor=function(e){return this.useIntegerZoom?this.expression.interpolationFactor(ba(e),this.zoom,this.zoom+1):this.expression.interpolationFactor(e,this.zoom,this.zoom+1)},sa.prototype.setUniforms=function(a,t,e){t.set(this.interpolationFactor(e.zoom))},sa.prototype.getBinding=function(a,t){return new Yi(a,t)};var ua=function(l,t,e,r,n,i,a){this.expression=l,this.names=t,this.type=e,this.uniformNames=this.names.map(function(e){return"u_"+e+"_t"}),this.useIntegerZoom=r,this.zoom=n,this.maxValue=-1/0,this.layerId=a,this.paintVertexAttributes=t.map(function(e){return{name:"a_"+e,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i};ua.prototype.defines=function(){return[]},ua.prototype.setConstantPatternPositions=function(){},ua.prototype.populatePaintArray=function(d,t,e){var r=this.zoomInPaintVertexArray,n=this.zoomOutPaintVertexArray,i=this.layerId,a=r.length;if(r.reserve(d),n.reserve(d),e&&t.patterns&&t.patterns[i]){var o=t.patterns[i],s=o.min,u=o.mid,l=o.max,p=e[s],c=e[u],g=e[l];if(!p||!c||!g)return;for(var h=a;h<d;h++)r.emplaceBack(c.tl[0],c.tl[1],c.br[0],c.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1]),n.emplaceBack(c.tl[0],c.tl[1],c.br[0],c.br[1],g.tl[0],g.tl[1],g.br[0],g.br[1])}},ua.prototype.updatePaintArray=function(g,t,e,r,n){var i=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,o=this.layerId;if(n&&e.patterns&&e.patterns[o]){var s=e.patterns[o],u=s.min,l=s.mid,p=s.max,c=n[u],h=n[l],m=n[p];if(!c||!h||!m)return;for(var y=g;y<t;y++)i.emplace(y,h.tl[0],h.tl[1],h.br[0],h.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1]),a.emplace(y,h.tl[0],h.tl[1],h.br[0],h.br[1],m.tl[0],m.tl[1],m.br[0],m.br[1])}},ua.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ua.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ua.prototype.setUniforms=function(a,t){t.set(0)},ua.prototype.getBinding=function(a,t){return new Yi(a,t)};var la=function(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new Ki,this._bufferOffset=0};la.createDynamic=function(d,t,e){var r=new la,n=[];for(var i in d.paint._values)if(e(i)){var a=d.paint.get(i);if(a instanceof Yn&&mr(a.property.specification)){var o=ia(i,d.type),s=a.property.specification.type,u=a.property.useIntegerZoom;if("cross-faded"===a.property.specification["property-type"]||"cross-faded-data-driven"===a.property.specification["property-type"]){if("constant"===a.value.kind)r.binders[i]=new aa(a.value.value,o,s),n.push("/u_"+i);else{var l=ha(i,s,"source");r.binders[i]=new ua(a.value,o,s,u,t,l,d.id),n.push("/a_"+i)}}else if("constant"===a.value.kind)r.binders[i]=new na(a.value.value,o,s),n.push("/u_"+i);else if("source"===a.value.kind){var p=ha(i,s,"source");r.binders[i]=new oa(a.value,o,s,p),n.push("/a_"+i)}else{var c=ha(i,s,"composite");r.binders[i]=new sa(a.value,o,s,u,t,c),n.push("/z_"+i)}}}return r.cacheKey=n.sort().join(""),r},la.prototype.populatePaintArrays=function(a,t,e,r){for(var o in this.binders)this.binders[o].populatePaintArray(a,t,r);void 0!==t.id&&this._featureMap.add(+t.id,e,this._bufferOffset,a),this._bufferOffset=a},la.prototype.setConstantPatternPositions=function(a,t){for(var e in this.binders)this.binders[e].setConstantPatternPositions(a,t)},la.prototype.updatePaintArrays=function(d,t,e,r){var n=!1;for(var g in d)for(var a=0,m=this._featureMap.getPositions(+g);a<m.length;a+=1){var s=m[a],u=t.feature(s.index);for(var l in this.binders){var p=this.binders[l];if(!(p instanceof na||p instanceof aa)&&!0===p.expression.isStateDependent){var c=e.paint.get(l);p.expression=c.value,p.updatePaintArray(s.start,s.end,u,d[g],r),n=!0}}}return n},la.prototype.defines=function(){var a=[];for(var t in this.binders)a.push.apply(a,this.binders[t].defines());return a},la.prototype.getPaintVertexBuffers=function(){return this._buffers},la.prototype.getUniforms=function(l,t){var e=[];for(var r in this.binders)for(var n=this.binders[r],i=0,d=n.uniformNames,o;i<d.length;i+=1)if(o=d[i],t[o]){var c=n.getBinding(l,t[o]);e.push({name:o,property:r,binding:c})}return e},la.prototype.setUniforms=function(d,t,e,r){for(var n=0,c=t;n<c.length;n+=1){var a=c[n],o=a.name,s=a.property,p=a.binding;this.binders[s].setUniforms(d,p,r,e.get(s),o)}},la.prototype.updatePatternPaintBuffers=function(a){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof ua){var o=2===a.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;o&&t.push(o)}else(r instanceof oa||r instanceof sa)&&r.paintVertexBuffer&&t.push(r.paintVertexBuffer)}this._buffers=t},la.prototype.upload=function(a){for(var t in this.binders)this.binders[t].upload(a);var e=[];for(var r in this.binders){var o=this.binders[r];(o instanceof oa||o instanceof sa)&&o.paintVertexBuffer&&e.push(o.paintVertexBuffer)}this._buffers=e},la.prototype.destroy=function(){for(var e in this.binders)this.binders[e].destroy()};var pa=function(l,t,e,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var s=0,d=t,a;s<d.length;s+=1)a=d[s],this.programConfigurations[a.id]=la.createDynamic(a,e,r),this.programConfigurations[a.id].layoutAttributes=l;this.needsUpload=!1};pa.prototype.populatePaintArrays=function(a,t,e,r){for(var o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(a,t,e,r);this.needsUpload=!0},pa.prototype.updatePaintArrays=function(l,t,e,r){for(var n=0,s=e,a;n<s.length;n+=1)a=s[n],this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(l,t,a,r)||this.needsUpload},pa.prototype.get=function(e){return this.programConfigurations[e]},pa.prototype.upload=function(a){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(a);this.needsUpload=!1}},pa.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},un("ConstantBinder",na),un("CrossFadedConstantBinder",aa),un("SourceExpressionBinder",oa),un("CrossFadedCompositeBinder",ua),un("CompositeExpressionBinder",sa),un("ProgramConfiguration",la,{omit:["_buffers"]}),un("ProgramConfigurationSet",pa);var ca=(Od=16,{min:-1*ya(2,Od-1),max:ya(2,Od-1)-1}),ma=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ui,this.indexArray=new zi,this.segments=new Zi,this.programConfigurations=new pa(Ni,e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})},Od;ma.prototype.populate=function(l,t){for(var e=0,d=l;e<d.length;e+=1){var n=d[e],i=n.feature,a=n.index,o=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nn(this.zoom),i)){var s=Pn(i);this.addFeature(i,s,a),t.featureIndex.insert(i,s,a,o,this.index)}}},ma.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},ma.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ma.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ma.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ni),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ma.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ma.prototype.addFeature=function(d,t,e){for(var r=0,g=t;r<g.length;r+=1)for(var i=0,h=g[r];i<h.length;i+=1){var o=h[i],s=o.x,u=o.y;if(!(0>s||8192<=s||0>u||8192<=u)){var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),p=l.vertexLength;Dn(this.layoutVertexArray,s,u,-1,-1),Dn(this.layoutVertexArray,s,u,1,-1),Dn(this.layoutVertexArray,s,u,1,1),Dn(this.layoutVertexArray,s,u,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),l.vertexLength+=4,l.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d,e,{})},un("CircleBucket",ma,{omit:["layers"]});var Rd={paint:new ni({"circle-radius":new Qn(Ft.paint_circle["circle-radius"]),"circle-color":new Qn(Ft.paint_circle["circle-color"]),"circle-blur":new Qn(Ft.paint_circle["circle-blur"]),"circle-opacity":new Qn(Ft.paint_circle["circle-opacity"]),"circle-translate":new Wn(Ft.paint_circle["circle-translate"]),"circle-translate-anchor":new Wn(Ft.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wn(Ft.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wn(Ft.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qn(Ft.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qn(Ft.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qn(Ft.paint_circle["circle-stroke-opacity"])})},Va="undefined"==typeof Float32Array?Array:Float32Array;var La;La=Da(),!function(){var a=(e=new Va(4),Va!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e),e}();var Md,jd,Fd,Bd,Nd,Vd;Md=Da(),jd=Oa(1,0,0),Fd=Oa(0,1,0),Bd=Na(),Nd=Na(),Vd=Pa(),!function(){var a=(e=new Va(2),Va!=Float32Array&&(e[0]=0,e[1]=0),e),e}();var Ud=function(a){function t(t){a.call(this,t,Rd)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new ma(e)},t.prototype.queryRadius=function(a){var t=a;return Ea("circle-radius",this,t)+Ea("circle-stroke-width",this,t)+Ma(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(_,t,e,r,n,i,a,o){for(var s=Ta(_,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),i.angle,a),u=this.paint.get("circle-radius").evaluate(t,e)+this.paint.get("circle-stroke-width").evaluate(t,e),l="map"===this.paint.get("circle-pitch-alignment"),p=l?s:function(a,r){return a.map(function(e){return Za(e,r)})}(s,o),c=l?u*a:u,h=0,k=r;h<k.length;h+=1)for(var y=0,w=k[h];y<w.length;y+=1){var m=w[y],v=l?m:Za(m,o),g=c,T=Ra([],[m.x,m.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?g*=T[3]/i.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(g*=i.cameraToCenterDistance/T[3]),Fn(p,v,g))return!0}return!1},t}(ii),Qa=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(ma);un("HeatmapBucket",Qa,{omit:["layers"]});var eo=function(a,t){to(this,a,1,t)};eo.prototype.resize=function(e){ro(this,e,1)},eo.prototype.clone=function(){return new eo({width:this.width,height:this.height},new Uint8Array(this.data))},eo.copy=function(a,t,e,r,o){no(a,t,e,r,o,1)};var ao=function(a,t){to(this,a,4,t)};ao.prototype.resize=function(e){ro(this,e,4)},ao.prototype.replace=function(a,t){t?this.data.set(a):a instanceof Uint8ClampedArray?this.data=new Uint8Array(a.buffer):this.data=a},ao.prototype.clone=function(){return new ao({width:this.width,height:this.height},new Uint8Array(this.data))},ao.copy=function(a,t,e,r,o){no(a,t,e,r,o,4)},un("AlphaImage",eo),un("RGBAImage",ao);var oo={paint:new ni({"heatmap-radius":new Qn(Ft.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qn(Ft.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wn(Ft.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ri(Ft.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wn(Ft.paint_heatmap["heatmap-opacity"])})},so=function(a){function t(t){a.call(this,t,oo),this._updateColorRamp()}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new Qa(e)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){"heatmap-color"===e&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){var e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=io(e,"heatmapDensity"),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(ii),lo={paint:new ni({"hillshade-illumination-direction":new Wn(Ft.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wn(Ft.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wn(Ft.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wn(Ft.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wn(Ft.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wn(Ft.paint_hillshade["hillshade-accent-color"])})},po=function(a){function t(t){a.call(this,t,lo)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(ii),co=zn([{name:"a_pos",components:2,type:"Int16"}],4).members,ho=uo;uo.deviation=function(d,t,e,r){var n=t&&t.length,i=n?t[0]*e:d.length,a=_a(Do(d,0,i,e));if(n)for(var g=0,m=t.length;g<m;g++){var u=t[g]*e,l=g<m-1?t[g+1]*e:d.length;a-=_a(Do(d,u,l,e))}var p=0;for(g=0;g<r.length;g+=3){var x=r[g]*e,h=r[g+1]*e,f=r[g+2]*e;p+=_a((d[x]-d[f])*(d[h+1]-d[x+1])-(d[x]-d[h])*(d[f+1]-d[x+1]))}return 0===a&&0===p?0:_a((p-a)/a)},uo.flatten=function(l){for(var t=l[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,s=0;s<l.length;s++){for(var d=0;d<l[s].length;d++)for(var c=0;c<t;c++)e.vertices.push(l[s][d][c]);0<s&&(r+=l[s-1].length,e.holes.push(r))}return e},ho.default=uo;var fo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ui,this.indexArray=new zi,this.indexArray2=new Ii,this.programConfigurations=new pa(co,e.layers,e.zoom),this.segments=new Zi,this.segments2=new Zi,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};fo.prototype.populate=function(d,t){this.features=[],this.hasPattern=No("fill",this.layers,t);for(var e=0,c=d;e<c.length;e+=1){var n=c[e],i=n.feature,a=n.index,o=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nn(this.zoom),i)){var s=Pn(i),p={sourceLayerIndex:o,index:a,geometry:s,properties:i.properties,type:i.type,patterns:{}};void 0!==i.id&&(p.id=i.id),this.hasPattern?this.features.push(Zo("fill",this.layers,p,this.zoom,t)):this.addFeature(p,s,a,{}),t.featureIndex.insert(i,s,a,o,this.index)}}},fo.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},fo.prototype.addFeatures=function(o,t){for(var e=0,l=this.features;e<l.length;e+=1){var n=l[e],i=n.geometry;this.addFeature(n,i,n.index,t)}},fo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},fo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},fo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,co),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},fo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},fo.prototype.addFeature=function(k,t,e,r){for(var n=0,w=jo(t,500);n<w.length;n+=1){for(var a=w[n],o=0,T=0,A=a;T<A.length;T+=1)o+=A[T].length;for(var l=this.segments.prepareSegment(o,this.layoutVertexArray,this.indexArray),p=l.vertexLength,c=[],h=[],f=0,S=a,d;f<S.length;f+=1)if(d=S[f],0!==d.length){d!==a[0]&&h.push(c.length/2);var C=this.segments2.prepareSegment(d.length,this.layoutVertexArray,this.indexArray2),v=C.vertexLength;this.layoutVertexArray.emplaceBack(d[0].x,d[0].y),this.indexArray2.emplaceBack(v+d.length-1,v),c.push(d[0].x),c.push(d[0].y);for(var g=1;g<d.length;g++)this.layoutVertexArray.emplaceBack(d[g].x,d[g].y),this.indexArray2.emplaceBack(v+g-1,v+g),c.push(d[g].x),c.push(d[g].y);C.vertexLength+=d.length,C.primitiveLength+=d.length}for(var L=ho(c,h),b=0;b<L.length;b+=3)this.indexArray.emplaceBack(p+L[b],p+L[b+1],p+L[b+2]);l.vertexLength+=o,l.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,k,e,r)},un("FillBucket",fo,{omit:["layers","features"]});var Go={paint:new ni({"fill-antialias":new Wn(Ft.paint_fill["fill-antialias"]),"fill-opacity":new Qn(Ft.paint_fill["fill-opacity"]),"fill-color":new Qn(Ft.paint_fill["fill-color"]),"fill-outline-color":new Qn(Ft.paint_fill["fill-outline-color"]),"fill-translate":new Wn(Ft.paint_fill["fill-translate"]),"fill-translate-anchor":new Wn(Ft.paint_fill["fill-translate-anchor"]),"fill-pattern":new ti(Ft.paint_fill["fill-pattern"])})},Xo=function(a){function t(t){a.call(this,t,Go)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(t){a.prototype.recalculate.call(this,t);var e=this.paint._values["fill-outline-color"];"constant"===e.value.kind&&void 0===e.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(e){return new fo(e)},t.prototype.queryRadius=function(){return Ma(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(l,t,e,r,n,i,a){return Bn(Ta(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),i.angle,a),r)},t.prototype.isTileClipped=function(){return!0},t}(ii),Jo=zn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Ho=Ko;Ko.types=["Unknown","Point","LineString","Polygon"],Ko.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,r=1,d=0,c=0,p=0,g=[],u;i.pos<t;){if(0>=d){var h=i.readVarint();r=7&h,d=h>>3}if(d--,1==r||2==r)c+=i.readSVarint(),p+=i.readSVarint(),1==r&&(u&&g.push(u),u=[]),u.push(new ud(c,p));else{if(7!=r)throw new Error("unknown command "+r);u&&u.push(u[0].clone())}}return u&&g.push(u),g},Ko.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var t=d.readVarint()+d.pos,e=1,c=0,g=0,h=0,m=1/0,y=-1/0,f=1/0,x=-1/0;d.pos<t;){if(0>=c){var _=d.readVarint();e=7&_,c=_>>3}if(c--,1==e||2==e)(g+=d.readSVarint())<m&&(m=g),g>y&&(y=g),(h+=d.readSVarint())<f&&(f=h),h>x&&(x=h);else if(7!=e)throw new Error("unknown command "+e)}return[m,f,y,x]},Ko.prototype.toGeoJSON=function(d,t,e){function r(i){for(var t=0;t<i.length;t++){var l=i[t],r=180-360*(l.y+o)/p;i[t]=[360*(l.x+a)/p-180,360/Pe*xa(m(r*Pe/180))-90]}}var p=this.extent*ya(2,e),a=this.extent*d,o=this.extent*t,s=this.loadGeometry(),g=Ko.types[this.type],y,f;switch(this.type){case 1:var x=[];for(y=0;y<s.length;y++)x[y]=s[y][0];r(s=x);break;case 2:for(y=0;y<s.length;y++)r(s[y]);break;case 3:for(s=function(l){var t=l.length;if(1>=t)return[l];for(var e=[],i=0,s,d,c;i<t;i++)c=Wo(l[i]),0!==c&&(null==d&&(d=0>c),d===0>c?(s&&e.push(s),s=[l[i]]):s.push(l[i]));return s&&e.push(s),e}(s),y=0;y<s.length;y++)for(f=0;f<s[y].length;f++)r(s[y][f]);}1===s.length?s=s[0]:g="Multi"+g;var c={type:"Feature",geometry:{type:g,coordinates:s},properties:this.properties};return"id"in this&&(c.id=this.id),c};var Yo=Qo;Qo.prototype.feature=function(a){if(0>a||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var t=this._pbf.readVarint()+this._pbf.pos;return new Ho(this._pbf,t,this.extent,this._keys,this._values)};var ts={VectorTile:function(a,t){this.layers=a.readFields(sl,{},t)},VectorTileFeature:Ho,VectorTileLayer:Yo},is=ts.VectorTileFeature.types,as=ya(2,13),os=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new hi,this.indexArray=new zi,this.programConfigurations=new pa(Jo,e.layers,e.zoom),this.segments=new Zi,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};os.prototype.populate=function(d,t){this.features=[],this.hasPattern=No("fill-extrusion",this.layers,t);for(var e=0,c=d;e<c.length;e+=1){var n=c[e],i=n.feature,a=n.index,o=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nn(this.zoom),i)){var s=Pn(i),p={sourceLayerIndex:o,index:a,geometry:s,properties:i.properties,type:i.type,patterns:{}};void 0!==i.id&&(p.id=i.id),this.hasPattern?this.features.push(Zo("fill-extrusion",this.layers,p,this.zoom,t)):this.addFeature(p,s,a,{}),t.featureIndex.insert(i,s,a,o,this.index,!0)}}},os.prototype.addFeatures=function(o,t){for(var e=0,l=this.features;e<l.length;e+=1){var n=l[e],i=n.geometry;this.addFeature(n,i,n.index,t)}},os.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},os.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},os.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},os.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},os.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},os.prototype.addFeature=function(T,t,e,r){for(var n=0,L=jo(t,500);n<L.length;n+=1){for(var a=L[n],o=0,P=0,D=a;P<D.length;P+=1)o+=D[P].length;for(var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),O=0,R=a,h;O<R.length;O+=1)if(h=R[O],0!==h.length&&!Fl(h))for(var M=0,j=0,F;j<h.length;j++)if(F=h[j],1<=j){var N=h[j-1];if(!Dl(F,N)){l.vertexLength+4>Zi.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var v=F.sub(N)._perp()._unit(),g=N.dist(F);32768<M+g&&(M=0),Ll(this.layoutVertexArray,F.x,F.y,v.x,v.y,0,0,M),Ll(this.layoutVertexArray,F.x,F.y,v.x,v.y,0,1,M),M+=g,Ll(this.layoutVertexArray,N.x,N.y,v.x,v.y,0,0,M),Ll(this.layoutVertexArray,N.x,N.y,v.x,v.y,0,1,M);var x=l.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),l.vertexLength+=4,l.primitiveLength+=2}}if(l.vertexLength+o>Zi.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(o,this.layoutVertexArray,this.indexArray)),"Polygon"===is[T.type]){for(var b=[],_=[],w=l.vertexLength,A=0,V=a,k;A<V.length;A+=1)if(k=V[A],0!==k.length){k!==a[0]&&_.push(b.length/2);for(var U=0,H;U<k.length;U++)H=k[U],Ll(this.layoutVertexArray,H.x,H.y,0,0,1,1,0),b.push(H.x),b.push(H.y)}for(var G=ho(b,_),C=0;C<G.length;C+=3)this.indexArray.emplaceBack(w+G[C],w+G[C+2],w+G[C+1]);l.primitiveLength+=G.length/3,l.vertexLength+=o}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,T,e,r)},un("FillExtrusionBucket",os,{omit:["layers","features"]});var us={paint:new ni({"fill-extrusion-opacity":new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qn(Ft["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ti(Ft["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qn(Ft["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qn(Ft["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Wn(Ft["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},cs=function(a){function t(t){a.call(this,t,us)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new os(e)},t.prototype.queryRadius=function(){return Ma(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,t,e,r,n,a,o,s){var d=Ta(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,o),l=this.paint.get("fill-extrusion-height").evaluate(t,e),p=this.paint.get("fill-extrusion-base").evaluate(t,e),c=function(i,t,e,r){for(var n=[],a=0,d=i;a<d.length;a+=1){var s=d[a],c=[s.x,s.y,r,1];Ra(c,c,t),n.push(new ud(c[0]/c[3],c[1]/c[3]))}return n}(d,s,0,0),u=function(i,t,e,r){for(var n=[],a=[],o=r[8]*t,s=r[9]*t,u=r[10]*t,l=r[11]*t,p=r[8]*e,c=r[9]*e,h=r[10]*e,f=r[11]*e,y=0,C=i;y<C.length;y+=1){for(var m=C[y],v=[],g=[],x=0,E=m;x<E.length;x+=1){var _=E[x],w=_.x,A=_.y,S=r[0]*w+r[4]*A+r[12],k=r[1]*w+r[5]*A+r[13],z=r[2]*w+r[6]*A+r[14],I=r[3]*w+r[7]*A+r[15],P=I+l,T=I+f,L=new ud((S+o)/P,(k+s)/P);L.z=(z+u)/P,v.push(L);var D=new ud((S+p)/T,(k+c)/T);D.z=(z+h)/T,g.push(D)}n.push(v),a.push(g)}return[n,a]}(r,p,l,s);return function(d,t,e){var r=1/0;Bn(e,t)&&(r=Gl(e,t[0]));for(var g=0;g<t.length;g++)for(var m=t[g],a=d[g],o=0;o<m.length-1;o++){var y=m[o],u=m[o+1],l=a[o],p=a[o+1],c=[y,u,p,l,y];ga(e,c)&&(r=ea(r,Gl(e,c)))}return r!==1/0&&r}(u[0],u[1],c)},t}(ii),hs=zn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ds=ts.VectorTileFeature.types,ms=R(37.5*(Pe/180)),gs=.5,xs=ya(2,14)/gs,bs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.features=[],this.hasPattern=!1,this.layoutVertexArray=new fi,this.indexArray=new zi,this.programConfigurations=new pa(hs,e.layers,e.zoom),this.segments=new Zi,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};bs.prototype.populate=function(d,t){this.features=[],this.hasPattern=No("line",this.layers,t);for(var e=0,c=d;e<c.length;e+=1){var n=c[e],i=n.feature,a=n.index,o=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nn(this.zoom),i)){var s=Pn(i),p={sourceLayerIndex:o,index:a,geometry:s,properties:i.properties,type:i.type,patterns:{}};void 0!==i.id&&(p.id=i.id),this.hasPattern?this.features.push(Zo("line",this.layers,p,this.zoom,t)):this.addFeature(p,s,a,{}),t.featureIndex.insert(i,s,a,o,this.index)}}},bs.prototype.update=function(a,t,e){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,t,this.stateDependentLayers,e)},bs.prototype.addFeatures=function(o,t){for(var e=0,l=this.features;e<l.length;e+=1){var n=l[e],i=n.geometry;this.addFeature(n,i,n.index,t)}},bs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},bs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},bs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hs),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},bs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},bs.prototype.addFeature=function(d,t,e,r){for(var n=this.layers[0].layout,i=n.get("line-join").evaluate(d,{}),a=n.get("line-cap"),o=n.get("line-miter-limit"),s=n.get("line-round-limit"),u=0,g=t,p;u<g.length;u+=1)p=g[u],this.addLine(p,d,i,a,o,s,e,r)},bs.prototype.addLine=function(g,t,e,r,n,H,a,o){var s=null;t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")&&(s={start:t.properties.mapbox_clip_start,end:t.properties.mapbox_clip_end,tileTotal:void 0});for(var G="Polygon"===ds[t.type],l=g.length;2<=l&&g[l-1].equals(g[l-2]);)l--;for(var Y=0;Y<l-1&&g[Y].equals(g[Y+1]);)Y++;if(!(l<(G?3:2))){s&&(s.tileTotal=function(l,t,e){for(var r=0,s=t,d,c;s<e-1;s++)d=l[s],c=l[s+1],r+=d.dist(c);return r}(g,Y,l)),"bevel"===e&&(n=1.05);var W=15*(8192/(512*this.overscaling)),h=g[Y],f=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.distance=0;var y=G?"butt":r,x=!0,X,Z,K,J,Q,$,ee;this.e1=this.e2=this.e3=-1,G&&(X=g[l-2],ee=h.sub(X)._unit()._perp());for(var te=Y;te<l;te++)if(!(Q=G&&te==l-1?g[Y+1]:g[te+1])||!g[te].equals(Q)){ee&&($=ee),X&&(J=X),X=g[te],ee=Q?Q.sub(X)._unit()._perp():$;var ae=($=$||ee).add(ee);0===ae.x&&0===ae.y||ae._unit();var re=ae.x*ee.x+ae.y*ee.y,I=0==re?1/0:1/re,B=re<ms&&J&&Q;if(B&&te>Y){var C=X.dist(J);if(C>2*W){var E=X.sub(X.sub(J)._mult(W/C)._round());this.distance+=E.dist(J),this.addCurrentVertex(E,this.distance,$.mult(1),0,0,!1,f,s),J=E}}var M=J&&Q,T=M?e:Q?r:y;if(M&&"round"===T&&(I<H?T="miter":2>=I&&(T="fakeround")),"miter"===T&&I>n&&(T="bevel"),"bevel"===T&&(2<I&&(T="flipbevel"),I<n&&(T="miter")),J&&(this.distance+=X.dist(J)),"miter"===T)ae._mult(I),this.addCurrentVertex(X,this.distance,ae,0,0,!1,f,s);else if("flipbevel"===T){if(100<I)ae=ee.clone().mult(-1);else{var oe=0<$.x*ee.y-$.y*ee.x?-1:1,V=I*$.add(ee).mag()/$.sub(ee).mag();ae._perp()._mult(V*oe)}this.addCurrentVertex(X,this.distance,ae,0,0,!1,f,s),this.addCurrentVertex(X,this.distance,ae.mult(-1),0,0,!1,f,s)}else if("bevel"===T||"fakeround"===T){var F=0<$.x*ee.y-$.y*ee.x,L=-N(I*I-1);if(F?(K=0,Z=L):(Z=0,K=L),x||this.addCurrentVertex(X,this.distance,$,Z,K,!1,f,s),"fakeround"===T){for(var D=ba(8*(.5-(re-.5))),O=void 0,ie=0;ie<D;ie++)O=ee.mult((ie+1)/(D+1))._add($)._unit(),this.addPieSliceVertex(X,this.distance,O,F,f,s);this.addPieSliceVertex(X,this.distance,ae,F,f,s);for(var ne=D-1;0<=ne;ne--)O=$.mult((ne+1)/(D+1))._add(ee)._unit(),this.addPieSliceVertex(X,this.distance,O,F,f,s)}Q&&this.addCurrentVertex(X,this.distance,ee,-Z,-K,!1,f,s)}else"butt"===T?(x||this.addCurrentVertex(X,this.distance,$,0,0,!1,f,s),Q&&this.addCurrentVertex(X,this.distance,ee,0,0,!1,f,s)):"square"===T?(x||(this.addCurrentVertex(X,this.distance,$,1,1,!1,f,s),this.e1=this.e2=-1),Q&&this.addCurrentVertex(X,this.distance,ee,-1,-1,!1,f,s)):"round"==T&&(x||(this.addCurrentVertex(X,this.distance,$,0,0,!1,f,s),this.addCurrentVertex(X,this.distance,$,1,1,!0,f,s),this.e1=this.e2=-1),Q&&(this.addCurrentVertex(X,this.distance,ee,-1,-1,!0,f,s),this.addCurrentVertex(X,this.distance,ee,0,0,!1,f,s)));if(B&&te<l-1){var le=X.dist(Q);if(le>2*W){var q=X.add(Q.sub(X)._mult(W/le)._round());this.distance+=q.dist(X),this.addCurrentVertex(q,this.distance,ee.mult(1),0,0,!1,f,s),X=q}}x=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,o)}},bs.prototype.addCurrentVertex=function(d,t,c,r,n,i,a,o){var s=this.layoutVertexArray,l=this.indexArray,p;o&&(t=Wl(t,o)),p=c.clone(),r&&p._sub(c.perp()._mult(r)),Yl(s,d,p,i,!1,r,t),this.e3=a.vertexLength++,0<=this.e1&&0<=this.e2&&(l.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,p=c.mult(-1),n&&p._sub(c.perp()._mult(n)),Yl(s,d,p,i,!0,-n,t),this.e3=a.vertexLength++,0<=this.e1&&0<=this.e2&&(l.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,t>xs/2&&!o&&(this.distance=0,this.addCurrentVertex(d,this.distance,c,r,n,i,a))},bs.prototype.addPieSliceVertex=function(l,t,d,c,n,i){d=d.mult(c?-1:1);var a=this.layoutVertexArray,o=this.indexArray;i&&(t=Wl(t,i)),Yl(a,l,d,!1,c,0,t),this.e3=n.vertexLength++,0<=this.e1&&0<=this.e2&&(o.emplaceBack(this.e1,this.e2,this.e3),n.primitiveLength++),c?this.e2=this.e3:this.e1=this.e3},un("LineBucket",bs,{omit:["layers","features"]});var ws=new ni({"line-cap":new Wn(Ft.layout_line["line-cap"]),"line-join":new Qn(Ft.layout_line["line-join"]),"line-miter-limit":new Wn(Ft.layout_line["line-miter-limit"]),"line-round-limit":new Wn(Ft.layout_line["line-round-limit"])}),Ss={paint:new ni({"line-opacity":new Qn(Ft.paint_line["line-opacity"]),"line-color":new Qn(Ft.paint_line["line-color"]),"line-translate":new Wn(Ft.paint_line["line-translate"]),"line-translate-anchor":new Wn(Ft.paint_line["line-translate-anchor"]),"line-width":new Qn(Ft.paint_line["line-width"]),"line-gap-width":new Qn(Ft.paint_line["line-gap-width"]),"line-offset":new Qn(Ft.paint_line["line-offset"]),"line-blur":new Qn(Ft.paint_line["line-blur"]),"line-dasharray":new ei(Ft.paint_line["line-dasharray"]),"line-pattern":new ti(Ft.paint_line["line-pattern"]),"line-gradient":new ri(Ft.paint_line["line-gradient"])}),layout:ws},ks=new(function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.possiblyEvaluate=function(t,e){return e=new Nn(ba(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),a.prototype.possiblyEvaluate.call(this,t,e)},t.prototype.evaluate=function(t,e,o,n){return e=dt({},e,{zoom:ba(e.zoom)}),a.prototype.evaluate.call(this,t,e,o,n)},t}(Qn))(Ss.paint.properties["line-width"].specification);ks.useIntegerZoom=!0;var zs=function(a){function t(t){a.call(this,t,Ss)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(e){"line-gradient"===e&&this._updateGradient()},t.prototype._updateGradient=function(){var e=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=io(e,"lineProgress"),this.gradientTexture=null},t.prototype.recalculate=function(t){a.prototype.recalculate.call(this,t),this.paint._values["line-floorwidth"]=ks.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},t.prototype.createBucket=function(e){return new bs(e)},t.prototype.queryRadius=function(a){var t=a,e=Xl(Ea("line-width",this,t),Ea("line-gap-width",this,t)),r=Ea("line-offset",this,t);return e/2+_a(r)+Ma(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,t,e,r,d,a,o){var s=Ta(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,o),c=o/2*Xl(this.paint.get("line-width").evaluate(t,e),this.paint.get("line-gap-width").evaluate(t,e)),l=this.paint.get("line-offset").evaluate(t,e);return l&&(r=function(i,t){for(var e=[],r=new ud(0,0),n=0;n<i.length;n++){for(var g=i[n],o=[],s=0;s<g.length;s++){var m=g[s-1],l=g[s],p=g[s+1],c=0==s?r:l.sub(m)._unit()._perp(),h=s==g.length-1?r:p.sub(l)._unit()._perp(),f=c._add(h)._unit(),y=f.x*h.x+f.y*h.y;f._mult(1/y),o.push(f._mult(t)._add(l))}e.push(o)}return e}(r,l*o)),function(o,t,e){for(var r=0,l;r<t.length;r++){if(l=t[r],3<=o.length)for(var s=0;s<l.length;s++)if(Ba(o,l[s]))return!0;if(wa(o,l,e))return!0}return!1}(s,r,c)},t.prototype.isTileClipped=function(){return!0},t}(ii),Is=zn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),Cs=zn([{name:"a_projected_pos",components:3,type:"Float32"}],4),Es=(zn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),zn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ms=(zn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),zn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ts=zn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);zn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"}]),zn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"radialTextOffset"}]),zn([{type:"Float32",name:"offsetX"}]),zn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ps={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","¢":"\uFFE0","£":"\uFFE1","¥":"\uFFE5","¦":"\uFFE4","¬":"\uFFE2","¯":"\uFFE3","–":"\uFE32","—":"\uFE31","‘":"\uFE43","’":"\uFE44","“":"\uFE41","”":"\uFE42","…":"\uFE19","‧":"\u30FB","₩":"\uFFE6","、":"\uFE11","。":"\uFE12","〈":"\uFE3F","〉":"\uFE40","《":"\uFE3D","》":"\uFE3E","「":"\uFE41","」":"\uFE42","『":"\uFE43","』":"\uFE44","【":"\uFE3B","】":"\uFE3C","〔":"\uFE39","〕":"\uFE3A","〖":"\uFE17","〗":"\uFE18","！":"\uFE15","（":"\uFE35","）":"\uFE36","，":"\uFE10","－":"\uFE32","．":"\u30FB","：":"\uFE13","；":"\uFE14","＜":"\uFE3F","＞":"\uFE40","？":"\uFE16","［":"\uFE47","］":"\uFE48","＿":"\uFE33","｛":"\uFE37","｜":"\u2015","｝":"\uFE38","｟":"\uFE35","｠":"\uFE36","｡":"\uFE12","｢":"\uFE41","｣":"\uFE42"},Fs=function(a){function t(t,e,r,o){a.call(this,t,e),this.angle=r,void 0!==o&&(this.segment=o)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(ud);un("Anchor",Fs);var Ls=Object.freeze({getSizeData:Jl,evaluateSizeForFeature:Ql,evaluateSizeForZoom:$l,SIZE_PACK_FACTOR:256}),js=ts.VectorTileFeature.types,qs=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],Ns=function(e){this.layoutVertexArray=new di,this.indexArray=new zi,this.programConfigurations=e,this.segments=new Zi,this.dynamicLayoutVertexArray=new mi,this.opacityVertexArray=new vi,this.placedSymbolArray=new Vi};Ns.prototype.upload=function(a,t,e,r){e&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Is.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Cs.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,qs,!0),this.opacityVertexBuffer.itemSize=1),(e||r)&&this.programConfigurations.upload(a)},Ns.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},un("SymbolBuffers",Ns);var Gs=function(a,t,e){this.layoutVertexArray=new a,this.layoutAttributes=t,this.indexArray=new e,this.segments=new Zi,this.collisionVertexArray=new bi};Gs.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Es.members,!0)},Gs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},un("CollisionBuffers",Gs);var Xs=function(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1;var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jl(this.zoom,t["text-size"]),this.iconSizeData=Jl(this.zoom,t["icon-size"]);var e=this.layers[0].layout,r=e.get("symbol-sort-key"),n=e.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==n&&void 0!==r.constantOr(1);var i="viewport-y"===n||"auto"===n&&!this.sortFeaturesByKey;this.sortFeaturesByY=i&&(e.get("text-allow-overlap")||e.get("icon-allow-overlap")||e.get("text-ignore-placement")||e.get("icon-ignore-placement")),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id}),this.sourceID=o.sourceID};Xs.prototype.createArrays=function(){this.text=new Ns(new pa(Is.members,this.layers,this.zoom,function(e){return /^text/.test(e)})),this.icon=new Ns(new pa(Is.members,this.layers,this.zoom,function(e){return /^icon/.test(e)})),this.collisionBox=new Gs(xi,Ms.members,Ii),this.collisionCircle=new Gs(xi,Ts.members,zi),this.glyphOffsetArray=new Oi,this.lineVertexArray=new Ui,this.symbolInstances=new Li},Xs.prototype.calculateGlyphDependencies=function(o,t,e,r){for(var n=0;n<o.length;n++)if(t[o.charCodeAt(n)]=!0,e&&r){var l=Ps[o.charAt(n)];l&&(t[l.charCodeAt(0)]=!0)}},Xs.prototype.populate=function(T,t){var e=this.layers[0],r=e.layout,n=r.get("text-font"),i=r.get("text-field"),a=r.get("icon-image"),o=("constant"!==i.value.kind||0<i.value.value.toString().length)&&("constant"!==n.value.kind||0<n.value.value.length),s="constant"!==a.value.kind||a.value.value&&0<a.value.value.length,u=r.get("symbol-sort-key");if(this.features=[],o||s){for(var l=t.iconDependencies,p=t.glyphDependencies,c=new Nn(this.zoom),h=0,L=T;h<L.length;h+=1){var y=L[h],d=y.feature,m=y.index,v=y.sourceLayerIndex;if(e._featureFilter(c,d)){var g=void 0;if(o){var P=e.getValueAndResolveTokens("text-field",d);g=Kl(P instanceof se?P:se.fromString(P),e,d)}var b=void 0;if(s&&(b=e.getValueAndResolveTokens("icon-image",d)),g||b){var D=this.sortFeaturesByKey?u.evaluate(d,{}):void 0,w={text:g,icon:b,index:m,sourceLayerIndex:v,geometry:Pn(d),properties:d.properties,type:js[d.type],sortKey:D};if(void 0!==d.id&&(w.id=d.id),this.features.push(w),b&&(l[b]=!0),g)for(var A=n.evaluate(d,{}).join(","),S="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),k=0,O=g.sections;k<O.length;k+=1){var I=O[k],R=fn(g.toString()),C=I.fontStack||A,E=p[C]=p[C]||{};this.calculateGlyphDependencies(I.text,E,S,R)}}}}"line"===r.get("symbol-placement")&&(this.features=function(g){function t(t){_.push(g[t]),r++}function a(r,t,e){var o=x[r];return delete x[r],x[t]=o,_[o].geometry[0].pop(),_[o].geometry[0]=_[o].geometry[0].concat(e[0]),o}function o(e,t,r){var o=u[t];return delete u[t],u[e]=o,_[o].geometry[0].shift(),_[o].geometry[0]=r[0].concat(_[o].geometry[0]),o}function s(a,t,e){var r=e?t[0][t[0].length-1]:t[0][0];return a+":"+r.x+":"+r.y}for(var u={},x={},_=[],r=0,e=0;e<g.length;e++){var n=g[e],p=n.geometry,c=n.text?n.text.toString():null;if(c){var h=s(c,p),f=s(c,p,!0);if(h in x&&f in u&&x[h]!==u[f]){var y=o(h,f,p),d=a(h,f,_[y].geometry);delete u[h],delete x[f],x[s(c,_[d].geometry,!0)]=d,_[y].geometry=null}else h in x?a(h,f,p):f in u?o(h,f,p):(t(e),u[h]=r-1,x[f]=r-1)}else t(e)}return _.filter(function(e){return e.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(a,t){return a.sortKey-t.sortKey})}},Xs.prototype.update=function(a,t,e){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,t,this.layers,e),this.icon.programConfigurations.updatePaintArrays(a,t,this.layers,e))},Xs.prototype.isEmpty=function(){return 0===this.symbolInstances.length},Xs.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Xs.prototype.upload=function(e){this.uploaded||(this.collisionBox.upload(e),this.collisionCircle.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Xs.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},Xs.prototype.addToLineVertexArray=function(d,t){var e=this.lineVertexArray.length;if(void 0!==d.segment){for(var r=d.dist(t[d.segment+1]),c=d.dist(t[d.segment]),p={},a=d.segment+1;a<t.length;a++)p[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:r},a<t.length-1&&(r+=t[a+1].dist(t[a]));for(var g=d.segment||0;0<=g;g--)p[g]={x:t[g].x,y:t[g].y,tileUnitDistanceFromAnchor:c},0<g&&(c+=t[g-1].dist(t[g]));for(var h=0,m;h<t.length;h++)m=p[h],this.lineVertexArray.emplaceBack(m.x,m.y,m.tileUnitDistanceFromAnchor)}return{lineStartIndex:e,lineLength:this.lineVertexArray.length-e}},Xs.prototype.addSymbols=function(T,t,e,r,n,i,a,o,s,u){for(var l=T.indexArray,p=T.layoutVertexArray,c=T.dynamicLayoutVertexArray,h=T.segments.prepareSegment(4*t.length,T.layoutVertexArray,T.indexArray,i.sortKey),f=this.glyphOffsetArray.length,y=h.vertexLength,d=0,C=t;d<C.length;d+=1){var v=C[d],g=v.tl,x=v.tr,b=v.bl,_=v.br,w=v.tex,A=h.vertexLength,S=v.glyphOffset[1];es(p,o.x,o.y,g.x,S+g.y,w.x,w.y,e),es(p,o.x,o.y,x.x,S+x.y,w.x+w.w,w.y,e),es(p,o.x,o.y,b.x,S+b.y,w.x,w.y+w.h,e),es(p,o.x,o.y,_.x,S+_.y,w.x+w.w,w.y+w.h,e),rs(c,o,0),l.emplaceBack(A,A+1,A+2),l.emplaceBack(A+1,A+2,A+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(v.glyphOffset[0])}T.placedSymbolArray.emplaceBack(o.x,o.y,f,this.glyphOffsetArray.length-f,y,s,u,o.segment,e?e[0]:0,e?e[1]:0,r[0],r[1],a,!1,0),T.programConfigurations.populatePaintArrays(T.layoutVertexArray.length,i,i.index,{})},Xs.prototype._addCollisionDebugVertex=function(o,t,e,r,n,i){return t.emplaceBack(0,0),o.emplaceBack(e.x,e.y,r,n,V(i.x),V(i.y))},Xs.prototype.addCollisionDebugVertices=function(i,t,e,r,n,a,o,s){var u=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=u.vertexLength,p=n.layoutVertexArray,c=n.collisionVertexArray,g=o.anchorX,h=o.anchorY;if(this._addCollisionDebugVertex(p,c,a,g,h,new ud(i,t)),this._addCollisionDebugVertex(p,c,a,g,h,new ud(e,t)),this._addCollisionDebugVertex(p,c,a,g,h,new ud(e,r)),this._addCollisionDebugVertex(p,c,a,g,h,new ud(i,r)),u.vertexLength+=4,s){var y=n.indexArray;y.emplaceBack(l,l+1,l+2),y.emplaceBack(l,l+2,l+3),u.primitiveLength+=2}else{var d=n.indexArray;d.emplaceBack(l,l+1),d.emplaceBack(l+1,l+2),d.emplaceBack(l+2,l+3),d.emplaceBack(l+3,l),u.primitiveLength+=4}},Xs.prototype.addDebugCollisionBoxes=function(d,t,e){for(var r=d;r<t;r++){var c=this.collisionBoxArray.get(r),i=c.x1,a=c.y1,o=c.x2,s=c.y2,p=0<c.radius;this.addCollisionDebugVertices(i,a,o,s,p?this.collisionCircle:this.collisionBox,c.anchorPoint,e,p)}},Xs.prototype.generateCollisionDebugBuffers=function(){for(var a=0,r;a<this.symbolInstances.length;a++)r=this.symbolInstances.get(a),this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r)},Xs.prototype._deserializeCollisionBoxesForSymbol=function(d,t,e,r,n){for(var i={},a=t,c;a<e;a++){if(c=d.get(a),0===c.radius){i.textBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY},i.textFeatureIndex=c.featureIndex;break}i.textCircles||(i.textCircles=[],i.textFeatureIndex=c.featureIndex),i.textCircles.push(c.anchorPointX,c.anchorPointY,c.radius,c.signedDistanceFromAnchor,1)}for(var p=r,g;p<n;p++)if(g=d.get(p),0===g.radius){i.iconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},i.iconFeatureIndex=g.featureIndex;break}return i},Xs.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var t=0,o;t<this.symbolInstances.length;t++)o=this.symbolInstances.get(t),this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,o.textBoxStartIndex,o.textBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex))},Xs.prototype.hasTextData=function(){return 0<this.text.segments.get().length},Xs.prototype.hasIconData=function(){return 0<this.icon.segments.get().length},Xs.prototype.hasCollisionBoxData=function(){return 0<this.collisionBox.segments.get().length},Xs.prototype.hasCollisionCircleData=function(){return 0<this.collisionCircle.segments.get().length},Xs.prototype.addIndicesForPlacedTextSymbol=function(a){for(var t=this.text.placedSymbolArray.get(a),e=t.vertexStartIndex+4*t.numGlyphs,r=t.vertexStartIndex;r<e;r+=4)this.text.indexArray.emplaceBack(r,r+1,r+2),this.text.indexArray.emplaceBack(r+1,r+2,r+3)},Xs.prototype.getSortedSymbolIndexes=function(l){if(this.sortedAngle===l&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=De(l),e=R(l),r=[],n=[],i=[],a=0;a<this.symbolInstances.length;++a){i.push(a);var d=this.symbolInstances.get(a);r.push(0|V(t*d.anchorX+e*d.anchorY)),n.push(d.featureIndex)}return i.sort(function(a,t){return r[a]-r[t]||n[t]-n[a]}),i},Xs.prototype.sortFeatures=function(l){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var e=0,t=this.symbolInstanceIndexes;e<t.length;e+=1){var n=t[e],i=this.symbolInstances.get(n);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach(function(e,t,a){0<=e&&a.indexOf(e)===t&&d.addIndicesForPlacedTextSymbol(e)}),0<=i.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedTextSymbol(i.verticalPlacedTextSymbolIndex);var a=this.icon.placedSymbolArray.get(n);if(a.numGlyphs){var o=a.vertexStartIndex;this.icon.indexArray.emplaceBack(o,o+1,o+2),this.icon.indexArray.emplaceBack(o+1,o+2,o+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},un("SymbolBucket",Xs,{omit:["layers","collisionBoxArray","features","compareText"]}),Xs.MAX_GLYPHS=65535,Xs.addDynamicAttributes=rs;var Js=new ni({"symbol-placement":new Wn(Ft.layout_symbol["symbol-placement"]),"symbol-spacing":new Wn(Ft.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wn(Ft.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qn(Ft.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wn(Ft.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Wn(Ft.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Wn(Ft.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wn(Ft.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wn(Ft.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qn(Ft.layout_symbol["icon-size"]),"icon-text-fit":new Wn(Ft.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Wn(Ft.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qn(Ft.layout_symbol["icon-image"]),"icon-rotate":new Qn(Ft.layout_symbol["icon-rotate"]),"icon-padding":new Wn(Ft.layout_symbol["icon-padding"]),"icon-keep-upright":new Wn(Ft.layout_symbol["icon-keep-upright"]),"icon-offset":new Qn(Ft.layout_symbol["icon-offset"]),"icon-anchor":new Qn(Ft.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wn(Ft.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wn(Ft.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wn(Ft.layout_symbol["text-rotation-alignment"]),"text-field":new Qn(Ft.layout_symbol["text-field"]),"text-font":new Qn(Ft.layout_symbol["text-font"]),"text-size":new Qn(Ft.layout_symbol["text-size"]),"text-max-width":new Qn(Ft.layout_symbol["text-max-width"]),"text-line-height":new Wn(Ft.layout_symbol["text-line-height"]),"text-letter-spacing":new Qn(Ft.layout_symbol["text-letter-spacing"]),"text-justify":new Qn(Ft.layout_symbol["text-justify"]),"text-radial-offset":new Qn(Ft.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wn(Ft.layout_symbol["text-variable-anchor"]),"text-anchor":new Qn(Ft.layout_symbol["text-anchor"]),"text-max-angle":new Wn(Ft.layout_symbol["text-max-angle"]),"text-rotate":new Qn(Ft.layout_symbol["text-rotate"]),"text-padding":new Wn(Ft.layout_symbol["text-padding"]),"text-keep-upright":new Wn(Ft.layout_symbol["text-keep-upright"]),"text-transform":new Qn(Ft.layout_symbol["text-transform"]),"text-offset":new Qn(Ft.layout_symbol["text-offset"]),"text-allow-overlap":new Wn(Ft.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Wn(Ft.layout_symbol["text-ignore-placement"]),"text-optional":new Wn(Ft.layout_symbol["text-optional"])}),Hs={paint:new ni({"icon-opacity":new Qn(Ft.paint_symbol["icon-opacity"]),"icon-color":new Qn(Ft.paint_symbol["icon-color"]),"icon-halo-color":new Qn(Ft.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qn(Ft.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qn(Ft.paint_symbol["icon-halo-blur"]),"icon-translate":new Wn(Ft.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wn(Ft.paint_symbol["icon-translate-anchor"]),"text-opacity":new Qn(Ft.paint_symbol["text-opacity"]),"text-color":new Qn(Ft.paint_symbol["text-color"]),"text-halo-color":new Qn(Ft.paint_symbol["text-halo-color"]),"text-halo-width":new Qn(Ft.paint_symbol["text-halo-width"]),"text-halo-blur":new Qn(Ft.paint_symbol["text-halo-blur"]),"text-translate":new Wn(Ft.paint_symbol["text-translate"]),"text-translate-anchor":new Wn(Ft.paint_symbol["text-translate-anchor"])}),layout:Js},Ys=function(a){function t(t){a.call(this,t,Hs)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(t){a.prototype.recalculate.call(this,t),"auto"===this.layout.get("icon-rotation-alignment")&&("point"===this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="viewport":this.layout._values["icon-rotation-alignment"]="map"),"auto"===this.layout.get("text-rotation-alignment")&&("point"===this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="viewport":this.layout._values["text-rotation-alignment"]="map"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},t.prototype.getValueAndResolveTokens=function(a,t){var e=this.layout.get(a).evaluate(t,{}),o=this._unevaluatedLayout._values[a],i;return o.isDataDriven()||Tr(o.value)?e:(i=t.properties,e.replace(/{([^{}]+)}/g,function(a,t){return t in i?i[t]+"":""}))},t.prototype.createBucket=function(e){return new Xs(e)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t}(ii),$s={paint:new ni({"background-color":new Wn(Ft.paint_background["background-color"]),"background-pattern":new ei(Ft.paint_background["background-pattern"]),"background-opacity":new Wn(Ft.paint_background["background-opacity"])})},Ws=function(a){function t(t){a.call(this,t,$s)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(ii),Qs={paint:new ni({"raster-opacity":new Wn(Ft.paint_raster["raster-opacity"]),"raster-hue-rotate":new Wn(Ft.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wn(Ft.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wn(Ft.paint_raster["raster-brightness-max"]),"raster-saturation":new Wn(Ft.paint_raster["raster-saturation"]),"raster-contrast":new Wn(Ft.paint_raster["raster-contrast"]),"raster-resampling":new Wn(Ft.paint_raster["raster-resampling"]),"raster-fade-duration":new Wn(Ft.paint_raster["raster-fade-duration"])})},Hd=function(a){function t(t){a.call(this,t,Qs)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(ii),Gd=function(a){function t(t){a.call(this,t,{}),this.implementation=t}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},t.prototype.onRemove=function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},t}(ii),qd={circle:Ud,heatmap:so,hillshade:po,fill:Xo,"fill-extrusion":cs,line:zs,symbol:Ys,background:Ws,raster:Hd},Yd=function(a,t){var e=t.pixelRatio,r=t.version;this.paddedRect=a,this.pixelRatio=e,this.version=r},Wd={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Wd.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Wd.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Wd.tlbr.get=function(){return this.tl.concat(this.br)},Wd.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Yd.prototype,Wd);var Xd=function(x,t){var e={},r={};this.haveRenderCallbacks=[];var n=[];this.addImages(x,e,n),this.addImages(t,r,n);var i=ns(n),a=i.w,o=i.h,s=new ao({width:a||1,height:o||1});for(var u in x){var l=x[u],p=e[u].paddedRect;ao.copy(l.data,s,{x:0,y:0},{x:p.x+1,y:p.y+1},l.data)}for(var c in t){var h=t[c],f=r[c].paddedRect,y=f.x+1,d=f.y+1,m=h.data.width,_=h.data.height;ao.copy(h.data,s,{x:0,y:0},{x:y,y:d},h.data),ao.copy(h.data,s,{x:0,y:_-1},{x:y,y:d-1},{width:m,height:1}),ao.copy(h.data,s,{x:0,y:0},{x:y,y:d+_},{width:m,height:1}),ao.copy(h.data,s,{x:m-1,y:0},{x:y-1,y:d},{width:1,height:_}),ao.copy(h.data,s,{x:0,y:0},{x:y+m,y:d},{width:1,height:_})}this.image=s,this.iconPositions=e,this.patternPositions=r};Xd.prototype.addImages=function(o,t,e){for(var r in o){var n=o[r],i={x:0,y:0,w:n.data.width+2,h:n.data.height+2};e.push(i),t[r]=new Yd(i,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(r)}},Xd.prototype.patchUpdatedImages=function(a,t){for(var e in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[e],a.getImage(e),t),this.patchUpdatedImage(this.patternPositions[e],a.getImage(e),t)},Xd.prototype.patchUpdatedImage=function(o,t,e){if(o&&t&&o.version!==t.version){o.version=t.version;var r=o.tl,n=r[0],i=r[1];e.update(t.data,void 0,{x:n,y:i})}},un("ImagePosition",Yd),un("ImageAtlas",Xd);var Zd=self.HTMLImageElement,Kd=self.HTMLCanvasElement,Jd=self.HTMLVideoElement,Qd=self.ImageData,$d=function(a,t,e,r){this.context=a,this.format=e,this.texture=a.gl.createTexture(),this.update(t,r)};$d.prototype.update=function(d,t,e){var r=d.width,n=d.height,i=!(this.size&&this.size[0]===r&&this.size[1]===n||e),a=this.context,o=a.gl;if(this.useMipmap=!!(t&&t.useMipmap),o.bindTexture(o.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===o.RGBA&&(!t||!1!==t.premultiply)),i)this.size=[r,n],d instanceof Zd||d instanceof Kd||d instanceof Jd||d instanceof Qd?o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,o.UNSIGNED_BYTE,d):o.texImage2D(o.TEXTURE_2D,0,this.format,r,n,0,this.format,o.UNSIGNED_BYTE,d.data);else{var s=e||{x:0,y:0},c=s.x,l=s.y;d instanceof Zd||d instanceof Kd||d instanceof Jd||d instanceof Qd?o.texSubImage2D(o.TEXTURE_2D,0,c,l,o.RGBA,o.UNSIGNED_BYTE,d):o.texSubImage2D(o.TEXTURE_2D,0,c,l,r,n,o.RGBA,o.UNSIGNED_BYTE,d.data)}this.useMipmap&&this.isSizePowerOfTwo()&&o.generateMipmap(o.TEXTURE_2D)},$d.prototype.bind=function(a,t,e){var o=this.context.gl;o.bindTexture(o.TEXTURE_2D,this.texture),e!==o.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(e=o.LINEAR),a!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,e||a),this.filter=a),t!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,t),this.wrap=t)},$d.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&0==P(this.size[0])/E%1},$d.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ec=function(d,t,e,r,n){var i=8*n-r-1,s=(1<<i)-1,u=s>>1,l=-7,g=e?n-1:0,m=e?-1:1,h=d[t+g],y,x;for(g+=m,y=h&(1<<-l)-1,h>>=-l,l+=i;0<l;y=256*y+d[t+g],g+=m,l-=8);for(x=y&(1<<-l)-1,y>>=-l,l+=r;0<l;x=256*x+d[t+g],g+=m,l-=8);if(0===y)y=1-u;else{if(y===s)return x?NaN:1/0*(h?-1:1);x+=ya(2,r),y-=u}return(h?-1:1)*x*ya(2,y-r)},tc=function(g,t,m,r,n,x){var a=8*x-n-1,_=(1<<a)-1,p=_>>1,c=23===n?ya(2,-24)-ya(2,-77):0,h=r?0:x-1,b=r?1:-1,y=0>t||0===t&&0>1/t?1:0,d,v,k;for(t=_a(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,d=_):(d=ba(P(t)/E),1>t*(k=ya(2,-d))&&(d--,k*=2),2<=(t+=1<=d+p?c/k:c*ya(2,1-p))*k&&(d++,k/=2),d+p>=_?(v=0,d=_):1<=d+p?(v=(t*k-1)*ya(2,n),d+=p):(v=t*ya(2,p-1)*ya(2,n),d=0));8<=n;g[m+h]=255&v,h+=b,v/=256,n-=8);for(d=d<<n|v,a+=n;0<a;g[m+h]=255&d,h+=b,d/=256,a-=8);g[m+h-b]|=128*y},ac=ls;ls.Varint=0,ls.Fixed64=1,ls.Bytes=2,ls.Fixed32=5,ls.prototype={destroy:function(){this.buf=null},readFields:function(o,t,e){for(e=e||this.length;this.pos<e;){var i=this.readVarint(),n=this.pos;this.type=7&i,o(i>>3,t,this),this.pos===n&&this.skip(i)}return t},readMessage:function(a,t){return this.readFields(a,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Us(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Ks(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Us(this.buf,this.pos)+4294967296*Us(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Us(this.buf,this.pos)+4294967296*Ks(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=ec(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ec(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(a){var t=this.buf,o,i;return o=127&(i=t[this.pos++]),128>i?o:(o|=(127&(i=t[this.pos++]))<<7,128>i?o:(o|=(127&(i=t[this.pos++]))<<14,128>i?o:(o|=(127&(i=t[this.pos++]))<<21,128>i?o:function(o,t,e){var r=e.buf,a,l;if(l=r[e.pos++],a=(112&l)>>4,128>l)return ps(o,a,t);if(l=r[e.pos++],a|=(127&l)<<3,128>l)return ps(o,a,t);if(l=r[e.pos++],a|=(127&l)<<10,128>l)return ps(o,a,t);if(l=r[e.pos++],a|=(127&l)<<17,128>l)return ps(o,a,t);if(l=r[e.pos++],a|=(127&l)<<24,128>l)return ps(o,a,t);if(l=r[e.pos++],a|=(1&l)<<31,128>l)return ps(o,a,t);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(i=t[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return 1==e%2?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,t=function(d,t,e){for(var r="",c=t;c<e;){var g=d[c],u=null,h=239<g?4:223<g?3:191<g?2:1,m,y,f;if(c+h>e)break;1==h?128>g&&(u=g):2==h?128==(192&(m=d[c+1]))&&127>=(u=(31&g)<<6|63&m)&&(u=null):3==h?(m=d[c+1],y=d[c+2],128==(192&m)&&128==(192&y)&&(2047>=(u=(15&g)<<12|(63&m)<<6|63&y)||55296<=u&&57343>=u)&&(u=null)):4==h&&(m=d[c+1],y=d[c+2],f=d[c+3],128==(192&m)&&128==(192&y)&&128==(192&f)&&(65535>=(u=(15&g)<<18|(63&m)<<12|(63&y)<<6|63&f)||1114112<=u)&&(u=null)),null===u?(u=65533,h=1):65535<u&&(u-=65536,r+=D(55296|1023&u>>>10),u=56320|1023&u),r+=D(u),c+=h}return r}(this.buf,this.pos,a);return this.pos=a,t},readBytes:function(){var a=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,a);return this.pos=a,t},readPackedVarint:function(a,o){if(this.type!==ls.Bytes)return a.push(this.readVarint(o));var e=ss(this);for(a=a||[];this.pos<e;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==ls.Bytes)return a.push(this.readSVarint());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==ls.Bytes)return a.push(this.readBoolean());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==ls.Bytes)return a.push(this.readFloat());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==ls.Bytes)return a.push(this.readDouble());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==ls.Bytes)return a.push(this.readFixed32());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==ls.Bytes)return a.push(this.readSFixed32());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==ls.Bytes)return a.push(this.readFixed64());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==ls.Bytes)return a.push(this.readSFixed64());var r=ss(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed64());return a},skip:function(a){var t=7&a;if(t===ls.Varint)for(;127<this.buf[this.pos++];);else if(t===ls.Bytes)this.pos=this.readVarint()+this.pos;else if(t===ls.Fixed32)this.pos+=4;else{if(t!==ls.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(a,t){this.writeVarint(a<<3|t)},realloc:function(a){for(var t=this.length||16;t<this.pos+a;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Zs(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Zs(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Zs(this.buf,-1&e,this.pos),Zs(this.buf,ba(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Zs(this.buf,-1&e,this.pos),Zs(this.buf,ba(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){268435455<(e=+e||0)||0>e?function(a,t){var e,o;if(0<=a?(e=0|a%4294967296,o=0|a/4294967296):(o=~(-a/4294967296),4294967295^(e=~(-a%4294967296))?e=0|e+1:(e=0,o=0|o+1)),0x10000000000000000<=a||-0x10000000000000000>a)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(a,o,e){e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos]=127&a}(e,0,t),function(a,o){var e=(7&a)<<4;(o.buf[o.pos++]|=e|((a>>>=3)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a)}(o,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&e>>>7))))},writeSVarint:function(e){this.writeVarint(0>e?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(a){a+="",this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(o,t,e){for(var l=0,s,d;l<t.length;l++){if(55295<(s=t.charCodeAt(l))&&57344>s){if(!d){56319<s||l+1===t.length?(o[e++]=239,o[e++]=191,o[e++]=189):d=s;continue}if(56320>s){o[e++]=239,o[e++]=191,o[e++]=189,d=s;continue}s=65536|(d-55296<<10|s-56320),d=null}else d&&(o[e++]=239,o[e++]=191,o[e++]=189,d=null);128>s?o[e++]=s:(2048>s?o[e++]=192|s>>6:(65536>s?o[e++]=224|s>>12:(o[e++]=240|s>>18,o[e++]=128|63&s>>12),o[e++]=128|63&s>>6),o[e++]=128|63&s)}return e}(this.buf,a,this.pos);var e=this.pos-o;128<=e&&ys(o,e,this),this.pos=o-1,this.writeVarint(e),this.pos+=e},writeFloat:function(e){this.realloc(4),tc(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),tc(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var t=a.length;this.writeVarint(t),this.realloc(t);for(var e=0;e<t;e++)this.buf[this.pos++]=a[e]},writeRawMessage:function(a,t){this.pos++;var e=this.pos;a(t,this);var r=this.pos-e;128<=r&&ys(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeMessage:function(a,t,e){this.writeTag(a,ls.Bytes),this.writeRawMessage(t,e)},writePackedVarint:function(a,t){t.length&&this.writeMessage(a,fs,t)},writePackedSVarint:function(a,t){t.length&&this.writeMessage(a,_s,t)},writePackedBoolean:function(a,t){t.length&&this.writeMessage(a,Ds,t)},writePackedFloat:function(a,t){t.length&&this.writeMessage(a,vs,t)},writePackedDouble:function(a,t){t.length&&this.writeMessage(a,As,t)},writePackedFixed32:function(a,t){t.length&&this.writeMessage(a,Os,t)},writePackedSFixed32:function(a,t){t.length&&this.writeMessage(a,Rs,t)},writePackedFixed64:function(a,t){t.length&&this.writeMessage(a,Bs,t)},writePackedSFixed64:function(a,t){t.length&&this.writeMessage(a,Vs,t)},writeBytesField:function(a,t){this.writeTag(a,ls.Bytes),this.writeBytes(t)},writeFixed32Field:function(a,t){this.writeTag(a,ls.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(a,t){this.writeTag(a,ls.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(a,t){this.writeTag(a,ls.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(a,t){this.writeTag(a,ls.Fixed64),this.writeSFixed64(t)},writeVarintField:function(a,t){this.writeTag(a,ls.Varint),this.writeVarint(t)},writeSVarintField:function(a,t){this.writeTag(a,ls.Varint),this.writeSVarint(t)},writeStringField:function(a,t){this.writeTag(a,ls.Bytes),this.writeString(t)},writeFloatField:function(a,t){this.writeTag(a,ls.Fixed32),this.writeFloat(t)},writeDoubleField:function(a,t){this.writeTag(a,ls.Fixed64),this.writeDouble(t)},writeBooleanField:function(a,t){this.writeVarintField(a,!!t)}};var rc=function(a,t,e){this.target=a,this.parent=t,this.mapId=e,this.callbacks={},this.callbackID=0,f(["receive"],this),this.target.addEventListener("message",this.receive,!1)};rc.prototype.send=function(l,t,e,r){var n=this,i=e?this.mapId+":"+this.callbackID++:null;e&&(this.callbacks[i]=e);var a=[];if(this.target.postMessage({targetMapId:r,sourceMapId:this.mapId,type:l,id:i+"",data:hn(t,a)},a),e)return{cancel:function(){n.callbacks[i]=null,n.target.postMessage({targetMapId:r,sourceMapId:n.mapId,type:"<cancel>",id:i+""})}}},rc.prototype.receive=function(l){var d=this,t=l.data,r=t.id,i;if(!t.targetMapId||this.mapId===t.targetMapId){var n=function(a,t){delete d.callbacks[r];var e=[];d.target.postMessage({sourceMapId:d.mapId,type:"<response>",id:r+"",error:a?hn(a):null,data:hn(t,e)},e)};if("<response>"===t.type||"<cancel>"===t.type)i=this.callbacks[t.id],delete this.callbacks[t.id],i&&t.error?i(yn(t.error)):i&&i(null,yn(t.data));else if(void 0!==t.id&&this.parent[t.type]){this.callbacks[t.id]=null;var a=this.parent[t.type](t.sourceMapId,yn(t.data),n);a&&null===this.callbacks[t.id]&&(this.callbacks[t.id]=a.cancel)}else if(void 0!==t.id&&this.parent.getWorkerSource){var o=t.type.split("."),s=yn(t.data);this.parent.getWorkerSource(t.sourceMapId,o[0],s.source)[o[1]](s,n)}else this.parent[t.type](yn(t.data))}},rc.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var oc=function(a,t){a&&(t?this.setSouthWest(a).setNorthEast(t):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};oc.prototype.setNorthEast=function(e){return this._ne=e instanceof ic?new ic(e.lng,e.lat):ic.convert(e),this},oc.prototype.setSouthWest=function(e){return this._sw=e instanceof ic?new ic(e.lng,e.lat):ic.convert(e),this},oc.prototype.extend=function(a){var t=this._sw,o=this._ne,i,n;if(a instanceof ic)i=a,n=a;else{if(!(a instanceof oc))return Array.isArray(a)?a.every(Array.isArray)?this.extend(oc.convert(a)):this.extend(ic.convert(a)):this;if(i=a._sw,n=a._ne,!i||!n)return this}return t||o?(t.lng=ea(i.lng,t.lng),t.lat=ea(i.lat,t.lat),o.lng=va(n.lng,o.lng),o.lat=va(n.lat,o.lat)):(this._sw=new ic(i.lng,i.lat),this._ne=new ic(n.lng,n.lat)),this},oc.prototype.getCenter=function(){return new ic((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},oc.prototype.getSouthWest=function(){return this._sw},oc.prototype.getNorthEast=function(){return this._ne},oc.prototype.getNorthWest=function(){return new ic(this.getWest(),this.getNorth())},oc.prototype.getSouthEast=function(){return new ic(this.getEast(),this.getSouth())},oc.prototype.getWest=function(){return this._sw.lng},oc.prototype.getSouth=function(){return this._sw.lat},oc.prototype.getEast=function(){return this._ne.lng},oc.prototype.getNorth=function(){return this._ne.lat},oc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},oc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},oc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},oc.convert=function(e){return!e||e instanceof oc?e:new oc(e)};var ic=function(a,t){if(isNaN(a)||isNaN(t))throw new Error("Invalid LngLat object: ("+a+", "+t+")");if(this.lng=+a,this.lat=+t,90<this.lat||-90>this.lat)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ic.prototype.wrap=function(){return new ic(l(this.lng,-180,180),this.lat)},ic.prototype.toArray=function(){return[this.lng,this.lat]},ic.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ic.prototype.toBounds=function(a){void 0===a&&(a=0);var o=360*a/40075017,e=o/R(Pe/180*this.lat);return new oc(new ic(this.lng-e,this.lat-o),new ic(this.lng+e,this.lat+o))},ic.convert=function(e){if(e instanceof ic)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new ic(+e[0],+e[1]);if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new ic(+("lng"in e?e.lng:e.lon),+e.lat);throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var nc=function(a,t,e){void 0===e&&(e=0),this.x=+a,this.y=+t,this.z=+e};nc.fromLngLat=function(a,t){void 0===t&&(t=0);var o=ic.convert(a);return new nc(id(o.lng),nd(o.lat),ld(t,o.lat))},nc.prototype.toLngLat=function(){return new ic(360*this.x-180,sd(this.y))},nc.prototype.toAltitude=function(){return a=this.z,r=this.y,a*od(sd(r));var a,r};var lc=function(a,t,e){this.z=a,this.x=t,this.y=e,this.key=dd(0,a,t,e)};lc.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},lc.prototype.url=function(l,t){var e=(d=this.x,c=this.y,p=this.z,u=rd(256*d,256*(c=ya(2,p)-c-1),p),g=rd(256*(d+1),256*(c+1),p),u[0]+","+u[1]+","+g[0]+","+g[1]),s=function(o,t,e){for(var r="",l=o,s;0<l;l--)r+=(t&(s=1<<l-1)?1:0)+(e&s?2:0);return r}(this.z,this.x,this.y),d,c,p,u,g;return l[(this.x+this.y)%l.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",this.z+"").replace("{x}",this.x+"").replace("{y}",("tms"===t?ya(2,this.z)-this.y-1:this.y)+"").replace("{quadkey}",s).replace("{bbox-epsg-3857}",e)},lc.prototype.getTilePoint=function(a){var t=ya(2,this.z);return new ud(8192*(a.x*t-this.x),8192*(a.y*t-this.y))};var sc=function(a,t){this.wrap=a,this.canonical=t,this.key=dd(a,t.z,t.x,t.y)},dc=function(a,t,e,r,o){this.overscaledZ=a,this.wrap=t,this.canonical=new lc(e,+r,+o),this.key=dd(t,a,r,o)};dc.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},dc.prototype.scaledTo=function(a){var t=this.canonical.z-a;return a>this.canonical.z?new dc(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new dc(a,this.wrap,a,this.canonical.x>>t,this.canonical.y>>t)},dc.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var t=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>t&&a.canonical.y===this.canonical.y>>t},dc.prototype.children=function(a){if(this.overscaledZ>=a)return[new dc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,e=2*this.canonical.x,r=2*this.canonical.y;return[new dc(t,this.wrap,t,e,r),new dc(t,this.wrap,t,e+1,r),new dc(t,this.wrap,t,e,r+1),new dc(t,this.wrap,t,e+1,r+1)]},dc.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},dc.prototype.wrapped=function(){return new dc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},dc.prototype.unwrapTo=function(e){return new dc(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},dc.prototype.overscaleFactor=function(){return ya(2,this.overscaledZ-this.canonical.z)},dc.prototype.toUnwrapped=function(){return new sc(this.wrap,this.canonical)},dc.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},dc.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new nc(e.x-this.wrap,e.y))},un("CanonicalTileID",lc),un("OverscaledTileID",dc,{omit:["posMatrix"]});var cc=function(d,t,e){if(this.uid=d,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(e&&"mapbox"!==e&&"terrarium"!==e)return Fa("\""+e+"\" is not a valid encoding type. Valid types include \"mapbox\" and \"terrarium\".");var r=this.dim=t.height;this.stride=this.dim+2,this.data=new Int32Array(this.stride*this.stride);for(var n=t.data,i="terrarium"===e?this._unpackTerrarium:this._unpackMapbox,a=0;a<r;a++)for(var c=0,p;c<r;c++)p=4*(a*r+c),this.set(c,a,i(n[p],n[p+1],n[p+2]));for(var g=0;g<r;g++)this.set(-1,g,this.get(0,g)),this.set(r,g,this.get(r-1,g)),this.set(g,-1,this.get(g,0)),this.set(g,r,this.get(g,r-1));this.set(-1,-1,this.get(0,0)),this.set(r,-1,this.get(r-1,0)),this.set(-1,r,this.get(0,r-1)),this.set(r,r,this.get(r-1,r-1))};cc.prototype.set=function(a,t,e){this.data[this._idx(a,t)]=e+65536},cc.prototype.get=function(a,t){return this.data[this._idx(a,t)]-65536},cc.prototype._idx=function(a,t){if(-1>a||a>=this.dim+1||-1>t||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(a+1)},cc.prototype._unpackMapbox=function(a,t,e){return(256*(256*a)+256*t+e)/10-1e4},cc.prototype._unpackTerrarium=function(a,t,e){return 256*a+t+e/256-32768},cc.prototype.getPixels=function(){return new ao({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},cc.prototype.backfillBorder=function(d,t,e){if(this.dim!==d.dim)throw new Error("dem dimension mismatch");var r=t*this.dim,c=t*this.dim+this.dim,g=e*this.dim,h=e*this.dim+this.dim;-1===t?r=c-1:1===t?c=r+1:void 0,-1===e?g=h-1:1===e?h=g+1:void 0;for(var m=-t*this.dim,s=-e*this.dim,u=g;u<h;u++)for(var y=r;y<c;y++)this.set(y,u,d.get(y+m,u+s))},un("DEMData",cc);var pc=zn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),uc=function(a){this._stringToNumber={},this._numberToString=[];for(var t=0,o;t<a.length;t++)o=a[t],this._stringToNumber[o]=t,this._numberToString[t]=o};uc.prototype.encode=function(e){return this._stringToNumber[e]},uc.prototype.decode=function(e){return this._numberToString[e]};var gc=function(a,t,e,r){this.type="Feature",this._vectorTileFeature=a,a._z=t,a._x=e,a._y=r,this.properties=a.properties,null!=a.id&&(this.id=a.id)},tl={geometry:{configurable:!0}};tl.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},tl.geometry.set=function(e){this._geometry=e},gc.prototype.toJSON=function(){var a={geometry:this.geometry};for(var t in this)"_geometry"!=t&&"_vectorTileFeature"!=t&&(a[t]=this[t]);return a},Object.defineProperties(gc.prototype,tl);var el=function(){this.state={},this.stateChanges={},this.deletedStates={}};el.prototype.updateState=function(l,t,e){var r=t+"";if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][r]=this.stateChanges[l][r]||{},dt(this.stateChanges[l][r],e),null===this.deletedStates[l])for(var n in this.deletedStates[l]={},this.state[l])n!=r&&(this.deletedStates[l][n]=null);else if(this.deletedStates[l]&&null===this.deletedStates[l][r])for(var i in this.deletedStates[l][r]={},this.state[l][r])e[i]||(this.deletedStates[l][r][i]=null);else for(var a in e)this.deletedStates[l]&&this.deletedStates[l][r]&&null===this.deletedStates[l][r][a]&&delete this.deletedStates[l][r][a]},el.prototype.removeFeatureState=function(a,t,e){if(null!==this.deletedStates[a]){var o=t+"";if(this.deletedStates[a]=this.deletedStates[a]||{},e&&void 0!==t&&0<=t)null!==this.deletedStates[a][o]&&(this.deletedStates[a][o]=this.deletedStates[a][o]||{},this.deletedStates[a][o][e]=null);else if(!(void 0!==t&&0<=t))this.deletedStates[a]=null;else if(this.stateChanges[a]&&this.stateChanges[a][o])for(e in this.deletedStates[a][o]={},this.stateChanges[a][o])this.deletedStates[a][o][e]=null;else this.deletedStates[a][o]=null}},el.prototype.getState=function(l,t){var e=t+"",r=this.state[l]||{},n=this.stateChanges[l]||{},i=dt({},r[e],n[e]);if(null===this.deletedStates[l])return{};if(this.deletedStates[l]){var a=this.deletedStates[l][t];if(null===a)return{};for(var o in a)delete i[o]}return i},el.prototype.initializeTileState=function(a,t){a.setFeatureState(this.state,t)},el.prototype.coalesceChanges=function(d,t){var e={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var n={};for(var i in this.stateChanges[r])this.state[r][i]||(this.state[r][i]={}),dt(this.state[r][i],this.stateChanges[r][i]),n[i]=this.state[r][i];e[r]=n}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var o={};if(null===this.deletedStates[a])for(var s in this.state[a])o[s]={},this.state[a][s]={};else for(var c in this.deletedStates[a]){if(null===this.deletedStates[a][c])this.state[a][c]={};else for(var l=0,u=Object.keys(this.deletedStates[a][c]),g;l<u.length;l+=1)g=u[l],delete this.state[a][c][g];o[c]=this.state[a][c]}e[a]=e[a]||{},dt(e[a],o)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(e).length)for(var h in d)d[h].setFeatureState(e,t)};var rl=function(a,t,e){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=t||new xn(8192,16,0),this.grid3D=new xn(8192,16,0),this.featureIndexArray=e||new qi};rl.prototype.insert=function(d,t,e,r,n,i){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(e,r,n);for(var o=i?this.grid3D:this.grid,s=0;s<t.length;s++){for(var g=t[s],l=[1/0,1/0,-1/0,-1/0],p=0,m;p<g.length;p++)m=g[p],l[0]=ea(l[0],m.x),l[1]=ea(l[1],m.y),l[2]=va(l[2],m.x),l[3]=va(l[3],m.y);8192>l[0]&&8192>l[1]&&0<=l[2]&&0<=l[3]&&o.insert(a,l[0],l[1],l[2],l[3])}},rl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ts.VectorTile(new ac(this.rawTileData)).layers,this.sourceLayerCoder=new uc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},rl.prototype.query=function(_,t,k){var r=this;this.loadVTLayers();for(var e=_.params||{},n=8192/_.tileSize/_.scale,a=Ur(e.filter),o=_.queryGeometry,i=_.queryPadding*n,l=cd(o),s=this.grid.query(l.minX-i,l.minY-i,l.maxX+i,l.maxY+i),c=cd(_.cameraQueryGeometry),p=this.grid3D.query(c.minX-i,c.minY-i,c.maxX+i,c.maxY+i,function(t,e,r,o){return function(i,t,e,r,n){for(var a=0,d=i,s;a<d.length;a+=1)if(s=d[a],t<=s.x&&e<=s.y&&r>=s.x&&n>=s.y)return!0;var g=[new ud(t,e),new ud(t,n),new ud(r,n),new ud(r,e)];if(2<i.length)for(var l=0,m=g;l<m.length;l+=1)if(Ba(i,m[l]))return!0;for(var c=0;c<i.length-1;c++)if(Ca(i[c],i[c+1],g))return!0;return!1}(_.cameraQueryGeometry,t-i,e-i,r+i,o+i)}),u=0,h=p,d;u<h.length;u+=1)d=h[u],s.push(d);s.sort(il);for(var f={},g=function(d){var i=s[d];if(i!==w){w=i;var l=r.featureIndexArray.get(i),c=null;r.loadMatchingFeature(f,l.bucketIndex,l.sourceLayerIndex,l.featureIndex,a,e.layers,t,function(t,e){c||(c=Pn(t));var i={};return t.id&&(i=k.getState(e.sourceLayer||"_geojsonTileLayer",t.id)),e.queryIntersectsFeature(o,t,i,c,r.z,_.transform,n,_.pixelPosMatrix)})}},x=0,w;x<s.length;x++)g(x);return f},rl.prototype.loadMatchingFeature=function(g,t,e,r,n,i,a,o){var s=this.bucketLayerIDs[t];if(!i||function(a,t){for(var e=0;e<a.length;e++)if(0<=t.indexOf(a[e]))return!0;return!1}(i,s)){var u=this.sourceLayerCoder.decode(e),l=this.vtLayers[u].feature(r);if(n(new Nn(this.tileID.overscaledZ),l))for(var p=0,x;p<s.length;p++)if(x=s[p],!(i&&0>i.indexOf(x))){var _=a[x];if(_){var f=!o||o(l,_);if(f){var y=new gc(l,this.z,this.x,this.y);y.layer=_.serialize();var d=g[x];void 0===d&&(d=g[x]=[]),d.push({featureIndex:r,feature:y,intersectionZ:f})}}}}},rl.prototype.lookupSymbolFeatures=function(d,t,e,r,n,i){var a={};this.loadVTLayers();for(var o=Ur(r),s=0,c=d,l;s<c.length;s+=1)l=c[s],this.loadMatchingFeature(a,t,e,l,o,n,i);return a},rl.prototype.hasLayer=function(a){for(var t=0,o=this.bucketLayerIDs;t<o.length;t+=1)for(var r=0,l=o[t];r<l.length;r+=1)if(a===l[r])return!0;return!1},un("FeatureIndex",rl,{omit:["rawTileData","sourceLayerCoder"]});var nl=function(a,t){this.tileID=a,this.uid=s(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};nl.prototype.registerFadeDuration=function(a){var t=a+this.timeAdded;t<T.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},nl.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},nl.prototype.loadVectorData=function(l,t,e){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){for(var r in l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(o,l){var e={};if(!l)return e;for(var t=function(){var a=d[r],i=a.layerIds.map(function(e){return l.getLayer(e)}).filter(Boolean);if(0!==i.length){a.layers=i,a.stateDependentLayerIds&&(a.stateDependentLayers=a.stateDependentLayerIds.map(function(a){return i.filter(function(t){return t.id===a})[0]}));for(var t=0,n=i,s;t<n.length;t+=1)s=n[t],e[s.id]=a}},r=0,d=o;r<d.length;r+=1)t();return e}(l.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var n=this.buckets[r];if(n instanceof Xs){if(this.hasSymbolBuckets=!0,!e)break;n.justReloaded=!0}}for(var i in this.queryPadding=0,this.buckets){var a=this.buckets[i];this.queryPadding=va(this.queryPadding,t.style.getLayer(i).queryRadius(a))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new Ti},nl.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},nl.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},nl.prototype.getBucket=function(e){return this.buckets[e.id]},nl.prototype.upload=function(a){for(var t in this.buckets){var e=this.buckets[t];e.uploadPending()&&e.upload(a)}var r=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new $d(a,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new $d(a,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},nl.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},nl.prototype.queryRenderedFeatures=function(l,t,e,r,n,i,a,o,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:e,cameraQueryGeometry:r,scale:n,tileSize:this.tileSize,pixelPosMatrix:s,transform:a,params:i,queryPadding:this.queryPadding*o},l,t):{}},nl.prototype.querySourceFeatures=function(d,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var e=this.latestFeatureIndex.loadVTLayers(),r=t?t.sourceLayer:"",n=e._geojsonTileLayer||e[r];if(n)for(var i=Ur(t&&t.filter),a=this.tileID.canonical,o=a.z,s=a.x,u=a.y,l={z:o,x:s,y:u},p=0,g;p<n.length;p++)if(g=n.feature(p),i(new Nn(this.tileID.overscaledZ),g)){var m=new gc(g,o,s,u);m.tile=l,d.push(m)}}},nl.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},nl.prototype.setMask=function(o,t){if(!Re(this.mask,o)&&(this.mask=o,this.clearMask(),!Re(o,{0:!0}))){var e=new ci,r=new zi;this.segments=new Zi,this.segments.prepareSegment(0,e,r);for(var i=Object.keys(o),a=0;a<i.length;a++){var n=o[+i[a]],d=8192>>n.z,l=new ud(n.x*d,n.y*d),p=new ud(l.x+d,l.y+d),c=this.segments.prepareSegment(4,e,r);e.emplaceBack(l.x,l.y,l.x,l.y),e.emplaceBack(p.x,l.y,p.x,l.y),e.emplaceBack(l.x,p.y,l.x,p.y),e.emplaceBack(p.x,p.y,p.x,p.y);var u=c.vertexLength;r.emplaceBack(u,u+1,u+2),r.emplaceBack(u+1,u+2,u+3),c.vertexLength+=4,c.primitiveLength+=2}this.maskedBoundsBuffer=t.createVertexBuffer(e,pc.members),this.maskedIndexBuffer=t.createIndexBuffer(r)}},nl.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},nl.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},nl.prototype.setExpiryData=function(o){var t=this.expirationTime;if(o.cacheControl){var e=A(o.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){var r=Date.now(),n=!1;if(this.expirationTime>r)n=!1;else if(!t)n=!0;else if(this.expirationTime<t)n=!0;else{var l=this.expirationTime-t;l?this.expirationTime=r+va(l,3e4):n=!0}n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},nl.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<ea(this.expiredRequestCount-1,31)):ea(this.expirationTime-new Date().getTime(),ya(2,31)-1)},nl.prototype.setFeatureState=function(l,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(l).length){var e=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets){var n=this.buckets[r],i=n.layers[0].sourceLayer||"_geojsonTileLayer",a=e[i],o=l[i];a&&o&&0!==Object.keys(o).length&&(n.update(o,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),t&&t.style&&(this.queryPadding=va(this.queryPadding,t.style.getLayer(r).queryRadius(n))))}}},nl.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},nl.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<T.now()},nl.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},nl.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=T.now()+e};var ol={horizontal:1,vertical:2,horizontalOnly:3},ul=function(){this.text="",this.sectionIndex=[],this.sections=[]};ul.fromFeature=function(o,t){for(var e=new ul,r=0,l;r<o.sections.length;r++){l=o.sections[r],e.sections.push({scale:l.scale||1,fontStack:l.fontStack||t}),e.text+=l.text;for(var s=0;s<l.text.length;s++)e.sectionIndex.push(r)}return e},ul.prototype.length=function(){return this.text.length},ul.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},ul.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},ul.prototype.verticalizePunctuation=function(){this.text=function(a){for(var t="",o=0;o<a.length;o++){var l=a.charCodeAt(o+1)||null,n=a.charCodeAt(o-1)||null;t+=l&&Cn(l)&&!Ps[a[o+1]]||n&&Cn(n)&&!Ps[a[o-1]]||!Ps[a[o]]?a[o]:Ps[a[o]]}return t}(this.text)},ul.prototype.trim=function(){for(var a=0,o=0;o<this.text.length&&ll[this.text.charCodeAt(o)];o++)a++;for(var i=this.text.length,l=this.text.length-1;0<=l&&l>=a&&ll[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(a,i),this.sectionIndex=this.sectionIndex.slice(a,i)},ul.prototype.substring=function(a,t){var e=new ul;return e.text=this.text.substring(a,t),e.sectionIndex=this.sectionIndex.slice(a,t),e.sections=this.sections,e},ul.prototype.toString=function(){return this.text},ul.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(t,e){return va(t,a.sections[e].scale)},0)};var ll={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cl={};cl[10]=!0,cl[32]=!0,cl[38]=!0,cl[40]=!0,cl[41]=!0,cl[43]=!0,cl[45]=!0,cl[47]=!0,cl[173]=!0,cl[183]=!0,cl[8203]=!0,cl[8208]=!0,cl[8211]=!0,cl[8231]=!0;var hl=function(i,t,e,r,n,a,o,s,u,l,p,c){var h=o.top*s-u,k=o.bottom*s+u,T=o.left*s-u,S=o.right*s+u;if(this.boxStartIndex=i.length,l){var C=k-h,L=S-T;0<C&&(C=va(10*s,C),this._addLineCollisionCircles(i,t,e,e.segment,L,C,r,n,a,p))}else{if(c){var g=new ud(T,h),x=new ud(S,h),b=new ud(T,k),_=new ud(S,k),w=c*Pe/180;g._rotate(w),x._rotate(w),b._rotate(w),_._rotate(w),T=ea(g.x,x.x,b.x,_.x),S=va(g.x,x.x,b.x,_.x),h=ea(g.y,x.y,b.y,_.y),k=va(g.y,x.y,b.y,_.y)}i.emplaceBack(e.x,e.y,T,h,S,k,r,n,a,0,0)}this.boxEndIndex=i.length};hl.prototype._addLineCollisionCircles=function(x,t,e,r,n,i,a,o,s,u){var l=i/2,p=ba(n/l)||1,c=1+.4*P(u)/E,h=ba(p*c/2),f=-i/2,y=e,T=r+1,C=f,L=-n/2;do{if(0>--T){if(C>L)return;T=0;break}C-=t[T].dist(y),y=t[T]}while(C>L-n/4);for(var g=t[T].dist(t[T+1]),D=-h;D<p+h;D++){var O=D*l,w=L+O;if(0>O&&(w+=O),O>n&&(w+=O-n),!(w<C)){for(;C+g<w;){if(C+=g,++T+1>=t.length)return;g=t[T].dist(t[T+1])}var R=w-C,S=t[T],k=t[T+1].sub(S)._unit()._mult(R)._add(S)._round(),z=_a(w-f)<l?0:.8*(w-f);x.emplaceBack(k.x,k.y,-i/2,-i/2,i/2,i/2,a,o,s,i/2,z)}}};var zl=function(a,o){if(void 0===a&&(a=[]),void 0===o&&(o=kl),this.data=a,this.length=this.data.length,this.compare=o,0<this.length)for(var i=(this.length>>1)-1;0<=i;i--)this._down(i)};zl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},zl.prototype.pop=function(){if(0!==this.length){var e=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},zl.prototype.peek=function(){return this.data[0]},zl.prototype._up=function(o){for(var l=this.data,e=this.compare,r=l[o];0<o;){var n=o-1>>1,i=l[n];if(0<=e(r,i))break;l[o]=i,o=n}l[o]=r},zl.prototype._down=function(l){for(var d=this.data,e=this.compare,r=this.length>>1,n=d[l];l<r;){var i=1+(l<<1),c=d[i],p=i+1;if(p<this.length&&0>e(d[p],c)&&(i=p,c=d[p]),0<=e(c,n))break;d[l]=c,l=i}d[l]=n};var Il=t(function(e){e.exports=function(d,t){var e,c,p,g,h,m,y,f;for(e=3&d.length,c=d.length-e,p=t,h=3432918353,m=461845907,f=0;f<c;)y=255&d.charCodeAt(f)|(255&d.charCodeAt(++f))<<8|(255&d.charCodeAt(++f))<<16|(255&d.charCodeAt(++f))<<24,++f,p=27492+(65535&(g=4294967295&5*(65535&(p=(p^=y=4294967295&(65535&(y=(y=4294967295&(65535&y)*h+((65535&(y>>>16)*h)<<16))<<15|y>>>17))*m+((65535&(y>>>16)*m)<<16))<<13|p>>>19))+((65535&5*(p>>>16))<<16)))+((65535&58964+(g>>>16))<<16);switch(y=0,e){case 3:y^=(255&d.charCodeAt(f+2))<<16;case 2:y^=(255&d.charCodeAt(f+1))<<8;case 1:p^=y=4294967295&(65535&(y=(y=4294967295&(65535&(y^=255&d.charCodeAt(f)))*h+((65535&(y>>>16)*h)<<16))<<15|y>>>17))*m+((65535&(y>>>16)*m)<<16);}return p^=d.length,p=4294967295&2246822507*(65535&(p^=p>>>16))+((65535&2246822507*(p>>>16))<<16),p=4294967295&3266489909*(65535&(p^=p>>>13))+((65535&3266489909*(p>>>16))<<16),(p^=p>>>16)>>>0}}),Tl=t(function(e){e.exports=function(o,t){for(var e=o.length,l=t^e,s=0,d;4<=e;)d=1540483477*(65535&(d=255&o.charCodeAt(s)|(255&o.charCodeAt(++s))<<8|(255&o.charCodeAt(++s))<<16|(255&o.charCodeAt(++s))<<24))+((65535&1540483477*(d>>>16))<<16),l=1540483477*(65535&l)+((65535&1540483477*(l>>>16))<<16)^(d=1540483477*(65535&(d^=d>>>24))+((65535&1540483477*(d>>>16))<<16)),e-=4,++s;switch(e){case 3:l^=(255&o.charCodeAt(s+2))<<16;case 2:l^=(255&o.charCodeAt(s+1))<<8;case 1:l=1540483477*(65535&(l^=255&o.charCodeAt(s)))+((65535&1540483477*(l>>>16))<<16);}return l=1540483477*(65535&(l^=l>>>13))+((65535&1540483477*(l>>>16))<<16),(l^=l>>>15)>>>0}}),Pl=Il;Pl.murmur3=Il,Pl.murmur2=Tl;var Vl=65535;j.Actor=rc,j.AlphaImage=eo,j.CanonicalTileID=lc,j.CollisionBoxArray=Ti,j.Color=ie,j.DEMData=cc,j.DataConstantProperty=Wn,j.DictionaryCoder=uc,j.EXTENT=8192,j.ErrorEvent=Pt,j.EvaluationParameters=Nn,j.Event=Et,j.Evented=Vt,j.FeatureIndex=rl,j.FillBucket=fo,j.FillExtrusionBucket=os,j.ImageAtlas=Xd,j.ImagePosition=Yd,j.LineBucket=bs,j.LngLat=ic,j.LngLatBounds=oc,j.MercatorCoordinate=nc,j.ONE_EM=24,j.OverscaledTileID=dc,j.Point=ud,j.Point$1=ud,j.ProgramConfiguration=la,j.Properties=ni,j.Protobuf=ac,j.RGBAImage=ao,j.RequestManager=vd,j.ResourceType=Td,j.SegmentVector=Zi,j.SourceFeatureState=el,j.StructArrayLayout1ui2=Bi,j.StructArrayLayout2i4=ui,j.StructArrayLayout2ui4=Ii,j.StructArrayLayout3ui6=zi,j.StructArrayLayout4i8=ci,j.SymbolBucket=Xs,j.Texture=$d,j.Tile=nl,j.Transitionable=Gn,j.Uniform1f=Yi,j.Uniform1i=Hi,j.Uniform2f=$i,j.Uniform3f=Wi,j.Uniform4f=Qi,j.UniformColor=ta,j.UniformMatrix4f=ra,j.UnwrappedTileID=sc,j.ValidationError=Lt,j.WritingMode=ol,j.ZoomHistory=In,j.addDynamicAttributes=rs,j.asyncAll=function(o,l,s){if(!o.length)return s(null,[]);var r=o.length,d=Array(o.length),i=null;o.forEach(function(e,a){l(e,function(o,t){o&&(i=o),d[a]=t,0==--r&&s(i,d)})})},j.bezier=a,j.bindAll=f,j.browser=T,j.cacheEntryPossiblyAdded=function(e){++wd>kd&&(e.send("enforceCacheSizeLimit",ct),wd=0)},j.clamp=Ue,j.clearTileCache=function(a){var t=self.caches.delete("mapbox-tiles");a&&t.catch(a).then(function(){return a()})},j.clone=function(a){var t=new Va(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},j.clone$1=x,j.config=md,j.create=function(){var e=new Va(16);return Va!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},j.create$1=Pa,j.create$2=function(){var e=new Va(4);return Va!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},j.createCommonjsModule=t,j.createExpression=Ir,j.createLayout=zn,j.createStyleLayer=function(e){return"custom"===e.type?new Gd(e):new qd[e.type](e)},j.deepEqual=Re,j.ease=r,j.emitValidationErrors=dn,j.endsWith=ht,j.enforceCacheSizeLimit=function(a){self.caches&&self.caches.open("mapbox-tiles").then(function(t){t.keys().then(function(e){for(var r=0;r<e.length-a;r++)t.delete(e[r])})})},j.evaluateRadialOffset=Ml,j.evaluateSizeForFeature=Ql,j.evaluateSizeForZoom=$l,j.evented=zd,j.extend=dt,j.featureFilter=Ur,j.filterObject=g,j.fromRotation=function(a,t){var e=De(t),r=R(t);return a[0]=r,a[1]=e,a[2]=0,a[3]=-e,a[4]=r,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},j.getAnchorAlignment=ml,j.getAnchorJustification=Ol,j.getArrayBuffer=kt,j.getImage=Cd,j.getJSON=function(a,t){return At(dt(a,{type:"json"}),t)},j.getReferrer=_t,j.getVideo=function(l,t){var e=self.document.createElement("video"),i,s;e.muted=!0,e.onloadstart=function(){t(null,e)};for(var d=0,c;d<l.length;d++)c=self.document.createElement("source"),i=l[d],s=void 0,(s=self.document.createElement("a")).href=i,(s.protocol!==self.document.location.protocol||s.host!==self.document.location.host)&&(e.crossOrigin="Anonymous"),c.src=l[d],e.appendChild(c);return{cancel:function(){}}},j.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},j.invert=function(T,t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],p=t[9],c=t[10],h=t[11],f=t[12],y=t[13],d=t[14],m=t[15],v=e*o-r*a,g=e*s-n*a,x=e*u-i*a,b=r*s-n*o,_=r*u-i*o,w=n*u-i*s,A=l*y-p*f,S=l*d-c*f,k=l*m-h*f,L=p*d-c*y,I=p*m-h*y,z=c*m-h*d,C=v*z-g*I+x*L+b*k-_*S+w*A;return C?(C=1/C,T[0]=(o*z-s*I+u*L)*C,T[1]=(n*I-r*z-i*L)*C,T[2]=(y*w-d*_+m*b)*C,T[3]=(c*_-p*w-h*b)*C,T[4]=(s*k-a*z-u*S)*C,T[5]=(e*z-n*k+i*S)*C,T[6]=(d*x-f*w-m*g)*C,T[7]=(l*w-c*x+h*g)*C,T[8]=(a*I-o*k+u*A)*C,T[9]=(r*k-e*I-i*A)*C,T[10]=(f*_-y*x+m*v)*C,T[11]=(p*x-l*_-h*v)*C,T[12]=(o*S-a*L-s*A)*C,T[13]=(e*L-r*S+n*A)*C,T[14]=(y*g-f*b-d*v)*C,T[15]=(l*b-p*g+c*v)*C,T):null},j.isChar=En,j.isMapboxURL=O,j.keysDifference=function(a,t){var e=[];for(var r in a)r in t||e.push(r);return e},j.makeRequest=At,j.mapObject=v,j.mercatorXfromLng=id,j.mercatorYfromLat=nd,j.mercatorZfromAltitude=ld,j.multiply=function(k,t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],p=t[8],c=t[9],h=t[10],f=t[11],y=t[12],d=t[13],m=t[14],v=t[15],g=e[0],T=e[1],A=e[2],S=e[3];return k[0]=g*r+T*o+A*p+S*y,k[1]=g*n+T*s+A*c+S*d,k[2]=g*i+T*u+A*h+S*m,k[3]=g*a+T*l+A*f+S*v,g=e[4],T=e[5],A=e[6],S=e[7],k[4]=g*r+T*o+A*p+S*y,k[5]=g*n+T*s+A*c+S*d,k[6]=g*i+T*u+A*h+S*m,k[7]=g*a+T*l+A*f+S*v,g=e[8],T=e[9],A=e[10],S=e[11],k[8]=g*r+T*o+A*p+S*y,k[9]=g*n+T*s+A*c+S*d,k[10]=g*i+T*u+A*h+S*m,k[11]=g*a+T*l+A*f+S*v,g=e[12],T=e[13],A=e[14],S=e[15],k[12]=g*r+T*o+A*p+S*y,k[13]=g*n+T*s+A*c+S*d,k[14]=g*i+T*u+A*h+S*m,k[15]=g*a+T*l+A*f+S*v,k},j.mvt=ts,j.number=Be,j.ortho=function(d,t,e,r,n,i,a){var o=1/(t-e),s=1/(r-n),c=1/(i-a);return d[0]=-2*o,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*s,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*c,d[11]=0,d[12]=(t+e)*o,d[13]=(n+r)*s,d[14]=(a+i)*c,d[15]=1,d},j.parseGlyphPBF=function(e){return new ac(e).readFields(ed,[])},j.pbf=ac,j.performSymbolLayout=function(w,t,e,r,n,i){w.createArrays();var a=512*w.overscaling;w.tilePixelRatio=8192/a,w.compareText={},w.iconsNeedLinear=!1;var o=w.layers[0].layout,s=w.layers[0]._unevaluatedLayout._values,u={};if("composite"===w.textSizeData.kind){var l=w.textSizeData,p=l.minZoom,c=l.maxZoom;u.compositeTextSizes=[s["text-size"].possiblyEvaluate(new Nn(p)),s["text-size"].possiblyEvaluate(new Nn(c))]}if("composite"===w.iconSizeData.kind){var h=w.iconSizeData,f=h.minZoom,y=h.maxZoom;u.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new Nn(f)),s["icon-size"].possiblyEvaluate(new Nn(y))]}u.layoutTextSize=s["text-size"].possiblyEvaluate(new Nn(w.zoom+1)),u.layoutIconSize=s["icon-size"].possiblyEvaluate(new Nn(w.zoom+1)),u.textMaxSize=s["text-size"].possiblyEvaluate(new Nn(18));for(var d=24*o.get("text-line-height"),m="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement"),v=o.get("text-keep-upright"),g=0,S=w.features;g<S.length;g+=1){var b=S[g],_=o.get("text-font").evaluate(b,{}).join(","),A={horizontal:{},vertical:void 0},k=b.text,z=[0,0];if(k){var H=k.toString(),B=24*o.get("text-letter-spacing").evaluate(b,{}),C=bn(H)?B:0,E=o.get("text-anchor").evaluate(b,{}),M=o.get("text-variable-anchor"),T=o.get("text-radial-offset").evaluate(b,{});M||(z=T?Ml(E,24*T):o.get("text-offset").evaluate(b,{}).map(function(e){return 24*e}));var P=m?"center":o.get("text-justify").evaluate(b,{}),G="point"===o.get("symbol-placement")?24*o.get("text-max-width").evaluate(b,{}):0;if(!m&&M){for(var F="auto"===P?M.map(function(e){return Ol(e)}):[P],L=!1,Y=0,W;Y<F.length;Y++)if(W=F[Y],!A.horizontal[W])if(L)A.horizontal[W]=A.horizontal[0];else{var X=al(k,t,_,G,d,"center",W,C,z,ol.horizontal);X&&(A.horizontal[W]=X,L=1===X.lineCount)}}else{"auto"===P&&(P=Ol(E));var U=al(k,t,_,G,d,E,P,C,z,ol.horizontal);U&&(A.horizontal[P]=U),fn(H)&&m&&v&&(A.vertical=al(k,t,_,G,d,E,P,C,z,ol.vertical))}}var j=void 0;if(b.icon){var Z=r[b.icon];Z&&(j=pd(n[b.icon],o.get("icon-offset").evaluate(b,{}),o.get("icon-anchor").evaluate(b,{})),void 0===w.sdfIcons?w.sdfIcons=Z.sdf:w.sdfIcons!==Z.sdf&&Fa("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),Z.pixelRatio===w.pixelRatio?0!==o.get("icon-rotate").constantOr(1)&&(w.iconsNeedLinear=!0):w.iconsNeedLinear=!0)}(Object.keys(A.horizontal).length||j)&&Rl(w,b,A,j,e,u,z)}i&&w.generateCollisionDebugBuffers()},j.perspective=function(l,t,e,r,n){var i=1/fa(t/2),o;return l[0]=i/e,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=i,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,null!=n&&n!==1/0?(o=1/(r-n),l[10]=(n+r)*o,l[14]=2*n*r*o):(l[10]=-1,l[14]=-2*r),l},j.pick=function(a,t){for(var e={},r=0,o;r<t.length;r++)o=t[r],o in a&&(e[o]=a[o]);return e},j.plugin=qn,j.polygonIntersectsPolygon=ga,j.postMapLoadEvent=pt,j.postTurnstileEvent=ut,j.potpack=ns,j.rasterBoundsAttributes=pc,j.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],j.register=un,j.registerForPluginAvailability=function(e){return Ed?e({pluginURL:Ed,completionCallback:Zn}):zd.once("pluginAvailable",e),e},j.rotate=function(l,t,e){var r=t[0],n=t[1],i=t[2],a=t[3],o=De(e),s=R(e);return l[0]=r*s+i*o,l[1]=n*s+a*o,l[2]=r*-o+i*s,l[3]=n*-o+a*s,l},j.rotateX=function(d,t,e){var r=De(e),n=R(e),i=t[4],a=t[5],o=t[6],s=t[7],u=t[8],l=t[9],p=t[10],c=t[11];return t!==d&&(d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=t[3],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15]),d[4]=i*n+u*r,d[5]=a*n+l*r,d[6]=o*n+p*r,d[7]=s*n+c*r,d[8]=u*n-i*r,d[9]=l*n-a*r,d[10]=p*n-o*r,d[11]=c*n-s*r,d},j.rotateZ=function(d,t,e){var r=De(e),n=R(e),i=t[0],a=t[1],o=t[2],s=t[3],u=t[4],l=t[5],p=t[6],c=t[7];return t!==d&&(d[8]=t[8],d[9]=t[9],d[10]=t[10],d[11]=t[11],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15]),d[0]=i*n+u*r,d[1]=a*n+l*r,d[2]=o*n+p*r,d[3]=s*n+c*r,d[4]=u*n-i*r,d[5]=l*n-a*r,d[6]=p*n-o*r,d[7]=c*n-s*r,d},j.scale=function(o,t,e){var r=e[0],n=e[1],i=e[2];return o[0]=t[0]*r,o[1]=t[1]*r,o[2]=t[2]*r,o[3]=t[3]*r,o[4]=t[4]*n,o[5]=t[5]*n,o[6]=t[6]*n,o[7]=t[7]*n,o[8]=t[8]*i,o[9]=t[9]*i,o[10]=t[10]*i,o[11]=t[11]*i,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},j.setCacheLimits=function(a,t){ct=a,kd=t},j.setRTLTextPlugin=function(a,r){if(Mn)throw new Error("setRTLTextPlugin cannot be called multiple times.");Mn=!0,Ed=T.resolveURL(a),Zn=function(e){e?(Mn=!1,Ed=null,r&&r(e)):Id=!0},zd.fire(new Et("pluginAvailable",{pluginURL:Ed,completionCallback:Zn}))},j.sphericalToCartesian=function(a){var t=a[0],e=a[1],o=a[2];return e+=90,e*=Pe/180,o*=Pe/180,{x:t*R(e)*De(o),y:t*De(e)*De(o),z:t*R(o)}},j.styleSpec=Ft,j.symbolSize=Ls,j.transformMat3=function(o,t,e){var r=t[0],n=t[1],i=t[2];return o[0]=r*e[0]+n*e[3]+i*e[6],o[1]=r*e[1]+n*e[4]+i*e[7],o[2]=r*e[2]+n*e[5]+i*e[8],o},j.transformMat4=Ra,j.translate=function(g,t,e){var r=e[0],d=e[1],m=e[2],x,_,b,v,k,w,T,A,S,C,L,E;return t===g?(g[12]=t[0]*r+t[4]*d+t[8]*m+t[12],g[13]=t[1]*r+t[5]*d+t[9]*m+t[13],g[14]=t[2]*r+t[6]*d+t[10]*m+t[14],g[15]=t[3]*r+t[7]*d+t[11]*m+t[15]):(x=t[0],_=t[1],b=t[2],v=t[3],k=t[4],w=t[5],T=t[6],A=t[7],S=t[8],C=t[9],L=t[10],E=t[11],g[0]=x,g[1]=_,g[2]=b,g[3]=v,g[4]=k,g[5]=w,g[6]=T,g[7]=A,g[8]=S,g[9]=C,g[10]=L,g[11]=E,g[12]=x*r+k*d+S*m+t[12],g[13]=_*r+w*d+C*m+t[13],g[14]=b*r+T*d+L*m+t[14],g[15]=v*r+A*d+E*m+t[15]),g},j.uniqueId=s,j.validateCustomStyleLayer=function(a){var t=[],e=a.id;return void 0===e&&t.push({message:"layers."+e+": missing required property \"id\""}),void 0===a.render&&t.push({message:"layers."+e+": missing required method \"render\""}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&t.push({message:"layers."+e+": property \"renderingMode\" must be either \"2d\" or \"3d\""}),t},j.validateLight=mn,j.validateStyle=pn,j.values=function(a){var t=[];for(var e in a)t.push(a[e]);return t},j.vectorTile=ts,j.version="1.1.1",j.warnOnce=Fa,j.webpSupported=yd,j.window=self,j.wrap=l}),e(["./shared.js"],function(C){function z(t){var e=typeof t;if("number"==e||"boolean"==e||"string"==e||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",l=0,d=t;l<d.length;l+=1)r+=z(d[l])+",";return r+"]"}for(var n=Object.keys(t).sort(),a="{",c=0;c<n.length;c++)a+=JSON.stringify(n[c])+":"+z(t[n[c]])+",";return a+"}"}function D(e){for(var t="",a=0,r=C.refProperties;a<r.length;a+=1)t+="/"+z(e[r[a]]);return t}function e(e,t){for(var a=new C.EvaluationParameters(t),r=0,o=e;r<o.length;r+=1)o[r].recalculate(a)}function a(e,a){var t=C.getArrayBuffer(e.request,function(e,t,r,o){e?a(e):t&&a(null,{vectorTile:new C.vectorTile.VectorTile(new C.pbf(t)),rawData:t,cacheControl:r,expires:o})});return function(){t.cancel(),a()}}function h(a){var e=0;if(a&&0<a.length){e+=_a(t(a[0]));for(var o=1;o<a.length;o++)e-=_a(t(a[o]))}return e}function t(l){var e=0,p=l.length,u,g,h,m,y,f;if(2<p){for(f=0;f<p;f++)f===p-2?(h=p-2,m=p-1,y=0):f===p-1?(h=p-1,m=0,y=1):(h=f,m=f+1,y=f+2),u=l[h],g=l[m],e+=(d(l[y][0])-d(u[0]))*De(d(g[1]));e=e*c.RADIUS*c.RADIUS/2}return e}function d(t){return t*Pe/180}function g(a,e){return function(t){return a(t,e)}}function r(a,e){e=!!e,a[0]=x(a[0],e);for(var o=1;o<a.length;o++)a[o]=x(a[o],!e);return a}function x(a,e){return function(t){return 0<=p.ring(t)}(a)===e?a:a.reverse()}function w(a,e){this.options=e||{},this.features=a,this.length=a.length}function S(a,e){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=e||4096}function T(e){var t=new C.pbf;return function(a,e){for(var t in a.layers)e.writeMessage(3,I,a.layers[t])}(e,t),t.finish()}function I(a,e){var t;e.writeVarintField(15,a.version||1),e.writeStringField(1,a.name||""),e.writeVarintField(5,a.extent||4096);var l={keys:[],values:[],keycache:{},valuecache:{}};for(t=0;t<a.length;t++)l.feature=a.feature(t),e.writeMessage(2,E,l);var o=l.keys;for(t=0;t<o.length;t++)e.writeStringField(3,o[t]);var i=l.values;for(t=0;t<i.length;t++)e.writeMessage(4,J,i[t])}function E(a,e){var t=a.feature;void 0!==t.id&&e.writeVarintField(1,t.id),e.writeMessage(2,O,a),e.writeVarintField(3,t.type),e.writeMessage(4,B,t)}function O(d,e){var t=d.feature,r=d.keys,o=d.values,i=d.keycache,n=d.valuecache;for(var a in t.properties){var s=i[a];void 0===s&&(r.push(a),s=r.length-1,i[a]=s),e.writeVarint(s);var g=t.properties[a],m=typeof g;"string"!=m&&"boolean"!=m&&"number"!=m&&(g=JSON.stringify(g));var h=m+":"+g,c=n[h];void 0===c&&(o.push(g),c=o.length-1,n[h]=c),e.writeVarint(c)}}function F(a,e){return(e<<3)+(7&a)}function A(t){return t<<1^t>>31}function B(d,e){for(var t=d.loadGeometry(),r=d.type,o=0,g=0,m=t.length,a=0;a<m;a++){var y=t[a],u=1;1===r&&(u=y.length),e.writeVarint(F(1,u));for(var x=3===r?y.length-1:y.length,h=0;h<x;h++){1==h&&1!==r&&e.writeVarint(F(2,x-1));var _=y[h].x-o,p=y[h].y-g;e.writeVarint(A(_)),e.writeVarint(A(p)),o+=_,g+=p}3===r&&e.writeVarint(F(7,1))}}function J(a,e){var t=typeof a;"string"==t?e.writeStringField(1,a):"boolean"==t?e.writeBooleanField(7,a):"number"==t&&(0==a%1?0>a?e.writeSVarintField(6,a):e.writeVarintField(5,a):e.writeDoubleField(3,a))}function G(l,e,t,r,o,i){if(!(o-r<=t)){var n=r+o>>1;!function y(e,t,r,o,x,_){for(;x>o;){if(600<x-o){var a=x-o+1,s=r-o+1,u=P(a),l=.5*m(2*u/3),h=.5*N(u*l*(a-l)/a)*(0>s-a/2?-1:1),c=va(o,ba(r-s*l/a+h)),p=ea(x,ba(r+(a-s)*l/a+h));y(e,t,r,c,p,_)}var f=t[2*r+_],d=o,b=x;for(Z(e,t,o,r),t[2*x+_]>f&&Z(e,t,o,x);d<b;){for(Z(e,t,d,b),d++,b--;t[2*d+_]<f;)d++;for(;t[2*b+_]>f;)b--}t[2*o+_]===f?Z(e,t,o,b):Z(e,t,++b,x),b<=r&&(o=b+1),r<=b&&(x=b-1)}}(l,e,n,r,o,i%2),G(l,e,t,r,n-1,i+1),G(l,e,t,n+1,o,i+1)}}function Z(a,e,t,r){j(a,t,r),j(e,2*t,2*r),j(e,2*t+1,2*r+1)}function j(a,e,t){var r=a[e];a[e]=a[t],a[t]=r}function Y(a,e,t,r){var o=a-t,i=e-r;return o*o+i*i}function Ae(a,e,t,r,o){return{x:a,y:e,zoom:1/0,id:t,parentId:-1,numPoints:r,properties:o}}function $(a,e){var t=a.geometry.coordinates,r=t[0],o=t[1];return{x:Q(r),y:ee(o),zoom:1/0,index:e,parentId:-1}}function H(a){return{type:"Feature",id:a.id,properties:K(a),geometry:{type:"Point",coordinates:[(n=a.x,360*(n-.5)),(e=a.y,i=(180-360*e)*Pe/180,360*xa(m(i))/Pe-90)]}};var e,i,n}function K(a){var e=a.numPoints,t=1e4<=e?V(e/1e3)+"k":1e3<=e?V(e/100)/10+"k":e;return te(te({},a.properties),{cluster:!0,cluster_id:a.id,point_count:e,point_count_abbreviated:t})}function Q(t){return t/360+.5}function ee(a){var e=De(a*Pe/180),t=.5-.25*P((1+e)/(1-e))/Pe;return 0>t?0:1<t?1:t}function te(a,e){for(var t in e)a[t]=e[t];return a}function re(t){return t.x}function oe(t){return t.y}function ie(l,e,t,d,c,i){var n=c-t,p=i-d;if(0!=n||0!=p){var g=((l-t)*n+(e-d)*p)/(n*n+p*p);1<g?(t=c,d=i):0<g&&(t+=n*g,d+=p*g)}return(n=l-t)*n+(p=e-d)*p}function ne(a,e,t,r){var o={id:void 0===a?null:a,type:e,geometry:t,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(a){var e=a.geometry,t=a.type;if("Point"===t||"MultiPoint"===t||"LineString"===t)ae(a,e);else if("Polygon"===t||"MultiLineString"===t)for(var r=0;r<e.length;r++)ae(a,e[r]);else if("MultiPolygon"===t)for(r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)ae(a,e[r][n])}(o),o}function ae(a,e){for(var t=0;t<e.length;t+=3)a.minX=ea(a.minX,e[t]),a.minY=ea(a.minY,e[t+1]),a.maxX=va(a.maxX,e[t]),a.maxY=va(a.maxY,e[t+1])}function se(d,e,t,r){if(e.geometry){var o=e.geometry.coordinates,i=e.geometry.type,n=ya(t.tolerance/((1<<t.maxZoom)*t.extent),2),a=[],c=e.id;if(t.promoteId?c=e.properties[t.promoteId]:t.generateId&&(c=r||0),"Point"===i)ue(o,a);else if("MultiPoint"===i)for(var p=0;p<o.length;p++)ue(o[p],a);else if("LineString"===i)le(o,a,n,!1);else if("MultiLineString"===i){if(t.lineMetrics){for(p=0;p<o.length;p++)a=[],le(o[p],a,n,!1),d.push(ne(c,"LineString",a,e.properties));return}he(o,a,n,!1)}else if("Polygon"===i)he(o,a,n,!0);else{if("MultiPolygon"!==i){if("GeometryCollection"===i){for(p=0;p<e.geometry.geometries.length;p++)se(d,{id:c,geometry:e.geometry.geometries[p],properties:e.properties},t,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(p=0;p<o.length;p++){var g=[];he(o[p],g,n,!0),a.push(g)}}d.push(ne(c,i,a,e.properties))}}function ue(a,e){e.push(ce(a[0])),e.push(pe(a[1])),e.push(0)}function le(d,e,t,r){for(var o=0,c=0,p,g;c<d.length;c++){var m=ce(d[c][0]),u=pe(d[c][1]);e.push(m),e.push(u),e.push(0),0<c&&(o+=r?(p*u-m*g)/2:N(ya(m-p,2)+ya(u-g,2))),p=m,g=u}var l=e.length-3;e[2]=1,function s(e,t,r,o){for(var i=o,m=r-t,y=e[t],l=e[t+1],h=e[r],c=e[r+1],p=t+3,x,_;p<r;p+=3)if(_=ie(e[p],e[p+1],y,l,h,c),_>i)x=p,i=_;else if(_===i){var b=_a(p-(r-t>>1));b<m&&(x=p,m=b)}i>o&&(3<x-t&&s(e,t,x,o),e[x+2]=i,3<r-x&&s(e,x,r,o))}(e,0,l,t),e[l+2]=1,e.size=_a(o),e.start=0,e.end=e.size}function he(a,e,t,r){for(var o=0,l;o<a.length;o++)l=[],le(a[o],l,t,r),e.push(l)}function ce(t){return t/360+.5}function pe(a){var e=De(a*Pe/180),t=.5-.25*P((1+e)/(1-e))/Pe;return 0>t?0:1<t?1:t}function fe(y,e,t,x,_,i,n,a){if(x/=e,i>=(t/=e)&&n<x)return y;if(n<t||i>=x)return null;for(var s=[],u=0;u<y.length;u++){var b=y[u],h=b.geometry,c=b.type,k=0===_?b.minX:b.minY,f=0===_?b.maxX:b.maxY;if(k>=t&&f<x)s.push(b);else if(!(f<t||k>=x)){var d=[];if("Point"===c||"MultiPoint"===c)de(h,d,t,x,_);else if("LineString"===c)ge(h,d,t,x,_,!1,a.lineMetrics);else if("MultiLineString"===c)ve(h,d,t,x,_,!1);else if("Polygon"===c)ve(h,d,t,x,_,!0);else if("MultiPolygon"===c)for(var w=0,T;w<h.length;w++)T=[],ve(h[w],T,t,x,_,!0),T.length&&d.push(T);if(d.length){if(a.lineMetrics&&"LineString"===c){for(w=0;w<d.length;w++)s.push(ne(b.id,c,d[w],b.tags));continue}"LineString"!==c&&"MultiLineString"!==c||(1===d.length?(c="LineString",d=d[0]):c="MultiLineString"),"Point"!==c&&"MultiPoint"!==c||(c=3===d.length?"Point":"MultiPoint"),s.push(ne(b.id,c,d,b.tags))}}}return s.length?s:null}function de(l,e,t,r,o){for(var i=0,s;i<l.length;i+=3)s=l[i+o],s>=t&&s<=r&&(e.push(l[i]),e.push(l[i+1]),e.push(l[i+2]))}function ge(_,e,t,r,o,i,n){for(var a=me(_),b=0===o?xe:we,h=_.start,k=0,T,A;k<_.length-3;k+=3){var C=_[k],L=_[k+1],E=_[k+2],I=_[k+3],m=_[k+4],v=0===o?C:L,z=0===o?I:m,x=!1;n&&(T=N(ya(C-I,2)+ya(L-m,2))),v<t?z>t&&(A=b(a,C,L,I,m,t),n&&(a.start=h+T*A)):v>r?z<r&&(A=b(a,C,L,I,m,r),n&&(a.start=h+T*A)):ye(a,C,L,E),z<t&&v>=t&&(A=b(a,C,L,I,m,t),x=!0),z>r&&v<=r&&(A=b(a,C,L,I,m,r),x=!0),!i&&x&&(n&&(a.end=h+T*A),e.push(a),a=me(_)),n&&(h+=T)}var P=_.length-3;C=_[P],L=_[P+1],E=_[P+2],(v=0===o?C:L)>=t&&v<=r&&ye(a,C,L,E),P=a.length-3,i&&3<=P&&(a[P]!==a[0]||a[P+1]!==a[1])&&ye(a,a[0],a[1],a[2]),a.length&&e.push(a)}function me(a){var e=[];return e.size=a.size,e.start=a.start,e.end=a.end,e}function ve(l,e,t,r,o,i){for(var n=0;n<l.length;n++)ge(l[n],e,t,r,o,i,!1)}function ye(a,e,t,r){a.push(e),a.push(t),a.push(r)}function xe(l,e,t,r,o,i){var n=(i-e)/(r-e);return l.push(i),l.push(t+(o-t)*n),l.push(1),n}function we(l,e,t,r,o,i){var n=(i-t)/(o-t);return l.push(e+(r-e)*n),l.push(i),l.push(1),n}function Se(d,e){for(var t=[],r=0;r<d.length;r++){var c=d[r],n=c.type,a;if("Point"===n||"MultiPoint"===n||"LineString"===n)a=Ee(c.geometry,e);else if("MultiLineString"===n||"Polygon"===n){a=[];for(var p=0;p<c.geometry.length;p++)a.push(Ee(c.geometry[p],e))}else if("MultiPolygon"===n)for(a=[],p=0;p<c.geometry.length;p++){for(var g=[],u=0;u<c.geometry[p].length;u++)g.push(Ee(c.geometry[p][u],e));a.push(g)}t.push(ne(c.id,n,a,c.tags))}return t}function Ee(a,e){var t=[];t.size=a.size,void 0!==a.start&&(t.start=a.start,t.end=a.end);for(var r=0;r<a.length;r+=3)t.push(a[r]+e,a[r+1],a[r+2]);return t}function ke(d,e){if(d.transformed)return d;var t=1<<d.z,n=d.x,a=d.y,s,p,g;for(s=0;s<d.features.length;s++){var m=d.features[s],u=m.geometry,l=m.type;if(m.geometry=[],1===l)for(p=0;p<u.length;p+=2)m.geometry.push(be(u[p],u[p+1],e,t,n,a));else for(p=0;p<u.length;p++){var h=[];for(g=0;g<u[p].length;g+=2)h.push(be(u[p][g],u[p][g+1],e,t,n,a));m.geometry.push(h)}}return d.transformed=!0,d}function be(a,e,t,r,o,i){return[V(t*(a*r-o)),V(t*(e*r-i))]}function _e(d,e,t,r,o){for(var i=e===o.maxZoom?0:o.tolerance/((1<<e)*o.extent),n={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:t,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<d.length;a++){n.numFeatures++,Re(n,d[a],i,o);var p=d[a].minX,u=d[a].minY,l=d[a].maxX,g=d[a].maxY;p<n.minX&&(n.minX=p),u<n.minY&&(n.minY=u),l>n.maxX&&(n.maxX=l),g>n.maxY&&(n.maxY=g)}return n}function Re(d,e,t,r){var o=e.geometry,i=e.type,n=[];if("Point"===i||"MultiPoint"===i)for(var a=0;a<o.length;a+=3)n.push(o[a]),n.push(o[a+1]),d.numPoints++,d.numSimplified++;else if("LineString"===i)Ie(n,o,d,t,!1,!1);else if("MultiLineString"===i||"Polygon"===i)for(a=0;a<o.length;a++)Ie(n,o[a],d,t,"Polygon"===i,0==a);else if("MultiPolygon"===i)for(var g=0,m;g<o.length;g++)for(m=o[g],a=0;a<m.length;a++)Ie(n,m[a],d,t,!0,0==a);if(n.length){var y=e.tags||null;if("LineString"===i&&r.lineMetrics){for(var f in y={},e.tags)y[f]=e.tags[f];y.mapbox_clip_start=o.start/o.size,y.mapbox_clip_end=o.end/o.size}var c={geometry:n,type:"Polygon"===i||"MultiPolygon"===i?3:"LineString"===i||"MultiLineString"===i?2:1,tags:y};null!==e.id&&(c.id=e.id),d.features.push(c)}}function Ie(l,e,t,r,o,i){var n=r*r;if(0<r&&e.size<(o?n:r))t.numPoints+=e.length/3;else{for(var a=[],s=0;s<e.length;s+=3)(0==r||e[s+2]>n)&&(t.numSimplified++,a.push(e[s]),a.push(e[s+1])),t.numPoints++;o&&function(l,e){for(var t=0,d=0,c=l.length,p=c-2;d<c;p=d,d+=2)t+=(l[d]-l[p])*(l[d+1]+l[p+1]);if(0<t===e)for(d=0,c=l.length;d<c/2;d+=2){var u=l[d],a=l[d+1];l[d]=l[c-2-d],l[d+1]=l[c-1-d],l[c-2-d]=u,l[c-1-d]=a}}(a,i),l.push(a)}}function Te(a,e){var i=(e=this.options=function(a,e){for(var t in e)a[t]=e[t];return a}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),0>e.maxZoom||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(a,e){var t=[];if("FeatureCollection"===a.type)for(var r=0;r<a.features.length;r++)se(t,a.features[r],e,r);else"Feature"===a.type?se(t,a,e):se(t,{geometry:a},e);return t}(a,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(a,e){var t=e.buffer/e.extent,r=a,l=fe(a,1,-1-t,t,0,-1,2,e),i=fe(a,1,1-t,2+t,0,-1,2,e);return(l||i)&&(r=fe(a,1,-t,1+t,0,-1,2,e)||[],l&&(r=Se(l,1).concat(r)),i&&(r=r.concat(Se(i,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Le(a,e,t){return 32*((1<<a)*t+e)+a}function Me(a,e){var t=a.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(t.z,t.x,t.y);if(!r)return e(null,null);var o=new v(r.features),i=k(o);0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),e(null,{vectorTile:o,rawData:i.buffer})}var Ce=function(t){this.keyCache={},t&&this.replace(t)};Ce.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},Ce.prototype.update=function(e,t){for(var r=this,o=0,i=e,a;o<i.length;o+=1){a=i[o],this._layerConfigs[a.id]=a;var _=this._layers[a.id]=C.createStyleLayer(a);_._featureFilter=C.featureFilter(_.filter),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(var u=0,b=t,h;u<b.length;u+=1)h=b[u],delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h];this.familiesBySource={};for(var k=0,w=function(r,e){for(var t={},o=0,l;o<r.length;o++){l=e&&e[r[o].id]||D(r[o]),e&&(e[r[o].id]=l);var d=t[l];d||(d=t[l]=[]),d.push(r[o])}var c=[];for(var s in t)c.push(t[s]);return c}(C.values(this._layerConfigs),this.keyCache);k<w.length;k+=1){var f=w[k].map(function(t){return r._layers[t.id]}),d=f[0];if("none"!==d.visibility){var g=d.source||"",m=this.familiesBySource[g];m||(m=this.familiesBySource[g]={});var T=d.sourceLayer||"_geojsonTileLayer",y=m[T];y||(y=m[T]=[]),y.push(f)}}};var je=function(e){var t={},r=[];for(var o in e){var i=e[o],n=t[o]={};for(var a in i){var s=i[+a];if(s&&0!==s.bitmap.width&&0!==s.bitmap.height){var u={x:0,y:0,w:s.bitmap.width+2,h:s.bitmap.height+2};r.push(u),n[a]={rect:u,metrics:s.metrics}}}}var l=C.potpack(r),h=l.w,c=l.h,p=new C.AlphaImage({width:h||1,height:c||1});for(var f in e){var d=e[f];for(var g in d){var m=d[+g];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var x=t[f][g].rect;C.AlphaImage.copy(m.bitmap,p,{x:0,y:0},{x:x.x+1,y:x.y+1},m.bitmap)}}}this.image=p,this.positions=t};C.register("GlyphAtlas",je);var Fe=function(e){this.tileID=new C.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies};Fe.prototype.parse=function(a,t,r,i){function o(){if(m)return i(m);if(A&&E&&z){var a=new je(A),t=new C.ImageAtlas(E,z);for(var r in l){var o=l[r];o instanceof C.SymbolBucket?(e(o.layers,this.zoom),C.performSymbolLayout(o,A,a.positions,E,t.iconPositions,this.showCollisionBoxes)):o.hasPattern&&(o instanceof C.LineBucket||o instanceof C.FillBucket||o instanceof C.FillExtrusionBucket)&&(e(o.layers,this.zoom),o.addFeatures(d,t.patternPositions))}this.status="done",i(null,{buckets:C.values(l).filter(function(t){return!t.isEmpty()}),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:a.image,imageAtlas:t,glyphMap:this.returnDependencies?A:null,iconMap:this.returnDependencies?E:null,glyphPositions:this.returnDependencies?a.positions:null})}}var n=this;this.status="parsing",this.data=a,this.collisionBoxArray=new C.CollisionBoxArray;var s=new C.DictionaryCoder(Object.keys(a.layers).sort()),u=new C.FeatureIndex(this.tileID);u.bucketLayerIDs=[];var l={},d={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{}},g=t.familiesBySource[this.source],m,A,E,z;for(var D in g){var v=a.layers[D];if(v){1===v.version&&C.warnOnce("Vector tile source \""+this.source+"\" layer \""+D+"\" does not use vector tile spec v2 and therefore may have some rendering errors.");for(var y=s.encode(D),x=[],w=0,O;w<v.length;w++)O=v.feature(w),x.push({feature:O,index:w,sourceLayerIndex:y});for(var R=0,j=g[D];R<j.length;R+=1){var b=j[R],_=b[0];_.minzoom&&this.zoom<ba(_.minzoom)||_.maxzoom&&this.zoom>=_.maxzoom||"none"===_.visibility||(e(b,this.zoom),(l[_.id]=_.createBucket({index:u.bucketLayerIDs.length,layers:b,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:y,sourceID:this.source})).populate(x,d),u.bucketLayerIDs.push(b.map(function(t){return t.id})))}}}var P=C.mapObject(d.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(P).length?r.send("getGlyphs",{uid:this.uid,stacks:P},function(a,e){m||(m=a,A=e,o.call(n))}):A={};var I=Object.keys(d.iconDependencies);I.length?r.send("getImages",{icons:I},function(a,e){m||(m=a,E=e,o.call(n))}):E={};var T=Object.keys(d.patternDependencies);T.length?r.send("getImages",{icons:T},function(a,e){m||(m=a,z=e,o.call(n))}):z={},o.call(this)};var o="undefined"!=typeof performance,n={getEntriesByName:function(t){return!!(o&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(o&&performance&&performance.mark)&&performance.mark(t)},measure:function(a,e,t){return!!(o&&performance&&performance.measure)&&performance.measure(a,e,t)},clearMarks:function(t){return!!(o&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(o&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}},i=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},n.mark(this._marks.start)};i.prototype.finish=function(){n.mark(this._marks.end);var t=n.getEntriesByName(this._marks.measure);return 0===t.length&&(n.measure(this._marks.measure,this._marks.start,this._marks.end),t=n.getEntriesByName(this._marks.measure),n.clearMarks(this._marks.start),n.clearMarks(this._marks.end),n.clearMeasures(this._marks.measure)),t},n.Performance=i;var l=function(o,e,t){this.actor=o,this.layerIndex=e,this.loadVectorData=t||a,this.loading={},this.loaded={}};l.prototype.loadTile=function(e,d){var r=this,o=e.uid;this.loading||(this.loading={});var i=!!(e&&e.request&&e.request.collectResourceTiming)&&new n.Performance(e.request),a=this.loading[o]=new Fe(e);a.abort=this.loadVectorData(e,function(e,t){if(delete r.loading[o],e||!t)return a.status="done",r.loaded[o]=a,d(e);var n=t.rawData,s={};t.expires&&(s.expires=t.expires),t.cacheControl&&(s.cacheControl=t.cacheControl);var l={};if(i){var p=i.finish();p&&(l.resourceTiming=JSON.parse(JSON.stringify(p)))}a.vectorTile=t.vectorTile,a.parse(t.vectorTile,r.layerIndex,r.actor,function(e,t){return e||!t?d(e):void d(null,C.extend({rawTileData:n.slice(0)},t,s,l))}),r.loaded=r.loaded||{},r.loaded[o]=a})},l.prototype.reloadTile=function(l,s){var e=this.loaded,t=l.uid,d=this;if(e&&e[t]){var i=e[t];i.showCollisionBoxes=l.showCollisionBoxes;var r=function(t,e){var a=i.reloadCallback;a&&(delete i.reloadCallback,i.parse(i.vectorTile,d.layerIndex,d.actor,a)),s(t,e)};"parsing"===i.status?i.reloadCallback=r:"done"===i.status&&(i.vectorTile?i.parse(i.vectorTile,this.layerIndex,this.actor,r):r())}},l.prototype.abortTile=function(a,e){var t=this.loading,r=a.uid;t&&t[r]&&t[r].abort&&(t[r].abort(),delete t[r]),e()},l.prototype.removeTile=function(a,e){var t=this.loaded,r=a.uid;t&&t[r]&&delete t[r],e()};var s=function(){this.loaded={}};s.prototype.loadTile=function(e,t){var r=e.uid,o=e.encoding,i=e.rawImageData,n=new C.DEMData(r,i,o);this.loaded=this.loaded||{},this.loaded[r]=n,t(null,n)},s.prototype.removeTile=function(a){var e=this.loaded,t=a.uid;e&&e[t]&&delete e[t]};var c={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142},p={geometry:function a(e){var t=0,i;switch(e.type){case"Polygon":return h(e.coordinates);case"MultiPolygon":for(i=0;i<e.coordinates.length;i++)t+=h(e.coordinates[i]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(i=0;i<e.geometries.length;i++)t+=a(e.geometries[i]);return t;}},ring:t},f=function a(e,t){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(g(a,t)),e;case"GeometryCollection":return e.geometries=e.geometries.map(g(a,t)),e;case"Feature":return e.geometry=a(e.geometry,t),e;case"Polygon":case"MultiPolygon":return function(a,e){return"Polygon"===a.type?a.coordinates=r(a.coordinates,e):"MultiPolygon"===a.type&&(a.coordinates=a.coordinates.map(g(r,e))),a}(e,t);default:return e;}},u=C.vectorTile.VectorTileFeature.prototype.toGeoJSON,y=function(e){this._feature=e,this.extent=C.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};y.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],t=0,d=this._feature.geometry,o;t<d.length;t+=1)o=d[t],e.push([new C.Point$1(o[0],o[1])]);return e}for(var p=[],n=0,g=this._feature.geometry;n<g.length;n+=1){for(var s=[],u=0,m=g[n],h;u<m.length;u+=1)h=m[u],s.push(new C.Point$1(h[0],h[1]));p.push(s)}return p},y.prototype.toGeoJSON=function(a,e,t){return u.call(this,a,e,t)};var v=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=C.EXTENT,this.length=e.length,this._features=e};v.prototype.feature=function(t){return new y(this._features[t])};var b=C.vectorTile.VectorTileFeature,_=w;w.prototype.feature=function(t){return new S(this.features[t],this.options.extent)},S.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var a=e[t],o=[],i=0;i<a.length;i++)o.push(new C.Point$1(a[i][0],a[i][1]));this.geometry.push(o)}return this.geometry},S.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var l=this.geometry,e=1/0,d=-1/0,c=1/0,p=-1/0,g=0;g<l.length;g++)for(var h=l[g],a=0,m;a<h.length;a++)m=h[a],e=ea(e,m.x),d=va(d,m.x),c=ea(c,m.y),p=va(p,m.y);return[e,c,d,p]},S.prototype.toGeoJSON=b.prototype.toGeoJSON;var k=T;k.fromVectorTileJs=T,k.fromGeojsonVt=function(a,e){e=e||{};var i={};for(var r in a)i[r]=new _(a[r].features,e),i[r].name=r,i[r].version=e.version,i[r].extent=e.extent;return T({layers:i})},k.GeoJSONWrapper=_;var L=function(t){return t[0]},M=function(t){return t[1]},W=function(l,e,d,c,p){void 0===e&&(e=L),void 0===d&&(d=M),void 0===c&&(c=64),void 0===p&&(p=Float64Array),this.nodeSize=c,this.points=l;for(var g=65536>l.length?Uint16Array:Uint32Array,n=this.ids=new g(l.length),a=this.coords=new p(2*l.length),s=0;s<l.length;s++)n[s]=s,a[2*s]=e(l[s]),a[2*s+1]=d(l[s]);G(n,a,c,0,n.length-1,0)};W.prototype.range=function(a,e,t,r){return function(y,e,t,r,o,i,n){for(var a=[0,y.length-1,0],l=[],h,x;a.length;){var _=a.pop(),c=a.pop(),p=a.pop();if(c-p<=n)for(var f=p;f<=c;f++)h=e[2*f],x=e[2*f+1],h>=t&&h<=o&&x>=r&&x<=i&&l.push(y[f]);else{var b=ba((p+c)/2);h=e[2*b],x=e[2*b+1],h>=t&&h<=o&&x>=r&&x<=i&&l.push(y[b]);var g=(_+1)%2;(0===_?t<=h:r<=x)&&(a.push(p),a.push(b-1),a.push(g)),(0===_?o>=h:i>=x)&&(a.push(b+1),a.push(c),a.push(g))}}return l}(this.ids,this.coords,a,e,t,r,this.nodeSize)},W.prototype.within=function(a,e,t){return function(y,e,t,r,o,i){for(var n=[0,y.length-1,0],a=[],s=o*o;n.length;){var u=n.pop(),l=n.pop(),h=n.pop();if(l-h<=i)for(var c=h;c<=l;c++)Y(e[2*c],e[2*c+1],t,r)<=s&&a.push(y[c]);else{var x=ba((h+l)/2),f=e[2*x],d=e[2*x+1];Y(f,d,t,r)<=s&&a.push(y[x]);var g=(u+1)%2;(0===u?t-o<=f:r-o<=d)&&(n.push(h),n.push(x-1),n.push(g)),(0===u?t+o>=f:r+o>=d)&&(n.push(x+1),n.push(l),n.push(g))}}return a}(this.ids,this.coords,a,e,t,this.nodeSize)};var R={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,map:function(t){return t}},q=function(t){this.options=te(Object.create(R),t),this.trees=Array(this.options.maxZoom+1)};q.prototype.load=function(d){var e=this.options,t=e.log,r=e.minZoom,o=e.maxZoom,i=e.nodeSize;t&&console.time("total time");var n="prepare "+d.length+" points";t&&console.time(n),this.points=d;for(var a=[],c=0;c<d.length;c++)d[c].geometry&&a.push($(d[c],c));this.trees[o+1]=new W(a,re,oe,i,Float32Array),t&&console.timeEnd(n);for(var p=o,g;p>=r;p--)g=+Date.now(),a=this._cluster(a,p),this.trees[p]=new W(a,re,oe,i,Float32Array),t&&console.log("z%d: %d clusters in %dms",p,a.length,+Date.now()-g);return t&&console.timeEnd("total time"),this},q.prototype.getClusters=function(d,e){var t=((d[0]+180)%360+360)%360-180,g=va(-90,ea(90,d[1])),o=180===d[2]?180:((d[2]+180)%360+360)%360-180,m=va(-90,ea(90,d[3]));if(360<=d[2]-d[0])t=-180,o=180;else if(t>o){var n=this.getClusters([t,g,180,m],e),a=this.getClusters([-180,g,o,m],e);return n.concat(a)}for(var s=this.trees[this._limitZoom(e)],u=[],l=0,y=s.range(Q(t),ee(m),Q(o),ee(g));l<y.length;l+=1){var c=y[l],p=s.points[c];u.push(p.numPoints?H(p):this.points[p.index])}return u},q.prototype.getChildren=function(t){var e=t%32,r=this.trees[e];if(!r)throw new Error("No cluster with the specified id.");var o=r.points[t>>5];if(!o)throw new Error("No cluster with the specified id.");for(var i=this.options.radius/(this.options.extent*ya(2,e-1)),a=[],n=0,s=r.within(o.x,o.y,i);n<s.length;n+=1){var l=s[n],d=r.points[l];d.parentId===t&&a.push(d.numPoints?H(d):this.points[d.index])}if(0===a.length)throw new Error("No cluster with the specified id.");return a},q.prototype.getLeaves=function(a,e,i){e=e||10,i=i||0;var n=[];return this._appendLeaves(n,a,e,i,0),n},q.prototype.getTile=function(d,e,t){var r=this.trees[this._limitZoom(d)],o=ya(2,d),i=this.options,n=i.extent,a=i.radius/n,s=(t-a)/o,c=(t+1+a)/o,l={features:[]};return this._addTileFeatures(r.range((e-a)/o,s,(e+1+a)/o,c),r.points,e,t,o,l),0===e&&this._addTileFeatures(r.range(1-a/o,s,1,c),r.points,o,t,o,l),e===o-1&&this._addTileFeatures(r.range(0,s,a/o,c),r.points,-1,t,o,l),l.features.length?l:null},q.prototype.getClusterExpansionZoom=function(a){for(var o=a%32-1,i;o<=this.options.maxZoom&&(i=this.getChildren(a),o++,1===i.length);)a=i[0].properties.cluster_id;return o},q.prototype._appendLeaves=function(l,e,t,r,o){for(var d=0,c=this.getChildren(e);d<c.length;d+=1){var a=c[d],s=a.properties;if(s&&s.cluster?o+s.point_count<=r?o+=s.point_count:o=this._appendLeaves(l,s.cluster_id,t,r,o):o<r?o++:l.push(a),l.length===t)break}return o},q.prototype._addTileFeatures=function(d,e,t,r,o,i){for(var n=0,c=d;n<c.length;n+=1){var s=e[c[n]],p={type:1,geometry:[[V(this.options.extent*(s.x*o-t)),V(this.options.extent*(s.y*o-r))]],tags:s.numPoints?K(s):this.points[s.index].properties},l=s.numPoints?s.id:this.points[s.index].id;void 0!==l&&(p.id=l),i.features.push(p)}},q.prototype._limitZoom=function(t){return va(this.options.minZoom,ea(t,this.options.maxZoom+1))},q.prototype._cluster=function(_,e){for(var t=[],r=this.options,o=r.radius,i=r.extent,n=r.reduce,a=o/(i*ya(2,e)),s=0,b;s<_.length;s++)if(b=_[s],!(b.zoom<=e)){b.zoom=e;for(var k=this.trees[e+1],h=k.within(b.x,b.y,a),c=b.numPoints||1,T=b.x*c,A=b.y*c,C=n?this._map(b,!0):null,g=(s<<5)+(e+1),m=0,L=h;m<L.length;m+=1){var y=L[m],x=k.points[y];if(!(x.zoom<=e)){x.zoom=e;var w=x.numPoints||1;T+=x.x*w,A+=x.y*w,c+=w,x.parentId=g,n&&n(C,this._map(x))}}1===c?t.push(b):(b.parentId=g,t.push(Ae(T/c,A/c,g,c,C)))}return t},q.prototype._map=function(a,e){if(a.numPoints)return e?te({},a.properties):a.properties;var t=this.points[a.index].properties,r=this.options.map(t);return e&&r===t?te({},r):r},Te.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Te.prototype.splitTile=function(_,T,A,C,L,i,n){for(var a=[_,T,A,C],s=this.options,u=s.debug;a.length;){C=a.pop(),A=a.pop(),T=a.pop(),_=a.pop();var l=1<<T,h=Le(T,A,C),c=this.tiles[h];if(!c&&(1<u&&console.time("creation"),c=this.tiles[h]=_e(_,T,A,C,s),this.tileCoords.push({z:T,x:A,y:C}),u)){1<u&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",T,A,C,c.numFeatures,c.numPoints,c.numSimplified),console.timeEnd("creation"));var E="z"+T;this.stats[E]=(this.stats[E]||0)+1,this.total++}if(c.source=_,L){if(T===s.maxZoom||T===L)continue;var f=1<<L-T;if(A!==ba(i/f)||C!==ba(n/f))continue}else if(T===s.indexMaxZoom||c.numPoints<=s.indexMaxPoints)continue;if(c.source=null,0!==_.length){1<u&&console.time("clipping");var d=.5*s.buffer/s.extent,S=.5-d,I=.5+d,k=1+d,b,z,P,D,O,R;b=z=P=D=null,O=fe(_,l,A-d,A+I,0,c.minX,c.maxX,s),R=fe(_,l,A+S,A+k,0,c.minX,c.maxX,s),_=null,O&&(b=fe(O,l,C-d,C+I,1,c.minY,c.maxY,s),z=fe(O,l,C+S,C+k,1,c.minY,c.maxY,s),O=null),R&&(P=fe(R,l,C-d,C+I,1,c.minY,c.maxY,s),D=fe(R,l,C+S,C+k,1,c.minY,c.maxY,s),R=null),1<u&&console.timeEnd("clipping"),a.push(b||[],T+1,2*A,2*C),a.push(z||[],T+1,2*A,2*C+1),a.push(P||[],T+1,2*A+1,2*C),a.push(D||[],T+1,2*A+1,2*C+1)}}},Te.prototype.getTile=function(d,e,p){var r=this.options,o=r.extent,i=r.debug;if(0>d||24<d)return null;var n=1<<d,a=Le(d,e=(e%n+n)%n,p);if(this.tiles[a])return ke(this.tiles[a],o);1<i&&console.log("drilling down to z%d-%d-%d",d,e,p);for(var s=d,g=e,m=p,y;!y&&0<s;)s--,g=ba(g/2),m=ba(m/2),y=this.tiles[Le(s,g,m)];return y&&y.source?(1<i&&console.log("found parent tile z%d-%d-%d",s,g,m),1<i&&console.time("drilling down"),this.splitTile(y.source,s,g,m,d,e,p),1<i&&console.timeEnd("drilling down"),this.tiles[a]?ke(this.tiles[a],o):null):null};var U=function(a){function e(t,e,r){a.call(this,t,e,Me),r&&(this.loadGeoJSON=r)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.loadData=function(a,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=a,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},e.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var t=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var o=!!(r&&r.request&&r.request.collectResourceTiming)&&new n.Performance(r.request);this.loadGeoJSON(r,function(i,n){if(i||!n)return t(i);if("object"!=typeof n)return t(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."));f(n,!0);try{e._geoJSONIndex=r.cluster?new q(function(e){var t=e.superclusterOptions,r=e.clusterProperties;if(!r||!t)return t;for(var y={},x={},_={accumulated:null,zoom:0},a={properties:null},s=Object.keys(r),o=0,i=s;o<i.length;o+=1){var n=i[o],c=r[n],p=c[0],u=c[1],d=C.createExpression(u),g=C.createExpression("string"==typeof p?[p,["accumulated"],["get",n]]:p);y[n]=d.value,x[n]=g.value}return t.map=function(i){a.properties=i;for(var e={},t=0,l=s,o;t<l.length;t+=1)o=l[t],e[o]=y[o].evaluate(_,a);return e},t.reduce=function(n,e){a.properties=e;for(var t=0,l=s,o;t<l.length;t+=1)o=l[t],_.accumulated=n[o],n[o]=x[o].evaluate(_,a)},t}(r)).load(n.features):function(a,e){return new Te(a,e)}(n,r.geojsonVtOptions)}catch(e){return t(e)}e.loaded={};var a={};if(o){var l=o.finish();l&&(a.resourceTiming={},a.resourceTiming[r.source]=JSON.parse(JSON.stringify(l)))}t(null,a)})}},e.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},e.prototype.reloadTile=function(t,e){var r=this.loaded,o=t.uid;return r&&r[o]?a.prototype.reloadTile.call(this,t,e):this.loadTile(t,e)},e.prototype.loadGeoJSON=function(a,t){if(a.request)C.getJSON(a.request,t);else{if("string"!=typeof a.data)return t(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."));try{return t(null,JSON.parse(a.data))}catch(r){return t(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."))}}},e.prototype.removeSource=function(a,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},e.prototype.getClusterExpansionZoom=function(a,e){e(null,this._geoJSONIndex.getClusterExpansionZoom(a.clusterId))},e.prototype.getClusterChildren=function(a,e){e(null,this._geoJSONIndex.getChildren(a.clusterId))},e.prototype.getClusterLeaves=function(a,e){e(null,this._geoJSONIndex.getLeaves(a.clusterId,a.limit,a.offset))},e}(l),X=function(e){var a=this;this.self=e,this.actor=new C.Actor(e,this),this.layerIndexes={},this.workerSourceTypes={vector:l,geojson:U},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(r,e){if(a.workerSourceTypes[r])throw new Error("Worker source with name \""+r+"\" already registered.");a.workerSourceTypes[r]=e},this.self.registerRTLTextPlugin=function(e){if(C.plugin.isLoaded())throw new Error("RTL text plugin already registered.");C.plugin.applyArabicShaping=e.applyArabicShaping,C.plugin.processBidirectionalText=e.processBidirectionalText,C.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return X.prototype.setReferrer=function(a,e){this.referrer=e},X.prototype.setLayers=function(a,e,t){this.getLayerIndex(a).replace(e),t()},X.prototype.updateLayers=function(a,e,t){this.getLayerIndex(a).update(e.layers,e.removedIds),t()},X.prototype.loadTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).loadTile(e,t)},X.prototype.loadDEMTile=function(a,e,t){this.getDEMWorkerSource(a,e.source).loadTile(e,t)},X.prototype.reloadTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).reloadTile(e,t)},X.prototype.abortTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).abortTile(e,t)},X.prototype.removeTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).removeTile(e,t)},X.prototype.removeDEMTile=function(a,e){this.getDEMWorkerSource(a,e.source).removeTile(e)},X.prototype.removeSource=function(a,e,t){if(this.workerSources[a]&&this.workerSources[a][e.type]&&this.workerSources[a][e.type][e.source]){var r=this.workerSources[a][e.type][e.source];delete this.workerSources[a][e.type][e.source],void 0===r.removeSource?t():r.removeSource(e,t)}},X.prototype.loadWorkerSource=function(a,e,t){try{this.self.importScripts(e.url),t()}catch(a){t(a.toString())}},X.prototype.loadRTLTextPlugin=function(e,t,a){try{C.plugin.isLoaded()||(this.self.importScripts(t),a(C.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+t)))}catch(t){a(t.toString())}},X.prototype.getLayerIndex=function(a){var e=this.layerIndexes[a];return e||(e=this.layerIndexes[a]=new Ce),e},X.prototype.getWorkerSource=function(a,e,t){var n=this;if(this.workerSources[a]||(this.workerSources[a]={}),this.workerSources[a][e]||(this.workerSources[a][e]={}),!this.workerSources[a][e][t]){var r={send:function(e,t,r){n.actor.send(e,t,r,a)}};this.workerSources[a][e][t]=new this.workerSourceTypes[e](r,this.getLayerIndex(a))}return this.workerSources[a][e][t]},X.prototype.getDEMWorkerSource=function(a,e){return this.demWorkerSources[a]||(this.demWorkerSources[a]={}),this.demWorkerSources[a][e]||(this.demWorkerSources[a][e]=new s),this.demWorkerSources[a][e]},X.prototype.enforceCacheSizeLimit=function(e,t){C.enforceCacheSizeLimit(t)},"undefined"!=typeof WorkerGlobalScope&&void 0!==C.window&&C.window instanceof WorkerGlobalScope&&(C.window.worker=new X(C.window)),X}),e(["./shared.js"],function(ta){function t(a){if(!i)return a[0];for(var t=0;t<a.length;t++)if(a[t]in i)return a[t];return a[0]}function aa(a){var t=a.userImage;return!!(t&&t.render&&t.render())&&(a.data.replace(new Uint8Array(t.data.buffer)),!0)}function r(l,t,e,i,o,r){this.fontSize=l||24,this.buffer=void 0===t?3:t,this.cutoff=i||.25,this.fontFamily=o||"sans-serif",this.fontWeight=r||"normal",this.radius=e||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=V(a/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function h(d,t,e,i,o,r,a){for(var n=0;n<t;n++){for(var c=0;c<e;c++)i[c]=d[c*t+n];for(f(i,o,r,a,e),c=0;c<e;c++)d[c*t+n]=o[c]}for(c=0;c<e;c++){for(n=0;n<t;n++)i[n]=d[c*t+n];for(f(i,o,r,a,t),n=0;n<t;n++)d[c*t+n]=N(o[n])}}function f(l,t,e,i,o){e[0]=0,i[0]=-100000000000000000000,i[1]=100000000000000000000;for(var r=1,d=0;r<o;r++){for(var c=(l[r]+r*r-(l[e[d]]+e[d]*e[d]))/(2*r-2*e[d]);c<=i[d];)d--,c=(l[r]+r*r-(l[e[d]]+e[d]*e[d]))/(2*r-2*e[d]);e[++d]=r,i[d]=c,i[d+1]=100000000000000000000}for(r=0,d=0;r<o;r++){for(;i[d+1]<r;)d++;t[r]=(r-e[d])*(r-e[d])+l[e[d]]}}function g(t,e,i){var a=function(o,r){if(o)return i(o);if(r){var a=ta.pick(r,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);r.vector_layers&&(a.vectorLayers=r.vector_layers,a.vectorLayerIds=a.vectorLayers.map(function(e){return e.id})),t.url&&(a.tiles=e.canonicalizeTileset(a,t.url)),i(null,a)}};return t.url?ta.getJSON(e.transformRequest(e.normalizeSourceURL(t.url),ta.ResourceType.Source),a):ta.browser.frame(function(){return a(null,t)})}function T(t,e){var a=ta.identity([]);return ta.translate(a,a,[1,1,0]),ta.scale(a,a,[.5*t.width,.5*t.height,1]),ta.multiply(a,a,t.calculatePosMatrix(e.toUnwrapped()))}function k(g,t,e,i,o){var r=function(l,t,e){if(l){for(var i=0,d=l,r;i<d.length;i+=1)if(r=t[d[i]],r&&r.source===e&&"fill-extrusion"===r.type)return!0;}else for(var c in t){var n=t[c];if(n.source===e&&"fill-extrusion"===n.type)return!0}return!1}(i&&i.layers,t,g.id),a=o.maxPitchScaleFactor(),n=g.tilesIn(e,a,r);n.sort(B);for(var s=[],l=0,m=n,u;l<m.length;l+=1)u=m[l],s.push({wrappedTileID:u.tileID.wrapped().key,queryResults:u.tile.queryRenderedFeatures(t,g._state,u.queryGeometry,u.cameraQueryGeometry,u.scale,i,o,a,T(g.transform,u.tileID))});var y=function(g){for(var t={},e={},i=0,m=g;i<m.length;i+=1){var r=m[i],a=r.queryResults,n=r.wrappedTileID,s=e[n]=e[n]||{};for(var l in a)for(var c=a[l],u=s[l]=s[l]||{},h=t[l]=t[l]||[],p=0,y=c,x;p<y.length;p+=1)x=y[p],u[x.featureIndex]||(u[x.featureIndex]=!0,h.push(x))}return t}(s);for(var p in y)y[p].forEach(function(t){var e=t.feature,a=g.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=a});return y}function B(a,t){var e=a.tileID,r=t.tileID;return e.overscaledZ-r.overscaledZ||e.canonical.y-r.canonical.y||e.wrap-r.wrap||e.canonical.x-r.canonical.x}function O(a,t){return a%32-t%32||t-a}function Lt(e){return"raster"===e||"image"===e||"video"===e}function Dt(){return new ta.window.Worker(bo.workerUrl)}function Mt(t,e){var a={};for(var o in t)"ref"!=o&&(a[o]=t[o]);return ta.refProperties.forEach(function(r){r in e&&(a[r]=e[r])}),a}function Bt(a){a=a.slice();for(var r=Object.create(null),e=0;e<a.length;e++)r[a[e].id]=a[e];for(var n=0;n<a.length;n++)"ref"in a[n]&&(a[n]=Mt(a[n],r[a[n].ref]));return a}function Ot(a,t,e){e.push({command:Wa.addSource,args:[a,t[a]]})}function Ut(a,t,e){t.push({command:Wa.removeSource,args:[a]}),e[a]=!0}function Nt(a,t,e,r){Ut(a,e,r),Ot(a,t,e)}function Zt(t,e,a){for(var o in t[a])if(t[a].hasOwnProperty(o)&&"data"!==o&&!ta.deepEqual(t[a][o],e[a][o]))return!1;for(o in e[a])if(e[a].hasOwnProperty(o)&&"data"!==o&&!ta.deepEqual(t[a][o],e[a][o]))return!1;return!0}function jt(t,l,d,o,r,a){for(var n in l=l||{},t=t||{})t.hasOwnProperty(n)&&(ta.deepEqual(t[n],l[n])||d.push({command:a,args:[o,n,l[n],r]}));for(n in l)l.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(ta.deepEqual(t[n],l[n])||d.push({command:a,args:[o,n,l[n],r]}))}function qt(e){return e.id}function Vt(a,t){return a[t.id]=t,a}function Gt(t,e){if(!t)return[{command:Wa.setStyle,args:[e]}];var i=[];try{if(!ta.deepEqual(t.version,e.version))return[{command:Wa.setStyle,args:[e]}];ta.deepEqual(t.center,e.center)||i.push({command:Wa.setCenter,args:[e.center]}),ta.deepEqual(t.zoom,e.zoom)||i.push({command:Wa.setZoom,args:[e.zoom]}),ta.deepEqual(t.bearing,e.bearing)||i.push({command:Wa.setBearing,args:[e.bearing]}),ta.deepEqual(t.pitch,e.pitch)||i.push({command:Wa.setPitch,args:[e.pitch]}),ta.deepEqual(t.sprite,e.sprite)||i.push({command:Wa.setSprite,args:[e.sprite]}),ta.deepEqual(t.glyphs,e.glyphs)||i.push({command:Wa.setGlyphs,args:[e.glyphs]}),ta.deepEqual(t.transition,e.transition)||i.push({command:Wa.setTransition,args:[e.transition]}),ta.deepEqual(t.light,e.light)||i.push({command:Wa.setLight,args:[e.light]});var l={},r=[];!function(t,n,l,o){for(var r in n=n||{},t=t||{})t.hasOwnProperty(r)&&(n.hasOwnProperty(r)||Ut(r,l,o));for(r in n)n.hasOwnProperty(r)&&(t.hasOwnProperty(r)?ta.deepEqual(t[r],n[r])||("geojson"===t[r].type&&"geojson"===n[r].type&&Zt(t,n,r)?l.push({command:Wa.setGeoJSONSourceData,args:[r,n[r].data]}):Nt(r,n,l,o)):Ot(r,n,l))}(t.sources,e.sources,r,l);var a=[];t.layers&&t.layers.forEach(function(e){l[e.source]?i.push({command:Wa.removeLayer,args:[e.id]}):a.push(e)}),i=i.concat(r),function(t,g,y){g=g||[];var o=(t=t||[]).map(qt),h=g.map(qt),p=t.reduce(Vt,{}),d=g.reduce(Vt,{}),x=o.slice(),f=Object.create(null),m,_,b,v,k,w,T;for(m=0,_=0;m<o.length;m++)b=o[m],d.hasOwnProperty(b)?_++:(y.push({command:Wa.removeLayer,args:[b]}),x.splice(x.indexOf(b,_),1));for(m=0,_=0;m<h.length;m++)b=h[h.length-1-m],x[x.length-1-m]!==b&&(p.hasOwnProperty(b)?(y.push({command:Wa.removeLayer,args:[b]}),x.splice(x.lastIndexOf(b,x.length-_),1)):_++,w=x[x.length-m],y.push({command:Wa.addLayer,args:[d[b],w]}),x.splice(x.length-m,0,b),f[b]=!0);for(m=0;m<h.length;m++)if(v=p[b=h[m]],k=d[b],!f[b]&&!ta.deepEqual(v,k))if(ta.deepEqual(v.source,k.source)&&ta.deepEqual(v["source-layer"],k["source-layer"])&&ta.deepEqual(v.type,k.type)){for(T in jt(v.layout,k.layout,y,b,null,Wa.setLayoutProperty),jt(v.paint,k.paint,y,b,null,Wa.setPaintProperty),ta.deepEqual(v.filter,k.filter)||y.push({command:Wa.setFilter,args:[b,k.filter]}),ta.deepEqual(v.minzoom,k.minzoom)&&ta.deepEqual(v.maxzoom,k.maxzoom)||y.push({command:Wa.setLayerZoomRange,args:[b,k.minzoom,k.maxzoom]}),v)v.hasOwnProperty(T)&&"layout"!==T&&"paint"!==T&&"filter"!==T&&"metadata"!==T&&"minzoom"!==T&&"maxzoom"!==T&&(0===T.indexOf("paint.")?jt(v[T],k[T],y,b,T.slice(6),Wa.setPaintProperty):ta.deepEqual(v[T],k[T])||y.push({command:Wa.setLayerProperty,args:[b,T,k[T]]}));for(T in k)k.hasOwnProperty(T)&&!v.hasOwnProperty(T)&&"layout"!==T&&"paint"!==T&&"filter"!==T&&"metadata"!==T&&"minzoom"!==T&&"maxzoom"!==T&&(0===T.indexOf("paint.")?jt(v[T],k[T],y,b,T.slice(6),Wa.setPaintProperty):ta.deepEqual(v[T],k[T])||y.push({command:Wa.setLayerProperty,args:[b,T,k[T]]}))}else y.push({command:Wa.removeLayer,args:[b]}),w=x[x.lastIndexOf(b)+1],y.push({command:Wa.addLayer,args:[k,w]})}(a,e.layers,i)}catch(a){console.warn("Unable to compute style diff:",a),i=[{command:Wa.setStyle,args:[e]}]}return i}function Wt(t,e,i,o,r){var a=ta.create();return e?(ta.scale(a,a,[1/r,1/r,1]),i||ta.rotateZ(a,a,o.angle)):ta.multiply(a,o.labelPlaneMatrix,t),a}function Ht(t,e,i,o,r){if(e){var a=ta.clone(t);return ta.scale(a,a,[r,r,1]),i||ta.rotateZ(a,a,-o.angle),a}return o.glCoordMatrix}function Kt(t,e){var a=[t.x,t.y,0,1];ae(a,a,e);var o=a[3];return{point:new ta.Point(a[0]/o,a[1]/o),signedDistanceFromCamera:o}}function Yt(a,t){var e=a[0]/a[3],r=a[1]/a[3];return e>=-t[0]&&e<=t[0]&&r>=-t[1]&&r<=t[1]}function Jt(t,e,i,o,r,a,n,s){var l=o?t.textSizeData:t.iconSizeData,c=ta.evaluateSizeForZoom(l,i.transform.zoom),u=[2*(256/i.width)+1,2*(256/i.height)+1],h=o?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();for(var p=t.lineVertexArray,d=o?t.text.placedSymbolArray:t.icon.placedSymbolArray,_=i.transform.width/i.transform.height,f=!1,k=0,A;k<d.length;k++)if(A=d.get(k),A.hidden||A.writingMode===ta.WritingMode.vertical&&!f)oe(A.numGlyphs,h);else{f=!1;var S=[A.anchorX,A.anchorY,0,1];if(ta.transformMat4(S,S,e),Yt(S,u)){var y=.5+.5*(S[3]/i.transform.cameraToCenterDistance),x=ta.evaluateSizeForFeature(l,c,A),b=n?x*y:x/y,w=new ta.Point(A.anchorX,A.anchorY),L=Kt(w,r).point,T={},E=te(A,b,!1,s,e,r,a,t.glyphOffsetArray,p,h,L,w,T,_);f=E.useVertical,(E.notEnoughRoom||f||E.needsFlipping&&te(A,b,!0,s,e,r,a,t.glyphOffsetArray,p,h,L,w,T,_).notEnoughRoom)&&oe(A.numGlyphs,h)}else oe(A.numGlyphs,h)}o?t.text.dynamicLayoutVertexBuffer.updateData(h):t.icon.dynamicLayoutVertexBuffer.updateData(h)}function Qt(y,t,e,i,o,r,a,n,s,l,c,u){var h=n.glyphStartIndex+n.numGlyphs,p=n.lineStartIndex,d=n.lineStartIndex+n.lineLength,x=t.getoffsetX(n.glyphStartIndex),f=t.getoffsetX(h-1),m=ie(y*x,e,i,o,r,a,n.segment,p,d,s,l,c,u);if(!m)return null;var g=ie(y*f,e,i,o,r,a,n.segment,p,d,s,l,c,u);return g?{first:m,last:g}:null}function $t(t,e,a,o){return t===ta.WritingMode.horizontal&&_a(a.y-e.y)>_a(a.x-e.x)*o?{useVertical:!0}:(t===ta.WritingMode.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function te(t,e,i,o,r,a,n,s,l,c,u,h,p,d){var _=e/24,m=t.lineOffsetX*_,g=t.lineOffsetY*_,v;if(1<t.numGlyphs){var O=t.glyphStartIndex+t.numGlyphs,y=t.lineStartIndex,x=t.lineStartIndex+t.lineLength,b=Qt(_,s,m,g,i,u,h,t,l,a,p,!1);if(!b)return{notEnoughRoom:!0};var w=Kt(b.first.point,n).point,E=Kt(b.last.point,n).point;if(o&&!i){var T=$t(t.writingMode,w,E,d);if(T)return T}v=[b.first];for(var I=t.glyphStartIndex+1;I<O-1;I++)v.push(ie(_*s.getoffsetX(I),m,g,i,u,h,t.segment,y,x,l,a,p,!1));v.push(b.last)}else{if(o&&!i){var j=Kt(h,r).point,S=t.lineStartIndex+t.segment+1,P=new ta.Point(l.getx(S),l.gety(S)),z=Kt(P,r),L=0<z.signedDistanceFromCamera?z.point:ee(h,P,j,1,r),D=$t(t.writingMode,j,L,d);if(D)return D}var M=ie(_*s.getoffsetX(t.glyphStartIndex),m,g,i,u,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,l,a,p,!1);if(!M)return{notEnoughRoom:!0};v=[M]}for(var R=0,F=v,k;R<F.length;R+=1)k=F[R],ta.addDynamicAttributes(c,k.point,k.angle);return{}}function ee(l,t,e,i,o){var r=Kt(l.add(l.sub(t)._unit()),o).point,a=e.sub(r);return e.add(a._mult(i/a.mag()))}function ie(t,e,i,o,r,a,n,s,l,c,u,h,p){var d=o?t-e:t+e,_=0<d?1:-1,k=0;o&&(_*=-1,k=Pe),0>_&&(k+=Pe);for(var A=0<_?s+n:s+n+1,D=A,v=r,O=r,R=0,M=0,j=_a(d);R+M<=j;){if((A+=_)<s||A>=l)return null;if(O=v,void 0===(v=h[A])){var E=new ta.Point(c.getx(A),c.gety(A)),T=Kt(E,u);if(0<T.signedDistanceFromCamera)v=h[A]=T.point;else{var I=A-_;v=ee(0==R?a:new ta.Point(c.getx(I),c.gety(I)),E,O,j-R+1,u)}}R+=M,M=O.dist(v)}var C=(j-R)/M,S=v.sub(O),P=S.mult(C)._add(O);return P._add(S._unit()._perp()._mult(i*_)),{point:P,angle:k+L(v.y-O.y,v.x-O.x),tileDistance:p?{prevTileDistance:A-_===D?0:c.gettileUnitDistanceFromAnchor(A-_),lastSegmentViewportDistance:j-R}:null}}function oe(a,t){for(var e=0,r;e<a;e++)r=t.length,t.resize(r+4),t.float32.set(Xt,3*r)}function ae(a,t,e){var i=t[0],o=t[1];return a[0]=e[0]*i+e[4]*o+e[12],a[1]=e[1]*i+e[5]*o+e[13],a[3]=e[3]*i+e[7]*o+e[15],a}function ne(a,t,e){a[t+4]=e?1:0}function le(t,e,a){return e*(ta.EXTENT/(t.tileSize*ya(2,a-t.tileID.overscaledZ)))}function ce(t,e,i,o,r){var a=ta.getAnchorAlignment(t),n=-(a.horizontalAlign-.5)*e,s=-(a.verticalAlign-.5)*i,l=ta.evaluateRadialOffset(t,o);return new ta.Point(n+l[0]*r,s+l[1]*r)}function fe(a,t,e,i,o){a.emplaceBack(t?1:0,e?1:0,i||0,o||0),a.emplaceBack(t?1:0,e?1:0,i||0,o||0),a.emplaceBack(t?1:0,e?1:0,i||0,o||0),a.emplaceBack(t?1:0,e?1:0,i||0,o||0)}function ge(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var t=a.placed?1:0,e=ba(127*a.opacity);return 33554432*e+16777216*t+131072*e+65536*t+512*e+256*t+2*e+t}function Ie(a,r){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l={};return{fragmentSource:a=a.replace(n,function(o,t,e,i,r){return l[r]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+r+"\nvarying "+e+" "+i+" "+r+";\n#else\nuniform "+e+" "+i+" u_"+r+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+r+"\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n"}),vertexSource:r=r.replace(n,function(o,t,e,i,r){var a="float"===i?"vec2":"vec4",n=r.match(/color/)?"color":a;return l[r]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+e+" "+a+" a_"+r+";\nvarying "+e+" "+i+" "+r+";\n#else\nuniform "+e+" "+i+" u_"+r+";\n#endif\n":"vec4"==n?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = a_"+r+";\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = unpack_mix_"+n+"(a_"+r+", u_"+r+"_t);\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+e+" "+a+" a_"+r+";\n#else\nuniform "+e+" "+i+" u_"+r+";\n#endif\n":"vec4"==n?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+e+" "+i+" "+r+" = a_"+r+";\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+e+" "+i+" "+r+" = unpack_mix_"+n+"(a_"+r+", u_"+r+"_t);\n#else\n    "+e+" "+i+" "+r+" = u_"+r+";\n#endif\n"})}}function ra(t,e,i){var o=1/le(i,1,e.transform.tileZoom),r=ya(2,i.tileID.overscaledZ),a=i.tileSize*ya(2,e.transform.tileZoom)/r,n=a*(i.tileID.canonical.x+i.tileID.wrap*r),s=a*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[ta.browser.devicePixelRatio,o,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[n>>16,s>>16],u_pixel_coord_lower:[65535&n,65535&s]}}function oa(t,e){var a=ya(2,e.canonical.z),o=e.canonical.y;return[new ta.MercatorCoordinate(0,o/a).toLngLat().lat,new ta.MercatorCoordinate(0,(o+1)/a).toLngLat().lat]}function ia(a,t){return 1/le(a,1,t.tileZoom)}function na(a,t,e){return a.translatePosMatrix(t.tileID.posMatrix,t,e.paint.get("line-translate"),e.paint.get("line-translate-anchor"))}function la(a){a*=Pe/180;var r=De(a),e=R(a);return[(2*e+1)/3,(-N(3)*r-e+1)/3,(N(3)*r-e+1)/3]}function sa(t,e){for(var i=t.sort(function(a,t){return a.tileID.isLessThan(t.tileID)?-1:t.tileID.isLessThan(a.tileID)?1:0}),o=0;o<i.length;o++){var l={},a=i[o],n=i.slice(o+1);da(a.tileID.wrapped(),a.tileID,n,new ta.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),l),a.setMask(l,e)}}function da(t,e,i,o,r){for(var a=0,d;a<i.length&&(d=i[a],!o.isLessThan(d.tileID));a++){if(e.key===d.tileID.key)return;if(d.tileID.isChildOf(e)){for(var p=e.children(1/0),l=0;l<p.length;l++)da(t,p[l],i.slice(a),o,r);return}}var g=e.overscaledZ-t.overscaledZ,u=new ta.CanonicalTileID(g,e.canonical.x-(t.canonical.x<<g),e.canonical.y-(t.canonical.y<<g));r[u.key]=r[u.key]||u}function ca(d,t,e,i,o){for(var r=d.context,a=r.gl,n=o?d.useProgram("collisionCircle"):d.useProgram("collisionBox"),s=0;s<i.length;s++){var g=i[s],c=t.getTile(g),u=c.getBucket(e);if(u){var h=o?u.collisionCircle:u.collisionBox;h&&n.draw(r,o?a.TRIANGLES:a.LINES,Et.disabled,Tt.disabled,d.colorModeForRenderPass(),Ct.disabled,mr(g.posMatrix,d.transform,c),e.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,null,d.transform.zoom,null,null,h.collisionVertexBuffer)}}}function pa(t,e,i,o,r,a){var n=ta.getAnchorAlignment(t),s=-(n.horizontalAlign-.5)*e,l=-(n.verticalAlign-.5)*i,d=ta.evaluateRadialOffset(t,o);return new ta.Point((s/r+d[0])*a,(l/r+d[1])*a)}function ua(t,e,i,o,r,a,n,s,l,c){var u=t.text.placedSymbolArray,h=t.text.dynamicLayoutVertexArray;h.clear();for(var p=0;p<u.length;p++){var k=u.get(p),_=!k.hidden&&k.crossTileID?o[k.crossTileID]:null;if(_){var f=new ta.Point(k.anchorX,k.anchorY),m=Kt(f,i?s:n),g=.5+.5*(a.cameraToCenterDistance/m.signedDistanceFromCamera),v=r.evaluateSizeForFeature(t.textSizeData,c,k)*g/ta.ONE_EM;i&&(v*=t.tilePixelRatio/l);for(var A=_.width,x=_.height,b=_.radialOffset,w=_.textBoxScale,S=pa(_.anchor,A,x,b,w,v),T=i?Kt(f.add(S),n).point:m.point.add(e?S.rotate(-a.angle):S),L=0;L<k.numGlyphs;L++)ta.addDynamicAttributes(h,T,0)}else oe(k.numGlyphs,h)}t.text.dynamicLayoutVertexBuffer.updateData(h)}function ga(t,e,i,o,r,a,n,s,l,c,u,h,p){for(var d=t.context,m=d.gl,g=t.transform,v="map"===s,y="map"===l,x=v&&"point"!==i.layout.get("symbol-placement"),b=v&&!y&&!x,w=void 0!==i.layout.get("symbol-sort-key").constantOr(1),E=t.depthModeForSublayer(0,Et.ReadOnly),T=i.layout.get("text-variable-anchor"),I=[],C=0,ee=o,P,te;C<ee.length;C+=1){var ae=ee[C],z=e.getTile(ae),L=z.getBucket(i);if(L){var D=r?L.text:L.icon;if(D&&D.segments.get().length){var M=D.programConfigurations.get(i.id),R=r||L.sdfIcons,A=r?L.textSizeData:L.iconSizeData;P||(P=t.useProgram(R?"symbolSDF":"symbolIcon",M),te=ta.evaluateSizeForZoom(A,g.zoom)),d.activeTexture.set(m.TEXTURE0);var k=void 0,re=void 0,oe=void 0;if(r)re=z.glyphAtlasTexture,oe=m.LINEAR,k=z.glyphAtlasTexture.size;else{var ie=1!==i.layout.get("icon-size").constantOr(0)||L.iconsNeedLinear,U=y||0!==g.pitch;re=z.imageAtlasTexture,oe=R||t.options.rotating||t.options.zooming||ie||U?m.LINEAR:m.NEAREST,k=z.imageAtlasTexture.size}var N=le(z,1,t.transform.zoom),Z=Wt(ae.posMatrix,y,v,t.transform,N),j=Ht(ae.posMatrix,y,v,t.transform,N);if(x)Jt(L,ae.posMatrix,t,r,Z,j,y,c);else if(r&&te&&T){var q=ya(2,g.zoom-z.tileID.overscaledZ);ua(L,v,y,p,ta.symbolSize,g,Z,ae.posMatrix,q,te)}var V=t.translatePosMatrix(ae.posMatrix,z,a,n),G=x||r&&T?Pr:Z,W=t.translatePosMatrix(j,z,a,n,!0),X=R&&0!==i.paint.get(r?"text-halo-width":"icon-halo-width").constantOr(1),H={program:P,buffers:D,uniformValues:R?Lr(A.kind,te,b,y,t,V,G,W,r,k,!0):Cr(A.kind,te,b,y,t,V,G,W,r,k),atlasTexture:re,atlasInterpolation:oe,isSDF:R,hasHalo:X};if(w)for(var K=0,ne=D.segments.get(),J;K<ne.length;K+=1)J=ne[K],I.push({segments:new ta.SegmentVector([J]),sortKey:J.sortKey,state:H});else I.push({segments:D.segments,sortKey:0,state:H})}}}w&&I.sort(function(a,t){return a.sortKey-t.sortKey});for(var se=0,de=I;se<de.length;se+=1){var ce=de[se],pe=ce.state;if(pe.atlasTexture.bind(pe.atlasInterpolation,m.CLAMP_TO_EDGE),pe.isSDF){var ue=pe.uniformValues;pe.hasHalo&&(ue.u_is_halo=1,ha(pe.buffers,ce.segments,i,t,pe.program,E,u,h,ue)),ue.u_is_halo=0}ha(pe.buffers,ce.segments,i,t,pe.program,E,u,h,pe.uniformValues)}}function ha(d,t,e,i,o,r,a,n,s){var l=i.context,c=l.gl;o.draw(l,c.TRIANGLES,r,a,n,Ct.disabled,s,e.id,d.layoutVertexBuffer,d.indexBuffer,t,e.paint,i.transform.zoom,d.programConfigurations.get(e.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function ma(k,t,e,i,o,r,a){var n=k.context.gl,p=e.paint.get("fill-pattern"),d=p&&p.constantOr(1),_=e.getCrossfadeParameters(),f,A,L,z,P;a?(A=d&&!e.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",f=n.LINES):(A=d?"fillPattern":"fill",f=n.TRIANGLES);for(var D=0,O=i;D<O.length;D+=1){var g=O[D],v=t.getTile(g);if(!d||v.patternsLoaded()){var y=v.getBucket(e);if(y){var x=y.programConfigurations.get(e.id),b=k.useProgram(A,x);d&&(k.context.activeTexture.set(n.TEXTURE0),v.imageAtlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE),x.updatePatternPaintBuffers(_));var w=p.constantOr(null);if(w&&v.imageAtlas){var E=v.imageAtlas.patternPositions[w.to],T=v.imageAtlas.patternPositions[w.from];E&&T&&x.setConstantPatternPositions(E,T)}var I=k.translatePosMatrix(g.posMatrix,v,e.paint.get("fill-translate"),e.paint.get("fill-translate-anchor"));if(a){z=y.indexBuffer2,P=y.segments2;var C=[n.drawingBufferWidth,n.drawingBufferHeight];L="fillOutlinePattern"===A&&d?ur(I,k,_,v,C):pr(I,C)}else z=y.indexBuffer,P=y.segments,L=d?cr(I,k,_,v):dr(I);b.draw(k.context,f,o,k.stencilModeForClipping(g),r,Ct.disabled,L,e.id,y.layoutVertexBuffer,z,P,e.paint,k.transform.zoom,x)}}}}function xa(k,t,e,i,o,r,a){for(var n=k.context,s=n.gl,l=e.paint.get("fill-extrusion-pattern"),c=l.constantOr(1),u=e.getCrossfadeParameters(),h=e.paint.get("fill-extrusion-opacity"),p=0,A=i;p<A.length;p+=1){var _=A[p],f=t.getTile(_),m=f.getBucket(e);if(m){var g=m.programConfigurations.get(e.id),v=k.useProgram(c?"fillExtrusionPattern":"fillExtrusion",g);c&&(k.context.activeTexture.set(s.TEXTURE0),f.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),g.updatePatternPaintBuffers(u));var y=l.constantOr(null);if(y&&f.imageAtlas){var x=f.imageAtlas.patternPositions[y.to],b=f.imageAtlas.patternPositions[y.from];x&&b&&g.setConstantPatternPositions(x,b)}var w=k.translatePosMatrix(_.posMatrix,f,e.paint.get("fill-extrusion-translate"),e.paint.get("fill-extrusion-translate-anchor")),S=e.paint.get("fill-extrusion-vertical-gradient"),T=c?sr(w,k,S,h,_,u,f):lr(w,k,S,h);v.draw(n,n.gl.TRIANGLES,o,r,a,Ct.backCCW,T,e.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,e.paint,k.transform.zoom,g)}}}function ka(d,t,e,i,o,r){var a=d.context,n=a.gl,s=t.fbo;if(s){var l=d.useProgram("hillshade");a.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,s.colorAttachment.get());var c=br(d,t,e);t.maskedBoundsBuffer&&t.maskedIndexBuffer&&t.segments?l.draw(a,n.TRIANGLES,i,o,r,Ct.disabled,c,e.id,t.maskedBoundsBuffer,t.maskedIndexBuffer,t.segments):l.draw(a,n.TRIANGLES,i,o,r,Ct.disabled,c,e.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}}function wa(t,e,i,o,r,a,n){var s=t.context,l=s.gl;if(e.dem&&e.dem.data){var c=e.dem.dim,u=e.dem.stride,g=e.dem.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(u),e.demTexture){var p=e.demTexture;p.update(g,{premultiply:!1}),p.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else e.demTexture=new ta.Texture(s,g,l.RGBA,{premultiply:!1}),e.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);var d=e.fbo;if(!d){var h=new ta.Texture(s,{width:c,height:c,data:null},l.RGBA);h.bind(l.LINEAR,l.CLAMP_TO_EDGE),(d=e.fbo=s.createFramebuffer(c,c)).colorAttachment.set(h.texture)}s.bindFramebuffer.set(d.framebuffer),s.viewport.set([0,0,c,c]),t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,a,n,Ct.disabled,vr(e,o),i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function Ta(t,e,i,o,r){var a=o.paint.get("raster-fade-duration");if(0<a){var n=ta.browser.now(),s=(n-t.timeAdded)/a,l=e?(n-e.timeAdded)/a:-1,c=i.getSource(),u=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),g=!e||_a(e.tileID.overscaledZ-u)>_a(t.tileID.overscaledZ-u),p=g&&t.refreshedUponExpiration?1:ta.clamp(g?s:1-l,0,1);return t.refreshedUponExpiration&&1<=s&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}function Aa(t,e,i){var o=t.context,r=o.gl,a=i.posMatrix,n=t.useProgram("debug"),s=Et.disabled,l=Tt.disabled,c=t.colorModeForRenderPass();n.draw(o,r.LINE_STRIP,s,l,c,Ct.disabled,yr(a,ta.Color.red),"$debug",t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);for(var u=e.getTileByID(i.key).latestRawTileData,p=u&&u.byteLength||0,d=ba(p/1024),h=function(d,t,g,i){i=i||1;var m=[],p,y,f,x,_,b,v,k;for(p=0,y=d.length;p<y;p++)if(_=Dr[d[p]]){for(k=null,f=0,x=_[1].length;f<x;f+=2)-1===_[1][f]&&-1===_[1][f+1]?k=null:(b=t+_[1][f]*i,v=g-_[1][f+1]*i,k&&m.push(k.x,k.y,b,v),k={x:b,y:v});t+=_[0]*i}return m}(i.toString()+" "+d+"kb",50,200,5),f=new ta.StructArrayLayout2i4,m=new ta.StructArrayLayout2ui4,g=0;g<h.length;g+=2)f.emplaceBack(h[g],h[g+1]),m.emplaceBack(g,g+1);for(var _=o.createVertexBuffer(f,Be.members),y=o.createIndexBuffer(m),x=ta.SegmentVector.simpleSegment(0,0,f.length/2,f.length/2),b=e.getTile(i).tileSize,k=ta.EXTENT/(ya(2,t.transform.zoom-i.overscaledZ)*b),w=[[-1,-1],[-1,1],[1,-1],[1,1]],T=0,A;T<w.length;T++)A=w[T],n.draw(o,r.LINES,s,l,c,Ct.disabled,yr(ta.translate([],a,[k*A[0],k*A[1],0]),ta.Color.white),"$debug",_,y,x);n.draw(o,r.LINES,s,l,c,Ct.disabled,yr(a,ta.Color.black),"$debug",_,y,x)}function Sa(a,r){if(a.y>r.y){var o=a;a=r,r=o}return{x0:a.x,y0:a.y,x1:r.x,y1:r.y,dx:r.x-a.x,dy:r.y-a.y}}function Ca(g,m,y,i,o){var r=va(y,ba(m.y0)),a=ea(i,M(m.y1));if(g.x0===m.x0&&g.y0===m.y0?g.x0+m.dy/g.dy*g.dx<m.x1:g.x1-m.dy/g.dy*g.dx<m.x0){var n=g;g=m,m=n}for(var s=g.dx/g.dy,l=m.dx/m.dy,c=0<g.dx,u=0>m.dx,h=r;h<a;h++){var f=s*va(0,ea(g.dy,h+c-g.y0))+g.x0,d=l*va(0,ea(m.dy,h+u-m.y0))+m.x0;o(ba(d),M(f),h)}}function La(d,t,e,i,o,r){var a=Sa(d,t),p=Sa(t,e),u=Sa(e,d),g;a.dy>p.dy&&(g=a,a=p,p=g),a.dy>u.dy&&(g=a,a=u,u=g),p.dy>u.dy&&(g=p,p=u,u=g),a.dy&&Ca(u,a,i,o,r),p.dy&&Ca(u,p,i,o,r)}function Ea(e){return e*(2-e)}function Ia(e){e.parentNode&&e.parentNode.removeChild(e)}function za(t,l,i){if(t=new ta.LngLat(t.lng,t.lat),l){var o=new ta.LngLat(t.lng-360,t.lat),r=new ta.LngLat(t.lng+360,t.lat),a=i.locationPoint(t).distSqr(l);i.locationPoint(o).distSqr(l)<a?t=o:i.locationPoint(r).distSqr(l)<a&&(t=r)}for(;180<_a(t.lng-i.center.lng);){var n=i.locationPoint(t);if(0<=n.x&&0<=n.y&&n.x<=i.width&&n.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}function Pa(a,t,e){var i=a.classList;for(var o in co)i.remove("mapboxgl-"+e+"-anchor-"+o);i.add("mapboxgl-"+e+"-anchor-"+t)}function Da(g,t,e){var i=e&&e.maxWidth||100,c=g._container.clientHeight/2,u=(h=g.unproject([0,c]),m=g.unproject([i,c]),y=Pe/180,f=h.lat*y,x=m.lat*y,_=De(f)*De(x)+R(f)*R(x)*R((m.lng-h.lng)*y),6371e3*d(ea(_,1))),h,m,y,f,x,_;if(e&&"imperial"===e.unit){var b=3.2808*u;5280<b?Oa(t,i,b/5280,"mi"):Oa(t,i,b,"ft")}else e&&"nautical"===e.unit?Oa(t,i,u/1852,"nm"):Oa(t,i,u,"m")}function Oa(d,t,e,i){var c=(l=e,u=ya(10,(""+ba(l)).length-1),g=10<=(g=l/u)?10:5<=g?5:3<=g?3:2<=g?2:1<=g?1:function(a){var t=ya(10,M(-P(a)/I));return V(a*t)/t}(g),u*g),p=c/e,l,u,g;"m"===i&&1e3<=c&&(c/=1e3,i="km"),d.style.width=t*p+"px",d.innerHTML=c+i}var Ra=ta.createCommonjsModule(function(a){function r(a){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(a),o,i;try{i=new Worker(r),o=!0}catch(t){o=!1}return i&&i.terminate(),URL.revokeObjectURL(r),o}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(a){return void 0===e[a]&&(e[a]=function(e){var t=document.createElement("canvas"),a=Object.create(r.webGLContextAttributes);return a.failIfMajorPerformanceCaveat=e,t.probablySupportsContext?t.probablySupportsContext("webgl",a)||t.probablySupportsContext("experimental-webgl",a):t.supportsContext?t.supportsContext("webgl",a)||t.supportsContext("experimental-webgl",a):t.getContext("webgl",a)||t.getContext("experimental-webgl",a)}(a)),e[a]}(a&&a.failIfMajorPerformanceCaveat))}a.exports?a.exports=r:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=r);var e={};r.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),Ma={create:function(t,e,a){var o=ta.window.document.createElement(t);return void 0!==e&&(o.className=e),a&&a.appendChild(o),o},createNS:function(t,e){return ta.window.document.createElementNS(t,e)}},i=ta.window.document.documentElement.style,e=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o;Ma.disableDrag=function(){i&&e&&(o=i[e],i[e]="none")},Ma.enableDrag=function(){i&&e&&(i[e]=o)};var n=t(["transform","WebkitTransform"]);Ma.setTransform=function(a,t){a.style[n]=t};var s=!1;try{var ja=Object.defineProperty({},"passive",{get:function(){s=!0}});ta.window.addEventListener("test",ja,ja),ta.window.removeEventListener("test",ja,ja)}catch(e){s=!1}Ma.addEventListener=function(a,t,e,r){void 0===r&&(r={}),"passive"in r&&s?a.addEventListener(t,e,r):a.addEventListener(t,e,r.capture)},Ma.removeEventListener=function(a,t,e,r){void 0===r&&(r={}),"passive"in r&&s?a.removeEventListener(t,e,r):a.removeEventListener(t,e,r.capture)};var c=function(t){t.preventDefault(),t.stopPropagation(),ta.window.removeEventListener("click",c,!0)};Ma.suppressClick=function(){ta.window.addEventListener("click",c,!0),ta.window.setTimeout(function(){ta.window.removeEventListener("click",c,!0)},0)},Ma.mousePos=function(t,e){var a=t.getBoundingClientRect(),o=ta.window.TouchEvent&&e instanceof ta.window.TouchEvent?e.touches[0]:e;return new ta.Point(o.clientX-a.left-t.clientLeft,o.clientY-a.top-t.clientTop)},Ma.touchPos=function(t,e){for(var i=t.getBoundingClientRect(),o=[],r="touchend"===e.type?e.changedTouches:e.touches,a=0;a<r.length;a++)o.push(new ta.Point(r[a].clientX-i.left-t.clientLeft,r[a].clientY-i.top-t.clientTop));return o},Ma.mouseButton=function(t){return void 0!==ta.window.InstallTrigger&&2===t.button&&t.ctrlKey&&0<=ta.window.navigator.platform.toUpperCase().indexOf("MAC")?0:t.button},Ma.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var u=function(t){function e(){t.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new ta.RGBAImage({width:1,height:1}),this.dirty=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isLoaded=function(){return this.loaded},e.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var t=0,l=this.requestors;t<l.length;t+=1){var i=l[t],o=i.ids,r=i.callback;this._notify(o,r)}this.requestors=[]}},e.prototype.getImage=function(e){return this.images[e]},e.prototype.addImage=function(a,t){this.images[a]=t},e.prototype.updateImage=function(a,t){var e=this.images[a];t.version=e.version+1,this.images[a]=t,this.updatedImages[a]=!0},e.prototype.removeImage=function(a){var t=this.images[a];delete this.images[a],delete this.patterns[a],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()},e.prototype.listImages=function(){return Object.keys(this.images)},e.prototype.getImages=function(n,t){var e=!0;if(!this.isLoaded())for(var l=0,s=n,r;l<s.length;l+=1)r=s[l],this.images[r]||(e=!1);this.isLoaded()||e?this._notify(n,t):this.requestors.push({ids:n,callback:t})},e.prototype._notify=function(t,e){for(var i={},o=0,l=t,a;o<l.length;o+=1){a=l[o],this.images[a]||this.fire(new ta.Event("styleimagemissing",{id:a}));var d=this.images[a];d?i[a]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:ta.warnOnce("Image \""+a+"\" could not be loaded. Please make sure you have added the image with map.addImage() or a \"sprite\" property in your style. You can provide missing images by listening for the \"styleimagemissing\" map event.")}e(null,i)},e.prototype.getPixelSize=function(){var e=this.atlasImage;return{width:e.width,height:e.height}},e.prototype.getPattern=function(t){var e=this.patterns[t],i=this.getImage(t);if(!i)return null;if(e&&e.position.version===i.version)return e.position;if(e)e.position.version=i.version;else{var o={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new ta.ImagePosition(o,i);this.patterns[t]={bin:o,position:r}}return this._updatePatternAtlas(),this.patterns[t].position},e.prototype.bind=function(t){var e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ta.Texture(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)},e.prototype._updatePatternAtlas=function(){var t=[];for(var e in this.patterns)t.push(this.patterns[e].bin);var i=ta.potpack(t),o=i.w,r=i.h,a=this.atlasImage;for(var n in a.resize({width:o||1,height:r||1}),this.patterns){var s=this.patterns[n].bin,l=s.x+1,c=s.y+1,u=this.images[n].data,g=u.width,p=u.height;ta.RGBAImage.copy(u,a,{x:0,y:0},{x:l,y:c},{width:g,height:p}),ta.RGBAImage.copy(u,a,{x:0,y:p-1},{x:l,y:c-1},{width:g,height:1}),ta.RGBAImage.copy(u,a,{x:0,y:0},{x:l,y:c+p},{width:g,height:1}),ta.RGBAImage.copy(u,a,{x:g-1,y:0},{x:l-1,y:c},{width:1,height:p}),ta.RGBAImage.copy(u,a,{x:0,y:0},{x:l+g,y:c},{width:1,height:p})}this.dirty=!0},e.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},e.prototype.dispatchRenderCallbacks=function(a){for(var t=0,n=a,i;t<n.length;t+=1)if(i=n[t],!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var l=this.images[i];aa(l)&&this.updateImage(i,l)}},e}(ta.Evented),p=1e20;r.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),e=new Uint8ClampedArray(this.size*this.size),i=0,l;i<this.size*this.size;i++)l=t.data[4*i+3]/255,this.gridOuter[i]=1===l?0:0===l?p:ya(va(0,.5-l),2),this.gridInner[i]=1===l?p:0===l?0:ya(va(0,l-.5),2);for(h(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),h(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var s=this.gridOuter[i]-this.gridInner[i];e[i]=va(0,ea(255,V(255-255*(s/this.radius+this.cutoff))))}return e};var _=function(a,t){this.requestManager=a,this.localIdeographFontFamily=t,this.entries={}};_.prototype.setURL=function(e){this.url=e},_.prototype.getGlyphs=function(t,d){var c=this,e=[];for(var r in t)for(var a=0,o=t[r],i;a<o.length;a+=1)i=o[a],e.push({stack:r,id:i});ta.asyncAll(e,function(o,d){var e=o.stack,i=o.id,p=c.entries[e];p||(p=c.entries[e]={glyphs:{},requests:{}});var t=p.glyphs[i];if(void 0!==t)d(null,{stack:e,id:i,glyph:t});else if(t=c._tinySDF(p,e,i))d(null,{stack:e,id:i,glyph:t});else{var u=ba(i/256);if(65535<256*u)d(new Error("glyphs > 65535 not supported"));else{var s=p.requests[u];s||(s=p.requests[u]=[],_.loadGlyphRange(e,u,c.url,c.requestManager,function(a,t){if(t)for(var e in t)p.glyphs[+e]=t[+e];for(var i=0,n=s;i<n.length;i+=1)(0,n[i])(a,t);delete p.requests[u]})),s.push(function(a,t){a?d(a):t&&d(null,{stack:e,id:i,glyph:t[i]||null})})}}},function(i,t){if(i)d(i);else if(t){for(var e={},o=0,p=t;o<p.length;o+=1){var a=p[o],n=a.stack,s=a.id,l=a.glyph;(e[n]||(e[n]={}))[s]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics}}d(null,e)}})},_.prototype._tinySDF=function(t,e,i){var o=this.localIdeographFontFamily;if(o&&(ta.isChar["CJK Unified Ideographs"](i)||ta.isChar["Hangul Syllables"](i)||ta.isChar.Hiragana(i)||ta.isChar.Katakana(i))){var r=t.tinySDF;if(!r){var l="400";/bold/i.test(e)?l="900":/medium/i.test(e)?l="500":/light/i.test(e)&&(l="200"),r=t.tinySDF=new _.TinySDF(24,3,8,.25,o,l)}return{id:i,bitmap:new ta.AlphaImage({width:30,height:30},r.draw(D(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(t,e,i,o,d){var a=256*e,r=o.transformRequest(o.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",a+"-"+(a+255)),ta.ResourceType.Glyphs);ta.getArrayBuffer(r,function(t,e){if(t)d(t);else if(e){for(var a={},o=0,i=ta.parseGlyphPBF(e),n;o<i.length;o+=1)n=i[o],a[n.id]=n;d(null,a)}})},_.TinySDF=r;var v=function(){this.specification=ta.styleSpec.light.position};v.prototype.possiblyEvaluate=function(t,e){return ta.sphericalToCartesian(t.expression.evaluate(e))},v.prototype.interpolate=function(t,e,a){return{x:ta.number(t.x,e.x,a),y:ta.number(t.y,e.y,a),z:ta.number(t.z,e.z,a)}};var y=new ta.Properties({anchor:new ta.DataConstantProperty(ta.styleSpec.light.anchor),position:new v,color:new ta.DataConstantProperty(ta.styleSpec.light.color),intensity:new ta.DataConstantProperty(ta.styleSpec.light.intensity)}),x=function(t){function e(e){t.call(this),this._transitionable=new ta.Transitionable(y),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLight=function(){return this._transitionable.serialize()},e.prototype.setLight=function(t,e){if(void 0===e&&(e={}),!this._validate(ta.validateLight,t,e))for(var a in t){var o=t[a];ta.endsWith(a,"-transition")?this._transitionable.setTransition(a.slice(0,-11),o):this._transitionable.setValue(a,o)}},e.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},e.prototype.hasTransition=function(){return this._transitioning.hasTransition()},e.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},e.prototype._validate=function(t,e,a){return(!a||!1!==a.validate)&&ta.emitValidationErrors(this,t.call(ta.validateStyle,ta.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:ta.styleSpec})))},e}(ta.Evented),b=function(a,t){this.width=a,this.height=t,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};b.prototype.getDash=function(a,t){var e=a.join(",")+(t+"");return this.positions[e]||(this.positions[e]=this.addDash(a,t)),this.positions[e]},b.prototype.addDash=function(t,e){var i=e?7:0,o=2*i+1;if(this.nextRow+o>this.height)return ta.warnOnce("LineAtlas out of space"),null;for(var r=0,k=0;k<t.length;k++)r+=t[k];for(var A=this.width/r,s=A/2,l=1==t.length%2,c=-i;c<=i;c++)for(var S=this.nextRow+i+c,h=this.width*S,p=l?-t[t.length-1]:0,C=t[0],L=1,I=0;I<this.width;I++){for(;C<I/A;)p=C,C+=t[L],l&&L==t.length-1&&(C+=t[0]),L++;var z=_a(I-p*A),g=_a(I-C*A),v=ea(z,g),y=1==L%2,x=void 0;if(e){var P=i?c/i*(s+1):0;if(y){var w=s-_a(P);x=N(v*v+w*w)}else x=s-N(v*v+P*P)}else x=(y?1:-1)*v;this.data[3+4*(h+I)]=va(0,ea(255,x+128))}var E={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:r};return this.nextRow+=o,this.dirty=!0,E},b.prototype.bind=function(a){var t=a.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))};var w=function t(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=ta.uniqueId();for(var o=this.workerPool.acquire(this.id),r=0;r<o.length;r++){var l=o[r],n=new t.Actor(l,i,this.id);n.name="Worker "+r,this.actors.push(n)}};w.prototype.broadcast=function(a,e,t){t=t||function(){},ta.asyncAll(this.actors,function(r,t){r.send(a,e,t)},t)},w.prototype.send=function(a,t,e,r){return("number"!=typeof r||isNaN(r))&&(r=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[r].send(a,t,e),r},w.prototype.remove=function(){this.actors.forEach(function(e){e.remove()}),this.actors=[],this.workerPool.release(this.id)},w.Actor=ta.Actor;var Fa=function(t,e,a){this.bounds=ta.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=a||24};Fa.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[va(-180,e[0]),va(-90,e[1]),ea(180,e[2]),ea(90,e[3])]:[-180,-90,180,90]},Fa.prototype.contains=function(t){var e=ya(2,t.z),i=ba(ta.mercatorXfromLng(this.bounds.getWest())*e),o=ba(ta.mercatorYfromLat(this.bounds.getNorth())*e),r=M(ta.mercatorXfromLng(this.bounds.getEast())*e),a=M(ta.mercatorYfromLat(this.bounds.getSouth())*e);return t.x>=i&&t.x<r&&t.y>=o&&t.y<a};var Ba=function(t){function e(e,i,o,r){if(t.call(this),this.id=e,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,ta.extend(this,ta.pick(i,["url","scheme","tileSize"])),this._options=ta.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=g(this._options,this.map._requestManager,function(e,a){t._tileJSONRequest=null,e?t.fire(new ta.ErrorEvent(e)):a&&(ta.extend(t,a),a.bounds&&(t.tileBounds=new Fa(a.bounds,t.minzoom,t.maxzoom)),ta.postTurnstileEvent(a.tiles),ta.postMapLoadEvent(a.tiles,t.map._getMapId(),t.map._requestManager._skuToken),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"content"})))})},e.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},e.prototype.serialize=function(){return ta.extend({},this._options)},e.prototype.loadTile=function(t,e){function i(a,o){return t.aborted?e(null):a&&404!==a.status?e(a):(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),this.map._refreshExpiredTiles&&o&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),ta.cacheEntryPossiblyAdded(this.dispatcher),e(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}var a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.url,null),o={request:this.map._requestManager.transformRequest(a,ta.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:ta.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};o.request.collectResourceTiming=this._collectResourceTiming,void 0===t.workerID||"expired"===t.state?t.workerID=this.dispatcher.send("loadTile",o,i.bind(this)):"loading"===t.state?t.reloadCallback=e:this.dispatcher.send("reloadTile",o,i.bind(this),t.workerID)},e.prototype.abortTile=function(e){this.dispatcher.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},e.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),C=function(t){function e(e,i,o,r){t.call(this),this.id=e,this.dispatcher=o,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=ta.extend({},i),ta.extend(this,ta.pick(i,["url","scheme","tileSize"]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=g(this._options,this.map._requestManager,function(e,a){t._tileJSONRequest=null,e?t.fire(new ta.ErrorEvent(e)):a&&(ta.extend(t,a),a.bounds&&(t.tileBounds=new Fa(a.bounds,t.minzoom,t.maxzoom)),ta.postTurnstileEvent(a.tiles),ta.postMapLoadEvent(a.tiles,t.map._getMapId(),t.map._requestManager._skuToken),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"content"})))})},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},e.prototype.serialize=function(){return ta.extend({},this._options)},e.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},e.prototype.loadTile=function(t,e){var i=this,a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);t.request=ta.getImage(this.map._requestManager.transformRequest(a,ta.ResourceType.Tile),function(o,r){if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(o)t.state="errored",e(o);else if(r){i.map._refreshExpiredTiles&&t.setExpiryData(r),delete r.cacheControl,delete r.expires;var a=i.map.painter.context,n=a.gl;t.texture=i.map.painter.getTileTexture(r.width),t.texture?t.texture.update(r,{useMipmap:!0}):(t.texture=new ta.Texture(a,r,n.RGBA,{useMipmap:!0}),t.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),t.state="loaded",ta.cacheEntryPossiblyAdded(i.dispatcher),e(null)}})},e.prototype.abortTile=function(a,t){a.request&&(a.request.cancel(),delete a.request),t()},e.prototype.unloadTile=function(a,t){a.texture&&this.map.painter.saveTileTexture(a.texture),t()},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),S=function(t){function e(e,i,o,r){t.call(this,e,i,o,r),this.type="raster-dem",this.maxzoom=22,this._options=ta.extend({},i),this.encoding=i.encoding||"mapbox"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},e.prototype.loadTile=function(l,e){var t=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);l.request=ta.getImage(this.map._requestManager.transformRequest(t,ta.ResourceType.Tile),function(t,o){if(delete l.request,l.aborted)l.state="unloaded",e(null);else if(t)l.state="errored",e(t);else if(o){this.map._refreshExpiredTiles&&l.setExpiryData(o),delete o.cacheControl,delete o.expires;var r=ta.browser.getImageData(o),a={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:r,encoding:this.encoding};l.workerID&&"expired"!==l.state||(l.workerID=this.dispatcher.send("loadDEMTile",a,function(a,t){a&&(l.state="errored",e(a)),t&&(l.dem=t,l.needsHillshadePrepare=!0,l.state="loaded",e(null))}.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)},e.prototype._getNeighboringTiles=function(t){var e=t.canonical,i=ya(2,e.z),o=(e.x-1+i)%i,r=0===e.x?t.wrap-1:t.wrap,a=(e.x+1+i)%i,n=e.x+1===i?t.wrap+1:t.wrap,s={};return s[new ta.OverscaledTileID(t.overscaledZ,r,e.z,o,e.y).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,n,e.z,a,e.y).key]={backfilled:!1},0<e.y&&(s[new ta.OverscaledTileID(t.overscaledZ,r,e.z,o,e.y-1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,n,e.z,a,e.y-1).key]={backfilled:!1}),e.y+1<i&&(s[new ta.OverscaledTileID(t.overscaledZ,r,e.z,o,e.y+1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,n,e.z,a,e.y+1).key]={backfilled:!1}),s},e.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:e.uid,source:this.id},void 0,e.workerID)},e}(C),Na=function(t){function e(e,i,o,r){t.call(this),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=o,this.setEventedParent(r),this._data=i.data,this._options=ta.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution);var a=ta.EXTENT/this.tileSize;this.workerOptions=ta.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0===i.buffer?128:i.buffer)*a,tolerance:(void 0===i.tolerance?.375:i.tolerance)*a,extent:ta.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0===i.clusterMaxZoom?this.maxzoom-1:ea(i.clusterMaxZoom,this.maxzoom-1),extent:ta.EXTENT,radius:(i.clusterRadius||50)*a,log:!1},clusterProperties:i.clusterProperties},i.workerOptions)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)t.fire(new ta.ErrorEvent(e));else{var a={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&0<t._resourceTiming.length&&(a.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new ta.Event("data",a))}})},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.setData=function(t){var a=this;return this._data=t,this.fire(new ta.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)a.fire(new ta.ErrorEvent(t));else{var e={dataType:"source",sourceDataType:"content"};a._collectResourceTiming&&a._resourceTiming&&0<a._resourceTiming.length&&(e.resourceTiming=a._resourceTiming,a._resourceTiming=[]),a.fire(new ta.Event("data",e))}}),this},e.prototype.getClusterExpansionZoom=function(a,t){return this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},t,this.workerID),this},e.prototype.getClusterChildren=function(a,t){return this.dispatcher.send("geojson.getClusterChildren",{clusterId:a,source:this.id},t,this.workerID),this},e.prototype.getClusterLeaves=function(a,t,e,r){return this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:t,offset:e},r,this.workerID),this},e.prototype._updateWorkerData=function(a){var e=this,i=ta.extend({},this.workerOptions),t=this._data;"string"==typeof t?(i.request=this.map._requestManager.transformRequest(ta.browser.resolveURL(t),ta.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(t),this.workerID=this.dispatcher.send(this.type+".loadData",i,function(o,t){e._removed||t&&t.abandoned||(e._loaded=!0,t&&t.resourceTiming&&t.resourceTiming[e.id]&&(e._resourceTiming=t.resourceTiming[e.id].slice(0)),e.dispatcher.send(e.type+".coalesce",{source:i.source},null,e.workerID),a(o))},this.workerID)},e.prototype.loadTile=function(n,e){var i=this,o=void 0===n.workerID?"loadTile":"reloadTile",t={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:ta.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};n.workerID=this.dispatcher.send(o,t,function(r,t){return n.unloadVectorData(),n.aborted?e(null):r?e(r):(n.loadVectorData(t,i.map.painter,"reloadTile"==o),e(null))},this.workerID)},e.prototype.abortTile=function(e){e.aborted=!0},e.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},null,e.workerID)},e.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},e.prototype.serialize=function(){return ta.extend({},this._options,{type:this.type,data:this._data})},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),z=function(a){function e(e,t,i,o){a.call(this),this.id=e,this.dispatcher=i,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(o),this.options=t}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.load=function(t,e){var i=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),this.url=this.options.url,ta.getImage(this.map._requestManager.transformRequest(this.url,ta.ResourceType.Image),function(o,r){o?i.fire(new ta.ErrorEvent(o)):r&&(i.image=r,t&&(i.coordinates=t),e&&e(),i._finishLoading())})},e.prototype.updateImage=function(a){var t=this;return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,function(){t.texture=null}),this):this},e.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ta.Event("data",{dataType:"source",sourceDataType:"metadata"})))},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.setCoordinates=function(t){var e=this;this.coordinates=t;var a=t.map(ta.MercatorCoordinate.fromLngLat);this.tileID=function(t){for(var e=1/0,g=1/0,m=-1/0,y=-1/0,f=0,x=t,s;f<x.length;f+=1)s=x[f],e=ea(e,s.x),g=ea(g,s.y),m=va(m,s.x),y=va(y,s.y);var _=m-e,c=y-g,u=va(_,c),h=va(0,ba(-P(u)/E)),p=ya(2,h);return new ta.CanonicalTileID(h,ba((e+m)/2*p),ba((g+y)/2*p))}(a),this.minzoom=this.maxzoom=this.tileID.z;var o=a.map(function(a){return e.tileID.getTilePoint(a)._round()});return this._boundsArray=new ta.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,ta.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,ta.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,ta.EXTENT,ta.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new ta.Event("data",{dataType:"source",sourceDataType:"content"})),this},e.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,e=t.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,ta.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=ta.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ta.Texture(t,this.image,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[a];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},e.prototype.loadTile=function(a,t){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[a.tileID.wrap+""]=a,a.buckets={},t(null)):(a.state="errored",t(null))},e.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),Va=function(a){function e(e,t,i,o){a.call(this,e,t,i,o),this.roundZoom=!0,this.type="video",this.options=t}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this,e=this.options;this.urls=[];for(var i=0,n=e.urls,r;i<n.length;i+=1)r=n[i],this.urls.push(this.map._requestManager.transformRequest(r,ta.ResourceType.Source).url);ta.getVideo(this.urls,function(e,a){e?t.fire(new ta.ErrorEvent(e)):a&&(t.video=a,t.video.loop=!0,t.video.addEventListener("playing",function(){t.map.triggerRepaint()}),t.map&&t.video.play(),t._finishLoading())})},e.prototype.getVideo=function(){return this.video},e.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},e.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||2>this.video.readyState)){var t=this.map.painter.context,e=t.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,ta.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=ta.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new ta.Texture(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[a];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},e.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return this.video&&!this.video.paused},e}(z),Ua=function(t){function e(e,i,o,r){t.call(this,e,i,o,r),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(function(e){return!Array.isArray(e)||2!==e.length||e.some(function(e){return"number"!=typeof e})})||this.fire(new ta.ErrorEvent(new ta.ValidationError("sources."+e,null,"\"coordinates\" property must be an array of 4 longitude/latitude array pairs"))):this.fire(new ta.ErrorEvent(new ta.ValidationError("sources."+e,null,"missing required property \"coordinates\""))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new ta.ErrorEvent(new ta.ValidationError("sources."+e,null,"optional \"animate\" property must be a boolean value"))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof ta.window.HTMLCanvasElement||this.fire(new ta.ErrorEvent(new ta.ValidationError("sources."+e,null,"\"canvas\" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance"))):this.fire(new ta.ErrorEvent(new ta.ValidationError("sources."+e,null,"missing required property \"canvas\""))),this.options=i,this.animate=void 0===i.animate||i.animate}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof ta.window.HTMLCanvasElement?this.options.canvas:ta.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new ta.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},e.prototype.getCanvas=function(){return this.canvas},e.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},e.prototype.onRemove=function(){this.pause()},e.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,i=n.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,ta.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=ta.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ta.Texture(n,this.canvas,i.RGBA,{premultiply:!0}),this.tiles){var r=this.tiles[o];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},e.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},e.prototype.hasTransition=function(){return this._playing},e.prototype._hasInvalidDimensions=function(){for(var a=0,r=[this.canvas.width,this.canvas.height],e;a<r.length;a+=1)if(e=r[a],isNaN(e)||0>=e)return!0;return!1},e}(z),Ha={vector:Ba,raster:C,"raster-dem":S,geojson:Na,video:Va,image:z,canvas:Ua},Ga=function(t,e,i,o){var r=new Ha[e.type](t,e,i,o);if(r.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+r.id);return ta.bindAll(["load","abort","unload","serialize","prepare"],r),r},A=function(a,t){this.max=a,this.onRemove=t,this.reset()};A.prototype.reset=function(){for(var a in this.data)for(var t=0,r=this.data[a],i;t<r.length;t+=1)i=r[t],i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this},A.prototype.add=function(l,t,e){var i=this,o=l.wrapped().key;void 0===this.data[o]&&(this.data[o]=[]);var r={value:t,timeout:void 0};if(void 0!==e&&(r.timeout=setTimeout(function(){i.remove(l,r)},e)),this.data[o].push(r),this.order.push(o),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},A.prototype.has=function(e){return e.wrapped().key in this.data},A.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},A.prototype._getAndRemoveByKey=function(a){var t=this.data[a].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),t.value},A.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},A.prototype.remove=function(a,t){if(!this.has(a))return this;var e=a.wrapped().key,i=void 0===t?0:this.data[e].indexOf(t),o=this.data[e][i];return this.data[e].splice(i,1),o.timeout&&clearTimeout(o.timeout),0===this.data[e].length&&delete this.data[e],this.onRemove(o.value),this.order.splice(this.order.indexOf(e),1),this},A.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this};var F=function(a,t,e){this.context=a;var r=a.gl;this.buffer=r.createBuffer(),this.dynamicDraw=!!e,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};F.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},F.prototype.updateData=function(a){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},F.prototype.destroy=function(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)};var U={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},qa=function(a,t,e,i){this.length=t.length,this.attributes=e,this.itemSize=t.bytesPerElement,this.dynamicDraw=i,this.context=a;var o=a.gl;this.buffer=o.createBuffer(),a.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};qa.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},qa.prototype.updateData=function(a){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,a.arrayBuffer)},qa.prototype.enableAttributes=function(a,t){for(var e=0;e<this.attributes.length;e++){var n=this.attributes[e],o=t.attributes[n.name];void 0!==o&&a.enableVertexAttribArray(o)}},qa.prototype.setVertexAttribPointers=function(n,t,e){for(var i=0;i<this.attributes.length;i++){var l=this.attributes[i],r=t.attributes[l.name];void 0!==r&&n.vertexAttribPointer(r,l.components,n[U[l.type]],!1,this.itemSize,l.offset+this.itemSize*(e||0))}},qa.prototype.destroy=function(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)};var Z=function(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Z.prototype.get=function(){return this.current},Z.prototype.set=function(){},Z.prototype.getDefault=function(){return this.default},Z.prototype.setDefault=function(){this.set(this.default)};var j=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return ta.Color.transparent},e.prototype.set=function(a){var t=this.current;(a.r!==t.r||a.g!==t.g||a.b!==t.b||a.a!==t.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},e}(Z),q=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return 1},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)},t}(Z),Ya=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return 0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)},t}(Z),G=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return[!0,!0,!0,!0]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||a[2]!==t[2]||a[3]!==t[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},t}(Z),W=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return!0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)},t}(Z),X=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return 255},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)},t}(Z),H=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},t.prototype.set=function(a){var t=this.current;(a.func!==t.func||a.ref!==t.ref||a.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},t}(Z),K=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||a[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},t}(Z),Y=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=a,this.dirty=!1}},t}(Z),J=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return[0,1]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},t}(Z),Q=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=a,this.dirty=!1}},t}(Z),$=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return this.gl.LESS},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)},t}(Z),tt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.BLEND):t.disable(t.BLEND),this.current=a,this.dirty=!1}},t}(Z),et=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.ONE,e.ZERO]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},t}(Z),it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return ta.Color.transparent},e.prototype.set=function(a){var t=this.current;(a.r!==t.r||a.g!==t.g||a.b!==t.b||a.a!==t.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},e}(Z),ot=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return this.gl.FUNC_ADD},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)},t}(Z),rt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;a?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=a,this.dirty=!1}},t}(Z),at=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return this.gl.BACK},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)},t}(Z),nt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return this.gl.CCW},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)},t}(Z),st=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)},t}(Z),lt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return this.gl.TEXTURE0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)},t}(Z),ct=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]},t.prototype.set=function(a){var t=this.current;(a[0]!==t[0]||a[1]!==t[1]||a[2]!==t[2]||a[3]!==t[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},t}(Z),ut=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},t}(Z),ht=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,a),this.current=a,this.dirty=!1}},t}(Z),pt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,a),this.current=a,this.dirty=!1}},t}(Z),dt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},t}(Z),_t=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(a){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},t}(Z),ft=function(a){function t(t){a.call(this,t),this.vao=t.extVertexArrayObject}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)},t}(Z),mt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return 4},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},t}(Z),gt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},t}(Z),vt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(a){if(a!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},t}(Z),yt=function(a){function t(t,e){a.call(this,t),this.context=t,this.parent=e}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getDefault=function(){return null},t}(Z),xt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.setDirty=function(){this.dirty=!0},t.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},t}(yt),bt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,a),this.current=a,this.dirty=!1}},t}(yt),wt=function(a,t,e){this.context=a,this.width=t,this.height=e;var i=a.gl,o=this.framebuffer=i.createFramebuffer();this.colorAttachment=new xt(a,o),this.depthAttachment=new bt(a,o)};wt.prototype.destroy=function(){var a=this.context.gl,t=this.colorAttachment.get();t&&a.deleteTexture(t);var e=this.depthAttachment.get();e&&a.deleteRenderbuffer(e),a.deleteFramebuffer(this.framebuffer)};var Et=function(a,t,e){this.func=a,this.mask=t,this.range=e};Et.ReadOnly=!1,Et.ReadWrite=!0,Et.disabled=new Et(519,Et.ReadOnly,[0,1]);var Tt=function(n,t,e,i,o,r){this.test=n,this.ref=t,this.mask=e,this.fail=i,this.depthFail=o,this.pass=r};Tt.disabled=new Tt({func:519,mask:0},0,0,7680,7680,7680);var It=function(a,t,e){this.blendFunction=a,this.blendColor=t,this.mask=e};It.Replace=[1,0],It.disabled=new It(It.Replace,ta.Color.transparent,[!1,!1,!1,!1]),It.unblended=new It(It.Replace,ta.Color.transparent,[!0,!0,!0,!0]),It.alphaBlended=new It([1,771],ta.Color.transparent,[!0,!0,!0,!0]);var Ct=function(a,t,e){this.enable=a,this.mode=t,this.frontFace=e};Ct.disabled=new Ct(!1,1029,2305),Ct.backCCW=new Ct(!0,1029,2305);var St=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new j(this),this.clearDepth=new q(this),this.clearStencil=new Ya(this),this.colorMask=new G(this),this.depthMask=new W(this),this.stencilMask=new X(this),this.stencilFunc=new H(this),this.stencilOp=new K(this),this.stencilTest=new Y(this),this.depthRange=new J(this),this.depthTest=new Q(this),this.depthFunc=new $(this),this.blend=new tt(this),this.blendFunc=new et(this),this.blendColor=new it(this),this.blendEquation=new ot(this),this.cullFace=new rt(this),this.cullFaceSide=new at(this),this.frontFace=new nt(this),this.program=new st(this),this.activeTexture=new lt(this),this.viewport=new ct(this),this.bindFramebuffer=new ut(this),this.bindRenderbuffer=new ht(this),this.bindTexture=new pt(this),this.bindVertexBuffer=new dt(this),this.bindElementBuffer=new _t(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ft(this),this.pixelStoreUnpack=new mt(this),this.pixelStoreUnpackPremultiplyAlpha=new gt(this),this.pixelStoreUnpackFlipY=new vt(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear")};St.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},St.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},St.prototype.createIndexBuffer=function(a,t){return new F(this,a,t)},St.prototype.createVertexBuffer=function(a,t,e){return new qa(this,a,t,e)},St.prototype.createRenderbuffer=function(a,t,e){var i=this.gl,o=i.createRenderbuffer();return this.bindRenderbuffer.set(o),i.renderbufferStorage(i.RENDERBUFFER,a,t,e),this.bindRenderbuffer.set(null),o},St.prototype.createFramebuffer=function(a,t){return new wt(this,a,t)},St.prototype.clear=function(a){var t=a.color,e=a.depth,i=this.gl,o=0;t&&(o|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(o|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),i.clear(o)},St.prototype.setCullFace=function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))},St.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},St.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},St.prototype.setColorMode=function(t){ta.deepEqual(t.blendFunction,It.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},St.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Pt=function(t){function k(e,i,o){var r=this;t.call(this),this.id=e,this.dispatcher=o,this.on("data",function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(r._sourceLoaded=!0),r._sourceLoaded&&!r._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(r.reload(),r.transform&&r.update(r.transform))}),this.on("error",function(){r._sourceErrored=!0}),this._source=Ga(e,i,o,this),this._tiles={},this._cache=new A(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new ta.SourceFeatureState}return t&&(k.__proto__=t),k.prototype=Object.create(t&&t.prototype),k.prototype.constructor=k,k.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},k.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},k.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var a in this._tiles){var t=this._tiles[a];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},k.prototype.getSource=function(){return this._source},k.prototype.pause=function(){this._paused=!0},k.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},k.prototype._loadTile=function(a,t){return this._source.loadTile(a,t)},k.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,function(){})},k.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,function(){})},k.prototype.serialize=function(){return this._source.serialize()},k.prototype.prepare=function(a){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var e=this._tiles[t];e.upload(a),e.prepare(this.map.style.imageManager)}},k.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(O)},k.prototype.getRenderableIds=function(t){var l=this,e=[];for(var a in this._tiles)this._isIdRenderable(+a,t)&&e.push(+a);return t?e.sort(function(t,e){var o=l._tiles[t].tileID,r=l._tiles[e].tileID,a=new ta.Point(o.canonical.x,o.canonical.y)._rotate(l.transform.angle),i=new ta.Point(r.canonical.x,r.canonical.y)._rotate(l.transform.angle);return o.overscaledZ-r.overscaledZ||i.y-a.y||i.x-a.x}):e.sort(O)},k.prototype.hasRenderableParent=function(a){var t=this.findLoadedParent(a,0);return!!t&&this._isIdRenderable(t.tileID.key)},k.prototype._isIdRenderable=function(a,t){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(t||!this._tiles[a].holdingForFade())},k.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")},k.prototype._reloadTile=function(a,t){var e=this._tiles[a];e&&("loading"!==e.state&&(e.state=t),this._loadTile(e,this._tileLoaded.bind(this,e,a,t)))},k.prototype._tileLoaded=function(t,e,a,o){return o?(t.state="errored",void(404===o.status?this.update(this.transform):this._source.fire(new ta.ErrorEvent(o,{tile:t})))):void(t.timeAdded=ta.browser.now(),"expired"===a&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new ta.Event("data",{dataType:"source",tile:t,coord:t.tileID})))},k.prototype._backfillDEM=function(n){function t(n,t){n.needsHillshadePrepare=!0;var e=t.tileID.canonical.x-n.tileID.canonical.x,l=t.tileID.canonical.y-n.tileID.canonical.y,o=ya(2,n.tileID.canonical.z),r=t.tileID.key;0===e&&0==l||1<_a(l)||(1<_a(e)&&(1===_a(e+o)?e+=o:1===_a(e-o)&&(e-=o)),t.dem&&n.dem&&(n.dem.backfillBorder(t.dem,e,l),n.neighboringTiles&&n.neighboringTiles[r]&&(n.neighboringTiles[r].backfilled=!0)))}for(var a=this.getRenderableIds(),e=0,l;e<a.length;e++)if(l=a[e],n.neighboringTiles&&n.neighboringTiles[l]){var s=this.getTileByID(l);t(n,s),t(s,n)}},k.prototype.getTile=function(e){return this.getTileByID(e.key)},k.prototype.getTileByID=function(e){return this._tiles[e]},k.prototype.getZoom=function(e){return e.zoom+e.scaleZoom(e.tileSize/this._source.tileSize)},k.prototype._retainLoadedChildren=function(d,t,e,i){for(var o in this._tiles){var r=this._tiles[o];if(!(i[o]||!r.hasData()||r.tileID.overscaledZ<=t||r.tileID.overscaledZ>e)){for(var c=r.tileID,p;r&&r.tileID.overscaledZ>t+1;)p=r.tileID.scaledTo(r.tileID.overscaledZ-1),(r=this._tiles[p.key])&&r.hasData()&&(c=p);for(var u=c;u.overscaledZ>t;)if(d[(u=u.scaledTo(u.overscaledZ-1)).key]){i[c.key]=c;break}}}},k.prototype.findLoadedParent=function(n,t){for(var e=n.overscaledZ-1,l;e>=t;e--){if(l=n.scaledTo(e),!l)return;var s=l.key+"",r=this._tiles[s];if(r&&r.hasData())return r;if(this._cache.has(l))return this._cache.get(l)}},k.prototype.updateCacheSize=function(a){var t=(M(a.width/this._source.tileSize)+1)*(M(a.height/this._source.tileSize)+1),e=ba(5*t),r="number"==typeof this._maxTileCacheSize?ea(this._maxTileCacheSize,e):e;this._cache.setMaxSize(r)},k.prototype.handleWrapJump=function(d){var t=(d-(void 0===this._prevLng?d:this._prevLng))/360,e=V(t);if(this._prevLng=d,e){var i={};for(var o in this._tiles){var r=this._tiles[o];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),i[r.tileID.key]=r}for(var a in this._tiles=i,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var n in this._tiles){var s=this._tiles[n];this._setTileReloadTimer(n,s)}}},k.prototype.update=function(t){var e=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var o;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?o=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new ta.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}):(o=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(o=o.filter(function(a){return e._source.hasTile(a)}))):o=[];var i=(this._source.roundZoom?V:ba)(this.getZoom(t)),a=va(i-k.maxOverzooming,this._source.minzoom),n=va(i+k.maxUnderzooming,this._source.minzoom),s=this._updateRetainedTiles(o,i);if(Lt(this._source.type)){for(var l={},c={},u=0,T=Object.keys(s);u<T.length;u+=1){var p=T[u],d=s[p],_=this._tiles[p];if(_&&!(_.fadeEndTime&&_.fadeEndTime<=ta.browser.now())){var f=this.findLoadedParent(d,a);f&&(this._addTile(f.tileID),l[f.tileID.key]=f.tileID),c[p]=d}}for(var m in this._retainLoadedChildren(c,i,n,s),l)s[m]||(this._coveredTiles[m]=!0,s[m]=l[m])}for(var g in s)this._tiles[g].clearFadeHold();for(var v=0,A=ta.keysDifference(this._tiles,s);v<A.length;v+=1){var x=A[v],b=this._tiles[x];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(x)}}},k.prototype.releaseSymbolFadeTiles=function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)},k.prototype._updateRetainedTiles=function(i,t){for(var e={},o={},r=va(t-k.maxOverzooming,this._source.minzoom),a=va(t+k.maxUnderzooming,this._source.minzoom),n={},s=0,w=i;s<w.length;s+=1){var c=w[s],u=this._addTile(c);e[c.key]=c,u.hasData()||t<this._source.maxzoom&&(n[c.key]=c)}this._retainLoadedChildren(n,t,a,e);for(var h=0,T=i;h<T.length;h+=1){var d=T[h],_=this._tiles[d.key];if(!_.hasData()){if(t+1>this._source.maxzoom){var A=d.children(this._source.maxzoom)[0],m=this.getTile(A);if(m&&m.hasData()){e[A.key]=A;continue}}else{var g=d.children(this._source.maxzoom);if(e[g[0].key]&&e[g[1].key]&&e[g[2].key]&&e[g[3].key])continue}for(var v=_.wasRequested(),S=d.overscaledZ-1,C;S>=r&&(C=d.scaledTo(S),!o[C.key])&&(o[C.key]=!0,!(_=this.getTile(C))&&v&&(_=this._addTile(C)),!(_&&(e[C.key]=C,v=_.wasRequested(),_.hasData())));--S);}}return e},k.prototype._addTile=function(t){var e=this._tiles[t.key];if(e)return e;(e=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));var a=!!e;return a||(e=new ta.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,a||this._source.fire(new ta.Event("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null},k.prototype._setTileReloadTimer=function(a,t){var e=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var r=t.getExpiryTimeout();r&&(this._timers[a]=setTimeout(function(){e._reloadTile(a,"expired"),delete e._timers[a]},r))},k.prototype._removeTile=function(a){var t=this._tiles[a];t&&(t.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),0<t.uses||(t.hasData()?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},k.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},k.prototype.tilesIn=function(t,e,i){var x=this,r=[],a=this.transform;if(!a)return r;for(var o=i?a.getCameraQueryGeometry(t):t,n=t.map(function(e){return a.pointCoordinate(e)}),l=o.map(function(e){return a.pointCoordinate(e)}),c=this.getIds(),u=1/0,b=1/0,k=-1/0,w=-1/0,s=0,T=l,m;s<T.length;s+=1)m=T[s],u=ea(u,m.x),b=ea(b,m.y),k=va(k,m.x),w=va(w,m.y);for(var A=function(t){var i=x._tiles[c[t]];if(!i.holdingForFade()){var o=i.tileID,s=ya(2,a.zoom-i.tileID.overscaledZ),d=e*i.queryPadding*ta.EXTENT/i.tileSize/s,p=[o.getTilePoint(new ta.MercatorCoordinate(u,b)),o.getTilePoint(new ta.MercatorCoordinate(k,w))];if(p[0].x-d<ta.EXTENT&&p[0].y-d<ta.EXTENT&&0<=p[1].x+d&&0<=p[1].y+d){var g=n.map(function(e){return o.getTilePoint(e)}),h=l.map(function(e){return o.getTilePoint(e)});r.push({tile:i,tileID:o,queryGeometry:g,cameraQueryGeometry:h,scale:s})}}},v=0;v<c.length;v++)A(v);return r},k.prototype.getVisibleCoordinates=function(n){for(var l=this,e=this.getRenderableIds(n).map(function(e){return l._tiles[e].tileID}),t=0,i=e,r;t<i.length;t+=1)r=i[t],r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return e},k.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Lt(this._source.type))for(var t in this._tiles){var e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=ta.browser.now())return!0}return!1},k.prototype.setFeatureState=function(a,r,e){a=a||"_geojsonTileLayer",this._state.updateState(a,r,e)},k.prototype.removeFeatureState=function(a,r,e){a=a||"_geojsonTileLayer",this._state.removeFeatureState(a,r,e)},k.prototype.getFeatureState=function(a,r){return a=a||"_geojsonTileLayer",this._state.getState(a,r)},k}(ta.Evented);Pt.maxOverzooming=10,Pt.maxUnderzooming=3;var zt=function(){this.active={}};zt.prototype.acquire=function(e){if(!this.workers)for(this.workers=[];this.workers.length<zt.workerCount;)this.workers.push(new Dt);return this.active[e]=!0,this.workers.slice()},zt.prototype.release=function(e){delete this.active[e],0===Object.keys(this.active).length&&(this.workers.forEach(function(e){e.terminate()}),this.workers=null)};var Rt=ba(ta.browser.hardwareConcurrency/2),kt;zt.workerCount=va(ea(Rt,6),1);var Wa={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"},Ft=function(n,t,e){var i=this.boxCells=[],o=this.circleCells=[];this.xCellCount=M(n/e),this.yCellCount=M(t/e);for(var r=0;r<this.xCellCount*this.yCellCount;r++)i.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=t,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};Ft.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ft.prototype.insert=function(a,t,e,i,o){this._forEachCell(t,e,i,o,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(o)},Ft.prototype.insertCircle=function(a,t,e,r){this._forEachCell(t-r,e-r,t+r,e+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(t),this.circles.push(e),this.circles.push(r)},Ft.prototype._insertBoxCell=function(n,t,e,i,o,r){this.boxCells[o].push(r)},Ft.prototype._insertCircleCell=function(n,t,e,i,o,r){this.circleCells[o].push(r)},Ft.prototype._query=function(d,t,e,i,o,r){if(0>e||d>this.width||0>i||t>this.height)return!o&&[];var a=[];if(0>=d&&0>=t&&this.width<=e&&this.height<=i){if(o)return!0;for(var n=0;n<this.boxKeys.length;n++)a.push({key:this.boxKeys[n],x1:this.bboxes[4*n],y1:this.bboxes[4*n+1],x2:this.bboxes[4*n+2],y2:this.bboxes[4*n+3]});for(var p=0;p<this.circleKeys.length;p++){var g=this.circles[3*p],c=this.circles[3*p+1],u=this.circles[3*p+2];a.push({key:this.circleKeys[p],x1:g-u,y1:c-u,x2:g+u,y2:c+u})}return r?a.filter(r):a}return this._forEachCell(d,t,e,i,this._queryCell,a,{hitTest:o,seenUids:{box:{},circle:{}}},r),o?0<a.length:a},Ft.prototype._queryCircle=function(d,t,e,i,o){var r=d-e,a=d+e,n=t-e,s=t+e;if(0>a||r>this.width||0>s||n>this.height)return!i&&[];var l=[];return this._forEachCell(r,n,a,s,this._queryCellCircle,l,{hitTest:i,circle:{x:d,y:t,radius:e},seenUids:{box:{},circle:{}}},o),i?0<l.length:l},Ft.prototype.query=function(a,t,e,i,o){return this._query(a,t,e,i,!1,o)},Ft.prototype.hitTest=function(a,t,e,i,o){return this._query(a,t,e,i,!0,o)},Ft.prototype.hitTestCircle=function(a,t,e,r){return this._queryCircle(a,t,e,!0,r)},Ft.prototype._queryCell=function(k,t,e,i,o,r,a,n){var s=a.seenUids,l=this.boxCells[o];if(null!==l)for(var c=this.bboxes,u=0,T=l,p;u<T.length;u+=1)if(p=T[u],!s.box[p]){s.box[p]=!0;var A=4*p;if(k<=c[A+2]&&t<=c[A+3]&&e>=c[A+0]&&i>=c[A+1]&&(!n||n(this.boxKeys[p]))){if(a.hitTest)return r.push(!0),!0;r.push({key:this.boxKeys[p],x1:c[A],y1:c[A+1],x2:c[A+2],y2:c[A+3]})}}var _=this.circleCells[o];if(null!==_)for(var f=this.circles,m=0,S=_,v;m<S.length;m+=1)if(v=S[m],!s.circle[v]){s.circle[v]=!0;var C=3*v;if(this._circleAndRectCollide(f[C],f[C+1],f[C+2],k,t,e,i)&&(!n||n(this.circleKeys[v]))){if(a.hitTest)return r.push(!0),!0;var x=f[C],b=f[C+1],w=f[C+2];r.push({key:this.circleKeys[v],x1:x-w,y1:b-w,x2:x+w,y2:b+w})}}},Ft.prototype._queryCellCircle=function(k,t,e,i,o,r,a,n){var s=a.circle,l=a.seenUids,c=this.boxCells[o];if(null!==c)for(var u=this.bboxes,h=0,w=c,d;h<w.length;h+=1)if(d=w[h],!l.box[d]){l.box[d]=!0;var T=4*d;if(this._circleAndRectCollide(s.x,s.y,s.radius,u[T+0],u[T+1],u[T+2],u[T+3])&&(!n||n(this.boxKeys[d])))return r.push(!0),!0}var f=this.circleCells[o];if(null!==f)for(var m=this.circles,g=0,A=f,y;g<A.length;g+=1)if(y=A[g],!l.circle[y]){l.circle[y]=!0;var S=3*y;if(this._circlesCollide(m[S],m[S+1],m[S+2],s.x,s.y,s.radius)&&(!n||n(this.circleKeys[y])))return r.push(!0),!0}},Ft.prototype._forEachCell=function(g,t,e,i,o,r,a,n){for(var s=this._convertToXCellCoord(g),l=this._convertToYCellCoord(t),c=this._convertToXCellCoord(e),u=this._convertToYCellCoord(i),h=s;h<=c;h++)for(var m=l,y;m<=u;m++)if(y=this.xCellCount*m+h,o.call(this,g,t,e,i,y,r,a,n))return},Ft.prototype._convertToXCellCoord=function(e){return va(0,ea(this.xCellCount-1,ba(e*this.xScale)))},Ft.prototype._convertToYCellCoord=function(e){return va(0,ea(this.yCellCount-1,ba(e*this.yScale)))},Ft.prototype._circlesCollide=function(d,t,e,i,o,r){var a=i-d,n=o-t,s=e+r;return s*s>a*a+n*n},Ft.prototype._circleAndRectCollide=function(d,t,e,i,o,r,a){var n=(r-i)/2,s=_a(d-(i+n));if(s>n+e)return!1;var l=(a-o)/2,c=_a(t-(o+l));if(c>l+e)return!1;if(s<=n||c<=l)return!0;var u=s-n,g=c-l;return u*u+g*g<=e*e};var Xt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]),re=function(a,t,r){void 0===t&&(t=new Ft(a.width+200,a.height+200,25)),void 0===r&&(r=new Ft(a.width+200,a.height+200,25)),this.transform=a,this.grid=t,this.ignoredGrid=r,this.pitchfactor=R(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};re.prototype.placeCollisionBox=function(d,t,e,i,o){var r=this.projectAndGetPerspectiveRatio(i,d.anchorPointX,d.anchorPointY),a=e*r.perspectiveRatio,n=d.x1*a+r.point.x,s=d.y1*a+r.point.y,l=d.x2*a+r.point.x,c=d.y2*a+r.point.y;return this.isInsideGrid(n,s,l,c)&&(t||!this.grid.hitTest(n,s,l,c,o))?{box:[n,s,l,c],offscreen:this.isOffscreen(n,s,l,c)}:{box:[],offscreen:!1}},re.prototype.approximateTileDistance=function(l,t,e,i,o){var r=o?1:i/this.pitchfactor,a=l.lastSegmentViewportDistance*e;return l.prevTileDistance+a+(r-1)*a*_a(De(t))},re.prototype.placeCollisionCircles=function(t,e,i,o,r,a,n,s,l,c,u,h,p){var d=[],m=this.projectAnchor(l,r.anchorX,r.anchorY),f=r.lineOffsetX*s,g=r.lineOffsetY*s,_=new ta.Point(r.anchorX,r.anchorY),y=Qt(s/24,n,f,g,!1,Kt(_,c).point,_,r,a,c,{},!0),x=!1,v=!1,V=!0,H=m.perspectiveRatio*o,T=1/(o*i),I=0,G=0;y&&(I=this.approximateTileDistance(y.first.tileDistance,y.first.angle,T,m.cameraDistance,h),G=this.approximateTileDistance(y.last.tileDistance,y.last.angle,T,m.cameraDistance,h));for(var q=0;q<t.length;q+=5){var Y=t[q],z=t[q+1],L=t[q+2],D=t[q+3];if(!y||D<-I||D>G)ne(t,q,!1);else{var M=this.projectPoint(l,Y,z),R=L*H;if(0<d.length){var A=M.x-d[d.length-4],k=M.y-d[d.length-3];if(2*(R*R)>A*A+k*k&&q+8<t.length){var B=t[q+8];if(B>-I&&B<G){ne(t,q,!1);continue}}}var O=q/5;d.push(M.x,M.y,R,O),ne(t,q,!0);var F=M.x-R,U=M.y-R,N=M.x+R,W=M.y+R;if(V=V&&this.isOffscreen(F,U,N,W),v=v||this.isInsideGrid(F,U,N,W),!e&&this.grid.hitTestCircle(M.x,M.y,R,p)){if(!u)return{circles:[],offscreen:!1};x=!0}}}return{circles:x||!v?[]:d,offscreen:V}},re.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var e=[],i=1/0,y=1/0,x=-1/0,b=-1/0,v=0,k=t;v<k.length;v+=1){var l=k[v],c=new ta.Point(l.x+100,l.y+100);i=ea(i,c.x),y=ea(y,c.y),x=va(x,c.x),b=va(b,c.y),e.push(c)}for(var u={},h={},p=0,w=this.grid.query(i,y,x,b).concat(this.ignoredGrid.query(i,y,x,b));p<w.length;p+=1){var _=w[p],f=_.key;if(void 0===u[f.bucketInstanceId]&&(u[f.bucketInstanceId]={}),!u[f.bucketInstanceId][f.featureIndex]){var m=[new ta.Point(_.x1,_.y1),new ta.Point(_.x2,_.y1),new ta.Point(_.x2,_.y2),new ta.Point(_.x1,_.y2)];ta.polygonIntersectsPolygon(e,m)&&(u[f.bucketInstanceId][f.featureIndex]=!0,void 0===h[f.bucketInstanceId]&&(h[f.bucketInstanceId]=[]),h[f.bucketInstanceId].push(f.featureIndex))}}return h},re.prototype.insertCollisionBox=function(a,t,e,i,o){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:e,featureIndex:i,collisionGroupID:o},a[0],a[1],a[2],a[3])},re.prototype.insertCollisionCircles=function(l,t,e,i,o){for(var r=t?this.ignoredGrid:this.grid,a={bucketInstanceId:e,featureIndex:i,collisionGroupID:o},n=0;n<l.length;n+=4)r.insertCircle(a,l[n],l[n+1],l[n+2])},re.prototype.projectAnchor=function(a,t,e){var r=[t,e,0,1];return ae(r,r,a),{perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/r[3]),cameraDistance:r[3]}},re.prototype.projectPoint=function(t,e,a){var o=[e,a,0,1];return ae(o,o,t),new ta.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100)},re.prototype.projectAndGetPerspectiveRatio=function(t,e,a){var o=[e,a,0,1];return ae(o,o,t),{point:new ta.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/o[3])}},re.prototype.isOffscreen=function(a,t,e,r){return 100>e||a>=this.screenRightBoundary||100>r||t>this.screenBottomBoundary},re.prototype.isInsideGrid=function(a,t,e,r){return 0<=e&&a<this.gridRightBoundary&&0<=r&&t<this.gridBottomBoundary};var se=function(a,t,e,r){this.opacity=a?va(0,ea(1,a.opacity+(a.placed?t:-t))):r&&e?1:0,this.placed=e};se.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var ue=function(a,t,e,i,o){this.text=new se(a?a.text:null,t,e,o),this.icon=new se(a?a.icon:null,t,i,o)};ue.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var he=function(a,t,e){this.text=a,this.icon=t,this.skipFade=e},pe=function(a,t,e,i,o){this.bucketInstanceId=a,this.featureIndex=t,this.sourceLayerIndex=e,this.bucketIndex=i,this.tileID=o},de=function(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}};de.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var r=++this.maxGroupID;this.collisionGroups[a]={ID:r,predicate:function(e){return e.collisionGroupID===r}}}return this.collisionGroups[a]};var _e=function(a,t,e,r){this.transform=a.clone(),this.collisionIndex=new re(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new de(e),this.prevPlacement=r,r&&(r.prevPlacement=void 0)};_e.prototype.placeLayerTile=function(t,e,i,o){var r=e.getBucket(t),a=e.latestFeatureIndex;if(r&&a&&t.id===r.layerIds[0]){var n=e.collisionBoxArray,s=r.layers[0].layout,l=ya(2,this.transform.zoom-e.tileID.overscaledZ),c=e.tileSize/ta.EXTENT,u=this.transform.calculatePosMatrix(e.tileID.toUnwrapped()),g=Wt(u,"map"===s.get("text-pitch-alignment"),"map"===s.get("text-rotation-alignment"),this.transform,le(e,1,this.transform.zoom)),p=Wt(u,"map"===s.get("icon-pitch-alignment"),"map"===s.get("icon-rotation-alignment"),this.transform,le(e,1,this.transform.zoom));this.retainedQueryData[r.bucketInstanceId]=new pe(r.bucketInstanceId,a,r.sourceLayerIndex,r.index,e.tileID),this.placeLayerBucket(r,u,g,p,l,c,i,e.holdingForFade(),o,n)}},_e.prototype.attemptAnchorPlacement=function(t,e,i,o,r,a,n,s,l,c,u,h,p,d){var y=ce(t,i,o,r,a),m=this.collisionIndex.placeCollisionBox(function(t,e,i,o,r,a){var n=t.x1,s=t.x2,l=t.y1,c=t.y2,u=t.anchorPointX,g=t.anchorPointY,p=new ta.Point(e,i);return o&&p._rotate(r?a:-a),{x1:n+p.x,y1:l+p.y,x2:s+p.x,y2:c+p.y,anchorPointX:u,anchorPointY:g}}(e,y.x,y.y,n,s,this.transform.angle),h,l,c,u.predicate),g;if(0<m.box.length)return this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(g=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={radialOffset:r,width:i,height:o,anchor:t,textBoxScale:a,prevAnchor:g},this.markUsedJustification(d,t,p),m},_e.prototype.placeLayerBucket=function(t,e,i,o,k,a,n,s,l,r){var c=this,h=t.layers[0].layout,p=ta.evaluateSizeForZoom(t.textSizeData,this.transform.zoom),d=h.get("text-optional"),_=h.get("icon-optional"),u=h.get("text-allow-overlap"),m=h.get("icon-allow-overlap"),f=u&&(m||!t.hasIconData()||_),v=m&&(u||!t.hasTextData()||d),y=this.collisionGroups.get(t.sourceID),g="map"===h.get("text-rotation-alignment"),x="map"===h.get("text-pitch-alignment"),b="viewport-y"===h.get("symbol-z-order");!t.collisionArrays&&r&&t.deserializeCollisionBoxes(r);var w=function(o,r){if(!l[o.crossTileID])if(s)c.placements[o.crossTileID]=new he(!1,!1,!1);else{var m=!1,b=!1,w=!0,H=null,G=null,Y=null,W=0,X=0;r.textFeatureIndex&&(W=r.textFeatureIndex);var K=r.textBox;if(K)if(h.get("text-variable-anchor")){var L=K.x2-K.x1,D=K.y2-K.y1,M=o.textBoxScale,R=h.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[o.crossTileID]){var J=c.prevPlacement.variableOffsets[o.crossTileID];R[0]!==J.anchor&&(R=R.filter(function(e){return e!==J.anchor})).unshift(J.anchor)}for(var Q=0,$=R,O;Q<$.length;Q+=1)if(O=$[Q],H=c.attemptAnchorPlacement(O,K,L,D,o.radialTextOffset,M,g,x,a,e,y,u,o,t)){m=!0;break}if(!c.variableOffsets[o.crossTileID]&&c.prevPlacement){var ee=c.prevPlacement.variableOffsets[o.crossTileID];ee&&(c.variableOffsets[o.crossTileID]=ee,c.markUsedJustification(t,ee.anchor,o))}}else m=0<(H=c.collisionIndex.placeCollisionBox(K,h.get("text-allow-overlap"),a,e,y.predicate)).box.length;w=H&&H.offscreen;var U=r.textCircles;if(U){var N=t.text.placedSymbolArray.get(o.centerJustifiedTextSymbolIndex),Z=ta.evaluateSizeForFeature(t.textSizeData,p,N);G=c.collisionIndex.placeCollisionCircles(U,h.get("text-allow-overlap"),k,a,N,t.lineVertexArray,t.glyphOffsetArray,Z,e,i,n,x,y.predicate),m=h.get("text-allow-overlap")||0<G.circles.length,w=w&&G.offscreen}r.iconFeatureIndex&&(X=r.iconFeatureIndex),r.iconBox&&(b=0<(Y=c.collisionIndex.placeCollisionBox(r.iconBox,h.get("icon-allow-overlap"),a,e,y.predicate)).box.length,w=w&&Y.offscreen);var j=d||0===o.numHorizontalGlyphVertices&&0===o.numVerticalGlyphVertices,q=_||0===o.numIconVertices;j||q?q?j||(b=b&&m):m=b&&m:b=m=b&&m,m&&H&&c.collisionIndex.insertCollisionBox(H.box,h.get("text-ignore-placement"),t.bucketInstanceId,W,y.ID),b&&Y&&c.collisionIndex.insertCollisionBox(Y.box,h.get("icon-ignore-placement"),t.bucketInstanceId,X,y.ID),m&&G&&c.collisionIndex.insertCollisionCircles(G.circles,h.get("text-ignore-placement"),t.bucketInstanceId,W,y.ID),c.placements[o.crossTileID]=new he(m||f,b||v,w||t.justReloaded),l[o.crossTileID]=!0}};if(b)for(var T=t.getSortedSymbolIndexes(this.transform.angle),A=T.length-1,L;0<=A;--A)L=T[A],w(t.symbolInstances.get(L),t.collisionArrays[L]);else for(var E=0;E<t.symbolInstances.length;++E)w(t.symbolInstances.get(E),t.collisionArrays[E]);t.justReloaded=!1},_e.prototype.markUsedJustification=function(t,e,i){var o={left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex},r=o[ta.getAnchorJustification(e)];for(var a in o){var n=o[a];0<=n&&(t.text.placedSymbolArray.get(n).crossTileID=0<=r&&n!==r?0:i.crossTileID)}},_e.prototype.commit=function(d){this.commitTime=d;var t=this.prevPlacement,e=!1,g=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,o=t?t.opacities:{},r=t?t.variableOffsets:{};for(var a in this.placements){var n=this.placements[a],s=o[a];s?(this.opacities[a]=new ue(s,g,n.text,n.icon),e=e||n.text!==s.text.placed||n.icon!==s.icon.placed):(this.opacities[a]=new ue(null,g,n.text,n.icon,n.skipFade),e=e||n.text||n.icon)}for(var l in o){var c=o[l];if(!this.opacities[l]){var u=new ue(c,g,!1,!1);u.isHidden()||(this.opacities[l]=u,e=e||c.text.placed||c.icon.placed)}}for(var h in r)this.variableOffsets[h]||!this.opacities[h]||this.opacities[h].isHidden()||(this.variableOffsets[h]=r[h]);e?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:d)},_e.prototype.updateLayerOpacities=function(l,t){for(var e={},i=0,s=t;i<s.length;i+=1){var r=s[i],a=r.getBucket(l);a&&r.latestFeatureIndex&&l.id===a.layerIds[0]&&this.updateBucketOpacities(a,e,r.collisionBoxArray)}},_e.prototype.updateBucketOpacities=function(y,e,t){y.hasTextData()&&y.text.opacityVertexArray.clear(),y.hasIconData()&&y.icon.opacityVertexArray.clear(),y.hasCollisionBoxData()&&y.collisionBox.collisionVertexArray.clear(),y.hasCollisionCircleData()&&y.collisionCircle.collisionVertexArray.clear();var o=y.layers[0].layout,r=new ue(null,0,!1,!1,!0),a=o.get("text-allow-overlap"),i=o.get("icon-allow-overlap"),n=o.get("text-variable-anchor"),l="map"===o.get("text-rotation-alignment"),s="map"===o.get("text-pitch-alignment"),c=new ue(null,0,a&&(i||!y.hasIconData()||o.get("icon-optional")),i&&(a||!y.hasTextData()||o.get("text-optional")),!0);!y.collisionArrays&&t&&(y.hasCollisionBoxData()||y.hasCollisionCircleData())&&y.deserializeCollisionBoxes(t);for(var u=0;u<y.symbolInstances.length;u++){var h=y.symbolInstances.get(u),d=h.numHorizontalGlyphVertices,_=h.numVerticalGlyphVertices,f=h.crossTileID,m=e[f],g=this.opacities[f];m?g=r:g||(g=c,this.opacities[f]=g),e[f]=!0;var k=0<h.numIconVertices;if(0<d||0<_){for(var x=ge(g.text),b=0;b<(d+_)/4;b++)y.text.opacityVertexArray.emplaceBack(x);var w=g.text.isHidden()?1:0;[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex].forEach(function(e){0<=e&&(y.text.placedSymbolArray.get(e).hidden=w)});var T=this.variableOffsets[h.crossTileID];T&&this.markUsedJustification(y,T.anchor,h)}if(k){for(var I=ge(g.icon),C=0;C<h.numIconVertices/4;C++)y.icon.opacityVertexArray.emplaceBack(I);y.icon.placedSymbolArray.get(u).hidden=g.icon.isHidden()}if(y.hasCollisionBoxData()||y.hasCollisionCircleData()){var O=y.collisionArrays[u];if(O){if(O.textBox){var P=new ta.Point(0,0),j=!0;if(n){var F=this.variableOffsets[f];F?(P=ce(F.anchor,F.width,F.height,F.radialOffset,F.textBoxScale),l&&P._rotate(s?this.transform.angle:-this.transform.angle)):j=!1}fe(y.collisionBox.collisionVertexArray,g.text.placed,!j,P.x,P.y)}O.iconBox&&fe(y.collisionBox.collisionVertexArray,g.icon.placed,!1);var D=O.textCircles;if(D&&y.hasCollisionCircleData())for(var M=0,B;M<D.length;M+=5)B=m||0===D[M+4],fe(y.collisionCircle.collisionVertexArray,g.text.placed,B)}}}y.sortFeatures(this.transform.angle),this.retainedQueryData[y.bucketInstanceId]&&(this.retainedQueryData[y.bucketInstanceId].featureSortOrder=y.featureSortOrder),y.hasTextData()&&y.text.opacityVertexBuffer&&y.text.opacityVertexBuffer.updateData(y.text.opacityVertexArray),y.hasIconData()&&y.icon.opacityVertexBuffer&&y.icon.opacityVertexBuffer.updateData(y.icon.opacityVertexArray),y.hasCollisionBoxData()&&y.collisionBox.collisionVertexBuffer&&y.collisionBox.collisionVertexBuffer.updateData(y.collisionBox.collisionVertexArray),y.hasCollisionCircleData()&&y.collisionCircle.collisionVertexBuffer&&y.collisionCircle.collisionVertexBuffer.updateData(y.collisionCircle.collisionVertexArray)},_e.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration},_e.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},_e.prototype.stillRecent=function(e){return this.commitTime+this.fadeDuration>e},_e.prototype.setStale=function(){this.stale=!0};var me=ya(2,25),ve=ya(2,24),ye=ya(2,17),xe=ya(2,16),be=ya(2,9),we=ya(2,8),Ee=ya(2,1),Te=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};Te.prototype.continuePlacement=function(n,t,e,i,o){for(;this._currentTileIndex<n.length;){var r=n[this._currentTileIndex];if(t.placeLayerTile(i,r,e,this._seenCrossTileIDs),this._currentTileIndex++,o())return!0}};var Ce=function(l,t,e,i,o,r,a){this.placement=new _e(l,o,r,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=e,this._showCollisionBoxes=i,this._done=!1};Ce.prototype.isDone=function(){return this._done},Ce.prototype.continuePlacement=function(t,e,i){for(var o=this,r=ta.browser.now(),a=function(){var t=ta.browser.now()-r;return!o._forceFullPlacement&&2<t};0<=this._currentPlacementIndex;){var n=e[t[this._currentPlacementIndex]],s=this.placement.collisionIndex.transform.zoom;if("symbol"===n.type&&(!n.minzoom||n.minzoom<=s)&&(!n.maxzoom||n.maxzoom>s)){if(this._inProgressLayer||(this._inProgressLayer=new Te),this._inProgressLayer.continuePlacement(i[n.source],this.placement,this._showCollisionBoxes,n,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ce.prototype.commit=function(e){return this.placement.commit(e),this.placement};var Se=512/ta.EXTENT/2,Xa=function(n,t,e){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=e;for(var i=0;i<t.length;i++){var l=t.get(i),r=l.key;this.indexedSymbolInstances[r]||(this.indexedSymbolInstances[r]=[]),this.indexedSymbolInstances[r].push({crossTileID:l.crossTileID,coord:this.getScaledCoordinates(l,n)})}};Xa.prototype.getScaledCoordinates=function(t,e){var a=e.canonical.z-this.tileID.canonical.z,o=Se/ya(2,a);return{x:ba((e.canonical.x*ta.EXTENT+t.anchorX)*o),y:ba((e.canonical.y*ta.EXTENT+t.anchorY)*o)}},Xa.prototype.findMatches=function(d,t,e){for(var i=this.tileID.canonical.z<t.canonical.z?1:ya(2,this.tileID.canonical.z-t.canonical.z),o=0,p;o<d.length;o++)if(p=d.get(o),!p.crossTileID){var g=this.indexedSymbolInstances[p.key];if(g)for(var n=this.getScaledCoordinates(p,t),s=0,h=g,c;s<h.length;s+=1)if(c=h[s],_a(c.coord.x-n.x)<=i&&_a(c.coord.y-n.y)<=i&&!e[c.crossTileID]){e[c.crossTileID]=!0,p.crossTileID=c.crossTileID;break}}};var ze=function(){this.maxCrossTileID=0};ze.prototype.generate=function(){return++this.maxCrossTileID};var Le=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Le.prototype.handleWrapJump=function(l){var t=V((l-this.lng)/360);if(0!==t)for(var e in this.indexes){var i=this.indexes[e],o={};for(var r in i){var a=i[r];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+t),o[a.tileID.key]=a}this.indexes[e]=o}this.lng=l},Le.prototype.addBucket=function(d,t,e){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(var i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var p=this.usedCrossTileIDs[d.overscaledZ];for(var r in this.indexes){var a=this.indexes[r];if(+r>d.overscaledZ)for(var n in a){var s=a[n];s.tileID.isChildOf(d)&&s.findMatches(t.symbolInstances,d,p)}else{var l=a[d.scaledTo(+r).key];l&&l.findMatches(t.symbolInstances,d,p)}}for(var c=0,g;c<t.symbolInstances.length;c++)g=t.symbolInstances.get(c),g.crossTileID||(g.crossTileID=e.generate(),p[g.crossTileID]=!0);return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Xa(d,t.symbolInstances,t.bucketInstanceId),!0},Le.prototype.removeBucketCrossTileIDs=function(n,t){for(var e in t.indexedSymbolInstances)for(var i=0,l=t.indexedSymbolInstances[e],r;i<l.length;i+=1)r=l[i],delete this.usedCrossTileIDs[n][r.crossTileID]},Le.prototype.removeStaleBuckets=function(a){var t=!1;for(var n in this.indexes){var i=this.indexes[n];for(var o in i)a[i[o].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[o]),delete i[o],t=!0)}return t};var Za=function(){this.layerIndexes={},this.crossTileIDs=new ze,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Za.prototype.addLayer=function(d,t,e){var i=this.layerIndexes[d.id];void 0===i&&(i=this.layerIndexes[d.id]=new Le);var p=!1,u={};i.handleWrapJump(e);for(var a=0,g=t;a<g.length;a+=1){var s=g[a],l=s.getBucket(d);l&&d.id===l.layerIds[0]&&(l.bucketInstanceId||(l.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,l,this.crossTileIDs)&&(p=!0),u[l.bucketInstanceId]=!0)}return i.removeStaleBuckets(u)&&(p=!0),p},Za.prototype.pruneUnusedLayers=function(a){var r={};for(var e in a.forEach(function(e){r[e]=!0}),this.layerIndexes)r[e]||delete this.layerIndexes[e]};var Me=function(t,e){return ta.emitValidationErrors(t,e&&e.filter(function(e){return"source.canvas"!==e.identifier}))},Re=ta.pick(Wa,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ae=ta.pick(Wa,["setCenter","setZoom","setBearing","setPitch"]),ke=function(t){function l(e,o){var s=this;void 0===o&&(o={}),t.call(this),this.map=e,this.dispatcher=new w((kt||(kt=new zt),kt),this),this.imageManager=new u,this.imageManager.setEventedParent(this),this.glyphManager=new _(e._requestManager,o.localIdeographFontFamily),this.lineAtlas=new b(256,512),this.crossTileSymbolIndex=new Za,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new ta.ZoomHistory,this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",ta.getReferrer());var a=this;this._rtlTextPluginCallback=l.registerForPluginAvailability(function(r){for(var t in a.dispatcher.broadcast("loadRTLTextPlugin",r.pluginURL,r.completionCallback),a.sourceCaches)a.sourceCaches[t].reload()}),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){var t=s.sourceCaches[a.sourceId];if(t){var e=t.getSource();if(e&&e.vectorLayerIds)for(var i in s._layers){var o=s._layers[i];o.source===e.id&&s._validateLayer(o)}}}})}return t&&(l.__proto__=t),l.prototype=Object.create(t&&t.prototype),l.prototype.constructor=l,l.prototype.loadURL=function(t,n){var l=this;void 0===n&&(n={}),this.fire(new ta.Event("dataloading",{dataType:"style"}));var o="boolean"==typeof n.validate?n.validate:!ta.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,n.accessToken);var r=this.map._requestManager.transformRequest(t,ta.ResourceType.Style);this._request=ta.getJSON(r,function(t,e){l._request=null,t?l.fire(new ta.ErrorEvent(t)):e&&l._load(e,o)})},l.prototype.loadJSON=function(t,e){var a=this;void 0===e&&(e={}),this.fire(new ta.Event("dataloading",{dataType:"style"})),this._request=ta.browser.frame(function(){a._request=null,a._load(t,!1!==e.validate)})},l.prototype._load=function(t,e){var d=this;if(!e||!Me(this,ta.validateStyle(t))){for(var o in this._loaded=!0,this.stylesheet=t,t.sources)this.addSource(o,t.sources[o],{validate:!1});t.sprite?this._spriteRequest=function(t,e,g){function o(){if(x)g(x);else if(m&&y){var t=ta.browser.getImageData(y),e={};for(var a in m){var r=m[a],o=r.width,i=r.height,n=r.x,l=r.y,s=r.sdf,d=r.pixelRatio,c=new ta.RGBAImage({width:o,height:i});ta.RGBAImage.copy(t,c,{x:n,y:l},{x:0,y:0},{width:o,height:i}),e[a]={data:c,pixelRatio:d,sdf:s}}g(null,e)}}var i=1<ta.browser.devicePixelRatio?"@2x":"",s=ta.getJSON(e.transformRequest(e.normalizeSpriteURL(t,i,".json"),ta.ResourceType.SpriteJSON),function(a,t){s=null,x||(x=a,m=t,o())}),d=ta.getImage(e.transformRequest(e.normalizeSpriteURL(t,i,".png"),ta.ResourceType.SpriteImage),function(a,t){d=null,x||(x=a,y=t,o())}),m,y,x;return{cancel:function(){s&&(s.cancel(),s=null),d&&(d.cancel(),d=null)}}}(t.sprite,this.map._requestManager,function(t,e){if(d._spriteRequest=null,t)d.fire(new ta.ErrorEvent(t));else if(e)for(var a in e)d.imageManager.addImage(a,e[a]);d.imageManager.setLoaded(!0),d.fire(new ta.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var r=Bt(this.stylesheet.layers);this._order=r.map(function(e){return e.id}),this._layers={};for(var a=0,i=r,s;a<i.length;a+=1)s=i[a],(s=ta.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s;this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new x(this.stylesheet.light),this.fire(new ta.Event("data",{dataType:"style"})),this.fire(new ta.Event("style.load"))}},l.prototype._validateLayer=function(t){var e=this.sourceCaches[t.source];if(e){var a=t.sourceLayer;if(a){var o=e.getSource();("geojson"===o.type||o.vectorLayerIds&&-1===o.vectorLayerIds.indexOf(a))&&this.fire(new ta.ErrorEvent(new Error("Source layer \""+a+"\" does not exist on source \""+o.id+"\" as specified by style layer \""+t.id+"\"")))}}},l.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},l.prototype._serializeLayers=function(n){for(var t=[],e=0,l=n;e<l.length;e+=1){var o=l[e],r=this._layers[o];"custom"!==r.type&&t.push(r.serialize())}return t},l.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},l.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},l.prototype.update=function(t){if(this._loaded){var e=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),o=Object.keys(this._removedLayers);for(var r in(i.length||o.length)&&this._updateWorkerLayers(i,o),this._updatedSources){var a=this._updatedSources[r];"reload"===a?this._reloadSource(r):"clear"===a&&this._clearSource(r)}for(var n in this._updatedPaintProps)this._layers[n].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,d=this._order;l<d.length;l+=1){var u=d[l],g=this._layers[u];g.recalculate(t),!g.isHidden(t.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}this.light.recalculate(t),this.z=t.zoom,e&&this.fire(new ta.Event("data",{dataType:"style"}))}},l.prototype._updateWorkerLayers=function(a,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:t})},l.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},l.prototype.setState=function(t){var a=this;if(this._checkLoaded(),Me(this,ta.validateStyle(t)))return!1;(t=ta.clone$1(t)).layers=Bt(t.layers);var i=Gt(this.serialize(),t).filter(function(e){return!(e.command in Ae)});if(0===i.length)return!1;var o=i.filter(function(e){return!(e.command in Re)});if(0<o.length)throw new Error("Unimplemented: "+o.map(function(e){return e.command}).join(", ")+".");return i.forEach(function(e){"setTransition"!==e.command&&a[e.command].apply(a,e.args)}),this.stylesheet=t,!0},l.prototype.addImage=function(t,e){return this.getImage(t)?this.fire(new ta.ErrorEvent(new Error("An image with this name already exists."))):void(this.imageManager.addImage(t,e),this.fire(new ta.Event("data",{dataType:"style"})))},l.prototype.updateImage=function(a,t){this.imageManager.updateImage(a,t)},l.prototype.getImage=function(e){return this.imageManager.getImage(e)},l.prototype.removeImage=function(t){return this.getImage(t)?void(this.imageManager.removeImage(t),this.fire(new ta.Event("data",{dataType:"style"}))):this.fire(new ta.ErrorEvent(new Error("No image with this name exists.")))},l.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},l.prototype.addSource=function(t,e,i){var n=this;if(void 0===i&&(i={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!e.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(e).join(", ")+".");if(!(0<=["vector","raster","geojson","video","image"].indexOf(e.type))||!this._validate(ta.validateStyle.source,"sources."+t,e,null,i)){this.map&&this.map._collectResourceTiming&&(e.collectResourceTiming=!0);var r=this.sourceCaches[t]=new Pt(t,e,this.dispatcher);r.style=this,r.setEventedParent(this,function(){return{isSourceLoaded:n.loaded(),source:r.serialize(),sourceId:t}}),r.onAdd(this.map),this._changed=!0}},l.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var e in this._layers)if(this._layers[e].source===t)return this.fire(new ta.ErrorEvent(new Error("Source \""+t+"\" cannot be removed while layer \""+e+"\" is using it.")));var a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new ta.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.clearTiles(),a.onRemove&&a.onRemove(this.map),this._changed=!0},l.prototype.setGeoJSONSourceData=function(a,t){this._checkLoaded(),this.sourceCaches[a].getSource().setData(t),this._changed=!0},l.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},l.prototype.addLayer=function(t,l,i){void 0===i&&(i={}),this._checkLoaded();var d=t.id;if(this.getLayer(d))this.fire(new ta.ErrorEvent(new Error("Layer with id \""+d+"\" already exists on this map")));else{var r;if("custom"===t.type){if(Me(this,ta.validateCustomStyleLayer(t)))return;r=ta.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(d,t.source),t=ta.clone$1(t),t=ta.extend(t,{source:d})),this._validate(ta.validateStyle.layer,"layers."+d,t,{arrayIndex:-1},i))return;r=ta.createStyleLayer(t),this._validateLayer(r),r.setEventedParent(this,{layer:{id:d}})}var c=l?this._order.indexOf(l):this._order.length;if(l&&-1===c)this.fire(new ta.ErrorEvent(new Error("Layer with id \""+l+"\" does not exist on this map.")));else{if(this._order.splice(c,0,d),this._layerOrderChanged=!0,this._layers[d]=r,this._removedLayers[d]&&r.source&&"custom"!==r.type){var n=this._removedLayers[d];delete this._removedLayers[d],n.type===r.type?(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()):this._updatedSources[r.source]="clear"}this._updateLayer(r),r.onAdd&&r.onAdd(this.map)}}},l.prototype.moveLayer=function(t,e){if(this._checkLoaded(),this._changed=!0,!this._layers[t])this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")));else if(t!==e){var a=this._order.indexOf(t);this._order.splice(a,1);var o=e?this._order.indexOf(e):this._order.length;e&&-1===o?this.fire(new ta.ErrorEvent(new Error("Layer with id \""+e+"\" does not exist on this map."))):(this._order.splice(o,0,t),this._layerOrderChanged=!0)}},l.prototype.removeLayer=function(t){this._checkLoaded();var e=this._layers[t];if(e){e.setEventedParent(null);var a=this._order.indexOf(t);this._order.splice(a,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],e.onRemove&&e.onRemove(this.map)}else this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},l.prototype.getLayer=function(e){return this._layers[e]},l.prototype.setLayerZoomRange=function(t,e,a){this._checkLoaded();var o=this.getLayer(t);o?o.minzoom===e&&o.maxzoom===a||(null!=e&&(o.minzoom=e),null!=a&&(o.maxzoom=a),this._updateLayer(o)):this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},l.prototype.setFilter=function(t,e,a){void 0===a&&(a={}),this._checkLoaded();var i=this.getLayer(t);if(!i)this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")));else if(!ta.deepEqual(i.filter,e))return null==e?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(ta.validateStyle.filter,"layers."+i.id+".filter",e,null,a)||(i.filter=ta.clone$1(e),this._updateLayer(i)))},l.prototype.getFilter=function(t){return ta.clone$1(this.getLayer(t).filter)},l.prototype.setLayoutProperty=function(t,e,i,o){void 0===o&&(o={}),this._checkLoaded();var n=this.getLayer(t);n?ta.deepEqual(n.getLayoutProperty(e),i)||(n.setLayoutProperty(e,i,o),this._updateLayer(n)):this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},l.prototype.getLayoutProperty=function(t,e){var a=this.getLayer(t);return a?a.getLayoutProperty(e):void this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},l.prototype.setPaintProperty=function(t,e,i,o){void 0===o&&(o={}),this._checkLoaded();var n=this.getLayer(t);n?ta.deepEqual(n.getPaintProperty(e),i)||(n.setPaintProperty(e,i,o)&&this._updateLayer(n),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},l.prototype.getPaintProperty=function(a,t){return this.getLayer(a).getPaintProperty(t)},l.prototype.setFeatureState=function(t,e){this._checkLoaded();var i=t.source,o=t.sourceLayer,r=this.sourceCaches[i],a=parseInt(t.id,10);if(void 0!==r){var n=r.getSource().type;"geojson"===n&&o?this.fire(new ta.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==n||o?isNaN(a)||0>a?this.fire(new ta.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):r.setFeatureState(o,a,e):this.fire(new ta.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new ta.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},l.prototype.removeFeatureState=function(t,e){this._checkLoaded();var i=t.source,o=this.sourceCaches[i];if(void 0!==o){var r=o.getSource().type,a="vector"===r?t.sourceLayer:void 0,n=parseInt(t.id,10);"vector"!==r||a?void 0!==t.id&&isNaN(n)||0>n?this.fire(new ta.ErrorEvent(new Error("The feature id parameter must be non-negative."))):e&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new ta.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):o.removeFeatureState(a,n,e):this.fire(new ta.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new ta.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},l.prototype.getFeatureState=function(t){this._checkLoaded();var e=t.source,i=t.sourceLayer,o=this.sourceCaches[e],r=parseInt(t.id,10);if(void 0===o)this.fire(new ta.ErrorEvent(new Error("The source '"+e+"' does not exist in the map's style.")));else if("vector"!==o.getSource().type||i){if(!(isNaN(r)||0>r))return o.getFeatureState(i,r);this.fire(new ta.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new ta.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))},l.prototype.getTransition=function(){return ta.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},l.prototype.serialize=function(){return ta.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:ta.mapObject(this.sourceCaches,function(e){return e.serialize()}),layers:this._serializeLayers(this._order)},function(e){return void 0!==e})},l.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},l.prototype._flattenAndSortRenderedFeatures=function(k){for(var T=this,e=function(e){return"fill-extrusion"===T._layers[e].type},t={},o=[],r=this._order.length-1,i;0<=r;r--)if(i=this._order[r],e(i)){t[i]=r;for(var A=0,S=k,l;A<S.length;A+=1)if(l=S[A][i],l)for(var C=0,L=l,h;C<L.length;C+=1)h=L[C],o.push(h)}o.sort(function(a,t){return t.intersectionZ-a.intersectionZ});for(var I=[],d=this._order.length-1,z;0<=d;d--)if(z=this._order[d],e(z))for(var P=o.length-1,D;0<=P&&(D=o[P].feature,!(t[D.layer.id]<d));P--)I.push(D),o.pop();else for(var O=0,R=k,y;O<R.length;O+=1)if(y=R[O][z],y)for(var M=0,j=y,w;M<j.length;M+=1)w=j[M],I.push(w.feature);return I},l.prototype.queryRenderedFeatures=function(t,e,i){e&&e.filter&&this._validate(ta.validateStyle.filter,"queryRenderedFeatures.filter",e.filter,null,e);var o={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire(new ta.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var r=0,d=e.layers;r<d.length;r+=1){var n=d[r],s=this._layers[n];if(!s)return this.fire(new ta.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be queried for features."))),[];o[s.source]=!0}}var l=[];for(var c in this.sourceCaches)e.layers&&!o[c]||l.push(k(this.sourceCaches[c],this._layers,t,e,i));return this.placement&&l.push(function(g,t,e,y,o,r){for(var x={},n=o.queryRenderedSymbols(e),a=[],i=0,l=Object.keys(n).map(Number),s;i<l.length;i+=1)s=l[i],a.push(r[s]);a.sort(B);for(var u=function(){var s=b[p],e=s.featureIndex.lookupSymbolFeatures(n[s.bucketInstanceId],s.bucketIndex,s.sourceLayerIndex,y.filter,y.layers,g);for(var t in e){var r=x[t]=x[t]||[],a=e[t];a.sort(function(e,t){var a=s.featureSortOrder;if(a){var o=a.indexOf(e.featureIndex);return a.indexOf(t.featureIndex)-o}return t.featureIndex-e.featureIndex});for(var o=0,i=a,l;o<i.length;o+=1)l=i[o],r.push(l)}},p=0,b=a;p<b.length;p+=1)u();var _=function(e){x[e].forEach(function(i){var o=i.feature,r=g[e],a=t[r.source].getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=a})};for(var f in x)_(f);return x}(this._layers,this.sourceCaches,t,e,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(l)},l.prototype.querySourceFeatures=function(t,e){e&&e.filter&&this._validate(ta.validateStyle.filter,"querySourceFeatures.filter",e.filter,null,e);var a=this.sourceCaches[t];return a?function(l,t){for(var e=l.getRenderableIds().map(function(t){return l.getTileByID(t)}),i=[],o={},r=0;r<e.length;r++){var d=e[r],n=d.tileID.canonical.key;o[n]||(o[n]=!0,d.querySourceFeatures(i,t))}return i}(a,e):[]},l.prototype.addSourceType=function(a,t,e){return l.getSourceType(a)?e(new Error("A source type called \""+a+"\" already exists.")):(l.setSourceType(a,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:t.workerSourceURL},e):e(null,null))},l.prototype.getLight=function(){return this.light.getLight()},l.prototype.setLight=function(t,e){void 0===e&&(e={}),this._checkLoaded();var l=this.light.getLight(),o=!1;for(var s in t)if(!ta.deepEqual(t[s],l[s])){o=!0;break}if(o){var a={now:ta.browser.now(),transition:ta.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,e),this.light.updateTransitions(a)}},l.prototype._validate=function(t,e,i,o,r){return void 0===r&&(r={}),(!r||!1!==r.validate)&&Me(this,t.call(ta.validateStyle,ta.extend({key:e,style:this.serialize(),value:i,styleSpec:ta.styleSpec},o)))},l.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),ta.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[t].clearTiles();this.dispatcher.remove()},l.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},l.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},l.prototype._updateSources=function(a){for(var t in this.sourceCaches)this.sourceCaches[t].update(a)},l.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},l.prototype._updatePlacement=function(t,e,i,o){for(var r=!1,y=!1,x={},s=0,b=this._order;s<b.length;s+=1){var c=b[s],u=this._layers[c];if("symbol"===u.type){if(!x[u.source]){var h=this.sourceCaches[u.source];x[u.source]=h.getRenderableIds(!0).map(function(e){return h.getTileByID(e)}).sort(function(a,t){return t.tileID.overscaledZ-a.tileID.overscaledZ||(a.tileID.isLessThan(t.tileID)?-1:1)})}var p=this.crossTileSymbolIndex.addLayer(u,x[u.source],t.center.lng);r=r||p}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var d=this._layerOrderChanged||0===i;if((d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ta.browser.now()))&&(this.pauseablePlacement=new Ce(t,this._order,d,e,i,o,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,x),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ta.browser.now()),y=!0),r&&this.pauseablePlacement.placement.setStale()),y||r)for(var _=0,k=this._order;_<k.length;_+=1){var m=k[_],g=this._layers[m];"symbol"===g.type&&this.placement.updateLayerOpacities(g,x[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ta.browser.now())},l.prototype._releaseSymbolFadeTiles=function(){for(var e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()},l.prototype.getImages=function(a,t,e){this.imageManager.getImages(t.icons,e)},l.prototype.getGlyphs=function(a,t,e){this.glyphManager.getGlyphs(t.stacks,e)},l.prototype.getResource=function(t,e,a){return ta.makeRequest(e,a)},l}(ta.Evented);ke.getSourceType=function(e){return Ha[e]},ke.setSourceType=function(a,t){Ha[a]=t},ke.registerForPluginAvailability=ta.registerForPluginAvailability;var Be=ta.createLayout([{name:"a_pos",type:"Int16",components:2}]),Oe=Ie("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Fe=Ie("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ue=Ie("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ne=Ie("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ze=Ie("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),je=Ie("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),qe=Ie("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ve=Ie("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ge=Ie("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),We=Ie("uniform highp vec4 u_color;void main() {gl_FragColor=u_color;}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Xe=Ie("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),He=Ie("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ke=Ie("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ye=Ie("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Je=Ie("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Qe=Ie("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec4 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),$e=Ie("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;return (data.r+data.g*256.0+data.b*256.0*256.0)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ka=Ie("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ja=Ie("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Qa=Ie("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),$a=Ie("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec4 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x,1.0);float x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);float y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);vec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));vec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);}"),er=Ie("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),tr=Ie("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ar=Ie("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),rr=Ie("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=vec2(tex.x,tex.y);v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),or=Object.freeze({prelude:Oe,background:Fe,backgroundPattern:Ue,circle:Ne,clippingMask:Ze,heatmap:je,heatmapTexture:qe,collisionBox:Ve,collisionCircle:Ge,debug:We,fill:Xe,fillOutline:He,fillOutlinePattern:Ke,fillPattern:Ye,fillExtrusion:Je,fillExtrusionPattern:Qe,hillshadePrepare:$e,hillshade:Ka,line:Ja,lineGradient:Qa,linePattern:$a,lineSDF:er,raster:tr,symbolIcon:ar,symbolSDF:rr}),ir=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ir.prototype.bind=function(d,t,e,i,o,r,a,n){this.context=d;for(var s=this.boundPaintVertexBuffers.length!==i.length,p=0;!s&&p<i.length;p++)this.boundPaintVertexBuffers[p]!==i[p]&&(s=!0);var g=!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==e||s||this.boundIndexBuffer!==o||this.boundVertexOffset!==r||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==n;!d.extVertexArrayObject||g?this.freshBind(t,e,i,o,r,a,n):(d.bindVertexArrayOES.set(this.vao),a&&a.bind(),o&&o.dynamicDraw&&o.bind(),n&&n.bind())},ir.prototype.freshBind=function(g,t,e,i,o,r,a){var n=g.numAttributes,l=this.context,c=l.gl,u;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),u=0,this.boundProgram=g,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=e,this.boundIndexBuffer=i,this.boundVertexOffset=o,this.boundDynamicVertexBuffer=r,this.boundDynamicVertexBuffer2=a;else{u=l.currentNumAttributes||0;for(var y=n;y<u;y++)c.disableVertexAttribArray(y)}t.enableAttributes(c,g);for(var x=0,b=e;x<b.length;x+=1)b[x].enableAttributes(c,g);r&&r.enableAttributes(c,g),a&&a.enableAttributes(c,g),t.bind(),t.setVertexAttribPointers(c,g,o);for(var d=0,v=e,f;d<v.length;d+=1)f=v[d],f.bind(),f.setVertexAttribPointers(c,g,o);r&&(r.bind(),r.setVertexAttribPointers(c,g,o)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,g,o)),l.currentNumAttributes=n},ir.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var nr=function(y,t,e,i,o){var r=y.gl;this.program=r.createProgram();var a=e.defines();o&&a.push("#define OVERDRAW_INSPECTOR;");var n=a.concat(Oe.fragmentSource,t.fragmentSource).join("\n"),s=a.concat(Oe.vertexSource,t.vertexSource).join("\n"),l=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(l,n),r.compileShader(l),r.attachShader(this.program,l);var c=r.createShader(r.VERTEX_SHADER);r.shaderSource(c,s),r.compileShader(c),r.attachShader(this.program,c);for(var u=e.layoutAttributes||[],h=0;h<u.length;h++)r.bindAttribLocation(this.program,h,u[h].name);r.linkProgram(this.program),this.numAttributes=r.getProgramParameter(this.program,r.ACTIVE_ATTRIBUTES),this.attributes={};for(var x={},d=0,b;d<this.numAttributes;d++)b=r.getActiveAttrib(this.program,d),b&&(this.attributes[b.name]=r.getAttribLocation(this.program,b.name));for(var k=r.getProgramParameter(this.program,r.ACTIVE_UNIFORMS),m=0,w;m<k;m++)w=r.getActiveUniform(this.program,m),w&&(x[w.name]=r.getUniformLocation(this.program,w.name));this.fixedUniforms=i(y,x),this.binderUniforms=e.getUniforms(y,x)};nr.prototype.draw=function(k,t,e,i,o,r,a,n,s,l,c,u,h,p,d,_){var f=k.gl,g;for(var T in k.program.set(this.program),k.setDepthMode(e),k.setStencilMode(i),k.setColorMode(o),k.setCullFace(r),this.fixedUniforms)this.fixedUniforms[T].set(a[T]);p&&p.setUniforms(k,this.binderUniforms,u,{zoom:h});for(var v=(g={},g[f.LINES]=2,g[f.TRIANGLES]=3,g[f.LINE_STRIP]=1,g)[t],y=0,A=c.get();y<A.length;y+=1){var b=A[y],w=b.vaos||(b.vaos={});(w[n]||(w[n]=new ir)).bind(k,this,s,p?p.getPaintVertexBuffers():[],l,b.vertexOffset,d,_),f.drawElements(t,b.primitiveLength*v,f.UNSIGNED_SHORT,2*(b.primitiveOffset*v))}};var lr=function(t,e,i,o){var r=e.style.light,a=r.properties.get("position"),n=[a.x,a.y,a.z],s=ta.create$1();"viewport"===r.properties.get("anchor")&&ta.fromRotation(s,-e.transform.angle),ta.transformMat3(n,n,s);var l=r.properties.get("color");return{u_matrix:t,u_lightpos:n,u_lightintensity:r.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+i,u_opacity:o}},sr=function(t,e,i,o,r,a,n){return ta.extend(lr(t,e,i,o),ra(a,e,n),{u_height_factor:-ya(2,r.overscaledZ)/n.tileSize/8})},dr=function(e){return{u_matrix:e}},cr=function(t,e,a,o){return ta.extend(dr(t),ra(a,e,o))},pr=function(a,t){return{u_matrix:a,u_world:t}},ur=function(t,e,i,o,r){return ta.extend(cr(t,e,i,o),{u_world:r})},gr=function(t,e,i,o){var r=t.transform,s,d;if("map"===o.paint.get("circle-pitch-alignment")){var c=le(i,1,r.zoom);s=!0,d=[c,c]}else s=!1,d=r.pixelsToGLUnits;return{u_camera_to_center_distance:r.cameraToCenterDistance,u_scale_with_map:+("map"===o.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,i,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_pitch_with_map:+s,u_device_pixel_ratio:ta.browser.devicePixelRatio,u_extrude_scale:d}},hr=function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_camera_to_center_distance:new ta.Uniform1f(t,e.u_camera_to_center_distance),u_pixels_to_tile_units:new ta.Uniform1f(t,e.u_pixels_to_tile_units),u_extrude_scale:new ta.Uniform2f(t,e.u_extrude_scale),u_overscale_factor:new ta.Uniform1f(t,e.u_overscale_factor)}},mr=function(n,t,e){var i=le(e,1,t.zoom),o=ya(2,t.zoom-e.tileID.overscaledZ),r=e.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:i,u_extrude_scale:[t.pixelsToGLUnits[0]/(i*o),t.pixelsToGLUnits[1]/(i*o)],u_overscale_factor:r}},yr=function(a,t){return{u_matrix:a,u_color:t}},fr=function(e){return{u_matrix:e}},xr=function(a,t,e,r){return{u_matrix:a,u_extrude_scale:le(t,1,e),u_intensity:r}},_r=function(t,e,i,o){var r=ta.create();ta.ortho(r,0,t.width,t.height,0,0,1);var a=t.context.gl;return{u_matrix:r,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:i,u_color_ramp:o,u_opacity:e.paint.get("heatmap-opacity")}},br=function(l,t,e){var i=e.paint.get("hillshade-shadow-color"),o=e.paint.get("hillshade-highlight-color"),r=e.paint.get("hillshade-accent-color"),a=e.paint.get("hillshade-illumination-direction")*(Pe/180);"viewport"===e.paint.get("hillshade-illumination-anchor")&&(a-=l.transform.angle);var d=!l.options.moving;return{u_matrix:l.transform.calculatePosMatrix(t.tileID.toUnwrapped(),d),u_image:0,u_latrange:oa(l,t.tileID),u_light:[e.paint.get("hillshade-exaggeration"),a],u_shadow:i,u_highlight:o,u_accent:r}},vr=function(t,e){var a=t.dem.stride,o=ta.create();return ta.ortho(o,0,ta.EXTENT,-ta.EXTENT,0,0,1),ta.translate(o,o,[0,-ta.EXTENT,0]),{u_matrix:o,u_image:1,u_dimension:[a,a],u_zoom:t.tileID.overscaledZ,u_maxzoom:e}},kr=function(t,e,a){var o=t.transform;return{u_matrix:na(t,e,a),u_ratio:1/le(e,1,o.zoom),u_device_pixel_ratio:ta.browser.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},wr=function(t,e,a){return ta.extend(kr(t,e,a),{u_image:0})},Tr=function(t,e,i,o){var r=t.transform,a=ia(e,r);return{u_matrix:na(t,e,i),u_texsize:e.imageAtlasTexture.size,u_ratio:1/le(e,1,r.zoom),u_device_pixel_ratio:ta.browser.devicePixelRatio,u_image:0,u_scale:[ta.browser.devicePixelRatio,a,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},Ar=function(t,e,i,o,r){var a=t.transform,n=t.lineAtlas,s=ia(e,a),l="round"===i.layout.get("line-cap"),c=n.getDash(o.from,l),u=n.getDash(o.to,l),g=c.width*r.fromScale,p=u.width*r.toScale;return ta.extend(kr(t,e,i),{u_patternscale_a:[s/g,-c.height/2],u_patternscale_b:[s/p,-u.height/2],u_sdfgamma:n.width/(256*ea(g,p)*ta.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:u.y,u_mix:r.t})},Sr=function(l,t,e,i,o){return{u_matrix:l,u_tl_parent:t,u_scale_parent:e,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*o.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:o.paint.get("raster-brightness-min"),u_brightness_high:o.paint.get("raster-brightness-max"),u_saturation_factor:(s=o.paint.get("raster-saturation"),0<s?1-1/(1.001-s):-s),u_contrast_factor:(r=o.paint.get("raster-contrast"),0<r?1/(1-r):1+r),u_spin_weights:la(o.paint.get("raster-hue-rotate"))};var r,s},Cr=function(d,t,e,i,o,r,a,n,s,l){var c=o.transform;return{u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:2*(c.pitch/360)*Pe,u_rotate_symbol:+e,u_aspect_ratio:c.width/c.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:r,u_label_plane_matrix:a,u_coord_matrix:n,u_is_text:+s,u_pitch_with_map:+i,u_texsize:l,u_texture:0}},Lr=function(t,e,i,o,r,a,n,s,l,d,c){var u=r.transform;return ta.extend(Cr(t,e,i,o,r,a,n,s,l,d),{u_gamma_scale:o?R(u._pitch)*u.cameraToCenterDistance:1,u_device_pixel_ratio:ta.browser.devicePixelRatio,u_is_halo:+c})},Er=function(a,t,e){return{u_matrix:a,u_opacity:t,u_color:e}},Ir=function(t,e,i,o,r,a){return ta.extend(function(d,t,e,i){var o=e.imageManager.getPattern(d.from),r=e.imageManager.getPattern(d.to),a=e.imageManager.getPixelSize(),n=a.width,s=a.height,l=ya(2,i.tileID.overscaledZ),c=i.tileSize*ya(2,e.transform.tileZoom)/l,u=c*(i.tileID.canonical.x+i.tileID.wrap*l),g=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:o.tl,u_pattern_br_a:o.br,u_pattern_tl_b:r.tl,u_pattern_br_b:r.br,u_texsize:[n,s],u_mix:t.t,u_pattern_size_a:o.displaySize,u_pattern_size_b:r.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/le(i,1,e.transform.tileZoom),u_pixel_coord_upper:[u>>16,g>>16],u_pixel_coord_lower:[65535&u,65535&g]}}(o,a,i,r),{u_matrix:t,u_opacity:e})},zr={fillExtrusion:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_lightpos:new ta.Uniform3f(t,e.u_lightpos),u_lightintensity:new ta.Uniform1f(t,e.u_lightintensity),u_lightcolor:new ta.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new ta.Uniform1f(t,e.u_vertical_gradient),u_opacity:new ta.Uniform1f(t,e.u_opacity)}},fillExtrusionPattern:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_lightpos:new ta.Uniform3f(t,e.u_lightpos),u_lightintensity:new ta.Uniform1f(t,e.u_lightintensity),u_lightcolor:new ta.Uniform3f(t,e.u_lightcolor),u_vertical_gradient:new ta.Uniform1f(t,e.u_vertical_gradient),u_height_factor:new ta.Uniform1f(t,e.u_height_factor),u_image:new ta.Uniform1i(t,e.u_image),u_texsize:new ta.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new ta.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ta.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new ta.Uniform4f(t,e.u_scale),u_fade:new ta.Uniform1f(t,e.u_fade),u_opacity:new ta.Uniform1f(t,e.u_opacity)}},fill:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix)}},fillPattern:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_image:new ta.Uniform1i(t,e.u_image),u_texsize:new ta.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new ta.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ta.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new ta.Uniform4f(t,e.u_scale),u_fade:new ta.Uniform1f(t,e.u_fade)}},fillOutline:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_world:new ta.Uniform2f(t,e.u_world)}},fillOutlinePattern:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_world:new ta.Uniform2f(t,e.u_world),u_image:new ta.Uniform1i(t,e.u_image),u_texsize:new ta.Uniform2f(t,e.u_texsize),u_pixel_coord_upper:new ta.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ta.Uniform2f(t,e.u_pixel_coord_lower),u_scale:new ta.Uniform4f(t,e.u_scale),u_fade:new ta.Uniform1f(t,e.u_fade)}},circle:function(t,e){return{u_camera_to_center_distance:new ta.Uniform1f(t,e.u_camera_to_center_distance),u_scale_with_map:new ta.Uniform1i(t,e.u_scale_with_map),u_pitch_with_map:new ta.Uniform1i(t,e.u_pitch_with_map),u_extrude_scale:new ta.Uniform2f(t,e.u_extrude_scale),u_device_pixel_ratio:new ta.Uniform1f(t,e.u_device_pixel_ratio),u_matrix:new ta.UniformMatrix4f(t,e.u_matrix)}},collisionBox:hr,collisionCircle:hr,debug:function(t,e){return{u_color:new ta.UniformColor(t,e.u_color),u_matrix:new ta.UniformMatrix4f(t,e.u_matrix)}},clippingMask:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix)}},heatmap:function(t,e){return{u_extrude_scale:new ta.Uniform1f(t,e.u_extrude_scale),u_intensity:new ta.Uniform1f(t,e.u_intensity),u_matrix:new ta.UniformMatrix4f(t,e.u_matrix)}},heatmapTexture:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_world:new ta.Uniform2f(t,e.u_world),u_image:new ta.Uniform1i(t,e.u_image),u_color_ramp:new ta.Uniform1i(t,e.u_color_ramp),u_opacity:new ta.Uniform1f(t,e.u_opacity)}},hillshade:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_image:new ta.Uniform1i(t,e.u_image),u_latrange:new ta.Uniform2f(t,e.u_latrange),u_light:new ta.Uniform2f(t,e.u_light),u_shadow:new ta.UniformColor(t,e.u_shadow),u_highlight:new ta.UniformColor(t,e.u_highlight),u_accent:new ta.UniformColor(t,e.u_accent)}},hillshadePrepare:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_image:new ta.Uniform1i(t,e.u_image),u_dimension:new ta.Uniform2f(t,e.u_dimension),u_zoom:new ta.Uniform1f(t,e.u_zoom),u_maxzoom:new ta.Uniform1f(t,e.u_maxzoom)}},line:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_ratio:new ta.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ta.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new ta.Uniform2f(t,e.u_units_to_pixels)}},lineGradient:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_ratio:new ta.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ta.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new ta.Uniform2f(t,e.u_units_to_pixels),u_image:new ta.Uniform1i(t,e.u_image)}},linePattern:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_texsize:new ta.Uniform2f(t,e.u_texsize),u_ratio:new ta.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ta.Uniform1f(t,e.u_device_pixel_ratio),u_image:new ta.Uniform1i(t,e.u_image),u_units_to_pixels:new ta.Uniform2f(t,e.u_units_to_pixels),u_scale:new ta.Uniform4f(t,e.u_scale),u_fade:new ta.Uniform1f(t,e.u_fade)}},lineSDF:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_ratio:new ta.Uniform1f(t,e.u_ratio),u_device_pixel_ratio:new ta.Uniform1f(t,e.u_device_pixel_ratio),u_units_to_pixels:new ta.Uniform2f(t,e.u_units_to_pixels),u_patternscale_a:new ta.Uniform2f(t,e.u_patternscale_a),u_patternscale_b:new ta.Uniform2f(t,e.u_patternscale_b),u_sdfgamma:new ta.Uniform1f(t,e.u_sdfgamma),u_image:new ta.Uniform1i(t,e.u_image),u_tex_y_a:new ta.Uniform1f(t,e.u_tex_y_a),u_tex_y_b:new ta.Uniform1f(t,e.u_tex_y_b),u_mix:new ta.Uniform1f(t,e.u_mix)}},raster:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_tl_parent:new ta.Uniform2f(t,e.u_tl_parent),u_scale_parent:new ta.Uniform1f(t,e.u_scale_parent),u_buffer_scale:new ta.Uniform1f(t,e.u_buffer_scale),u_fade_t:new ta.Uniform1f(t,e.u_fade_t),u_opacity:new ta.Uniform1f(t,e.u_opacity),u_image0:new ta.Uniform1i(t,e.u_image0),u_image1:new ta.Uniform1i(t,e.u_image1),u_brightness_low:new ta.Uniform1f(t,e.u_brightness_low),u_brightness_high:new ta.Uniform1f(t,e.u_brightness_high),u_saturation_factor:new ta.Uniform1f(t,e.u_saturation_factor),u_contrast_factor:new ta.Uniform1f(t,e.u_contrast_factor),u_spin_weights:new ta.Uniform3f(t,e.u_spin_weights)}},symbolIcon:function(t,e){return{u_is_size_zoom_constant:new ta.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new ta.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new ta.Uniform1f(t,e.u_size_t),u_size:new ta.Uniform1f(t,e.u_size),u_camera_to_center_distance:new ta.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new ta.Uniform1f(t,e.u_pitch),u_rotate_symbol:new ta.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new ta.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new ta.Uniform1f(t,e.u_fade_change),u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new ta.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new ta.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new ta.Uniform1f(t,e.u_is_text),u_pitch_with_map:new ta.Uniform1i(t,e.u_pitch_with_map),u_texsize:new ta.Uniform2f(t,e.u_texsize),u_texture:new ta.Uniform1i(t,e.u_texture)}},symbolSDF:function(t,e){return{u_is_size_zoom_constant:new ta.Uniform1i(t,e.u_is_size_zoom_constant),u_is_size_feature_constant:new ta.Uniform1i(t,e.u_is_size_feature_constant),u_size_t:new ta.Uniform1f(t,e.u_size_t),u_size:new ta.Uniform1f(t,e.u_size),u_camera_to_center_distance:new ta.Uniform1f(t,e.u_camera_to_center_distance),u_pitch:new ta.Uniform1f(t,e.u_pitch),u_rotate_symbol:new ta.Uniform1i(t,e.u_rotate_symbol),u_aspect_ratio:new ta.Uniform1f(t,e.u_aspect_ratio),u_fade_change:new ta.Uniform1f(t,e.u_fade_change),u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_label_plane_matrix:new ta.UniformMatrix4f(t,e.u_label_plane_matrix),u_coord_matrix:new ta.UniformMatrix4f(t,e.u_coord_matrix),u_is_text:new ta.Uniform1f(t,e.u_is_text),u_pitch_with_map:new ta.Uniform1i(t,e.u_pitch_with_map),u_texsize:new ta.Uniform2f(t,e.u_texsize),u_texture:new ta.Uniform1i(t,e.u_texture),u_gamma_scale:new ta.Uniform1f(t,e.u_gamma_scale),u_device_pixel_ratio:new ta.Uniform1f(t,e.u_device_pixel_ratio),u_is_halo:new ta.Uniform1f(t,e.u_is_halo)}},background:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_opacity:new ta.Uniform1f(t,e.u_opacity),u_color:new ta.UniformColor(t,e.u_color)}},backgroundPattern:function(t,e){return{u_matrix:new ta.UniformMatrix4f(t,e.u_matrix),u_opacity:new ta.Uniform1f(t,e.u_opacity),u_image:new ta.Uniform1i(t,e.u_image),u_pattern_tl_a:new ta.Uniform2f(t,e.u_pattern_tl_a),u_pattern_br_a:new ta.Uniform2f(t,e.u_pattern_br_a),u_pattern_tl_b:new ta.Uniform2f(t,e.u_pattern_tl_b),u_pattern_br_b:new ta.Uniform2f(t,e.u_pattern_br_b),u_texsize:new ta.Uniform2f(t,e.u_texsize),u_mix:new ta.Uniform1f(t,e.u_mix),u_pattern_size_a:new ta.Uniform2f(t,e.u_pattern_size_a),u_pattern_size_b:new ta.Uniform2f(t,e.u_pattern_size_b),u_scale_a:new ta.Uniform1f(t,e.u_scale_a),u_scale_b:new ta.Uniform1f(t,e.u_scale_b),u_pixel_coord_upper:new ta.Uniform2f(t,e.u_pixel_coord_upper),u_pixel_coord_lower:new ta.Uniform2f(t,e.u_pixel_coord_lower),u_tile_units_to_pixels:new ta.Uniform1f(t,e.u_tile_units_to_pixels)}}},Pr=ta.identity(new Float32Array(16)),Dr={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},Or={symbol:function(l,t,e,i,o){if("translucent"===l.renderPass){var r=Tt.disabled,a=l.colorModeForRenderPass();0!==e.paint.get("icon-opacity").constantOr(1)&&ga(l,t,e,i,!1,e.paint.get("icon-translate"),e.paint.get("icon-translate-anchor"),e.layout.get("icon-rotation-alignment"),e.layout.get("icon-pitch-alignment"),e.layout.get("icon-keep-upright"),r,a,o),0!==e.paint.get("text-opacity").constantOr(1)&&ga(l,t,e,i,!0,e.paint.get("text-translate"),e.paint.get("text-translate-anchor"),e.layout.get("text-rotation-alignment"),e.layout.get("text-pitch-alignment"),e.layout.get("text-keep-upright"),r,a,o),t.map.showCollisionBoxes&&function(a,t,e,r){ca(a,t,e,r,!1),ca(a,t,e,r,!0)}(l,t,e,i)}},circle:function(g,t,e,i){if("translucent"===g.renderPass){var o=e.paint.get("circle-opacity"),r=e.paint.get("circle-stroke-width"),a=e.paint.get("circle-stroke-opacity");if(0!==o.constantOr(1)||0!==r.constantOr(1)&&0!==a.constantOr(1))for(var n=g.context,s=n.gl,l=g.depthModeForSublayer(0,Et.ReadOnly),c=Tt.disabled,u=g.colorModeForRenderPass(),h=0;h<i.length;h++){var y=i[h],d=t.getTile(y),x=d.getBucket(e);if(x){var f=x.programConfigurations.get(e.id);g.useProgram("circle",f).draw(n,s.TRIANGLES,l,c,u,Ct.disabled,gr(g,y,d,e),e.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,e.paint,g.transform.zoom,f)}}}},heatmap:function(t,e,i,o){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var r=t.context,a=r.gl,n=t.depthModeForSublayer(0,Et.ReadOnly),s=Tt.disabled,l=new It([a.ONE,a.ONE],ta.Color.transparent,[!0,!0,!0,!0]);!function(n,t,e){var i=n.gl;n.activeTexture.set(i.TEXTURE1),n.viewport.set([0,0,t.width/4,t.height/4]);var o=e.heatmapFbo;if(o)i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),n.bindFramebuffer.set(o.framebuffer);else{var l=i.createTexture();i.bindTexture(i.TEXTURE_2D,l),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),o=e.heatmapFbo=n.createFramebuffer(t.width/4,t.height/4),function n(t,e,i,o){var r=t.gl;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width/4,e.height/4,0,r.RGBA,t.extTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:r.UNSIGNED_BYTE,null),o.colorAttachment.set(i),t.extTextureHalfFloat&&r.checkFramebufferStatus(r.FRAMEBUFFER)!==r.FRAMEBUFFER_COMPLETE&&(t.extTextureHalfFloat=null,o.colorAttachment.setDirty(),n(t,e,i,o))}(n,t,l,o)}}(r,t,i),r.clear({color:ta.Color.transparent});for(var c=0,g;c<o.length;c++)if(g=o[c],!e.hasRenderableParent(g)){var y=e.getTile(g),p=y.getBucket(i);if(p){var d=p.programConfigurations.get(i.id),x=t.useProgram("heatmap",d),f=t.transform.zoom;x.draw(r,a.TRIANGLES,n,s,l,Ct.disabled,xr(g.posMatrix,y,f,i.paint.get("heatmap-intensity")),i.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,i.paint,t.transform.zoom,d)}}r.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,e){var i=t.context,o=i.gl,r=e.heatmapFbo;if(r){i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,r.colorAttachment.get()),i.activeTexture.set(o.TEXTURE1);var a=e.colorRampTexture;a||(a=e.colorRampTexture=new ta.Texture(i,e.colorRamp,o.RGBA)),a.bind(o.LINEAR,o.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,o.TRIANGLES,Et.disabled,Tt.disabled,t.colorModeForRenderPass(),Ct.disabled,_r(t,e,0,1),e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}}(t,i))},line:function(t,e,i,o){if("translucent"===t.renderPass){var r=i.paint.get("line-opacity"),a=i.paint.get("line-width");if(0!==r.constantOr(1)&&0!==a.constantOr(1)){var n=t.depthModeForSublayer(0,Et.ReadOnly),s=t.colorModeForRenderPass(),l=i.paint.get("line-dasharray"),c=i.paint.get("line-pattern"),u=c.constantOr(1),h=i.paint.get("line-gradient"),p=i.getCrossfadeParameters(),d=l?"lineSDF":u?"linePattern":h?"lineGradient":"line",_=t.context,f=_.gl,m=!0;if(h){_.activeTexture.set(f.TEXTURE0);var k=i.gradientTexture;if(!i.gradient)return;k||(k=i.gradientTexture=new ta.Texture(_,i.gradient,f.RGBA)),k.bind(f.LINEAR,f.CLAMP_TO_EDGE)}for(var A=0,O=o;A<O.length;A+=1){var x=O[A],b=e.getTile(x);if(!u||b.patternsLoaded()){var w=b.getBucket(i);if(w){var E=w.programConfigurations.get(i.id),T=t.context.program.get(),I=t.useProgram(d,E),C=m||I.program!==T,S=c.constantOr(null);if(S&&b.imageAtlas){var P=b.imageAtlas.patternPositions[S.to],z=b.imageAtlas.patternPositions[S.from];P&&z&&E.setConstantPatternPositions(P,z)}var L=l?Ar(t,b,i,l,p):u?Tr(t,b,i,p):h?wr(t,b,i):kr(t,b,i);l&&(C||t.lineAtlas.dirty)?(_.activeTexture.set(f.TEXTURE0),t.lineAtlas.bind(_)):u&&(_.activeTexture.set(f.TEXTURE0),b.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),E.updatePatternPaintBuffers(p)),I.draw(_,f.TRIANGLES,n,t.stencilModeForClipping(x),s,Ct.disabled,L,i.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,i.paint,t.transform.zoom,E),m=!1}}}}}},fill:function(t,e,i,o){var r=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var n=t.colorModeForRenderPass(),s=i.paint.get("fill-pattern"),l=t.opaquePassEnabledForLayer()&&!s.constantOr(1)&&1===r.constantOr(ta.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===l){var d=t.depthModeForSublayer(1,"opaque"===t.renderPass?Et.ReadWrite:Et.ReadOnly);ma(t,e,i,o,d,n,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){var c=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Et.ReadOnly);ma(t,e,i,o,c,n,!0)}}},"fill-extrusion":function(l,t,e,i){var o=e.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===l.renderPass){var r=new Et(l.context.gl.LEQUAL,Et.ReadWrite,l.depthRangeFor3D);if(1!==o||e.paint.get("fill-extrusion-pattern").constantOr(1))xa(l,t,e,i,r,Tt.disabled,It.disabled),xa(l,t,e,i,r,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var a=l.colorModeForRenderPass();xa(l,t,e,i,r,Tt.disabled,a)}}},hillshade:function(d,t,e,i){if("offscreen"===d.renderPass||"translucent"===d.renderPass){for(var o=d.context,r=t.getSource().maxzoom,a=d.depthModeForSublayer(0,Et.ReadOnly),n=Tt.disabled,s=d.colorModeForRenderPass(),l=0,g=i;l<g.length;l+=1){var u=g[l],h=t.getTile(u);h.needsHillshadePrepare&&"offscreen"===d.renderPass?wa(d,h,e,r,a,n,s):"translucent"===d.renderPass&&ka(d,h,e,a,n,s)}o.viewport.set([0,0,d.width,d.height])}},raster:function(k,t,e,i){if("translucent"===k.renderPass&&0!==e.paint.get("raster-opacity"))for(var o=k.context,r=o.gl,a=t.getSource(),n=k.useProgram("raster"),s=Tt.disabled,l=k.colorModeForRenderPass(),c=i.length&&i[0].overscaledZ,u=!k.options.moving,h=0,T=i;h<T.length;h+=1){var d=T[h],_=k.depthModeForSublayer(d.overscaledZ-c,1===e.paint.get("raster-opacity")?Et.ReadWrite:Et.ReadOnly,r.LESS),f=t.getTile(d),m=k.transform.calculatePosMatrix(d.toUnwrapped(),u);f.registerFadeDuration(e.paint.get("raster-fade-duration"));var g=t.findLoadedParent(d,0),v=Ta(f,g,t,e,k.transform),y=void 0,A=void 0,S="nearest"===e.paint.get("raster-resampling")?r.NEAREST:r.LINEAR;o.activeTexture.set(r.TEXTURE0),f.texture.bind(S,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(r.TEXTURE1),g?(g.texture.bind(S,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),y=ya(2,g.tileID.overscaledZ-f.tileID.overscaledZ),A=[f.tileID.canonical.x*y%1,f.tileID.canonical.y*y%1]):f.texture.bind(S,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST);var w=Sr(m,A||[0,0],y||1,v,e);a instanceof z?n.draw(o,r.TRIANGLES,_,s,l,Ct.disabled,w,e.id,a.boundsBuffer,k.quadTriangleIndexBuffer,a.boundsSegments):f.maskedBoundsBuffer&&f.maskedIndexBuffer&&f.segments?n.draw(o,r.TRIANGLES,_,s,l,Ct.disabled,w,e.id,f.maskedBoundsBuffer,f.maskedIndexBuffer,f.segments,e.paint,k.transform.zoom):n.draw(o,r.TRIANGLES,_,s,l,Ct.disabled,w,e.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments)}},background:function(k,t,e){var i=e.paint.get("background-color"),o=e.paint.get("background-opacity");if(0!==o){var r=k.context,a=r.gl,n=k.transform,s=n.tileSize,l=e.paint.get("background-pattern");if(!k.isPatternMissing(l)){var c=l||1!==i.a||1!==o?"translucent":"opaque";if(k.renderPass===c){var u=Tt.disabled,h=k.depthModeForSublayer(0,"opaque"==c?Et.ReadWrite:Et.ReadOnly),p=k.colorModeForRenderPass(),d=k.useProgram(l?"backgroundPattern":"background"),_=n.coveringTiles({tileSize:s});l&&(r.activeTexture.set(a.TEXTURE0),k.imageManager.bind(k.context));for(var f=e.getCrossfadeParameters(),m=0,w=_;m<w.length;m+=1){var v=w[m],y=k.transform.calculatePosMatrix(v.toUnwrapped()),x=l?Ir(y,o,k,l,{tileID:v,tileSize:s},f):Er(y,o,i);d.draw(r,a.TRIANGLES,h,u,p,Ct.disabled,x,e.id,k.tileExtentBuffer,k.quadTriangleIndexBuffer,k.tileExtentSegments)}}}}},debug:function(a,t,e){for(var r=0;r<e.length;r++)Aa(a,t,e[r])},custom:function(l,t,e){var i=l.context,o=e.implementation;if("offscreen"===l.renderPass){var r=o.prerender;r&&(l.setCustomLayerDefaults(),i.setColorMode(l.colorModeForRenderPass()),r.call(o,i.gl,l.transform.customLayerMatrix()),i.setDirty(),l.setBaseState())}else if("translucent"===l.renderPass){l.setCustomLayerDefaults(),i.setColorMode(l.colorModeForRenderPass()),i.setStencilMode(Tt.disabled);var a="3d"===o.renderingMode?new Et(l.context.gl.LEQUAL,Et.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,Et.ReadOnly);i.setDepthMode(a),o.render(i.gl,l.transform.customLayerMatrix()),i.setDirty(),l.setBaseState(),i.bindFramebuffer.set(null)}}},Rr=function(t,e){this.context=new St(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=Pt.maxUnderzooming+Pt.maxOverzooming+1,this.depthEpsilon=1/ya(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new ta.ProgramConfiguration,this.crossTileSymbolIndex=new Za};Rr.prototype.resize=function(t,e){var i=this.context.gl;if(this.width=t*ta.browser.devicePixelRatio,this.height=e*ta.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,l=this.style._order,a;o<l.length;o+=1)a=l[o],this.style._layers[a].resize();this.depthRbo&&(i.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Rr.prototype.setup=function(){var t=this.context,e=new ta.StructArrayLayout2i4;e.emplaceBack(0,0),e.emplaceBack(ta.EXTENT,0),e.emplaceBack(0,ta.EXTENT),e.emplaceBack(ta.EXTENT,ta.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(e,Be.members),this.tileExtentSegments=ta.SegmentVector.simpleSegment(0,0,4,2);var i=new ta.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(ta.EXTENT,0),i.emplaceBack(0,ta.EXTENT),i.emplaceBack(ta.EXTENT,ta.EXTENT),this.debugBuffer=t.createVertexBuffer(i,Be.members),this.debugSegments=ta.SegmentVector.simpleSegment(0,0,4,5);var o=new ta.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(ta.EXTENT,0,ta.EXTENT,0),o.emplaceBack(0,ta.EXTENT,0,ta.EXTENT),o.emplaceBack(ta.EXTENT,ta.EXTENT,ta.EXTENT,ta.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(o,ta.rasterBoundsAttributes.members),this.rasterBoundsSegments=ta.SegmentVector.simpleSegment(0,0,4,2);var r=new ta.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(1,0),r.emplaceBack(0,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,Be.members),this.viewportSegments=ta.SegmentVector.simpleSegment(0,0,4,2);var a=new ta.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(a);var n=new ta.StructArrayLayout3ui6;n.emplaceBack(0,1,2),n.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(n);var s=this.context.gl;this.stencilClearMode=new Tt({func:s.ALWAYS,mask:0},0,255,s.ZERO,s.ZERO,s.ZERO)},Rr.prototype.clearStencil=function(){var t=this.context,e=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var a=ta.create();ta.ortho(a,0,this.width,this.height,0,0,1),ta.scale(a,a,[e.drawingBufferWidth,e.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,e.TRIANGLES,Et.disabled,this.stencilClearMode,It.disabled,Ct.disabled,fr(a),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Rr.prototype._renderTileClippingMasks=function(d,t){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&t&&t.length){this.currentStencilSource=d.source;var e=this.context,i=e.gl;256<this.nextStencilID+t.length&&this.clearStencil(),e.setColorMode(It.disabled),e.setDepthMode(Et.disabled);var o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var r=0,c=t;r<c.length;r+=1){var n=c[r],s=this._tileClippingMaskIDs[n.key]=this.nextStencilID++;o.draw(e,i.TRIANGLES,Et.disabled,new Tt({func:i.ALWAYS,mask:0},s,255,i.KEEP,i.KEEP,i.REPLACE),It.disabled,Ct.disabled,fr(n.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Rr.prototype.stencilModeFor3D=function(){256<this.nextStencilID+1&&this.clearStencil();var a=this.nextStencilID++,t=this.context.gl;return new Tt({func:t.NOTEQUAL,mask:255},a,255,t.KEEP,t.KEEP,t.REPLACE)},Rr.prototype.stencilModeForClipping=function(a){var t=this.context.gl;return new Tt({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,t.KEEP,t.KEEP,t.REPLACE)},Rr.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new It([t.CONSTANT_COLOR,t.ONE],new ta.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?It.unblended:It.alphaBlended},Rr.prototype.depthModeForSublayer=function(a,t,e){if(!this.opaquePassEnabledForLayer())return Et.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new Et(e||this.context.gl.LEQUAL,t,[r,r])},Rr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Rr.prototype.render=function(t,e){this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(ta.browser.now()),this.imageManager.beginFrame();var i=this.style._order,o=this.style.sourceCaches;for(var r in o){var a=o[r];a.used&&a.prepare(this.context)}var n={},s={},l={};for(var c in o){var u=o[c];n[c]=u.getVisibleCoordinates(),s[c]=n[c].slice().reverse(),l[c]=u.getVisibleCoordinates(!0).reverse()}for(var h in o){var p=o[h],d=p.getSource();if("raster"===d.type||"raster-dem"===d.type){for(var _=[],f=0,k=n[h],g;f<k.length;f+=1)g=k[f],_.push(p.getTile(g));sa(_,this.context)}}this.opaquePassCutoff=1/0;for(var A=0,O;A<i.length;A++)if(O=i[A],this.style._layers[O].is3D()){this.opaquePassCutoff=A;break}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var R=0,j=i;R<j.length;R+=1){var w=j[R],E=this.style._layers[w];if(E.hasOffscreenPass()&&!E.isHidden(this.transform.zoom)){var T=s[E.source];("custom"===E.type||T.length)&&this.renderLayer(this,o[E.source],E,T)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:e.showOverdrawInspector?ta.Color.black:ta.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=e.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=i.length-1;0<=this.currentLayer;this.currentLayer--){var I=this.style._layers[i[this.currentLayer]],C=o[I.source],S=n[I.source];this._renderTileClippingMasks(I,S),this.renderLayer(this,C,I,S)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var P=this.style._layers[i[this.currentLayer]],z=o[P.source],L=("symbol"===P.type?l:s)[P.source];this._renderTileClippingMasks(P,n[P.source]),this.renderLayer(this,z,P,L)}if(this.options.showTileBoundaries)for(var D in o){Or.debug(this,o[D],n[D]);break}this.context.setDefault()},Rr.prototype.setupOffscreenDepthRenderbuffer=function(){var e=this.context;this.depthRbo||(this.depthRbo=e.createRenderbuffer(e.gl.DEPTH_COMPONENT16,this.width,this.height))},Rr.prototype.renderLayer=function(a,t,e,r){e.isHidden(this.transform.zoom)||("background"===e.type||"custom"===e.type||r.length)&&(this.id=e.id,Or[e.type](a,t,e,r,this.style.placement.variableOffsets))},Rr.prototype.translatePosMatrix=function(t,e,i,d,r){if(!i[0]&&!i[1])return t;var a=r?"map"===d?this.transform.angle:0:"viewport"===d?-this.transform.angle:0;if(a){var n=De(a),s=R(a);i=[i[0]*s-i[1]*n,i[0]*n+i[1]*s]}var l=[r?i[0]:le(e,i[0],this.transform.zoom),r?i[1]:le(e,i[1],this.transform.zoom),0],c=new Float32Array(16);return ta.translate(c,t,l),c},Rr.prototype.saveTileTexture=function(a){var t=this._tileTextures[a.size[0]];t?t.push(a):this._tileTextures[a.size[0]]=[a]},Rr.prototype.getTileTexture=function(a){var t=this._tileTextures[a];return t&&0<t.length?t.pop():null},Rr.prototype.isPatternMissing=function(a){if(!a)return!1;var t=this.imageManager.getPattern(a.from),e=this.imageManager.getPattern(a.to);return!t||!e},Rr.prototype.useProgram=function(a,t){void 0===t&&(t=this.emptyProgramConfiguration),this.cache=this.cache||{};var r=""+a+(t.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new nr(this.context,or[a],t,zr[a],this._showOverdrawInspector)),this.cache[r]},Rr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Rr.prototype.setBaseState=function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)};var Mr=function(t,e,a){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===a||a,this._minZoom=t||0,this._maxZoom=e||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ta.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},jr={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Mr.prototype.clone=function(){var e=new Mr(this._minZoom,this._maxZoom,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._calcMatrices(),e},jr.minZoom.get=function(){return this._minZoom},jr.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=va(this.zoom,e))},jr.maxZoom.get=function(){return this._maxZoom},jr.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=ea(this.zoom,e))},jr.renderWorldCopies.get=function(){return this._renderWorldCopies},jr.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},jr.worldSize.get=function(){return this.tileSize*this.scale},jr.centerPoint.get=function(){return this.size._div(2)},jr.size.get=function(){return new ta.Point(this.width,this.height)},jr.bearing.get=function(){return 180*(-this.angle/Pe)},jr.bearing.set=function(t){var e=-ta.wrap(t,-180,180)*Pe/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=ta.create$2(),ta.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},jr.pitch.get=function(){return 180*(this._pitch/Pe)},jr.pitch.set=function(t){var e=ta.clamp(t,0,60)/180*Pe;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())},jr.fov.get=function(){return 180*(this._fov/Pe)},jr.fov.set=function(e){e=va(.01,ea(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Pe,this._calcMatrices())},jr.zoom.get=function(){return this._zoom},jr.zoom.set=function(a){var t=ea(va(a,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=ba(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},jr.center.get=function(){return this._center},jr.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},Mr.prototype.coveringZoomLevel=function(e){return(e.roundZoom?V:ba)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize))},Mr.prototype.getVisibleUnwrappedCoordinates=function(t){var e=[new ta.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new ta.Point(0,0)),o=this.pointCoordinate(new ta.Point(this.width,0)),r=this.pointCoordinate(new ta.Point(this.width,this.height)),a=this.pointCoordinate(new ta.Point(0,this.height)),n=ba(ea(i.x,o.x,r.x,a.x)),s=ba(va(i.x,o.x,r.x,a.x)),l=n-1;l<=s+1;l++)0!=l&&e.push(new ta.UnwrappedTileID(l,t));return e},Mr.prototype.coveringTiles=function(t){var e=this.coveringZoomLevel(t),l=e;if(void 0!==t.minzoom&&e<t.minzoom)return[];void 0!==t.maxzoom&&e>t.maxzoom&&(e=t.maxzoom);var o=ta.MercatorCoordinate.fromLngLat(this.center),r=ya(2,e),a=new ta.Point(r*o.x-.5,r*o.y-.5);return function(t,e,d,o){function i(e,r,i){var n,l,s,m;if(0<=i&&i<=g)for(n=e;n<r;n++)l=ba(n/g),s=(n%g+g)%g,0!==l&&!0!==o||(m=new ta.OverscaledTileID(d,l,t,s,i),a[m.key]=m)}void 0===o&&(o=!0);var g=1<<t,a={},n=e.map(function(t){return new ta.Point(t.x,t.y)._mult(g)});return La(n[0],n[1],n[2],0,g,i),La(n[2],n[3],n[0],0,g,i),Object.keys(a).map(function(e){return a[e]})}(e,[this.pointCoordinate(new ta.Point(0,0)),this.pointCoordinate(new ta.Point(this.width,0)),this.pointCoordinate(new ta.Point(this.width,this.height)),this.pointCoordinate(new ta.Point(0,this.height))],t.reparseOverscaled?l:e,this._renderWorldCopies).sort(function(r,t){return a.dist(r.canonical)-a.dist(t.canonical)})},Mr.prototype.resize=function(a,t){this.width=a,this.height=t,this.pixelsToGLUnits=[2/a,-2/t],this._constrain(),this._calcMatrices()},jr.unmodified.get=function(){return this._unmodified},Mr.prototype.zoomScale=function(e){return ya(2,e)},Mr.prototype.scaleZoom=function(e){return P(e)/E},Mr.prototype.project=function(t){var e=ta.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new ta.Point(ta.mercatorXfromLng(t.lng)*this.worldSize,ta.mercatorYfromLat(e)*this.worldSize)},Mr.prototype.unproject=function(t){return new ta.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},jr.point.get=function(){return this.project(this.center)},Mr.prototype.setLocationAtPoint=function(t,e){var i=this.pointCoordinate(e),o=this.pointCoordinate(this.centerPoint),r=this.locationCoordinate(t),a=new ta.MercatorCoordinate(r.x-(i.x-o.x),r.y-(i.y-o.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},Mr.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},Mr.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},Mr.prototype.locationCoordinate=function(t){return ta.MercatorCoordinate.fromLngLat(t)},Mr.prototype.coordinateLocation=function(e){return e.toLngLat()},Mr.prototype.pointCoordinate=function(t){var e=[t.x,t.y,0,1],i=[t.x,t.y,1,1];ta.transformMat4(e,e,this.pixelMatrixInverse),ta.transformMat4(i,i,this.pixelMatrixInverse);var o=e[3],r=i[3],a=e[0]/o,n=i[0]/r,s=e[1]/o,l=i[1]/r,d=e[2]/o,c=i[2]/r,u=d==c?0:(0-d)/(c-d);return new ta.MercatorCoordinate(ta.number(a,n,u)/this.worldSize,ta.number(s,l,u)/this.worldSize)},Mr.prototype.coordinatePoint=function(t){var e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return ta.transformMat4(e,e,this.pixelMatrix),new ta.Point(e[0]/e[3],e[1]/e[3])},Mr.prototype.getBounds=function(){return new ta.LngLatBounds().extend(this.pointLocation(new ta.Point(0,0))).extend(this.pointLocation(new ta.Point(this.width,0))).extend(this.pointLocation(new ta.Point(this.width,this.height))).extend(this.pointLocation(new ta.Point(0,this.height)))},Mr.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new ta.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Mr.prototype.setMaxBounds=function(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Mr.prototype.calculatePosMatrix=function(t,e){void 0===e&&(e=!1);var d=t.key,o=e?this._alignedPosMatrixCache:this._posMatrixCache;if(o[d])return o[d];var r=t.canonical,a=this.worldSize/this.zoomScale(r.z),n=r.x+ya(2,r.z)*t.wrap,s=ta.identity(new Float64Array(16));return ta.translate(s,s,[n*a,r.y*a,0]),ta.scale(s,s,[a/ta.EXTENT,a/ta.EXTENT,1]),ta.multiply(s,e?this.alignedProjMatrix:this.projMatrix,s),o[d]=new Float32Array(s),o[d]},Mr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Mr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t=-90,y=90,x=-180,b=180,k=this.size,c=this._unmodified,u,w,T,A;if(this.latRange){var S=this.latRange;t=ta.mercatorYfromLat(S[1])*this.worldSize,u=(y=ta.mercatorYfromLat(S[0])*this.worldSize)-t<k.y?k.y/(y-t):0}if(this.lngRange){var h=this.lngRange;x=ta.mercatorXfromLng(h[0])*this.worldSize,w=(b=ta.mercatorXfromLng(h[1])*this.worldSize)-x<k.x?k.x/(b-x):0}var p=this.point,d=va(w||0,u||0);if(d)return this.center=this.unproject(new ta.Point(w?(b+x)/2:p.x,u?(y+t)/2:p.y)),this.zoom+=this.scaleZoom(d),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var _=p.y,f=k.y/2;_-f<t&&(A=t+f),_+f>y&&(A=y-f)}if(this.lngRange){var m=p.x,g=k.x/2;m-g<x&&(T=x+g),m+g>b&&(T=b-g)}void 0===T&&void 0===A||(this.center=this.unproject(new ta.Point(void 0===T?p.x:T,void 0===A?p.y:A))),this._unmodified=c,this._constraining=!1}},Mr.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/fa(this._fov/2)*this.height;var t=this._fov/2,e=Pe/2+this._pitch,i=De(t)*this.cameraToCenterDistance/De(Pe-e-t),o=this.point,r=o.x,a=o.y,n=1.01*(R(Pe/2-this._pitch)*i+this.cameraToCenterDistance),s=new Float64Array(16);ta.perspective(s,this._fov,this.width/this.height,1,n),ta.scale(s,s,[1,-1,1]),ta.translate(s,s,[0,0,-this.cameraToCenterDistance]),ta.rotateX(s,s,this._pitch),ta.rotateZ(s,s,this.angle),ta.translate(s,s,[-r,-a,0]),this.mercatorMatrix=ta.scale([],s,[this.worldSize,this.worldSize,this.worldSize]),ta.scale(s,s,[1,1,ta.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=s;var g=this.width%2/2,c=this.height%2/2,u=R(this.angle),h=De(this.angle),p=r-V(r)+u*g+h*c,d=a-V(a)+u*c+h*g,m=new Float64Array(s);if(ta.translate(m,m,[.5<p?p-1:p,.5<d?d-1:d,0]),this.alignedProjMatrix=m,s=ta.create(),ta.scale(s,s,[this.width/2,-this.height/2,1]),ta.translate(s,s,[1,-1,0]),this.labelPlaneMatrix=s,s=ta.create(),ta.scale(s,s,[1,-1,1]),ta.translate(s,s,[-1,-1,0]),ta.scale(s,s,[2/this.width,2/this.height,1]),this.glCoordMatrix=s,this.pixelMatrix=ta.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(s=ta.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=s,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Mr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new ta.Point(0,0)),e=[t.x*this.worldSize,t.y*this.worldSize,0,1];return ta.transformMat4(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance},Mr.prototype.getCameraPoint=function(){var t=this._pitch,e=fa(t)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new ta.Point(0,e))},Mr.prototype.getCameraQueryGeometry=function(t){var e=this.getCameraPoint();if(1===t.length)return[t[0],e];for(var i=e.x,d=e.y,p=e.x,u=e.y,g=0,h=t,l;g<h.length;g+=1)l=h[g],i=ea(i,l.x),d=ea(d,l.y),p=va(p,l.x),u=va(u,l.y);return[new ta.Point(i,d),new ta.Point(p,d),new ta.Point(p,u),new ta.Point(i,u),new ta.Point(i,d)]},Object.defineProperties(Mr.prototype,jr);var Fr=function(){var t,n,l,s,d;ta.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(t=this._updateHashUnthrottled.bind(this),n=300,l=!1,s=null,d=function(){s=null,l&&(t(),s=setTimeout(d,n),l=!1)},function(){return l=!0,s||d(),s})};Fr.prototype.addTo=function(t){return this._map=t,ta.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Fr.prototype.remove=function(){return ta.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Fr.prototype.getHashString=function(d){var t=this._map.getCenter(),e=V(100*this._map.getZoom())/100,i=M((e*E+P(512/360/.5))/I),o=ya(10,i),r=V(t.lng*o)/o,a=V(t.lat*o)/o,n=this._map.getBearing(),s=this._map.getPitch(),l="";return l+=d?"#/"+r+"/"+a+"/"+e:"#"+e+"/"+a+"/"+r,(n||s)&&(l+="/"+V(10*n)/10),s&&(l+="/"+V(s)),l},Fr.prototype._onHashChange=function(){var t=ta.window.location.hash.replace("#","").split("/");return 3<=t.length&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},Fr.prototype._updateHashUnthrottled=function(){var t=this.getHashString();try{ta.window.history.replaceState(ta.window.history.state,"",t)}catch(e){}};var Br=function(t){function e(e,o,r,a){void 0===a&&(a={});var i=Ma.mousePos(o.getCanvasContainer(),r),s=o.unproject(i);t.call(this,e,ta.extend({point:i,lngLat:s,originalEvent:r},a)),this._defaultPrevented=!1,this.target=o}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var a={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,a),e}(ta.Event),Nr=function(t){function e(e,o,r){var a=Ma.touchPos(o.getCanvasContainer(),r),i=a.map(function(e){return o.unproject(e)}),n=a.reduce(function(a,t,e,r){return a.add(t.div(r.length))},new ta.Point(0,0)),l=o.unproject(n);t.call(this,e,{points:a,point:n,lngLats:i,lngLat:l,originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var a={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,a),e}(ta.Event),Vr=function(a){function t(t,e,r){a.call(this,t,{originalEvent:r}),this._defaultPrevented=!1}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={defaultPrevented:{configurable:!0}};return t.prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(ta.Event),Ur=function(t){this._map=t,this._el=t.getCanvasContainer(),this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,ta.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ur.prototype.setZoomRate=function(e){this._defaultZoomRate=e},Ur.prototype.setWheelZoomRate=function(e){this._wheelZoomRate=e},Ur.prototype.isEnabled=function(){return!!this._enabled},Ur.prototype.isActive=function(){return!!this._active},Ur.prototype.isZooming=function(){return!!this._zooming},Ur.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},Ur.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ur.prototype.onWheel=function(t){if(this.isEnabled()){var e=t.deltaMode===ta.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,a=ta.browser.now(),o=a-(this._lastWheelEventTime||0);this._lastWheelEventTime=a,0!==e&&0==e%4.000244140625?this._type="wheel":0!==e&&4>_a(e)?this._type="trackpad":400<o?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=200>_a(o*e)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this.isActive()||this._start(t)),t.preventDefault()}},Ur.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(e)},Ur.prototype._start=function(t){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0,this._map.fire(new ta.Event("movestart",{originalEvent:t})),this._map.fire(new ta.Event("zoomstart",{originalEvent:t}))),this._finishTimeout&&clearTimeout(this._finishTimeout);var e=Ma.mousePos(this._el,t);this._around=ta.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(e)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},Ur.prototype._onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){var e=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&4.000244140625<_a(this._delta)?this._wheelZoomRate:this._defaultZoomRate,o=2/(1+m(-_a(this._delta*i)));0>this._delta&&0!=o&&(o=1/o);var d="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=ea(e.maxZoom,va(e.minZoom,e.scaleZoom(d*o))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:e.zoom,n=this._startZoom,s=this._easing,l=!1;if("wheel"===this._type&&n&&s){var p=ea((ta.browser.now()-this._lastWheelEventTime)/200,1),u=s(p);e.zoom=ta.number(n,a,u),1>p?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):l=!0}else e.zoom=a,l=!0;e.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new ta.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new ta.Event("zoom",{originalEvent:this._lastWheelEvent})),l&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._zooming=!1,t._map.fire(new ta.Event("zoomend",{originalEvent:t._lastWheelEvent})),t._map.fire(new ta.Event("moveend",{originalEvent:t._lastWheelEvent})),delete t._targetZoom},200))}},Ur.prototype._smoothOutEasing=function(t){var e=ta.ease;if(this._prevEase){var l=this._prevEase,o=(ta.browser.now()-l.start)/l.duration,r=l.easing(o+.01)-l.easing(o),a=.01*(.27/N(r*r+1e-4)),n=N(.0729-a*a);e=ta.bezier(a,n,.25,1)}return this._prevEase={start:ta.browser.now(),duration:t,easing:e},e};var Hr=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1,ta.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};Hr.prototype.isEnabled=function(){return!!this._enabled},Hr.prototype.isActive=function(){return!!this._active},Hr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Hr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Hr.prototype.onMouseDown=function(t){this.isEnabled()&&t.shiftKey&&0===t.button&&(ta.window.document.addEventListener("mousemove",this._onMouseMove,!1),ta.window.document.addEventListener("keydown",this._onKeyDown,!1),ta.window.document.addEventListener("mouseup",this._onMouseUp,!1),Ma.disableDrag(),this._startPos=this._lastPos=Ma.mousePos(this._el,t),this._active=!0)},Hr.prototype._onMouseMove=function(i){var t=Ma.mousePos(this._el,i);if(!(this._lastPos.equals(t)||!this._box&&t.dist(this._startPos)<this._clickTolerance)){var e=this._startPos;this._lastPos=t,this._box||(this._box=Ma.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));var o=ea(e.x,t.x),r=va(e.x,t.x),a=ea(e.y,t.y),n=va(e.y,t.y);Ma.setTransform(this._box,"translate("+o+"px,"+a+"px)"),this._box.style.width=r-o+"px",this._box.style.height=n-a+"px"}},Hr.prototype._onMouseUp=function(t){if(0===t.button){var e=this._startPos,a=Ma.mousePos(this._el,t);this._finish(),Ma.suppressClick(),e.x===a.x&&e.y===a.y?this._fireEvent("boxzoomcancel",t):this._map.fitScreenCoordinates(e,a,this._map.getBearing(),{linear:!0}).fire(new ta.Event("boxzoomend",{originalEvent:t}))}},Hr.prototype._onKeyDown=function(e){27===e.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",e))},Hr.prototype._finish=function(){this._active=!1,ta.window.document.removeEventListener("mousemove",this._onMouseMove,!1),ta.window.document.removeEventListener("keydown",this._onKeyDown,!1),ta.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Ma.remove(this._box),this._box=null),Ma.enableDrag(),delete this._startPos,delete this._lastPos},Hr.prototype._fireEvent=function(t,e){return this._map.fire(new ta.Event(t,{originalEvent:e}))};var Gr=ta.bezier(0,0,.25,1),qr=function(t,e){this._map=t,this._el=e.element||t.getCanvasContainer(),this._state="disabled",this._button=e.button||"right",this._bearingSnap=e.bearingSnap||0,this._pitchWithRotate=!1!==e.pitchWithRotate,ta.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};qr.prototype.isEnabled=function(){return"disabled"!==this._state},qr.prototype.isActive=function(){return"active"===this._state},qr.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},qr.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled";}},qr.prototype.onMouseDown=function(t){if("enabled"===this._state){if("right"!==this._button){if(t.ctrlKey||0!==Ma.mouseButton(t))return;this._eventButton=0}else if(this._eventButton=Ma.mouseButton(t),this._eventButton!==(t.ctrlKey?0:2))return;Ma.disableDrag(),ta.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),ta.window.document.addEventListener("mouseup",this._onMouseUp),ta.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[ta.browser.now(),this._map.getBearing()]],this._startPos=this._lastPos=Ma.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault()}},qr.prototype._onMouseMove=function(a){var t=Ma.mousePos(this._el,a);this._lastPos.equals(t)||(this._lastMoveEvent=a,this._lastPos=t,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",a),this._fireEvent("movestart",a),this._pitchWithRotate&&this._fireEvent("pitchstart",a)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},qr.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform,i=this._startPos,o=this._lastPos,r=.8*(i.x-o.x),a=-.5*(i.y-o.y),n=e.bearing-r,s=e.pitch-a,l=this._inertia,d=l[l.length-1];this._drainInertiaBuffer(),l.push([ta.browser.now(),this._map._normalizeBearing(n,d[1])]),e.bearing=n,this._pitchWithRotate&&(this._fireEvent("pitch",t),e.pitch=s),this._fireEvent("rotate",t),this._fireEvent("move",t),delete this._lastMoveEvent,this._startPos=this._lastPos}},qr.prototype._onMouseUp=function(e){if(Ma.mouseButton(e)===this._eventButton)switch(this._state){case"active":this._state="enabled",Ma.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(e);break;case"pending":this._state="enabled",this._unbind();}},qr.prototype._onBlur=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",e),this._pitchWithRotate&&this._fireEvent("pitchend",e),this._fireEvent("moveend",e);break;case"pending":this._state="enabled",this._unbind();}},qr.prototype._unbind=function(){ta.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),ta.window.document.removeEventListener("mouseup",this._onMouseUp),ta.window.removeEventListener("blur",this._onBlur),Ma.enableDrag()},qr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},qr.prototype._inertialRotate=function(g){var t=this;this._fireEvent("rotateend",g),this._drainInertiaBuffer();var e=this._map,i=e.getBearing(),o=this._inertia,r=function(){_a(i)<t._bearingSnap?e.resetNorth({noMoveStart:!0},{originalEvent:g}):t._fireEvent("moveend",g),t._pitchWithRotate&&t._fireEvent("pitchend",g)};if(2>o.length)r();else{var a=o[0],n=o[o.length-1],s=o[o.length-2],l=e._normalizeBearing(i,s[1]),m=n[1]-a[1],u=0>m?-1:1,h=(n[0]-a[0])/1e3;if(0!=m&&0!=h){var p=_a(m*(.25/h));180<p&&(p=180);var y=p/180;l+=u*p*(y/2),_a(e._normalizeBearing(l,0))<this._bearingSnap&&(l=e._normalizeBearing(0,l)),e.rotateTo(l,{duration:1e3*y,easing:Gr,noMoveStart:!0},{originalEvent:g})}else r()}},qr.prototype._fireEvent=function(t,e){return this._map.fire(new ta.Event(t,e?{originalEvent:e}:{}))},qr.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=ta.browser.now();0<t.length&&160<e-t[0][0];)t.shift()};var Yr=ta.bezier(0,0,.3,1),Wr=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._state="disabled",this._clickTolerance=e.clickTolerance||1,ta.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Wr.prototype.isEnabled=function(){return"disabled"!==this._state},Wr.prototype.isActive=function(){return"active"===this._state},Wr.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},Wr.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled";}},Wr.prototype.onMouseDown=function(t){"enabled"===this._state&&(t.ctrlKey||0!==Ma.mouseButton(t)||(Ma.addEventListener(ta.window.document,"mousemove",this._onMove,{capture:!0}),Ma.addEventListener(ta.window.document,"mouseup",this._onMouseUp),this._start(t)))},Wr.prototype.onTouchStart=function(t){"enabled"===this._state&&(1<t.touches.length||(Ma.addEventListener(ta.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),Ma.addEventListener(ta.window.document,"touchend",this._onTouchEnd),this._start(t)))},Wr.prototype._start=function(t){ta.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._lastPos=Ma.mousePos(this._el,t),this._inertia=[[ta.browser.now(),this._startPos]]},Wr.prototype._onMove=function(t){t.preventDefault();var e=Ma.mousePos(this._el,t);this._lastPos.equals(e)||"pending"===this._state&&e.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=t,this._lastPos=e,this._drainInertiaBuffer(),this._inertia.push([ta.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",t),this._fireEvent("movestart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Wr.prototype._onDragFrame=function(){this._frameId=null;var a=this._lastMoveEvent;if(a){var t=this._map.transform;t.setLocationAtPoint(t.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",a),this._fireEvent("move",a),this._startPos=this._lastPos,delete this._lastMoveEvent}},Wr.prototype._onMouseUp=function(e){if(0===Ma.mouseButton(e))switch(this._state){case"active":this._state="enabled",Ma.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind();}},Wr.prototype._onTouchEnd=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind();}},Wr.prototype._onBlur=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",e),this._fireEvent("moveend",e);break;case"pending":this._state="enabled",this._unbind();}},Wr.prototype._unbind=function(){Ma.removeEventListener(ta.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),Ma.removeEventListener(ta.window.document,"touchend",this._onTouchEnd),Ma.removeEventListener(ta.window.document,"mousemove",this._onMove,{capture:!0}),Ma.removeEventListener(ta.window.document,"mouseup",this._onMouseUp),Ma.removeEventListener(ta.window,"blur",this._onBlur)},Wr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._mouseDownPos,delete this._lastPos},Wr.prototype._inertialPan=function(d){this._fireEvent("dragend",d),this._drainInertiaBuffer();var t=this._inertia;if(2>t.length)this._fireEvent("moveend",d);else{var e=t[t.length-1],i=t[0],o=e[1].sub(i[1]),r=(e[0]-i[0])/1e3;if(0==r||e[1].equals(i[1]))this._fireEvent("moveend",d);else{var a=o.mult(.3/r),n=a.mag();1400<n&&(n=1400,a._unit()._mult(n));var p=n/750,l=a.mult(-p/2);this._map.panBy(l,{duration:1e3*p,easing:Yr,noMoveStart:!0},{originalEvent:d})}}},Wr.prototype._fireEvent=function(t,e){return this._map.fire(new ta.Event(t,e?{originalEvent:e}:{}))},Wr.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=ta.browser.now();0<t.length&&160<e-t[0][0];)t.shift()};var Xr=function(t){this._map=t,this._el=t.getCanvasContainer(),ta.bindAll(["_onKeyDown"],this)};Xr.prototype.isEnabled=function(){return!!this._enabled},Xr.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Xr.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Xr.prototype._onKeyDown=function(d){if(!(d.altKey||d.ctrlKey||d.metaKey)){var t=0,c=0,p=0,u=0,g=0;switch(d.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:d.shiftKey?c=-1:(d.preventDefault(),u=-1);break;case 39:d.shiftKey?c=1:(d.preventDefault(),u=1);break;case 38:d.shiftKey?p=1:(d.preventDefault(),g=-1);break;case 40:d.shiftKey?p=-1:(g=1,d.preventDefault());break;default:return;}var h=this._map,n=h.getZoom(),s={duration:300,delayEndEvents:500,easing:Ea,zoom:t?V(n)+t*(d.shiftKey?2:1):n,bearing:h.getBearing()+15*c,pitch:h.getPitch()+10*p,offset:[100*-u,100*-g],center:h.getCenter()};h.easeTo(s,{originalEvent:d})}};var Zr=function(t){this._map=t,ta.bindAll(["_onDblClick","_onZoomEnd"],this)};Zr.prototype.isEnabled=function(){return!!this._enabled},Zr.prototype.isActive=function(){return!!this._active},Zr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Zr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zr.prototype.onTouchStart=function(n){var t=this;if(this.isEnabled()&&!(1<n.points.length))if(this._tapped){var e=n.points[0],i=this._tappedPoint;if(i&&30>=i.dist(e)){n.originalEvent.preventDefault();var o=function(){t._tapped&&t._zoom(n),t._map.off("touchcancel",r),t._resetTapped()},r=function(){t._map.off("touchend",o),t._resetTapped()};this._map.once("touchend",o),this._map.once("touchcancel",r)}else this._resetTapped()}else this._tappedPoint=n.points[0],this._tapped=setTimeout(function(){t._tapped=null,t._tappedPoint=null},300)},Zr.prototype._resetTapped=function(){clearTimeout(this._tapped),this._tapped=null,this._tappedPoint=null},Zr.prototype.onDblClick=function(e){this.isEnabled()&&(e.originalEvent.preventDefault(),this._zoom(e))},Zr.prototype._zoom=function(e){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(e.originalEvent.shiftKey?-1:1),{around:e.lngLat},e)},Zr.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var Kr=ta.bezier(0,0,.15,1),Jr=function(t){this._map=t,this._el=t.getCanvasContainer(),ta.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Jr.prototype.isEnabled=function(){return!!this._enabled},Jr.prototype.enable=function(e){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)},Jr.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Jr.prototype.disableRotation=function(){this._rotationDisabled=!0},Jr.prototype.enableRotation=function(){this._rotationDisabled=!1},Jr.prototype.onStart=function(t){if(this.isEnabled()&&2===t.touches.length){var e=Ma.mousePos(this._el,t.touches[0]),o=Ma.mousePos(this._el,t.touches[1]),r=e.add(o).div(2);this._startVec=e.sub(o),this._startAround=this._map.transform.pointLocation(r),this._gestureIntent=void 0,this._inertia=[],Ma.addEventListener(ta.window.document,"touchmove",this._onMove,{passive:!1}),Ma.addEventListener(ta.window.document,"touchend",this._onEnd)}},Jr.prototype._getTouchEventData=function(a){var t=Ma.mousePos(this._el,a.touches[0]),e=Ma.mousePos(this._el,a.touches[1]),o=t.sub(e);return{vec:o,center:t.add(e).div(2),scale:o.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*o.angleWith(this._startVec)/Pe}},Jr.prototype._onMove=function(t){if(2===t.touches.length){var e=this._getTouchEventData(t),i=e.vec,o=e.scale,r=e.bearing;if(!this._gestureIntent){var a=this._rotationDisabled&&1!==o||.15<_a(1-o);10<_a(r)?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new ta.Event(this._gestureIntent+"start",{originalEvent:t})),this._map.fire(new ta.Event("movestart",{originalEvent:t})),this._startVec=i)}this._lastTouchEvent=t,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),t.preventDefault()}},Jr.prototype._onTouchFrame=function(){this._frameId=null;var t=this._gestureIntent;if(t){var e=this._map.transform;this._startScale||(this._startScale=e.scale,this._startBearing=e.bearing);var i=this._getTouchEventData(this._lastTouchEvent),o=i.center,r=i.bearing,a=i.scale,n=e.pointLocation(o),s=e.locationPoint(n);"rotate"===t&&(e.bearing=this._startBearing+r),e.zoom=e.scaleZoom(this._startScale*a),e.setLocationAtPoint(this._startAround,s),this._map.fire(new ta.Event(t,{originalEvent:this._lastTouchEvent})),this._map.fire(new ta.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([ta.browser.now(),a,o])}},Jr.prototype._onEnd=function(t){Ma.removeEventListener(ta.window.document,"touchmove",this._onMove,{passive:!1}),Ma.removeEventListener(ta.window.document,"touchend",this._onEnd);var e=this._gestureIntent,o=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,e){this._map.fire(new ta.Event(e+"end",{originalEvent:t})),this._drainInertiaBuffer();var r=this._inertia,a=this._map;if(2>r.length)a.snapToNorth({},{originalEvent:t});else{var i=r[r.length-1],n=r[0],l=a.transform.scaleZoom(o*i[1]),s=a.transform.scaleZoom(o*n[1]),c=(i[0]-n[0])/1e3,p=i[2];if(0!=c&&l!==s){var d=.15*(l-s)/c;2.5<_a(d)&&(d=0<d?2.5:-2.5);var u=1e3*_a(d/(.15*12)),g=l+d*u/2e3;0>g&&(g=0),a.easeTo({zoom:g,duration:u,easing:Kr,around:this._aroundCenter?a.getCenter():a.unproject(p),noMoveStart:!0},{originalEvent:t})}else a.snapToNorth({},{originalEvent:t})}}},Jr.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=ta.browser.now();2<t.length&&160<e-t[0][0];)t.shift()};var Qr={scrollZoom:Ur,boxZoom:Hr,dragRotate:qr,dragPan:Wr,keyboard:Xr,doubleClickZoom:Zr,touchZoomRotate:Jr},$r=function(t){function e(e,a){t.call(this),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=a.bearingSnap,ta.bindAll(["_renderFrameCallback"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCenter=function(){return new ta.LngLat(this.transform.center.lng,this.transform.center.lat)},e.prototype.setCenter=function(a,t){return this.jumpTo({center:a},t)},e.prototype.panBy=function(t,a,r){return t=ta.Point.convert(t).mult(-1),this.panTo(this.transform.center,ta.extend({offset:t},a),r)},e.prototype.panTo=function(t,e,a){return this.easeTo(ta.extend({center:t},e),a)},e.prototype.getZoom=function(){return this.transform.zoom},e.prototype.setZoom=function(a,t){return this.jumpTo({zoom:a},t),this},e.prototype.zoomTo=function(t,e,a){return this.easeTo(ta.extend({zoom:t},e),a)},e.prototype.zoomIn=function(a,t){return this.zoomTo(this.getZoom()+1,a,t),this},e.prototype.zoomOut=function(a,t){return this.zoomTo(this.getZoom()-1,a,t),this},e.prototype.getBearing=function(){return this.transform.bearing},e.prototype.setBearing=function(a,t){return this.jumpTo({bearing:a},t),this},e.prototype.rotateTo=function(t,e,a){return this.easeTo(ta.extend({bearing:t},e),a)},e.prototype.resetNorth=function(t,e){return this.rotateTo(0,ta.extend({duration:1e3},t),e),this},e.prototype.snapToNorth=function(a,t){return _a(this.getBearing())<this._bearingSnap?this.resetNorth(a,t):this},e.prototype.getPitch=function(){return this.transform.pitch},e.prototype.setPitch=function(a,t){return this.jumpTo({pitch:a},t),this},e.prototype.cameraForBounds=function(t,a){return t=ta.LngLatBounds.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,a)},e.prototype._cameraForBoxAndBearing=function(t,e,i,o){if("number"==typeof(o=ta.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){var b=o.padding;o.padding={top:b,bottom:b,right:b,left:b}}if(ta.deepEqual(Object.keys(o.padding).sort(function(a,t){return a<t?-1:a>t?1:0}),["bottom","left","right","top"])){var a=this.transform,n=a.project(ta.LngLat.convert(t)),s=a.project(ta.LngLat.convert(e)),l=n.rotate(-i*Pe/180),c=s.rotate(-i*Pe/180),u=new ta.Point(va(l.x,c.x),va(l.y,c.y)),h=new ta.Point(ea(l.x,c.x),ea(l.y,c.y)),p=u.sub(h),d=(a.width-o.padding.left-o.padding.right)/p.x,_=(a.height-o.padding.top-o.padding.bottom)/p.y;if(!(0>_||0>d)){var f=ea(a.scaleZoom(a.scale*ea(d,_)),o.maxZoom),m=ta.Point.convert(o.offset),g=(o.padding.left-o.padding.right)/2,v=(o.padding.top-o.padding.bottom)/2,y=new ta.Point(m.x+g,m.y+v).mult(a.scale/a.zoomScale(f));return{center:a.unproject(n.add(s).div(2).sub(y)),zoom:f,bearing:i}}ta.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else ta.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},e.prototype.fitBounds=function(a,t,e){return this._fitInternal(this.cameraForBounds(a,t),t,e)},e.prototype.fitScreenCoordinates=function(t,e,i,o,r){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(ta.Point.convert(t)),this.transform.pointLocation(ta.Point.convert(e)),i,o),o,r)},e.prototype._fitInternal=function(t,e,a){return t?(e=ta.extend(t,e)).linear?this.easeTo(e,a):this.flyTo(e,a):this},e.prototype.jumpTo=function(t,e){this.stop();var i=this.transform,o=!1,l=!1,s=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(o=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=ta.LngLat.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(l=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(s=!0,i.pitch=+t.pitch),this.fire(new ta.Event("movestart",e)).fire(new ta.Event("move",e)),o&&this.fire(new ta.Event("zoomstart",e)).fire(new ta.Event("zoom",e)).fire(new ta.Event("zoomend",e)),l&&this.fire(new ta.Event("rotatestart",e)).fire(new ta.Event("rotate",e)).fire(new ta.Event("rotateend",e)),s&&this.fire(new ta.Event("pitchstart",e)).fire(new ta.Event("pitch",e)).fire(new ta.Event("pitchend",e)),this.fire(new ta.Event("moveend",e))},e.prototype.easeTo=function(t,b){var i=this;this.stop(),!1===(t=ta.extend({offset:[0,0],duration:500,easing:ta.ease},t)).animate&&(t.duration=0);var o=this.transform,r=this.getZoom(),a=this.getBearing(),n=this.getPitch(),s="zoom"in t?+t.zoom:r,l="bearing"in t?this._normalizeBearing(t.bearing,a):a,c="pitch"in t?+t.pitch:n,u=o.centerPoint.add(ta.Point.convert(t.offset)),h=o.pointLocation(u),p=ta.LngLat.convert(t.center||h);this._normalizeCenter(p);var k=o.project(h),m=o.project(p).sub(k),g=o.zoomScale(s-r),v,w;return t.around&&(v=ta.LngLat.convert(t.around),w=o.locationPoint(v)),this._zooming=s!==r,this._rotating=a!==l,this._pitching=c!==n,this._prepareEase(b,t.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(t){if(i._zooming&&(o.zoom=ta.number(r,s,t)),i._rotating&&(o.bearing=ta.number(a,l,t)),i._pitching&&(o.pitch=ta.number(n,c,t)),v)o.setLocationAtPoint(v,w);else{var e=o.zoomScale(o.zoom-r),p=s>r?ea(2,g):va(.5,g),d=ya(p,1-t),h=o.unproject(k.add(m.mult(t*d)).mult(e));o.setLocationAtPoint(o.renderWorldCopies?h.wrap():h,u)}i._fireMoveEvents(b)},function(){t.delayEndEvents?i._easeEndTimeoutID=setTimeout(function(){return i._afterEase(b)},t.delayEndEvents):i._afterEase(b)},t),this},e.prototype._prepareEase=function(t,e){this._moving=!0,e||this.fire(new ta.Event("movestart",t)),this._zooming&&this.fire(new ta.Event("zoomstart",t)),this._rotating&&this.fire(new ta.Event("rotatestart",t)),this._pitching&&this.fire(new ta.Event("pitchstart",t))},e.prototype._fireMoveEvents=function(t){this.fire(new ta.Event("move",t)),this._zooming&&this.fire(new ta.Event("zoom",t)),this._rotating&&this.fire(new ta.Event("rotate",t)),this._pitching&&this.fire(new ta.Event("pitch",t))},e.prototype._afterEase=function(t){var e=this._zooming,a=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,e&&this.fire(new ta.Event("zoomend",t)),a&&this.fire(new ta.Event("rotateend",t)),o&&this.fire(new ta.Event("pitchend",t)),this.fire(new ta.Event("moveend",t))},e.prototype.flyTo=function(t,k){function i(a){var t=(v*v-h*h+(a?-1:1)*w*w*y*y)/(2*(a?v:h)*w*y);return P(N(t*t+1)-t)}function T(e){return(m(e)-m(-e))/2}function A(e){return(m(e)+m(-e))/2}var C=this;this.stop(),t=ta.extend({offset:[0,0],speed:1.2,curve:1.42,easing:ta.ease},t);var o=this.transform,r=this.getZoom(),a=this.getBearing(),n=this.getPitch(),s="zoom"in t?ta.clamp(+t.zoom,o.minZoom,o.maxZoom):r,l="bearing"in t?this._normalizeBearing(t.bearing,a):a,c="pitch"in t?+t.pitch:n,u=o.zoomScale(s-r),I=o.centerPoint.add(ta.Point.convert(t.offset)),p=o.pointLocation(I),O=ta.LngLat.convert(t.center||p);this._normalizeCenter(O);var _=o.project(p),f=o.project(O).sub(_),d=t.curve,h=va(o.width,o.height),v=h/u,y=f.mag();if("minZoom"in t){var x=ta.clamp(ea(t.minZoom,r,s),o.minZoom,o.maxZoom),b=h/o.zoomScale(x-r);d=N(2*(b/y))}var w=d*d,E=i(0),S=function(e){return A(E)/A(E+d*e)},R=function(a){return h*((A(E)*(T(t=E+d*a)/A(t))-T(E))/w)/y;var t},j=(i(1)-E)/d;if(1e-6>_a(y)||!isFinite(j)){if(1e-6>_a(h-v))return this.easeTo(t,k);var F=v<h?-1:1;j=_a(P(v/h))/d,R=function(){return 0},S=function(e){return m(F*d*e)}}if("duration"in t)t.duration=+t.duration;else{var D="screenSpeed"in t?+t.screenSpeed/d:+t.speed;t.duration=1e3*j/D}return t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=a!==l,this._pitching=c!==n,this._prepareEase(k,!1),this._ease(function(t){var e=t*j,i=1/S(e);o.zoom=1===t?s:r+o.scaleZoom(i),C._rotating&&(o.bearing=ta.number(a,l,t)),C._pitching&&(o.pitch=ta.number(n,c,t));var d=1===t?O:o.unproject(_.add(f.mult(R(e))).mult(i));o.setLocationAtPoint(o.renderWorldCopies?d.wrap():d,I),C._fireMoveEvents(k)},function(){return C._afterEase(k)},t),this},e.prototype.isEasing=function(){return!!this._easeFrameId},e.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var e=this._onEaseEnd;delete this._onEaseEnd,e.call(this)}return this},e.prototype._ease=function(t,e,a){!1===a.animate||0===a.duration?(t(1),e()):(this._easeStart=ta.browser.now(),this._easeOptions=a,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},e.prototype._renderFrameCallback=function(){var t=ea((ta.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),1>t?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},e.prototype._normalizeBearing=function(t,a){t=ta.wrap(t,-180,180);var r=_a(t-a);return _a(t-360-a)<r&&(t-=360),_a(t+360-a)<r&&(t+=360),t},e.prototype._normalizeCenter=function(a){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var e=a.lng-t.center.lng;a.lng+=180<e?-360:-180>e?360:0}},e}(ta.Evented),eo=function(t){void 0===t&&(t={}),this.options=t,ta.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};eo.prototype.getDefaultPosition=function(){return"bottom-right"},eo.prototype.onAdd=function(a){var t=this.options&&this.options.compact;return this._map=a,this._container=Ma.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=Ma.create("div","mapboxgl-ctrl-attrib-inner",this._container),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},eo.prototype.onRemove=function(){Ma.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},eo.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:ta.config.ACCESS_TOKEN}];if(t){var r=a.reduce(function(r,i,e){return i.value&&(r+=i.key+"="+i.value+(e<a.length-1?"&":"")),r},"?");t.href=ta.config.FEEDBACK_URL+"/"+r+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow"}},eo.prototype._updateData=function(e){e&&("metadata"===e.sourceDataType||"style"===e.dataType)&&(this._updateAttributions(),this._updateEditLink())},eo.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(e){return"string"==typeof e?e:""})):"string"==typeof this.options.customAttribution&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var e=this._map.style.sourceCaches;for(var i in e){var o=e[i];if(o.used){var r=o.getSource();r.attribution&&0>l.indexOf(r.attribution)&&l.push(r.attribution)}}l.sort(function(a,t){return a.length-t.length});var a=(l=l.filter(function(t,e){for(var a=e+1;a<l.length;a++)if(0<=l[a].indexOf(t))return!1;return!0})).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,l.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},eo.prototype._updateCompact=function(){640>=this._map.getCanvasContainer().offsetWidth?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var to=function(){ta.bindAll(["_updateLogo"],this),ta.bindAll(["_updateCompact"],this)};to.prototype.onAdd=function(a){this._map=a,this._container=Ma.create("div","mapboxgl-ctrl");var t=Ma.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label","Mapbox logo"),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},to.prototype.onRemove=function(){Ma.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},to.prototype.getDefaultPosition=function(){return"bottom-left"},to.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},to.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var t in a)if(a[t].getSource().mapbox_logo)return!0;return!1}},to.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var t=a[0];250>this._map.getCanvasContainer().offsetWidth?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}};var ao=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ao.prototype.add=function(a){var t=++this._id;return this._queue.push({callback:a,id:t,cancelled:!1}),t},ao.prototype.remove=function(a){for(var t=this._currentlyRunning,e=0,n=t?this._queue.concat(t):this._queue,o;e<n.length;e+=1)if(o=n[e],o.id===a)return void(o.cancelled=!0)},ao.prototype.run=function(){var a=this._currentlyRunning=this._queue;this._queue=[];for(var t=0,r=a,i;t<r.length&&(i=r[t],i.cancelled||(i.callback(),!this._cleared));t+=1);this._cleared=!1,this._currentlyRunning=!1},ao.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ro=ta.window.HTMLImageElement,oo=ta.window.HTMLElement,io={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},no=function(l){function e(t){var o=this;if(null!=(t=ta.extend({},io,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than minZoom");var r=new Mr(t.minZoom,t.maxZoom,t.renderWorldCopies);if(l.call(this,r,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new ao,this._controls=[],this._mapId=ta.uniqueId(),this._requestManager=new ta.RequestManager(t.transformRequest),"string"!=typeof t.container){if(!(t.container instanceof oo))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}else if(this._container=ta.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.");if(t.maxBounds&&this.setMaxBounds(t.maxBounds),ta.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return o._update(!1)}),this.on("moveend",function(){return o._update(!1)}),this.on("zoom",function(){return o._update(!0)}),void 0!==ta.window&&(ta.window.addEventListener("online",this._onWindowOnline,!1),ta.window.addEventListener("resize",this._onWindowResize,!1)),function(l,t){var d=l.getCanvasContainer(),o=null,c=!1,e=null;for(var i in Qr)l[i]=new Qr[i](l,t),t.interactive&&t[i]&&l[i].enable(t[i]);Ma.addEventListener(d,"mouseout",function(t){l.fire(new Br("mouseout",l,t))}),Ma.addEventListener(d,"mousedown",function(a){c=!0,e=Ma.mousePos(d,a);var r=new Br("mousedown",l,a);l.fire(r),r.defaultPrevented||(t.interactive&&!l.doubleClickZoom.isActive()&&l.stop(),l.boxZoom.onMouseDown(a),l.boxZoom.isActive()||l.dragPan.isActive()||l.dragRotate.onMouseDown(a),l.boxZoom.isActive()||l.dragRotate.isActive()||l.dragPan.onMouseDown(a))}),Ma.addEventListener(d,"mouseup",function(t){var e=l.dragRotate.isActive();o&&!e&&l.fire(new Br("contextmenu",l,o)),o=null,c=!1,l.fire(new Br("mouseup",l,t))}),Ma.addEventListener(d,"mousemove",function(t){if(!l.dragPan.isActive()&&!l.dragRotate.isActive()){for(var e=t.target;e&&e!==d;)e=e.parentNode;e===d&&l.fire(new Br("mousemove",l,t))}}),Ma.addEventListener(d,"mouseover",function(t){for(var e=t.target;e&&e!==d;)e=e.parentNode;e===d&&l.fire(new Br("mouseover",l,t))}),Ma.addEventListener(d,"touchstart",function(e){var a=new Nr("touchstart",l,e);l.fire(a),a.defaultPrevented||(t.interactive&&l.stop(),l.boxZoom.isActive()||l.dragRotate.isActive()||l.dragPan.onTouchStart(e),l.touchZoomRotate.onStart(e),l.doubleClickZoom.onTouchStart(a))},{passive:!1}),Ma.addEventListener(d,"touchmove",function(t){l.fire(new Nr("touchmove",l,t))},{passive:!1}),Ma.addEventListener(d,"touchend",function(t){l.fire(new Nr("touchend",l,t))}),Ma.addEventListener(d,"touchcancel",function(t){l.fire(new Nr("touchcancel",l,t))}),Ma.addEventListener(d,"click",function(o){var r=Ma.mousePos(d,o);(r.equals(e)||r.dist(e)<t.clickTolerance)&&l.fire(new Br("click",l,o))}),Ma.addEventListener(d,"dblclick",function(t){var e=new Br("dblclick",l,t);l.fire(e),e.defaultPrevented||l.doubleClickZoom.onDblClick(e)}),Ma.addEventListener(d,"contextmenu",function(t){var e=l.dragRotate.isActive();c||e?c&&(o=t):l.fire(new Br("contextmenu",l,t)),(l.dragRotate.isEnabled()||l.listens("contextmenu"))&&t.preventDefault()}),Ma.addEventListener(d,"wheel",function(e){t.interactive&&l.stop();var a=new Vr("wheel",l,e);l.fire(a),a.defaultPrevented||l.scrollZoom.onWheel(e)},{passive:!1})}(this,t),this._hash=t.hash&&new Fr().addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,ta.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new eo({customAttribution:t.customAttribution})),this.addControl(new to,t.logoPosition),this.on("style.load",function(){o.transform.unmodified&&o.jumpTo(o.style.stylesheet)}),this.on("data",function(t){o._update("style"===t.dataType),o.fire(new ta.Event(t.dataType+"data",t))}),this.on("dataloading",function(t){o.fire(new ta.Event(t.dataType+"dataloading",t))})}l&&(e.__proto__=l),e.prototype=Object.create(l&&l.prototype),e.prototype.constructor=e;var t={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return e.prototype._getMapId=function(){return this._mapId},e.prototype.addControl=function(t,e){if(void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right"),!t||!t.onAdd)return this.fire(new ta.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var a=t.onAdd(this);this._controls.push(t);var o=this._controlPositions[e];return-1===e.indexOf("bottom")?o.appendChild(a):o.insertBefore(a,o.firstChild),this},e.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new ta.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var e=this._controls.indexOf(t);return-1<e&&this._controls.splice(e,1),t.onRemove(this),this},e.prototype.resize=function(t){var e=this._containerDimensions(),a=e[0],o=e[1];return this._resizeCanvas(a,o),this.transform.resize(a,o),this.painter.resize(a,o),this.fire(new ta.Event("movestart",t)).fire(new ta.Event("move",t)).fire(new ta.Event("resize",t)).fire(new ta.Event("moveend",t)),this},e.prototype.getBounds=function(){return this.transform.getBounds()},e.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},e.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(ta.LngLatBounds.convert(t)),this._update()},e.prototype.setMinZoom=function(e){if(0<=(e=null==e?0:e)&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},e.prototype.getMinZoom=function(){return this.transform.minZoom},e.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},e.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},e.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update()},e.prototype.getMaxZoom=function(){return this.transform.maxZoom},e.prototype.project=function(t){return this.transform.locationPoint(ta.LngLat.convert(t))},e.prototype.unproject=function(t){return this.transform.pointLocation(ta.Point.convert(t))},e.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},e.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},e.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},e.prototype.on=function(s,d,c){var i=this;if(void 0===c)return l.prototype.on.call(this,s,d);var e=function(){var e;if("mouseenter"===s||"mouseover"===s){var t=!1;return{layer:d,listener:c,delegates:{mousemove:function(e){var a=i.getLayer(d)?i.queryRenderedFeatures(e.point,{layers:[d]}):[];a.length?t||(t=!0,c.call(i,new Br(s,i,e.originalEvent,{features:a}))):t=!1},mouseout:function(){t=!1}}}}if("mouseleave"===s||"mouseout"===s){var r=!1;return{layer:d,listener:c,delegates:{mousemove:function(e){(i.getLayer(d)?i.queryRenderedFeatures(e.point,{layers:[d]}):[]).length?r=!0:r&&(r=!1,c.call(i,new Br(s,i,e.originalEvent)))},mouseout:function(t){r&&(r=!1,c.call(i,new Br(s,i,t.originalEvent)))}}}}return{layer:d,listener:c,delegates:(e={},e[s]=function(e){var t=i.getLayer(d)?i.queryRenderedFeatures(e.point,{layers:[d]}):[];t.length&&(e.features=t,c.call(i,e),delete e.features)},e)}}();for(var t in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[s]=this._delegatedListeners[s]||[],this._delegatedListeners[s].push(e),e.delegates)this.on(t,e.delegates[t]);return this},e.prototype.off=function(o,t,e){if(void 0===e)return l.prototype.off.call(this,o,t);if(this._delegatedListeners&&this._delegatedListeners[o])for(var i=this._delegatedListeners[o],r=0,d;r<i.length;r++)if(d=i[r],d.layer===t&&d.listener===e){for(var c in d.delegates)this.off(c,d.delegates[c]);return i.splice(r,1),this}return this},e.prototype.queryRenderedFeatures=function(t,n){if(!this.style)return[];var l;if(void 0!==n||void 0===t||t instanceof ta.Point||Array.isArray(t)||(n=t,t=void 0),n=n||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof ta.Point||"number"==typeof t[0])l=[ta.Point.convert(t)];else{var s=ta.Point.convert(t[0]),r=ta.Point.convert(t[1]);l=[s,new ta.Point(r.x,s.y),r,new ta.Point(s.x,r.y),s]}return this.style.queryRenderedFeatures(l,n,this.transform)},e.prototype.querySourceFeatures=function(a,t){return this.style.querySourceFeatures(a,t)},e.prototype.setStyle=function(t,e){return!1!==(e=ta.extend({},{localIdeographFontFamily:io.localIdeographFontFamily},e)).diff&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(t,e))},e.prototype._updateStyle=function(a,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),a?(this.style=new ke(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof a?this.style.loadURL(a):this.style.loadJSON(a),this):(delete this.style,this)},e.prototype._diffStyle=function(t,n){var i=this;if("string"==typeof t){var e=this._requestManager.normalizeStyleURL(t),r=this._requestManager.transformRequest(e,ta.ResourceType.Style);ta.getJSON(r,function(t,e){t?i.fire(new ta.ErrorEvent(t)):e&&i._updateDiff(e,n)})}else"object"==typeof t&&this._updateDiff(t,n)},e.prototype._updateDiff=function(t,e){try{this.style.setState(t)&&this._update(!0)}catch(a){ta.warnOnce("Unable to perform style diff: "+(a.message||a.error||a)+".  Rebuilding the style from scratch."),this._updateStyle(t,e)}},e.prototype.getStyle=function(){if(this.style)return this.style.serialize()},e.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():ta.warnOnce("There is no style added to the map.")},e.prototype.addSource=function(a,t){return this.style.addSource(a,t),this._update(!0)},e.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];return void 0===e?void this.fire(new ta.ErrorEvent(new Error("There is no source with ID '"+t+"'"))):e.loaded()},e.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var t in a){var e=a[t]._tiles;for(var i in e){var o=e[i];if("loaded"!==o.state&&"errored"!==o.state)return!1}}return!0},e.prototype.addSourceType=function(a,t,e){return this.style.addSourceType(a,t,e)},e.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0)},e.prototype.getSource=function(e){return this.style.getSource(e)},e.prototype.addImage=function(t,e,i){void 0===i&&(i={});var g=i.pixelRatio;void 0===g&&(g=1);var m=i.sdf;if(void 0===m&&(m=!1),e instanceof ro){var y=ta.browser.getImageData(e),n=y.width,s=y.height,l=y.data;this.style.addImage(t,{data:new ta.RGBAImage({width:n,height:s},l),pixelRatio:g,sdf:m,version:0})}else{if(void 0===e.width||void 0===e.height)return this.fire(new ta.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var c=e.width,u=e.height,h=e.data,p=e;this.style.addImage(t,{data:new ta.RGBAImage({width:c,height:u},new Uint8Array(h)),pixelRatio:g,sdf:m,version:0,userImage:p}),p.onAdd&&p.onAdd(this,t)}},e.prototype.updateImage=function(t,e){var i=this.style.getImage(t);if(!i)return this.fire(new ta.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var o=e instanceof ro?ta.browser.getImageData(e):e,r=o.width,a=o.height,n=o.data;if(void 0===r||void 0===a)return this.fire(new ta.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(r!==i.data.width||a!==i.data.height)return this.fire(new ta.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));i.data.replace(n,!(e instanceof ro)),this.style.updateImage(t,i)},e.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new ta.ErrorEvent(new Error("Missing required image id"))),!1)},e.prototype.removeImage=function(e){this.style.removeImage(e)},e.prototype.loadImage=function(t,e){ta.getImage(this._requestManager.transformRequest(t,ta.ResourceType.Image),e)},e.prototype.listImages=function(){return this.style.listImages()},e.prototype.addLayer=function(a,t){return this.style.addLayer(a,t),this._update(!0)},e.prototype.moveLayer=function(a,t){return this.style.moveLayer(a,t),this._update(!0)},e.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0)},e.prototype.getLayer=function(e){return this.style.getLayer(e)},e.prototype.setFilter=function(a,t,e){return void 0===e&&(e={}),this.style.setFilter(a,t,e),this._update(!0)},e.prototype.setLayerZoomRange=function(a,t,e){return this.style.setLayerZoomRange(a,t,e),this._update(!0)},e.prototype.getFilter=function(e){return this.style.getFilter(e)},e.prototype.setPaintProperty=function(a,t,e,r){return void 0===r&&(r={}),this.style.setPaintProperty(a,t,e,r),this._update(!0)},e.prototype.getPaintProperty=function(a,t){return this.style.getPaintProperty(a,t)},e.prototype.setLayoutProperty=function(a,t,e,r){return void 0===r&&(r={}),this.style.setLayoutProperty(a,t,e,r),this._update(!0)},e.prototype.getLayoutProperty=function(a,t){return this.style.getLayoutProperty(a,t)},e.prototype.setLight=function(a,t){return void 0===t&&(t={}),this.style.setLight(a,t),this._update(!0)},e.prototype.getLight=function(){return this.style.getLight()},e.prototype.setFeatureState=function(a,t){return this.style.setFeatureState(a,t),this._update()},e.prototype.removeFeatureState=function(a,t){return this.style.removeFeatureState(a,t),this._update()},e.prototype.getFeatureState=function(e){return this.style.getFeatureState(e)},e.prototype.getContainer=function(){return this._container},e.prototype.getCanvasContainer=function(){return this._canvasContainer},e.prototype.getCanvas=function(){return this._canvas},e.prototype._containerDimensions=function(){var a=0,r=0;return this._container&&(a=this._container.clientWidth||400,r=this._container.clientHeight||300),[a,r]},e.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==ta.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&ta.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},e.prototype._setupContainer=function(){var i=this._container;i.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ma.create("div","mapboxgl-canary",i)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=Ma.create("div","mapboxgl-canvas-container",i);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=Ma.create("canvas","mapboxgl-canvas",t),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var e=this._containerDimensions();this._resizeCanvas(e[0],e[1]);var o=this._controlContainer=Ma.create("div","mapboxgl-control-container",i),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(e){r[e]=Ma.create("div","mapboxgl-ctrl-"+e,o)})},e.prototype._resizeCanvas=function(t,e){var a=ta.window.devicePixelRatio||1;this._canvas.width=a*t,this._canvas.height=a*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},e.prototype._setupPainter=function(){var e=ta.extend({},Ra.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",e)||this._canvas.getContext("experimental-webgl",e);t?(this.painter=new Rr(t,this.transform),ta.webpSupported.testSupport(t)):this.fire(new ta.ErrorEvent(new Error("Failed to initialize WebGL")))},e.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new ta.Event("webglcontextlost",{originalEvent:t}))},e.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new ta.Event("webglcontextrestored",{originalEvent:t}))},e.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},e.prototype._update=function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this},e.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},e.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},e.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var t=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var n=this.transform.zoom,i=ta.browser.now();this.style.zoomHistory.update(n,i);var o=new ta.EvaluationParameters(n,{now:i,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),r=o.crossFadingFactor();1===r&&r===this._crossFadingFactor||(t=!0,this._crossFadingFactor=r),this.style.update(o)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration}),this.fire(new ta.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new ta.Event("load"))),this.style&&(this.style.hasTransitions()||t)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new ta.Event("idle")),this},e.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,a=this._controls;t<a.length;t+=1)a[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==ta.window&&(ta.window.removeEventListener("resize",this._onWindowResize,!1),ta.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),Ia(this._canvasContainer),Ia(this._controlContainer),Ia(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new ta.Event("remove"))},e.prototype.triggerRepaint=function(){var t=this;this.style&&!this._frame&&(this._frame=ta.browser.frame(function(){t._frame=null,t._render()}))},e.prototype._onWindowOnline=function(){this._update()},e.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},t.showTileBoundaries.get=function(){return!!this._showTileBoundaries},t.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},t.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},t.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())},t.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},t.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},t.repaint.get=function(){return!!this._repaint},t.repaint.set=function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())},t.vertices.get=function(){return!!this._vertices},t.vertices.set=function(e){this._vertices=e,this._update()},e.prototype._setCacheLimits=function(t,e){ta.setCacheLimits(t,e)},Object.defineProperties(e.prototype,t),e}($r),lo={showCompass:!0,showZoom:!0},so=function(t){var e=this;this.options=ta.extend({},lo,t),this._container=Ma.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this.options.showZoom&&(ta.bindAll(["_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom in",function(){return e._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom out",function(){return e._map.zoomOut()})),this.options.showCompass&&(ta.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset bearing to north",function(){return e._map.resetNorth()}),this._compassArrow=Ma.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};so.prototype._updateZoomButtons=function(){var e=this._map.getZoom();this._zoomInButton.classList.toggle("mapboxgl-ctrl-icon-disabled",e===this._map.getMaxZoom()),this._zoomOutButton.classList.toggle("mapboxgl-ctrl-icon-disabled",e===this._map.getMinZoom())},so.prototype._rotateCompassArrow=function(){var e="rotate("+this._map.transform.angle*(180/Pe)+"deg)";this._compassArrow.style.transform=e},so.prototype.onAdd=function(e){return this._map=e,this.options.showZoom&&(this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qr(e,{button:"left",element:this._compass}),Ma.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},so.prototype.onRemove=function(){Ma.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),Ma.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},so.prototype._createButton=function(a,t,e){var o=Ma.create("button",a,this._container);return o.type="button",o.title=t,o.setAttribute("aria-label",t),o.addEventListener("click",e),o};var co={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},po=function(t){function e(e,i){if(t.call(this),(e instanceof ta.window.HTMLElement||i)&&(e=ta.extend({element:e},i)),ta.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._draggable=e&&e.draggable||!1,this._state="inactive",e&&e.element)this._element=e.element,this._offset=ta.Point.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ma.create("div");var r=Ma.createNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height","41px"),r.setAttributeNS(null,"width","27px"),r.setAttributeNS(null,"viewBox","0 0 27 41");var a=Ma.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");var n=Ma.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"fill-rule","nonzero");var s=Ma.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");for(var l=0,b=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<b.length;l+=1){var u=b[l],h=Ma.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",u.rx),h.setAttributeNS(null,"ry",u.ry),s.appendChild(h)}var p=Ma.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill",this._color);var d=Ma.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),p.appendChild(d);var _=Ma.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"fill","#000000");var f=Ma.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),_.appendChild(f);var m=Ma.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");var g=Ma.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(8.0, 8.0)");var v=Ma.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#000000"),v.setAttributeNS(null,"opacity","0.25"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962");var y=Ma.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),g.appendChild(v),g.appendChild(y),n.appendChild(s),n.appendChild(p),n.appendChild(_),n.appendChild(m),n.appendChild(g),r.appendChild(n),this._element.appendChild(r),this._offset=ta.Point.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(e){e.preventDefault()}),Pa(this._element,this._anchor,"marker"),this._popup=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addTo=function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},e.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),delete this._map),Ma.remove(this._element),this._popup&&this._popup.remove(),this},e.prototype.getLngLat=function(){return this._lngLat},e.prototype.setLngLat=function(t){return this._lngLat=ta.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},e.prototype.getElement=function(){return this._element},e.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null),a){if(!("offset"in a.options)){var t=N(ya(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},e.prototype._onMapClick=function(a){var t=a.originalEvent.target,e=this._element;this._popup&&(t===e||e.contains(t))&&this.togglePopup()},e.prototype.getPopup=function(){return this._popup},e.prototype.togglePopup=function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this},e.prototype._update=function(e){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=za(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),e&&"moveend"!==e.type||(this._pos=this._pos.round()),Ma.setTransform(this._element,co[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"))},e.prototype.getOffset=function(){return this._offset},e.prototype.setOffset=function(t){return this._offset=ta.Point.convert(t),this._update(),this},e.prototype._onMove=function(t){this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new ta.Event("dragstart"))),this.fire(new ta.Event("drag"))},e.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new ta.Event("dragend")),this._state="inactive"},e.prototype._addDragHandler=function(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},e.prototype.setDraggable=function(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},e.prototype.isDraggable=function(){return this._draggable},e}(ta.Evented),uo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},go=function(t){function e(e){t.call(this),this.options=ta.extend({},uo,e),ta.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onAdd=function(t){var e;return this._map=t,this._container=Ma.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),e=this._setupUI,void 0===yo?void 0===ta.window.navigator.permissions?(yo=!!ta.window.navigator.geolocation,e(yo)):ta.window.navigator.permissions.query({name:"geolocation"}).then(function(a){yo="denied"!==a.state,e(yo)}):e(yo),this._container},e.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(ta.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),Ma.remove(this._container),this._map=void 0},e.prototype._onSuccess=function(t){if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new ta.Event("geolocate",t)),this._finish()},e.prototype._updateCamera=function(t){var e=new ta.LngLat(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,o=this._map.getBearing(),r=ta.extend({bearing:o},this.options.fitBoundsOptions);this._map.fitBounds(e.toBounds(i),r,{geolocateSource:!0})},e.prototype._updateMarker=function(e){e?this._userLocationDotMarker.setLngLat([e.coords.longitude,e.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},e.prototype._onError=function(t){if(this.options.trackUserLocation)if(1===t.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new ta.Event("error",t)),this._finish()},e.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},e.prototype._setupUI=function(t){var a=this;!1===t?ta.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible."):(this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this._geolocateButton=Ma.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ma.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new po(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==a._watchState||(a._watchState="BACKGROUND",a._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),a._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),a.fire(new ta.Event("trackuserlocationend")))}))},e.prototype.trigger=function(){if(!this._setup)return ta.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new ta.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new ta.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new ta.Event("trackuserlocationstart"));}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=ta.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else ta.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},e.prototype._clearWatch=function(){ta.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},e}(ta.Evented),ho={maxWidth:100,unit:"metric"},mo=function(t){this.options=ta.extend({},ho,t),ta.bindAll(["_onMove","setUnit"],this)},yo;mo.prototype.getDefaultPosition=function(){return"bottom-left"},mo.prototype._onMove=function(){Da(this._map,this._container,this.options)},mo.prototype.onAdd=function(e){return this._map=e,this._container=Ma.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},mo.prototype.onRemove=function(){Ma.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},mo.prototype.setUnit=function(e){this.options.unit=e,Da(this._map,this._container,this.options)};var fo=function(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof ta.window.HTMLElement?this._container=t.container:ta.warnOnce("Full screen control 'container' must be a DOM element.")),ta.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in ta.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in ta.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in ta.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in ta.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};fo.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ma.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",ta.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},fo.prototype.onRemove=function(){Ma.remove(this._controlContainer),this._map=null,ta.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},fo.prototype._checkFullscreenSupport=function(){return!!(ta.window.document.fullscreenEnabled||ta.window.document.mozFullScreenEnabled||ta.window.document.msFullscreenEnabled||ta.window.document.webkitFullscreenEnabled)},fo.prototype._setupUI=function(){(this._fullscreenButton=Ma.create("button",this._className+"-icon "+this._className+"-fullscreen",this._controlContainer)).type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),ta.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},fo.prototype._updateTitle=function(){var e=this._isFullscreen()?"Exit fullscreen":"Enter fullscreen";this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e},fo.prototype._isFullscreen=function(){return this._fullscreen},fo.prototype._changeIcon=function(){(ta.window.document.fullscreenElement||ta.window.document.mozFullScreenElement||ta.window.document.webkitFullscreenElement||ta.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"),this._updateTitle())},fo.prototype._onClickFullscreen=function(){this._isFullscreen()?ta.window.document.exitFullscreen?ta.window.document.exitFullscreen():ta.window.document.mozCancelFullScreen?ta.window.document.mozCancelFullScreen():ta.window.document.msExitFullscreen?ta.window.document.msExitFullscreen():ta.window.document.webkitCancelFullScreen&&ta.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var xo={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},_o=function(t){function e(e){t.call(this),this.options=ta.extend(Object.create(xo),e),ta.bindAll(["_update","_onClickClose","remove"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addTo=function(t){var e=this;return this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",function(a){e._update(a.point)}),this._map.on("mouseup",function(a){e._update(a.point)}),this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new ta.Event("open")),this},e.prototype.isOpen=function(){return!!this._map},e.prototype.remove=function(){return this._content&&Ma.remove(this._content),this._container&&(Ma.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),this._map.off("remove",this.remove),this._map.off("mousemove"),delete this._map),this.fire(new ta.Event("close")),this},e.prototype.getLngLat=function(){return this._lngLat},e.prototype.setLngLat=function(t){return this._lngLat=ta.LngLat.convert(t),this._pos=null,this._map&&(this._map.on("move",this._update),this._map.off("mousemove"),this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this._trackPointer=!1,this._update(),this},e.prototype.trackPointer=function(){var a=this;return this._trackPointer=!0,this._pos=null,this._map&&(this._map.off("move",this._update),this._map.on("mousemove",function(t){a._update(t.point)}),this._map.on("drag",function(t){a._update(t.point)}),this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},e.prototype.getElement=function(){return this._container},e.prototype.setText=function(t){return this.setDOMContent(ta.window.document.createTextNode(t))},e.prototype.setHTML=function(t){var e=ta.window.document.createDocumentFragment(),a=ta.window.document.createElement("body"),r;for(a.innerHTML=t;r=a.firstChild;)e.appendChild(r);return this.setDOMContent(e)},e.prototype.getMaxWidth=function(){return this._container.style.maxWidth},e.prototype.setMaxWidth=function(e){return this.options.maxWidth=e,this._update(),this},e.prototype.setDOMContent=function(e){return this._createContent(),this._content.appendChild(e),this._update(),this},e.prototype._createContent=function(){this._content&&Ma.remove(this._content),this._content=Ma.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=Ma.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},e.prototype._update=function(t){var e=this,o=this._lngLat||this._trackPointer;if(this._map&&o&&this._content&&(this._container||(this._container=Ma.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Ma.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(a){return e._container.classList.add(a)})),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=za(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var r=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),a=this.options.anchor,i=function t(e){if(e){if("number"==typeof e){var a=V(N(.5*ya(e,2)));return{center:new ta.Point(0,0),top:new ta.Point(0,e),"top-left":new ta.Point(a,a),"top-right":new ta.Point(-a,a),bottom:new ta.Point(0,-e),"bottom-left":new ta.Point(a,-a),"bottom-right":new ta.Point(-a,-a),left:new ta.Point(e,0),right:new ta.Point(-e,0)}}if(e instanceof ta.Point||Array.isArray(e)){var o=ta.Point.convert(e);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:ta.Point.convert(e.center||[0,0]),top:ta.Point.convert(e.top||[0,0]),"top-left":ta.Point.convert(e["top-left"]||[0,0]),"top-right":ta.Point.convert(e["top-right"]||[0,0]),bottom:ta.Point.convert(e.bottom||[0,0]),"bottom-left":ta.Point.convert(e["bottom-left"]||[0,0]),"bottom-right":ta.Point.convert(e["bottom-right"]||[0,0]),left:ta.Point.convert(e.left||[0,0]),right:ta.Point.convert(e.right||[0,0])}}return t(new ta.Point(0,0))}(this.options.offset);if(!a){var s=this._container.offsetWidth,d=this._container.offsetHeight,c;c=r.y+i.bottom.y<d?["top"]:r.y>this._map.transform.height-d?["bottom"]:[],r.x<s/2?c.push("left"):r.x>this._map.transform.width-s/2&&c.push("right"),a=0===c.length?"bottom":c.join("-")}var p=r.add(i[a]).round();Ma.setTransform(this._container,co[a]+" translate("+p.x+"px,"+p.y+"px)"),Pa(this._container,a,"popup")}},e.prototype._onClickClose=function(){this.remove()},e}(ta.Evented),bo={version:ta.version,supported:Ra,setRTLTextPlugin:ta.setRTLTextPlugin,Map:no,NavigationControl:so,GeolocateControl:go,AttributionControl:eo,ScaleControl:mo,FullscreenControl:fo,Popup:_o,Marker:po,Style:ke,LngLat:ta.LngLat,LngLatBounds:ta.LngLatBounds,Point:ta.Point,MercatorCoordinate:ta.MercatorCoordinate,Evented:ta.Evented,config:ta.config,get accessToken(){return ta.config.ACCESS_TOKEN},set accessToken(t){ta.config.ACCESS_TOKEN=t},get baseApiUrl(){return ta.config.API_URL},set baseApiUrl(t){ta.config.API_URL=t},get workerCount(){return zt.workerCount},set workerCount(e){zt.workerCount=e},get maxParallelImageRequests(){return ta.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){ta.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){ta.clearTileCache(t)},workerUrl:""};return bo}),r})},{}],427:[function(e,t){"use strict";function a(e,t,a){for(var r=Array(e),o=0;o<e;++o)r[o]=0,o===t&&(r[o]+=.5),o===a&&(r[o]+=.5);return r}function r(e,t){if(0===t||t===(1<<e+1)-1)return[];for(var r=[],n=[],l=0;l<=e;++l)if(t&1<<l){r.push(a(e,l-1,l-1)),n.push(null);for(var s=0;s<=e;++s)~t&1<<s&&(r.push(a(e,l-1,s-1)),n.push([l,s]))}var d=o(r),c=[];i_loop:for(var l=0;l<d.length;++l){for(var p=d[l],u=[],s=0;s<p.length;++s){if(!n[p[s]])continue i_loop;u.push(n[p[s]].slice())}c.push(u)}return c}t.exports=function(e){for(var t=1<<e+1,a=Array(t),o=0;o<t;++o)a[o]=r(e,o);return a};var o=e("convex-hull")},{"convex-hull":130}],428:[function(e,t){function a(e,t,a){var r=t[0],o=t[1],i=t[2],n=t[3];return e[0]=a[0]*r+a[4]*o+a[8]*i+a[12]*n,e[1]=a[1]*r+a[5]*o+a[9]*i+a[13]*n,e[2]=a[2]*r+a[6]*o+a[10]*i+a[14]*n,e[3]=a[3]*r+a[7]*o+a[11]*i+a[15]*n,e}function r(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function o(e,t,a,r,o){e[0]=t[0]*r+a[0]*o,e[1]=t[1]*r+a[1]*o,e[2]=t[2]*r+a[2]*o}var n=e("./normalize"),l=e("gl-mat4/create"),s=e("gl-mat4/clone"),d=e("gl-mat4/determinant"),c=e("gl-mat4/invert"),p=e("gl-mat4/transpose"),u={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")},g=l(),h=l(),m=[0,0,0,0],y=[[0,0,0],[0,0,0],[0,0,0]],f=[0,0,0];t.exports=function(e,t,l,x,_,b){if(t||(t=[0,0,0]),l||(l=[0,0,0]),x||(x=[0,0,0]),_||(_=[0,0,0,1]),b||(b=[0,0,0,1]),!n(g,e))return!1;if(s(h,g),h[3]=0,h[7]=0,h[11]=0,h[15]=1,_a(1e-8>d(h)))return!1;var v=g[3],k=g[7],w=g[11],T=g[12],A=g[13],S=g[14],C=g[15];if(0!==v||0!==k||0!==w){m[0]=v,m[1]=k,m[2]=w,m[3]=C;var L=c(h,h);if(!L)return!1;p(h,h),a(_,m,h)}else _[0]=_[1]=_[2]=0,_[3]=1;if(t[0]=T,t[1]=A,t[2]=S,r(y,g),l[0]=u.length(y[0]),u.normalize(y[0],y[0]),x[0]=u.dot(y[0],y[1]),o(y[1],y[1],y[0],1,-x[0]),l[1]=u.length(y[1]),u.normalize(y[1],y[1]),x[0]/=l[1],x[1]=u.dot(y[0],y[2]),o(y[2],y[2],y[0],1,-x[1]),x[2]=u.dot(y[1],y[2]),o(y[2],y[2],y[1],1,-x[2]),l[2]=u.length(y[2]),u.normalize(y[2],y[2]),x[1]/=l[2],x[2]/=l[2],u.cross(f,y[1],y[2]),0>u.dot(y[0],f))for(var E=0;3>E;E++)l[E]*=-1,y[E][0]*=-1,y[E][1]*=-1,y[E][2]*=-1;return b[0]=.5*N(va(1+y[0][0]-y[1][1]-y[2][2],0)),b[1]=.5*N(va(1-y[0][0]+y[1][1]-y[2][2],0)),b[2]=.5*N(va(1-y[0][0]-y[1][1]+y[2][2],0)),b[3]=.5*N(va(1+y[0][0]+y[1][1]+y[2][2],0)),y[2][1]>y[1][2]&&(b[0]=-b[0]),y[0][2]>y[2][0]&&(b[1]=-b[1]),y[1][0]>y[0][1]&&(b[2]=-b[2]),!0}},{"./normalize":429,"gl-mat4/clone":259,"gl-mat4/create":260,"gl-mat4/determinant":261,"gl-mat4/invert":265,"gl-mat4/transpose":276,"gl-vec3/cross":334,"gl-vec3/dot":339,"gl-vec3/length":349,"gl-vec3/normalize":356}],429:[function(e,t){t.exports=function(e,t){var a=t[15];if(0===a)return!1;for(var r=0;16>r;r++)e[r]=t[r]*(1/a);return!0}},{}],430:[function(e,t){function a(){return{translate:r(),scale:r(1),skew:r(),perspective:o(),quaternion:o()}}function r(e){return[e||0,e||0,e||0]}function o(){return[0,0,0,1]}var i=e("gl-vec3/lerp"),n=e("mat4-recompose"),l=e("mat4-decompose"),s=e("gl-mat4/determinant"),d=e("quat-slerp"),c=a(),p=a(),u=a();t.exports=function(e,t,a,r){if(0===s(t)||0===s(a))return!1;var o=l(t,c.translate,c.scale,c.skew,c.perspective,c.quaternion),g=l(a,p.translate,p.scale,p.skew,p.perspective,p.quaternion);return!!(o&&g)&&(i(u.translate,c.translate,p.translate,r),i(u.skew,c.skew,p.skew,r),i(u.scale,c.scale,p.scale,r),i(u.perspective,c.perspective,p.perspective,r),d(u.quaternion,c.quaternion,p.quaternion,r),n(e,u.translate,u.scale,u.skew,u.perspective,u.quaternion),!0)}},{"gl-mat4/determinant":261,"gl-vec3/lerp":350,"mat4-decompose":428,"mat4-recompose":431,"quat-slerp":483}],431:[function(e,t){var a={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")},r=a.create(),o=a.create();t.exports=function(e,t,r,i,n,l){return a.identity(e),a.fromRotationTranslation(e,l,t),e[3]=n[0],e[7]=n[1],e[11]=n[2],e[15]=n[3],a.identity(o),0!==i[2]&&(o[9]=i[2],a.multiply(e,e,o)),0!==i[1]&&(o[9]=0,o[8]=i[1],a.multiply(e,e,o)),0!==i[0]&&(o[8]=0,o[4]=i[0],a.multiply(e,e,o)),a.scale(e,e,r),e}},{"gl-mat4/create":260,"gl-mat4/fromRotationTranslation":263,"gl-mat4/identity":264,"gl-mat4/multiply":267,"gl-mat4/scale":274,"gl-mat4/translate":275}],432:[function(e,t){"use strict";t.exports=Math.log2||function(e){return P(e)*Math.LOG2E}},{}],433:[function(e,t){"use strict";function a(e){this._components=e.slice(),this._time=[0],this.prevMatrix=e.slice(),this.nextMatrix=e.slice(),this.computedMatrix=e.slice(),this.computedInverse=e.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-Infinity,1/0]}var r=e("binary-search-bounds"),o=e("mat4-interpolate"),n=e("gl-mat4/invert"),l=e("gl-mat4/rotateX"),s=e("gl-mat4/rotateY"),d=e("gl-mat4/rotateZ"),c=e("gl-mat4/lookAt"),p=e("gl-mat4/translate"),u=e("gl-mat4/scale"),g=e("gl-vec3/normalize"),h=[0,0,0];t.exports=function(e){e=e||{};var t=e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new a(t)};var y=a.prototype;y.recalcMatrix=function(e){var t=this._time,a=r.le(t,e),l=this.computedMatrix;if(!(0>a)){var s=this._components;if(a===t.length-1)for(var d=16*a,c=0;16>c;++c)l[c]=s[d++];else{for(var p=t[a+1]-t[a],d=16*a,u=this.prevMatrix,h=!0,c=0;16>c;++c)u[c]=s[d++];for(var y=this.nextMatrix,c=0;16>c;++c)y[c]=s[d++],h=h&&u[c]===y[c];if(1e-6>p||h)for(var c=0;16>c;++c)l[c]=u[c];else o(l,u,y,(e-t[a])/p)}var f=this.computedUp;f[0]=l[1],f[1]=l[5],f[2]=l[9],g(f,f);var x=this.computedInverse;n(x,l);var _=this.computedEye,b=x[15];_[0]=x[12]/b,_[1]=x[13]/b,_[2]=x[14]/b;for(var v=this.computedCenter,k=m(this.computedRadius[0]),c=0;3>c;++c)v[c]=_[c]-l[2+4*c]*k}},y.idle=function(e){if(!(e<this.lastT())){for(var t=this._components,a=t.length-16,r=0;16>r;++r)t.push(t[a++]);this._time.push(e)}},y.flush=function(e){var t=r.gt(this._time,e)-2;0>t||(this._time.splice(0,t),this._components.splice(0,16*t))},y.lastT=function(){return this._time[this._time.length-1]},y.lookAt=function(e,t,a,r){this.recalcMatrix(e),t=t||this.computedEye,a=a||h,r=r||this.computedUp,this.setMatrix(e,c(this.computedMatrix,t,a,r));for(var o=0,n=0;3>n;++n)o+=ya(a[n]-t[n],2);o=P(N(o)),this.computedRadius[0]=o},y.rotate=function(e,t,a,r){this.recalcMatrix(e);var o=this.computedInverse;t&&s(o,o,t),a&&l(o,o,a),r&&d(o,o,r),this.setMatrix(e,n(this.computedMatrix,o))};var f=[0,0,0];y.pan=function(e,t,a,r){f[0]=-(t||0),f[1]=-(a||0),f[2]=-(r||0),this.recalcMatrix(e);var o=this.computedInverse;p(o,o,f),this.setMatrix(e,n(o,o))},y.translate=function(e,t,a,r){f[0]=t||0,f[1]=a||0,f[2]=r||0,this.recalcMatrix(e);var o=this.computedMatrix;p(o,o,f),this.setMatrix(e,o)},y.setMatrix=function(e,t){if(!(e<this.lastT())){this._time.push(e);for(var a=0;16>a;++a)this._components.push(t[a])}},y.setDistance=function(e,t){this.computedRadius[0]=t},y.setDistanceLimits=function(e,t){var a=this._limits;a[0]=e,a[1]=t},y.getDistanceLimits=function(e){var t=this._limits;return e?(e[0]=t[0],e[1]=t[1],e):t}},{"binary-search-bounds":91,"gl-mat4/invert":265,"gl-mat4/lookAt":266,"gl-mat4/rotateX":271,"gl-mat4/rotateY":272,"gl-mat4/rotateZ":273,"gl-mat4/scale":274,"gl-mat4/translate":275,"gl-vec3/normalize":356,"mat4-interpolate":430}],434:[function(e,t){"use strict";t.exports=function(e){var t=e.length;if(3>t){for(var r=Array(t),o=0;o<t;++o)r[o]=o;return 2===t&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:r}for(var n=Array(t),o=0;o<t;++o)n[o]=o;n.sort(function(t,a){var r=e[t][0]-e[a][0];return r?r:e[t][1]-e[a][1]});for(var l=[n[0],n[1]],s=[n[0],n[1]],o=2;o<t;++o){for(var d=n[o],c=e[d],p=l.length;1<p&&0>=a(e[l[p-2]],e[l[p-1]],c);)p-=1,l.pop();for(l.push(d),p=s.length;1<p&&0<=a(e[s[p-2]],e[s[p-1]],c);)p-=1,s.pop();s.push(d)}for(var r=Array(s.length+l.length-2),u=0,o=0,g=l.length;o<g;++o)r[u++]=l[o];for(var h=s.length-2;0<h;--h)r[u++]=s[h];return r};var a=e("robust-orientation")[3]},{"robust-orientation":510}],435:[function(e,t){"use strict";t.exports=function(e,t){function r(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==f.alt,f.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==f.shift,f.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==f.control,f.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==f.meta,f.meta=!!e.metaKey),t}function o(e,o){var i=a.x(o),n=a.y(o);"buttons"in o&&(e=0|o.buttons),(e!==g||i!==h||n!==m||r(o))&&(g=0|e,h=i||0,m=n||0,t&&t(g,h,m,f))}function i(e){o(0,e)}function n(){(g||h||m||f.shift||f.alt||f.meta||f.control)&&(h=m=0,g=0,f.shift=f.alt=f.control=f.meta=!1,t&&t(0,0,0,f))}function l(e){r(e)&&t&&t(g,h,m,f)}function s(e){0===a.buttons(e)?o(0,e):o(g,e)}function d(e){o(g|a.buttons(e),e)}function c(e){o(g&~a.buttons(e),e)}function p(){_||(_=!0,e.addEventListener("mousemove",s),e.addEventListener("mousedown",d),e.addEventListener("mouseup",c),e.addEventListener("mouseleave",i),e.addEventListener("mouseenter",i),e.addEventListener("mouseout",i),e.addEventListener("mouseover",i),e.addEventListener("blur",n),e.addEventListener("keyup",l),e.addEventListener("keydown",l),e.addEventListener("keypress",l),e!==window&&(window.addEventListener("blur",n),window.addEventListener("keyup",l),window.addEventListener("keydown",l),window.addEventListener("keypress",l)))}function u(){_&&(_=!1,e.removeEventListener("mousemove",s),e.removeEventListener("mousedown",d),e.removeEventListener("mouseup",c),e.removeEventListener("mouseleave",i),e.removeEventListener("mouseenter",i),e.removeEventListener("mouseout",i),e.removeEventListener("mouseover",i),e.removeEventListener("blur",n),e.removeEventListener("keyup",l),e.removeEventListener("keydown",l),e.removeEventListener("keypress",l),e!==window&&(window.removeEventListener("blur",n),window.removeEventListener("keyup",l),window.removeEventListener("keydown",l),window.removeEventListener("keypress",l)))}t||(t=e,e=window);var g=0,h=0,m=0,f={shift:!1,alt:!1,control:!1,meta:!1},_=!1;p();var b={element:e};return Object.defineProperties(b,{enabled:{get:function(){return _},set:function(e){e?p():u()},enumerable:!0},buttons:{get:function(){return g},enumerable:!0},x:{get:function(){return h},enumerable:!0},y:{get:function(){return m},enumerable:!0},mods:{get:function(){return f},enumerable:!0}}),b};var a=e("mouse-event")},{"mouse-event":437}],436:[function(e,t){function a(e){return e===window||e===document||e===document.body?r:e.getBoundingClientRect()}var r={left:0,top:0};t.exports=function(e,t,r){t=t||e.currentTarget||e.srcElement,Array.isArray(r)||(r=[0,0]);var o=e.clientX||0,i=e.clientY||0,n=a(t);return r[0]=o-n.left,r[1]=i-n.top,r}},{}],437:[function(e,t,a){"use strict";function r(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){var t=e.which;if(2===t)return 4;if(3===t)return 2;if(0<t)return 1<<t-1}else if("button"in e){var t=e.button;if(1===t)return 4;if(2===t)return 2;if(0<=t)return 1<<t}}return 0}function o(e){return e.target||e.srcElement||window}function i(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=o(e),a=t.getBoundingClientRect();return e.clientX-a.left}return 0}function n(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=o(e),a=t.getBoundingClientRect();return e.clientY-a.top}return 0}a.buttons=r,a.element=o,a.x=i,a.y=n},{}],438:[function(e,t){"use strict";var a=e("to-px");t.exports=function(e,t,r){"function"==typeof e&&(r=!!t,t=e,e=window);var o=a("ex",e),i=function(e){r&&e.preventDefault();var a=e.deltaX||0,i=e.deltaY||0,n=e.deltaZ||0,l=e.deltaMode,s=1;if(1===l?s=o:2===l?s=window.innerHeight:void 0,a*=s,i*=s,n*=s,a||i||n)return t(a,i,n,e)};return e.addEventListener("wheel",i),i}},{"to-px":539}],439:[function(e,t){"use strict";function a(e){return"a"+e}function r(e){return"d"+e}function o(e,t){return"c"+e+"_"+t}function n(e){return"s"+e}function l(e,t){return"t"+e+"_"+t}function s(e){return"o"+e}function d(e){return"x"+e}function c(e){return"p"+e}function p(e,t){return"d"+e+"_"+t}function u(e){return"i"+e}function g(e,t){return"u"+e+"_"+t}function h(e){return"b"+e}function m(e){return"y"+e}function y(e){return"e"+e}function f(e){return"v"+e}function x(e,t,a){for(var o=0,n=0;n<e;++n)t&1<<n&&(o|=1<<a[n]);return o}function _(e,t,_,v,w,T){function A(e,t){O.push("for(",u(w[e]),"=",t,";",u(w[e]),"<",n(w[e]),";","++",u(w[e]),"){")}function S(e){for(var t=0;t<z;++t)O.push(c(t),"+=",g(t,w[e]),";");O.push("}")}function C(e){for(var t=e-1;0<=t;--t)A(t,0);for(var a=[],t=0;t<z;++t)T[t]?a.push(r(t)+".get("+c(t)+")"):a.push(r(t)+"["+c(t)+"]");for(var t=0;t<v;++t)a.push(d(t));O.push("P","[","X","++]=phase(",a.join(),");");for(var t=0;t<e;++t)S(t);for(var o=0;o<z;++o)O.push(c(o),"+=",g(o,w[e]),";")}function L(e){for(var t=0;t<z;++t)T[t]?O.push(o(t,0),"=",r(t),".get(",c(t),");"):O.push(o(t,0),"=",r(t),"[",c(t),"];");for(var a=[],t=0;t<z;++t)a.push(o(t,0));for(var t=0;t<v;++t)a.push(d(t));O.push(h(0),"=","P","[","X","]=phase(",a.join(),");");for(var n=1;n<1<<P;++n)O.push(h(n),"=","P","[","X","+",y(n),"];");for(var l=[],n=1;n<1<<P;++n)l.push("("+h(0)+"!=="+h(n)+")");O.push("if(",l.join("||"),"){");for(var s=[],t=0;t<P;++t)s.push(u(t));for(var t=0;t<z;++t){s.push(o(t,0));for(var n=1;n<1<<P;++n)T[t]?O.push(o(t,n),"=",r(t),".get(",c(t),"+",p(t,n),");"):O.push(o(t,n),"=",r(t),"[",c(t),"+",p(t,n),"];"),s.push(o(t,n))}for(var t=0;t<1<<P;++t)s.push(h(t));for(var t=0;t<v;++t)s.push(d(t));O.push("vertex(",s.join(),");",f(0),"=","V","[","X","]=","N","++;");for(var g=(1<<P)-1,m=h(g),n=0;n<P;++n)if(0==(e&~(1<<n))){for(var x=g^1<<n,_=h(x),b=[],w=x;0<w;w=w-1&x)b.push("V[X+"+y(w)+"]");b.push(f(0));for(var w=0;w<z;++w)1&n?b.push(o(w,g),o(w,x)):b.push(o(w,x),o(w,g));1&n?b.push(m,_):b.push(_,m);for(var w=0;w<v;++w)b.push(d(w));O.push("if(",m,"!==",_,"){","face(",b.join(),")}")}O.push("}","X","+=1;")}function E(){for(var e=1;e<1<<P;++e)O.push("T","=",y(e),";",y(e),"=",m(e),";",m(e),"=","T",";")}function I(e,t){if(0>e)return void L(t);C(e),O.push("if(",n(w[e]),">0){",u(w[e]),"=1;"),I(e-1,t|1<<w[e]);for(var a=0;a<z;++a)O.push(c(a),"+=",g(a,w[e]),";");e===P-1&&(O.push("X","=0;"),E()),A(e,2),I(e-1,t),e===P-1&&(O.push("if(",u(w[P-1]),"&1){","X","=0;}"),E()),S(e),O.push("}")}var z=T.length,P=w.length;if(2>P)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var D="extractContour"+w.join("_"),O=[],R=[],M=[],F=0;F<z;++F)M.push(a(F));for(var F=0;F<v;++F)M.push(d(F));for(var F=0;F<P;++F)R.push(n(F)+"="+a(0)+".shape["+F+"]|0");for(var F=0;F<z;++F){R.push(r(F)+"="+a(F)+".data",s(F)+"="+a(F)+".offset|0");for(var B=0;B<P;++B)R.push(l(F,B)+"="+a(F)+".stride["+B+"]|0")}for(var F=0;F<z;++F){R.push(c(F)+"="+s(F)),R.push(o(F,0));for(var B=1,N;B<1<<P;++B){N=[];for(var V=0;V<P;++V)B&1<<V&&N.push("-"+l(F,V));R.push(p(F,B)+"=("+N.join("")+")|0"),R.push(o(F,B)+"=0")}}for(var F=0;F<z;++F)for(var B=0,U;B<P;++B)U=[l(F,w[B])],0<B&&U.push(l(F,w[B-1])+"*"+n(w[B-1])),R.push(g(F,w[B])+"=("+U.join("-")+")|0");for(var F=0;F<P;++F)R.push(u(F)+"=0");R.push("N=0");for(var H=["2"],F=P-2;0<=F;--F)H.push(n(w[F]));R.push("Q=("+H.join("*")+")|0","P=mallocUint32(Q)","V=mallocUint32(Q)","X=0"),R.push(h(0)+"=0");for(var B=1;B<1<<P;++B){for(var G=[],q=[],V=0;V<P;++V)B&1<<V&&(0===q.length?G.push("1"):G.unshift(q.join("*"))),q.push(n(w[V]));var Y="";0>G[0].indexOf(n(w[P-2]))&&(Y="-");var W=x(P,B,w);R.push(y(W)+"=(-"+G.join("-")+")|0",m(W)+"=("+Y+G.join("-")+")|0",h(W)+"=0")}R.push(f(0)+"=0","T=0"),I(P-1,0),O.push("freeUint32(","V",");freeUint32(","P",");");var X=["'use strict';","function ",D,"(",M.join(),"){","var ",R.join(),";",O.join(""),"}","return ",D].join(""),Z=new Function("vertex","face","phase","mallocUint32","freeUint32",X);return Z(e,t,_,b.mallocUint32,b.freeUint32)}var b=e("typedarray-pool");t.exports=function(e){function t(e){throw new Error("ndarray-extract-contour: "+e)}"object"!=typeof e&&t("Must specify arguments");var a=e.order;Array.isArray(a)||t("Must specify order");var r=e.arrayArguments||1;1>r&&t("Must have at least one array argument");var o=e.scalarArguments||0;0>o&&t("Scalar arg count must be > 0"),"function"!=typeof e.vertex&&t("Must specify vertex creation function"),"function"!=typeof e.cell&&t("Must specify cell creation function"),"function"!=typeof e.phase&&t("Must specify phase function");for(var n=e.getters||[],l=Array(r),s=0;s<r;++s)l[s]=!!(0<=n.indexOf(s));return _(e.vertex,e.cell,e.phase,o,a,l)}},{"typedarray-pool":545}],440:[function(e,t){"use strict";var a=e("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"cwise",blockSize:64});t.exports=function(e,t){return a(e,t),e}},{"cwise/lib/wrapper":149}],441:[function(e,t){"use strict";function a(e){if(e in s)return s[e];for(var t=[],a=0;a<e;++a)t.push("out",a,"s=0.5*(inp",a,"l-inp",a,"r);");for(var r=["array"],d=["junk"],a=0;a<e;++a){r.push("array"),d.push("out"+a+"s");var c=n(e);c[a]=-1,r.push({array:0,offset:c.slice()}),c[a]=1,r.push({array:0,offset:c.slice()}),d.push("inp"+a+"l","inp"+a+"r")}return s[e]=l({args:r,pre:p,post:p,body:{body:t.join(""),args:d.map(function(e){return{name:e,lvalue:0===e.indexOf("out"),rvalue:0===e.indexOf("inp"),count:0|"junk"!==e}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+e})}function r(e){function t(t){for(var a=n-t.length,r=[],o=[],s=[],d=0;d<n;++d)0<=t.indexOf(d+1)?s.push("0"):0<=t.indexOf(-(d+1))?s.push("s["+d+"]-1"):(s.push("-1"),r.push("1"),o.push("s["+d+"]-2"));var c=".lo("+r.join()+").hi("+o.join()+")";if(0===r.length&&(c=""),0<a){l.push("if(1");for(var d=0;d<n;++d)0<=t.indexOf(d+1)||0<=t.indexOf(-(d+1))||l.push("&&s[",d,"]>2");l.push("){grad",a,"(src.pick(",s.join(),")",c);for(var d=0;d<n;++d)0<=t.indexOf(d+1)||0<=t.indexOf(-(d+1))||l.push(",dst.pick(",s.join(),",",d,")",c);l.push(");")}for(var d=0;d<t.length;++d){var p=_a(t[d])-1,u="dst.pick("+s.join()+","+p+")"+c;switch(e[p]){case"clamp":var g=s.slice(),h=s.slice();0>t[d]?g[p]="s["+p+"]-2":h[p]="1",0===a?l.push("if(s[",p,"]>1){dst.set(",s.join(),",",p,",0.5*(src.get(",g.join(),")-src.get(",h.join(),")))}else{dst.set(",s.join(),",",p,",0)};"):l.push("if(s[",p,"]>1){diff(",u,",src.pick(",g.join(),")",c,",src.pick(",h.join(),")",c,");}else{zero(",u,");};");break;case"mirror":0===a?l.push("dst.set(",s.join(),",",p,",0);"):l.push("zero(",u,");");break;case"wrap":var m=s.slice(),y=s.slice();0>t[d]?(m[p]="s["+p+"]-2",y[p]="0"):(m[p]="s["+p+"]-1",y[p]="1"),0===a?l.push("if(s[",p,"]>2){dst.set(",s.join(),",",p,",0.5*(src.get(",m.join(),")-src.get(",y.join(),")))}else{dst.set(",s.join(),",",p,",0)};"):l.push("if(s[",p,"]>2){diff(",u,",src.pick(",m.join(),")",c,",src.pick(",y.join(),")",c,");}else{zero(",u,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition");}}0<a&&l.push("};")}var r=e.join(),o=c[r];if(o)return o;for(var n=e.length,l=["function gradient(dst,src){var s=src.shape.slice();"],d=0,p;d<1<<n;++d){p=[];for(var h=0;h<n;++h)d&1<<h&&p.push(h+1);for(var m=0,y;m<1<<p.length;++m){y=p.slice();for(var h=0;h<p.length;++h)m&1<<h&&(y[h]=-y[h]);t(y)}}l.push("return dst;};return gradient");for(var f=["diff","zero"],x=[u,g],d=1;d<=n;++d)f.push("grad"+d),x.push(a(d));f.push(l.join(""));var _=Function.apply(void 0,f),o=_.apply(void 0,x);return s[r]=o,o}t.exports=function(e,t,a){if(!Array.isArray(a))a="string"==typeof a?n(t.dimension,a):n(t.dimension,"clamp");else if(a.length!==t.dimension)throw new Error("ndarray-gradient: invalid boundary conditions");if(e.dimension!==t.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(e.shape[t.dimension]!==t.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var o=0;o<t.dimension;++o)if(e.shape[o]!==t.shape[o])throw new Error("ndarray-gradient: shape mismatch");if(0===t.size)return e;if(0>=t.dimension)return e.set(0),e;var l=r(a);return l(e,t)};var n=e("dup"),l=e("cwise-compiler"),s={},c={},p={body:"",args:[],thisVars:[],localVars:[]},u=l({args:["array","array","array"],pre:p,post:p,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),g=l({args:["array"],pre:p,post:p,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"})},{"cwise-compiler":146,dup:170}],442:[function(e,t){"use strict";var a=e("ndarray-warp"),r=e("gl-matrix-invert");t.exports=function(e,t,o){var l=t.dimension,n=r([],o);return a(e,t,function(e,t){for(var a=0;a<l;++a){e[a]=n[(l+1)*l+a];for(var r=0;r<l;++r)e[a]+=n[(l+1)*r+a]*t[r]}for(var o=n[(l+1)*(l+1)-1],r=0;r<l;++r)o+=n[(l+1)*r+l]*t[r];for(var s=1/o,a=0;a<l;++a)e[a]*=s;return e}),e}},{"gl-matrix-invert":277,"ndarray-warp":449}],443:[function(e,t){"use strict";function a(e,t){var a=ba(t),r=t-a,o=0<=a&&a<e.shape[0],i=0<=a+1&&a+1<e.shape[0],n=o?+e.get(a):0,l=i?+e.get(a+1):0;return(1-r)*n+r*l}function r(e,t,a){var r=ba(t),o=t-r,i=0<=r&&r<e.shape[0],n=0<=r+1&&r+1<e.shape[0],l=ba(a),s=a-l,d=0<=l&&l<e.shape[1],c=0<=l+1&&l+1<e.shape[1],p=i&&d?e.get(r,l):0,u=i&&c?e.get(r,l+1):0,g=n&&d?e.get(r+1,l):0,h=n&&c?e.get(r+1,l+1):0;return(1-s)*((1-o)*p+o*g)+s*((1-o)*u+o*h)}function o(e,t,a,r){var o=ba(t),i=t-o,n=0<=o&&o<e.shape[0],l=0<=o+1&&o+1<e.shape[0],s=ba(a),d=a-s,c=0<=s&&s<e.shape[1],p=0<=s+1&&s+1<e.shape[1],u=ba(r),g=r-u,h=0<=u&&u<e.shape[2],m=0<=u+1&&u+1<e.shape[2],y=n&&c&&h?e.get(o,s,u):0,f=n&&p&&h?e.get(o,s+1,u):0,x=l&&c&&h?e.get(o+1,s,u):0,_=l&&p&&h?e.get(o+1,s+1,u):0,b=n&&c&&m?e.get(o,s,u+1):0,v=n&&p&&m?e.get(o,s+1,u+1):0,k=l&&c&&m?e.get(o+1,s,u+1):0,w=l&&p&&m?e.get(o+1,s+1,u+1):0;return(1-g)*((1-d)*((1-i)*y+i*x)+d*((1-i)*f+i*_))+g*((1-d)*((1-i)*b+i*k)+d*((1-i)*v+i*w))}function i(e){var a=0|e.shape.length,o=Array(a),n=Array(a),l=Array(a),s=Array(a),d,c;for(d=0;d<a;++d)c=+arguments[d+1],o[d]=ba(c),n[d]=c-o[d],l[d]=0<=o[d]&&o[d]<e.shape[d],s[d]=0<=o[d]+1&&o[d]+1<e.shape[d];var p=0,u,g,h;i_loop:for(d=0;d<1<<a;++d){for(g=1,h=e.offset,u=0;u<a;++u)if(d&1<<u){if(!s[u])continue i_loop;g*=n[u],h+=e.stride[u]*(o[u]+1)}else{if(!l[u])continue i_loop;g*=1-n[u],h+=e.stride[u]*o[u]}p+=g*e.data[h]}return p}t.exports=function(e,t,n,l){switch(e.shape.length){case 0:return 0;case 1:return a(e,t);case 2:return r(e,t,n);case 3:return o(e,t,n,l);default:return i.apply(void 0,arguments);}},t.exports.d1=a,t.exports.d2=r,t.exports.d3=o},{}],444:[function(e,t,a){"use strict";function r(e){if(!e)return s;for(var t=0,r;t<e.args.length;++t)r=e.args[t],e.args[t]=0==t?{name:r,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:r,lvalue:!1,rvalue:!0,count:1};return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function o(e){return l({args:e.args,pre:r(e.pre),body:r(e.body),post:r(e.proc),funcName:e.funcName})}function n(e){for(var t=[],a=0;a<e.args.length;++a)t.push("a"+a);var r=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return r(o(e))}var l=e("cwise-compiler"),s={body:"",args:[],thisVars:[],localVars:[]},d={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in d){var t=d[e];a[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),a[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),a[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),a[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}})();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in c){var t=c[e];a[e]=n({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),a[e+"eq"]=n({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}})();var p={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in p){var t=p[e];a[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),a[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),a[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),a[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}})();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0,t;e<u.length;++e)t=u[e],a[t]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),a[t+"eq"]=n({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})})();var g=["max","min","atan2","pow"];(function(){for(var e=0,t;e<g.length;++e)t=g[e],a[t]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),a[t+"s"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),a[t+"eq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),a[t+"seq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})})();var h=["atan2","pow"];(function(){for(var e=0,t;e<h.length;++e)t=h[e],a[t+"op"]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),a[t+"ops"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),a[t+"opeq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),a[t+"opseq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})})(),a.any=l({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),a.all=l({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),a.sum=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),a.prod=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),a.norm2squared=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),a.norm2=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),a.norminf=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),a.norm1=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),a.sup=l({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.inf=l({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.argmin=l({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.argmax=l({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.random=n({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),a.assign=n({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),a.assigns=n({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),a.equals=l({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":146}],445:[function(e,t){"use strict";var a=e("ndarray"),r=e("./doConvert.js");t.exports=function(e,t){for(var o=[],i=e,n=1;Array.isArray(i);)o.push(i.length),n*=i.length,i=i[0];return 0===o.length?a():(t||(t=a(new Float64Array(n),o)),r(t,e),t)}},{"./doConvert.js":446,ndarray:450}],446:[function(e,t){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":146}],447:[function(e,t){"use strict";function a(e){return"uint8"===e?[l.mallocUint8,l.freeUint8]:"uint16"===e?[l.mallocUint16,l.freeUint16]:"uint32"===e?[l.mallocUint32,l.freeUint32]:"int8"===e?[l.mallocInt8,l.freeInt8]:"int16"===e?[l.mallocInt16,l.freeInt16]:"int32"===e?[l.mallocInt32,l.freeInt32]:"float32"===e?[l.mallocFloat,l.freeFloat]:"float64"===e?[l.mallocDouble,l.freeDouble]:null}function r(e){for(var t=[],a=0;a<e;++a)t.push("s"+a);for(var a=0;a<e;++a)t.push("n"+a);for(var a=1;a<e;++a)t.push("d"+a);for(var a=1;a<e;++a)t.push("e"+a);for(var a=1;a<e;++a)t.push("f"+a);return t}function o(e,t){function o(e){return"generic"===t?["data.get(",e,")"].join(""):["data[",e,"]"].join("")}function n(e,a){return"generic"===t?["data.set(",e,",",a,")"].join(""):["data[",e,"]=",a].join("")}var l=["'use strict'"],s=["ndarrayInsertionSort",e.join("d"),t].join(""),d=["left","right","data","offset"].concat(r(e.length)),c=a(t),p=["i,j,cptr,ptr=left*s0+offset"];if(1<e.length){for(var u=[],g=1;g<e.length;++g)p.push("i"+g),u.push("n"+g);c?p.push("scratch=malloc("+u.join("*")+")"):p.push("scratch=new Array("+u.join("*")+")"),p.push("dptr","sptr","a","b")}else p.push("scratch");if(l.push(["function ",s,"(",d.join(","),"){var ",p.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),1<e.length){l.push("dptr=0;sptr=ptr");for(var g=e.length-1,h;0<=g;--g)(h=e[g],0!==h)&&l.push(["for(i",h,"=0;i",h,"<n",h,";++i",h,"){"].join(""));l.push("scratch[dptr++]=",o("sptr"));for(var g=0,h;g<e.length;++g)(h=e[g],0!==h)&&l.push("sptr+=d"+h,"}");l.push("__g:while(j-->left){","dptr=0","sptr=cptr-s0");for(var g=1;g<e.length;++g)1==g&&l.push("__l:"),l.push(["for(i",g,"=0;i",g,"<n",g,";++i",g,"){"].join(""));l.push(["a=",o("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join(""));for(var g=e.length-1;1<=g;--g)l.push("sptr+=e"+g,"dptr+=f"+g,"}");l.push("dptr=cptr;sptr=cptr-s0");for(var g=e.length-1,h;0<=g;--g)(h=e[g],0!==h)&&l.push(["for(i",h,"=0;i",h,"<n",h,";++i",h,"){"].join(""));l.push(n("dptr",o("sptr")));for(var g=0,h;g<e.length;++g)(h=e[g],0!==h)&&l.push(["dptr+=d",h,";sptr+=d",h].join(""),"}");l.push("cptr-=s0\n}"),l.push("dptr=cptr;sptr=0");for(var g=e.length-1,h;0<=g;--g)(h=e[g],0!==h)&&l.push(["for(i",h,"=0;i",h,"<n",h,";++i",h,"){"].join(""));l.push(n("dptr","scratch[sptr++]"));for(var g=0,h;g<e.length;++g)(h=e[g],0!==h)&&l.push("dptr+=d"+h,"}")}else l.push("scratch="+o("ptr"),"while((j-->left)&&("+o("cptr-s0")+">scratch)){",n("cptr",o("cptr-s0")),"cptr-=s0","}",n("cptr","scratch"));if(l.push("}"),1<e.length&&c&&l.push("free(scratch)"),l.push("} return "+s),c){var m=new Function("malloc","free",l.join("\n"));return m(c[0],c[1])}var m=new Function(l.join("\n"));return m()}function n(e,t,o){function l(e){return["(offset+",e,"*s0)"].join("")}function s(e){return"generic"===t?["data.get(",e,")"].join(""):["data[",e,"]"].join("")}function d(e,a){return"generic"===t?["data.set(",e,",",a,")"].join(""):["data[",e,"]=",a].join("")}function c(t,a,r){if(1===t.length)w.push("ptr0="+l(t[0]));else for(var o=0;o<t.length;++o)w.push(["b_ptr",o,"=s0*",t[o]].join(""));a&&w.push("pivot_ptr=0"),w.push("ptr_shift=offset");for(var o=e.length-1,n;0<=o;--o)(n=e[o],0!==n)&&w.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));if(1<t.length)for(var o=0;o<t.length;++o)w.push(["ptr",o,"=b_ptr",o,"+ptr_shift"].join(""));w.push(r),a&&w.push("++pivot_ptr");for(var o=0,n;o<e.length;++o)(n=e[o],0!==n)&&(1<t.length?w.push("ptr_shift+=d"+n):w.push("ptr0+=d"+n),w.push("}"))}function p(t,a,r,o){if(1===a.length)w.push("ptr0="+l(a[0]));else{for(var n=0;n<a.length;++n)w.push(["b_ptr",n,"=s0*",a[n]].join(""));w.push("ptr_shift=offset")}r&&w.push("pivot_ptr=0"),t&&w.push(t+":");for(var n=1;n<e.length;++n)w.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));if(1<a.length)for(var n=0;n<a.length;++n)w.push(["ptr",n,"=b_ptr",n,"+ptr_shift"].join(""));w.push(o);for(var n=e.length-1;1<=n;--n)r&&w.push("pivot_ptr+=f"+n),1<a.length?w.push("ptr_shift+=e"+n):w.push("ptr0+=e"+n),w.push("}")}function u(){1<e.length&&S&&w.push("free(pivot1)","free(pivot2)")}function g(t,r){var o="el"+t,a="el"+r;if(1<e.length){var i="__l"+ ++C;p(i,[o,a],!1,["comp=",s("ptr0"),"-",s("ptr1"),"\n","if(comp>0){tmp0=",o,";",o,"=",a,";",a,"=tmp0;break ",i,"}\n","if(comp<0){break ",i,"}"].join(""))}else w.push(["if(",s(l(o)),">",s(l(a)),"){tmp0=",o,";",o,"=",a,";",a,"=tmp0}"].join(""))}function h(t,a){1<e.length?c([t,a],!1,d("ptr0",s("ptr1"))):w.push(d(l(t),s(l(a))))}function m(t,a,r){if(1<e.length){var o="__l"+ ++C;p(o,[a],!0,[t,"=",s("ptr0"),"-pivot",r,"[pivot_ptr]\n","if(",t,"!==0){break ",o,"}"].join(""))}else w.push([t,"=",s(l(a)),"-pivot",r].join(""))}function y(t,a){1<e.length?c([t,a],!1,["tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1","tmp")].join("")):w.push(["ptr0=",l(t),"\n","ptr1=",l(a),"\n","tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1","tmp")].join(""))}function f(t,a,r){1<e.length?(c([t,a,r],!1,["tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1",s("ptr2")),"\n",d("ptr2","tmp")].join("")),w.push("++"+a,"--"+r)):w.push(["ptr0=",l(t),"\n","ptr1=",l(a),"\n","ptr2=",l(r),"\n","++",a,"\n","--",r,"\n","tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1",s("ptr2")),"\n",d("ptr2","tmp")].join(""))}function x(e,t){y(e,t),w.push("--"+t)}function _(t,a,r){1<e.length?c([t,a],!0,[d("ptr0",s("ptr1")),"\n",d("ptr1",["pivot",r,"[pivot_ptr]"].join(""))].join("")):w.push(d(l(t),s(l(a))),d(l(a),"pivot"+r))}function b(t,a){w.push(["if((",a,"-",t,")<=",32,"){\n","insertionSort(",t,",",a,",data,offset,",r(e.length).join(","),")\n","}else{\n",T,"(",t,",",a,",data,offset,",r(e.length).join(","),")\n","}"].join(""))}function v(t,a,r){1<e.length?(w.push(["__l",++C,":while(true){"].join("")),c([t],!0,["if(",s("ptr0"),"!==pivot",a,"[pivot_ptr]){break __l",C,"}"].join("")),w.push(r,"}")):w.push(["while(",s(l(t)),"===pivot",a,"){",r,"}"].join(""))}var w=["'use strict'"],T=["ndarrayQuickSort",e.join("d"),t].join(""),A=["left","right","data","offset"].concat(r(e.length)),S=a(t),C=0;w.push(["function ",T,"(",A.join(","),"){"].join(""));var L=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(1<e.length){for(var E=[],I=1;I<e.length;++I)E.push("n"+I),L.push("i"+I);for(var I=0;8>I;++I)L.push("b_ptr"+I);L.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+E.join("*")),S?L.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):L.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else L.push("pivot1","pivot2");if(w.push("var "+L.join(",")),g(1,2),g(4,5),g(1,3),g(2,3),g(1,4),g(3,4),g(2,5),g(2,3),g(4,5),1<e.length?c(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",s("ptr1"),"\n","pivot2[pivot_ptr]=",s("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",s("ptr0"),"\n","y=",s("ptr2"),"\n","z=",s("ptr4"),"\n",d("ptr5","x"),"\n",d("ptr6","y"),"\n",d("ptr7","z")].join("")):w.push(["pivot1=",s(l("el2")),"\n","pivot2=",s(l("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",s(l("el1")),"\n","y=",s(l("el3")),"\n","z=",s(l("el5")),"\n",d(l("index1"),"x"),"\n",d(l("index3"),"y"),"\n",d(l("index5"),"z")].join("")),h("index2","left"),h("index4","right"),w.push("if(pivots_are_equal){"),w.push("for(k=less;k<=great;++k){"),m("comp","k",1),w.push("if(comp===0){continue}"),w.push("if(comp<0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),w.push("while(true){"),m("comp","great",1),w.push("if(comp>0){"),w.push("great--"),w.push("}else if(comp<0){"),f("k","less","great"),w.push("break"),w.push("}else{"),x("k","great"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}else{"),w.push("for(k=less;k<=great;++k){"),m("comp_pivot1","k",1),w.push("if(comp_pivot1<0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),m("comp_pivot2","k",2),w.push("if(comp_pivot2>0){"),w.push("while(true){"),m("comp","great",2),w.push("if(comp>0){"),w.push("if(--great<k){break}"),w.push("continue"),w.push("}else{"),m("comp","great",1),w.push("if(comp<0){"),f("k","less","great"),w.push("}else{"),x("k","great"),w.push("}"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),_("left","(less-1)",1),_("right","(great+1)",2),b("left","(less-2)"),b("(great+2)","right"),w.push("if(pivots_are_equal){"),u(),w.push("return"),w.push("}"),w.push("if(less<index1&&great>index5){"),v("less",1,"++less"),v("great",2,"--great"),w.push("for(k=less;k<=great;++k){"),m("comp_pivot1","k",1),w.push("if(comp_pivot1===0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),m("comp_pivot2","k",2),w.push("if(comp_pivot2===0){"),w.push("while(true){"),m("comp","great",2),w.push("if(comp===0){"),w.push("if(--great<k){break}"),w.push("continue"),w.push("}else{"),m("comp","great",1),w.push("if(comp<0){"),f("k","less","great"),w.push("}else{"),x("k","great"),w.push("}"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),u(),b("less","great"),w.push("}return "+T),1<e.length&&S){var n=new Function("insertionSort","malloc","free",w.join("\n"));return n(o,S[0],S[1])}var n=new Function("insertionSort",w.join("\n"));return n(o)}var l=e("typedarray-pool");t.exports=function(e,t){var a=["'use strict'"],l=["ndarraySortWrapper",e.join("d"),t].join("");a.push(["function ",l,"(",["array"].join(","),"){"].join(""));for(var s=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],d=0;d<e.length;++d)s.push(["s",d,"=stride[",d,"]|0,n",d,"=shape[",d,"]|0"].join(""));for(var c=Array(e.length),u=[],d=0,g;d<e.length;++d)(g=e[d],0!==g)&&(c[g]=0===u.length?"1":u.join("*"),u.push("n"+g));for(var h=-1,m=-1,d=0,y;d<e.length;++d){y=e[d],0!==y&&(0<h?s.push(["d",y,"=s",y,"-d",h,"*n",h].join("")):s.push(["d",y,"=s",y].join("")),h=y);var g=e.length-1-d;0!==g&&(0<m?s.push(["e",g,"=s",g,"-e",m,"*n",m,",f",g,"=",c[g],"-f",m,"*n",m].join("")):s.push(["e",g,"=s",g,",f",g,"=",c[g]].join("")),m=g)}a.push("var "+s.join(","));var f=["0","n0-1","data","offset"].concat(r(e.length));a.push(["if(n0<=",32,"){","insertionSort(",f.join(","),")}else{","quickSort(",f.join(","),")}"].join("")),a.push("}return "+l);var x=new Function("insertionSort","quickSort",a.join("\n")),_=o(e,t),b=n(e,t,_);return x(_,b)}},{"typedarray-pool":545}],448:[function(e,t){"use strict";var a=e("./lib/compile_sort.js"),r={};t.exports=function(e){var t=e.order,o=e.dtype,i=[t,o].join(":"),n=r[i];return n||(r[i]=n=a(t,o)),n(e),e}},{"./lib/compile_sort.js":447}],449:[function(e,t){"use strict";var a=e("ndarray-linear-interpolate"),r=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_3_arg4_)}",args:[{name:"_inline_3_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg2_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg3_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_4_arg2_(this_warped,_inline_4_arg0_),_inline_4_arg1_=_inline_4_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_4_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_4_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg4_",lvalue:!1,rvalue:!1,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warpND",blockSize:64}),o=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_7_arg2_(this_warped,_inline_7_arg0_),_inline_7_arg1_=_inline_7_arg3_(_inline_7_arg4_,this_warped[0])}",args:[{name:"_inline_7_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_7_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp1D",blockSize:64}),i=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_10_arg2_(this_warped,_inline_10_arg0_),_inline_10_arg1_=_inline_10_arg3_(_inline_10_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_10_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_10_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp2D",blockSize:64}),n=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_13_arg2_(this_warped,_inline_13_arg0_),_inline_13_arg1_=_inline_13_arg3_(_inline_13_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_13_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_13_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp3D",blockSize:64});t.exports=function(e,t,l){switch(t.shape.length){case 1:o(e,l,a.d1,t);break;case 2:i(e,l,a.d2,t);break;case 3:n(e,l,a.d3,t);break;default:r(e,l,a.bind(void 0,t),t.shape.length);}return e}},{"cwise/lib/wrapper":149,"ndarray-linear-interpolate":443}],450:[function(e,t){function a(e,t){return e[0]-t[0]}function r(){var e=this.stride,t=Array(e.length),r;for(r=0;r<t.length;++r)t[r]=[_a(e[r]),r];t.sort(a);var o=Array(t.length);for(r=0;r<o.length;++r)o[r]=t[r][1];return o}function o(e,t){var a=["View",t,"d",e].join("");0>t&&(a="View_Nil"+e);var o="generic"===e;if(-1===t){var l="function "+a+"(a){this.data=a;};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+a+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+a+"(a){return new "+a+"(a);}",s=new Function(l);return s()}if(0===t){var l="function "+a+"(a,d) {this.data = a;this.offset = d};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+a+"_copy() {return new "+a+"(this.data,this.offset)};proto.pick=function "+a+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+a+"_get(){return "+(o?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+a+"_set(v){return "+(o?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+a+"(a,b,c,d){return new "+a+"(a,d)}",s=new Function("TrivialArray",l);return s(c[e][0])}var l=["'use strict'"],d=n(t),p=d.map(function(e){return"i"+e}),u="this.offset+"+d.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),g=d.map(function(e){return"b"+e}).join(","),h=d.map(function(e){return"c"+e}).join(",");l.push("function "+a+"(a,"+g+","+h+",d){this.data=a","this.shape=["+g+"]","this.stride=["+h+"]","this.offset=d|0}","var proto="+a+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),l.push("Object.defineProperty(proto,'size',{get:function "+a+"_size(){return "+d.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?l.push("proto.order=[0]"):(l.push("Object.defineProperty(proto,'order',{get:"),4>t?(l.push("function "+a+"_order(){"),2===t?l.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3==t&&l.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):l.push("ORDER})")),l.push("proto.set=function "+a+"_set("+p.join(",")+",v){"),o?l.push("return this.data.set("+u+",v)}"):l.push("return this.data["+u+"]=v}"),l.push("proto.get=function "+a+"_get("+p.join(",")+"){"),o?l.push("return this.data.get("+u+")}"):l.push("return this.data["+u+"]}"),l.push("proto.index=function "+a+"_index(",p.join(),"){return "+u+"}"),l.push("proto.hi=function "+a+"_hi("+p.join(",")+"){return new "+a+"(this.data,"+d.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+d.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var m=d.map(function(e){return"a"+e+"=this.shape["+e+"]"}),y=d.map(function(e){return"c"+e+"=this.stride["+e+"]"});l.push("proto.lo=function "+a+"_lo("+p.join(",")+"){var b=this.offset,d=0,"+m.join(",")+","+y.join(","));for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'&&i"+f+">=0){d=i"+f+"|0;b+=c"+f+"*d;a"+f+"-=d}");l.push("return new "+a+"(this.data,"+d.map(function(e){return"a"+e}).join(",")+","+d.map(function(e){return"c"+e}).join(",")+",b)}"),l.push("proto.step=function "+a+"_step("+p.join(",")+"){var "+d.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+d.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'){d=i"+f+"|0;if(d<0){c+=b"+f+"*(a"+f+"-1);a"+f+"=ceil(-a"+f+"/d)}else{a"+f+"=ceil(a"+f+"/d)}b"+f+"*=d}");l.push("return new "+a+"(this.data,"+d.map(function(e){return"a"+e}).join(",")+","+d.map(function(e){return"b"+e}).join(",")+",c)}");for(var x=Array(t),_=Array(t),f=0;f<t;++f)x[f]="a[i"+f+"]",_[f]="b[i"+f+"]";l.push("proto.transpose=function "+a+"_transpose("+p+"){"+p.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+a+"(this.data,"+x.join(",")+","+_.join(",")+",this.offset)}"),l.push("proto.pick=function "+a+"_pick("+p+"){var a=[],b=[],c=this.offset");for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'&&i"+f+">=0){c=(c+this.stride["+f+"]*i"+f+")|0}else{a.push(this.shape["+f+"]);b.push(this.stride["+f+"])}");l.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),l.push("return function construct_"+a+"(data,shape,stride,offset){return new "+a+"(data,"+d.map(function(e){return"shape["+e+"]"}).join(",")+","+d.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",l.join("\n"));return s(c[e],r)}function i(e){if(l(e))return"buffer";if(s)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";}return Array.isArray(e)?"array":"generic"}var n=e("iota-array"),l=e("is-buffer"),s="undefined"!=typeof Float64Array,c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var e in c)c[e].push(o(e,-1))}),t.exports=function(e,t,a,r){if(e===void 0){var n=c.array[0];return n([])}"number"==typeof e&&(e=[e]);t===void 0&&(t=[e.length]);var l=t.length;if(a===void 0){a=Array(l);for(var s=l-1,d=1;0<=s;--s)a[s]=d,d*=t[s]}if(void 0===r){r=0;for(var s=0;s<l;++s)0>a[s]&&(r-=(t[s]-1)*a[s])}for(var p=i(e),u=c[p];u.length<=l+1;)u.push(o(p,u.length-1));var n=u[l+1];return n(e,t,a,r)}},{"iota-array":416,"is-buffer":418}],451:[function(e,t){"use strict";var a=e("double-bits"),r=ya(2,-1074);t.exports=function(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===t)return e;if(0===e)return 0>t?-r:r;var o=a.hi(e),i=a.lo(e);return t>e==0<e?4294967295===i?(o+=1,i=0):i+=1:0===i?(i=4294967295,o-=1):i-=1,a.pack(i,o)}},{"double-bits":167}],452:[function(e,t){function a(e,t,a,r){return["C",e,t,a,r,a,r]}function r(e,t,a,r,o,i){return["C",e/3+2/3*a,t/3+2/3*r,o/3+2/3*a,i/3+2/3*r,o,i]}function i(e,a,r,l,c,p,u,g,m,f){if(!f){var _=n(e,a,-c);e=_.x,a=_.y,_=n(g,m,-c),g=_.x,m=_.y;var b=(e-g)/2,x=(a-m)/2,y=b*b/(r*r)+x*x/(l*l);1<y&&(y=N(y),r=y*r,l=y*l);var v=r*r,w=l*l,T=(p==u?-1:1)*N(_a((v*w-v*x*x-w*b*b)/(v*x*x+w*b*b)));T==1/0&&(T=1);var A=T*r*x/l+(e+g)/2,S=T*-l*b/r+(a+m)/2,C=o(((a-S)/l).toFixed(9)),L=o(((m-S)/l).toFixed(9));C=e<A?s-C:C,L=g<A?s-L:L,0>C&&(C=2*s+C),0>L&&(L=2*s+L),u&&C>L&&(C-=2*s),!u&&L>C&&(L-=2*s)}else C=f[0],L=f[1],A=f[2],S=f[3];if(_a(L-C)>d){var E=L,I=g,z=m;L=C+d*(u&&L>C?1:-1),g=A+r*R(L),m=S+l*De(L);var P=i(g,m,r,l,c,0,u,I,z,[L,E,A,S])}var D=fa((L-C)/4),t=4/3*r*D,O=4/3*l*D,M=[2*e-(e+t*De(C)),2*a-(a-O*R(C)),g+t*De(L),m-O*R(L),g,m];if(f)return M;P&&(M=M.concat(P));for(var j=0,F;j<M.length;)F=n(M[j],M[j+1],c),M[j++]=F.x,M[j++]=F.y;return M}function n(e,t,a){return{x:e*R(a)-t*De(a),y:e*De(a)+t*R(a)}}function l(e){return e*(s/180)}var s=Pe,d=l(120);t.exports=function(e){for(var t=[],o=0,n=0,s=0,d=0,c=null,p=null,u=0,g=0,h=0,m=e.length,f;h<m;h++){var _=e[h],b=_[0];switch(b){case"M":s=_[1],d=_[2];break;case"A":_=i(u,g,_[1],_[2],l(_[3]),_[4],_[5],_[6],_[7]),_.unshift("C"),7<_.length&&(t.push(_.splice(0,7)),_.unshift("C"));break;case"S":var v=u,k=g;("C"==f||"S"==f)&&(v+=v-o,k+=k-n),_=["C",v,k,_[1],_[2],_[3],_[4]];break;case"T":"Q"==f||"T"==f?(c=2*u-c,p=2*g-p):(c=u,p=g),_=r(u,g,c,p,_[1],_[2]);break;case"Q":c=_[1],p=_[2],_=r(u,g,_[1],_[2],_[3],_[4]);break;case"L":_=a(u,g,_[1],_[2]);break;case"H":_=a(u,g,_[1],g);break;case"V":_=a(u,g,u,_[1]);break;case"Z":_=a(u,g,s,d);}f=b,u=_[_.length-2],g=_[_.length-1],4<_.length?(o=_[_.length-4],n=_[_.length-3]):(o=u,n=g),t.push(_)}return t}},{}],453:[function(e,t,a){a.vertexNormals=function(e,t,a){for(var r=t.length,o=Array(r),l=void 0===a?1e-6:a,s=0;s<r;++s)o[s]=[0,0,0];for(var s=0;s<e.length;++s)for(var d=e[s],g=0,h=d[d.length-1],y=d[0],f=0;f<d.length;++f){g=h,h=y,y=d[(f+1)%d.length];for(var x=t[g],_=t[h],b=t[y],T=[,,,],A=0,S=[,,,],C=0,L=0;3>L;++L)T[L]=x[L]-_[L],A+=T[L]*T[L],S[L]=b[L]-_[L],C+=S[L]*S[L];if(A*C>l)for(var E=o[h],I=1/N(A*C),L=0;3>L;++L){var z=(L+1)%3,u=(L+2)%3;E[L]+=I*(S[z]*T[u]-S[u]*T[z])}}for(var s=0;s<r;++s){for(var E=o[s],v=0,L=0;3>L;++L)v+=E[L]*E[L];if(v>l)for(var I=1/N(v),L=0;3>L;++L)E[L]*=I;else for(var L=0;3>L;++L)E[L]=0}return o},a.faceNormals=function(e,t,a){for(var r=e.length,o=Array(r),s=void 0===a?1e-6:a,d=0;d<r;++d){for(var c=e[d],p=[,,,],g=0;3>g;++g)p[g]=t[c[g]];for(var h=[,,,],m=[,,,],g=0;3>g;++g)h[g]=p[1][g]-p[0][g],m[g]=p[2][g]-p[0][g];for(var y=[,,,],n=0,g=0;3>g;++g){var f=(g+1)%3,u=(g+2)%3;y[g]=h[f]*m[u]-h[u]*m[f],n+=y[g]*y[g]}n=n>s?1/N(n):0;for(var g=0;3>g;++g)y[g]*=n;o[d]=y}return o}},{}],454:[function(e,t){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/"use strict";function a(e){if(null===e||e===void 0)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},a=0;10>a;a++)t["_"+D(a)]=a;var r=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==r.join(""))return!1;var o={};return["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t"].forEach(function(e){o[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}()?Object.assign:function(e){for(var t=a(e),l=1,d,c;l<arguments.length;l++){for(var p in d=Object(arguments[l]),d)o.call(d,p)&&(t[p]=d[p]);if(r){c=r(d);for(var u=0;u<c.length;u++)n.call(d,c[u])&&(t[c[u]]=d[c[u]])}}return t}},{}],455:[function(e,t){"use strict";t.exports=function(e,t,a,r,o,i,n,s,d,c){var p=t+i+c;if(0<u){var u=N(p+1);e[0]=.5*(n-d)/u,e[1]=.5*(s-r)/u,e[2]=.5*(a-i)/u,e[3]=.5*u}else{var g=va(t,i,c),u=N(2*g-p+1);t>=g?(e[0]=.5*u,e[1]=.5*(o+a)/u,e[2]=.5*(s+r)/u,e[3]=.5*(n-d)/u):i>=g?(e[0]=.5*(a+o)/u,e[1]=.5*u,e[2]=.5*(d+n)/u,e[3]=.5*(s-r)/u):(e[0]=.5*(r+s)/u,e[1]=.5*(n+d)/u,e[2]=.5*u,e[3]=.5*(a-o)/u)}return e}},{}],456:[function(e,t){"use strict";function a(e,t,a){return N(ya(e,2)+ya(t,2)+ya(a,2))}function r(e,t,a,r){return N(ya(e,2)+ya(t,2)+ya(a,2)+ya(r,2))}function o(e,t){var a=t[0],o=t[1],i=t[2],n=t[3],l=r(a,o,i,n);1e-6<l?(e[0]=a/l,e[1]=o/l,e[2]=i/l,e[3]=n/l):(e[0]=e[1]=e[2]=0,e[3]=1)}function i(e,t,a){this.radius=l([a]),this.center=l(t),this.rotation=l(e),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}function n(e){e=e||{};var t=e.center||[0,0,0],a=e.rotation||[0,0,0,1],r=e.radius||1;t=[].slice.call(t,0,3),a=[].slice.call(a,0,4),o(a,a);var n=new i(a,t,P(r));return n.setDistanceLimits(e.zoomMin,e.zoomMax),("eye"in e||"up"in e)&&n.lookAt(0,e.eye,e.center,e.up),n}t.exports=n;var l=e("filtered-vector"),s=e("gl-mat4/lookAt"),d=e("gl-mat4/fromQuat"),c=e("gl-mat4/invert"),p=e("./lib/quatFromFrame"),u=i.prototype;u.lastT=function(){return va(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},u.recalcMatrix=function(e){this.radius.curve(e),this.center.curve(e),this.rotation.curve(e);var t=this.computedRotation;o(t,t);var a=this.computedMatrix;d(a,t);var r=this.computedCenter,n=this.computedEye,l=this.computedUp,s=m(this.computedRadius[0]);n[0]=r[0]+s*a[2],n[1]=r[1]+s*a[6],n[2]=r[2]+s*a[10],l[0]=a[1],l[1]=a[5],l[2]=a[9];for(var c=0,p;3>c;++c){p=0;for(var u=0;3>u;++u)p+=a[c+4*u]*n[u];a[12+c]=-p}},u.getMatrix=function(e,t){this.recalcMatrix(e);var a=this.computedMatrix;if(t){for(var r=0;16>r;++r)t[r]=a[r];return t}return a},u.idle=function(e){this.center.idle(e),this.radius.idle(e),this.rotation.idle(e)},u.flush=function(e){this.center.flush(e),this.radius.flush(e),this.rotation.flush(e)},u.pan=function(e,t,r,o){t=t||0,r=r||0,o=o||0,this.recalcMatrix(e);var i=this.computedMatrix,n=i[1],l=i[5],s=i[9],d=a(n,l,s);n/=d,l/=d,s/=d;var c=i[0],p=i[4],u=i[8],g=c*n+p*l+u*s;c-=n*g,p-=l*g,u-=s*g;var h=a(c,p,u);c/=h,p/=h,u/=h;var y=i[2],f=i[6],x=i[10],_=y*n+f*l+x*s,b=y*c+f*p+x*u;y-=_*n+b*c,f-=_*l+b*p,x-=_*s+b*u;var v=a(y,f,x);y/=v,f/=v,x/=v;var k=c*t+n*r,w=p*t+l*r,T=u*t+s*r;this.center.move(e,k,w,T);var A=m(this.computedRadius[0]);A=va(1e-4,A+o),this.radius.set(e,P(A))},u.rotate=function(e,t,o,i){this.recalcMatrix(e),t=t||0,o=o||0;var n=this.computedMatrix,l=n[0],d=n[4],c=n[8],p=n[1],u=n[5],g=n[9],h=n[2],m=n[6],y=n[10],f=t*l+o*p,x=t*d+o*u,_=t*c+o*g,b=-(m*_-y*x),v=-(y*f-h*_),k=-(h*x-m*f),w=N(va(0,1-ya(b,2)-ya(v,2)-ya(k,2))),T=r(b,v,k,w);1e-6<T?(b/=T,v/=T,k/=T,w/=T):(b=v=k=0,w=1);var A=this.computedRotation,S=A[0],C=A[1],L=A[2],E=A[3],I=S*w+E*b+C*k-L*v,z=C*w+E*v+L*b-S*k,P=L*w+E*k+S*v-C*b,D=E*w-S*b-C*v-L*k;if(i){b=h,v=m,k=y;var O=De(i)/a(b,v,k);b*=O,v*=O,k*=O,w=R(t),I=I*w+D*b+z*k-P*v,z=z*w+D*v+P*b-I*k,P=P*w+D*k+I*v-z*b,D=D*w-I*b-z*v-P*k}var s=r(I,z,P,D);1e-6<s?(I/=s,z/=s,P/=s,D/=s):(I=z=P=0,D=1),this.rotation.set(e,I,z,P,D)},u.lookAt=function(e,t,a,r){this.recalcMatrix(e),a=a||this.computedCenter,t=t||this.computedEye,r=r||this.computedUp;var n=this.computedMatrix;s(n,t,a,r);var l=this.computedRotation;p(l,n[0],n[1],n[2],n[4],n[5],n[6],n[8],n[9],n[10]),o(l,l),this.rotation.set(e,l[0],l[1],l[2],l[3]);for(var d=0,c=0;3>c;++c)d+=ya(a[c]-t[c],2);this.radius.set(e,.5*P(va(d,1e-6))),this.center.set(e,a[0],a[1],a[2])},u.translate=function(e,t,a,r){this.center.move(e,t||0,a||0,r||0)},u.setMatrix=function(e,t){var a=this.computedRotation;p(a,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]),o(a,a),this.rotation.set(e,a[0],a[1],a[2],a[3]);var i=this.computedMatrix;c(i,t);var n=i[15];if(1e-6<_a(n)){var l=i[12]/n,s=i[13]/n,d=i[14]/n;this.recalcMatrix(e);var u=m(this.computedRadius[0]);this.center.set(e,l-i[2]*u,s-i[6]*u,d-i[10]*u),this.radius.idle(e)}else this.center.idle(e),this.radius.idle(e)},u.setDistance=function(e,t){0<t&&this.radius.set(e,P(t))},u.setDistanceLimits=function(e,t){e=0<e?P(e):-Infinity,t=0<t?P(t):1/0,t=va(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},u.getDistanceLimits=function(e){var t=this.radius.bounds;return e?(e[0]=m(t[0][0]),e[1]=m(t[1][0]),e):[m(t[0][0]),m(t[1][0])]},u.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:P(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},u.fromJSON=function(e){var a=this.lastT(),t=e.center;t&&this.center.set(a,t[0],t[1],t[2]);var o=e.rotation;o&&this.rotation.set(a,o[0],o[1],o[2],o[3]);var r=e.distance;r&&0<r&&this.radius.set(a,P(r)),this.setDistanceLimits(e.zoomMin,e.zoomMax)}},{"./lib/quatFromFrame":455,"filtered-vector":226,"gl-mat4/fromQuat":262,"gl-mat4/invert":265,"gl-mat4/lookAt":266}],457:[function(e,t){/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */"use strict";var a=e("repeat-string");t.exports=function(e,t,r){return r="undefined"==typeof r?" ":r+"",a(r,t)+e}},{"repeat-string":503}],458:[function(e,t){"use strict";function a(e,t){function r(e,t){for(var o=[],i=0,n;n=s.exec(e);){if(1e4<i++)throw Error("Circular references in parenthesis");o.push(e.slice(0,n.index)),o.push(r(t[n[1]],t)),e=e.slice(n.index+n[0].length)}return o.push(e),o}if("string"!=typeof e)return[e];var o=[e];"string"==typeof t||Array.isArray(t)?t={brackets:t}:!t&&(t={});var i=t.brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"],n=t.escape||"___",l=!!t.flat;i.forEach(function(e){function t(t){var a=o.push(t.slice(e[0].length,-e[1].length))-1;return i.push(a),n+a+n}var r=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join("")),i=[];o.forEach(function(e,n){for(var i=0,l;e!=l;)if(l=e,e=e.replace(r,t),1e4<i++)throw Error("References have circular dependency. Please, check them.");o[n]=e}),i=i.reverse(),o=o.map(function(t){return i.forEach(function(a){t=t.replace(new RegExp("(\\"+n+a+"\\"+n+")","g"),e[0]+"$1"+e[1])}),t})});var s=new RegExp("\\"+n+"([0-9]+)\\"+n);return l?o:r(o[0],o)}function r(e,t){function r(t,a){if(null==e[a])throw Error("Reference "+a+"is undefined");return e[a]}if(t&&t.flat){var o=t&&t.escape||"___",i=e[0],n;if(!i)return"";for(var l=new RegExp("\\"+o+"([0-9]+)\\"+o),s=0;i!=n;){if(1e4<s++)throw Error("Circular references in "+e);n=i,i=i.replace(l,r)}return i}return e.reduce(function e(t,a){return Array.isArray(a)&&(a=a.reduce(e,"")),t+a},"")}function o(e,t){return Array.isArray(e)?r(e,t):a(e,t)}o.parse=a,o.stringify=r,t.exports=o},{}],459:[function(e,t){"use strict";var a=e("pick-by-alias");t.exports=function(e){var t;return 1<arguments.length&&(e=arguments),"string"==typeof e?e=e.split(/\s/).map(parseFloat):"number"==typeof e&&(e=[e]),e.length&&"number"==typeof e[0]?1===e.length?t={width:e[0],height:e[0],x:0,y:0}:2===e.length?t={width:e[0],height:e[1],x:0,y:0}:t={x:e[0],y:e[1],width:e[2]-e[0]||0,height:e[3]-e[1]||0}:e&&(e=a(e,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),t={x:e.left||0,y:e.top||0},t.width=null==e.width?e.right?e.right-t.x:0:e.width,t.height=null==e.height?e.bottom?e.bottom-t.y:0:e.height),t}},{"pick-by-alias":465}],460:[function(e,t){function a(e){var t=e.match(i);return t?t.map(Number):[]}t.exports=function(e){var t=[];return e.replace(o,function(e,o,i){var n=o.toLowerCase();for(i=a(i),"m"==n&&2<i.length&&(t.push([o].concat(i.splice(0,2))),n="l",o="m"==o?"l":"L");;){if(i.length==r[n])return i.unshift(o),t.push(i);if(i.length<r[n])throw new Error("malformed path data");t.push([o].concat(i.splice(0,r[n])))}}),t};var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=/([astvzqmhlc])([^astvzqmhlc]*)/ig,i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig},{}],461:[function(e,t){t.exports=function(e,t){t||(t=[0,""]),e+="";var a=parseFloat(e,10);return t[0]=a,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],462:[function(e,t){(function(e){(function(){var a,r,o,i,n,l;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(a()-n)/1e6},r=e.hrtime,a=function(){var e;return e=r(),1e9*e[0]+e[1]},i=a(),l=1e9*e.uptime(),n=i-l):Date.now?(t.exports=function(){return Date.now()-o},o=Date.now()):(t.exports=function(){return new Date().getTime()-o},o=new Date().getTime())}).call(this)}).call(this,e("_process"))},{_process:482}],463:[function(e,t){"use strict";t.exports=function(e){var t=e.length;if(32>t){for(var r=1,o=0;o<t;++o)for(var n=0;n<o;++n)if(e[o]<e[n])r=-r;else if(e[o]===e[n])return 0;return r}for(var l=a.mallocUint8(t),o=0;o<t;++o)l[o]=0;for(var r=1,o=0;o<t;++o)if(!l[o]){var s=1;l[o]=1;for(var n=e[o];n!==o;n=e[n]){if(l[n])return a.freeUint8(l),0;s+=1,l[n]=1}1&s||(r=-r)}return a.freeUint8(l),r};var a=e("typedarray-pool")},{"typedarray-pool":545}],464:[function(e,t,a){"use strict";var o=e("typedarray-pool"),l=e("invert-permutation");a.rank=function(e){var a=e.length;switch(a){case 0:case 1:return 0;case 2:return e[1];default:}var n=o.mallocUint32(a),d=o.mallocUint32(a),c=0,p,u,g;for(l(e,d),g=0;g<a;++g)n[g]=e[g];for(g=a-1;0<g;--g)u=d[g],p=n[g],n[g]=n[u],n[u]=p,d[g]=d[p],d[p]=u,c=(c+p)*g;return o.freeUint32(d),o.freeUint32(n),c},a.unrank=function(e,a,o){switch(e){case 0:return o?o:[];case 1:return o?(o[0]=0,o):[0];case 2:return o?(a?(o[0]=0,o[1]=1):(o[0]=1,o[1]=0),o):a?[0,1]:[1,0];default:}o=o||Array(e);var n=1,l,d,c;for(o[0]=0,c=1;c<e;++c)o[c]=c,n=0|n*c;for(c=e-1;0<c;--c)l=0|a/n,a=0|a-l*n,n=0|n/c,d=0|o[c],o[c]=0|o[l],o[l]=0|d;return o}},{"invert-permutation":415,"typedarray-pool":545}],465:[function(e,t){"use strict";function a(e){return r[e]?r[e]:("string"==typeof e&&(e=r[e]=e.split(/\s*,\s*|\s+/)),e)}t.exports=function(e,t,r){var o={},n,l;if("string"==typeof t&&(t=a(t)),Array.isArray(t)){var s={};for(l=0;l<t.length;l++)s[t[l]]=!0;t=s}for(n in t)t[n]=a(t[n]);var d={};for(n in t){var c=t[n];if(Array.isArray(c))for(l=0;l<c.length;l++){var p=c[l];if(r&&(d[p]=!0),p in e){if(o[n]=e[p],r)for(var u=l;u<c.length;u++)d[c[u]]=!0;break}}else n in e&&(t[n]&&(o[n]=e[n]),r&&(d[n]=!0))}if(r)for(n in e)d[n]||(o[n]=e[n]);return o};var r={}},{}],466:[function(e,t){"use strict";t.exports=function(e,t){function o(e,t){var r=g[t][e[t]];r.splice(r.indexOf(e),1)}function n(n,a,l){for(var s=0,d,c,u;2>s;++s)if(0<g[s][a].length){d=g[s][a][0],u=s;break}c=d[1^u];for(var h=0,m;2>h;++h){m=g[h][a];for(var y=0;y<m.length;++y){var f=m[y],e=f[1^h],p=r(t[n],t[a],t[c],t[e]);0<p&&(d=f,c=e,u=h)}}return l?c:(d&&o(d,u),c)}function l(e,i){var l=g[i][e][0],s=[e];o(l,i);for(var p=l[1^i];;){for(;p!==e;)s.push(p),p=n(s[s.length-2],p,!1);if(0===g[0][e].length+g[1][e].length)break;var h=s[s.length-1],a=e,m=s[1],c=n(h,a,!0);if(0>r(t[h],t[a],t[m],t[c]))break;s.push(e),p=n(h,a)}return s}function s(e,t){return t[1]===t[t.length-1]}for(var d=0|t.length,p=e.length,g=[Array(d),Array(d)],h=0;h<d;++h)g[0][h]=[],g[1][h]=[];for(var h=0,a;h<p;++h)a=e[h],g[0][a[0]].push(a),g[1][a[1]].push(a);for(var u=[],h=0;h<d;++h)0===g[0][h].length+g[1][h].length&&u.push([h]);for(var h=0;h<d;++h)for(var m=0,y;2>m;++m){for(y=[];0<g[m][h].length;){var f=g[0][h].length,x=l(h,m);s(y,x)?y.push.apply(y,x):(0<y.length&&u.push(y),y=x)}0<y.length&&u.push(y)}return u};var r=e("compare-angle")},{"compare-angle":127}],467:[function(e,t){"use strict";t.exports=function(t,r){for(var o=a(t,r.length),l=Array(r.length),s=Array(r.length),d=[],c=0,p;c<r.length;++c)p=o[c].length,s[c]=p,l[c]=!0,1>=p&&d.push(c);for(;0<d.length;){var g=d.pop();l[g]=!1;for(var h=o[g],c=0,n;c<h.length;++c)n=h[c],0==--s[n]&&d.push(n)}for(var m=Array(r.length),y=[],c=0;c<r.length;++c)if(l[c]){var g=y.length;m[c]=g,y.push(r[c])}else m[c]=-1;for(var f=[],c=0,x;c<t.length;++c)x=t[c],l[x[0]]&&l[x[1]]&&f.push([m[x[0]],m[x[1]]]);return[f,y]};var a=e("edges-to-adjacency-list")},{"edges-to-adjacency-list":171}],468:[function(e,t){"use strict";function r(e,t){for(var a=Array(e),r=0;r<e;++r)a[r]=t;return a}function o(e){for(var t=Array(e),a=0;a<e;++a)t[a]=[];return t}function i(e,t){function h(e){for(var r=e.length,o=[0],i=0;i<r;++i){var n=t[e[i]],a=t[e[(i+1)%r]],l=d(-n[0],n[1]),s=d(-n[0],a[1]),c=d(a[0],n[1]),u=d(a[0],a[1]);o=p(o,p(p(l,s),p(c,u)))}return 0<o[o.length-1]}function m(e){for(var t=e.length,a=0;a<t;++a)if(!U[e[a]])return!1;return!0}var y=g(e,t);e=y[0],t=y[1];for(var x=t.length,_=e.length,v=n(e,t.length),w=0;w<x;++w)if(1==v[w].length%2)throw new Error("planar-graph-to-polyline: graph must be manifold");var T=l(e,t);T=T.filter(h);for(var A=T.length,S=Array(A),C=Array(A),w=0;w<A;++w){S[w]=w;var L=Array(A),E=T[w].map(function(e){return t[e]}),I=s([E]),z=0;outer:for(var P=0;P<A;++P)if(L[P]=0,w!=P){for(var D=T[P],O=D.length,R=0,M;R<O;++R)if(M=I(t[D[R]]),0!==M){0>M&&(L[P]=1,z+=1);continue outer}L[P]=1,z+=1}C[w]=[z,w,L]}C.sort(function(e,t){return t[0]-e[0]});for(var w=0;w<A;++w)for(var L=C[w],F=L[1],B=L[2],P=0;P<A;++P)B[P]&&(S[P]=F);for(var N=o(A),w=0;w<A;++w)N[w].push(S[w]),N[S[w]].push(w);for(var V={},U=r(x,!1),w=0;w<A;++w)for(var D=T[w],O=D.length,P=0;P<O;++P){var H=D[P],a=D[(P+1)%O],b=ea(H,a)+":"+va(H,a);if(b in V){var G=V[b];N[G].push(w),N[w].push(G),U[H]=U[a]=!0}else V[b]=w}for(var q=[],Y=r(A,-1),w=0;w<A;++w)S[w]!==w||m(T[w])?Y[w]=-1:(q.push(w),Y[w]=0);for(var y=[];0<q.length;){var W=q.pop(),X=N[W];u(X,function(e,t){return e-t});var Z=X.length,K=Y[W],J;if(0===K){var D=T[W];J=[D]}for(var w=0,Q;w<Z;++w)if((Q=X[w],!(0<=Y[Q]))&&(Y[Q]=1^K,q.push(Q),0===K)){var D=T[Q];m(D)||(D.reverse(),J.push(D))}0===K&&y.push(J)}return y}t.exports=i;var n=e("edges-to-adjacency-list"),l=e("planar-dual"),s=e("point-in-big-polygon"),d=e("two-product"),p=e("robust-sum"),u=e("uniq"),g=e("./lib/trim-leaves")},{"./lib/trim-leaves":467,"edges-to-adjacency-list":171,"planar-dual":466,"point-in-big-polygon":472,"robust-sum":515,"two-product":543,uniq:547}],469:[function(e,t){"use strict";t.exports=e("./quad")},{"./quad":471}],470:[function(e,t,a){arguments[4][111][0].apply(a,arguments)},{dup:111}],471:[function(e,t){"use strict";function a(e,t){for(var a=t[0],r=t[1],l=t[2],s=t[3],d=Array(e.length),c=0,p=e.length/2;c<p;c++)d[2*c]=o((e[2*c]-a)*(1/(l-a)),0,1),d[2*c+1]=o((e[2*c+1]-r)*(1/(s-r)),0,1);return d}var r=e("binary-search-bounds"),o=e("clamp"),i=e("parse-rect"),s=e("array-bounds"),d=e("pick-by-alias"),c=e("defined"),p=e("flatten-vertex-data"),u=e("is-obj"),g=e("dtype"),h=e("math-log2");t.exports=function(e,t){function o(e,t,a,r,n,s){if(!r.length)return null;var d=w[n]||(w[n]=[]),c=A[n]||(A[n]=[]),p=T[n]||(T[n]=[]),u=d.length;if(n++,n>_){for(var g=0;g<r.length;g++)d.push(r[g]),c.push(s),p.push(null,null,null,null);return u}if(d.push(r[0]),c.push(s),1>=r.length)return p.push(null,null,null,null),u;for(var h=.5*a,m=e+h,y=t+h,f=[],x=[],b=[],k=[],S=1,C=r.length;S<C;S++){var l=r[S],L=v[2*l],E=v[2*l+1];L<m?E<y?f.push(l):x.push(l):E<y?b.push(l):k.push(l)}return s<<=2,p.push(o(e,t,h,f,n,s),o(e,y,h,x,n,s+1),o(m,t,h,b,n,s+2),o(m,y,h,k,n,s+3)),u}function m(){function t(a,o,n,l,s,d){if(null!==s&&null!==d){if(!(k>a+n||A>o+n||S<a||C<o)&&!(l>=L)&&s!==d){var c=w[l];void 0===d&&(d=c.length);for(var p=s;p<d;p++){var u=c[p],g=e[2*u],h=e[2*u+1];g>=m&&g<=x&&h>=f&&h<=_&&I.push(u)}var y=T[l],b=y[4*s+0],v=y[4*s+1],E=y[4*s+2],z=y[4*s+3],P=r(y,s+1),D=.5*n,O=l+1;t(a,o,D,O,b,v||E||z||P),t(a,o+D,D,O,v,E||z||P),t(a+D,o,D,O,E,z||P),t(a+D,o+D,D,O,z,P)}}}function r(e,t){for(var a=null,r=0;null===a;)if(a=e[4*t+r],r++,r>e.length)return null;return a}for(var o=[],n=arguments.length;n--;)o[n]=arguments[n];var l;if(u(o[o.length-1])){var s=o.pop();o.length||null==s.x&&null==s.l&&null==s.left||(o=[s],l={}),l=d(s,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else l={};o.length||(o=b);var p=i.apply(void 0,o),g=[ea(p.x,p.x+p.width),ea(p.y,p.y+p.height),va(p.x,p.x+p.width),va(p.y,p.y+p.height)],m=g[0],f=g[1],x=g[2],_=g[3],v=a([m,f,x,_],b),k=v[0],A=v[1],S=v[2],C=v[3],L=c(l.level,w.length);if(null!=l.d){var E;"number"==typeof l.d?E=[l.d,l.d]:l.d.length&&(E=l.d),L=ea(va(M(-h(_a(E[0])/(b[2]-b[0]))),M(-h(_a(E[1])/(b[3]-b[1])))),L)}if(L=ea(L,w.length),l.lod)return y(k,A,S,C,L);var I=[];return t(0,0,1,0,0,1),I}function y(e,t,a,o,i){for(var n=[],l=0;l<i;l++){var s=A[l],d=S[l][0],c=f(e,t,l),p=f(a,o,l),u=r.ge(s,c),g=r.gt(s,p,u,s.length-1);n[l]=[u+d,g+d]}return n}function f(e,t,a){for(var r=1,o=.5,n=.5,l=.5,s=0;s<a;s++)r<<=2,r+=e<o?t<n?0:1:t<n?2:3,l*=.5,o+=e<o?-l:l,n+=t<n?-l:l;return r}t||(t={}),e=p(e,"float64"),t=d(t,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var _=c(t.maxDepth,255),b=c(t.bounds,s(e,2));b[0]===b[2]&&b[2]++,b[1]===b[3]&&b[3]++;var v=a(e,b),k=e.length>>>1,n;t.dtype||(t.dtype="array"),"string"==typeof t.dtype?n=new(g(t.dtype))(k):t.dtype&&(n=t.dtype,Array.isArray(n)&&(n.length=k));for(var x=0;x<k;++x)n[x]=x;var w=[],T=[],A=[],S=[];o(0,0,1,n,0,1);for(var C=0,L=0,E;L<w.length;L++){if(E=w[L],n.set)n.set(E,C);else for(var I=0,z=E.length;I<z;I++)n[I+C]=E[I];var l=C+w[L].length;S[L]=[C,l],C=l}return n.range=m,n}},{"array-bounds":65,"binary-search-bounds":470,clamp:115,defined:164,dtype:169,"flatten-vertex-data":227,"is-obj":421,"math-log2":432,"parse-rect":459,"pick-by-alias":465}],472:[function(e,t){function a(){return!0}function r(e){return function(t,r){var o=e[t];return!!o&&!!o.queryPoint(r,a)}}function o(e){for(var t={},a=0;a<e.length;++a){var o=e[a],n=o[0][0],l=o[0][1],s=o[1][1],d=[ea(l,s),va(l,s)];n in t?t[n].push(d):t[n]=[d]}for(var c={},p=Object.keys(t),a=0,u;a<p.length;++a)u=t[p[a]],c[p[a]]=h(u);return r(c)}function n(e,t){return function(a){var r=m.le(t,a[0]);if(0>r)return 1;var i=e[r];if(!i)if(0<r&&t[r]===a[0])i=e[r-1];else return 1;for(var n=1;i;){var l=i.key,s=u(a,l[0],l[1]);if(l[0][0]<l[1][0]){if(0>s)i=i.left;else if(0<s)n=-1,i=i.right;else return 0;}else if(0<s)i=i.left;else if(0>s)n=1,i=i.right;else return 0}return n}}function l(){return 1}function d(e){return function(t){return e(t[0],t[1])?0:1}}function c(e,t){return function(a){return e(a[0],a[1])?0:t(a)}}t.exports=function(e){for(var r=e.length,p=[],u=[],h=0;h<r;++h)for(var m=e[h],y=m.length,f=y-1,x=0;x<y;f=x++){var _=m[f],a=m[x];_[0]===a[0]?u.push([_,a]):p.push([_,a])}if(0===p.length)return 0===u.length?l:d(o(u));var b=g(p),v=n(b.slabs,b.coordinates);return 0===u.length?v:c(o(u),v)};var u=e("robust-orientation")[3],g=e("slab-decomposition"),h=e("interval-tree-1d"),m=e("binary-search-bounds")},{"binary-search-bounds":91,"interval-tree-1d":414,"robust-orientation":510,"slab-decomposition":526}],473:[function(e,t){function a(e,t,a){var r=u.segments(e),o=u.segments(t),i=u.combine(r,o),n=a(i);return u.polygon(n)}/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var r=e("./lib/build-log"),o=e("./lib/epsilon"),n=e("./lib/intersecter"),l=e("./lib/segment-chainer"),s=e("./lib/segment-selector"),d=e("./lib/geojson"),c=!1,p=o(),u;u={buildLog:function(e){return!0===e?c=r():!1==e&&(c=!1),!1!==c&&c.list},epsilon:function(e){return p.epsilon(e)},segments:function(e){var t=n(!0,p,c);return e.regions.forEach(t.addRegion),{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){var a=n(!1,p,c);return{combined:a.calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,c),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,c),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,c),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,c),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,c),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:l(e.segments,p,c),inverted:e.inverted}},polygonFromGeoJSON:function(e){return d.toPolygon(u,e)},polygonToGeoJSON:function(e){return d.fromPolygon(u,p,e)},union:function(e,t){return a(e,t,u.selectUnion)},intersect:function(e,t){return a(e,t,u.selectIntersect)},difference:function(e,t){return a(e,t,u.selectDifference)},differenceRev:function(e,t){return a(e,t,u.selectDifferenceRev)},xor:function(e,t){return a(e,t,u.selectXor)}},"object"==typeof window&&(window.PolyBool=u),t.exports=u},{"./lib/build-log":474,"./lib/epsilon":475,"./lib/geojson":476,"./lib/intersecter":477,"./lib/segment-chainer":479,"./lib/segment-selector":480}],474:[function(e,t){t.exports=function(){function e(e,t){return r.list.push({type:e,data:t?JSON.parse(JSON.stringify(t)):void 0}),r}var t=0,a=!1,r;return r={list:[],segmentId:function(){return t++},checkIntersection:function(t,a){return e("check",{seg1:t,seg2:a})},segmentChop:function(t,a){return e("div_seg",{seg:t,pt:a}),e("chop",{seg:t,pt:a})},statusRemove:function(t){return e("pop_seg",{seg:t})},segmentUpdate:function(t){return e("seg_update",{seg:t})},segmentNew:function(t,a){return e("new_seg",{seg:t,primary:a})},segmentRemove:function(t){return e("rem_seg",{seg:t})},tempStatus:function(t,a,r){return e("temp_status",{seg:t,above:a,below:r})},rewind:function(t){return e("rewind",{seg:t})},status:function(t,a,r){return e("status",{seg:t,above:a,below:r})},vert:function(t){return t===a?r:(a=t,e("vert",{x:t}))},log:function(t){return"string"!=typeof t&&(t=JSON.stringify(t,!1,"  ")),e("log",{txt:t})},reset:function(){return e("reset")},selected:function(t){return e("selected",{segs:t})},chainStart:function(t){return e("chain_start",{seg:t})},chainRemoveHead:function(t,a){return e("chain_rem_head",{index:t,pt:a})},chainRemoveTail:function(t,a){return e("chain_rem_tail",{index:t,pt:a})},chainNew:function(t,a){return e("chain_new",{pt1:t,pt2:a})},chainMatch:function(t){return e("chain_match",{index:t})},chainClose:function(t){return e("chain_close",{index:t})},chainAddHead:function(t,a){return e("chain_add_head",{index:t,pt:a})},chainAddTail:function(t,a){return e("chain_add_tail",{index:t,pt:a})},chainConnect:function(t,a){return e("chain_con",{index1:t,index2:a})},chainReverse:function(t){return e("chain_rev",{index:t})},chainJoin:function(t,a){return e("chain_join",{index1:t,index2:a})},done:function(){return e("done")}},r}},{}],475:[function(e,t){t.exports=function(e){"number"!=typeof e&&(e=1e-10);var t={epsilon:function(t){return"number"==typeof t&&(e=t),e},pointAboveOrOnLine:function(t,a,r){var o=a[0],i=a[1],n=r[0],l=r[1],s=t[0],d=t[1];return(n-o)*(d-i)-(l-i)*(s-o)>=-e},pointBetween:function(t,a,r){var o=t[1]-a[1],i=r[0]-a[0],n=t[0]-a[0],l=r[1]-a[1],s=n*i+o*l;if(s<e)return!1;return!(s-(i*i+l*l)>-e)},pointsSameX:function(t,a){return _a(t[0]-a[0])<e},pointsSameY:function(t,a){return _a(t[1]-a[1])<e},pointsSame:function(e,a){return t.pointsSameX(e,a)&&t.pointsSameY(e,a)},pointsCompare:function(e,a){return t.pointsSameX(e,a)?t.pointsSameY(e,a)?0:e[1]<a[1]?-1:1:e[0]<a[0]?-1:1},pointsCollinear:function(t,a,r){var o=t[0]-a[0],i=t[1]-a[1],n=a[0]-r[0],l=a[1]-r[1];return _a(o*l-n*i)<e},linesIntersect:function(t,a,r,o){var i=a[0]-t[0],n=a[1]-t[1],l=o[0]-r[0],s=o[1]-r[1],d=i*s-n*l;if(_a(d)<e)return!1;var c=t[0]-r[0],p=t[1]-r[1],u=(l*p-s*c)/d,g=(i*p-n*c)/d,h={alongA:0,alongB:0,pt:[t[0]+u*i,t[1]+u*n]};return h.alongA=u<=-e?-2:u<e?-1:u-1<=-e?0:u-1<e?1:2,h.alongB=g<=-e?-2:g<e?-1:g-1<=-e?0:g-1<e?1:2,h},pointInsideRegion:function(t,a){for(var r=t[0],o=t[1],n=a[a.length-1][0],l=a[a.length-1][1],s=!1,d=0;d<a.length;d++){var c=a[d][0],p=a[d][1];p-o>e!=l-o>e&&(n-c)*(o-p)/(l-p)+c-r>e&&(s=!s),n=c,l=p}return s}};return t}},{}],476:[function(e,t){t.exports={toPolygon:function(e,t){function a(t){function a(t){var a=t.slice(0,t.length-1);return e.segments({inverted:!1,regions:[a]})}if(0>=t.length)return e.segments({inverted:!1,regions:[]});for(var r=a(t[0]),o=1;o<t.length;o++)r=e.selectDifference(e.combine(r,a(t[o])));return r}if("Polygon"===t.type)return e.polygon(a(t.coordinates));if("MultiPolygon"===t.type){for(var r=e.segments({inverted:!1,regions:[]}),o=0;o<t.coordinates.length;o++)r=e.selectUnion(e.combine(r,a(t.coordinates[o])));return e.polygon(r)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,a){function r(e,a){return t.pointInsideRegion([.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])],a)}function o(e){return{region:e,children:[]}}function n(e,t){for(var a=0,l;a<e.children.length;a++)if(l=e.children[a],r(t,l.region))return void n(l,t);for(var s=o(t),a=0,l;a<e.children.length;a++)l=e.children[a],r(l.region,t)&&(s.children.push(l),e.children.splice(a,1),a--);e.children.push(s)}function l(e,t){for(var a=0,r=e[e.length-1][0],o=e[e.length-1][1],n=[],l=0;l<e.length;l++){var s=e[l][0],d=e[l][1];n.push([s,d]),a+=d*r-s*o,r=s,o=d}var c=0>a;return c!==t&&n.reverse(),n.push([n[0][0],n[0][1]]),n}function s(e){var t=[l(e.region,!1)];g.push(t);for(var a=0;a<e.children.length;a++)t.push(d(e.children[a]))}function d(e){for(var t=0;t<e.children.length;t++)s(e.children[t]);return l(e.region,!0)}a=e.polygon(e.segments(a));for(var c=o(null),p=0,u;p<a.regions.length;p++)u=a.regions[p],3>u.length||n(c,u);for(var g=[],p=0;p<c.children.length;p++)s(c.children[p]);return 0>=g.length?{type:"Polygon",coordinates:[]}:1==g.length?{type:"Polygon",coordinates:g[0]}:{type:"MultiPolygon",coordinates:g}}}},{}],477:[function(e,t){var a=e("./linked-list");t.exports=function(e,t,r){function o(e,t){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:null,below:null},otherFill:null}}function i(e,t,a){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:a.myFill.above,below:a.myFill.below},otherFill:null}}function n(e,a,r,o,i,n){var l=t.pointsCompare(a,i);return 0===l?t.pointsSame(r,n)?0:e===o?t.pointAboveOrOnLine(r,o?i:n,o?n:i)?1:-1:e?1:-1:l}function l(e,t){h.insertBefore(e,function(a){var r=n(e.isStart,e.pt,t,a.isStart,a.pt,a.other.pt);return 0>r})}function s(e,t){var r=a.node({isStart:!0,pt:e.start,seg:e,primary:t,other:null,status:null});return l(r,e.end),r}function d(e,t,r){var o=a.node({isStart:!1,pt:t.end,seg:t,primary:r,other:e,status:null});e.other=o,l(o,e.pt)}function c(e,t){var a=s(e,t);return d(a,e,t),a}function p(e,t){r&&r.segmentChop(e.seg,t),e.other.remove(),e.seg.end=t,e.other.pt=t,l(e.other,e.pt)}function u(e,t){var a=i(t,e.seg.end,e.seg);return p(e,t),c(a,e.primary)}function g(o,i){function n(e,a){var r=e.seg.start,o=e.seg.end,i=a.seg.start,n=a.seg.end;return t.pointsCollinear(r,i,n)?t.pointsCollinear(o,i,n)?1:t.pointAboveOrOnLine(o,i,n)?1:-1:t.pointAboveOrOnLine(r,i,n)?1:-1}function l(e){return c.findTransition(function(t){var a=n(e,t.ev);return 0<a})}function d(e,a){var o=e.seg,n=a.seg,l=o.start,s=o.end,d=n.start,c=n.end;r&&r.checkIntersection(o,n);var p=t.linesIntersect(l,s,d,c);if(!1===p){if(!t.pointsCollinear(l,s,d))return!1;if(t.pointsSame(l,c)||t.pointsSame(s,d))return!1;var i=t.pointsSame(l,d),g=t.pointsSame(s,c);if(i&&g)return a;var h=!i&&t.pointBetween(l,d,c),m=!g&&t.pointBetween(s,d,c);if(i)return m?u(a,s):u(e,c),a;h&&(g||(m?u(a,s):u(e,c)),u(a,l))}else 0===p.alongA&&(-1===p.alongB?u(e,d):0===p.alongB?u(e,p.pt):1===p.alongB&&u(e,c)),0===p.alongB&&(-1===p.alongA?u(a,l):0===p.alongA?u(a,p.pt):1===p.alongA&&u(a,s));return!1}for(var c=a.create(),p=[],g;!h.isEmpty();){if(g=h.getHead(),r&&r.vert(g.pt[0]),g.isStart){function t(){if(y){var e=d(g,y);if(e)return e}return!!f&&d(g,f)}r&&r.segmentNew(g.seg,g.primary);var m=l(g),y=m.before?m.before.ev:null,f=m.after?m.after.ev:null;r&&r.tempStatus(g.seg,!!y&&y.seg,!!f&&f.seg);var x=t();if(x){if(e){var _;_=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below,_&&(x.seg.myFill.above=!x.seg.myFill.above)}else x.seg.otherFill=g.seg.myFill;r&&r.segmentUpdate(x.seg),g.other.remove(),g.remove()}if(h.getHead()!==g){r&&r.rewind(g.seg);continue}if(e){var _;_=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below,g.seg.myFill.below=f?f.seg.myFill.above:o,g.seg.myFill.above=_?!g.seg.myFill.below:g.seg.myFill.below}else if(null===g.seg.otherFill){var b;b=f?g.primary===f.primary?f.seg.otherFill.above:f.seg.myFill.above:g.primary?i:o,g.seg.otherFill={above:b,below:b}}r&&r.status(g.seg,!!y&&y.seg,!!f&&f.seg),g.other.status=m.insert(a.node({ev:g}))}else{var v=g.status;if(null===v)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(c.exists(v.prev)&&c.exists(v.next)&&d(v.prev.ev,v.next.ev),r&&r.statusRemove(v.ev.seg),v.remove(),!g.primary){var k=g.seg.myFill;g.seg.myFill=g.seg.otherFill,g.seg.otherFill=k}p.push(g.seg)}h.getHead().remove()}return r&&r.done(),p}var h=a.create();return e?{addRegion:function(e){for(var a=e[e.length-1],r=0,n;r<e.length;r++){n=a,a=e[r];var l=t.pointsCompare(n,a);0===l||c(o(0>l?n:a,0>l?a:n),!0)}},calculate:function(e){return g(e,!1)}}:{calculate:function(e,t,a,r){return e.forEach(function(e){c(i(e.start,e.end,e),!0)}),a.forEach(function(e){c(i(e.start,e.end,e),!1)}),g(t,r)}}}},{"./linked-list":478}],478:[function(e,t){t.exports={create:function(){var e={root:{root:!0,next:null},exists:function(t){return null!==t&&t!==e.root},isEmpty:function(){return null===e.root.next},getHead:function(){return e.root.next},insertBefore:function(t,a){for(var r=e.root,o=e.root.next;null!==o;){if(a(o))return t.prev=o.prev,t.next=o,o.prev.next=t,void(o.prev=t);r=o,o=o.next}r.next=t,t.prev=r,t.next=null},findTransition:function(t){for(var a=e.root,r=e.root.next;null!==r&&!t(r);)a=r,r=r.next;return{before:a===e.root?null:a,after:r,insert:function(e){return e.prev=a,e.next=r,a.next=e,null!==r&&(r.prev=e),e}}}};return e},node:function(e){return e.prev=null,e.next=null,e.remove=function(){e.prev.next=e.next,e.next&&(e.next.prev=e.prev),e.prev=null,e.next=null},e}}},{}],479:[function(e,t){t.exports=function(e,t,a){var r=[],o=[];return e.forEach(function(e){function n(e,t,a){return(g.index=e,g.matches_head=t,g.matches_pt1=a,g===p)?(g=u,!1):(g=null,!0)}function l(e){a&&a.chainReverse(e),r[e].reverse()}function s(e,o){var i=r[e],n=r[o],l=i[i.length-1],s=i[i.length-2],d=n[0],c=n[1];t.pointsCollinear(s,l,d)&&(a&&a.chainRemoveTail(e,l),i.pop(),l=s),t.pointsCollinear(l,d,c)&&(a&&a.chainRemoveHead(o,d),n.shift()),a&&a.chainJoin(e,o),r[e]=i.concat(n),r.splice(o,1)}var d=e.start,c=e.end;if(t.pointsSame(d,c))return void console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");a&&a.chainStart(e);for(var p={index:0,matches_head:!1,matches_pt1:!1},u={index:0,matches_head:!1,matches_pt1:!1},g=p,h=0;h<r.length;h++){var m=r[h],y=m[0],f=m[1],x=m[m.length-1],_=m[m.length-2];if(t.pointsSame(y,d)){if(n(h,!0,!0))break;}else if(t.pointsSame(y,c)){if(n(h,!0,!1))break;}else if(t.pointsSame(x,d)){if(n(h,!1,!0))break;}else if(t.pointsSame(x,c)&&n(h,!1,!1))break}if(g===p)return r.push([d,c]),void(a&&a.chainNew(d,c));if(g===u){a&&a.chainMatch(p.index);var b=p.index,v=p.matches_pt1?c:d,k=p.matches_head,m=r[b],w=k?m[0]:m[m.length-1],T=k?m[1]:m[m.length-2],A=k?m[m.length-1]:m[0],C=k?m[m.length-2]:m[1];return(t.pointsCollinear(T,w,v)&&(k?(a&&a.chainRemoveHead(p.index,v),m.shift()):(a&&a.chainRemoveTail(p.index,v),m.pop()),w=T),t.pointsSame(A,v))?(r.splice(b,1),t.pointsCollinear(C,A,w)&&(k?(a&&a.chainRemoveTail(p.index,w),m.pop()):(a&&a.chainRemoveHead(p.index,w),m.shift())),a&&a.chainClose(p.index),void o.push(m)):void(k?(a&&a.chainAddHead(p.index,v),m.unshift(v)):(a&&a.chainAddTail(p.index,v),m.push(v)))}var L=p.index,E=u.index;a&&a.chainConnect(L,E);var S=r[L].length<r[E].length;p.matches_head?u.matches_head?S?(l(L),s(L,E)):(l(E),s(E,L)):s(E,L):u.matches_head?s(L,E):S?(l(L),s(E,L)):(l(E),s(L,E))}),o}},{}],480:[function(e,t){function a(e,t,a){var r=[];return e.forEach(function(e){var o=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);0!==t[o]&&r.push({id:a?a.segmentId():-1,start:e.start,end:e.end,myFill:{above:1===t[o],below:2===t[o]},otherFill:null})}),a&&a.selected(r),r}t.exports={union:function(e,t){return a(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return a(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return a(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return a(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return a(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}}},{}],481:[function(e,t){"use strict";function a(e,a,l,p,g){r.length<p.length&&(r=new Float64Array(p.length),o=new Float64Array(p.length),n=new Float64Array(p.length));for(var h=0;h<p.length;++h)r[h]=e[h]-p[h],o[h]=a[h]-e[h],n[h]=l[h]-e[h];for(var m=0,y=0,f=0,x=0,_=0,b=0,h=0;h<p.length;++h){var v=o[h],k=n[h],w=r[h];m+=v*v,y+=v*k,f+=k*k,x+=w*v,_+=w*k,b+=w*w}var d=_a(m*f-y*y),T=y*_-f*x,A=y*x-m*_,S;if(!(T+A<=d)){var C,L,E,I;0>T?(C=y+x,L=f+_,L>C?(E=L-C,I=m-2*y+f,E>=I?(T=1,A=0,S=m+2*x+b):(T=E/I,A=1-T,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*_)+b)):(T=0,0>=L?(A=1,S=f+2*_+b):0<=_?(A=0,S=b):(A=-_/f,S=_*A+b))):0>A?(C=y+_,L=m+x,L>C?(E=L-C,I=m-2*y+f,E>=I?(A=1,T=0,S=f+2*_+b):(A=E/I,T=1-A,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*_)+b)):(A=0,0>=L?(T=1,S=m+2*x+b):0<=x?(T=0,S=b):(T=-x/m,S=x*T+b))):(E=f+_-y-x,0>=E?(T=0,A=1,S=f+2*_+b):(I=m-2*y+f,E>=I?(T=1,A=0,S=m+2*x+b):(T=E/I,A=1-T,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*_)+b)))}else if(0>T)0>A?0>x?(A=0,-x>=m?(T=1,S=m+2*x+b):(T=-x/m,S=x*T+b)):(T=0,0<=_?(A=0,S=b):-_>=f?(A=1,S=f+2*_+b):(A=-_/f,S=_*A+b)):(T=0,0<=_?(A=0,S=b):-_>=f?(A=1,S=f+2*_+b):(A=-_/f,S=_*A+b));else if(0>A)A=0,0<=x?(T=0,S=b):-x>=m?(T=1,S=m+2*x+b):(T=-x/m,S=x*T+b);else{var z=1/d;T*=z,A*=z,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*_)+b}for(var P=1-T-A,h=0;h<p.length;++h)g[h]=P*e[h]+T*a[h]+A*l[h];return 0>S?0:S}var r=new Float64Array(4),o=new Float64Array(4),n=new Float64Array(4);t.exports=a},{}],482:[function(e,t){function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(p===setTimeout)return setTimeout(t,0);if((p===a||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(a){try{return p.call(null,t,0)}catch(a){return p.call(this,t,0)}}}function i(t){if(u===clearTimeout)return clearTimeout(t);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(a){try{return u.call(null,t)}catch(a){return u.call(this,t)}}}function n(){h&&y&&(h=!1,y.length?g=y.concat(g):m=-1,g.length&&l())}function l(){if(!h){var e=o(n);h=!0;for(var t=g.length;t;){for(y=g,g=[];++m<t;)y&&y[m].run();m=-1,t=g.length}y=null,h=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function d(){}var c=t.exports={},p,u;(function(){try{p="function"==typeof setTimeout?setTimeout:a}catch(t){p=a}try{u="function"==typeof clearTimeout?clearTimeout:r}catch(t){u=r}})();var g=[],h=!1,m=-1,y;c.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];g.push(new s(e,t)),1!==g.length||h||o(l)},s.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=d,c.addListener=d,c.once=d,c.off=d,c.removeListener=d,c.removeAllListeners=d,c.emit=d,c.prependListener=d,c.prependOnceListener=d,c.listeners=function(){return[]},c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],483:[function(e,t){t.exports=e("gl-quat/slerp")},{"gl-quat/slerp":293}],484:[function(e,t){(function(a){for(var r=e("performance-now"),o="undefined"==typeof window?a:window,n=["moz","webkit"],l="AnimationFrame",s=o["request"+l],d=o["cancel"+l]||o["cancelRequest"+l],c=0;!s&&c<n.length;c++)s=o[n[c]+"Request"+l],d=o[n[c]+"Cancel"+l]||o[n[c]+"CancelRequest"+l];if(!s||!d){var p=0,u=0,g=[];s=function(e){if(0===g.length){var t=r(),a=va(0,1e3/60-(t-p));p=a+t,setTimeout(function(){var e=g.slice(0);g.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(p)}catch(t){setTimeout(function(){throw t},0)}},V(a))}return g.push({handle:++u,callback:e,cancelled:!1}),u},d=function(e){for(var t=0;t<g.length;t++)g[t].handle===e&&(g[t].cancelled=!0)}}t.exports=function(e){return s.call(o,e)},t.exports.cancel=function(){d.apply(o,arguments)},t.exports.polyfill=function(e){e||(e=o),e.requestAnimationFrame=s,e.cancelAnimationFrame=d}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"performance-now":462}],485:[function(e,t){"use strict";var o=e("big-rat/add");t.exports=function(e,t){for(var a=e.length,n=Array(a),r=0;r<a;++r)n[r]=o(e[r],t[r]);return n}},{"big-rat/add":75}],486:[function(e,t){"use strict";t.exports=function(e){for(var t=Array(e.length),r=0;r<e.length;++r)t[r]=a(e[r]);return t};var a=e("big-rat")},{"big-rat":78}],487:[function(e,t){"use strict";var o=e("big-rat"),l=e("big-rat/mul");t.exports=function(e,t){for(var a=o(t),s=e.length,n=Array(s),r=0;r<s;++r)n[r]=l(e[r],a);return n}},{"big-rat":78,"big-rat/mul":87}],488:[function(e,t){"use strict";var o=e("big-rat/sub");t.exports=function(e,t){for(var a=e.length,n=Array(a),r=0;r<a;++r)n[r]=o(e[r],t[r]);return n}},{"big-rat/sub":89}],489:[function(e,t){"use strict";var a=e("compare-cell"),r=e("compare-oriented-cell"),n=e("cell-orientation");t.exports=function(e){e.sort(r);for(var t=e.length,l=0,s=0;s<t;++s){var d=e[s],c=n(d);if(0!==c){if(0<l){var o=e[l-1];if(0===a(d,o)&&n(o)!==c){l-=1;continue}}e[l++]=d}}return e.length=l,e}},{"cell-orientation":112,"compare-cell":128,"compare-oriented-cell":129}],490:[function(e,t){"use strict";var a=e("array-bounds"),r=e("color-normalize"),o=e("update-diff"),n=e("pick-by-alias"),l=e("object-assign"),s=e("flatten-vertex-data"),d=e("to-float32"),c=d.float32,p=d.fract32;t.exports=function(e,t){function i(e){e?h(e):null===e&&m(),d()}function d(t){return"number"==typeof t?g(t):void(t&&!Array.isArray(t)&&(t=[t]),e._refresh(),x.forEach(function(e,a){if(e)return t&&(t[a]?e.draw=!0:e.draw=!1),e.draw?void g(a):void(e.draw=!0)}))}function g(e){"number"==typeof e&&(e=x[e]),null!=e&&e&&e.count&&e.color&&e.opacity&&e.positions&&1<e.positions.length&&(e.scaleRatio=[e.scale[0]*e.viewport.width,e.scale[1]*e.viewport.height],_(e),e.after&&e.after(e))}function h(e){if(e){null==e.length?!Array.isArray(e)&&(e=[e]):"number"==typeof e[0]&&(e=[{positions:e}]);var t=0,d=0;if(i.groups=x=e.map(function(e,c){var i=x[c];return e?("function"==typeof e?e={after:e}:"number"==typeof e[0]&&(e={positions:e}),e=n(e,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),i||(x[c]=i={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},e=l({},f,e)),o(i,e,[{lineWidth:function(e){return .5*+e},capSize:function(e){return .5*+e},opacity:parseFloat,errors:function(e){return e=s(e),d+=e.length,e},positions:function(e,r){return e=s(e,"float64"),r.count=ba(e.length/2),r.bounds=a(e,2),r.offset=t,t+=r.count,e}},{color:function(e,t){var a=t.count;if(e||(e="transparent"),!Array.isArray(e)||"number"==typeof e[0]){var o=e;e=Array(a);for(var n=0;n<a;n++)e[n]=o}if(e.length<a)throw Error("Not enough colors");for(var l=new Uint8Array(4*a),s=0,d;s<a;s++)d=r(e[s],"uint8"),l.set(d,4*s);return l},range:function(e,t){var a=t.bounds;return e||(e=a),t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])],t.translate=[-e[0],-e[1]],t.scaleFract=p(t.scale),t.translateFract=p(t.translate),e},viewport:function(e){var t;return Array.isArray(e)?t={x:e[0],y:e[1],width:e[2]-e[0],height:e[3]-e[1]}:e?(t={x:e.x||e.left||0,y:e.y||e.top||0},t.width=e.right?e.right-t.x:e.w||e.width||0,t.height=e.bottom?e.bottom-t.y:e.h||e.height||0):t={x:0,y:0,width:y.drawingBufferWidth,height:y.drawingBufferHeight},t}}]),i):i}),t||d){var u=x.reduce(function(e,t){return e+(t?t.count:0)},0),g=new Float64Array(2*u),h=new Uint8Array(4*u),m=new Float32Array(4*u);x.forEach(function(e){if(e){var t=e.positions,a=e.count,r=e.offset,o=e.color,i=e.errors;a&&(h.set(o,4*r),m.set(i,4*r),g.set(t,2*r))}}),b(c(g)),v(p(g)),k(h),w(m)}}}function m(){b.destroy(),v.destroy(),k.destroy(),w.destroy(),T.destroy()}if("function"==typeof e?(!t&&(t={}),t.regl=e):t=e,t.length&&(t.positions=t),e=t.regl,!e.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var y=e._gl,f={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},x=[],_,b,v,k,w,T;return k=e.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),b=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),w=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),T=e.buffer({usage:"static",type:"float",data:u}),h(t),_=e({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:e.prop("range"),lineWidth:e.prop("lineWidth"),capSize:e.prop("capSize"),opacity:e.prop("opacity"),scale:e.prop("scale"),translate:e.prop("translate"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{color:{buffer:k,offset:function(e,t){return 4*t.offset},divisor:1},position:{buffer:b,offset:function(e,t){return 8*t.offset},divisor:1},positionFract:{buffer:v,offset:function(e,t){return 8*t.offset},divisor:1},error:{buffer:w,offset:function(e,t){return 16*t.offset},divisor:1},direction:{buffer:T,stride:24,offset:0},lineOffset:{buffer:T,stride:24,offset:8},capOffset:{buffer:T,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:!1,instances:e.prop("count"),count:u.length}),l(i,{update:h,draw:d,destroy:m,regl:e,gl:y,canvas:y.canvas,groups:x}),i};var u=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":65,"color-normalize":120,"flatten-vertex-data":227,"object-assign":454,"pick-by-alias":465,"to-float32":538,"update-diff":549}],491:[function(e,t){"use strict";function a(e,t){if(!(this instanceof a))return new a(e,t);if("function"==typeof e?(!t&&(t={}),t.regl=e):t=e,t.length&&(t.positions=t),e=t.regl,!e.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=e._gl,this.regl=e,this.passes=[],this.shaders=a.shaders.has(e)?a.shaders.get(e):a.shaders.set(e,a.createShaders(e)).get(e),this.update(t)}var r=e("color-normalize"),i=e("array-bounds"),n=e("object-assign"),l=e("glslify"),s=e("pick-by-alias"),d=e("flatten-vertex-data"),c=e("earcut"),p=e("array-normalize"),u=e("to-float32"),g=u.float32,h=u.fract32,m=e("es6-weak-map"),f=e("parse-rect");t.exports=a,a.dashMult=2,a.maxPatternLength=256,a.precisionThreshold=3e6,a.maxPoints=1e4,a.maxLines=2048,a.shaders=new m,a.createShaders=function(e){var t=e.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),a={primitive:"triangle strip",instances:e.prop("count"),count:4,offset:0,uniforms:{miterMode:function(e,t){return"round"===t.join?2:1},miterLimit:e.prop("miterLimit"),scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),thickness:e.prop("thickness"),dashPattern:e.prop("dashTexture"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),dashSize:e.prop("dashLength"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]},depth:e.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(e,t){return!t.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport")},r=e(n({vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\n\nuniform float dashSize, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},a)),o;try{o=e(n({cull:{enable:!0,face:"back"},vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aColor:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:e.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},a))}catch(t){o=r}var i=e({primitive:"triangle",elements:function(e,t){return t.triangles},offset:0,vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:e.prop("scale"),color:e.prop("fill"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{position:{buffer:e.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8}},blend:a.blend,depth:{enable:!1},scissor:a.scissor,stencil:a.stencil,viewport:a.viewport});return{fill:i,rect:r,miter:o}},a.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},a.prototype.render=function(){for(var e=[],t=arguments.length,a;t--;)e[t]=arguments[t];e.length&&(a=this).update.apply(a,e),this.draw()},a.prototype.draw=function(){for(var e=this,t=[],r=arguments.length;r--;)t[r]=arguments[r];return(t.length?t:this.passes).forEach(function(t){var r;return t&&Array.isArray(t)?(r=e).draw.apply(r,t):void(("number"==typeof t&&(t=e.passes[t]),!!(t&&1<t.count&&t.opacity))&&(e.regl._refresh(),t.fill&&t.triangles&&2<t.triangles.length&&e.shaders.fill(t),t.thickness&&(t.scale[0]*t.viewport.width>a.precisionThreshold||t.scale[1]*t.viewport.height>a.precisionThreshold?e.shaders.rect(t):"rect"===t.join||!t.join&&(2>=t.thickness||t.count>=a.maxPoints)?e.shaders.rect(t):e.shaders.miter(t))))}),this},a.prototype.update=function(e){var t=this;if(e){null==e.length?!Array.isArray(e)&&(e=[e]):"number"==typeof e[0]&&(e=[{positions:e}]);var o=this,u=o.regl,m=o.gl;if(e.forEach(function(e,_){var b=t.passes[_];if(void 0!==e){if(null===e)return void(t.passes[_]=null);if("number"==typeof e[0]&&(e={positions:e}),e=s(e,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"}),b||(t.passes[_]=b={id:_,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:u.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:u.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:u.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:u.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},e=n({},a.defaults,e)),null!=e.thickness&&(b.thickness=parseFloat(e.thickness)),null!=e.opacity&&(b.opacity=parseFloat(e.opacity)),null!=e.miterLimit&&(b.miterLimit=parseFloat(e.miterLimit)),null!=e.overlay&&(b.overlay=!!e.overlay,_<a.maxLines&&(b.depth=2*(a.maxLines-1-_%a.maxLines)/a.maxLines-1)),null!=e.join&&(b.join=e.join),null!=e.hole&&(b.hole=e.hole),null!=e.fill&&(b.fill=e.fill?r(e.fill,"uint8"):null),null!=e.viewport&&(b.viewport=f(e.viewport)),b.viewport||(b.viewport=f([m.drawingBufferWidth,m.drawingBufferHeight])),null!=e.close&&(b.close=e.close),null===e.positions&&(e.positions=[]),e.positions){var v,w;if(e.positions.x&&e.positions.y){var T=e.positions.x,A=e.positions.y;w=b.count=va(T.length,A.length),v=new Float64Array(2*w);for(var S=0;S<w;S++)v[2*S]=T[S],v[2*S+1]=A[S]}else v=d(e.positions,"float64"),w=b.count=ba(v.length/2);var C=b.bounds=i(v,2);if(b.fill){for(var L=[],E={},I=0,z=0,P=0,D=b.count;z<D;z++){var l=v[2*z],O=v[2*z+1];isNaN(l)||isNaN(O)||null==l||null==O?(l=v[2*I],O=v[2*I+1],E[z]=I):I=z,L[P++]=l,L[P++]=O}for(var R=c(L,b.hole||[]),M=0,F=R.length;M<F;M++)null!=E[R[M]]&&(R[M]=E[R[M]]);b.triangles=R}var B=new Float64Array(v);p(B,2,C);var N=new Float64Array(2*w+6);b.close?v[0]===v[2*w-2]&&v[1]===v[2*w-1]?(N[0]=B[2*w-4],N[1]=B[2*w-3]):(N[0]=B[2*w-2],N[1]=B[2*w-1]):(N[0]=B[0],N[1]=B[1]),N.set(B,2),b.close?v[0]===v[2*w-2]&&v[1]===v[2*w-1]?(N[2*w+2]=B[2],N[2*w+3]=B[3],b.count-=1):(N[2*w+2]=B[0],N[2*w+3]=B[1],N[2*w+4]=B[2],N[2*w+5]=B[3]):(N[2*w+2]=B[2*w-2],N[2*w+3]=B[2*w-1],N[2*w+4]=B[2*w-2],N[2*w+5]=B[2*w-1]),b.positionBuffer(g(N)),b.positionFractBuffer(h(N))}if(e.range?b.range=e.range:!b.range&&(b.range=b.bounds),(e.range||e.positions)&&b.count){var V=b.bounds,U=V[2]-V[0],H=V[3]-V[1],G=b.range[2]-b.range[0],q=b.range[3]-b.range[1];b.scale=[U/G,H/q],b.translate=[-b.range[0]/G+V[0]/G||0,-b.range[1]/q+V[1]/q||0],b.scaleFract=h(b.scale),b.translateFract=h(b.translate)}if(e.dashes){var Y=0,W;if(!e.dashes||2>e.dashes.length)Y=1,W=new Uint8Array([255,255,255,255,255,255,255,255]);else{Y=0;for(var X=0;X<e.dashes.length;++X)Y+=e.dashes[X];W=new Uint8Array(Y*a.dashMult);for(var Z=0,K=255,J=0;2>J;J++)for(var Q=0;Q<e.dashes.length;++Q){for(var $=0,ee=.5*(e.dashes[Q]*a.dashMult);$<ee;++$)W[Z++]=K;K^=255}}b.dashLength=Y,b.dashTexture({channels:1,data:W,width:W.length,height:1,mag:"linear",min:"linear"},0,0)}if(e.color){var te=b.count,ae=e.color;ae||(ae="transparent");var re=new Uint8Array(4*te+4);if(!Array.isArray(ae)||"number"==typeof ae[0])for(var oe=r(ae,"uint8"),ie=0;ie<te+1;ie++)re.set(oe,4*ie);else{for(var ne=0,le;ne<te;ne++)le=r(ae[ne],"uint8"),re.set(le,4*ne);re.set(r(ae[0],"uint8"),4*te)}b.colorBuffer({usage:"dynamic",type:"uint8",data:re})}}}),e.length<this.passes.length){for(var l=e.length,y;l<this.passes.length;l++)(y=t.passes[l],!!y)&&(y.colorBuffer.destroy(),y.positionBuffer.destroy(),y.dashTexture.destroy());this.passes.length=e.length}for(var x=[],_=0;_<this.passes.length;_++)null!==t.passes[_]&&x.push(t.passes[_]);return this.passes=x,this}},a.prototype.destroy=function(){return this.passes.forEach(function(e){e.colorBuffer.destroy(),e.positionBuffer.destroy(),e.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":65,"array-normalize":66,"color-normalize":120,earcut:492,"es6-weak-map":493,"flatten-vertex-data":227,glslify:409,"object-assign":454,"parse-rect":459,"pick-by-alias":465,"to-float32":538}],492:[function(e,t){"use strict";function a(e,t,a){a=a||2;var o=t&&t.length,l=o?t[0]*a:e.length,s=r(e,0,l,a,!0),d=[];if(!s||s.next===s.prev)return d;var c,u,g,h,m,f,_;if(o&&(s=p(e,t,s,a)),e.length>80*a){c=g=e[0],u=h=e[1];for(var b=a;b<l;b+=a)m=e[b],f=e[b+1],m<c&&(c=m),f<u&&(u=f),m>g&&(g=m),f>h&&(h=f);_=va(g-c,h-u),_=0===_?0:1/_}return n(s,d,a,c,u,_),d}function r(e,t,a,r,o){var n,l;if(o===0<P(e,t,a,r))for(n=t;n<a;n+=r)l=E(n,e[n],e[n+1],l);else for(n=a-r;n>=t;n-=r)l=E(n,e[n],e[n+1],l);return l&&w(l,l.next)&&(I(l),l=l.next),l}function o(e,t){if(!e)return e;t||(t=e);var a=e,r;do if(r=!1,!a.steiner&&(w(a,a.next)||0===k(a.prev,a,a.next))){if(I(a),a=t=a.prev,a===a.next)break;r=!0}else a=a.next;while(r||a!==t);return t}function n(e,t,a,r,i,p,u){if(e){!u&&p&&m(e,r,i,p);for(var g=e,h,y;e.prev!==e.next;){if(h=e.prev,y=e.next,p?s(e,r,i,p):l(e)){t.push(h.i/a),t.push(e.i/a),t.push(y.i/a),I(e),e=y.next,g=y.next;continue}if(e=y,e===g){u?1===u?(e=d(e,t,a),n(e,t,a,r,i,p,2)):2==u&&c(e,t,a,r,i,p):n(o(e),t,a,r,i,p,1);break}}}}function l(e){var t=e.prev,a=e,r=e.next;if(0<=k(t,a,r))return!1;for(var o=e.next.next;o!==e.prev;){if(_(t.x,t.y,a.x,a.y,r.x,r.y,o.x,o.y)&&0<=k(o.prev,o,o.next))return!1;o=o.next}return!0}function s(e,t,r,o){var i=e.prev,a=e,l=e.next;if(0<=k(i,a,l))return!1;for(var s=i.x<a.x?i.x<l.x?i.x:l.x:a.x<l.x?a.x:l.x,d=i.y<a.y?i.y<l.y?i.y:l.y:a.y<l.y?a.y:l.y,c=i.x>a.x?i.x>l.x?i.x:l.x:a.x>l.x?a.x:l.x,u=i.y>a.y?i.y>l.y?i.y:l.y:a.y>l.y?a.y:l.y,g=f(s,d,t,r,o),h=f(c,u,t,r,o),m=e.prevZ,y=e.nextZ;m&&m.z>=g&&y&&y.z<=h;){if(m!==e.prev&&m!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,m.x,m.y)&&0<=k(m.prev,m,m.next))return!1;if(m=m.prevZ,y!==e.prev&&y!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,y.x,y.y)&&0<=k(y.prev,y,y.next))return!1;y=y.nextZ}for(;m&&m.z>=g;){if(m!==e.prev&&m!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,m.x,m.y)&&0<=k(m.prev,m,m.next))return!1;m=m.prevZ}for(;y&&y.z<=h;){if(y!==e.prev&&y!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,y.x,y.y)&&0<=k(y.prev,y,y.next))return!1;y=y.nextZ}return!0}function d(e,t,r){var o=e;do{var i=o.prev,a=o.next.next;!w(i,a)&&T(i,o,o.next,a)&&S(i,a)&&S(a,i)&&(t.push(i.i/r),t.push(o.i/r),t.push(a.i/r),I(o),I(o.next),o=e=a),o=o.next}while(o!==e);return o}function c(e,t,r,i,l,s){var d=e;do{for(var p=d.next.next;p!==d.prev;){if(d.i!==p.i&&v(d,p)){var u=L(d,p);return d=o(d,d.next),u=o(u,u.next),n(d,t,r,i,l,s),void n(u,t,r,i,l,s)}p=p.next}d=d.next}while(d!==e)}function p(e,t,a,n){var l=[],s,d,c,p,h;for(s=0,d=t.length;s<d;s++)c=t[s]*n,p=s<d-1?t[s+1]*n:e.length,h=r(e,c,p,n,!1),h===h.next&&(h.steiner=!0),l.push(x(h));for(l.sort(u),s=0;s<l.length;s++)g(l[s],a),a=o(a,a.next);return a}function u(e,t){return e.x-t.x}function g(e,t){if(t=h(e,t),t){var a=L(t,e);o(a,a.next)}}function h(e,t){var a=t,r=e.x,o=e.y,i=-Infinity,n;do{if(o<=a.y&&o>=a.next.y&&a.next.y!==a.y){var l=a.x+(o-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(l<=r&&l>i){if(i=l,l===r){if(o===a.y)return a;if(o===a.next.y)return a.next}n=a.x<a.next.x?a:a.next}}a=a.next}while(a!==t);if(!n)return null;if(r===i)return n.prev;var s=n,d=n.x,c=n.y,u=1/0,g;for(a=n.next;a!==s;)r>=a.x&&a.x>=d&&r!==a.x&&_(o<c?r:i,o,d,c,o<c?i:r,o,a.x,a.y)&&(g=_a(o-a.y)/(r-a.x),(g<u||g===u&&a.x>n.x)&&S(a,e)&&(n=a,u=g)),a=a.next;return n}function m(e,t,a,r){var o=e;do null===o.z&&(o.z=f(o.x,o.y,t,a,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,y(o)}function y(t){var a=1,r,o,n,l,s,d,c,u;do{for(o=t,t=null,s=null,d=0;o;){for(d++,n=o,c=0,r=0;r<a&&(c++,n=n.nextZ,!!n);r++);for(u=a;0<c||0<u&&n;)0!==c&&(0===u||!n||o.z<=n.z)?(l=o,o=o.nextZ,c--):(l=n,n=n.nextZ,u--),s?s.nextZ=l:t=l,l.prevZ=s,s=l;o=n}s.nextZ=null,a*=2}while(1<d);return t}function f(e,t,a,r,o){return e=32767*(e-a)*o,t=32767*(t-r)*o,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function x(e){var t=e,a=e;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==e);return a}function _(e,t,a,r,o,i,n,l){return 0<=(o-n)*(t-l)-(e-n)*(i-l)&&0<=(e-n)*(r-l)-(a-n)*(t-l)&&0<=(a-n)*(i-l)-(o-n)*(r-l)}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!A(e,t)&&S(e,t)&&S(t,e)&&C(e,t)}function k(e,t,a){return(t.y-e.y)*(a.x-t.x)-(t.x-e.x)*(a.y-t.y)}function w(e,t){return e.x===t.x&&e.y===t.y}function T(e,t,a,r){return!!(w(e,t)&&w(a,r)||w(e,r)&&w(a,t))||0<k(e,t,a)!=0<k(e,t,r)&&0<k(a,r,e)!=0<k(a,r,t)}function A(e,t){var a=e;do{if(a.i!==e.i&&a.next.i!==e.i&&a.i!==t.i&&a.next.i!==t.i&&T(a,a.next,e,t))return!0;a=a.next}while(a!==e);return!1}function S(e,t){return 0>k(e.prev,e,e.next)?0<=k(e,t,e.next)&&0<=k(e,e.prev,t):0>k(e,t,e.prev)||0>k(e,e.next,t)}function C(e,t){var a=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do a.y>i!=a.next.y>i&&a.next.y!==a.y&&o<(a.next.x-a.x)*(i-a.y)/(a.next.y-a.y)+a.x&&(r=!r),a=a.next;while(a!==e);return r}function L(e,t){var a=new z(e.i,e.x,e.y),r=new z(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,a.next=o,o.prev=a,r.next=a,a.prev=r,i.next=r,r.prev=i,r}function E(e,t,a,r){var o=new z(e,t,a);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function I(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function z(e,t,a){this.i=e,this.x=t,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(e,t,a,r){for(var o=0,n=t,l=a-r;n<a;n+=r)o+=(e[l]-e[n])*(e[n+1]+e[l+1]),l=n;return o}t.exports=a,t.exports.default=a,a.deviation=function(e,t,r,o){var n=t&&t.length,l=n?t[0]*r:e.length,s=_a(P(e,0,l,r));if(n)for(var d=0,p=t.length;d<p;d++){var u=t[d]*r,g=d<p-1?t[d+1]*r:e.length;s-=_a(P(e,u,g,r))}var h=0;for(d=0;d<o.length;d+=3){var m=o[d]*r,a=o[d+1]*r,y=o[d+2]*r;h+=_a((e[m]-e[y])*(e[a+1]-e[m+1])-(e[m]-e[a])*(e[y+1]-e[m+1]))}return 0===s&&0===h?0:_a((h-s)/s)},a.flatten=function(e){for(var t=e[0][0].length,a={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var n=0;n<e[o].length;n++)for(var l=0;l<t;l++)a.vertices.push(e[o][n][l]);0<o&&(r+=e[o-1].length,a.holes.push(r))}return a}},{}],493:[function(e,t,a){arguments[4][318][0].apply(a,arguments)},{"./is-implemented":494,"./polyfill":496,dup:318}],494:[function(e,t,a){arguments[4][319][0].apply(a,arguments)},{dup:319}],495:[function(e,t,a){arguments[4][320][0].apply(a,arguments)},{dup:320}],496:[function(e,t,a){arguments[4][321][0].apply(a,arguments)},{"./is-native-implemented":495,d:151,dup:321,"es5-ext/object/is-value":194,"es5-ext/object/set-prototype-of":200,"es5-ext/object/valid-object":204,"es5-ext/object/valid-value":205,"es5-ext/string/random-uniq":210,"es6-iterator/for-of":212,"es6-iterator/get":213,"es6-symbol":219}],497:[function(e,t){"use strict";function a(e,t){return n(e)||s(e,t)||c()}function r(e){return o(e)||l(e)||d()}function o(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function n(e){if(Array.isArray(e))return e}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function s(e,t){var a=[],r=!0,o=!1,i=void 0;try{for(var n=e[Symbol.iterator](),l;!(r=(l=n.next()).done)&&(a.push(l.value),!(t&&a.length===t));r=!0);}catch(e){o=!0,i=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(o)throw i}}return a}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(e,t){var a=this;if(!(this instanceof p))return new p(e,t);"function"==typeof e?(!t&&(t={}),t.regl=e):(t=e,e=null),t&&t.length&&(t.positions=t),e=t.regl;var r=e._gl,o=[],i=255,n;this.tooManyColors=v,n=e.texture({data:new Uint8Array(4*i),width:i,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),y(this,{regl:e,gl:r,groups:[],markerCache:[null],markerTextures:[null],palette:o,paletteIds:{},paletteTexture:n,maxColors:i,maxSize:100,canvas:r.canvas}),this.update(t);var l={uniforms:{pixelRatio:e.context("pixelRatio"),palette:n,paletteSize:function(){return[a.tooManyColors?0:i,n.height]},scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translate:e.prop("translate"),translateFract:e.prop("translateFract"),opacity:e.prop("opacity"),marker:e.prop("markerTexture")},attributes:{x:function(e,t){return t.xAttr||{buffer:t.positionBuffer,stride:8,offset:0}},y:function(e,t){return t.yAttr||{buffer:t.positionBuffer,stride:8,offset:4}},xFract:function(e,t){return t.xAttr?{constant:[0,0]}:{buffer:t.positionFractBuffer,stride:8,offset:0}},yFract:function(e,t){return t.yAttr?{constant:[0,0]}:{buffer:t.positionFractBuffer,stride:8,offset:4}},size:function(e,t){return t.size.length?{buffer:t.sizeBuffer,stride:2,offset:0}:{constant:[V(255*t.size/a.maxSize)]}},borderSize:function(e,t){return t.borderSize.length?{buffer:t.sizeBuffer,stride:2,offset:1}:{constant:[V(255*t.borderSize/a.maxSize)]}},colorId:function(e,t){return t.color.length?{buffer:t.colorBuffer,stride:a.tooManyColors?8:4,offset:0}:{constant:a.tooManyColors?o.slice(4*t.color,4*t.color+4):[t.color]}},borderColorId:function(e,t){return t.borderColor.length?{buffer:t.colorBuffer,stride:a.tooManyColors?8:4,offset:a.tooManyColors?4:2}:{constant:a.tooManyColors?o.slice(4*t.borderColor,4*t.borderColor+4):[t.borderColor]}},isActive:function(e,t){return!0===t.activation?{constant:[1]}:t.activation?t.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:e.prop("elements"),count:e.prop("count"),offset:e.prop("offset"),primitive:"points"},s=y({},l);s.frag=f(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float pixelRatio, opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),s.vert=f(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pixelRatio;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=e(s);var d=y({},l);d.frag=f(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),d.vert=f(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),v&&(d.frag=d.frag.replace("smoothstep","smoothStep"),s.frag=s.frag.replace("smoothstep","smoothStep")),this.drawCircle=e(d)}var u=e("color-normalize"),g=e("array-bounds"),h=e("color-id"),m=e("point-cluster"),y=e("object-assign"),f=e("glslify"),x=e("pick-by-alias"),_=e("update-diff"),b=e("flatten-vertex-data"),v=e("is-iexplorer"),i=e("to-float32"),k=e("parse-rect");p.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},p.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},p.prototype.draw=function(){for(var e=this,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];var o=this.groups;if(1===a.length&&Array.isArray(a[0])&&(null===a[0][0]||Array.isArray(a[0][0]))&&(a=a[0]),this.regl._refresh(),a.length)for(var n=0;n<a.length;n++)this.drawItem(n,a[n]);else o.forEach(function(t,a){e.drawItem(a)});return this},p.prototype.drawItem=function(e,t){var a=this.groups,o=a[e];if("number"==typeof t&&(e=t,o=a[t],t=null),!!(o&&o.count&&o.opacity)){o.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,o,t));for(var n=[],l=1;l<o.activation.length;l++)o.activation[l]&&(!0===o.activation[l]||o.activation[l].data.length)&&n.push.apply(n,r(this.getMarkerDrawOptions(l,o,t)));n.length&&this.drawMarker(n)}},p.prototype.getMarkerDrawOptions=function(e,t,r){var o=t.range,n=t.tree,s=t.viewport,d=t.activation,c=t.selectionBuffer,p=t.count,u=this.regl;if(!n)return r?[y({},t,{markerTexture:this.markerTextures[e],activation:d[e],count:r.length,elements:r,offset:0})]:[y({},t,{markerTexture:this.markerTextures[e],activation:d[e],offset:0})];var g=[],h=n.range(o,{lod:!0,px:[(o[2]-o[0])/s.width,(o[3]-o[1])/s.height]});if(r){for(var m=d[e],f=m.data,x=new Uint8Array(p),_=0,b;_<r.length;_++)b=r[_],x[b]=f?f[b]:1;c.subdata(x)}for(var v=h.length;v--;){var k=a(h[v],2),w=k[0],T=k[1];g.push(y({},t,{markerTexture:this.markerTextures[e],activation:r?c:d[e],offset:w,count:T-w}))}return g},p.prototype.update=function(){for(var e=this,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];if(a.length){1===a.length&&Array.isArray(a[0])&&(a=a[0]);var o=this.groups,n=this.gl,l=this.regl,s=this.maxSize,d=this.maxColors,c=this.palette;this.groups=o=a.map(function(t,a){var r=o[a];if(void 0===t)return r;null===t?t={positions:null}:"function"==typeof t?t={ondraw:t}:"number"==typeof t[0]&&(t={positions:t}),t=x(t,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),null===t.positions&&(t.positions=[]),null!=t.tooManyColors&&(e.tooManyColors=t.tooManyColors),r||(o[a]=r={id:a,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:l.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},t=y({},p.defaults,t)),t.positions&&!("marker"in t)&&(t.marker=r.marker,delete r.marker),t.marker&&!("positions"in t)&&(t.positions=r.positions,delete r.positions);var u=0,h=0;if(_(r,t,[{snap:!0,size:function(e){return null==e&&(e=p.defaults.size),u+=e&&e.length?1:0,e},borderSize:function(e){return null==e&&(e=p.defaults.borderSize),u+=e&&e.length?1:0,e},opacity:parseFloat,color:function(t){return null==t&&(t=p.defaults.color),t=e.updateColor(t),h++,t},borderColor:function(t){return null==t&&(t=p.defaults.borderColor),t=e.updateColor(t),h++,t},bounds:function(e,t,a){return"range"in a||(a.range=null),e},positions:function(e,t,a){var r=t.snap,o=t.positionBuffer,n=t.positionFractBuffer,s=t.selectionBuffer;if(e.x||e.y)return t.xAttr=e.x.length?{buffer:l.buffer(e.x),offset:0,stride:4,count:e.x.length}:{buffer:e.x.buffer,offset:4*e.x.offset||0,stride:4*(e.x.stride||1),count:e.x.count},t.yAttr=e.y.length?{buffer:l.buffer(e.y),offset:0,stride:4,count:e.y.length}:{buffer:e.y.buffer,offset:4*e.y.offset||0,stride:4*(e.y.stride||1),count:e.y.count},t.count=va(t.xAttr.count,t.yAttr.count),e;e=b(e,"float64");var d=t.count=ba(e.length/2),c=t.bounds=d?g(e,2):null;if(a.range||t.range||(delete t.range,a.range=c),a.marker||t.marker||(delete t.marker,a.marker=null),r&&(!0===r||d>r)?t.tree=m(e,{bounds:c}):r&&r.length&&(t.tree=r),t.tree){var p={primitive:"points",usage:"static",data:t.tree,type:"uint32"};t.elements?t.elements(p):t.elements=l.elements(p)}return o({data:i.float(e),usage:"dynamic"}),n({data:i.fract(e),usage:"dynamic"}),s({data:new Uint8Array(d),type:"uint8",usage:"stream"}),e}},{marker:function(t,a){var r=a.activation;if(r.forEach(function(e){return e&&e.destroy&&e.destroy()}),r.length=0,!t||"number"==typeof t[0]){var o=e.addMarker(t);r[o]=!0}else{for(var i=[],n=0,s=ea(t.length,a.count),d;n<s;n++)d=e.addMarker(t[n]),i[d]||(i[d]=new Uint8Array(a.count)),i[d][n]=1;for(var c=0;c<i.length;c++)if(i[c]){var p={data:i[c],type:"uint8",usage:"static"};r[c]?r[c](p):r[c]=l.buffer(p),r[c].data=i[c]}}return t},range:function(e,t){var a=t.bounds;if(a)return e||(e=a),t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])],t.translate=[-e[0],-e[1]],t.scaleFract=i.fract(t.scale),t.translateFract=i.fract(t.translate),e},viewport:function(e){var t=k(e||[n.drawingBufferWidth,n.drawingBufferHeight]);return t}}]),u){var f=r,v=f.count,w=f.size,T=f.borderSize,A=f.sizeBuffer,S=new Uint8Array(2*v);if(w.length||T.length)for(var C=0;C<v;C++)S[2*C]=V(255*(null==w[C]?w:w[C])/s),S[2*C+1]=V(255*(null==T[C]?T:T[C])/s);A({data:S,usage:"dynamic"})}if(h){var L=r,E=L.count,I=L.color,z=L.borderColor,P=L.colorBuffer,D;if(e.tooManyColors){if(I.length||z.length){D=new Uint8Array(8*E);for(var O=0,R;O<E;O++){R=I[O],D[8*O]=c[4*R],D[8*O+1]=c[4*R+1],D[8*O+2]=c[4*R+2],D[8*O+3]=c[4*R+3];var M=z[O];D[8*O+4]=c[4*M],D[8*O+5]=c[4*M+1],D[8*O+6]=c[4*M+2],D[8*O+7]=c[4*M+3]}}}else if(I.length||z.length){D=new Uint8Array(4*E+2);for(var j=0;j<E;j++)null!=I[j]&&(D[4*j]=I[j]%d,D[4*j+1]=ba(I[j]/d)),null!=z[j]&&(D[4*j+2]=z[j]%d,D[4*j+3]=ba(z[j]/d))}P({data:D||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return r})}},p.prototype.addMarker=function(e){var t=this.markerTextures,a=this.regl,r=this.markerCache,o=null==e?0:r.indexOf(e);if(0<=o)return o;var n;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)n=e;else{n=new Uint8Array(e.length);for(var s=0,d=e.length;s<d;s++)n[s]=255*e[s]}var l=ba(N(n.length));return o=t.length,r.push(e),t.push(a.texture({channels:1,data:n,radius:l,mag:"linear",min:"linear"})),o},p.prototype.updateColor=function(e){var t=this.paletteIds,a=this.palette,r=this.maxColors;Array.isArray(e)||(e=[e]);var o=[];if("number"==typeof e[0]){var n=[];if(Array.isArray(e))for(var l=0;l<e.length;l+=4)n.push(e.slice(l,l+4));else for(var s=0;s<e.length;s+=4)n.push(e.subarray(s,s+4));e=n}for(var d=0,c;d<e.length;d++){c=e[d],c=u(c,"uint8");var p=h(c,!1);if(null==t[p]){var g=a.length;t[p]=ba(g/4),a[g]=c[0],a[g+1]=c[1],a[g+2]=c[2],a[g+3]=c[3]}o[d]=t[p]}return!this.tooManyColors&&a.length>4*r&&(this.tooManyColors=!0),this.updatePalette(a),1===o.length?o[0]:o},p.prototype.updatePalette=function(e){if(!this.tooManyColors){var t=this.maxColors,a=this.paletteTexture,r=M(.25*e.length/t);if(1<r){e=e.slice();for(var o=.25*e.length%t;o<r*t;o++)e.push(0,0,0,0)}a.height<r&&a.resize(t,r),a.subimage({width:ea(.25*e.length,t),height:r,data:e},0,0)}},p.prototype.destroy=function(){return this.groups.forEach(function(e){e.sizeBuffer.destroy(),e.positionBuffer.destroy(),e.positionFractBuffer.destroy(),e.colorBuffer.destroy(),e.activation.forEach(function(e){return e&&e.destroy&&e.destroy()}),e.selectionBuffer.destroy(),e.elements&&e.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(e){return e&&e.destroy&&e.destroy()}),this};var w=e("object-assign");t.exports=function(e,t){var a=new p(e,t),r=a.render.bind(a);return w(r,{render:r,update:a.update.bind(a),draw:a.draw.bind(a),destroy:a.destroy.bind(a),regl:a.regl,gl:a.gl,canvas:a.gl.canvas,groups:a.groups,markers:a.markerCache,palette:a.palette}),r}},{"array-bounds":65,"color-id":118,"color-normalize":120,"flatten-vertex-data":227,glslify:409,"is-iexplorer":419,"object-assign":454,"parse-rect":459,"pick-by-alias":465,"point-cluster":499,"to-float32":538,"update-diff":549}],498:[function(e,t,a){arguments[4][111][0].apply(a,arguments)},{dup:111}],499:[function(e,t){"use strict";t.exports=e("./quad")},{"./quad":500}],500:[function(e,t){"use strict";function a(e,t){for(var a=t[0],r=t[1],l=t[2],s=t[3],d=Array(e.length),c=0,p=e.length/2;c<p;c++)d[2*c]=o((e[2*c]-a)*(1/(l-a)),0,1),d[2*c+1]=o((e[2*c+1]-r)*(1/(s-r)),0,1);return d}var r=e("binary-search-bounds"),o=e("clamp"),i=e("parse-rect"),s=e("array-bounds"),d=e("pick-by-alias"),c=e("defined"),p=e("flatten-vertex-data"),u=e("is-obj"),g=e("dtype"),h=e("math-log2");t.exports=function(e,t){function o(e,t,a,r,n,s){if(!r.length)return null;var d=w[n]||(w[n]=[]),c=A[n]||(A[n]=[]),p=T[n]||(T[n]=[]),u=d.length;if(n++,n>_||s>1073741824){for(var g=0;g<r.length;g++)d.push(r[g]),c.push(s),p.push(null,null,null,null);return u}if(d.push(r[0]),c.push(s),1>=r.length)return p.push(null,null,null,null),u;for(var h=.5*a,m=e+h,y=t+h,f=[],x=[],b=[],k=[],S=1,C=r.length;S<C;S++){var l=r[S],L=v[2*l],E=v[2*l+1];L<m?E<y?f.push(l):x.push(l):E<y?b.push(l):k.push(l)}return s<<=2,p.push(o(e,t,h,f,n,s),o(e,y,h,x,n,s+1),o(m,t,h,b,n,s+2),o(m,y,h,k,n,s+3)),u}function m(){function t(a,o,n,l,s,d){if(null!==s&&null!==d){if(!(k>a+n||A>o+n||S<a||C<o)&&!(l>=L)&&s!==d){var c=w[l];void 0===d&&(d=c.length);for(var p=s;p<d;p++){var u=c[p],g=e[2*u],h=e[2*u+1];g>=m&&g<=x&&h>=f&&h<=_&&I.push(u)}var y=T[l],b=y[4*s+0],v=y[4*s+1],E=y[4*s+2],z=y[4*s+3],P=r(y,s+1),D=.5*n,O=l+1;t(a,o,D,O,b,v||E||z||P),t(a,o+D,D,O,v,E||z||P),t(a+D,o,D,O,E,z||P),t(a+D,o+D,D,O,z,P)}}}function r(e,t){for(var a=null,r=0;null===a;)if(a=e[4*t+r],r++,r>e.length)return null;return a}for(var o=[],n=arguments.length;n--;)o[n]=arguments[n];var l;if(u(o[o.length-1])){var s=o.pop();o.length||null==s.x&&null==s.l&&null==s.left||(o=[s],l={}),l=d(s,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else l={};o.length||(o=b);var p=i.apply(void 0,o),g=[ea(p.x,p.x+p.width),ea(p.y,p.y+p.height),va(p.x,p.x+p.width),va(p.y,p.y+p.height)],m=g[0],f=g[1],x=g[2],_=g[3],v=a([m,f,x,_],b),k=v[0],A=v[1],S=v[2],C=v[3],L=c(l.level,w.length);if(null!=l.d){var E;"number"==typeof l.d?E=[l.d,l.d]:l.d.length&&(E=l.d),L=ea(va(M(-h(_a(E[0])/(b[2]-b[0]))),M(-h(_a(E[1])/(b[3]-b[1])))),L)}if(L=ea(L,w.length),l.lod)return y(k,A,S,C,L);var I=[];return t(0,0,1,0,0,1),I}function y(e,t,a,o,i){for(var n=[],l=0;l<i;l++){var s=A[l],d=S[l][0],c=f(e,t,l),p=f(a,o,l),u=r.ge(s,c),g=r.gt(s,p,u,s.length-1);n[l]=[u+d,g+d]}return n}function f(e,t,a){for(var r=1,o=.5,n=.5,l=.5,s=0;s<a;s++)r<<=2,r+=e<o?t<n?0:1:t<n?2:3,l*=.5,o+=e<o?-l:l,n+=t<n?-l:l;return r}t||(t={}),e=p(e,"float64"),t=d(t,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var _=c(t.maxDepth,255),b=c(t.bounds,s(e,2));b[0]===b[2]&&b[2]++,b[1]===b[3]&&b[3]++;var v=a(e,b),k=e.length>>>1,n;t.dtype||(t.dtype="array"),"string"==typeof t.dtype?n=new(g(t.dtype))(k):t.dtype&&(n=t.dtype,Array.isArray(n)&&(n.length=k));for(var x=0;x<k;++x)n[x]=x;var w=[],T=[],A=[],S=[];o(0,0,1,n,0,1);for(var C=0,L=0,E;L<w.length;L++){if(E=w[L],n.set)n.set(E,C);else for(var I=0,z=E.length;I<z;I++)n[I+C]=E[I];var l=C+w[L].length;S[L]=[C,l],C=l}return n.range=m,n}},{"array-bounds":65,"binary-search-bounds":498,clamp:115,defined:164,dtype:169,"flatten-vertex-data":227,"is-obj":421,"math-log2":432,"parse-rect":459,"pick-by-alias":465}],501:[function(e,t){"use strict";function a(e,t){return this instanceof a?void(this.traces=[],this.passes={},this.regl=e,this.scatter=s(e),this.canvas=this.scatter.canvas):new a(e,t)}function r(e,t,a){var r=null==e.id?e:e.id;return r<<16|(255&t)<<8|255&a}function i(e,t,a){var r=e[t],o=e[a],i,n,l,s,d,c,p,u;return 2<r.length?(i=r[0],l=r[2],n=r[1],s=r[3]):r.length?(i=n=r[0],l=s=r[1]):(i=r.x,n=r.y,l=r.x+r.width,s=r.y+r.height),2<o.length?(d=o[0],p=o[2],c=o[1],u=o[3]):o.length?(d=c=o[0],p=u=o[1]):(d=o.x,c=o.y,p=o.x+o.width,u=o.y+o.height),[d,n,p,s]}function l(e){if("number"==typeof e)return[e,e,e,e];if(2===e.length)return[e[0],e[1],e[0],e[1]];var t=g(e);return[t.x,t.y,t.x+t.width,t.y+t.height]}var s=e("regl-scatter2d"),d=e("pick-by-alias"),c=e("array-bounds"),p=e("raf"),u=e("array-range"),g=e("parse-rect"),h=e("flatten-vertex-data");t.exports=a,a.prototype.render=function(){for(var e=this,t=[],a=arguments.length,r;a--;)t[a]=arguments[a];return(t.length&&(r=this).update.apply(r,t),this.regl.attributes.preserveDrawingBuffer)?this.draw():(this.dirty?null==this.planned&&(this.planned=p(function(){e.draw(),e.dirty=!0,e.planned=null})):(this.draw(),this.dirty=!0,p(function(){e.dirty=!1})),this)},a.prototype.update=function(){for(var e=this,t=[],a=arguments.length,r;a--;)t[a]=arguments[a];if(t.length){for(var o=0;o<t.length;o++)e.updateItem(o,t[o]);this.traces=this.traces.filter(Boolean);for(var n=[],l=0,s=0;s<this.traces.length;s++){for(var d=e.traces[s],c=e.traces[s].passes,p=0;p<c.length;p++)n.push(e.passes[c[p]]);d.passOffset=l,l+=d.passes.length}return(r=this.scatter).update.apply(r,n),this}},a.prototype.updateItem=function(e,t){var a=this,s=this,p=s.regl;if(null===t)return this.traces[e]=null,this;if(!t)return this;var u=d(t,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),o=this.traces[e]||(this.traces[e]={id:e,buffer:p.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:g([p._gl.drawingBufferWidth,p._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=u.color&&(o.color=u.color),null!=u.size&&(o.size=u.size),null!=u.marker&&(o.marker=u.marker),null!=u.borderColor&&(o.borderColor=u.borderColor),null!=u.borderSize&&(o.borderSize=u.borderSize),null!=u.opacity&&(o.opacity=u.opacity),u.viewport&&(o.viewport=g(u.viewport)),null!=u.diagonal&&(o.diagonal=u.diagonal),null!=u.upper&&(o.upper=u.upper),null!=u.lower&&(o.lower=u.lower),u.data){o.buffer(h(u.data)),o.columns=u.data.length,o.count=u.data[0].length,o.bounds=[];for(var y=0;y<o.columns;y++)o.bounds[y]=c(u.data[y],1)}var f;u.range&&(o.range=u.range,f=o.range&&"number"!=typeof o.range[0]),u.domain&&(o.domain=u.domain);var x=!1;null!=u.padding&&(Array.isArray(u.padding)&&u.padding.length===o.columns&&"number"==typeof u.padding[u.padding.length-1]?(o.padding=u.padding.map(l),x=!0):o.padding=l(u.padding));var _=o.columns,m=o.count,n=o.viewport.width,b=o.viewport.height,v=o.viewport.x,k=o.viewport.y,w=n/_,T=b/_;o.passes=[];for(var A=0;A<_;A++)for(var S=0;S<_;S++)if((o.diagonal||S!=A)&&(o.upper||!(A>S))&&(o.lower||!(A<S))){var C=r(o.id,A,S),L=a.passes[C]||(a.passes[C]={});if(u.data&&(L.positions=u.transpose?{x:{buffer:o.buffer,offset:S,count:m,stride:_},y:{buffer:o.buffer,offset:A,count:m,stride:_}}:{x:{buffer:o.buffer,offset:S*m,count:m},y:{buffer:o.buffer,offset:A*m,count:m}},L.bounds=i(o.bounds,A,S)),u.domain||u.viewport||u.data){var E=x?i(o.padding,A,S):o.padding;if(o.domain){var I=i(o.domain,A,S),z=I[0],P=I[1],D=I[2],O=I[3];L.viewport=[v+z*n+E[0],k+P*b+E[1],v+D*n-E[2],k+O*b-E[3]]}else L.viewport=[v+S*w+w*E[0],k+A*T+T*E[1],v+(S+1)*w-w*E[2],k+(A+1)*T-T*E[3]]}u.color&&(L.color=o.color),u.size&&(L.size=o.size),u.marker&&(L.marker=o.marker),u.borderSize&&(L.borderSize=o.borderSize),u.borderColor&&(L.borderColor=o.borderColor),u.opacity&&(L.opacity=o.opacity),u.range&&(L.range=f?i(o.range,A,S):o.range||L.bounds),o.passes.push(C)}return this},a.prototype.draw=function(){for(var e=this,t=[],a=arguments.length,r;a--;)t[a]=arguments[a];if(!t.length)this.scatter.draw();else{for(var o=[],n=0;n<t.length;n++)if("number"==typeof t[n]){var l=e.traces[t[n]],s=l.passes,d=l.passOffset;o.push.apply(o,u(d,d+s.length))}else if(t[n].length){var c=t[n],p=e.traces[n],g=p.passes,h=p.passOffset;g=g.map(function(e,t){o[h+t]=c})}(r=this.scatter).draw.apply(r,o)}return this},a.prototype.destroy=function(){return this.traces.forEach(function(e){e.buffer&&e.buffer.destroy&&e.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":65,"array-range":67,"flatten-vertex-data":227,"parse-rect":459,"pick-by-alias":465,raf:484,"regl-scatter2d":497}],502:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?t.exports=r():"function"==typeof ka&&ka.amd?ka(r):e.createREGL=r()})(this,function(){function e(e,t){this.id=E++,this.type=e,this.data=t}function t(e){if(0===e.length)return[];var r=e.charAt(0),o=e.charAt(e.length-1);if(1<e.length&&r===o&&("\""===r||"'"===r))return["\""+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+"\""];if(r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,r.index)).concat(t(r[1])).concat(t(e.substr(r.index+r[0].length)));if(r=e.split("."),1===r.length)return["\""+e.replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+"\""];for(e=[],o=0;o<r.length;++o)e=e.concat(t(r[o]));return e}function r(e){return"["+t(e).join("][")+"]"}function o(){var t={"":0},r=[""];return{id:function(a){var o=t[a];return o?o:(o=t[a]=r.length,r.push(a),o)},str:function(e){return r[e]}}}function a(t,a,r){function o(){var a=window.innerWidth,o=window.innerHeight;t!==document.body&&(o=t.getBoundingClientRect(),a=o.right-o.left,o=o.bottom-o.top),i.width=r*a,i.height=r*o,te(i.style,{width:a+"px",height:o+"px"})}var i=document.createElement("canvas");return te(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",te(t.style,{margin:0,padding:0})),window.addEventListener("resize",o,!1),o(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",o),t.removeChild(i)}}}function i(e,t){function a(a){try{return e.getContext(a,t)}catch(e){return null}}return a("webgl")||a("experimental-webgl")||a("webgl-experimental")}function l(e){return"string"==typeof e?e.split():e}function s(e){return"string"==typeof e?document.querySelector(e):e}function p(o){var p=o||{},u,h,y,x;o={};var _=[],b=[],v="undefined"==typeof window?1:window.devicePixelRatio,k=!1,w=function(){},T=function(){};if("string"==typeof p?u=document.querySelector(p):"object"==typeof p&&("string"==typeof p.nodeName&&"function"==typeof p.appendChild&&"function"==typeof p.getBoundingClientRect?u=p:"function"==typeof p.drawArrays||"function"==typeof p.drawElements?(x=p,y=x.canvas):("gl"in p?x=p.gl:"canvas"in p?y=s(p.canvas):"container"in p&&(h=s(p.container)),"attributes"in p&&(o=p.attributes),"extensions"in p&&(_=l(p.extensions)),"optionalExtensions"in p&&(b=l(p.optionalExtensions)),"onDone"in p&&(w=p.onDone),"profile"in p&&(k=!!p.profile),"pixelRatio"in p&&(v=+p.pixelRatio))),u&&("canvas"===u.nodeName.toLowerCase()?y=u:h=u),!x){if(!y){if(u=a(h||document.body,w,v),!u)return null;y=u.canvas,T=u.onDestroy}x=i(y,o)}return x?{gl:x,canvas:y,container:h,extensions:_,optionalExtensions:b,pixelRatio:v,profile:k,onDone:w,onDestroy:T}:(T(),w("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function _(t,a){function r(e){e=e.toLowerCase();var a;try{a=o[e]=t.getExtension(e)}catch(e){}return!!a}for(var o={},e=0,i;e<a.extensions.length;++e)if(i=a.extensions[e],!r(i))return a.onDestroy(),a.onDone("\""+i+"\" extension is not supported by the current WebGL context, try upgrading your system or a different browser"),null;return a.optionalExtensions.forEach(r),{extensions:o,restore:function(){Object.keys(o).forEach(function(e){if(o[e]&&!r(e))throw Error("(regl): error restoring extension "+e)})}}}function z(t,a){for(var r=Array(t),o=0;o<t;++o)r[o]=a(o);return r}function n(e){var t,r;return t=(65535<e)<<4,e>>>=t,r=(255<e)<<3,e>>>=r,t|=r,r=(15<e)<<2,e>>>=r,t|=r,r=(3<e)<<1,t|r|e>>>r>>1}function d(){function e(e){a:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break a}e=0}return t=r[n(e)>>2],0<t.length?t.pop():new ArrayBuffer(e)}function t(e){r[n(e.byteLength)>>2].push(e)}var r=z(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,a){var r=null;switch(t){case 5120:r=new Int8Array(e(a),0,a);break;case 5121:r=new Uint8Array(e(a),0,a);break;case 5122:r=new Int16Array(e(2*a),0,a);break;case 5123:r=new Uint16Array(e(2*a),0,a);break;case 5124:r=new Int32Array(e(4*a),0,a);break;case 5125:r=new Uint32Array(e(4*a),0,a);break;case 5126:r=new Float32Array(e(4*a),0,a);break;default:return null;}return r.length===a?r:r.subarray(0,a)},freeType:function(e){t(e.buffer)}}}function T(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||x(e.data))}function u(o,a,i,l,e,s){for(var c=0;c<a;++c)for(var p=o[c],u=0;u<i;++u)for(var g=p[u],h=0;h<l;++h)e[s++]=g[h]}function h(t,a,o,i,e){for(var l=1,s=o+1;s<a.length;++s)l*=a[s];var c=a[o];if(4==a.length-o){var p=a[o+1],r=a[o+2];for(a=a[o+3],s=0;s<c;++s)u(t[s],p,r,a,i,e),e+=l}else for(s=0;s<c;++s)h(t[s],a,o+1,i,e),e+=l}function w(e){return 0|ne[Object.prototype.toString.call(e)]}function k(e,t){for(var a=0;a<t.length;++a)e[a]=t[a]}function A(t,a,o,i,e,l,s){for(var n=0,d=0;d<o;++d)for(var c=0;c<i;++c)t[n++]=a[e*d+l*c+s]}function C(o,a,i,l){function s(e){this.id=n++,this.buffer=o.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,i.profile&&(this.stats={size:0})}function p(e,t,a){e.byteLength=t.byteLength,o.bufferData(e.type,t,a)}function y(o,a,i,n,s,d){if(o.usage=i,Array.isArray(a)){if(o.dtype=n||5126,0<a.length)if(Array.isArray(a[0])){s=ce(a);for(var e=n=1;e<s.length;++e)n*=s[e];o.dimension=n,a=de(a,s,o.dtype),p(o,a,i),d?o.persistentData=a:oe.freeType(a)}else"number"==typeof a[0]?(o.dimension=s,s=oe.allocType(o.dtype,a.length),k(s,a),p(o,s,i),d?o.persistentData=s:oe.freeType(s)):x(a[0])&&(o.dimension=a[0].length,o.dtype=n||w(a[0])||5126,a=de(a,[a.length,a[0].length],o.dtype),p(o,a,i),d?o.persistentData=a:oe.freeType(a));}else if(x(a))o.dtype=n||w(a),o.dimension=s,p(o,a,i),d&&(o.persistentData=new Uint8Array(new Uint8Array(a.buffer)));else if(T(a)){s=a.shape;var c=a.stride,e=a.offset,u=0,g=0,m=0,y=0;1===s.length?(u=s[0],g=1,m=c[0],y=0):2===s.length&&(u=s[0],g=s[1],m=c[0],y=c[1]),o.dtype=n||w(a.data)||5126,o.dimension=g,s=oe.allocType(o.dtype,u*g),A(s,a.data,u,g,m,y,e),p(o,s,i),d?o.persistentData=s:oe.freeType(s)}}function e(e){a.bufferCount--;for(var t=0,r;t<l.state.length;++t)r=l.state[t],r.buffer===e&&(o.disableVertexAttribArray(t),r.buffer=null);o.deleteBuffer(e.buffer),e.buffer=null,delete g[e.id]}var n=0,g={};s.prototype.bind=function(){o.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){e(this)};var d=[];return i.profile&&(a.getTotalBufferSize=function(){var e=0;return Object.keys(g).forEach(function(t){e+=g[t].stats.size}),e}),{create:function(t,r,n,c){function p(t){var a=35044,r=null,n=0,s=0,u=1;return Array.isArray(t)||x(t)||T(t)?r=t:"number"==typeof t?n=0|t:t&&("data"in t&&(r=t.data),"usage"in t&&(a=se[t.usage]),"type"in t&&(s=le[t.type]),"dimension"in t&&(u=0|t.dimension),"length"in t&&(n=0|t.length)),l.bind(),r?y(l,r,a,s,u,c):(n&&o.bufferData(l.type,n,a),l.dtype=s||5121,l.usage=a,l.dimension=u,l.byteLength=n),i.profile&&(l.stats.size=l.byteLength*pe[l.dtype]),p}a.bufferCount++;var l=new s(r);return g[l.id]=l,n||p(t),p._reglType="buffer",p._buffer=l,p.subdata=function(t,a){var r=0|(a||0),i;if(l.bind(),x(t))o.bufferSubData(l.type,r,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var n=oe.allocType(l.dtype,t.length);k(n,t),o.bufferSubData(l.type,r,n),oe.freeType(n)}else(Array.isArray(t[0])||x(t[0]))&&(i=ce(t),n=de(t,i,l.dtype),o.bufferSubData(l.type,r,n),oe.freeType(n));}else if(T(t)){i=t.shape;var s=t.stride,c=n=0,u=0,h=0;1===i.length?(n=i[0],c=1,u=s[0],h=0):2===i.length&&(n=i[0],c=i[1],u=s[0],h=s[1]),i=Array.isArray(t.data)?l.dtype:w(t.data),i=oe.allocType(i,n*c),A(i,t.data,n,c,u,h,t.offset),o.bufferSubData(l.type,r,i),oe.freeType(i)}return p},i.profile&&(p.stats=l.stats),p.destroy=function(){e(l)},p},createStream:function(e,t){var a=d.pop();return a||(a=new s(e)),a.bind(),y(a,t,35040,0,1,!1),a},destroyStream:function(e){d.push(e)},clear:function(){M(g).forEach(e),d.forEach(e)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:function(){M(g).forEach(function(e){e.buffer=o.createBuffer(),o.bindBuffer(e.type,e.buffer),o.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})},_initBuffer:y}}function I(o,a,i,s){function e(e){this.id=l++,n[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function p(t,e,r,n,s,l,c){if(t.buffer.bind(),e){var p=c;c||x(e)&&(!T(e)||x(e.data))||(p=a.oes_element_index_uint?5125:5123),i._initBuffer(t.buffer,e,r,p,3)}else o.bufferData(34963,l,r),t.buffer.dtype=p||5121,t.buffer.usage=r,t.buffer.dimension=3,t.buffer.byteLength=l;if(p=c,!c){switch(t.buffer.dtype){case 5121:case 5120:p=5121;break;case 5123:case 5122:p=5123;break;case 5125:case 5124:p=5125;}t.buffer.dtype=p}t.type=p,e=s,0>e&&(e=t.buffer.byteLength,5123===p?e>>=1:5125===p&&(e>>=2)),t.vertCount=e,e=n,0>n&&(e=4,n=t.buffer.dimension,1===n&&(e=0),2===n&&(e=1),3===n&&(e=4)),t.primType=e}function d(e){s.elementsCount--,delete n[e.id],e.buffer.destroy(),e.buffer=null}var n={},l=0,u={uint8:5121,uint16:5123};a.oes_element_index_uint&&(u.uint32=5125),e.prototype.bind=function(){this.buffer.bind()};var c=[];return{create:function(t){function r(t){if(!t)o(),n.primType=4,n.vertCount=0,n.type=5121;else if("number"==typeof t)o(t),n.primType=4,n.vertCount=0|t,n.type=5121;else{var a=null,i=35044,l=-1,s=-1,d=0,h=0;Array.isArray(t)||x(t)||T(t)?a=t:("data"in t&&(a=t.data),"usage"in t&&(i=se[t.usage]),"primitive"in t&&(l=ue[t.primitive]),"count"in t&&(s=0|t.count),"type"in t&&(h=u[t.type]),"length"in t)?d=0|t.length:(d=s,5123===h||5122===h)?d*=2:(5125===h||5124===h)&&(d*=4),p(n,a,i,l,s,d,h)}return r}var o=i.create(null,34963,!0),n=new e(o._buffer);return s.elementsCount++,r(t),r._reglType="elements",r._elements=n,r.subdata=function(e,t){return o.subdata(e,t),r},r.destroy=function(){d(n)},r},createStream:function(t){var a=c.pop();return a||(a=new e(i.create(null,34963,!0,!1)._buffer)),p(a,t,35040,-1,-1,0,0),a},destroyStream:function(e){c.push(e)},getElements:function(t){return"function"==typeof t&&t._elements instanceof e?t._elements:null},clear:function(){M(n).forEach(d)}}}function g(t){for(var a=oe.allocType(5123,t.length),r=0;r<t.length;++r)if(isNaN(t[r]))a[r]=65535;else if(1/0===t[r])a[r]=31744;else if(-Infinity===t[r])a[r]=64512;else{ge[0]=t[r];var o=he[0],i=o>>>31<<15,n=(o<<1>>>24)-127,o=1023&o>>13;a[r]=-24>n?i:-14>n?i+(o+1024>>-14-n):15<n?i+31744:i+(n+15<<10)+o}return a}function v(e){return Array.isArray(e)||x(e)}function c(e){return"[object "+e+"]"}function m(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function O(e){return!!(Array.isArray(e)&&0!==e.length&&v(e[0]))}function R(e){return Object.prototype.toString.call(e)}function j(e){if(!e)return!1;var t=R(e);return!!(0<=ke.indexOf(t))||m(e)||O(e)||T(e)}function b(e,t){36193===e.type?(e.data=g(t),oe.freeType(t)):e.data=t}function F(t,r,o,i,n,l){if(t="undefined"==typeof Te[t]?fe[t]*we[r]:Te[t],l&&(t*=6),n){for(i=0;1<=o;)i+=t*o*o,o/=2;return i}return t*o*i}function N(o,a,i,s,c,_,E){function e(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function n(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function r(t,a){if("object"==typeof a&&a){"premultiplyAlpha"in a&&(t.premultiplyAlpha=a.premultiplyAlpha),"flipY"in a&&(t.flipY=a.flipY),"alignment"in a&&(t.unpackAlignment=a.alignment),"colorSpace"in a&&(t.colorSpace=K[a.colorSpace]),"type"in a&&(t.type=$[a.type]);var r=t.width,o=t.height,i=t.channels,n=!1;"shape"in a?(r=a.shape[0],o=a.shape[1],3===a.shape.length&&(i=a.shape[2],n=!0)):("radius"in a&&(r=o=a.radius),"width"in a&&(r=a.width),"height"in a&&(o=a.height),"channels"in a&&(i=a.channels,n=!0)),t.width=0|r,t.height=0|o,t.channels=0|i,r=!1,"format"in a&&(r=a.format,o=t.internalformat=G[r],t.format=se[o],r in $&&!("type"in a)&&(t.type=$[r]),r in U&&(t.compressed=!0),r=!0),!n&&r?t.channels=fe[t.format]:n&&!r&&t.channels!==ye[t.format]&&(t.format=t.internalformat=ye[t.channels])}}function H(e){o.pixelStorei(37440,e.flipY),o.pixelStorei(37441,e.premultiplyAlpha),o.pixelStorei(37443,e.colorSpace),o.pixelStorei(3317,e.unpackAlignment)}function t(){e.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function w(t,a){var o=null;if(j(a)?o=a:a&&(r(t,a),"x"in a&&(t.xOffset=0|a.x),"y"in a&&(t.yOffset=0|a.y),j(a.data)&&(o=a.data)),a.copy){var i=c.viewportWidth,n=c.viewportHeight;t.width=t.width||i-t.xOffset,t.height=t.height||n-t.yOffset,t.needsCopy=!0}else if(!o)t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;else if(x(o))t.channels=t.channels||4,t.data=o,"type"in a||5121!==t.type||(t.type=0|ne[Object.prototype.toString.call(o)]);else if(m(o)){switch(t.channels=t.channels||4,i=o,n=i.length,t.type){case 5121:case 5123:case 5125:case 5126:n=oe.allocType(t.type,n),n.set(i),t.data=n;break;case 36193:t.data=g(i);}t.alignment=1,t.needsFree=!0}else if(T(o)){i=o.data,Array.isArray(i)||5121!==t.type||(t.type=0|ne[Object.prototype.toString.call(i)]);var n=o.shape,s=o.stride,u,y,_,k;3===n.length?(_=n[2],k=s[2]):k=_=1,u=n[0],y=n[1],n=s[0],s=s[1],t.alignment=1,t.width=u,t.height=y,t.channels=_,t.format=t.internalformat=ye[_],t.needsFree=!0,u=k,o=o.offset,_=t.width,k=t.height,y=t.channels;for(var A=oe.allocType(36193===t.type?5126:t.type,_*k*y),C=0,E=0;E<k;++E)for(var z=0;z<_;++z)for(var P=0;P<y;++P)A[C++]=i[n*z+s*E+u*P+o];b(t,A)}else if(R(o)===L||R(o)===xe)t.element=R(o)===L?o:o.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(R(o)===_e)t.element=o,t.width=o.width,t.height=o.height,t.channels=4;else if(R(o)===be)t.element=o,t.width=o.naturalWidth,t.height=o.naturalHeight,t.channels=4;else if(R(o)===ve)t.element=o,t.width=o.videoWidth,t.height=o.videoHeight,t.channels=4;else if(O(o)){for(i=t.width||o[0].length,n=t.height||o.length,s=t.channels,s=v(o[0][0])?s||o[0][0].length:s||1,u=S.shape(o),_=1,k=0;k<u.length;++k)_*=u[k];_=oe.allocType(36193===t.type?5126:t.type,_),S.flatten(o,u,"",_),b(t,_),t.alignment=1,t.width=i,t.height=n,t.channels=s,t.format=t.internalformat=ye[s],t.needsFree=!0}}function C(e,t,a,r,i){var n=e.element,d=e.data,l=e.internalformat,c=e.format,p=e.type,u=e.width,g=e.height;H(e),n?o.texSubImage2D(t,i,a,r,c,p,n):e.compressed?o.compressedTexSubImage2D(t,i,a,r,l,u,g,d):e.needsCopy?(s(),o.copyTexSubImage2D(t,i,a,r,e.xOffset,e.yOffset,u,g)):o.texSubImage2D(t,i,a,r,u,g,c,p,d)}function k(){return de.pop()||new t}function h(e){e.needsFree&&oe.freeType(e.data),t.call(e),de.push(e)}function l(){e.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function u(e,t,a){var r=e.images[0]=k();e.mipmask=1,r.width=e.width=t,r.height=e.height=a,r.channels=e.channels=4}function I(t,a){var o=null;if(j(a))o=t.images[0]=k(),n(o,t),w(o,a),t.mipmask=1;else if(r(t,a),Array.isArray(a.mipmap))for(var i=a.mipmap,l=0;l<i.length;++l)o=t.images[l]=k(),n(o,t),o.width>>=l,o.height>>=l,w(o,i[l]),t.mipmask|=1<<l;else o=t.images[0]=k(),n(o,t),w(o,a),t.mipmask=1;n(t,t.images[0])}function z(e,t){for(var a=e.images,r=0;r<a.length&&a[r];++r){var i=a[r],n=t,d=r,l=i.element,c=i.data,u=i.internalformat,g=i.format,m=i.type,y=i.width,x=i.height,_=i.channels;H(i),l?o.texImage2D(n,d,g,g,m,l):i.compressed?o.compressedTexImage2D(n,d,u,y,x,0,c):i.needsCopy?(s(),o.copyTexImage2D(n,d,g,i.xOffset,i.yOffset,y,x,0)):((i=!c)&&(c=oe.zero.allocType(m,y*x*_)),o.texImage2D(n,d,g,y,x,0,g,m,c),i&&c&&oe.zero.freeType(c))}}function B(){var t=P.pop()||new l;e.call(t);for(var a=t.mipmask=0;16>a;++a)t.images[a]=null;return t}function D(e){for(var t=e.images,a=0;a<t.length;++a)t[a]&&h(t[a]),t[a]=null;P.push(e)}function N(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function y(t,a){"min"in a&&(t.minFilter=V[a.min],0<=me.indexOf(t.minFilter)&&!("faces"in a)&&(t.genMipmaps=!0)),"mag"in a&&(t.magFilter=Y[a.mag]);var r=t.wrapS,o=t.wrapT;if("wrap"in a){var i=a.wrap;"string"==typeof i?r=o=A[i]:Array.isArray(i)&&(r=A[i[0]],o=A[i[1]])}else"wrapS"in a&&(r=A[a.wrapS]),"wrapT"in a&&(o=A[a.wrapT]);if(t.wrapS=r,t.wrapT=o,"anisotropic"in a&&(t.anisotropic=a.anisotropic),"mipmap"in a){switch(r=!1,typeof a.mipmap){case"string":t.mipmapHint=f[a.mipmap],r=t.genMipmaps=!0;break;case"boolean":r=t.genMipmaps=a.mipmap;break;case"object":t.genMipmaps=!1,r=!0;}!r||"min"in a||(t.minFilter=9984)}}function q(e,t){o.texParameteri(t,10241,e.minFilter),o.texParameteri(t,10240,e.magFilter),o.texParameteri(t,10242,e.wrapS),o.texParameteri(t,10243,e.wrapT),a.ext_texture_filter_anisotropic&&o.texParameteri(t,34046,e.anisotropic),e.genMipmaps&&(o.hint(33170,e.mipmapHint),o.generateMipmap(t))}function d(t){e.call(this),this.mipmask=0,this.internalformat=6408,this.id=ce++,this.refCount=1,this.target=t,this.texture=o.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new N,E.profile&&(this.stats={size:0})}function Z(e){o.activeTexture(33984),o.bindTexture(e.target,e.texture)}function Q(){var e=ue[0];e?o.bindTexture(e.target,e.texture):o.bindTexture(3553,null)}function p(t){var a=t.texture,r=t.unit,e=t.target;0<=r&&(o.activeTexture(33984+r),o.bindTexture(e,null),ue[r]=null),o.deleteTexture(a),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete pe[t.id],_.textureCount--}var f={"don't care":4352,"dont care":4352,nice:4354,fast:4353},A={repeat:10497,clamp:33071,mirror:33648},Y={nearest:9728,linear:9729},V=te({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Y),K={none:0,browser:37444},$={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},G={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},U={};a.ext_srgb&&(G.srgb=35904,G.srgba=35906),a.oes_texture_float&&($.float32=$.float=5126),a.oes_texture_half_float&&($.float16=$["half float"]=36193),a.webgl_depth_texture&&(te(G,{depth:6402,"depth stencil":34041}),te($,{uint16:5123,uint32:5125,"depth stencil":34042})),a.webgl_compressed_texture_s3tc&&te(U,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),a.webgl_compressed_texture_atc&&te(U,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),a.webgl_compressed_texture_pvrtc&&te(U,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),a.webgl_compressed_texture_etc1&&(U["rgb etc1"]=36196);var W=Array.prototype.slice.call(o.getParameter(34467));Object.keys(U).forEach(function(e){var t=U[e];0<=W.indexOf(t)&&(G[e]=t)});var ee=Object.keys(G);i.textureFormats=ee;var ae=[];Object.keys(G).forEach(function(e){ae[G[e]]=e});var J=[];Object.keys($).forEach(function(e){J[$[e]]=e});var re=[];Object.keys(Y).forEach(function(e){re[Y[e]]=e});var ie=[];Object.keys(V).forEach(function(e){ie[V[e]]=e});var le=[];Object.keys(A).forEach(function(e){le[A[e]]=e});var se=ee.reduce(function(e,t){var a=G[t];return e[a]=6409===a||6406===a||6409===a||6410===a||6402===a||34041===a?a:32855===a||0<=t.indexOf("rgba")?6408:6407,e},{}),de=[],P=[],ce=0,pe={},X=i.maxTextureUnits,ue=Array(X).map(function(){return null});return te(d.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var a=0,r;a<X;++a){if(r=ue[a],r){if(0<r.bindCount)continue;r.unit=-1}ue[a]=this,t=a;break}E.profile&&_.maxTextureUnits<t+1&&(_.maxTextureUnits=t+1),this.unit=t,o.activeTexture(33984+t),o.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&p(this)}}),E.profile&&(_.getTotalTextureSize=function(){var e=0;return Object.keys(pe).forEach(function(t){e+=pe[t].stats.size}),e}),{create2D:function(t,a){function r(t,a){var o=e.texInfo;N.call(o);var i=B();return"number"==typeof t?"number"==typeof a?u(i,0|t,0|a):u(i,0|t,0|t):t?(y(o,t),I(i,t)):u(i,1,1),o.genMipmaps&&(i.mipmask=(i.width<<1)-1),e.mipmask=i.mipmask,n(e,i),e.internalformat=i.internalformat,r.width=i.width,r.height=i.height,Z(e),z(i,3553),q(o,3553),Q(),D(i),E.profile&&(e.stats.size=F(e.internalformat,e.type,i.width,i.height,o.genMipmaps,!1)),r.format=ae[e.internalformat],r.type=J[e.type],r.mag=re[o.magFilter],r.min=ie[o.minFilter],r.wrapS=le[o.wrapS],r.wrapT=le[o.wrapT],r}var e=new d(3553);return pe[e.id]=e,_.textureCount++,r(t,a),r.subimage=function(t,a,o,i){a|=0,o|=0,i|=0;var l=k();return n(l,e),l.width=0,l.height=0,w(l,t),l.width=l.width||(e.width>>i)-a,l.height=l.height||(e.height>>i)-o,Z(e),C(l,3553,a,o,i),Q(),h(l),r},r.resize=function(t,a){var i=0|t,n=0|a||i;if(i===e.width&&n===e.height)return r;r.width=e.width=i,r.height=e.height=n,Z(e);for(var l=e.channels,s=e.type,d=0,c;e.mipmask>>d;++d){var u=i>>d,g=n>>d;if(!u||!g)break;c=oe.zero.allocType(s,u*g*l),o.texImage2D(3553,d,e.format,u,g,0,e.format,e.type,c),c&&oe.zero.freeType(c)}return Q(),E.profile&&(e.stats.size=F(e.internalformat,e.type,i,n,!1,!1)),r},r._reglType="texture2d",r._texture=e,E.profile&&(r.stats=e.stats),r.destroy=function(){e.decRef()},r},createCube:function(t,a,i,e,l,s){function g(t,o,i,l,s,e){var d=x.texInfo,c;for(N.call(d),c=0;6>c;++c)m[c]=B();if("number"==typeof t||!t)for(t=0|t||1,c=0;6>c;++c)u(m[c],t,t);else if("object"==typeof t)if(o)I(m[0],t),I(m[1],o),I(m[2],i),I(m[3],l),I(m[4],s),I(m[5],e);else if(y(d,t),r(x,t),"faces"in t)for(t=t.faces,c=0;6>c;++c)n(m[c],x),I(m[c],t[c]);else for(c=0;6>c;++c)I(m[c],t);for(n(x,m[0]),x.mipmask=d.genMipmaps?(m[0].width<<1)-1:m[0].mipmask,x.internalformat=m[0].internalformat,g.width=m[0].width,g.height=m[0].height,Z(x),c=0;6>c;++c)z(m[c],34069+c);for(q(d,34067),Q(),E.profile&&(x.stats.size=F(x.internalformat,x.type,g.width,g.height,d.genMipmaps,!0)),g.format=ae[x.internalformat],g.type=J[x.type],g.mag=re[d.magFilter],g.min=ie[d.minFilter],g.wrapS=le[d.wrapS],g.wrapT=le[d.wrapT],c=0;6>c;++c)D(m[c]);return g}var x=new d(34067);pe[x.id]=x,_.cubeCount++;var m=[,,,,,,];return g(t,a,i,e,l,s),g.subimage=function(t,a,r,o,i){r|=0,o|=0,i|=0;var l=k();return n(l,x),l.width=0,l.height=0,w(l,a),l.width=l.width||(x.width>>i)-r,l.height=l.height||(x.height>>i)-o,Z(x),C(l,34069+t,r,o,i),Q(),h(l),g},g.resize=function(e){if(e|=0,e!==x.width){g.width=x.width=e,g.height=x.height=e,Z(x);for(var t=0;6>t;++t)for(var a=0;x.mipmask>>a;++a)o.texImage2D(34069+t,a,x.format,e>>a,e>>a,0,x.format,x.type,null);return Q(),E.profile&&(x.stats.size=F(x.internalformat,x.type,g.width,g.height,!1,!0)),g}},g._reglType="textureCube",g._texture=x,E.profile&&(g.stats=x.stats),g.destroy=function(){x.decRef()},g},clear:function(){for(var e=0;e<X;++e)o.activeTexture(33984+e),o.bindTexture(3553,null),ue[e]=null;M(pe).forEach(p),_.cubeCount=0,_.textureCount=0},getTexture:function(){return null},restore:function(){for(var e=0,t;e<X;++e)t=ue[e],t&&(t.bindCount=0,t.unit=-1,ue[e]=null);M(pe).forEach(function(e){e.texture=o.createTexture(),o.bindTexture(e.target,e.texture);for(var t=0;32>t;++t)if(0!=(e.mipmask&1<<t))if(3553===e.target)o.texImage2D(3553,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var a=0;6>a;++a)o.texImage2D(34069+a,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);q(e.texInfo,e.target)})}}}function H(o,a,i,s,e,p){function g(e,t,r){this.target=e,this.texture=t,this.renderbuffer=r;var o=e=0;t?(e=t.width,o=t.height):r&&(e=r.width,o=r.height),this.width=e,this.height=o}function n(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function _(e){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function r(e,t){t&&(t.texture?o.framebufferTexture2D(36160,e,t.target,t.texture._texture.texture,0):o.framebufferRenderbuffer(36160,e,36161,t.renderbuffer._renderbuffer.renderbuffer))}function w(t){var r=3553,o=null,i=null,n=t;return"object"==typeof t&&(n=t.data,"target"in t&&(r=0|t.target)),t=n._reglType,"texture2d"===t?o=n:"textureCube"===t?o=n:"renderbuffer"===t&&(i=n,r=36161),new g(r,o,i)}function t(t,r,o,i,n){return o?(t=s.create2D({width:t,height:r,format:i,type:n}),t._texture.refCount=0,new g(3553,t,null)):(t=e.create({width:t,height:r,format:i}),t._renderbuffer.refCount=0,new g(36161,null,t))}function m(e){return e&&(e.texture||e.renderbuffer)}function T(e,t,a){e&&(e.texture?e.texture.resize(t,a):e.renderbuffer&&e.renderbuffer.resize(t,a),e.width=t,e.height=a)}function d(){this.id=y++,f[this.id]=this,this.framebuffer=o.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function A(e){e.colorAttachments.forEach(n),n(e.depthAttachment),n(e.stencilAttachment),n(e.depthStencilAttachment)}function l(e){o.deleteFramebuffer(e.framebuffer),e.framebuffer=null,p.framebufferCount--,delete f[e.id]}function S(t){var a;o.bindFramebuffer(36160,t.framebuffer);var n=t.colorAttachments;for(a=0;a<n.length;++a)r(36064+a,n[a]);for(a=n.length;a<i.maxColorAttachments;++a)o.framebufferTexture2D(36160,36064+a,3553,null,0);o.framebufferTexture2D(36160,33306,3553,null,0),o.framebufferTexture2D(36160,36096,3553,null,0),o.framebufferTexture2D(36160,36128,3553,null,0),r(36096,t.depthAttachment),r(36128,t.stencilAttachment),r(33306,t.depthStencilAttachment),o.checkFramebufferStatus(36160),o.isContextLost(),o.bindFramebuffer(36160,h.next?h.next.framebuffer:null),h.cur=h.next,o.getError()}function u(r,a){function o(e,a){var r=0,l=0,s=!0,c=!0,p;p=null;var b=!0,C="rgba",L="uint8",I=1,z=null,P=null,D=null,O=!1;"number"==typeof e?(r=0|e,l=0|a||r):e?("shape"in e?(l=e.shape,r=l[0],l=l[1]):("radius"in e&&(r=l=e.radius),"width"in e&&(r=e.width),"height"in e&&(l=e.height)),("color"in e||"colors"in e)&&(p=e.color||e.colors,Array.isArray(p)),!p&&("colorCount"in e&&(I=0|e.colorCount),"colorTexture"in e&&(b=!!e.colorTexture,C="rgba4"),"colorType"in e&&(L=e.colorType,!b)&&("half float"===L||"float16"===L?C="rgba16f":("float"===L||"float32"===L)&&(C="rgba32f")),"colorFormat"in e&&(C=e.colorFormat,0<=v.indexOf(C)?b=!0:0<=x.indexOf(C)&&(b=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(O=e.depthTexture||e.depthStencilTexture),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(z=e.depth,c=!1)),"stencil"in e&&("boolean"==typeof e.stencil?c=e.stencil:(P=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=c=e.depthStencil:(D=e.depthStencil,c=s=!1))):r=l=1;var R=null,M=null,j=null,V=null;if(Array.isArray(p))R=p.map(w);else if(p)R=[w(p)];else for(R=Array(I),p=0;p<I;++p)R[p]=t(r,l,b,C,L);for(r=r||R[0].width,l=l||R[0].height,z?M=w(z):s&&!c&&(M=t(r,l,O,"depth","uint32")),P?j=w(P):c&&!s&&(j=t(r,l,!1,"stencil","uint8")),D?V=w(D):!z&&!P&&c&&s&&(V=t(r,l,O,"depth stencil","depth stencil")),s=null,p=0;p<R.length;++p)_(R[p],r,l),R[p]&&R[p].texture&&(c=Q[R[p].texture._texture.format]*Se[R[p].texture._texture.type],null===s&&(s=c));return _(M,r,l),_(j,r,l),_(V,r,l),A(i),i.width=r,i.height=l,i.colorAttachments=R,i.depthAttachment=M,i.stencilAttachment=j,i.depthStencilAttachment=V,o.color=R.map(m),o.depth=m(M),o.stencil=m(j),o.depthStencil=m(V),o.width=i.width,o.height=i.height,S(i),o}var i=new d;return p.framebufferCount++,o(r,a),te(o,{resize:function(e,t){var a=va(0|e,1),r=va(0|t||a,1);if(a===i.width&&r===i.height)return o;for(var n=i.colorAttachments,l=0;l<n.length;++l)T(n[l],a,r);return T(i.depthAttachment,a,r),T(i.stencilAttachment,a,r),T(i.depthStencilAttachment,a,r),i.width=o.width=a,i.height=o.height=r,S(i),o},_reglType:"framebuffer",_framebuffer:i,destroy:function(){l(i),A(i)},use:function(e){h.setFBO({framebuffer:o},e)}})}var h={cur:null,next:null,dirty:!1,setFBO:null},v=["rgba"],x=["rgba4","rgb565","rgb5 a1"];a.ext_srgb&&x.push("srgba"),a.ext_color_buffer_half_float&&x.push("rgba16f","rgb16f"),a.webgl_color_buffer_float&&x.push("rgba32f");var c=["uint8"];a.oes_texture_half_float&&c.push("half float","float16"),a.oes_texture_float&&c.push("float","float32");var y=0,f={};return te(h,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer,e instanceof d)?e:null},create:u,createCube:function(e){function t(e){var o={color:null},i=0,n=null,c;c="rgba";var p="uint8",y=1;if("number"==typeof e?i=0|e:e?("shape"in e?i=e.shape[0]:("radius"in e&&(i=0|e.radius),"width"in e?i=0|e.width:"height"in e&&(i=0|e.height)),("color"in e||"colors"in e)&&(n=e.color||e.colors,Array.isArray(n)),n||("colorCount"in e&&(y=0|e.colorCount),"colorType"in e&&(p=e.colorType),"colorFormat"in e&&(c=e.colorFormat)),"depth"in e&&(o.depth=e.depth),"stencil"in e&&(o.stencil=e.stencil),"depthStencil"in e&&(o.depthStencil=e.depthStencil)):i=1,!n)for(e=Array(y),n={radius:i,format:c,type:p},c=0;c<y;++c)e[c]=s.createCube(n);else if(Array.isArray(n))for(e=[],c=0;c<n.length;++c)e[c]=n[c];else e=[n];for(o.color=Array(e.length),c=0;c<e.length;++c)y=e[c],i=i||y.width,o.color[c]={target:34069,data:e[c]};for(c=0;6>c;++c){for(y=0;y<e.length;++y)o.color[y].target=34069+c;0<c&&(o.depth=r[0].depth,o.stencil=r[0].stencil,o.depthStencil=r[0].depthStencil),r[c]?r[c](o):r[c]=u(o)}return te(t,{width:i,height:i,color:e})}var r=[,,,,,,];return t(e),te(t,{faces:r,resize:function(o){var i=0|o;if(i===t.width)return t;var n=t.color;for(o=0;o<n.length;++o)n[o].resize(i);for(o=0;6>o;++o)r[o].resize(i);return t.width=t.height=i,t},_reglType:"framebufferCube",destroy:function(){r.forEach(function(e){e.destroy()})}})},clear:function(){M(f).forEach(l)},restore:function(){h.cur=null,h.next=null,h.dirty=!0,M(f).forEach(function(e){e.framebuffer=o.createFramebuffer(),S(e)})}})}function f(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function Y(e,t,r){for(e=r.maxAttributes,t=Array(e),r=0;r<e;++r)t[r]=new f;return{Record:f,scope:{},state:t}}function X(o,a,i,l){function e(e,t,a,r){this.name=e,this.id=t,this.location=a,this.info=r}function s(e,t){for(var a=0;a<e.length;++a)if(e[a].id===t.id)return void(e[a].location=t.location);e.push(t)}function d(t,i,n){n=35632===t?r:p;var l=n[i];if(!l){var s=a.str(i),l=o.createShader(t);o.shaderSource(l,s),o.compileShader(l),n[i]=l}return l}function n(e,t){this.id=g++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],l.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function c(i){var n,c;n=d(35632,i.fragId),c=d(35633,i.vertId);var p=i.program=o.createProgram();o.attachShader(p,n),o.attachShader(p,c),o.linkProgram(p);var u=o.getProgramParameter(p,35718);l.profile&&(i.stats.uniformsCount=u);var g=i.uniforms;for(n=0;n<u;++n)if(c=o.getActiveUniform(p,n))if(1<c.size)for(var h=0,f;h<c.size;++h)f=c.name.replace("[0]","["+h+"]"),s(g,new e(f,a.id(f),o.getUniformLocation(p,f),c));else s(g,new e(c.name,a.id(c.name),o.getUniformLocation(p,c.name),c));for(u=o.getProgramParameter(p,35721),l.profile&&(i.stats.attributesCount=u),g=i.attributes,n=0;n<u;++n)(c=o.getActiveAttrib(p,n))&&s(g,new e(c.name,a.id(c.name),o.getAttribLocation(p,c.name),c))}var r={},p={},u={},h=[],g=0;return l.profile&&(i.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},i.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var e=o.deleteShader.bind(o);M(r).forEach(e),r={},M(p).forEach(e),p={},h.forEach(function(e){o.deleteProgram(e.program)}),h.length=0,u={},i.shaderCount=0},program:function(t,a,r){var o=u[a];o||(o=u[a]={});var l=o[t];return l||(l=new n(a,t),i.shaderCount++,c(l,r),o[t]=l,h.push(l)),l},restore:function(){r={},p={};for(var e=0;e<h.length;++e)c(h[e])},shader:d,frag:-1,vert:-1}}function $(t,o,a,i){function e(e){var n=null===o.next?5121:o.next.colorAttachments[0].texture._texture.type;var s=0,c=0,p=i.framebufferWidth,u=i.framebufferHeight,m=null;return x(e)?m=e:e&&(s=0|e.x,c=0|e.y,p=0|(e.width||i.framebufferWidth-s),u=0|(e.height||i.framebufferHeight-c),m=e.data||null),a(),e=4*(p*u),m||(5121===n?m=new Uint8Array(e):5126===n&&(m=m||new Float32Array(e))),t.pixelStorei(3333,4),t.readPixels(s,c,p,u,6408,n,m),m}function n(t){var a;return o.setFBO({framebuffer:t.framebuffer},function(){a=e(t)}),a}return function(t){return t&&"framebuffer"in t?n(t):e(t)}}function B(e){return Array.prototype.slice.call(e)}function V(e){return B(e).join("")}function U(){function t(){var e=[],t=[];return te(function(){e.push.apply(e,B(arguments))},{def:function(){var a="v"+o++;return t.push(a),0<arguments.length&&(e.push(a,"="),e.push.apply(e,B(arguments)),e.push(";")),a},toString:function(){return V([0<t.length?"var ;":"",V(e)])}})}function r(){function r(t,a){i(t,a,"=",o.def(t,a),";")}var o=t(),i=t(),a=o.toString,e=i.toString;return te(function(){o.apply(o,B(arguments))},{def:o.def,entry:o,exit:i,save:r,set:function(t,a,i){r(t,a),o(t,a,"=",i,";")},toString:function(){return a()+e()}})}var o=0,i=[],e=[],l=t(),s={};return{global:l,link:function(t){for(var a=0;a<e.length;++a)if(e[a]===t)return i[a];return a="g"+o++,i.push(a),e.push(t),a},block:t,proc:function(t,a){function o(){var e="a"+i.length;return i.push(e),e}var i=[];a=a||0;for(var e=0;e<a;++e)o();var e=r(),n=e.toString;return s[t]=te(e,{arg:o,toString:function(){return V(["function(",i.join(),"){",n(),"}"])}})},scope:r,cond:function(){var t=V(arguments),a=r(),o=r(),i=a.toString,e=o.toString;return te(a,{then:function(){return a.apply(a,B(arguments)),this},else:function(){return o.apply(o,B(arguments)),this},toString:function(){var a=e();return a&&(a="else{"+a+"}"),V(["if(",t,"){",i(),"}",a])}})},compile:function(){var t=["\"use strict\";",l,"return {"];Object.keys(s).forEach(function(e){t.push("\"",e,"\":",s[e].toString(),",")}),t.push("}");var a=V(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,i.concat(a)).apply(null,e)}}}function J(e){return Array.isArray(e)||x(e)||T(e)}function q(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function G(t,a,r,o){this.thisDep=t,this.contextDep=a,this.propDep=r,this.append=o}function W(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Z(e){return new G(!1,!1,!1,e)}function D(e,t){var a=e.type;return 0===a?(a=e.data.length,new G(!0,1<=a,2<=a,t)):4===a?(a=e.data,new G(a.thisDep,a.contextDep,a.propDep,t)):new G(3===a,2===a,1===a,t)}function ee(o,i,a,s,_,c,e,n,d,r,p,t,g,m,f){function C(e){return e.replace(".","_")}function l(e,t,a){var r=C(e);ce.push(e),de[r]=se[r]=!!a,pe[r]=t}function u(e,t,a){var r=C(e);ce.push(e),Array.isArray(a)?(se[r]=a.slice(),de[r]=a.slice()):se[r]=de[r]=a,ge[r]=t}function w(){var t=U(),o=t.link,n=t.global;t.id=ye++,t.batchId="0";var l=o(he),s=t.shared={props:"a0"};Object.keys(he).forEach(function(e){s[e]=n.def(l,".",e)});var e=t.next={},d=t.current={};Object.keys(ge).forEach(function(t){Array.isArray(se[t])&&(e[t]=n.def(s.next,".",t),d[t]=n.def(s.current,".",t))});var c=t.constants={};Object.keys(me).forEach(function(e){c[e]=n.def(JSON.stringify(me[e]))}),t.invoke=function(a,r){switch(r.type){case 0:var i=["this",s.context,s.props,t.batchId];return a.def(o(r.data),".call(",i.slice(0,va(r.data.length+1,4)),")");case 1:return a.def(s.props,r.data);case 2:return a.def(s.context,r.data);case 3:return a.def("this",r.data);case 4:return r.data.append(t,a),r.data.ref;}},t.attribCache={};var p={};return t.scopeAttrib=function(e){if(e=i.id(e),e in p)return p[e];var t=r.scope[e];return t||(t=r.scope[e]=new ie),p[e]=o(t)},t}function I(t){var r=t["static"];t=t.dynamic;var o;if("profile"in r){var i=!!r.profile;o=Z(function(){return i}),o.enable=i}else if("profile"in t){var n=t.profile;o=D(n,function(e,t){return e.invoke(t,n)})}return o}function P(t){var a=t["static"],r=t.dynamic;if("framebuffer"in a){var o=a.framebuffer;return o?(o=n.getFramebuffer(o),Z(function(e,t){var a=e.link(o),r=e.shared;return t.set(r.framebuffer,".next",a),r=r.context,t.set(r,".framebufferWidth",a+".width"),t.set(r,".framebufferHeight",a+".height"),a})):Z(function(e,t){var a=e.shared;return t.set(a.framebuffer,".next","null"),a=a.context,t.set(a,".framebufferWidth",a+".drawingBufferWidth"),t.set(a,".framebufferHeight",a+".drawingBufferHeight"),"null"})}if("framebuffer"in r){var i=r.framebuffer;return D(i,function(t,a){var r=t.invoke(a,i),o=t.shared,n=o.framebuffer,r=a.def(n,".getFramebuffer(",r,")");return a.set(n,".next",r),o=o.context,a.set(o,".framebufferWidth",r+"?"+r+".width:"+o+".drawingBufferWidth"),a.set(o,".framebufferHeight",r+"?"+r+".height:"+o+".drawingBufferHeight"),r})}return null}function y(t,r){function o(t){if(t in i){var o=i[t];t=!0;var n=0|o.x,l=0|o.y,s,c;return"width"in o?s=0|o.width:t=!1,"height"in o?c=0|o.height:t=!1,new G(!t&&r&&r.thisDep,!t&&r&&r.contextDep,!t&&r&&r.propDep,function(t,a){var r=t.shared.context,i=s;"width"in o||(i=a.def(r,".","framebufferWidth","-",n));var d=c;return"height"in o||(d=a.def(r,".","framebufferHeight","-",l)),[n,l,i,d]})}if(t in e){var u=e[t];return t=D(u,function(t,a){var r=t.invoke(a,u),o=t.shared.context,i=a.def(r,".x|0"),e=a.def(r,".y|0"),n=a.def("\"width\" in ",r,"?",r,".width|0:","(",o,".","framebufferWidth","-",i,")"),r=a.def("\"height\" in ",r,"?",r,".height|0:","(",o,".","framebufferHeight","-",e,")");return[i,e,n,r]}),r&&(t.thisDep=t.thisDep||r.thisDep,t.contextDep=t.contextDep||r.contextDep,t.propDep=t.propDep||r.propDep),t}return r?new G(r.thisDep,r.contextDep,r.propDep,function(e,t){var a=e.shared.context;return[0,0,t.def(a,".","framebufferWidth"),t.def(a,".","framebufferHeight")]}):null}var i=t["static"],e=t.dynamic;if(t=o("viewport")){var n=t;t=new G(t.thisDep,t.contextDep,t.propDep,function(e,t){var a=n.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",a[2]),t.set(r,".viewportHeight",a[3]),a})}return{viewport:t,scissor_box:o("scissor.box")}}function x(t){function r(e){if(e in o){var t=i.id(o[e]);return e=Z(function(){return t}),e.id=t,e}if(e in n){var r=n[e];return D(r,function(e,t){var a=e.invoke(t,r);return t.def(e.shared.strings,".id(",a,")")})}return null}var o=t["static"],n=t.dynamic,l=r("frag"),s=r("vert"),e=null;return W(l)&&W(s)?(e=p.program(s.id,l.id),t=Z(function(t){return t.link(e)})):t=new G(l&&l.thisDep||s&&s.thisDep,l&&l.contextDep||s&&s.contextDep,l&&l.propDep||s&&s.propDep,function(t,a){var r=t.shared.shader,o;o=l?l.append(t,a):a.def(r,".","frag");var i;return i=s?s.append(t,a):a.def(r,".","vert"),a.def(r+".program("+i+","+o+")")}),{frag:l,vert:s,progVar:t,program:e}}function E(t){function a(t,i){if(t in r){var n=0|r[t];return Z(function(e){return i&&(e.OFFSET=n),n})}if(t in e){var l=e[t];return D(l,function(e,t){var a=e.invoke(t,l);return i&&(e.OFFSET=a),a})}return i&&o?Z(function(e){return e.OFFSET="0",0}):null}var r=t["static"],e=t.dynamic,o=function(){if("elements"in r){var t=r.elements;J(t)?t=c.getElements(c.create(t,!0)):t&&(t=c.getElements(t));var o=Z(function(e){if(t){var a=e.link(t);return e.ELEMENTS=a}return e.ELEMENTS=null});return o.value=t,o}if("elements"in e){var i=e.elements;return D(i,function(t,a){var r=t.shared,o=r.isBufferArgs,r=r.elements,n=t.invoke(a,i),l=a.def("null"),o=a.def(o,"(",n,")"),n=t.cond(o).then(l,"=",r,".createStream(",n,");")["else"](l,"=",r,".getElements(",n,");");return a.entry(n),a.exit(t.cond(o).then(r,".destroyStream(",l,");")),t.ELEMENTS=l})}return null}(),i=a("offset",!0);return{elements:o,primitive:function(){if("primitive"in r){var t=r.primitive;return Z(function(){return ue[t]})}if("primitive"in e){var i=e.primitive;return D(i,function(t,a){var r=t.constants.primTypes,o=t.invoke(a,i);return a.def(r,"[",o,"]")})}return o?W(o)?o.value?Z(function(e,t){return t.def(e.ELEMENTS,".primType")}):Z(function(){return 4}):new G(o.thisDep,o.contextDep,o.propDep,function(e,t){var a=e.ELEMENTS;return t.def(a,"?",a,".primType:",4)}):null}(),count:function(){if("count"in r){var t=0|r.count;return Z(function(){return t})}if("count"in e){var n=e.count;return D(n,function(e,t){return e.invoke(t,n)})}return o?W(o)?o?i?new G(i.thisDep,i.contextDep,i.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):Z(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):Z(function(){return-1}):new G(o.thisDep||i.thisDep,o.contextDep||i.contextDep,o.propDep||i.propDep,function(e,t){var a=e.ELEMENTS;return e.OFFSET?t.def(a,"?",a,".vertCount-",e.OFFSET,":-1"):t.def(a,"?",a,".vertCount:-1")}):null}(),instances:a("instances",!1),offset:i}}function O(t){var r=t["static"],o=t.dynamic,i={};return ce.forEach(function(t){function e(e,n){if(t in r){var l=e(r[t]);i[a]=Z(function(){return l})}else if(t in o){var s=o[t];i[a]=D(s,function(e,t){return n(e,t,e.invoke(t,s))})}}var a=C(t);return"cull.enable"===t||"blend.enable"===t||"dither"===t||"stencil.enable"===t||"depth.enable"===t||"scissor.enable"===t||"polygonOffset.enable"===t||"sample.alpha"===t||"sample.enable"===t||"depth.mask"===t?e(function(e){return e},function(e,t,a){return a}):"depth.func"===t?e(function(e){return Ie[e]},function(e,t,a){return t.def(e.constants.compareFuncs,"[",a,"]")}):"depth.range"===t?e(function(e){return e},function(e,t,r){return e=t.def("+",r,"[0]"),t=t.def("+",r,"[1]"),[e,t]}):"blend.func"===t?e(function(e){return[Ee["srcRGB"in e?e.srcRGB:e.src],Ee["dstRGB"in e?e.dstRGB:e.dst],Ee["srcAlpha"in e?e.srcAlpha:e.src],Ee["dstAlpha"in e?e.dstAlpha:e.dst]]},function(t,r,o){function i(t,a){return r.def("\"",t,a,"\" in ",o,"?",o,".",t,a,":",o,".",t)}t=t.constants.blendFuncs;var n=i("src","RGB"),l=i("dst","RGB"),n=r.def(t,"[",n,"]"),s=r.def(t,"[",i("src","Alpha"),"]"),l=r.def(t,"[",l,"]");return t=r.def(t,"[",i("dst","Alpha"),"]"),[n,l,s,t]}):"blend.equation"===t?e(function(e){return"string"==typeof e?[b[e],b[e]]:"object"==typeof e?[b[e.rgb],b[e.alpha]]:void 0},function(t,r,o){var i=t.constants.blendEquations,n=r.def(),e=r.def();return t=t.cond("typeof ",o,"===\"string\""),t.then(n,"=",e,"=",i,"[",o,"];"),t["else"](n,"=",i,"[",o,".rgb];",e,"=",i,"[",o,".alpha];"),r(t),[n,e]}):"blend.color"===t?e(function(e){return z(4,function(t){return+e[t]})},function(e,t,r){return z(4,function(e){return t.def("+",r,"[",e,"]")})}):"stencil.mask"===t?e(function(e){return 0|e},function(e,t,a){return t.def(a,"|0")}):"stencil.func"===t?e(function(e){return[Ie[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,r){e=t.def("\"cmp\" in ",r,"?",e.constants.compareFuncs,"[",r,".cmp]",":",7680);var o=t.def(r,".ref|0");return t=t.def("\"mask\" in ",r,"?",r,".mask|0:-1"),[e,o,t]}):"stencil.opFront"===t||"stencil.opBack"===t?e(function(e){return["stencil.opBack"===t?1029:1028,ze[e.fail||"keep"],ze[e.zfail||"keep"],ze[e.zpass||"keep"]]},function(a,r,o){function i(t){return r.def("\"",t,"\" in ",o,"?",e,"[",o,".",t,"]:",7680)}var e=a.constants.stencilOps;return["stencil.opBack"===t?1029:1028,i("fail"),i("zfail"),i("zpass")]}):"polygonOffset.offset"===t?e(function(e){return[0|e.factor,0|e.units]},function(e,t,r){return e=t.def(r,".factor|0"),t=t.def(r,".units|0"),[e,t]}):"cull.face"===t?e(function(e){var t=0;return"front"===e?t=1028:"back"==e&&(t=1029),t},function(e,t,a){return t.def(a,"===\"front\"?",1028,":",1029)}):"lineWidth"===t?e(function(e){return e},function(e,t,a){return a}):"frontFace"===t?e(function(e){return Pe[e]},function(e,t,a){return t.def(a+"===\"cw\"?2304:2305")}):"colorMask"===t?e(function(e){return e.map(function(e){return!!e})},function(e,t,r){return z(4,function(e){return"!!"+r+"["+e+"]"})}):"sample.coverage"===t?e(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,r){return e=t.def("\"value\" in ",r,"?+",r,".value:1"),t=t.def("!!",r,".invert"),[e,t]}):void 0}),i}function R(t){var r=t["static"],o=t.dynamic,i={};return Object.keys(r).forEach(function(e){var t=r[e],a;if("number"==typeof t||"boolean"==typeof t)a=Z(function(){return t});else if("function"==typeof t){var o=t._reglType;"texture2d"===o||"textureCube"===o?a=Z(function(e){return e.link(t)}):("framebuffer"===o||"framebufferCube"===o)&&(a=Z(function(e){return e.link(t.color[0])}))}else v(t)&&(a=Z(function(e){return e.global.def("[",z(t.length,function(e){return t[e]}),"]")}));a.value=t,i[e]=a}),Object.keys(o).forEach(function(e){var t=o[e];i[e]=D(t,function(e,a){return e.invoke(a,t)})}),i}function j(t){var r=t["static"],o=t.dynamic,s={};return Object.keys(r).forEach(function(t){var a=r[t],o=i.id(t),e=new ie;if(J(a))e.state=1,e.buffer=_.getBuffer(_.create(a,34962,!1,!0)),e.type=0;else{var d=_.getBuffer(a);if(d)e.state=1,e.buffer=d,e.type=0;else if("constant"in a){var p=a.constant;e.buffer="null",e.state=2,"number"==typeof p?e.x=p:Ce.forEach(function(t,a){a<p.length&&(e[t]=p[a])})}else{var d=J(a.buffer)?_.getBuffer(_.create(a.buffer,34962,!1,!0)):_.getBuffer(a.buffer),u=0|a.offset,g=0|a.stride,h=0|a.size,m=!!a.normalized,l=0;"type"in a&&(l=le[a.type]),a=0|a.divisor,e.buffer=d,e.state=1,e.size=h,e.normalized=m,e.type=l||d.dtype,e.offset=u,e.stride=g,e.divisor=a}}s[t]=Z(function(t){var a=t.attribCache;if(o in a)return a[o];var r={isStream:!1};return Object.keys(e).forEach(function(t){r[t]=e[t]}),e.buffer&&(r.buffer=t.link(e.buffer),r.type=r.type||r.buffer+".dtype"),a[o]=r})}),Object.keys(o).forEach(function(e){var t=o[e];s[e]=D(t,function(r,o){function a(e){o(s[e],"=",i,".",e,"|0;")}var i=r.invoke(o,t),e=r.shared,n=e.isBufferArgs,l=e.buffer,s={isStream:o.def(!1)},d=new ie;d.state=1,Object.keys(d).forEach(function(e){s[e]=o.def(""+d[e])});var c=s.buffer,p=s.type;return o("if(",n,"(",i,")){",s.isStream,"=true;",c,"=",l,".createStream(",34962,",",i,");",p,"=",c,".dtype;","}else{",c,"=",l,".getBuffer(",i,");","if(",c,"){",p,"=",c,".dtype;","}else if(\"constant\" in ",i,"){",s.state,"=",2,";","if(typeof "+i+".constant === \"number\"){",s[Ce[0]],"=",i,".constant;",Ce.slice(1).map(function(e){return s[e]}).join("="),"=0;","}else{",Ce.map(function(e,t){return s[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",n,"(",i,".buffer)){",c,"=",l,".createStream(",34962,",",i,".buffer);","}else{",c,"=",l,".getBuffer(",i,".buffer);","}",p,"=\"type\" in ",i,"?",e.glTypes,"[",i,".type]:",c,".dtype;",s.normalized,"=!!",i,".normalized;"),a("size"),a("offset"),a("stride"),a("divisor"),o("}}"),o.exit("if(",s.isStream,"){",l,".destroyStream(",c,");","}"),s})}),s}function T(e){var t=e["static"],r=e.dynamic,o={};return Object.keys(t).forEach(function(e){var r=t[e];o[e]=Z(function(e){return"number"==typeof r||"boolean"==typeof r?""+r:e.link(r)})}),Object.keys(r).forEach(function(e){var t=r[e];o[e]=D(t,function(e,a){return e.invoke(a,t)})}),o}function h(t,a,r,o,i){var e=P(t,i),n=y(t,e,i),l=E(t,i),s=O(t,i),d=x(t,i),c=n.viewport;return c&&(s.viewport=c),c=C("scissor.box"),(n=n[c])&&(s[c]=n),n=0<Object.keys(s).length,e={framebuffer:e,draw:l,shader:d,state:s,dirty:n},e.profile=I(t,i),e.uniforms=R(r,i),e.attributes=j(a,i),e.context=T(o,i),e}function A(t,a,r){var o=t.shared.context,i=t.scope();Object.keys(r).forEach(function(e){a.save(o,"."+e),i(o,".",e,"=",r[e].append(t,a),";")}),a(i)}function M(t,r,o,i){var n=t.shared,l=n.gl,s=n.framebuffer,d;ne&&(d=r.def(n.extensions,".webgl_draw_buffers"));var c=t.constants,n=c.drawBuffer,c=c.backBuffer;t=o?o.append(t,r):r.def(s,".next"),i||r("if(",t,"!==",s,".cur){"),r("if(",t,"){",l,".bindFramebuffer(",36160,",",t,".framebuffer);"),ne&&r(d,".drawBuffersWEBGL(",n,"[",t,".colorAttachments.length]);"),r("}else{",l,".bindFramebuffer(",36160,",null);"),ne&&r(d,".drawBuffersWEBGL(",c,");"),r("}",s,".cur=",t,";"),i||r("}")}function F(t,a,r){var o=t.shared,i=o.gl,e=t.current,n=t.next,l=o.current,s=o.next,c=t.cond(l,".dirty");ce.forEach(function(a){if(a=C(a),!(a in r.state)){var o,p;if(a in n){o=n[a],p=e[a];var u=z(se[a].length,function(e){return c.def(o,"[",e,"]")});c(t.cond(u.map(function(e,t){return e+"!=="+p+"["+t+"]"}).join("||")).then(i,".",ge[a],"(",u,");",u.map(function(e,t){return p+"["+t+"]="+e}).join(";"),";"))}else o=c.def(s,".",a),u=t.cond(o,"!==",l,".",a),c(u),a in pe?u(t.cond(o).then(i,".enable(",pe[a],");")["else"](i,".disable(",pe[a],");"),l,".",a,"=",o,";"):u(i,".",ge[a],"(",o,");",l,".",a,"=",o,";")}}),0===Object.keys(r.state).length&&c(l,".dirty=false;"),a(c)}function B(t,a,r,o){var i=t.shared,l=t.current,s=i.current,d=i.gl;q(Object.keys(r)).forEach(function(i){var e=r[i];if(!o||o(e)){var c=e.append(t,a);if(pe[i]){var p=pe[i];W(e)?c?a(d,".enable(",p,");"):a(d,".disable(",p,");"):a(t.cond(c).then(d,".enable(",p,");")["else"](d,".disable(",p,");")),a(s,".",i,"=",c,";")}else if(v(c)){var u=l[i];a(d,".",ge[i],"(",c,");",c.map(function(e,t){return u+"["+t+"]="+e}).join(";"),";")}else a(d,".",ge[i],"(",c,");",s,".",i,"=",c,";")}})}function N(e,t){X&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function V(o,i,s,p,d){function e(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function u(t){_=i.def(),t(_,"=",e(),";"),"string"==typeof d?t(f,".count+=",d,";"):t(f,".count++;"),m&&(p?(b=i.def(),t(b,"=",n,".getNumPendingQueries();")):t(n,".beginQuery(",f,");"))}function g(t){t(f,".cpuTime+=",e(),"-",_,";"),m&&(p?t(n,".pushScopeStats(",b,",",n,".getNumPendingQueries(),",f,");"):t(n,".endQuery();"))}function h(e){var t=i.def(x,".profile");i(x,".profile=",e,";"),i.exit(x,".profile=",t,";")}var y=o.shared,f=o.stats,x=y.current,n=y.timer;s=s.profile;var _,b;if(s){if(W(s))return void(s.enable?(u(i),g(i.exit),h("true")):h("false"));s=s.append(o,i),h(s)}else s=i.def(x,".profile");y=o.block(),u(y),i("if(",s,"){",y,"}"),o=o.block(),g(o),i.exit("if(",s,"){",o,"}")}function H(t,r,a,o,i){function e(e){return 35664===e||35667===e||35671===e?2:35665===e||35668===e||35672===e?3:35666===e||35669===e||35673===e?4:1}function n(a,o,i){function e(){r("if(!",l,".buffer){",p,".enableVertexAttribArray(",u,");}");var e=i.type,a;a=i.size?r.def(i.size,"||",o):o,r("if(",l,".type!==",e,"||",l,".size!==",a,"||",n.map(function(e){return l+"."+e+"!=="+i[e]}).join("||"),"){",p,".bindBuffer(",34962,",",h,".buffer);",p,".vertexAttribPointer(",[u,a,e,i.normalized,i.stride,i.offset],");",l,".type=",e,";",l,".size=",a,";",n.map(function(e){return l+"."+e+"="+i[e]+";"}).join(""),"}"),X&&(e=i.divisor,r("if(",l,".divisor!==",e,"){",t.instancing,".vertexAttribDivisorANGLE(",[u,e],");",l,".divisor=",e,";}"))}function d(){r("if(",l,".buffer){",p,".disableVertexAttribArray(",u,");","}if(",Ce.map(function(e,t){return l+"."+e+"!=="+g[t]}).join("||"),"){",p,".vertexAttrib4f(",u,",",g,");",Ce.map(function(e,t){return l+"."+e+"="+g[t]+";"}).join(""),"}")}var p=s.gl,u=r.def(a,".location"),l=r.def(s.attributes,"[",u,"]");a=i.state;var h=i.buffer,g=[i.x,i.y,i.z,i.w],n=["buffer","normalized","offset","stride"];1===a?e():2===a?d():(r("if(",a,"===",1,"){"),e(),r("}else{"),d(),r("}"))}var s=t.shared;o.forEach(function(o){var s=o.name,d=a.attributes[s],c;if(d){if(!i(d))return;c=d.append(t,r)}else{if(!i(De))return;var p=t.scopeAttrib(s);c={},Object.keys(new ie).forEach(function(e){c[e]=r.def(p,".",e)})}n(t.link(o),e(o.info.type),c)})}function Y(o,a,s,d,e){for(var c=o.shared,p=c.gl,u=0,g;u<d.length;++u){var h=d[u],y=h.name,f=h.info.type,x=s.uniforms[y],h=o.link(h)+".location",_;if(x){if(!e(x))continue;if(W(x)){y=x.value,35678===f||35680===f?(f=o.link(y._texture||y.color[0]._texture),a(p,".uniform1i(",h,",",f+".bind());"),a.exit(f,".unbind();")):35674===f||35675===f||35676===f?(y=o.global.def("new Float32Array(["+Array.prototype.slice.call(y)+"])"),x=2,35675===f?x=3:35676===f&&(x=4),a(p,".uniformMatrix",x,"fv(",h,",false,",y,");")):(5126===f?g="1f":35664===f?g="2f":35665===f?g="3f":35666===f?g="4f":35670===f?g="1i":5124===f?g="1i":35671===f?g="2i":35667===f?g="2i":35672===f?g="3i":35668===f?g="3i":35673===f?g="4i":35669===f?g="4i":void 0,a(p,".uniform",g,"(",h,",",v(y)?Array.prototype.slice.call(y):y,");"));continue}else _=x.append(o,a)}else{if(!e(De))continue;_=a.def(c.uniforms,"[",i.id(y),"]")}switch(35678===f?a("if(",_,"&&",_,"._reglType===\"framebuffer\"){",_,"=",_,".color[0];","}"):35680===f&&a("if(",_,"&&",_,"._reglType===\"framebufferCube\"){",_,"=",_,".color[0];","}"),y=1,f){case 35678:case 35680:f=a.def(_,"._texture"),a(p,".uniform1i(",h,",",f,".bind());"),a.exit(f,".unbind();");continue;case 5124:case 35670:g="1i";break;case 35667:case 35671:g="2i",y=2;break;case 35668:case 35672:g="3i",y=3;break;case 35669:case 35673:g="4i",y=4;break;case 5126:g="1f";break;case 35664:g="2f",y=2;break;case 35665:g="3f",y=3;break;case 35666:g="4f",y=4;break;case 35674:g="Matrix2fv";break;case 35675:g="Matrix3fv";break;case 35676:g="Matrix4fv";}if(a(p,".uniform",g,"(",h,","),"M"===g.charAt(0)){var h=ya(f-35674+2,2),b=o.global.def("new Float32Array(",h,")");a("false,(Array.isArray(",_,")||",_," instanceof Float32Array)?",_,":(",z(h,function(e){return b+"["+e+"]="+_+"["+e+"]"}),",",b,")")}else 1<y?a(z(y,function(e){return _+"["+e+"]"})):a(_);a(");")}}function K(o,a,i,s){function d(e){var t=m[e];return t?t.contextDep&&s.contextDynamic||t.propDep?t.append(o,i):t.append(o,a):a.def(h,".",e)}function e(){function e(){i(f,".drawElementsInstancedANGLE(",[n,r,x,y+"<<(("+x+"-5121)>>1)",t],");")}function a(){i(f,".drawArraysInstancedANGLE(",[n,y,r,t],");")}l?_?e():(i("if(",l,"){"),e(),i("}else{"),a(),i("}")):a()}function c(){function e(){i(g+".drawElements("+[n,r,x,y+"<<(("+x+"-5121)>>1)"]+");")}function t(){i(g+".drawArrays("+[n,y,r]+");")}l?_?e():(i("if(",l,"){"),e(),i("}else{"),t(),i("}")):t()}var p=o.shared,g=p.gl,h=p.draw,m=s.draw,l=function(){var t=m.elements,r=a;return t?((t.contextDep&&s.contextDynamic||t.propDep)&&(r=i),t=t.append(o,r)):t=r.def(h,".","elements"),t&&r("if("+t+")"+g+".bindBuffer(34963,"+t+".buffer.buffer);"),t}(),n=d("primitive"),y=d("offset"),r=function(){var t=m.count,r=a;return t?((t.contextDep&&s.contextDynamic||t.propDep)&&(r=i),t=t.append(o,r)):t=r.def(h,".","count"),t}();if(!("number"==typeof r))i("if(",r,"){"),i.exit("}");else if(0===r)return;var t,f;X&&(t=d("instances"),f=o.instancing);var x=l+".type",_=m.elements&&W(m.elements);X&&("number"!=typeof t||0<=t)?"string"==typeof t?(i("if(",t,">0){"),e(),i("}else if(",t,"<0){"),c(),i("}")):e():c()}function k(t,a,r,o,i){return a=w(),i=a.proc("body",i),X&&(a.instancing=i.def(a.shared.extensions,".angle_instanced_arrays")),t(a,i,r,o),a.compile().body}function S(e,t,a,r){N(e,t),H(e,t,a,r.attributes,function(){return!0}),Y(e,t,a,r.uniforms,function(){return!0}),K(e,t,t,a)}function L(t,a){var r=t.proc("draw",1);N(t,r),A(t,r,a.context),M(t,r,a.framebuffer),F(t,r,a),B(t,r,a.state),V(t,r,a,!1,!0);var o=a.shader.progVar.append(t,r);if(r(t.shared.gl,".useProgram(",o,".program);"),a.shader.program)S(t,r,a,a.shader.program);else{var i=t.global.def("{}"),e=r.def(o,".id"),n=r.def(i,"[",e,"]");r(t.cond(n).then(n,".call(this,a0);")["else"](n,"=",i,"[",e,"]=",t.link(function(e){return k(S,t,a,e,1)}),"(",o,");",n,".call(this,a0);"))}0<Object.keys(a.state).length&&r(t.shared.current,".dirty=true;")}function Q(t,a,r,o){function i(){return!0}t.batchId="a1",N(t,a),H(t,a,r,o.attributes,i),Y(t,a,r,o.uniforms,i),K(t,a,a,r)}function $(t,a,r,o){function i(e){return e.contextDep&&n||e.propDep}function e(e){return!i(e)}N(t,a);var n=r.contextDep,s=a.def(),c=a.def();t.shared.props=c,t.batchId=s;var p=t.scope(),u=t.scope();a(p.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",c,"=","a0","[",s,"];",u,"}",p.exit),r.needsContext&&A(t,u,r.context),r.needsFramebuffer&&M(t,u,r.framebuffer),B(t,u,r.state,i),r.profile&&i(r.profile)&&V(t,u,r,!1,!0),o?(H(t,p,r,o.attributes,e),H(t,u,r,o.attributes,i),Y(t,p,r,o.uniforms,e),Y(t,u,r,o.uniforms,i),K(t,p,u,r)):(a=t.global.def("{}"),o=r.shader.progVar.append(t,u),c=u.def(o,".id"),p=u.def(a,"[",c,"]"),u(t.shared.gl,".useProgram(",o,".program);","if(!",p,"){",p,"=",a,"[",c,"]=",t.link(function(e){return k(Q,t,r,e,2)}),"(",o,");}",p,".call(this,a0[",s,"],",s,");"))}function ee(t,r){function o(e){return e.contextDep&&i||e.propDep}var a=t.proc("batch",2);t.batchId="0",N(t,a);var i=!1,n=!0;Object.keys(r.context).forEach(function(e){i=i||r.context[e].propDep}),i||(A(t,a,r.context),n=!1);var l=r.framebuffer,s=!1;if(l?(l.propDep?i=s=!0:l.contextDep&&i&&(s=!0),s||M(t,a,l)):M(t,a,null),r.state.viewport&&r.state.viewport.propDep&&(i=!0),F(t,a,r),B(t,a,r.state,function(e){return!o(e)}),r.profile&&o(r.profile)||V(t,a,r,!1,"a1"),r.contextDep=i,r.needsContext=n,r.needsFramebuffer=s,n=r.shader.progVar,n.contextDep&&i||n.propDep)$(t,a,r,null);else if(n=n.append(t,a),a(t.shared.gl,".useProgram(",n,".program);"),r.shader.program)$(t,a,r,r.shader.program);else{var l=t.global.def("{}"),s=a.def(n,".id"),d=a.def(l,"[",s,"]");a(t.cond(d).then(d,".call(this,a0,a1);")["else"](d,"=",l,"[",s,"]=",t.link(function(e){return k($,t,r,e,2)}),"(",n,");",d,".call(this,a0,a1);"))}0<Object.keys(r.state).length&&a(t.shared.current,".dirty=true;")}function te(t,a){function r(r){var i=a.shader[r];i&&o.set(e.shader,"."+r,i.append(t,o))}var o=t.proc("scope",3);t.batchId="a2";var e=t.shared,n=e.current;A(t,o,a.context),a.framebuffer&&a.framebuffer.append(t,o),q(Object.keys(a.state)).forEach(function(r){var i=a.state[r].append(t,o);v(i)?i.forEach(function(e,a){o.set(t.next[r],"["+a+"]",e)}):o.set(e.next,"."+r,i)}),V(t,o,a,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(r){var i=a.draw[r];i&&o.set(e.draw,"."+r,""+i.append(t,o))}),Object.keys(a.uniforms).forEach(function(r){o.set(e.uniforms,"["+i.id(r)+"]",a.uniforms[r].append(t,o))}),Object.keys(a.attributes).forEach(function(e){var r=a.attributes[e].append(t,o),i=t.scopeAttrib(e);Object.keys(new ie).forEach(function(e){o.set(i,"."+e,r[e])})}),r("vert"),r("frag"),0<Object.keys(a.state).length&&(o(n,".dirty=true;"),o.exit(n,".dirty=true;")),o("a1(",t.shared.context,",a0,",t.batchId,");")}function re(e){if("object"==typeof e&&!v(e)){for(var t=Object.keys(e),a=0;a<t.length;++a)if(ae.isDynamic(e[t[a]]))return!0;return!1}}function oe(t,a,r){function o(e,t){n.forEach(function(a){var r=i[a];ae.isDynamic(r)&&(r=e.invoke(t,r),t(u,".",a,"=",r,";"))})}var i=a["static"][r];if(i&&re(i)){var e=t.global,n=Object.keys(i),s=!1,d=!1,p=!1,u=t.global.def("{}");n.forEach(function(a){var r=i[a];if(ae.isDynamic(r))"function"==typeof r&&(r=i[a]=ae.unbox(r)),a=D(r,null),s=s||a.thisDep,p=p||a.propDep,d=d||a.contextDep;else{switch(e(u,".",a,"="),typeof r){case"number":e(r);break;case"string":e("\"",r,"\"");break;case"object":Array.isArray(r)&&e("[",r.join(),"]");break;default:e(t.link(r));}e(";")}}),a.dynamic[r]=new ae.DynamicVariable(4,{thisDep:s,contextDep:d,propDep:p,ref:u,append:o}),delete a["static"][r]}}var ie=r.Record,b={add:32774,subtract:32778,"reverse subtract":32779};a.ext_blend_minmax&&(b.min=32775,b.max=32776);var X=a.angle_instanced_arrays,ne=a.webgl_draw_buffers,se={dirty:!0,profile:f.profile},de={},ce=[],pe={},ge={};l("dither",3024),l("blend.enable",3042),u("blend.color","blendColor",[0,0,0,0]),u("blend.equation","blendEquationSeparate",[32774,32774]),u("blend.func","blendFuncSeparate",[1,0,1,0]),l("depth.enable",2929,!0),u("depth.func","depthFunc",513),u("depth.range","depthRange",[0,1]),u("depth.mask","depthMask",!0),u("colorMask","colorMask",[!0,!0,!0,!0]),l("cull.enable",2884),u("cull.face","cullFace",1029),u("frontFace","frontFace",2305),u("lineWidth","lineWidth",1),l("polygonOffset.enable",32823),u("polygonOffset.offset","polygonOffset",[0,0]),l("sample.alpha",32926),l("sample.enable",32928),u("sample.coverage","sampleCoverage",[1,!1]),l("stencil.enable",2960),u("stencil.mask","stencilMask",-1),u("stencil.func","stencilFunc",[519,0,-1]),u("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),u("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),l("scissor.enable",3089),u("scissor.box","scissor",[0,0,o.drawingBufferWidth,o.drawingBufferHeight]),u("viewport","viewport",[0,0,o.drawingBufferWidth,o.drawingBufferHeight]);var he={gl:o,context:g,strings:i,next:de,current:se,draw:t,elements:c,buffer:_,shader:p,attributes:r.state,uniforms:d,framebuffer:n,extensions:a,timer:m,isBufferArgs:J},me={primTypes:ue,compareFuncs:Ie,blendFuncs:Ee,blendEquations:b,stencilOps:ze,glTypes:le,orientationType:Pe};ne&&(me.backBuffer=[1029],me.drawBuffer=z(s.maxDrawbuffers,function(e){return 0===e?[0]:z(e,function(e){return 36064+e})}));var ye=0;return{next:de,current:se,procs:function(){var t=w(),a=t.proc("poll"),r=t.proc("refresh"),o=t.block();a(o),r(o);var e=t.shared,i=e.gl,d=e.next,c=e.current;o(c,".dirty=false;"),M(t,a),M(t,r,null,!0);var p;X&&(p=t.link(X));for(var u=0;u<s.maxAttributes;++u){var g=r.def(e.attributes,"[",u,"]"),n=t.cond(g,".buffer");n.then(i,".enableVertexAttribArray(",u,");",i,".bindBuffer(",34962,",",g,".buffer.buffer);",i,".vertexAttribPointer(",u,",",g,".size,",g,".type,",g,".normalized,",g,".stride,",g,".offset);")["else"](i,".disableVertexAttribArray(",u,");",i,".vertexAttrib4f(",u,",",g,".x,",g,".y,",g,".z,",g,".w);",g,".buffer=null;"),r(n),X&&r(p,".vertexAttribDivisorANGLE(",u,",",g,".divisor);")}return Object.keys(pe).forEach(function(n){var e=pe[n],s=o.def(d,".",n),p=t.block();p("if(",s,"){",i,".enable(",e,")}else{",i,".disable(",e,")}",c,".",n,"=",s,";"),r(p),a("if(",s,"!==",c,".",n,"){",p,"}")}),Object.keys(ge).forEach(function(s){var e=ge[s],p=se[s],u=t.block(),g,h;u(i,".",e,"("),v(p)?(e=p.length,g=t.global.def(d,".",s),h=t.global.def(c,".",s),u(z(e,function(e){return g+"["+e+"]"}),");",z(e,function(e){return h+"["+e+"]="+g+"["+e+"];"}).join("")),a("if(",z(e,function(e){return g+"["+e+"]!=="+h+"["+e+"]"}).join("||"),"){",u,"}")):(g=o.def(d,".",s),h=o.def(c,".",s),u(g,");",c,".",s,"=",g,";"),a("if(",g,"!==",h,"){",u,"}")),r(u)}),t.compile()}(),compile:function(t,r,a,o,i){var e=w();return e.stats=e.link(i),Object.keys(r["static"]).forEach(function(t){oe(e,r,t)}),Le.forEach(function(a){oe(e,t,a)}),a=h(t,r,a,o,e),L(e,a),te(e,a),ee(e,a),e.compile()}}}function P(e,t){for(var a=0;a<e.length;++a)if(e[a]===t)return a;return-1}var te=function(t,a){for(var r=Object.keys(a),o=0;o<r.length;++o)t[r[o]]=a[r[o]];return t},E=0,ae={DynamicVariable:e,define:function(t,a){return new e(t,r(a+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t){return"function"==typeof t?new e(0,t):t},accessor:r},K={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},re="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},oe=d();oe.zero=d();var ie=function(t,r){var a=1;r.ext_texture_filter_anisotropic&&(a=t.getParameter(34047));var o=1,i=1;r.webgl_draw_buffers&&(o=t.getParameter(34852),i=t.getParameter(36063));var l=!!r.oes_texture_float;if(l){l=t.createTexture(),t.bindTexture(3553,l),t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var s=t.createFramebuffer();if(t.bindFramebuffer(36160,s),t.framebufferTexture2D(36160,36064,3553,l,0),t.bindTexture(3553,null),36053!==t.checkFramebufferStatus(36160))l=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var p=oe.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,p),t.getError()?l=!1:(t.deleteFramebuffer(s),t.deleteTexture(l),l=1===p[0]),oe.freeType(p)}}return p=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(p=t.createTexture(),s=oe.allocType(5121,36),t.activeTexture(33984),t.bindTexture(34067,p),t.texImage2D(34069,0,6408,3,3,0,6408,5121,s),oe.freeType(s),t.bindTexture(34067,null),t.deleteTexture(p),p=!t.getError()),{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(r).filter(function(e){return!!r[e]}),maxAnisotropic:a,maxDrawbuffers:o,maxColorAttachments:i,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:l,npotTextureCube:p}},x=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},M=function(e){return Object.keys(e).map(function(t){return e[t]})},S={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(t,a,r,o){var i=1;if(a.length)for(var l=0;l<a.length;++l)i*=a[l];else i=0;switch(r=o||oe.allocType(r,i),a.length){case 0:break;case 1:for(o=a[0],a=0;a<o;++a)r[a]=t[a];break;case 2:for(o=a[0],a=a[1],l=i=0;l<o;++l)for(var s=t[l],n=0;n<a;++n)r[i++]=s[n];break;case 3:u(t,a[0],a[1],a[2],r,0);break;default:h(t,a,0,r,0);}return r}},ne={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},le={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},se={dynamic:35048,stream:35040,static:35044},de=S.flatten,ce=S.shape,pe=[];pe[5120]=1,pe[5122]=2,pe[5124]=4,pe[5121]=1,pe[5123]=2,pe[5125]=4,pe[5126]=4;var ue={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ge=new Float32Array(1),he=new Uint32Array(ge.buffer),me=[9984,9986,9985,9987],ye=[0,6409,6410,6407,6408],fe={};fe[6409]=fe[6406]=fe[6402]=1,fe[34041]=fe[6410]=2,fe[6407]=fe[35904]=3,fe[6408]=fe[35906]=4;var L=c("HTMLCanvasElement"),xe=c("CanvasRenderingContext2D"),_e=c("ImageBitmap"),be=c("HTMLImageElement"),ve=c("HTMLVideoElement"),ke=Object.keys(ne).concat([L,xe,_e,be,ve]),we=[];we[5121]=1,we[5126]=4,we[36193]=2,we[5123]=2,we[5125]=4;var Te=[];Te[32854]=2,Te[32855]=2,Te[36194]=2,Te[34041]=4,Te[33776]=.5,Te[33777]=.5,Te[33778]=1,Te[33779]=1,Te[35986]=.5,Te[35987]=1,Te[34798]=1,Te[35840]=.5,Te[35841]=.25,Te[35842]=.5,Te[35843]=.25,Te[36196]=.5;var y=[];y[32854]=2,y[32855]=2,y[36194]=2,y[33189]=2,y[36168]=1,y[34041]=4,y[35907]=4,y[34836]=16,y[34842]=8,y[34843]=6;var Ae=function(o,a,i,l,s){function e(e){this.id=r++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,s.profile&&(this.stats={size:0})}function d(e){var t=e.renderbuffer;o.bindRenderbuffer(36161,null),o.deleteRenderbuffer(t),e.renderbuffer=null,e.refCount=0,delete u[e.id],l.renderbufferCount--}var n={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};a.ext_srgb&&(n.srgba=35907),a.ext_color_buffer_half_float&&(n.rgba16f=34842,n.rgb16f=34843),a.webgl_color_buffer_float&&(n.rgba32f=34836);var p=[];Object.keys(n).forEach(function(e){p[n[e]]=e});var r=0,u={};return e.prototype.decRef=function(){0>=--this.refCount&&d(this)},s.profile&&(l.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach(function(t){e+=u[t].stats.size}),e}),{create:function(t,a){function r(t,a){var l=0,c=0,u=32854;if("object"==typeof t&&t?("shape"in t?(c=t.shape,l=0|c[0],c=0|c[1]):("radius"in t&&(l=c=0|t.radius),"width"in t&&(l=0|t.width),"height"in t&&(c=0|t.height)),"format"in t&&(u=n[t.format])):"number"==typeof t?(l=0|t,c="number"==typeof a?0|a:l):t||(l=c=1),l!==i.width||c!==i.height||u!==i.format)return r.width=i.width=l,r.height=i.height=c,i.format=u,o.bindRenderbuffer(36161,i.renderbuffer),o.renderbufferStorage(36161,u,l,c),s.profile&&(i.stats.size=y[i.format]*i.width*i.height),r.format=p[i.format],r}var i=new e(o.createRenderbuffer());return u[i.id]=i,l.renderbufferCount++,r(t,a),r.resize=function(t,a){var n=0|t,l=0|a||n;return n===i.width&&l===i.height?r:(r.width=i.width=n,r.height=i.height=l,o.bindRenderbuffer(36161,i.renderbuffer),o.renderbufferStorage(36161,i.format,n,l),s.profile&&(i.stats.size=y[i.format]*i.width*i.height),r)},r._reglType="renderbuffer",r._renderbuffer=i,s.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},clear:function(){M(u).forEach(d)},restore:function(){M(u).forEach(function(e){e.renderbuffer=o.createRenderbuffer(),o.bindRenderbuffer(36161,e.renderbuffer),o.renderbufferStorage(36161,e.format,e.width,e.height)}),o.bindRenderbuffer(36161,null)}}},Q=[];Q[6408]=4,Q[6407]=3;var Se=[];Se[5121]=1,Se[5126]=4,Se[36193]=2;var Ce=["x","y","z","w"],Le=["blend.func","blend.equation","stencil.func","stencil.opFront","stencil.opBack","sample.coverage","viewport","scissor.box","polygonOffset.offset"],Ee={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ie={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ze={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Pe={cw:2304,ccw:2305},De=new G(!1,!1,!1,function(){}),Oe=function(t,o){function i(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function l(t,a,r){var o=u.pop()||new i;o.startQueryIndex=t,o.endQueryIndex=a,o.sum=0,o.stats=r,n.push(o)}if(!o.ext_disjoint_timer_query)return null;var s=[],p=[],u=[],n=[],d=[],r=[];return{beginQuery:function(e){var t=s.pop()||o.ext_disjoint_timer_query.createQueryEXT();o.ext_disjoint_timer_query.beginQueryEXT(35007,t),p.push(t),l(p.length-1,p.length,e)},endQuery:function(){o.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:l,update:function(){var t,i;if(t=p.length,0!==t){r.length=va(r.length,t+1),d.length=va(d.length,t+1),d[0]=0;var l=r[0]=0;for(i=t=0;i<p.length;++i){var g=p[i];o.ext_disjoint_timer_query.getQueryObjectEXT(g,34919)?(l+=o.ext_disjoint_timer_query.getQueryObjectEXT(g,34918),s.push(g)):p[t++]=g,d[i+1]=l,r[i+1]=t}for(p.length=t,i=t=0;i<n.length;++i){var l=n[i],m=l.startQueryIndex,g=l.endQueryIndex;l.sum+=d[g]-d[m],m=r[m],g=r[g],g===m?(l.stats.gpuTime+=l.sum/1E6,u.push(l)):(l.startQueryIndex=m,l.endQueryIndex=g,n[t++]=l)}n.length=t}},getNumPendingQueries:function(){return p.length},clear:function(){s.push.apply(s,p);for(var e=0;e<s.length;e++)o.ext_disjoint_timer_query.deleteQueryEXT(s[e]);p.length=0,s.length=0},restore:function(){p.length=0,s.length=0}}};return function(i){function s(){if(0===L.length)x&&x.update(),Z=null;else{Z=K.next(s),w();for(var e=L.length-1,t;0<=e;--e)t=L[e],t&&t(q,null,0);y.flush(),x&&x.update()}}function b(){!Z&&0<L.length&&(Z=K.next(s))}function c(){Z&&(K.cancel(s),Z=null)}function e(e){e.preventDefault(),c(),G.forEach(function(e){e()})}function g(){y.getError(),E.restore(),T.restore(),R.restore(),Q.restore(),A.restore(),M.restore(),x&&x.restore(),oe.procs.refresh(),b(),U.forEach(function(e){e()})}function d(t){function r(t){var a={},r={};return Object.keys(t).forEach(function(o){var i=t[o];ae.isDynamic(i)?r[o]=ae.unbox(i,o):a[o]=i}),{dynamic:r,static:a}}function o(e){for(;l.length<e;)l.push(null);return l}var i=r(t.context||{}),n=r(t.uniforms||{}),e=r(t.attributes||{}),s=r(function(e){function t(e){if(e in r){var t=r[e];delete r[e],Object.keys(t).forEach(function(a){r[e+"."+a]=t[a]})}}var r=te({},e);return delete r.uniforms,delete r.attributes,delete r.context,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),r}(t));t={gpuTime:0,cpuTime:0,count:0};var i=oe.compile(s,e,n,i,t),c=i.draw,p=i.batch,u=i.scope,l=[];return te(function(e,t){var a;if("function"==typeof e)return u.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e)for(a=0;a<e;++a)u.call(this,null,t,a);else if(Array.isArray(e))for(a=0;a<e.length;++a)u.call(this,e[a],t,a);else return u.call(this,e,t,0);}else if("number"!=typeof e){if(!Array.isArray(e))return c.call(this,e);if(e.length)return p.call(this,e,e.length)}else if(0<e)return p.call(this,o(0|e),0|e)},{stats:t})}function n(e,t){var a=0;oe.procs.poll();var r=t.color;r&&(y.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),a|=16384),"depth"in t&&(y.clearDepth(+t.depth),a|=256),"stencil"in t&&(y.clearStencil(0|t.stencil),a|=1024),y.clear(a)}function f(e){return L.push(e),b(),{cancel:function(){function t(){var e=P(L,t);L[e]=L[L.length-1],--L.length,0>=L.length&&c()}var a=P(L,e);L[a]=t}}}function r(){var e=V.viewport,t=V.scissor_box;e[0]=e[1]=t[0]=t[1]=0,q.viewportWidth=q.framebufferWidth=q.drawingBufferWidth=e[2]=t[2]=y.drawingBufferWidth,q.viewportHeight=q.framebufferHeight=q.drawingBufferHeight=e[3]=t[3]=y.drawingBufferHeight}function w(){q.tick+=1,q.time=m(),r(),oe.procs.poll()}function t(){r(),oe.procs.refresh(),x&&x.update()}function m(){return(re()-j)/1E3}if(i=p(i),!i)return null;var y=i.gl,k=y.getContextAttributes();y.isContextLost();var E=_(y,i);if(!E)return null;var l=o(),z={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},v=E.extensions,x=Oe(y,v),j=re(),D=y.drawingBufferWidth,B=y.drawingBufferHeight,q={tick:0,time:0,viewportWidth:D,viewportHeight:B,framebufferWidth:D,framebufferHeight:B,drawingBufferWidth:D,drawingBufferHeight:B,pixelRatio:i.pixelRatio},O=ie(y,v),D=Y(y,v,O,l),R=C(y,z,i,D),F=I(y,v,R,z),T=X(y,l,z,i),Q=N(y,v,O,function(){oe.procs.poll()},q,z,i),A=Ae(y,v,O,z,i),M=H(y,v,O,Q,A,z),oe=ee(y,l,v,O,R,F,Q,M,{},D,T,{elements:null,primitive:4,count:-1,offset:0,instances:-1},q,x,i),l=$(y,M,oe.procs.poll,q,k,v,O),V=oe.next,S=y.canvas,L=[],G=[],U=[],W=[i.onDestroy],Z=null;S&&(S.addEventListener("webglcontextlost",e,!1),S.addEventListener("webglcontextrestored",g,!1));var ne=M.setFBO=d({framebuffer:ae.define.call(null,1,"framebuffer")});return t(),k=te(d,{clear:function(e){if(!("framebuffer"in e))n(null,e);else if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ne(te({framebuffer:e.framebuffer.faces[t]},e),n);else ne(e,n)},prop:ae.define.bind(null,1),context:ae.define.bind(null,2),this:ae.define.bind(null,3),draw:d({}),buffer:function(e){return R.create(e,34962,!1,!1)},elements:function(e){return F.create(e,!1)},texture:Q.create2D,cube:Q.createCube,renderbuffer:A.create,framebuffer:M.create,framebufferCube:M.createCube,attributes:k,frame:f,on:function(e,t){var r;switch(e){case"frame":return f(t);case"lost":r=G;break;case"restore":r=U;break;case"destroy":r=W;}return r.push(t),{cancel:function(){for(var e=0;e<r.length;++e)if(r[e]===t){r[e]=r[r.length-1],r.pop();break}}}},limits:O,hasExtension:function(e){return 0<=O.extensions.indexOf(e.toLowerCase())},read:l,destroy:function(){L.length=0,c(),S&&(S.removeEventListener("webglcontextlost",e),S.removeEventListener("webglcontextrestored",g)),T.clear(),M.clear(),A.clear(),Q.clear(),F.clear(),R.clear(),x&&x.clear(),W.forEach(function(e){e()})},_gl:y,_refresh:t,poll:function(){w(),x&&x.update()},now:m,stats:z}),i.onDone(null,k),k}})},{}],503:[function(e,t){/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */"use strict";function a(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var a=e.length*t;if(o!==e||"undefined"==typeof o)o=e,r="";else if(r.length>=a)return r.substr(0,a);for(;a>r.length&&1<t;)1&t&&(r+=e),t>>=1,e+=e;return r+=e,r=r.substr(0,a),r}var r="",o;t.exports=a},{}],504:[function(e,t){(function(e){t.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],505:[function(e,t){"use strict";t.exports=function(t){for(var e=t.length,r=t[t.length-1],o=e,n=e-2;0<=n;--n){var l=r,s=t[n];r=l+s;var d=r-l,c=s-d;c&&(t[--o]=r,r=c)}for(var p=0,n=o;n<e;++n){var l=t[n],s=r;r=l+s;var d=r-l,c=s-d;c&&(t[p++]=c)}return t[p++]=r,t.length=p,t}},{}],506:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function r(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var r=0;r<e;++r)t[a][r]=["m[",a,"][",r,"]"].join("")}return t}function o(e){return 1&e?"-":""}function n(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",n(e.slice(0,t)),",",n(e.slice(t)),")"].join("")}function l(e){if(2===e.length)return["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("");for(var t=[],r=0;r<e.length;++r)t.push(["scale(",l(a(e,r)),",",o(r),e[0][r],")"].join(""));return n(t)}function s(e){var t=new Function("sum","scale","prod","compress",["function robustDeterminant",e,"(m){return compress(",l(r(e)),")};return robustDeterminant",e].join(""));return t(c,p,d,u)}var d=e("two-product"),c=e("robust-sum"),p=e("robust-scale"),u=e("robust-compress"),g=[function(){return[0]},function(e){return[e[0][0]]}];(function(){for(;g.length<6;)g.push(s(g.length));for(var e=[],a=["function robustDeterminant(m){switch(m.length){"],r=0;r<6;++r)e.push("det"+r),a.push("case ",r,":return det",r,"(m);");a.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),e.push("CACHE","gen",a.join(""));var o=Function.apply(void 0,e);t.exports=o.apply(void 0,g.concat([g,s]));for(var r=0;r<g.length;++r)t.exports[r]=g[r]})()},{"robust-compress":505,"robust-scale":512,"robust-sum":515,"two-product":543}],507:[function(e,t){"use strict";var o=e("two-product"),n=e("robust-sum");t.exports=function(e,t){for(var a=o(e[0],t[0]),l=1;l<e.length;++l)a=n(a,o(e[l],t[l]));return a}},{"robust-sum":515,"two-product":543}],508:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function r(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var r=0;r<e;++r)t[a][r]=["m",r,"[",e-a-2,"]"].join("")}return t}function o(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",o(e.slice(0,t)),",",o(e.slice(t)),")"].join("")}function n(e,t){if("m"===e.charAt(0)){if("w"===t.charAt(0)){var a=e.split("[");return["w",t.substr(1),"m",a[0].substr(1)].join("")}return["prod(",e,",",t,")"].join("")}return n(t,e)}function l(e){return!0&e?"-":""}function s(e){if(2===e.length)return[["diff(",n(e[0][0],e[1][1]),",",n(e[1][0],e[0][1]),")"].join("")];for(var t=[],r=0;r<e.length;++r)t.push(["scale(",o(s(a(e,r))),",",l(r),e[0][r],")"].join(""));return t}function d(e,t){for(var a=[],r=0;r<t-2;++r)a.push(["prod(m",e,"[",r,"],m",e,"[",r,"])"].join(""));return o(a)}function c(e){for(var t=[],n=[],l=r(e),c=0;c<e;++c)l[0][c]="1",l[e-1][c]="w"+c;for(var c=0;c<e;++c)0==(1&c)?t.push.apply(t,s(a(l,c))):n.push.apply(n,s(a(l,c)));for(var p=o(t),m=o(n),f="exactInSphere"+e,x=[],c=0;c<e;++c)x.push("m"+c);for(var _=["function ",f,"(",x.join(),"){"],c=0;c<e;++c){_.push("var w",c,"=",d(c,e),";");for(var b=0;b<e;++b)b!=c&&_.push("var w",c,"m",b,"=scale(w",c,",m",b,"[0]);")}_.push("var p=",p,",n=",m,",d=diff(p,n);return d[d.length-1];}return ",f);var v=new Function("sum","diff","prod","scale",_.join(""));return v(g,h,u,y)}function p(e){var t=f[e.length];return t||(t=f[e.length]=c(e.length)),t.apply(void 0,e)}var u=e("two-product"),g=e("robust-sum"),h=e("robust-subtract"),y=e("robust-scale"),f=[function(){return 0},function(){return 0},function(){return 0}];(function(){for(;f.length<=6;)f.push(c(f.length));for(var e=[],a=["slow"],r=0;r<=6;++r)e.push("a"+r),a.push("o"+r);for(var o=["function testInSphere(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],r=2;r<=6;++r)o.push("case ",r,":return o",r,"(",e.slice(0,r).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),a.push(o.join(""));var n=Function.apply(void 0,a);t.exports=n.apply(void 0,[p].concat(f));for(var r=0;r<=6;++r)t.exports[r]=f[r]})()},{"robust-scale":512,"robust-subtract":514,"robust-sum":515,"two-product":543}],509:[function(e,t){"use strict";function a(e){for(var t="robustLinearSolve"+e+"d",a=["function ",t,"(A,b){return ["],o=0;o<e;++o){a.push("det([");for(var n=0;n<e;++n){0<n&&a.push(","),a.push("[");for(var l=0;l<e;++l)0<l&&a.push(","),l==o?a.push("+b[",n,"]"):a.push("+A[",n,"][",l,"]");a.push("]")}a.push("]),")}a.push("det(A)]}return ",t);var s=new Function("det",a.join(""));return 6>e?s(r[e]):s(r)}var r=e("robust-determinant"),o=[function(){return[0]},function(e,t){return[[t[0]],[e[0][0]]]}];(function(){for(;o.length<6;)o.push(a(o.length));for(var e=[],r=["function dispatchLinearSolve(A,b){switch(A.length){"],n=0;n<6;++n)e.push("s"+n),r.push("case ",n,":return s",n,"(A,b);");r.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),e.push("CACHE","g",r.join(""));var l=Function.apply(void 0,e);t.exports=l.apply(void 0,o.concat([o,a]));for(var n=0;n<6;++n)t.exports[n]=o[n]})()},{"robust-determinant":506}],510:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function r(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var r=0;r<e;++r)t[a][r]=["m",r,"[",e-a-1,"]"].join("")}return t}function o(e){return 1&e?"-":""}function l(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",l(e.slice(0,t)),",",l(e.slice(t)),")"].join("")}function s(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var t=[],r=0;r<e.length;++r)t.push(["scale(",l(s(a(e,r))),",",o(r),e[0][r],")"].join(""));return t}function d(e){for(var t=[],o=[],n=r(e),d=[],c=0;c<e;++c)0==(1&c)?t.push.apply(t,s(a(n,c))):o.push.apply(o,s(a(n,c))),d.push("m"+c);var m=l(t),y=l(o),f="orientation"+e+"Exact",x=["function ",f,"(",d.join(),"){var p=",m,",n=",y,",d=sub(p,n);return d[d.length-1];};return ",f].join(""),_=new Function("sum","prod","scale","sub",x);return _(u,p,g,h)}function c(e){var t=x[e.length];return t||(t=x[e.length]=d(e.length)),t.apply(void 0,e)}var p=e("two-product"),u=e("robust-sum"),g=e("robust-scale"),h=e("robust-subtract"),m=11102230246251565e-32,y=d(3),f=d(4),x=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,a){var o=(e[1]-a[1])*(t[0]-a[0]),i=(e[0]-a[0])*(t[1]-a[1]),r=o-i,n;if(0<o){if(0>=i)return r;n=o+i}else if(0>o){if(0<=i)return r;n=-(o+i)}else return r;var l=(3+16*m)*m*n;return r>=l||r<=-l?r:y(e,t,a)},function(e,t,a,r){var o=e[0]-r[0],i=t[0]-r[0],n=a[0]-r[0],l=e[1]-r[1],s=t[1]-r[1],d=a[1]-r[1],c=e[2]-r[2],p=t[2]-r[2],u=a[2]-r[2],g=i*d,h=n*s,y=n*l,x=o*d,_=o*s,b=i*l,v=c*(g-h)+p*(y-x)+u*(_-b),k=(_a(g)+_a(h))*_a(c)+(_a(y)+_a(x))*_a(p)+(_a(_)+_a(b))*_a(u),w=(7+56*m)*m*k;return v>w||-v>w?v:f(e,t,a,r)}];(function(){for(;x.length<=5;)x.push(d(x.length));for(var e=[],a=["slow"],r=0;r<=5;++r)e.push("a"+r),a.push("o"+r);for(var o=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],r=2;r<=5;++r)o.push("case ",r,":return o",r,"(",e.slice(0,r).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),a.push(o.join(""));var n=Function.apply(void 0,a);t.exports=n.apply(void 0,[c].concat(x));for(var r=0;r<=5;++r)t.exports[r]=x[r]})()},{"robust-scale":512,"robust-subtract":514,"robust-sum":515,"two-product":543}],511:[function(e,t){"use strict";var o=e("robust-sum"),n=e("robust-scale");t.exports=function(e,t){if(1===e.length)return n(t,e[0]);if(1===t.length)return n(e,t[0]);if(0===e.length||0===t.length)return[0];var a=[0];if(e.length<t.length)for(var l=0;l<e.length;++l)a=o(a,n(t,e[l]));else for(var l=0;l<t.length;++l)a=o(a,n(e,t[l]));return a}},{"robust-scale":512,"robust-sum":515}],512:[function(e,t){"use strict";var r=e("two-product"),o=e("two-sum");t.exports=function(l,e){var s=l.length;if(1===s){var n=r(l[0],e);return n[0]?n:[n[1]]}var d=Array(2*s),c=[.1,.1],p=[.1,.1],t=0;r(l[0],e,c),c[0]&&(d[t++]=c[0]);for(var u=1;u<s;++u){r(l[u],e,p);var g=c[1];o(g,p[0],c),c[0]&&(d[t++]=c[0]);var h=p[1],a=c[1],m=h+a,f=a-(m-h);c[1]=m,f&&(d[t++]=f)}return c[1]&&(d[t++]=c[1]),0===t&&(d[t++]=0),d.length=t,d}},{"two-product":543,"two-sum":544}],513:[function(e,t){"use strict";function a(e,t,a,r){for(var o=0;2>o;++o){var i=e[o],n=t[o],l=ea(i,n),s=va(i,n),c=a[o],p=r[o],u=ea(c,p),g=va(c,p);if(g<l||s<u)return!1}return!0}t.exports=function(e,t,o,i){var n=r(e,o,i),l=r(t,o,i);if(0<n&&0<l||0>n&&0>l)return!1;var s=r(o,e,t),d=r(i,e,t);return!(0<s&&0<d||0>s&&0>d)&&(0!==n||0!==l||0!==s||0!==d||a(e,t,o,i))};var r=e("robust-orientation")[3]},{"robust-orientation":510}],514:[function(e,t){"use strict";function r(e,t){var a=e+t,r=a-e,o=e-(a-r)+(t-r);return o?[o,a]:[a]}t.exports=function(t,e){var o=0|t.length,i=0|e.length;if(1==o&&1===i)return r(t[0],-e[0]);var n=Array(o+i),l=0,s=0,d=0,c=_a,p=t[s],u=c(p),g=-e[d],h=c(g),m,f;u<h?(f=p,s+=1,s<o&&(p=t[s],u=c(p))):(f=g,d+=1,d<i&&(g=-e[d],h=c(g))),s<o&&u<h||d>=i?(m=p,s+=1,s<o&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=-e[d],h=c(g)));for(var _=m+f,v=_-m,k=f-v,w=k,T=_,A,S,C,L,E;s<o&&d<i;)u<h?(m=p,s+=1,s<o&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=-e[d],h=c(g))),f=w,_=m+f,v=_-m,k=f-v,k&&(n[l++]=k),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,w=E+L,T=A;for(;s<o;)m=p,f=w,_=m+f,v=_-m,k=f-v,k&&(n[l++]=k),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,w=E+L,T=A,s+=1,s<o&&(p=t[s]);for(;d<i;)m=g,f=w,_=m+f,v=_-m,k=f-v,k&&(n[l++]=k),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,w=E+L,T=A,d+=1,d<i&&(g=-e[d]);return w&&(n[l++]=w),T&&(n[l++]=T),l||(n[l++]=0),n.length=l,n}},{}],515:[function(e,t){"use strict";function r(e,t){var a=e+t,r=a-e,o=e-(a-r)+(t-r);return o?[o,a]:[a]}t.exports=function(t,e){var o=0|t.length,i=0|e.length;if(1==o&&1===i)return r(t[0],e[0]);var n=Array(o+i),l=0,s=0,d=0,c=_a,p=t[s],u=c(p),g=e[d],h=c(g),m,f;u<h?(f=p,s+=1,s<o&&(p=t[s],u=c(p))):(f=g,d+=1,d<i&&(g=e[d],h=c(g))),s<o&&u<h||d>=i?(m=p,s+=1,s<o&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=e[d],h=c(g)));for(var _=m+f,v=_-m,k=f-v,w=k,T=_,A,S,C,L,E;s<o&&d<i;)u<h?(m=p,s+=1,s<o&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=e[d],h=c(g))),f=w,_=m+f,v=_-m,k=f-v,k&&(n[l++]=k),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,w=E+L,T=A;for(;s<o;)m=p,f=w,_=m+f,v=_-m,k=f-v,k&&(n[l++]=k),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,w=E+L,T=A,s+=1,s<o&&(p=t[s]);for(;d<i;)m=g,f=w,_=m+f,v=_-m,k=f-v,k&&(n[l++]=k),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,w=E+L,T=A,d+=1,d<i&&(g=e[d]);return w&&(n[l++]=w),T&&(n[l++]=T),l||(n[l++]=0),n.length=l,n}},{}],516:[function(e,t){"use strict";t.exports=function(e){return 0>e?-1:0<e?1:0}},{}],517:[function(e,t){"use strict";t.exports=function(e){return r(a(e))};var a=e("boundary-cells"),r=e("reduce-simplicial-complex")},{"boundary-cells":95,"reduce-simplicial-complex":489}],518:[function(e,t){"use strict";function a(e){for(var t=e.length,a=0,r=0;r<t;++r)a=0|va(a,e[r].length);return a-1}function r(e,t){for(var a=e.length,r=p.mallocUint8(a),o=0;o<a;++o)r[o]=0|e[o]<t;return r}function o(e,t){for(var r=e.length,o=0|t*(t+1)/2*r,n=p.mallocUint32(2*o),l=0,g=0;g<r;++g)for(var h=e[g],t=h.length,c=0;c<t;++c)for(var m=0;m<c;++m){var y=h[m],a=h[c];n[l++]=0|ea(y,a),n[l++]=0|va(y,a)}var f=0|l/2;u(s(n,[f,2]));for(var x=2,g=2;g<l;g+=2)(n[g-2]!==n[g]||n[g-1]!==n[g+1])&&(n[x++]=n[g],n[x++]=n[g+1]);return s(n,[0|x/2,2])}function i(e,t,r,o){for(var n=e.data,l=e.shape[0],d=p.mallocDouble(l),c=0,u=0;u<l;++u){var g=n[2*u],a=n[2*u+1];if(r[g]!==r[a]){var h=t[g],m=t[a];n[2*c]=g,n[2*c+1]=a,d[c++]=(m-o)/(m-h)}}return e.shape[0]=c,s(d,[c])}function n(e,t){var r=p.mallocInt32(2*t),o=e.shape[0],n=e.data;r[0]=0;for(var l=0,s=0,d;s<o;++s)if(d=n[2*s],d!==l){for(r[2*l+1]=s;++l<d;)r[2*l]=s,r[2*l+1]=s;r[2*l]=s}for(r[2*l+1]=o;++l<t;)r[2*l]=r[2*l+1]=o;return r}function l(e){for(var t=0|e.shape[0],a=e.data,r=Array(t),o=0;o<t;++o)r[o]=[a[2*o],a[2*o+1]];return r}t.exports=function(e,t,s,c){s=s||0,"undefined"==typeof c&&(c=a(e));var u=e.length;if(0===u||1>c)return{cells:[],vertexIds:[],vertexWeights:[]};var h=r(t,+s),m=o(e,c),y=i(m,t,h,+s),f=n(m,0|t.length),x=g(c)(e,m.data,f,h),_=l(m),b=[].slice.call(y.data,0,y.shape[0]);return p.free(h),p.free(m.data),p.free(y.data),p.free(f),{cells:x,vertexIds:_,vertexWeights:b}};var s=e("ndarray"),p=e("typedarray-pool"),u=e("ndarray-sort"),g=e("./lib/codegen")},{"./lib/codegen":519,ndarray:450,"ndarray-sort":448,"typedarray-pool":545}],519:[function(e,t){"use strict";function a(e){function t(e){if(!(0>=e.length)){c.push("R.push(");for(var t=0,a;t<e.length;++t){a=e[t],0<t&&c.push(","),c.push("[");for(var r=0,o;r<a.length;++r)o=a[r],0<r&&c.push(","),c.push("B(C,E,c[",o[0],"],c[",o[1],"])");c.push("]")}c.push(");")}}var a=0,n=Array(e+1);n[0]=[[]];for(var l=1,s;l<=e;++l){s=n[l]=o(l);for(var d=0;d<s.length;++d)a=va(a,s[l].length)}for(var c=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",e,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"],l=e+1;1<l;--l){l<e+1&&c.push("else "),c.push("if(l===",l,"){");for(var p=[],d=0;d<l;++d)p.push("(S[c["+d+"]]<<"+d+")");c.push("var M=",p.join("+"),";if(M===0||M===",(1<<l)-1,"){continue}switch(M){");for(var s=n[l-1],d=0;d<s.length;++d)c.push("case ",d,":"),t(s[d]),c.push("break;");c.push("}}")}c.push("}return R;};return getContour",e,"d");var u=new Function("pool",c.join(""));return u(r)}t.exports=function(e){var t=i[e];return t||(t=i[e]=a(e)),t};var r=e("typedarray-pool"),o=e("marching-simplex-table"),i={}},{"marching-simplex-table":427,"typedarray-pool":545}],520:[function(e,t,a){"use strict";"use restrict";function r(e,a){var r=e.length,o=e.length-a.length,n=ea;if(o)return o;switch(r){case 0:return 0;case 1:return e[0]-a[0];case 2:var l=e[0]+e[1]-a[0]-a[1];return l?l:n(e[0],e[1])-n(a[0],a[1]);case 3:var s=e[0]+e[1],c=a[0]+a[1];if(l=s+e[2]-(c+a[2]),l)return l;var p=n(e[0],e[1]),u=n(a[0],a[1]),l=n(p,e[2])-n(u,a[2]);return l?l:n(p+e[2],s)-n(u+a[2],c);default:var g=e.slice(0);g.sort();var h=a.slice(0);h.sort();for(var m=0;m<r;++m)if(o=g[m]-h[m],o)return o;return 0;}}function o(e,t){return r(e[0],t[0])}function s(e,t){if(t){for(var a=e.length,n=Array(a),l=0;l<a;++l)n[l]=[e[l],t[l]];n.sort(o);for(var l=0;l<a;++l)e[l]=n[l][0],t[l]=n[l][1];return e}return e.sort(r),e}function d(e){if(0===e.length)return[];for(var t=1,o=e.length,n=1,l;n<o;++n)if(l=e[n],r(l,e[n-1])){if(n===t){t++;continue}e[t++]=l}return e.length=t,e}function p(e,t){for(var a=0,o=e.length-1,i=-1;a<=o;){var n=a+o>>1,l=r(e[n],t);0>=l?(0===l&&(i=n),a=n+1):0<l&&(o=n-1)}return i}function u(e,t){for(var a=Array(e.length),o=0,s=a.length;o<s;++o)a[o]=[];for(var d=[],o=0,u=t.length;o<u;++o)for(var n=t[o],c=n.length,g=1;g<1<<c;++g){d.length=y.popCount(g);for(var h=0,m=0;m<c;++m)g&1<<m&&(d[h++]=n[m]);var f=p(e,d);if(!(0>f))for(;a[f++].push(o),!(f>=e.length||0!==r(e[f],d)););}return a}function g(e,t){if(0>t)return[];for(var a=[],r=0,o;r<e.length;++r){o=e[r];for(var n=(1<<t+1)-1;n<1<<o.length;n=y.nextCombination(n)){for(var d=Array(t+1),p=0,u=0;u<o.length;++u)n&1<<u&&(d[p++]=o[u]);a.push(d)}}return s(a)}function h(e,t){for(var a=new f(t),r=0,o;r<e.length;++r){o=e[r];for(var n=0;n<o.length;++n)for(var s=n+1;s<o.length;++s)a.link(o[n],o[s])}for(var d=[],p=a.ranks,r=0;r<p.length;++r)p[r]=-1;for(var r=0,u;r<e.length;++r)u=a.find(e[r][0]),0>p[u]?(p[u]=d.length,d.push([e[r].slice(0)])):d[p[u]].push(e[r].slice(0));return d}function m(e){for(var t=d(s(g(e,0))),a=new f(t.length),r=0,o;r<e.length;++r){o=e[r];for(var n=0,u;n<o.length;++n){u=p(t,[o[n]]);for(var h=n+1;h<o.length;++h)a.link(u,p(t,[o[h]]))}}for(var m=[],y=a.ranks,r=0;r<y.length;++r)y[r]=-1;for(var r=0,x;r<e.length;++r)x=a.find(p(t,[e[r][0]])),0>y[x]?(y[x]=m.length,m.push([e[r].slice(0)])):m[y[x]].push(e[r].slice(0));return m}var y=e("bit-twiddle"),f=e("union-find");a.dimension=function(e){for(var t=0,a=0,r=e.length;a<r;++a)t=va(t,e[a].length);return t-1},a.countVertices=function(e){for(var t=-1,a=0,r=e.length,o;a<r;++a){o=e[a];for(var n=0,l=o.length;n<l;++n)t=va(t,o[n])}return t+1},a.cloneCells=function(e){for(var t=Array(e.length),a=0,r=e.length;a<r;++a)t[a]=e[a].slice(0);return t},a.compareCells=r,a.normalize=s,a.unique=d,a.findCell=p,a.incidence=u,a.dual=function(e,t){if(!t)return u(d(g(e,0)),e,0);for(var a=Array(t),r=0;r<t;++r)a[r]=[];for(var r=0,o=e.length,n;r<o;++r){n=e[r];for(var l=0,s=n.length;l<s;++l)a[n[l]].push(r)}return a},a.explode=function(e){for(var t=[],a=0,r=e.length;a<r;++a)for(var o=e[a],n=0|o.length,l=1,d;l<1<<n;++l){d=[];for(var c=0;c<n;++c)1&l>>>c&&d.push(o[c]);t.push(d)}return s(t)},a.skeleton=g,a.boundary=function(e){for(var t=[],a=0,r=e.length,o;a<r;++a){o=e[a];for(var n=0,d=o.length,p;n<d;++n){p=Array(o.length-1);for(var u=0,g=0;u<d;++u)u!=n&&(p[g++]=o[u]);t.push(p)}}return s(t)},a.connectedComponents=function(e,t){return t?h(e,t):m(e)}},{"bit-twiddle":92,"union-find":546}],521:[function(e,t,a){arguments[4][92][0].apply(a,arguments)},{dup:92}],522:[function(e,t,a){arguments[4][520][0].apply(a,arguments)},{"bit-twiddle":521,dup:520,"union-find":523}],523:[function(e,t){"use strict";"use restrict";function a(e){this.roots=Array(e),this.ranks=Array(e);for(var t=0;t<e;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=a,a.prototype.length=function(){return this.roots.length},a.prototype.makeSet=function(){var e=this.roots.length;return this.roots.push(e),this.ranks.push(0),e},a.prototype.find=function(e){for(var t=this.roots;t[e]!==e;){var a=t[e];t[e]=t[a],e=a}return e},a.prototype.link=function(e,t){var a=this.find(e),r=this.find(t);if(a!==r){var o=this.ranks,i=this.roots,n=o[a],l=o[r];n<l?i[a]=r:l<n?i[r]=a:(i[r]=a,++o[a])}}},{}],524:[function(e,t){"use strict";function a(e,t,a){var o=_a(r(e,t,a)),i=N(ya(t[0]-a[0],2)+ya(t[1]-a[1],2));return o/i}t.exports=function(e,r,l){function d(e){if(A[e])return 1/0;var o=v[e],i=k[e];return 0>o||0>i?1/0:a(r[e],r[o],r[i])}function p(e,r){var o=t[e],a=t[r];t[e]=a,t[r]=o,E[o]=r,E[a]=e}function u(e){return T[t[e]]}function g(e){return 1&e?e-1>>1:(e>>1)-1}function h(e){for(var t=u(e);;){var a=t,r=2*e+1,o=2*(e+1),n=e;if(r<z){var l=u(r);l<a&&(n=r,a=l)}if(o<z){var s=u(o);s<a&&(n=o)}if(n===e)return e;p(e,n),e=n}}function m(e){for(var t=u(e),a;0<e;){if(a=g(e),0<=a){var r=u(a);if(t<r){p(e,a),e=a;continue}}return e}}function y(){if(0<z){var e=t[0];return p(0,z-1),z-=1,h(0),e}return-1}function f(e,r){var o=t[e];return T[o]===r?e:(T[o]=-Infinity,m(e),y(),T[o]=r,z+=1,m(z-1))}function x(e){if(!A[e]){A[e]=!0;var a=v[e],r=k[e];0<=v[r]&&(v[r]=a),0<=k[a]&&(k[a]=r),0<=E[a]&&f(E[a],d(a)),0<=E[r]&&f(E[r],d(r))}}function _(e,a){if(0>e[a])return a;var r=a,o=a;do{var i=e[o];if(!A[o]||0>i||i===o)break;if(o=i,i=e[o],!A[o]||0>i||i===o)break;o=i,r=e[r]}while(r!==o);for(var n=a;n!==o;n=e[n])e[n]=o;return o}for(var b=r.length,n=e.length,v=Array(b),k=Array(b),T=Array(b),A=Array(b),S=0;S<b;++S)v[S]=k[S]=-1,T[S]=1/0,A[S]=!1;for(var S=0,C;S<n;++S){if(C=e[S],2!==C.length)throw new Error("Input must be a graph");var L=C[1],s=C[0];k[s]=-1===k[s]?L:-2,v[L]=-1===v[L]?s:-2}for(var t=[],E=Array(b),S=0,I;S<b;++S)I=T[S]=d(S),I<1/0?(E[S]=t.length,t.push(S)):E[S]=-1;for(var z=t.length,S=z>>1;0<=S;--S)h(S);for(;;){var P=y();if(0>P||T[P]>l)break;x(P)}for(var D=[],S=0;S<b;++S)A[S]||(E[S]=D.length,D.push(r[S].slice()));var O=D.length,R=[];return e.forEach(function(e){var t=_(v,e[0]),a=_(k,e[1]);if(0<=t&&0<=a&&t!==a){var r=E[t],o=E[a];r!==o&&R.push([r,o])}}),o.unique(o.normalize(R)),{positions:D,edges:R}};var r=e("robust-orientation"),o=e("simplicial-complex")},{"robust-orientation":510,"simplicial-complex":522}],525:[function(e,t){"use strict";function r(e,t){var a,r;if(t[0][0]<t[1][0])a=t[0],r=t[1];else if(t[0][0]>t[1][0])a=t[1],r=t[0];else{var i=ea(e[0][1],e[1][1]),n=va(e[0][1],e[1][1]),l=ea(t[0][1],t[1][1]),s=va(t[0][1],t[1][1]);return n<l?n-l:i>s?i-s:n-s}var c,p;e[0][1]<e[1][1]?(c=e[0],p=e[1]):(c=e[1],p=e[0]);var u=o(r,a,c);return u?u:(u=o(r,a,p),u?u:p-r)}t.exports=function(e,t){var a,i;if(t[0][0]<t[1][0])a=t[0],i=t[1];else if(t[0][0]>t[1][0])a=t[1],i=t[0];else return r(t,e);var n,l;if(e[0][0]<e[1][0])n=e[0],l=e[1];else if(e[0][0]>e[1][0])n=e[1],l=e[0];else return-r(e,t);var s=o(a,i,l),d=o(a,i,n);if(0>s){if(0>=d)return s;}else if(0<s){if(0<=d)return s;}else if(d)return d;if(s=o(l,n,i),d=o(l,n,a),0>s){if(0>=d)return s;}else if(0<s){if(0<=d)return s;}else if(d)return d;return i[0]-l[0]};var o=e("robust-orientation")},{"robust-orientation":510}],526:[function(e,t){"use strict";function a(e,t,a){this.slabs=e,this.coordinates=t,this.horizontal=a}function r(t,e){return t.y-e}function i(e,t){for(var a=null;e;){var n=e.key,s,d;n[0][0]<n[1][0]?(s=n[0],d=n[1]):(s=n[1],d=n[0]);var p=c(s,d,t);if(0>p)e=e.left;else if(!(0<p)){if(t[0]!==n[1][0])return e;var o=i(e.right,t);if(o)return o;e=e.left}else if(t[0]!==n[1][0])a=e,e=e.right;else{var o=i(e.right,t);if(o)return o;e=e.left}}return a}function n(e,t,a,r){this.y=e,this.index=t,this.start=a,this.closed=r}function l(e,t,a,r){this.x=e,this.segment=t,this.create=a,this.index=r}t.exports=function(t){for(var r=t.length,o=2*r,c=Array(o),p=0;p<r;++p){var g=t[p],s=g[0][0]<g[1][0];c[2*p]=new l(g[0][0],g,s,p),c[2*p+1]=new l(g[1][0],g,!s,p)}c.sort(function(e,t){var a=e.x-t.x;return a?a:(a=e.create-t.create,a?a:ea(e.segment[0][1],e.segment[1][1])-ea(t.segment[0][1],t.segment[1][1]))});for(var h=d(u),m=[],y=[],f=[],_=-Infinity,p=0;p<o;){for(var b=c[p].x,x=[];p<o;){var v=c[p];if(v.x!==b)break;p+=1,v.segment[0][0]===v.x&&v.segment[1][0]===v.x?v.create&&(v.segment[0][1]<v.segment[1][1]?(x.push(new n(v.segment[0][1],v.index,!0,!0)),x.push(new n(v.segment[1][1],v.index,!1,!1))):(x.push(new n(v.segment[1][1],v.index,!0,!1)),x.push(new n(v.segment[0][1],v.index,!1,!0)))):v.create?h=h.insert(v.segment,v.index):h=h.remove(v.segment)}m.push(h.root),y.push(b),f.push(x)}return new a(m,y,f)};var s=e("binary-search-bounds"),d=e("functional-red-black-tree"),c=e("robust-orientation"),u=e("./lib/order-segments"),g=a.prototype;g.castUp=function(t){var a=s.le(this.coordinates,t[0]);if(0>a)return-1;var n=this.slabs[a],l=i(this.slabs[a],t),d=-1;if(l&&(d=l.value),this.coordinates[a]===t[0]){var p=null;if(l&&(p=l.key),0<a){var g=i(this.slabs[a-1],t);g&&(p?0<u(g.key,p)&&(p=g.key,d=g.value):(d=g.value,p=g.key))}var h=this.horizontal[a];if(0<h.length){var m=s.ge(h,t[1],r);if(m<h.length){var y=h[m];if(t[1]===y.y){if(y.closed)return y.index;for(;m<h.length-1&&h[m+1].y===t[1];)if(++m,y=h[m],y.closed)return y.index;if(y.y===t[1]&&!y.start){if(++m,m>=h.length)return d;y=h[m]}}if(!y.start)y.y!==t[1]&&(d=y.index);else if(p){var f=c(p[0],p[1],[t[0],y.y]);p[0][0]>p[1][0]&&(f=-f),0<f&&(d=y.index)}else d=y.index}}}return d}},{"./lib/order-segments":525,"binary-search-bounds":91,"functional-red-black-tree":230,"robust-orientation":510}],527:[function(e,t){"use strict";function r(e,t){var a=n(i(e,t),[t[t.length-1]]);return a[a.length-1]}function o(e,a,o,l){var s=-a/(l-a);0>s?s=0:1<s&&(s=1);for(var d=1-s,c=e.length,n=Array(c),r=0;r<c;++r)n[r]=s*e[r]+d*o[r];return n}var i=e("robust-dot-product"),n=e("robust-sum");t.exports=function(e,n){for(var l=[],d=[],c=r(e[e.length-1],n),u=e[e.length-1],g=e[0],h=0;h<e.length;++h,u=g){g=e[h];var m=r(g,n);if(0>c&&0<m||0<c&&0>m){var y=o(u,m,g,c);l.push(y),d.push(y.slice())}0>m?d.push(g.slice()):0<m?l.push(g.slice()):(l.push(g.slice()),d.push(g.slice())),c=m}return{positive:l,negative:d}},t.exports.positive=function(e,n){for(var l=[],d=r(e[e.length-1],n),c=e[e.length-1],p=e[0],u=0;u<e.length;++u,c=p){p=e[u];var g=r(p,n);(0>d&&0<g||0<d&&0>g)&&l.push(o(c,g,p,d)),0<=g&&l.push(p.slice()),d=g}return l},t.exports.negative=function(e,n){for(var l=[],d=r(e[e.length-1],n),c=e[e.length-1],p=e[0],u=0;u<e.length;++u,c=p){p=e[u];var g=r(p,n);(0>d&&0<g||0<d&&0>g)&&l.push(o(c,g,p,d)),0>=g&&l.push(p.slice()),d=g}return l}},{"robust-dot-product":507,"robust-sum":515}],528:[function(e,t,a){!function(){"use strict";function e(e){return r(o(e),arguments)}function t(t,a){return e.apply(null,[t].concat(a||[]))}function r(t,a){var r=1,o=t.length,l="",s,d,c,p,u,g,h,m,y;for(d=0;d<o;d++)if("string"==typeof t[d])l+=t[d];else if("object"==typeof t[d]){if(p=t[d],p.keys)for(s=a[r],c=0;c<p.keys.length;c++){if(null==s)throw new Error(e("[sprintf] Cannot access property \"%s\" of undefined value \"%s\"",p.keys[c],p.keys[c-1]));s=s[p.keys[c]]}else s=p.param_no?a[p.param_no]:a[r++];if(n.not_type.test(p.type)&&n.not_primitive.test(p.type)&&s instanceof Function&&(s=s()),n.numeric_arg.test(p.type)&&"number"!=typeof s&&isNaN(s))throw new TypeError(e("[sprintf] expecting number but found %T",s));switch(n.number.test(p.type)&&(m=0<=s),p.type){case"b":s=parseInt(s,10).toString(2);break;case"c":s=D(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,p.width?parseInt(p.width):0);break;case"e":s=p.precision?parseFloat(s).toExponential(p.precision):parseFloat(s).toExponential();break;case"f":s=p.precision?parseFloat(s).toFixed(p.precision):parseFloat(s);break;case"g":s=p.precision?+s.toPrecision(p.precision)+"":parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s+="",s=p.precision?s.substring(0,p.precision):s;break;case"t":s=!!s+"",s=p.precision?s.substring(0,p.precision):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=p.precision?s.substring(0,p.precision):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=p.precision?s.substring(0,p.precision):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase();}n.json.test(p.type)?l+=s:(n.number.test(p.type)&&(!m||p.sign)?(y=m?"+":"-",s=s.toString().replace(n.sign,"")):y="",g=p.pad_char?"0"===p.pad_char?"0":p.pad_char.charAt(1):" ",h=p.width-(y+s).length,u=p.width?0<h?g.repeat(h):"":"",l+=p.align?y+s+u:"0"===g?y+u+s:u+y+s)}return l}function o(e){if(i[e])return i[e];for(var t=e,a=[],r=0,o;t;){if(null!==(o=n.text.exec(t)))a.push(o[0]);else if(null!==(o=n.modulo.exec(t)))a.push("%");else if(null!==(o=n.placeholder.exec(t))){if(o[2]){r|=1;var l=[],s=o[2],d=[];if(null!==(d=n.key.exec(s))){for(l.push(d[1]);""!==(s=s.substring(d[0].length));)if(null!==(d=n.key_access.exec(s)))l.push(d[1]);else if(null!==(d=n.index_access.exec(s)))l.push(d[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");}else throw new SyntaxError("[sprintf] failed to parse named argument key");o[2]=l}else r|=2;if(3===r)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");a.push({placeholder:o[0],param_no:o[1],keys:o[2],sign:o[3],pad_char:o[4],align:o[5],width:o[6],precision:o[7],type:o[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");t=t.substring(o[0].length)}return i[e]=a}var n={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},i=Object.create(null);"undefined"!=typeof a&&(a.sprintf=e,a.vsprintf=t),"undefined"!=typeof window&&(window.sprintf=e,window.vsprintf=t,"function"==typeof ka&&ka.amd&&ka(function(){return{sprintf:e,vsprintf:t}}))}()},{}],529:[function(e,t){"use strict";var a=e("parenthesis");t.exports=function(e,t,r){if(null==e)throw Error("First argument should be a string");if(null==t)throw Error("Separator should be a string or a RegExp");r?("string"==typeof r||Array.isArray(r))&&(r={ignore:r}):r={},null==r.escape&&(r.escape=!0),null==r.ignore?r.ignore=["[]","()","{}","<>","\"\"","''","``","\u201C\u201D","\xAB\xBB"]:("string"==typeof r.ignore&&(r.ignore=[r.ignore]),r.ignore=r.ignore.map(function(e){return 1===e.length&&(e+=e),e}));var n=a.parse(e,{flat:!0,brackets:r.ignore}),l=n[0],s=l.split(t);if(r.escape){for(var d=[],c=0;c<s.length;c++){var p=s[c],u=s[c+1];"\\"===p[p.length-1]&&"\\"!==p[p.length-2]?(d.push(p+t+u),c++):d.push(p)}s=d}for(var c=0;c<s.length;c++)n[0]=s[c],s[c]=a.stringify(n,{flat:!0});return s}},{parenthesis:458}],530:[function(e,t){"use strict";t.exports=function(t){function a(a){var r=[a],p=[a];for(o[a]=n[a]=g,l[a]=!0,g+=1;0<p.length;){a=p[p.length-1];var y=t[a];if(s[a]<y.length){for(var e=s[a],f;e<y.length;++e){if(f=y[e],0>o[f]){o[f]=n[f]=g,l[f]=!0,g+=1,r.push(f),p.push(f);break}else l[f]&&(n[a]=0|ea(n[a],n[f]));0<=d[f]&&c[a].push(d[f])}s[a]=e}else{if(n[a]===o[a]){for(var x=[],_=[],b=0,e=r.length-1,k;0<=e;--e)if(k=r[e],l[k]=!1,x.push(k),_.push(c[k]),b+=c[k].length,d[k]=h.length,k===a){r.length=e;break}h.push(x);for(var T=Array(b),e=0;e<_.length;e++)for(var A=0;A<_[e].length;A++)T[--b]=_[e][A];m.push(T)}p.pop()}}}for(var r=t.length,o=Array(r),n=Array(r),l=Array(r),s=Array(r),d=Array(r),c=Array(r),p=0;p<r;++p)o[p]=-1,n[p]=0,l[p]=!1,s[p]=0,d[p]=-1,c[p]=[];for(var g=0,h=[],m=[],p=0;p<r;++p)0>o[p]&&a(p);for(var p=0,y,f;p<m.length;p++)if(f=m[p],0!==f.length){f.sort(function(e,t){return e-t}),y=[f[0]];for(var u=1;u<f.length;u++)f[u]!==f[u-1]&&y.push(f[u]);m[p]=y}return{components:h,adjacencyList:m}}},{}],531:[function(e,t){"use strict";function a(e,t){var a=e.length,r=["'use strict';"],s="surfaceNets"+e.join("_")+"d"+t;r.push("var contour=genContour({","order:[",e.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),"generic"===t&&r.push("getters:[0],");for(var d=[],c=[],p=0;p<a;++p)d.push("d"+p),c.push("d"+p);for(var p=0;p<1<<a;++p)d.push("v"+p),c.push("v"+p);for(var p=0;p<1<<a;++p)d.push("p"+p),c.push("p"+p);d.push("a","b","c"),c.push("a","c"),r.push("vertex:function vertexFunc(",d.join(),"){");for(var g=[],p=0;p<1<<a;++p)g.push("(p"+p+"<<"+p+")");r.push("var m=(",g.join("+"),")|0;if(m===0||m===",(1<<(1<<a))-1,"){return}");var h=[],m=[];128>=1<<(1<<a)?(r.push("switch(m){"),m=r):r.push("switch(m>>>7){");for(var p=0;p<1<<(1<<a);++p){if(128<1<<(1<<a)&&0==p%128){0<h.length&&m.push("}}");var y="vExtra"+h.length;r.push("case ",p>>>7,":",y,"(m&0x7f,",c.join(),");break;"),m=["function ",y,"(m,",c.join(),"){switch(m){"],h.push(m)}m.push("case ",127&p,":");for(var f=Array(a),x=Array(a),_=Array(a),b=Array(a),v=0,w=0;w<a;++w)f[w]=[],x[w]=[],_[w]=0,b[w]=0;for(var w=0;w<1<<a;++w)for(var T=0,A;T<a;++T)if((A=w^1<<T,!(A>w))&&!(p&1<<A)!=!(p&1<<w)){var S=1;p&1<<A?x[T].push("v"+A+"-v"+w):(x[T].push("v"+w+"-v"+A),S=-S),0>S?(f[T].push("-v"+w+"-v"+A),_[T]+=2):(f[T].push("v"+w+"+v"+A),_[T]-=2),v+=1;for(var C=0;C<a;++C)C!=T&&(A&1<<C?b[C]+=1:b[C]-=1)}for(var L=[],T=0;T<a;++T)if(0===f[T].length)L.push("d"+T+"-0.5");else{var E="";0>_[T]?E=_[T]+"*c":0<_[T]&&(E="+"+_[T]+"*c");var I=.5*(f[T].length/v),z=.5+.5*(b[T]/v);L.push("d"+T+"-"+z+"-"+I+"*("+f[T].join("+")+E+")/("+x[T].join("+")+")")}m.push("a.push([",L.join(),"]);","break;")}r.push("}},"),0<h.length&&m.push("}}");for(var P=[],p=0;p<1<<a-1;++p)P.push("v"+p);P.push("c0","c1","p0","p1","a","b","c"),r.push("cell:function cellFunc(",P.join(),"){");var D=n(a-1);r.push("if(p0){b.push(",D.map(function(e){return"["+e.map(function(e){return"v"+e})+"]"}).join(),")}else{b.push(",D.map(function(t){var a=t.slice();return a.reverse(),"["+a.map(function(e){return"v"+e})+"]"}).join(),")}}});function ",s,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",s,";");for(var p=0;p<h.length;++p)r.push(h[p].join(""));var O=new Function("genContour",r.join(""));return O(o)}function r(e,t){for(var a=l(e,t),r=a.length,o=Array(r),n=Array(r),s=0;s<r;++s)o[s]=[a[s]],n[s]=[s];return{positions:o,cells:n}}t.exports=function(e,t){if(0>=e.dimension)return{positions:[],cells:[]};if(1===e.dimension)return r(e,t);var o=e.order.join()+"-"+e.dtype,i=s[o],t=+t||0;return i||(i=s[o]=a(e.order,e.dtype)),i(e,t)};var o=e("ndarray-extract-contour"),n=e("triangulate-hypercube"),l=e("zero-crossings"),s={}},{"ndarray-extract-contour":439,"triangulate-hypercube":541,"zero-crossings":574}],532:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=function(){function e(e,t){var a=[],r=!0,o=!1,i=void 0;try{for(var n=e[Symbol.iterator](),l;!(r=(l=n.next()).done)&&(a.push(l.value),!(t&&a.length===t));r=!0);}catch(e){o=!0,i=e}finally{try{!r&&n["return"]&&n["return"]()}finally{if(o)throw i}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=2*Pe,i=function(e,t,a,r,o,i,n){var l=e.x,s=e.y;l*=t,s*=a;var d=r*l-o*s,c=o*l+r*s;return{x:d+i,y:c+n}},n=function(e,t){var a=.551915024494*(0>t?-1:1),r=R(e),o=De(e),i=R(e+t),n=De(e+t);return[{x:r-o*a,y:o+r*a},{x:i+n*a,y:n-i*a},{x:i,y:n}]},l=function(e,t,a,r){var o=0>e*r-t*a?-1:1,i=N(e*e+t*t),n=N(e*e+t*t),l=(e*a+t*r)/(i*n);return 1<l&&(l=1),-1>l&&(l=-1),o*d(l)},s=function(e,t,a,r,i,n,s,d,c,p,u,g){var h=ya(i,2),m=ya(n,2),y=ya(u,2),f=ya(g,2),x=h*m-h*f-m*y;0>x&&(x=0),x/=h*f+m*y,x=N(x)*(s===d?-1:1);var _=x*i/n*g,b=x*-n/i*u,v=(u-_)/i,k=(g-b)/n,w=l(1,0,v,k),T=l(v,k,(-u-_)/i,(-g-b)/n);return 0===d&&0<T&&(T-=o),1===d&&0>T&&(T+=o),[p*_-c*b+(e+a)/2,c*_+p*b+(t+r)/2,w,T]};a.default=function(e){var t=e.px,a=e.py,l=e.cx,d=e.cy,c=e.rx,p=e.ry,u=e.xAxisRotation,g=u===void 0?0:u,h=e.largeArcFlag,m=h===void 0?0:h,y=e.sweepFlag,f=y===void 0?0:y,x=[];if(0===c||0===p)return[];var _=De(g*o/360),b=R(g*o/360),v=b*(t-l)/2+_*(a-d)/2,k=-_*(t-l)/2+b*(a-d)/2;if(0===v&&0===k)return[];c=_a(c),p=_a(p);var w=ya(v,2)/ya(c,2)+ya(k,2)/ya(p,2);1<w&&(c*=N(w),p*=N(w));var T=s(t,a,l,d,c,p,m,f,_,b,v,k),A=r(T,4),S=A[0],C=A[1],L=A[2],E=A[3],I=_a(E)/(o/4);1e-7>_a(1-I)&&(I=1);var z=va(M(I),1);E/=z;for(var P=0;P<z;P++)x.push(n(L,E)),L+=E;return x.map(function(e){var t=i(e[0],c,p,b,_,S,C),a=t.x,r=t.y,o=i(e[1],c,p,b,_,S,C),n=o.x,l=o.y,s=i(e[2],c,p,b,_,S,C),d=s.x,u=s.y;return{x1:a,y1:r,x2:n,y2:l,x:d,y:u}})},t.exports=a.default},{}],533:[function(e,t){"use strict";var a=e("parse-svg-path"),r=e("abs-svg-path"),o=e("normalize-svg-path"),n=e("is-svg-path"),s=e("assert");t.exports=function(e){if(Array.isArray(e)&&1===e.length&&"string"==typeof e[0]&&(e=e[0]),"string"==typeof e&&(s(n(e),"String is not an SVG path."),e=a(e)),s(Array.isArray(e),"Argument should be a string or an array of path segments."),e=r(e),e=o(e),!e.length)return[0,0,0,0];for(var t=[1/0,1/0,-Infinity,-Infinity],d=0,c=e.length,l;d<c;d++){l=e[d].slice(1);for(var p=0;p<l.length;p+=2)l[p+0]<t[0]&&(t[0]=l[p+0]),l[p+1]<t[1]&&(t[1]=l[p+1]),l[p+0]>t[2]&&(t[2]=l[p+0]),l[p+1]>t[3]&&(t[3]=l[p+1])}return t}},{"abs-svg-path":60,assert:68,"is-svg-path":424,"normalize-svg-path":534,"parse-svg-path":460}],534:[function(e,t){"use strict";function a(e,t,a,r){return["C",e,t,a,r,a,r]}function r(e,t,a,r,o,i){return["C",e/3+2/3*a,t/3+2/3*r,o/3+2/3*a,i/3+2/3*r,o,i]}t.exports=function(e){for(var t=[],n=0,l=0,s=0,d=0,p=null,u=null,g=0,h=0,m=0,f=e.length,_;m<f;m++){var b=e[m],v=b[0];switch(v){case"M":s=b[1],d=b[2];break;case"A":var k=o({px:g,py:h,cx:b[6],cy:b[7],rx:b[1],ry:b[2],xAxisRotation:b[3],largeArcFlag:b[4],sweepFlag:b[5]});if(!k.length)continue;for(var w=0,T;w<k.length;w++)T=k[w],b=["C",T.x1,T.y1,T.x2,T.y2,T.x,T.y],w<k.length-1&&t.push(b);break;case"S":var A=g,S=h;("C"==_||"S"==_)&&(A+=A-n,S+=S-l),b=["C",A,S,b[1],b[2],b[3],b[4]];break;case"T":"Q"==_||"T"==_?(p=2*g-p,u=2*h-u):(p=g,u=h),b=r(g,h,p,u,b[1],b[2]);break;case"Q":p=b[1],u=b[2],b=r(g,h,b[1],b[2],b[3],b[4]);break;case"L":b=a(g,h,b[1],b[2]);break;case"H":b=a(g,h,b[1],h);break;case"V":b=a(g,h,g,b[1]);break;case"Z":b=a(g,h,s,d);}_=v,g=b[b.length-2],h=b[b.length-1],4<b.length?(n=b[b.length-4],l=b[b.length-3]):(n=g,l=h),t.push(b)}return t};var o=e("svg-arc-to-cubic-bezier")},{"svg-arc-to-cubic-bezier":532}],535:[function(e,t){"use strict";function a(){if(null!=c)return c;var e=document.createElement("canvas").getContext("2d");if(e.canvas.width=e.canvas.height=1,!window.Path2D)return c=!1;var t=new Path2D("M0,0h1v1h-1v-1Z");e.fillStyle="black",e.fill(t);var a=e.getImageData(0,0,1,1);return c=a&&a.data&&255===a.data[3]}var r=e("svg-path-bounds"),o=e("parse-svg-path"),i=e("draw-svg-path"),n=e("is-svg-path"),l=e("bitmap-sdf"),s=document.createElement("canvas"),d=s.getContext("2d");t.exports=function(e,t){if(!n(e))throw Error("Argument should be valid svg path string");t||(t={});var c,p;t.shape?(c=t.shape[0],p=t.shape[1]):(c=s.width=t.w||t.width||200,p=s.height=t.h||t.height||200);var u=ea(c,p),g=t.stroke||0,m=t.viewbox||t.viewBox||r(e),y=[c/(m[2]-m[0]),p/(m[3]-m[1])],f=ea(y[0]||0,y[1]||0)/2;if(d.fillStyle="black",d.fillRect(0,0,c,p),d.fillStyle="white",g&&("number"!=typeof g&&(g=1),d.strokeStyle=0<g?"white":"black",d.lineWidth=_a(g)),d.translate(.5*c,.5*p),d.scale(f,f),a()){var x=new Path2D(e);d.fill(x),g&&d.stroke(x)}else{var _=o(e);i(d,_),d.fill(),g&&d.stroke()}d.setTransform(1,0,0,1,0,0);var b=l(d,{cutoff:null==t.cutoff?.5:t.cutoff,radius:null==t.radius?.5*u:t.radius});return b};var c},{"bitmap-sdf":93,"draw-svg-path":168,"is-svg-path":424,"parse-svg-path":460,"svg-path-bounds":533}],536:[function(e,t){(function(a){"use strict";function r(e){for(var t=e.cells,a=e.positions,r=new Float32Array(6*t.length),o=0,n=0,l=0,s;l<t.length;++l){s=t[l];for(var d=0,c;3>d;++d)c=a[s[d]],r[o++]=c[0],r[o++]=c[1]+1.4,n=va(c[0],n)}return{data:r,shape:n}}function o(e,t,a){var a=a||{},l=s[e];l||(l=s[e]={" ":{data:new Float32Array(0),shape:.2}});var d=l[t];if(!d)if(1>=t.length||!/\d/.test(t))d=l[t]=r(n(t,{triangles:!0,font:e,textAlign:a.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var c=t.split(/(\d|\s)/),p=Array(c.length),u=0,g=0,h=0;h<c.length;++h)p[h]=o(e,c[h]),u+=p[h].data.length,g+=p[h].shape,0<h&&(g+=.02);for(var m=new Float32Array(u),y=0,f=-.5*g,h=0,x;h<p.length;++h){x=p[h].data;for(var _=0;_<x.length;_+=2)m[y++]=x[_]+f,m[y++]=x[_+1];f+=p[h].shape+.02}d=l[t]={data:m,shape:g}}return d}t.exports=o;var n=e("vectorize-text"),l=window||a.global||{},s=l.__TEXT_CACHE||{};l.__TEXT_CACHE={}}).call(this,e("_process"))},{_process:482,"vectorize-text":550}],537:[function(e,t){(function(e){function a(e,t){if(e=e?e:"",t=t||{},e instanceof a)return e;if(!(this instanceof a))return new a(e,t);var o=r(e);this._originalInput=e,this._r=o.r,this._g=o.g,this._b=o.b,this._a=o.a,this._roundA=H(100*this._a)/100,this._format=t.format||o.format,this._gradientType=t.gradientType,1>this._r&&(this._r=H(this._r)),1>this._g&&(this._g=H(this._g)),1>this._b&&(this._b=H(this._b)),this._ok=o.ok,this._tc_id=U++}function r(e){var t={r:0,g:0,b:0},r=1,i=null,c=null,p=null,u=!1,g=!1;return"string"==typeof e&&(e=j(e)),"object"==typeof e&&(M(e.r)&&M(e.g)&&M(e.b)?(t=o(e.r,e.g,e.b),u=!0,g="%"===(e.r+"").substr(-1)?"prgb":"rgb"):M(e.h)&&M(e.s)&&M(e.v)?(i=D(e.s),c=D(e.v),t=d(e.h,i,c),u=!0,g="hsv"):M(e.h)&&M(e.s)&&M(e.l)&&(i=D(e.s),p=D(e.l),t=n(e.h,i,p),u=!0,g="hsl"),e.hasOwnProperty("a")&&(r=e.a)),r=S(r),{ok:u,format:e.format||g,r:G(255,q(t.r,0)),g:G(255,q(t.g,0)),b:G(255,q(t.b,0)),a:r}}function o(e,t,a){return{r:255*C(e,255),g:255*C(t,255),b:255*C(a,255)}}function i(e,t,a){e=C(e,255),t=C(t,255),a=C(a,255);var o=q(e,t,a),i=G(e,t,a),n=(o+i)/2,l,c;if(o==i)l=c=0;else{var p=o-i;c=.5<n?p/(2-o-i):p/(o+i);o===e?l=(t-a)/p+(t<a?6:0):o===t?l=(a-e)/p+2:o===a?l=(e-t)/p+4:void 0;l/=6}return{h:l,s:c,l:n}}function n(e,t,a){function o(e,a,r){return 0>r&&(r+=1),1<r&&(r-=1),r<1/6?e+6*(a-e)*r:r<1/2?a:r<2/3?e+6*((a-e)*(2/3-r)):e}var i,n,d;if(e=C(e,360),t=C(t,100),a=C(a,100),0===t)i=n=d=a;else{var c=.5>a?a*(1+t):a+t-a*t,u=2*a-c;i=o(u,c,e+1/3),n=o(u,c,e),d=o(u,c,e-1/3)}return{r:255*i,g:255*n,b:255*d}}function l(e,t,a){e=C(e,255),t=C(t,255),a=C(a,255);var o=q(e,t,a),i=G(e,t,a),n=o-i,l,d;return d=0===o?0:n/o,o==i?l=0:(o===e?l=(t-a)/n+(t<a?6:0):o===t?l=(a-e)/n+2:o===a?l=(e-t)/n+4:void 0,l/=6),{h:l,s:d,v:o}}function d(e,a,o){e=6*C(e,360),a=C(a,100),o=C(o,100);var n=ba(e),i=e-n,l=o*(1-a),d=o*(1-i*a),c=o*(1-(1-i)*a),t=n%6,p=[o,d,l,l,c,o][t],r=[c,o,o,d,l,l][t],u=[l,l,c,o,o,d][t];return{r:255*p,g:255*r,b:255*u}}function c(e,t,a,r){var o=[P(H(e).toString(16)),P(H(t).toString(16)),P(H(a).toString(16))];return r&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function p(e,t,r,o,a){var i=[P(H(e).toString(16)),P(H(t).toString(16)),P(H(r).toString(16)),P(O(o))];return a&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0):i.join("")}function u(e,t,r,o){var a=[P(O(o)),P(H(e).toString(16)),P(H(t).toString(16)),P(H(r).toString(16))];return a.join("")}function g(e,t){t=0===t?0:t||10;var r=a(e).toHsl();return r.s-=t/100,r.s=L(r.s),a(r)}function h(e,t){t=0===t?0:t||10;var r=a(e).toHsl();return r.s+=t/100,r.s=L(r.s),a(r)}function m(e){return a(e).desaturate(100)}function y(e,t){t=0===t?0:t||10;var r=a(e).toHsl();return r.l+=t/100,r.l=L(r.l),a(r)}function f(e,t){t=0===t?0:t||10;var r=a(e).toRgb();return r.r=q(0,G(255,r.r-H(255*-(t/100)))),r.g=q(0,G(255,r.g-H(255*-(t/100)))),r.b=q(0,G(255,r.b-H(255*-(t/100)))),a(r)}function x(e,t){t=0===t?0:t||10;var r=a(e).toHsl();return r.l-=t/100,r.l=L(r.l),a(r)}function _(e,t){var r=a(e).toHsl(),o=(r.h+t)%360;return r.h=0>o?360+o:o,a(r)}function b(e){var t=a(e).toHsl();return t.h=(t.h+180)%360,a(t)}function v(e){var t=a(e).toHsl(),r=t.h;return[a(e),a({h:(r+120)%360,s:t.s,l:t.l}),a({h:(r+240)%360,s:t.s,l:t.l})]}function k(e){var t=a(e).toHsl(),r=t.h;return[a(e),a({h:(r+90)%360,s:t.s,l:t.l}),a({h:(r+180)%360,s:t.s,l:t.l}),a({h:(r+270)%360,s:t.s,l:t.l})]}function w(e){var t=a(e).toHsl(),r=t.h;return[a(e),a({h:(r+72)%360,s:t.s,l:t.l}),a({h:(r+216)%360,s:t.s,l:t.l})]}function T(e,t,r){t=t||6,r=r||30;var o=a(e).toHsl(),i=360/r,n=[a(e)];for(o.h=(o.h-(i*t>>1)+720)%360;--t;)o.h=(o.h+i)%360,n.push(a(o));return n}function A(e,t){t=t||6;for(var r=a(e).toHsv(),o=r.h,i=r.s,n=r.v,l=[],s=1/t;t--;)l.push(a({h:o,s:i,v:n})),n=(n+s)%1;return l}function S(e){return e=parseFloat(e),(isNaN(e)||0>e||1<e)&&(e=1),e}function C(e,t){I(e)&&(e="100%");var a=z(e);return e=G(t,q(0,parseFloat(e))),a&&(e=parseInt(e*t,10)/100),1e-6>_a(e-t)?1:e%t/parseFloat(t)}function L(e){return G(1,q(0,e))}function E(e){return parseInt(e,16)}function I(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function z(e){return"string"==typeof e&&-1!=e.indexOf("%")}function P(e){return 1==e.length?"0"+e:""+e}function D(e){return 1>=e&&(e=100*e+"%"),e}function O(e){return V(255*parseFloat(e)).toString(16)}function R(e){return E(e)/255}function M(e){return!!Z.CSS_UNIT.exec(e)}function j(e){e=e.replace(B,"").replace(N,"").toLowerCase();var t=!1;if(W[e])e=W[e],t=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};var a;return(a=Z.rgb.exec(e))?{r:a[1],g:a[2],b:a[3]}:(a=Z.rgba.exec(e))?{r:a[1],g:a[2],b:a[3],a:a[4]}:(a=Z.hsl.exec(e))?{h:a[1],s:a[2],l:a[3]}:(a=Z.hsla.exec(e))?{h:a[1],s:a[2],l:a[3],a:a[4]}:(a=Z.hsv.exec(e))?{h:a[1],s:a[2],v:a[3]}:(a=Z.hsva.exec(e))?{h:a[1],s:a[2],v:a[3],a:a[4]}:(a=Z.hex8.exec(e))?{r:E(a[1]),g:E(a[2]),b:E(a[3]),a:R(a[4]),format:t?"name":"hex8"}:(a=Z.hex6.exec(e))?{r:E(a[1]),g:E(a[2]),b:E(a[3]),format:t?"name":"hex"}:(a=Z.hex4.exec(e))?{r:E(a[1]+""+a[1]),g:E(a[2]+""+a[2]),b:E(a[3]+""+a[3]),a:R(a[4]+""+a[4]),format:t?"name":"hex8"}:!!(a=Z.hex3.exec(e))&&{r:E(a[1]+""+a[1]),g:E(a[2]+""+a[2]),b:E(a[3]+""+a[3]),format:t?"name":"hex"}}function F(e){var t,a;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),a=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA"),"small"!==a&&"large"!==a&&(a="small"),{level:t,size:a}}var B=/^\s+/,N=/\s+$/,U=0,H=V,G=ea,q=va,Y=e.random;a.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e=this.toRgb(),t,a,r,o,i,n;return t=e.r/255,a=e.g/255,r=e.b/255,o=.03928>=t?t/12.92:ya((t+.055)/1.055,2.4),i=.03928>=a?a/12.92:ya((a+.055)/1.055,2.4),n=.03928>=r?r/12.92:ya((r+.055)/1.055,2.4),.2126*o+.7152*i+.0722*n},setAlpha:function(e){return this._a=S(e),this._roundA=H(100*this._a)/100,this},toHsv:function(){var e=l(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=l(this._r,this._g,this._b),t=H(360*e.h),a=H(100*e.s),r=H(100*e.v);return 1==this._a?"hsv("+t+", "+a+"%, "+r+"%)":"hsva("+t+", "+a+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=i(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=i(this._r,this._g,this._b),t=H(360*e.h),a=H(100*e.s),r=H(100*e.l);return 1==this._a?"hsl("+t+", "+a+"%, "+r+"%)":"hsla("+t+", "+a+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return c(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return p(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:H(this._r),g:H(this._g),b:H(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+H(this._r)+", "+H(this._g)+", "+H(this._b)+")":"rgba("+H(this._r)+", "+H(this._g)+", "+H(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:H(100*C(this._r,255))+"%",g:H(100*C(this._g,255))+"%",b:H(100*C(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+H(100*C(this._r,255))+"%, "+H(100*C(this._g,255))+"%, "+H(100*C(this._b,255))+"%)":"rgba("+H(100*C(this._r,255))+"%, "+H(100*C(this._g,255))+"%, "+H(100*C(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(1>this._a)&&(X[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+u(this._r,this._g,this._b,this._a),r=t,o=this._gradientType?"GradientType = 1, ":"";if(e){var i=a(e);r="#"+u(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var a=!1,r=1>this._a&&0<=this._a,o=!t&&r&&("hex"===e||"hex6"===e||"hex3"===e||"hex4"===e||"hex8"===e||"name"===e);return o?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(a=this.toRgbString()),"prgb"===e&&(a=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(a=this.toHexString()),"hex3"===e&&(a=this.toHexString(!0)),"hex4"===e&&(a=this.toHex8String(!0)),"hex8"===e&&(a=this.toHex8String()),"name"===e&&(a=this.toName()),"hsl"===e&&(a=this.toHslString()),"hsv"===e&&(a=this.toHsvString()),a||this.toHexString())},clone:function(){return a(this.toString())},_applyModification:function(e,t){var a=e.apply(null,[this].concat([].slice.call(t)));return this._r=a._r,this._g=a._g,this._b=a._b,this.setAlpha(a._a),this},lighten:function(){return this._applyModification(y,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(g,arguments)},saturate:function(){return this._applyModification(h,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(_,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(T,arguments)},complement:function(){return this._applyCombination(b,arguments)},monochromatic:function(){return this._applyCombination(A,arguments)},splitcomplement:function(){return this._applyCombination(w,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(k,arguments)}},a.fromRatio=function(e,t){if("object"==typeof e){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]="a"==o?e[o]:D(e[o]));e=r}return a(e,t)},a.equals=function(e,t){return!!(e&&t)&&a(e).toRgbString()==a(t).toRgbString()},a.random=function(){return a.fromRatio({r:Y(),g:Y(),b:Y()})},a.mix=function(e,t,r){r=0===r?0:r||50;var o=a(e).toRgb(),i=a(t).toRgb(),n=r/100,l={r:(i.r-o.r)*n+o.r,g:(i.g-o.g)*n+o.g,b:(i.b-o.b)*n+o.b,a:(i.a-o.a)*n+o.a};return a(l)},a.readability=function(e,t){var r=a(e),o=a(t);return(va(r.getLuminance(),o.getLuminance())+.05)/(ea(r.getLuminance(),o.getLuminance())+.05)},a.isReadable=function(e,t,r){var o=a.readability(e,t),i,n;switch(n=!1,i=F(r),i.level+i.size){case"AAsmall":case"AAAlarge":n=4.5<=o;break;case"AAlarge":n=3<=o;break;case"AAAsmall":n=7<=o;}return n},a.mostReadable=function(e,t,r){var o=null,n=0,l,s,d,c;r=r||{},s=r.includeFallbackColors,d=r.level,c=r.size;for(var p=0;p<t.length;p++)l=a.readability(e,t[p]),l>n&&(n=l,o=a(t[p]));return a.isReadable(e,o,{level:d,size:c})||!s?o:(r.includeFallbackColors=!1,a.mostReadable(e,["#fff","#000"],r))};var W=a.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},X=a.hexNames=function(e){var t={};for(var a in e)e.hasOwnProperty(a)&&(t[e[a]]=a);return t}(W),Z=function(){var e="(?:"+"[-\\+]?\\d*\\.\\d+%?"+")|(?:"+"[-\\+]?\\d+%?"+")",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",a="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof t&&t.exports?t.exports=a:"function"==typeof ka&&ka.amd?ka(function(){return a}):window.tinycolor=a})(Math)},{}],538:[function(e,t){"use strict";function a(e){if(e.length){if(e instanceof Float32Array)return e;var t=new Float32Array(e);return t.set(e),t}return r[0]=e,r[0]}t.exports=a,t.exports.float32=t.exports.float=a,t.exports.fract32=t.exports.fract=function(e){if(e.length){for(var t=a(e),r=0,o=t.length;r<o;r++)t[r]=e[r]-t[r];return t}return a(e-a(e))};var r=new Float32Array(1)},{}],539:[function(e,t){"use strict";function a(e,t){var a=i(getComputedStyle(e).getPropertyValue(t));return a[0]*o(a[1],e)}function r(e,t){var r=document.createElement("div");r.style["font-size"]="128"+e,t.appendChild(r);var o=a(r,"font-size")/128;return t.removeChild(r),o}function o(e,t){return t=t||document.body,e=(e||"px").trim().toLowerCase(),(t===window||t===document)&&(t=document.body),"%"===e?t.clientHeight/100:"ch"===e||"ex"===e?r(e,t):"em"===e?a(t,"font-size"):"rem"===e?a(document.body,"font-size"):"vw"===e?window.innerWidth/100:"vh"===e?window.innerHeight/100:"vmin"===e?ea(window.innerWidth,window.innerHeight)/100:"vmax"===e?va(window.innerWidth,window.innerHeight)/100:"in"===e?96:"cm"===e?96/2.54:"mm"===e?96/25.4:"pt"===e?96/72:"pc"===e?16:1}var i=e("parse-unit");t.exports=o},{"parse-unit":461}],540:[function(e,t,a){(function(e,r){"object"==typeof a&&"undefined"!=typeof t?r(a):"function"==typeof ka&&ka.amd?ka(["exports"],r):r(e.topojson=e.topojson||{})})(this,function(e){"use strict";function t(e,t){var r=t.id,o=t.bbox,i=null==t.properties?{}:t.properties,n=a(e,t);return null==r&&null==o?{type:"Feature",properties:i,geometry:n}:null==o?{type:"Feature",id:r,properties:i,geometry:n}:{type:"Feature",id:r,bbox:o,properties:i,geometry:n}}function a(e,t){function a(e,t){t.length&&t.pop();for(var r=g[0>e?~e:e],a=0,o=r.length;a<o;++a)t.push(u(r[a].slice(),a));0>e&&c(t,o)}function r(e){return u(e.slice())}function i(e){for(var t=[],r=0,o=e.length;r<o;++r)a(e[r],t);return 2>t.length&&t.push(t[0].slice()),t}function n(e){for(var t=i(e);4>t.length;)t.push(t[0].slice());return t}function l(e){return e.map(n)}function d(e){var t=e.type,a;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(d)};case"Point":a=r(e.coordinates);break;case"MultiPoint":a=e.coordinates.map(r);break;case"LineString":a=i(e.arcs);break;case"MultiLineString":a=e.arcs.map(i);break;case"Polygon":a=l(e.arcs);break;case"MultiPolygon":a=e.arcs.map(l);break;default:return null;}return{type:t,coordinates:a}}var u=s(e),g=e.arcs;return d(t)}function r(e,t,a){var r,l,s;if(1<arguments.length)r=o(e,t,a);else for(l=0,r=Array(s=e.arcs.length);l<s;++l)r[l]=l;return{type:"MultiLineString",arcs:p(e,r)}}function o(e,t,a){function r(e){var t=0>e?~e:e;(c[t]||(c[t]=[])).push({i:e,g:p})}function i(e){e.forEach(r)}function n(e){e.forEach(i)}function l(e){e.forEach(n)}function s(e){switch(p=e,e.type){case"GeometryCollection":e.geometries.forEach(s);break;case"LineString":i(e.arcs);break;case"MultiLineString":case"Polygon":n(e.arcs);break;case"MultiPolygon":l(e.arcs);}}var d=[],c=[],p;return s(t),c.forEach(null==a?function(e){d.push(e[0].i)}:function(e){a(e[0].g,e[e.length-1].g)&&d.push(e[0].i)}),d}function i(e){for(var t=-1,r=e.length,o=e[r-1],n=0,l;++t<r;)l=o,o=e[t],n+=l[0]*o[1]-l[1]*o[0];return _a(n)}function n(e,t){function r(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"Polygon":n(e.arcs);break;case"MultiPolygon":e.arcs.forEach(n);}}function n(e){e.forEach(function(t){t.forEach(function(t){(s[t=0>t?~t:t]||(s[t]=[])).push(e)})}),d.push(e)}function l(t){return i(a(e,{type:"Polygon",arcs:[t]}).coordinates[0])}var s={},d=[],c=[];return t.forEach(r),d.forEach(function(e){if(!e._){var t=[],a=[e];for(e._=1,c.push(t);e=a.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){s[0>e?~e:e].forEach(function(e){e._||(e._=1,a.push(e))})})})}}),d.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:c.map(function(a){var r=[],o;if(a.forEach(function(e){e.forEach(function(e){e.forEach(function(e){2>s[0>e?~e:e].length&&r.push(e)})})}),r=p(e,r),1<(o=r.length))for(var d=1,c=l(r[0]),u,g;d<o;++d)(u=l(r[d]))>c&&(g=r[0],r[0]=r[d],r[d]=g,c=u);return r})}}var l=function(e){return e},s=function(e){if(null==(i=e.transform))return l;var t=i.scale[0],a=i.scale[1],r=i.translate[0],o=i.translate[1],i,n,s;return function(e,l){return l||(n=s=0),e[0]=(n+=e[0])*t+r,e[1]=(s+=e[1])*a+o,e}},d=function(e){function a(e){t[0]=e[0],t[1]=e[1],l(t),t[0]<d&&(d=t[0]),t[0]>p&&(p=t[0]),t[1]<c&&(c=t[1]),t[1]>u&&(u=t[1])}function r(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"Point":a(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(a);}}var o=e.bbox;if(!o){var l=s(e),t=[,,],d=1/0,c=d,p=-d,u=-d,g,i;for(i in e.arcs.forEach(function(e){for(var a=-1,r=e.length;++a<r;)g=e[a],t[0]=g[0],t[1]=g[1],l(t,a),t[0]<d&&(d=t[0]),t[0]>p&&(p=t[0]),t[1]<c&&(c=t[1]),t[1]>u&&(u=t[1])}),e.objects)r(e.objects[i]);o=e.bbox=[d,c,p,u]}return o},c=function(e,a){for(var r=e.length,o=r-a,n;o<--r;)n=e[o],e[o++]=e[r],e[r]=n},p=function(e,a){function r(t){var a=e.arcs[0>t?~t:t],r=a[0],o;return e.transform?(o=[0,0],a.forEach(function(e){o[0]+=e[0],o[1]+=e[1]})):o=a[a.length-1],0>t?[o,r]:[r,o]}function o(e,t){for(var a in e){var r=e[a];delete t[r.start],delete r.start,delete r.end,r.forEach(function(e){n[0>e?~e:e]=1}),d.push(r)}}var n={},l={},s={},d=[],c=-1;return a.forEach(function(r,o){var i=e.arcs[0>r?~r:r],n;!(3>i.length)||i[1][0]||i[1][1]||(n=a[++c],a[c]=r,a[o]=n)}),a.forEach(function(t){var a=r(t),e=a[0],o=a[1],i,n;if(i=s[e]){if(delete s[i.end],i.push(t),i.end=o,n=l[o]){delete l[n.start];var d=n===i?i:i.concat(n);l[d.start=i.start]=s[d.end=n.end]=d}else l[i.start]=s[i.end]=i;}else if(!(i=l[o]))i=[t],l[i.start=e]=s[i.end=o]=i;else if(delete l[i.start],i.unshift(t),i.start=e,n=s[e]){delete s[n.end];var c=n===i?i:n.concat(i);l[c.start=n.start]=s[c.end=i.end]=c}else l[i.start]=s[i.end]=i}),o(s,l),o(l,s),a.forEach(function(e){n[0>e?~e:e]||d.push([e])}),d},u=function(e,t){for(var a=0,r=e.length;a<r;){var o=a+r>>>1;e[o]<t?a=o+1:r=o}return a};e.bbox=d,e.feature=function(e,a){return"GeometryCollection"===a.type?{type:"FeatureCollection",features:a.geometries.map(function(a){return t(e,a)})}:t(e,a)},e.mesh=function(e){return a(e,r.apply(this,arguments))},e.meshArcs=r,e.merge=function(e){return a(e,n.apply(this,arguments))},e.mergeArcs=n,e.neighbors=function(e){function t(e,t){e.forEach(function(e){0>e&&(e=~e);var r=l[e];r?r.push(t):l[e]=[t]})}function a(e,a){e.forEach(function(e){t(e,a)})}function r(e,t){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,t)}):e.type in d&&d[e.type](e.arcs,t)}var l={},s=e.map(function(){return[]}),d={LineString:t,MultiLineString:a,Polygon:a,MultiPolygon:function(e,t){e.forEach(function(e){a(e,t)})}};for(var c in e.forEach(r),l)for(var o=l[c],p=o.length,g=0;g<p;++g)for(var h=g+1;h<p;++h){var m=o[g],y=o[h],f;(f=s[m])[c=u(f,y)]!==y&&f.splice(c,0,y),(f=s[y])[c=u(f,m)]!==m&&f.splice(c,0,m)}return s},e.quantize=function(e,t){function a(e){e[0]=V((e[0]-l)/s),e[1]=V((e[1]-c)/u)}function r(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"Point":a(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(a);}}if(!(2<=(t=ba(t))))throw new Error("n must be \u22652");if(e.transform)throw new Error("already quantized");var o=d(e),l=o[0],s=(o[2]-l)/(t-1)||1,c=o[1],u=(o[3]-c)/(t-1)||1,i;for(i in e.arcs.forEach(function(e){for(var t=1,a=1,r=e.length,o=e[0],n=o[0]=V((o[0]-l)/s),d=o[1]=V((o[1]-c)/u),p,g,h;t<r;++t)o=e[t],g=V((o[0]-l)/s),h=V((o[1]-c)/u),(g!==n||h!==d)&&(p=e[a++],p[0]=g-n,n=g,p[1]=h-d,d=h);2>a&&(p=e[a++],p[0]=0,p[1]=0),e.length=a}),e.objects)r(e.objects[i]);return e.transform={scale:[s,u],translate:[l,c]},e},e.transform=s,e.untransform=function(e){if(null==(i=e.transform))return l;var t=i.scale[0],a=i.scale[1],r=i.translate[0],o=i.translate[1],i,n,s;return function(e,l){l||(n=s=0);var i=V((e[0]-r)/t),d=V((e[1]-o)/a);return e[0]=i-n,n=i,e[1]=d-s,s=d,e}},Object.defineProperty(e,"__esModule",{value:!0})})},{}],541:[function(e,t){"use strict";t.exports=function(e){if(0>e)return[];if(0===e)return[[0]];for(var t=0|V(o(e+1)),n=[],l=0;l<t;++l){for(var s=a.unrank(e,l),d=[0],c=0,p=0;p<s.length;++p)c+=1<<s[p],d.push(c);1>r(s)&&(d[0]=c,d[e]=0),n.push(d)}return n};var a=e("permutation-rank"),r=e("permutation-parity"),o=e("gamma")},{gamma:231,"permutation-parity":463,"permutation-rank":464}],542:[function(e,t){"use strict";function a(e,t,a){return N(ya(e,2)+ya(t,2)+ya(a,2))}function r(e){return ea(1,va(-1,e))}function i(e){var t=_a(e[0]),a=_a(e[1]),r=_a(e[2]),o=[0,0,0];t>va(a,r)?o[2]=1:a>va(t,r)?o[0]=1:o[1]=1;for(var n=0,l=0,s=0;3>s;++s)n+=e[s]*e[s],l+=o[s]*e[s];for(var s=0;3>s;++s)o[s]-=l/n*e[s];return g(o,o),o}function n(e,t,a,r,o,n,l,d){this.center=s(a),this.up=s(r),this.right=s(o),this.radius=s([n]),this.angle=s([l,d]),this.angle.bounds=[[-Infinity,-Pe/2],[1/0,Pe/2]],this.setDistanceLimits(e,t),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=Array(16);for(var c=0;16>c;++c)this.computedMatrix[c]=.5;this.recalcMatrix(0)}function l(e){e=e||{};var t=e.center||[0,0,0],r=e.up||[0,1,0],o=e.right||i(r),l=e.radius||1,s=e.theta||0,c=e.phi||0;if(t=[].slice.call(t,0,3),r=[].slice.call(r,0,3),g(r,r),o=[].slice.call(o,0,3),g(o,o),"eye"in e){var p=e.eye,m=[p[0]-t[0],p[1]-t[1],p[2]-t[2]];u(o,m,r),1e-6>a(o[0],o[1],o[2])?o=i(r):g(o,o),l=a(m[0],m[1],m[2]);var y=h(r,m)/l,f=h(o,m)/l;c=d(y),s=d(f)}return l=P(l),new n(e.zoomMin,e.zoomMax,t,r,o,l,s,c)}t.exports=l;var s=e("filtered-vector"),c=e("gl-mat4/invert"),p=e("gl-mat4/rotate"),u=e("gl-vec3/cross"),g=e("gl-vec3/normalize"),h=e("gl-vec3/dot"),y=n.prototype;y.setDistanceLimits=function(e,t){e=0<e?P(e):-Infinity,t=0<t?P(t):1/0,t=va(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},y.getDistanceLimits=function(e){var t=this.radius.bounds[0];return e?(e[0]=m(t[0][0]),e[1]=m(t[1][0]),e):[m(t[0][0]),m(t[1][0])]},y.recalcMatrix=function(e){this.center.curve(e),this.up.curve(e),this.right.curve(e),this.radius.curve(e),this.angle.curve(e);for(var t=this.computedUp,r=this.computedRight,o=0,n=0,l=0;3>l;++l)n+=t[l]*r[l],o+=t[l]*t[l];for(var s=N(o),d=0,l=0;3>l;++l)r[l]-=t[l]*n/o,d+=r[l]*r[l],t[l]/=s;for(var c=N(d),l=0;3>l;++l)r[l]/=c;var p=this.computedToward;u(p,t,r),g(p,p);for(var h=m(this.computedRadius[0]),y=this.computedAngle[0],f=this.computedAngle[1],_=R(y),b=De(y),v=R(f),k=De(f),w=this.computedCenter,T=this.computedEye,A=this.computedMatrix,l=0,S;3>l;++l)S=_*v*r[l]+b*v*p[l]+k*t[l],A[4*l+1]=-_*k*r[l]+-b*k*p[l]+v*t[l],A[4*l+2]=S,A[4*l+3]=0;var C=A[1],L=A[5],E=A[9],I=A[2],z=A[6],P=A[10],D=L*P-E*z,O=E*I-C*P,M=C*z-L*I,F=a(D,O,M);D/=F,O/=F,M/=F,A[0]=D,A[4]=O,A[8]=M;for(var l=0;3>l;++l)T[l]=w[l]+A[2+4*l]*h;for(var l=0,d;3>l;++l){d=0;for(var B=0;3>B;++B)d+=A[l+4*B]*T[B];A[12+l]=-d}A[15]=1},y.getMatrix=function(e,t){this.recalcMatrix(e);var a=this.computedMatrix;if(t){for(var r=0;16>r;++r)t[r]=a[r];return t}return a};var f=[0,0,0];y.rotate=function(e,t,a,r){if(this.angle.move(e,t,a),r){this.recalcMatrix(e);var o=this.computedMatrix;f[0]=o[2],f[1]=o[6],f[2]=o[10];for(var n=this.computedUp,l=this.computedRight,s=this.computedToward,d=0;3>d;++d)o[4*d]=n[d],o[4*d+1]=l[d],o[4*d+2]=s[d];p(o,o,r,f);for(var d=0;3>d;++d)n[d]=o[4*d],l[d]=o[4*d+1];this.up.set(e,n[0],n[1],n[2]),this.right.set(e,l[0],l[1],l[2])}},y.pan=function(e,t,r,o){t=t||0,r=r||0,o=o||0,this.recalcMatrix(e);var i=this.computedMatrix,n=m(this.computedRadius[0]),l=i[1],s=i[5],d=i[9],c=a(l,s,d);l/=c,s/=c,d/=c;var p=i[0],u=i[4],g=i[8],h=p*l+u*s+g*d;p-=l*h,u-=s*h,g-=d*h;var y=a(p,u,g);p/=y,u/=y,g/=y;var f=p*t+l*r,x=u*t+s*r,_=g*t+d*r;this.center.move(e,f,x,_);var b=m(this.computedRadius[0]);b=va(1e-4,b+o),this.radius.set(e,P(b))},y.translate=function(e,t,a,r){this.center.move(e,t||0,a||0,r||0)},y.setMatrix=function(e,t,i,n){var l=1;"number"==typeof i&&(l=0|i),(0>l||3<l)&&(l=1);var s=(l+2)%3;t||(this.recalcMatrix(e),t=this.computedMatrix);var d=t[l],p=t[l+4],u=t[l+8];if(!n){var g=a(d,p,u);d/=g,p/=g,u/=g}else{var h=_a(d),y=_a(p),f=_a(u),x=va(h,y,f);h===x?(d=0>d?-1:1,p=u=0):f===x?(u=0>u?-1:1,d=p=0):(p=0>p?-1:1,d=u=0)}var _=t[s],b=t[s+4],v=t[s+8],k=_*d+b*p+v*u;_-=d*k,b-=p*k,v-=u*k;var T=a(_,b,v);_/=T,b/=T,v/=T;var A=p*v-u*b,S=u*_-d*v,C=d*b-p*_,E=a(A,S,C);A/=E,S/=E,C/=E,this.center.jump(e,void 0,void 0,void 0),this.radius.idle(e),this.up.jump(e,d,p,u),this.right.jump(e,_,b,v);var I,z;if(2==l){var P=t[1],D=t[5],O=t[9],R=P*_+D*b+O*v,M=P*A+D*S+O*C;I=0>N?-Pe/2:Pe/2,z=L(M,R)}else{var j=t[2],F=t[6],B=t[10],N=j*d+F*p+B*u,V=j*_+F*b+B*v,U=j*A+F*S+B*C;I=o(r(N)),z=L(U,V)}this.angle.jump(e,z,I),this.recalcMatrix(e);var H=t[2],G=t[6],q=t[10],Y=this.computedMatrix;c(Y,t);var W=Y[15],w=Y[12]/W,X=Y[13]/W,Z=Y[14]/W,K=m(this.computedRadius[0]);this.center.jump(e,w-H*K,X-G*K,Z-q*K)},y.lastT=function(){return va(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},y.idle=function(e){this.center.idle(e),this.up.idle(e),this.right.idle(e),this.radius.idle(e),this.angle.idle(e)},y.flush=function(e){this.center.flush(e),this.up.flush(e),this.right.flush(e),this.radius.flush(e),this.angle.flush(e)},y.setDistance=function(e,t){0<t&&this.radius.set(e,P(t))},y.lookAt=function(e,t,i,n){this.recalcMatrix(e),t=t||this.computedEye,i=i||this.computedCenter,n=n||this.computedUp;var l=n[0],s=n[1],d=n[2],c=a(l,s,d);if(!(1e-6>c)){l/=c,s/=c,d/=c;var p=t[0]-i[0],u=t[1]-i[1],g=t[2]-i[2],h=a(p,u,g);if(!(1e-6>h)){p/=h,u/=h,g/=h;var m=this.computedRight,y=m[0],f=m[1],x=m[2],_=l*y+s*f+d*x;y-=_*l,f-=_*s,x-=_*d;var b=a(y,f,x);if(!(.01>b&&(y=s*g-d*u,f=d*p-l*g,x=l*u-s*p,b=a(y,f,x),1e-6>b))){y/=b,f/=b,x/=b,this.up.set(e,l,s,d),this.right.set(e,y,f,x),this.center.set(e,i[0],i[1],i[2]),this.radius.set(e,P(h));var v=s*x-d*f,k=d*y-l*x,w=l*f-s*y,T=a(v,k,w);v/=T,k/=T,w/=T;var A=l*p+s*u+d*g,S=y*p+f*u+x*g,C=v*p+k*u+w*g,E=o(r(A)),I=L(C,S),z=this.angle._state,D=z[z.length-1],O=z[z.length-2];D%=2*Pe;var R=_a(D+2*Pe-I),M=_a(D-I),j=_a(D-2*Pe-I);R<M&&(D+=2*Pe),j<M&&(D-=2*Pe),this.angle.jump(this.angle.lastT(),D,O),this.angle.set(e,I,E)}}}}},{"filtered-vector":226,"gl-mat4/invert":265,"gl-mat4/rotate":270,"gl-vec3/cross":334,"gl-vec3/dot":339,"gl-vec3/normalize":356}],543:[function(e,t){"use strict";t.exports=function(e,t,a){var r=e*t,o=134217729*e,i=o-(o-e),n=e-i,l=134217729*t,s=l-(l-t),d=t-s,c=n*d-(r-i*s-n*s-i*d);return a?(a[0]=c,a[1]=r,a):[c,r]};+(ya(2,27)+1)},{}],544:[function(e,t){"use strict";t.exports=function(e,t,a){var r=e+t,o=r-e,i=t-o,n=e-(r-o);return a?(a[0]=n+i,a[1]=r,a):[n+i,r]}},{}],545:[function(e,t,a){(function(t,r){"use strict";function o(e){if(e){var t=e.length||e.byteLength,a=x.log2(t);k[a].push(e)}}function i(e){var e=x.nextPow2(e),t=x.log2(e),a=k[t];return 0<a.length?a.pop():new ArrayBuffer(e)}function l(e){return new Uint8Array(i(e),0,e)}function s(e){return new Uint16Array(i(2*e),0,e)}function d(e){return new Uint32Array(i(4*e),0,e)}function c(e){return new Int8Array(i(e),0,e)}function p(e){return new Int16Array(i(2*e),0,e)}function u(e){return new Int32Array(i(4*e),0,e)}function g(e){return new Float32Array(i(4*e),0,e)}function h(e){return new Float64Array(i(8*e),0,e)}function m(e){return b?new Uint8ClampedArray(i(e),0,e):l(e)}function y(e){return new DataView(i(e),0,e)}function f(e){e=x.nextPow2(e);var t=x.log2(e),a=w[t];return 0<a.length?a.pop():new r(e)}var x=e("bit-twiddle"),_=e("dup");t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:_([32,0]),UINT16:_([32,0]),UINT32:_([32,0]),INT8:_([32,0]),INT16:_([32,0]),INT32:_([32,0]),FLOAT:_([32,0]),DOUBLE:_([32,0]),DATA:_([32,0]),UINT8C:_([32,0]),BUFFER:_([32,0])});var b="undefined"!=typeof Uint8ClampedArray,v=t.__TYPEDARRAY_POOL;v.UINT8C||(v.UINT8C=_([32,0])),v.BUFFER||(v.BUFFER=_([32,0]));var k=v.DATA,w=v.BUFFER;a.free=function(e){if(r.isBuffer(e))w[x.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,a=0|x.log2(t);k[a].push(e)}},a.freeUint8=a.freeUint16=a.freeUint32=a.freeInt8=a.freeInt16=a.freeInt32=a.freeFloat32=a.freeFloat=a.freeFloat64=a.freeDouble=a.freeUint8Clamped=a.freeDataView=function(e){o(e.buffer)},a.freeArrayBuffer=o,a.freeBuffer=function(e){w[x.log2(e.length)].push(e)},a.malloc=function(e,t){return void 0===t||"arraybuffer"===t?i(e):"uint8"===t?l(e):"uint16"===t?s(e):"uint32"===t?d(e):"int8"===t?c(e):"int16"===t?p(e):"int32"===t?u(e):"float"===t||"float32"===t?g(e):"double"===t||"float64"===t?h(e):"uint8_clamped"===t?m(e):"buffer"===t?f(e):"data"===t||"dataview"===t?y(e):null},a.mallocArrayBuffer=i,a.mallocUint8=l,a.mallocUint16=s,a.mallocUint32=d,a.mallocInt8=c,a.mallocInt16=p,a.mallocInt32=u,a.mallocFloat32=a.mallocFloat=g,a.mallocFloat64=a.mallocDouble=h,a.mallocUint8Clamped=m,a.mallocDataView=y,a.mallocBuffer=f,a.clearCache=function(){for(var e=0;32>e;++e)v.UINT8[e].length=0,v.UINT16[e].length=0,v.UINT32[e].length=0,v.INT8[e].length=0,v.INT16[e].length=0,v.INT32[e].length=0,v.FLOAT[e].length=0,v.DOUBLE[e].length=0,v.UINT8C[e].length=0,k[e].length=0,w[e].length=0}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,e("buffer").Buffer)},{"bit-twiddle":92,buffer:105,dup:170}],546:[function(e,t){"use strict";"use restrict";function a(e){this.roots=Array(e),this.ranks=Array(e);for(var t=0;t<e;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=a;var r=a.prototype;Object.defineProperty(r,"length",{get:function(){return this.roots.length}}),r.makeSet=function(){var e=this.roots.length;return this.roots.push(e),this.ranks.push(0),e},r.find=function(e){for(var t=e,a=this.roots;a[e]!==e;)e=a[e];for(;a[t]!==e;){var r=a[t];a[t]=e,t=r}return e},r.link=function(e,t){var a=this.find(e),r=this.find(t);if(a!==r){var o=this.ranks,i=this.roots,n=o[a],l=o[r];n<l?i[a]=r:l<n?i[r]=a:(i[r]=a,++o[a])}}},{}],547:[function(e,t){"use strict";function a(e,t){for(var r=1,o=e.length,n=e[0],l=e[0],s=1;s<o;++s)if(l=n,n=e[s],t(n,l)){if(s===r){r++;continue}e[r++]=n}return e.length=r,e}function r(e){for(var t=1,r=e.length,o=e[0],n=e[0],l=1;l<r;++l,n=o)if(n=o,o=e[l],o!==n){if(l===t){t++;continue}e[t++]=o}return e.length=t,e}t.exports=function(e,t,o){return 0===e.length?e:t?(o||e.sort(t),a(e,t)):(o||e.sort(),r(e))}},{}],548:[function(e,t){var a=/[\'\"]/;t.exports=function(e){return e?(a.test(e.charAt(0))&&(e=e.substr(1)),a.test(e.charAt(e.length-1))&&(e=e.substr(0,e.length-1)),e):""}},{}],549:[function(e,t){"use strict";t.exports=function(e,t,a){Array.isArray(a)||(a=[].slice.call(arguments,2));for(var r=0,o=a.length,n;r<o;r++)for(var l in n=a[r],n)if((void 0===t[l]||Array.isArray(t[l])||e[l]!==t[l])&&l in t){var s;if(!0===n[l])s=t[l];else if(!1===n[l])continue;else if("function"==typeof n[l]&&(s=n[l](t[l],e,t),void 0===s))continue;e[l]=s}return e}},{}],550:[function(e,t){"use strict";function a(e,t){return("object"!=typeof t||null===t)&&(t={}),r(e,t.canvas||o,t.context||i,t)}t.exports=a;var r=e("./lib/vtext"),o=null,i=null;"undefined"!=typeof document&&(o=document.createElement("canvas"),o.width=8192,o.height=1024,i=o.getContext("2d"))},{"./lib/vtext":551}],551:[function(e,t){function a(e,t,r,o){for(var n="<"+e+">",l="</"+e+">",s=n.length,d=l.length,p="+"===t[0]||"-"===t[0],u=0,g=-d;-1<u&&(u=r.indexOf(n,u),-1!==u)&&!(g=r.indexOf(l,u+s),-1===g);){if(g<=u)break;for(var h=u;h<g+d;++h)if(h<u+s||h>=g)o[h]=null,r=r.substr(0,h)+" "+r.substr(h+1);else if(null!==o[h]){var m=o[h].indexOf(t[0]);-1===m?o[h]+=t:p&&(o[h]=o[h].substr(0,m+1)+(1+parseInt(o[h][m+1]))+o[h].substr(m+2))}var y=u+s,f=r.substr(y,g-y),x=f.indexOf(n);u=-1===x?g+d:x}return o}function r(e,t,a){for(var r=t.textAlign||"start",o=t.textBaseline||"alphabetic",l=[1073741824,1073741824],s=[0,0],d=e.length,n=0,c;n<d;++n){c=e[n];for(var u=0;2>u;++u)l[u]=0|ea(l[u],c[u]),s[u]=0|va(s[u],c[u])}var g=0;switch(r){case"center":g=-.5*(l[0]+s[0]);break;case"right":case"end":g=-s[0];break;case"left":case"start":g=-l[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+r+"'");}var h=0;switch(o){case"hanging":case"top":h=-l[1];break;case"middle":h=-.5*(l[1]+s[1]);break;case"alphabetic":case"ideographic":h=-3*a;break;case"bottom":h=-s[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+o+"'");}var m=1/a;return"lineHeight"in t?m*=+t.lineHeight:"width"in t?m=t.width/(s[0]-l[0]):"height"in t&&(m=t.height/(s[1]-l[1])),e.map(function(e){return[m*(e[0]+g),m*(e[1]+h)]})}function o(e,t,r,o,n,l){function s(){if(""!==T){var e=t.measureText(T).width;t.fillText(T,_+C,b+L),C+=e}}function d(){return""+V(E)+"px "}function p(e,a){var r=""+t.font;if(!0===l.subscripts){var o=e.indexOf("-"),i=a.indexOf("-"),n=-1<o?parseInt(e[1+o]):0,s=-1<i?parseInt(a[1+i]):0;n!==s&&(r=r.replace(d(),"?px "),E*=ya(.75,s-n),r=r.replace("?px ",d())),L+=.25*x*(s-n)}if(!0===l.superscripts){var c=e.indexOf("+"),p=a.indexOf("+"),u=-1<c?parseInt(e[1+c]):0,g=-1<p?parseInt(a[1+p]):0;u!==g&&(r=r.replace(d(),"?px "),E*=ya(.75,g-u),r=r.replace("?px ",d())),L-=.25*x*(g-u)}if(!0===l.bolds){var h=-1<e.indexOf("b|"),m=-1<a.indexOf("b|");!h&&m&&(y?r=r.replace("italic ","italic bold "):r="bold "+r),h&&!m&&(r=r.replace("bold ",""))}if(!0===l.italics){var y=-1<e.indexOf("i|"),f=-1<a.indexOf("i|");!y&&f&&(r="italic "+r),y&&!f&&(r=r.replace("italic ",""))}t.font=r}r=r.replace(/\n/g,""),r=!0===l.breaklines?r.replace(/\<br\>/g,"\n"):r.replace(/\<br\>/g," ");var u="",g=[];for(S=0;S<r.length;++S)g[S]=u;!0===l.bolds&&(g=a("b","b|",r,g)),!0===l.italics&&(g=a("i","i|",r,g)),!0===l.superscripts&&(g=a("sup","+1",r,g)),!0===l.subscripts&&(g=a("sub","-1",r,g));var h=[],m="";for(S=0;S<r.length;++S)null!==g[S]&&(m+=r[S],h.push(g[S]));var y=m.split("\n"),f=y.length,x=V(n*o),_=o,b=2*o,v=0,k=f*x+b;e.height<k&&(e.height=k),t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff";var w=0,T="",A,S,C,L,E;for(A=0;A<f;++A){var I=y[A]+"\n";for(C=0,L=A*x,E=o,T="",S=0;S<I.length;++S){var z=S+w<h.length?h[S+w]:h[h.length-1];u===z?T+=I[S]:(s(),T=I[S],z!==void 0&&(p(u,z),u=z))}s(),w+=I.length;var P=0|V(C+2*_);v<P&&(v=P)}var D=v,O=b+x*f,R=c(t.getImageData(0,0,D,O).data,[O,D,4]);return R.pick(-1,-1,0).transpose(1,0)}function n(e,t){var a=d(e,128);return t?p(a.cells,a.positions,.25):{edges:a.cells,positions:a.positions}}function l(e,t,a,o){var l=n(e,o),s=r(l.positions,t,a),d=l.edges,c="ccw"===t.orientation;if(u(s,d),t.polygons||t.polygon||t.polyline){for(var p=h(d,s),m=Array(p.length),y=0;y<p.length;++y){for(var f=p[y],x=Array(f.length),_=0;_<f.length;++_){for(var b=f[_],v=Array(b.length),w=0;w<b.length;++w)v[w]=s[b[w]].slice();c&&v.reverse(),x[_]=v}m[y]=x}return m}return t.triangles||t.triangulate||t.triangle?{cells:g(s,d,{delaunay:!1,exterior:!1,interior:!0}),positions:s}:{edges:d,positions:s}}function s(e,t,a){try{return l(e,t,a,!0)}catch(t){}try{return l(e,t,a,!1)}catch(t){}return t.polygons||t.polyline||t.polygon?[]:t.triangles||t.triangulate||t.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}t.exports=function(e,t,a,r){var i=64,n=1.25,l={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};r&&(r.size&&0<r.size&&(i=r.size),r.lineSpacing&&0<r.lineSpacing&&(n=r.lineSpacing),r.styletags&&r.styletags.breaklines&&(l.breaklines=!!r.styletags.breaklines),r.styletags&&r.styletags.bolds&&(l.bolds=!!r.styletags.bolds),r.styletags&&r.styletags.italics&&(l.italics=!!r.styletags.italics),r.styletags&&r.styletags.subscripts&&(l.subscripts=!!r.styletags.subscripts),r.styletags&&r.styletags.superscripts&&(l.superscripts=!!r.styletags.superscripts)),a.font=[r.fontStyle,r.fontVariant,r.fontWeight,i+"px",r.font].filter(function(e){return e}).join(" "),a.textAlign="start",a.textBaseline="alphabetic",a.direction="ltr";var d=o(t,a,e,i,n,l);return s(d,r,i)},t.exports.processPixels=s;var d=e("surface-nets"),c=e("ndarray"),p=e("simplify-planar-graph"),u=e("clean-pslg"),g=e("cdt2d"),h=e("planar-graph-to-polyline")},{cdt2d:106,"clean-pslg":116,ndarray:450,"planar-graph-to-polyline":468,"simplify-planar-graph":524,"surface-nets":531}],552:[function(e,t){(function(){"use strict";function e(t){t.permitHostObjects___&&t.permitHostObjects___(e)}function a(e){return"weakmap:"!=e.substr(0,8)||"___"!==e.substr(e.length-3)}function r(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[m];if(t&&t.key===e)return t;if(g(e)){t={key:e};try{return u(e,m,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(e){}}}function o(e){return e.prototype=null,Object.freeze(e)}function i(){_||"undefined"==typeof console||(_=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=e);var n=!1;if("function"==typeof WeakMap){var l=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var s=new l,d=Object.freeze({});if(s.set(d,1),1!==s.get(d))n=!0;else return void(t.exports=WeakMap)}}var c=Object.prototype.hasOwnProperty,p=Object.getOwnPropertyNames,u=Object.defineProperty,g=Object.isExtensible,h="weakmap:",m=h+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var y=new ArrayBuffer(25),f=new Uint8Array(y);crypto.getRandomValues(f),m=h+"rand:"+Array.prototype.map.call(f,function(e){return(e%36).toString(36)}).join("")+"___"}if(u(Object,"getOwnPropertyNames",{value:function(e){return p(e).filter(a)}}),"getPropertyNames"in Object){var x=Object.getPropertyNames;u(Object,"getPropertyNames",{value:function(e){return x(e).filter(a)}})}(function(){var e=Object.freeze;u(Object,"freeze",{value:function(t){return r(t),e(t)}});var t=Object.seal;u(Object,"seal",{value:function(e){return r(e),t(e)}});var a=Object.preventExtensions;u(Object,"preventExtensions",{value:function(e){return r(e),a(e)}})})();var _=!1,b=0,v=function(){function e(e,t){var a=r(e),o;return a?s in a?a[s]:t:(o=n.indexOf(e),0<=o?l[o]:t)}function t(e){var t=r(e);return t?s in t:0<=n.indexOf(e)}function a(e){var t=r(e),a,o;return t?s in t&&delete t[s]:(a=n.indexOf(e),!(0>a))&&(o=n.length-1,n[a]=void 0,l[a]=l[o],n[a]=n[o],n.length=o,l.length=o,!0)}this instanceof v||i();var n=[],l=[],s=b++;return Object.create(v.prototype,{get___:{value:o(e)},has___:{value:o(t)},set___:{value:o(function(e,t){var a=r(e),o;return a?a[s]=t:(o=n.indexOf(e),0<=o?l[o]=t:(o=n.length,l[o]=t,n[o]=e)),this})},delete___:{value:o(a)}})};v.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},delete:{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof l?function(){function a(){function t(e,t){return d?s.has(e)?s.get(e):d.get___(e,t):s.get(e,t)}function a(e){return s.has(e)||!!d&&d.has___(e)}function r(e){var t=!!s["delete"](e);return d?d.delete___(e)||t:t}this instanceof v||i();var s=new l,d=void 0,c=!1,p;return p=n?function(e,t){return s.set(e,t),s.has(e)||(!d&&(d=new v),d.set(e,t)),this}:function(t,a){if(c)try{s.set(t,a)}catch(r){d||(d=new v),d.set___(t,a)}else s.set(t,a);return this},Object.create(v.prototype,{get___:{value:o(t)},has___:{value:o(a)},set___:{value:o(p)},delete___:{value:o(r)},permitHostObjects___:{value:o(function(t){if(t===e)c=!0;else throw new Error("bogus call to permitHostObjects___")})}})}n&&"undefined"!=typeof Proxy&&(Proxy=void 0),a.prototype=v.prototype,t.exports=a,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),t.exports=v)}})()},{}],553:[function(e,t){var a=e("./hidden-store.js");t.exports=function(){var e={};return function(t){if(("object"!=typeof t||null===t)&&"function"!=typeof t)throw new Error("Weakmap-shim: Key must be object");var r=t.valueOf(e);return r&&r.identity===e?r:a(t,e)}}},{"./hidden-store.js":554}],554:[function(e,t){t.exports=function(e,t){var a={identity:t},r=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e===t?a:r.apply(this,arguments)},writable:!0}),a}},{}],555:[function(e,t){var a=e("./create-store.js");t.exports=function(){var e=a();return{get:function(t,a){var r=e(t);return r.hasOwnProperty("value")?r.value:a},set:function(t,a){return e(t).value=a,this},has:function(t){return"value"in e(t)},delete:function(t){return delete e(t).value}}}},{"./create-store.js":553}],556:[function(e,t){var a=e("get-canvas-context");t.exports=function(e){return a("webgl",e)}},{"get-canvas-context":232}],557:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t,a,r){var o,n;if("object"==typeof e)o=e,n=t||{};else{if(!("number"==typeof e&&1888<=e&&2111>=e))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof t&&1<=t&&12>=t))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof a&&1<=a&&31>=a))throw new Error("Solar day outside range 1 - 31");o={year:e,month:t,day:a},n=r||{}}var l=u[o.year-u[0]],s=o.year<<9|o.month<<5|o.day;n.year=s>=l?o.year:o.year-1,l=u[n.year-u[0]];var c=4095&l>>9,g=15&l>>5,h=31&l,d=new Date(c,g-1,h),m=new Date(o.year,o.month-1,o.day),y;y=V((m-d)/86400000);var f=p[n.year-p[0]],x;for(x=0;13>x;x++){var _=f&1<<12-x?30:29;if(y<_)break;y-=_}var b=f>>13;return!b||x<b?(n.isIntercalary=!1,n.month=1+x):x===b?(n.isIntercalary=!0,n.month=x):(n.isIntercalary=!1,n.month=x),n.day=1+y,n}function r(e,t,a,r,o){var n,l;if("object"==typeof e)l=e,n=t||{};else{if(!("number"==typeof e&&1888<=e&&2111>=e))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof t&&1<=t&&12>=t))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof a&&1<=a&&30>=a))throw new Error("Lunar day outside range 1 - 30");var s;"object"==typeof r?(s=!1,n=r):(s=!!r,n=o||{}),l={year:e,month:t,day:a,isIntercalary:s}}var d=l.day-1;var c=p[l.year-p[0]],g=c>>13,h;h=g?l.month>g?l.month:l.isIntercalary?l.month:l.month-1:l.month-1;for(var m=0,y;m<h;m++)y=c&1<<12-m?30:29,d+=y;var f=u[l.year-u[0]],x=new Date(4095&f>>9,(15&f>>5)-1,(31&f)+d);return n.year=x.getFullYear(),n.month=1+x.getMonth(),n.day=x.getDate(),n}var o=e("../main"),i=e("object-assign"),n=o.instance();t.prototype=new o.baseCalendar,i(t.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(e,t){if("string"==typeof e){var a=e.match(s);return a?a[0]:""}var r=this._validateYear(e),o=e.month(),i=""+this.toChineseMonth(r,o);return t&&2>i.length&&(i="0"+i),this.isIntercalaryMonth(r,o)&&(i+="i"),i},monthNames:function(e){if("string"==typeof e){var t=e.match(d);return t?t[0]:""}var a=this._validateYear(e),r=e.month(),o=this.toChineseMonth(a,r),i=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][o-1];return this.isIntercalaryMonth(a,r)&&(i="\u95F0"+i),i},monthNamesShort:function(e){if("string"==typeof e){var t=e.match(c);return t?t[0]:""}var a=this._validateYear(e),r=e.month(),o=this.toChineseMonth(a,r),i=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][o-1];return this.isIntercalaryMonth(a,r)&&(i="\u95F0"+i),i},parseMonth:function(e,t){e=this._validateYear(e);var a=parseInt(t),r;if(!isNaN(a)){var o=t[t.length-1];r="i"===o||"I"===o}else"\u95F0"===t[0]&&(r=!0,t=t.substring(1)),"\u6708"===t[t.length-1]&&(t=t.substring(0,t.length-1)),a=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(t);var i=this.toMonthIndex(e,a,r);return i},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(e,t){if(e.year&&(e=e.year()),"number"!=typeof e||1888>e||2111<e)throw t.replace(/\{0\}/,this.local.name);return e},toMonthIndex:function(e,t,a){var r=this.intercalaryMonth(e);if(a&&t!==r||1>t||12<t)throw o.local.invalidMonth.replace(/\{0\}/,this.local.name);var i;return i=r?!a&&t<=r?t-1:t:t-1,i},toChineseMonth:function(e,t){e.year&&(e=e.year(),t=e.month());var a=this.intercalaryMonth(e),r=a?12:11;if(0>t||t>r)throw o.local.invalidMonth.replace(/\{0\}/,this.local.name);var i;return i=a?t<a?t+1:t:t+1,i},intercalaryMonth:function(e){e=this._validateYear(e);var t=p[e-p[0]];return t>>13},isIntercalaryMonth:function(e,t){e.year&&(e=e.year(),t=e.month());var a=this.intercalaryMonth(e);return!!a&&a===t},leapYear:function(e){return 0!==this.intercalaryMonth(e)},weekOfYear:function(e,t,a){var r=this._validateYear(e,o.local.invalidyear),i=u[r-u[0]],l;l=n.newDate(4095&i>>9,15&i>>5,31&i),l.add(4-(l.dayOfWeek()||7),"d");var s=this.toJD(e,t,a)-l.toJD();return 1+ba(s/7)},monthsInYear:function(e){return this.leapYear(e)?13:12},daysInMonth:function(e,t){e.year&&(t=e.month(),e=e.year()),e=this._validateYear(e);var a=p[e-p[0]],r=a>>13?12:11;if(t>r)throw o.local.invalidMonth.replace(/\{0\}/,this.local.name);var i=a&1<<12-t?30:29;return i},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,a){var i=this._validate(e,void 0,a,o.local.invalidDate);e=this._validateYear(i.year()),t=i.month(),a=i.day();var l=this.isIntercalaryMonth(e,t),s=this.toChineseMonth(e,t),d=r(e,s,a,l);return n.toJD(d.year,d.month,d.day)},fromJD:function(e){var t=n.fromJD(e),r=a(t.year(),t.month(),t.day()),o=this.toMonthIndex(r.year,r.month,r.isIntercalary);return this.newDate(r.year,o,r.day)},fromString:function(e){var t=e.match(l),a=this._validateYear(+t[1]),r=+t[2],o=!!t[3],i=this.toMonthIndex(a,r,o),n=+t[4];return this.newDate(a,i,n)},add:function(e,a,r){var o=e.year(),i=e.month(),n=this.isIntercalaryMonth(o,i),l=this.toChineseMonth(o,i),s=Object.getPrototypeOf(t.prototype).add.call(this,e,a,r);if("y"===r){var d=s.year(),c=s.month(),p=this.isIntercalaryMonth(d,l),u=n&&p?this.toMonthIndex(d,l,!0):this.toMonthIndex(d,l,!1);u!==c&&s.month(u)}return s}});var l=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,s=/^\d?\d[iI]?/m,d=/^闰?十?[一二三四五六七八九]?月/m,c=/^闰?十?[一二三四五六七八九]?/m;o.calendars.chinese=t;var p=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],u=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":571,"object-assign":454}],558:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar,r(t.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=t.year()+(0>t.year()?1:0);return 3==e%4||-1==e%4},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear),13},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),ba((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(13===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var o=this._validate(e,t,r,a.local.invalidDate);return e=o.year(),0>e&&e++,o.day()+30*(o.month()-1)+365*(e-1)+ba(e/4)+this.jdEpoch-1},fromJD:function(e){var t=ba(e)+.5-this.jdEpoch,a=ba((t-ba((t+366)/1461))/365)+1;0>=a&&a--,t=ba(e)+.5-this.newDate(a,1,1).toJD();var r=ba(t/30)+1,o=t-30*(r-1)+1;return this.newDate(a,r,o)}}),a.calendars.coptic=t},{"../main":571,"object-assign":454}],559:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar,r(t.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),400},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),ba((r.dayOfYear()-1)/8)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,t,r){var o=this._validate(e,t,r,a.local.invalidDate);return(o.day()+1)%8},weekDay:function(e,t,a){var r=this.dayOfWeek(e,t,a);return 2<=r&&6>=r},extraInfo:function(e,t,r){var i=this._validate(e,t,r,a.local.invalidDate);return{century:o[ba((i.year()-1)/100)+1]||""}},toJD:function(e,t,r){var o=this._validate(e,t,r,a.local.invalidDate);return e=o.year()+(0>o.year()?1:0),t=o.month(),r=o.day(),r+(1<t?16:0)+(2<t?32*(t-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=ba(e+.5)-ba(this.jdEpoch)-1;var t=ba(e/400)+1;e-=400*(t-1),e+=15<e?16:0;var a=ba(e/32)+1,r=e-32*(a-1)+1;return this.newDate(0>=t?t-1:t,a,r)}});var o={20:"Fruitbat",21:"Anchovy"};a.calendars.discworld=t},{"../main":571,"object-assign":454}],560:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar,r(t.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=t.year()+(0>t.year()?1:0);return 3==e%4||-1==e%4},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear),13},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),ba((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(13===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var o=this._validate(e,t,r,a.local.invalidDate);return e=o.year(),0>e&&e++,o.day()+30*(o.month()-1)+365*(e-1)+ba(e/4)+this.jdEpoch-1},fromJD:function(e){var t=ba(e)+.5-this.jdEpoch,a=ba((t-ba((t+366)/1461))/365)+1;0>=a&&a--,t=ba(e)+.5-this.newDate(a,1,1).toJD();var r=ba(t/30)+1,o=t-30*(r-1)+1;return this.newDate(a,r,o)}}),a.calendars.ethiopian=t},{"../main":571,"object-assign":454}],561:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t){return e-t*ba(e/t)}var r=e("../main"),o=e("object-assign");t.prototype=new r.baseCalendar,o(t.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,r.local.invalidYear);return this._leapYear(t.year())},_leapYear:function(e){return e=0>e?e+1:e,7>a(7*e+1,19)},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,r.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),ba((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,r.local.invalidYear);return e=t.year(),this.toJD(-1===e?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,r.local.invalidMonth),12===t&&this.leapYear(e)?30:8===t&&5===a(this.daysInYear(e),10)?30:9===t&&3===a(this.daysInYear(e),10)?29:this.daysPerMonth[t-1]},weekDay:function(e,t,a){return 6!==this.dayOfWeek(e,t,a)},extraInfo:function(e,t,a){var o=this._validate(e,t,a,r.local.invalidDate);return{yearType:(this.leapYear(o)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(o)%10-3]}},toJD:function(e,t,a){var o=this._validate(e,t,a,r.local.invalidDate);e=o.year(),t=o.month(),a=o.day();var i=0>=e?e+1:e,n=this.jdEpoch+this._delay1(i)+this._delay2(i)+a+1;if(7>t){for(var l=7;l<=this.monthsInYear(e);l++)n+=this.daysInMonth(e,l);for(var l=1;l<t;l++)n+=this.daysInMonth(e,l)}else for(var l=7;l<t;l++)n+=this.daysInMonth(e,l);return n},_delay1:function(e){var t=ba((235*e-234)/19),r=29*t+ba((12084+13753*t)/25920);return 3>a(3*(r+1),7)&&r++,r},_delay2:function(e){var t=this._delay1(e-1),a=this._delay1(e),r=this._delay1(e+1);return 356==r-a?2:382==a-t?1:0},fromJD:function(e){e=ba(e)+.5;for(var t=ba(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(-1===t?1:t+1,7,1);)t++;for(var a=e<this.toJD(t,1,1)?7:1;e>this.toJD(t,a,this.daysInMonth(t,a));)a++;var r=e-this.toJD(t,a,1)+1;return this.newDate(t,a,r)}}),r.calendars.hebrew=t},{"../main":571,"object-assign":454}],562:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar,r(t.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 11>(11*t.year()+14)%30},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),ba((r.dayOfYear()-1)/7)+1},daysInYear:function(e){return this.leapYear(e)?355:354},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(12===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,r){var o=this._validate(e,t,r,a.local.invalidDate);return e=o.year(),t=o.month(),r=o.day(),e=0>=e?e+1:e,r+M(29.5*(t-1))+354*(e-1)+ba((3+11*e)/30)+this.jdEpoch-1},fromJD:function(e){e=ba(e)+.5;var t=ba((30*(e-this.jdEpoch)+10646)/10631);t=0>=t?t-1:t;var a=ea(12,M((e-29-this.toJD(t,1,1))/29.5)+1),r=e-this.toJD(t,a,1)+1;return this.newDate(t,a,r)}}),a.calendars.islamic=t},{"../main":571,"object-assign":454}],563:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar,r(t.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=0>t.year()?t.year()+1:t.year();return 0==e%4},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(4-(r.dayOfWeek()||7),"d"),ba((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(2===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var o=this._validate(e,t,r,a.local.invalidDate);return e=o.year(),t=o.month(),r=o.day(),0>e&&e++,2>=t&&(e--,t+=12),ba(365.25*(e+4716))+ba(30.6001*(t+1))+r-1524.5},fromJD:function(t){var r=ba(t+.5),a=r+1524,o=ba((a-122.1)/365.25),i=ba(365.25*o),n=ba((a-i)/30.6001),e=n-ba(14>n?1:13),l=o-ba(2<e?4716:4715),s=a-i-ba(30.6001*n);return 0>=l&&l--,this.newDate(l,e,s)}}),a.calendars.julian=t},{"../main":571,"object-assign":454}],564:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function r(e,t){return e-t*ba(e/t)}function o(e,t){return r(e-1,t)+1}var i=e("../main"),n=e("object-assign");t.prototype=new i.baseCalendar,n(t.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,i.local.invalidYear),!1},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,i.local.invalidYear);e=t.year();var a=ba(e/400);e%=400,e+=0>e?400:0;var r=ba(e/20);return a+"."+r+"."+e%20},forYear:function(e){if(e=e.split("."),3>e.length)throw"Invalid Mayan year";for(var t=0,a=0,r;a<e.length;a++){if(r=parseInt(e[a],10),19<_a(r)||0<a&&0>r)throw"Invalid Mayan year";t=20*t+r}return t},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,i.local.invalidYear),18},weekOfYear:function(e,t,a){return this._validate(e,t,a,i.local.invalidDate),0},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,i.local.invalidYear),360},daysInMonth:function(e,t){return this._validate(e,t,this.minDay,i.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(e,t,a){var r=this._validate(e,t,a,i.local.invalidDate);return r.day()},weekDay:function(e,t,a){return this._validate(e,t,a,i.local.invalidDate),!0},extraInfo:function(e,t,a){var r=this._validate(e,t,a,i.local.invalidDate),o=r.toJD(),n=this._toHaab(o),l=this._toTzolkin(o);return{haabMonthName:this.local.haabMonths[n[0]-1],haabMonth:n[0],haabDay:n[1],tzolkinDayName:this.local.tzolkinMonths[l[0]-1],tzolkinDay:l[0],tzolkinTrecena:l[1]}},_toHaab:function(e){e-=this.jdEpoch;var t=r(e+8+340,365);return[ba(t/20)+1,r(t,20)]},_toTzolkin:function(e){return e-=this.jdEpoch,[o(e+20,20),o(e+4,13)]},toJD:function(e,t,a){var r=this._validate(e,t,a,i.local.invalidDate);return r.day()+20*r.month()+360*r.year()+this.jdEpoch},fromJD:function(e){e=ba(e)+.5-this.jdEpoch;var t=ba(e/360);e%=360,e+=0>e?360:0;var a=ba(e/20),r=e%20;return this.newDate(t,a,r)}}),i.calendars.mayan=t},{"../main":571,"object-assign":454}],565:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar;var o=a.instance("gregorian");r(t.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear);return o.leapYear(t.year()+(1>t.year()?1:0)+1469)},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(1-(r.dayOfWeek()||7),"d"),ba((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(12===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var i=this._validate(e,t,r,a.local.invalidMonth),e=i.year();0>e&&e++;for(var n=i.day(),l=1;l<i.month();l++)n+=this.daysPerMonth[l-1];return n+o.toJD(e+1468,3,13)},fromJD:function(e){e=ba(e+.5);for(var t=ba((e-(this.jdEpoch-1))/366);e>=this.toJD(t+1,1,1);)t++;for(var a=e-ba(this.toJD(t,1,1)+.5)+1,r=1;a>this.daysInMonth(t,r);)a-=this.daysInMonth(t,r),r++;return this.newDate(t,r,a)}}),a.calendars.nanakshahi=t},{"../main":571,"object-assign":454}],566:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar,r(t.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(e){return this.daysInYear(e)!==this.daysPerYear},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),ba((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);if(e=t.year(),"undefined"==typeof this.NEPALI_CALENDAR_DATA[e])return this.daysPerYear;for(var r=0,o=this.minMonth;12>=o;o++)r+=this.NEPALI_CALENDAR_DATA[e][o];return r},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,a.local.invalidMonth),"undefined"==typeof this.NEPALI_CALENDAR_DATA[e]?this.daysPerMonth[t-1]:this.NEPALI_CALENDAR_DATA[e][t]},weekDay:function(e,t,a){return 6!==this.dayOfWeek(e,t,a)},toJD:function(e,t,r){var o=this._validate(e,t,r,a.local.invalidDate);e=o.year(),t=o.month(),r=o.day();var i=a.instance(),n=0,l=t,s=e;this._createMissingCalendarData(e);var d=e-(9<l||9===l&&r>=this.NEPALI_CALENDAR_DATA[s][0]?56:57);for(9!==t&&(n=r,l--);9!==l;)0>=l&&(l=12,s--),n+=this.NEPALI_CALENDAR_DATA[s][l],l--;return 9===t?(n+=r-this.NEPALI_CALENDAR_DATA[s][0],0>n&&(n+=i.daysInYear(d))):n+=this.NEPALI_CALENDAR_DATA[s][9]-this.NEPALI_CALENDAR_DATA[s][0],i.newDate(d,1,1).add(n,"d").toJD()},fromJD:function(e){var t=a.instance(),r=t.fromJD(e),o=r.year(),i=r.dayOfYear(),n=o+56;this._createMissingCalendarData(n);for(var l=9,s=this.NEPALI_CALENDAR_DATA[n][0],d=this.NEPALI_CALENDAR_DATA[n][l]-s+1;i>d;)l++,12<l&&(l=1,n++),d+=this.NEPALI_CALENDAR_DATA[n][l];var c=this.NEPALI_CALENDAR_DATA[n][l]-(d-i);return this.newDate(n,l,c)},_createMissingCalendarData:function(e){var t=this.daysPerMonth.slice(0);t.unshift(17);for(var a=e-1;a<e+2;a++)"undefined"==typeof this.NEPALI_CALENDAR_DATA[a]&&(this.NEPALI_CALENDAR_DATA[a]=t)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),a.calendars.nepali=t},{"../main":571,"object-assign":454}],567:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t){return e-t*ba(e/t)}var r=e("../main"),o=e("object-assign");t.prototype=new r.baseCalendar,o(t.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,r.local.invalidYear);return 682>682*((t.year()-(0<t.year()?474:473))%2820+474+38)%2816},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-((r.dayOfWeek()+1)%7),"d"),ba((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,r.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(12===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,o){var i=this._validate(e,t,o,r.local.invalidDate);e=i.year(),t=i.month(),o=i.day();var n=e-(0<=e?474:473),l=474+a(n,2820);return o+(7>=t?31*(t-1):30*(t-1)+6)+ba((682*l-110)/2816)+365*(l-1)+1029983*ba(n/2820)+this.jdEpoch-1},fromJD:function(e){e=ba(e)+.5;var t=e-this.toJD(475,1,1),r=ba(t/1029983),o=a(t,1029983),i=2820;if(1029982!==o){var n=ba(o/366),l=a(o,366);i=ba((2134*n+2816*l+2815)/1028522)+n+1}var s=i+2820*r+474;s=0>=s?s-1:s;var d=e-this.toJD(s,1,1)+1,c=186>=d?M(d/31):M((d-6)/30),p=e-this.toJD(s,c,1)+1;return this.newDate(s,c,p)}}),r.calendars.persian=t,r.calendars.jalali=t},{"../main":571,"object-assign":454}],568:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign"),o=a.instance();t.prototype=new a.baseCalendar,r(t.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return o.leapYear(e)},weekOfYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return o.weekOfYear(e,t.month(),t.day())},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(2===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var i=this._validate(e,t,r,a.local.invalidDate),e=this._t2gYear(i.year());return o.toJD(e,i.month(),i.day())},fromJD:function(e){var t=o.fromJD(e),a=this._g2tYear(t.year());return this.newDate(a,t.month(),t.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&-1>=e?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(1<=e&&e<=this.yearsOffset?1:0)}}),a.calendars.taiwan=t},{"../main":571,"object-assign":454}],569:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign"),o=a.instance();t.prototype=new a.baseCalendar,r(t.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return o.leapYear(e)},weekOfYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return o.weekOfYear(e,t.month(),t.day())},daysInMonth:function(e,t){var r=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(2===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var i=this._validate(e,t,r,a.local.invalidDate),e=this._t2gYear(i.year());return o.toJD(e,i.month(),i.day())},fromJD:function(e){var t=o.fromJD(e),a=this._g2tYear(t.year());return this.newDate(a,t.month(),t.day())},_t2gYear:function(e){return e-this.yearsOffset-(1<=e&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&-1>=e?1:0)}}),a.calendars.thai=t},{"../main":571,"object-assign":454}],570:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),r=e("object-assign");t.prototype=new a.baseCalendar,r(t.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 355===this.daysInYear(t.year())},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(-r.dayOfWeek(),"d"),ba((r.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var t=0,a=1;12>=a;a++)t+=this.daysInMonth(e,a);return t},daysInMonth:function(e,t){for(var r=this._validate(e,t,this.minDay,a.local.invalidMonth),n=r.toJD()-24e5+.5,l=0,s=0;s<o.length;s++){if(o[s]>n)return o[l]-o[l-1];l++}return 30},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,r){var i=this._validate(e,t,r,a.local.invalidDate),n=12*(i.year()-1)+i.month()-15292,l=i.day()+o[n-1]-1;return l+24e5-.5},fromJD:function(e){for(var t=e-24e5+.5,a=0,r=0;r<o.length&&!(o[r]>t);r++)a++;var n=a+15292,l=ba((n-1)/12),s=t-o[a-1]+1;return this.newDate(l+1,n-12*l,s)},isValid:function(e){var t=a.baseCalendar.prototype.isValid.apply(this,arguments);return t&&(e=null==e.year?e:e.year,t=1276<=e&&1500>=e),t},_validate:function(e,t,r,o){var i=a.baseCalendar.prototype._validate.apply(this,arguments);if(1276>i.year||1500<i.year)throw o.replace(/\{0\}/,this.local.name);return i}}),a.calendars.ummalqura=t;var o=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":571,"object-assign":454}],571:[function(e,t){function a(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function r(e,t,a,r){if(this._calendar=e,this._year=t,this._month=a,this._day=r,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(s.local.invalidDate||s.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function o(e,t){return e=""+e,"000000".substring(0,t-e.length)+e}function i(){this.shortYearCutoff="+10"}function n(e){this.local=this.regionalOptions[e]||this.regionalOptions[""]}var l=e("object-assign");l(a.prototype,{instance:function(e,t){e=(e||"gregorian").toLowerCase(),t=t||"";var a=this._localCals[e+"-"+t];if(!a&&this.calendars[e]&&(a=new this.calendars[e](t),this._localCals[e+"-"+t]=a),!a)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,e);return a},newDate:function(e,t,a,r,o){return r=(null!=e&&e.year?e.calendar():"string"==typeof r?this.instance(r,o):r)||this.instance(),r.newDate(e,t,a)},substituteDigits:function(e){return function(t){return(t+"").replace(/[0-9]/g,function(t){return e[t]})}},substituteChineseDigits:function(e,t){return function(a){for(var r="",o=0,i;0<a;)i=a%10,r=(0==i?"":e[i]+t[o])+r,o++,a=ba(a/10);return 0===r.indexOf(e[1]+t[1])&&(r=r.substr(1)),r||e[0]}}}),l(r.prototype,{newDate:function(e,t,a){return this._calendar.newDate(null==e?this:e,t,a)},year:function(e){return 0===arguments.length?this._year:this.set(e,"y")},month:function(e){return 0===arguments.length?this._month:this.set(e,"m")},day:function(e){return 0===arguments.length?this._day:this.set(e,"d")},date:function(e,t,a){if(!this._calendar.isValid(e,t,a))throw(s.local.invalidDate||s.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=e,this._month=t,this._day=a,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(e,t){return this._calendar.add(this,e,t)},set:function(e,t){return this._calendar.set(this,e,t)},compareTo:function(e){if(this._calendar.name!==e._calendar.name)throw(s.local.differentCalendars||s.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,e._calendar.local.name);var t=this._year===e._year?this._month===e._month?this._day-e._day:this.monthOfYear()-e.monthOfYear():this._year-e._year;return 0==t?0:0>t?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(e){return this._calendar.fromJD(e)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(e){return this._calendar.fromJSDate(e)},toString:function(){return(0>this.year()?"-":"")+o(_a(this.year()),4)+"-"+o(this.month(),2)+"-"+o(this.day(),2)}}),l(i.prototype,{_validateLevel:0,newDate:function(e,t,a){return null==e?this.today():(e.year&&(this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate),a=e.day(),t=e.month(),e=e.year()),new r(this,e,t,a))},today:function(){return this.fromJSDate(new Date)},epoch:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear);return 0>t.year()?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear);return(0>t.year()?"-":"")+o(_a(t.year()),4)},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear),12},monthOfYear:function(e,t){var a=this._validate(e,t,this.minDay,s.local.invalidMonth||s.regionalOptions[""].invalidMonth);return(a.month()+this.monthsInYear(a)-this.firstMonth)%this.monthsInYear(a)+this.minMonth},fromMonthOfYear:function(e,t){var a=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(e)+this.minMonth;return this._validate(e,a,this.minDay,s.local.invalidMonth||s.regionalOptions[""].invalidMonth),a},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(e,t,a){var r=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate);return r.toJD()-this.newDate(r.year(),this.fromMonthOfYear(r.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(e,t,a){var r=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate);return(ba(this.toJD(r))+2)%this.daysInWeek()},extraInfo:function(e,t,a){return this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate),{}},add:function(e,t,a){return this._validate(e,this.minMonth,this.minDay,s.local.invalidDate||s.regionalOptions[""].invalidDate),this._correctAdd(e,this._add(e,t,a),t,a)},_add:function(e,t,a){if(this._validateLevel++,"d"===a||"w"===a){var r=e.toJD()+t*("w"===a?this.daysInWeek():1),o=e.calendar().fromJD(r);return this._validateLevel--,[o.year(),o.month(),o.day()]}try{var i=e.year()+("y"===a?t:0),n=e.monthOfYear()+("m"===a?t:0),o=e.day(),l=function(e){for(;n<e.minMonth;)i--,n+=e.monthsInYear(i);for(var t=e.monthsInYear(i);n>t-1+e.minMonth;)i++,n-=t,t=e.monthsInYear(i)};"y"===a?(e.month()!==this.fromMonthOfYear(i,n)&&(n=this.newDate(i,e.month(),this.minDay).monthOfYear()),n=ea(n,this.monthsInYear(i)),o=ea(o,this.daysInMonth(i,this.fromMonthOfYear(i,n)))):"m"==a&&(l(this),o=ea(o,this.daysInMonth(i,this.fromMonthOfYear(i,n))));var s=[i,this.fromMonthOfYear(i,n),o];return this._validateLevel--,s}catch(t){throw this._validateLevel--,t}},_correctAdd:function(e,t,a,r){if(!this.hasYearZero&&("y"===r||"m"===r)&&(0===t[0]||0<e.year()!=0<t[0])){var o={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[r],i=0>a?-1:1;t=this._add(e,a*o[0]+i*o[1],o[2])}return e.date(t[0],t[1],t[2])},set:function(e,t,a){this._validate(e,this.minMonth,this.minDay,s.local.invalidDate||s.regionalOptions[""].invalidDate);var r="y"===a?t:e.year(),o="m"===a?t:e.month(),i="d"===a?t:e.day();return("y"===a||"m"===a)&&(i=ea(i,this.daysInMonth(r,o))),e.date(r,o,i)},isValid:function(e,t,a){this._validateLevel++;var r=this.hasYearZero||0!==e;if(r){var o=this.newDate(e,t,this.minDay);r=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(o)&&a>=this.minDay&&a-this.minDay<this.daysInMonth(o)}return this._validateLevel--,r},toJSDate:function(e,t,a){var r=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate);return s.instance().fromJD(this.toJD(r)).toJSDate()},fromJSDate:function(e){return this.fromJD(s.instance().fromJSDate(e).toJD())},_validate:function(e,t,a,r){if(e.year){if(0===this._validateLevel&&this.name!==e.calendar().name)throw(s.local.differentCalendars||s.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,e.calendar().local.name);return e}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(e,t,a))throw r.replace(/\{0\}/,this.local.name);var o=this.newDate(e,t,a);return this._validateLevel--,o}catch(t){throw this._validateLevel--,t}}}),n.prototype=new i,l(n.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear),e=t.year()+(0>t.year()?1:0);return 0==e%4&&(0!=e%100||0==e%400)},weekOfYear:function(e,t,a){var r=this.newDate(e,t,a);return r.add(4-(r.dayOfWeek()||7),"d"),ba((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,s.local.invalidMonth||s.regionalOptions[""].invalidMonth);return this.daysPerMonth[a.month()-1]+(2===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,r){var o=this._validate(e,t,r,s.local.invalidDate||s.regionalOptions[""].invalidDate);e=o.year(),t=o.month(),r=o.day(),0>e&&e++,3>t&&(t+=12,e--);var i=ba(e/100),a=2-i+ba(i/4);return ba(365.25*(e+4716))+ba(30.6001*(t+1))+r+a-1524.5},fromJD:function(t){var r=ba(t+.5),o=ba((r-1867216.25)/36524.25);o=r+1+o-ba(o/4);var i=o+1524,n=ba((i-122.1)/365.25),l=ba(365.25*n),s=ba((i-l)/30.6001),e=i-l-ba(30.6001*s),d=s-(13.5<s?13:1),c=n-(2.5<d?4716:4715);return 0>=c&&c--,this.newDate(c,d,e)},toJSDate:function(e,t,a){var r=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate),o=new Date(r.year(),r.month()-1,r.day());return o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0),o.setHours(12<o.getHours()?o.getHours()+2:0),o},fromJSDate:function(e){return this.newDate(e.getFullYear(),e.getMonth()+1,e.getDate())}});var s=t.exports=new a;s.cdate=r,s.baseCalendar=i,s.calendars.gregorian=n},{"object-assign":454}],572:[function(e){var t=e("object-assign"),a=e("./main");t(a.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),a.local=a.regionalOptions[""],t(a.cdate.prototype,{formatDate:function(e,t){return"string"!=typeof e&&(t=e,e=""),this._calendar.formatDate(e||"",this,t)}}),t(a.baseCalendar.prototype,{UNIX_EPOCH:a.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:a.instance().jdEpoch,TICKS_PER_DAY:864000000000,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(e,t,r){if("string"!=typeof e&&(r=t,t=e,e=""),!t)return"";if(t.calendar()!==this)throw a.local.invalidFormat||a.regionalOptions[""].invalidFormat;e=e||this.local.dateFormat,r=r||{};for(var o=r.dayNamesShort||this.local.dayNamesShort,i=r.dayNames||this.local.dayNames,n=r.monthNumbers||this.local.monthNumbers,l=r.monthNamesShort||this.local.monthNamesShort,s=r.monthNames||this.local.monthNames,d=r.calculateWeek||this.local.calculateWeek,c=function(t,a){for(var r=1;b+r<e.length&&e.charAt(b+r)===t;)r++;return b+=r-1,1<ba(r/(a||1))},p=function(e,t,a,r){var o=""+t;if(c(e,r))for(;o.length<a;)o="0"+o;return o},u=function(e,t,a,r){return c(e)?r[t]:a[t]},g=this,h=function(e){return"function"==typeof n?n.call(g,e,c("m")):f(p("m",e.month(),2))},m=function(e,t){return t?"function"==typeof s?s.call(g,e):s[e.month()-g.minMonth]:"function"==typeof l?l.call(g,e):l[e.month()-g.minMonth]},y=this.local.digits,f=function(e){return r.localNumbers&&y?y(e):e},x="",_=!1,b=0;b<e.length;b++)if(_)"'"!==e.charAt(b)||c("'")?x+=e.charAt(b):_=!1;else switch(e.charAt(b)){case"d":x+=f(p("d",t.day(),2));break;case"D":x+=u("D",t.dayOfWeek(),o,i);break;case"o":x+=p("o",t.dayOfYear(),3);break;case"w":x+=p("w",t.weekOfYear(),2);break;case"m":x+=h(t);break;case"M":x+=m(t,c("M"));break;case"y":x+=c("y",2)?t.year():(10>t.year()%100?"0":"")+t.year()%100;break;case"Y":c("Y",2),x+=t.formatYear();break;case"J":x+=t.toJD();break;case"@":x+=(t.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":x+=(t.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":c("'")?x+="'":_=!0;break;default:x+=e.charAt(b);}return x},parseDate:function(e,t,r){if(null==t)throw a.local.invalidArguments||a.regionalOptions[""].invalidArguments;if(t="object"==typeof t?t.toString():t+"",""===t)return null;e=e||this.local.dateFormat,r=r||{};var o=r.shortYearCutoff||this.shortYearCutoff;o="string"==typeof o?this.today().year()%100+parseInt(o,10):o;for(var i=r.dayNamesShort||this.local.dayNamesShort,n=r.dayNames||this.local.dayNames,l=r.parseMonth||this.local.parseMonth,s=r.monthNumbers||this.local.monthNumbers,d=r.monthNamesShort||this.local.monthNamesShort,c=r.monthNames||this.local.monthNames,p=-1,u=-1,g=-1,h=-1,m=-1,y=!1,f=!1,x=function(t,a){for(var r=1;S+r<e.length&&e.charAt(S+r)===t;)r++;return S+=r-1,1<ba(r/(a||1))},_=function(e,r){var o=x(e,r),i=[2,3,o?4:2,o?4:2,10,11,20]["oyYJ@!".indexOf(e)+1],n=new RegExp("^-?\\d{1,"+i+"}"),l=t.substring(A).match(n);if(!l)throw(a.local.missingNumberAt||a.regionalOptions[""].missingNumberAt).replace(/\{0\}/,A);return A+=l[0].length,parseInt(l[0],10)},b=this,v=function(){if("function"==typeof s){x("m");var e=s.call(b,t.substring(A));return A+=e.length,e}return _("m")},k=function(e,r,o,n){for(var l=x(e,n)?o:r,s=0;s<l.length;s++)if(t.substr(A,l[s].length).toLowerCase()===l[s].toLowerCase())return A+=l[s].length,s+b.minMonth;throw(a.local.unknownNameAt||a.regionalOptions[""].unknownNameAt).replace(/\{0\}/,A)},w=function(){if("function"==typeof c){var e=x("M")?c.call(b,t.substring(A)):d.call(b,t.substring(A));return A+=e.length,e}return k("M",d,c)},T=function(){if(t.charAt(A)!==e.charAt(S))throw(a.local.unexpectedLiteralAt||a.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,A);A++},A=0,S=0;S<e.length;S++)if(f)"'"!==e.charAt(S)||x("'")?T():f=!1;else switch(e.charAt(S)){case"d":h=_("d");break;case"D":k("D",i,n);break;case"o":m=_("o");break;case"w":_("w");break;case"m":g=v();break;case"M":g=w();break;case"y":var C=S;y=!x("y",2),S=C,u=_("y",2);break;case"Y":u=_("Y",2);break;case"J":p=_("J")+.5,"."===t.charAt(A)&&(A++,_("J"));break;case"@":p=_("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":p=_("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":A=t.length;break;case"'":x("'")?T():f=!0;break;default:T();}if(A<t.length)throw a.local.unexpectedText||a.regionalOptions[""].unexpectedText;if(-1===u?u=this.today().year():100>u&&y&&(u+=-1===o?1900:this.today().year()-this.today().year()%100-(u<=o?0:100)),"string"==typeof g&&(g=l.call(this,u,g)),-1<m){g=1,h=m;for(var L=this.daysInMonth(u,g);h>L;L=this.daysInMonth(u,g))g++,h-=L}return-1<p?this.fromJD(p):this.newDate(u,g,h)},determineDate:function(e,t,a,r,o){a&&"object"!=typeof a&&(o=r,r=a,a=null),"string"!=typeof r&&(o=r,r="");var i=this,n=function(e){try{return i.parseDate(r,e,o)}catch(t){}e=e.toLowerCase();for(var t=(e.match(/^c/)&&a?a.newDate():null)||i.today(),n=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,l=n.exec(e);l;)t.add(parseInt(l[1],10),l[2]||"d"),l=n.exec(e);return t};return t=t?t.newDate():null,e=null==e?t:"string"==typeof e?n(e):"number"==typeof e?isNaN(e)||e===1/0||e===-Infinity?t:i.today().add(e,"d"):i.newDate(e),e}})},{"./main":571,"object-assign":454}],573:[function(e,t){t.exports=e("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":146}],574:[function(e,t){"use strict";t.exports=function(e,t){var r=[];return t=+t||0,a(e.hi(e.shape[0]-1),r,t),r};var a=e("./lib/zc-core")},{"./lib/zc-core":573}],575:[function(e,t){"use strict";t.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],576:[function(e,t){"use strict";var a=e("./arrow_paths"),r=e("../../plots/font_attributes"),o=e("../../plots/cartesian/constants"),i=e("../../plot_api/plot_template").templatedArray;t.exports=i("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:r({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",o.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",o.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",o.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",o.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:r({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773,"../../plots/font_attributes":793,"./arrow_paths":575}],577:[function(e,t){"use strict";function a(e){var t=e._fullLayout;o.filterVisible(t.annotations).forEach(function(t){var a=i.getFromId(e,t.xref),o=i.getFromId(e,t.yref);t._extremes={},a&&r(t,a),o&&r(t,o)})}function r(e,t){var a=t._id,r=a.charAt(0),o=e[r],n=e["a"+r],l=e[r+"ref"],s=e["a"+r+"ref"],d=e["_"+r+"padplus"],c=e["_"+r+"padminus"],p={x:1,y:-1}[r]*e[r+"shift"],u=3*e.arrowsize*e.arrowwidth||0,g=u+p,h=u-p,m=3*e.startarrowsize*e.arrowwidth||0,y=m+p,f=m-p,x;if(s===l){var _=i.findExtremes(t,[t.r2c(o)],{ppadplus:g,ppadminus:h}),b=i.findExtremes(t,[t.r2c(n)],{ppadplus:va(d,y),ppadminus:va(c,f)});x={min:[_.min[0],b.min[0]],max:[_.max[0],b.max[0]]}}else y=n?y+n:y,f=n?f-n:f,x=i.findExtremes(t,[t.r2c(o)],{ppadplus:va(d,g,y),ppadminus:va(c,h,f)});e._extremes[a]=x}var o=e("../../lib"),i=e("../../plots/cartesian/axes"),n=e("./draw").draw;t.exports=function(e){var t=e._fullLayout,r=o.filterVisible(t.annotations);if(r.length&&e._fullData.length)return o.syncOrAsync([n,a],e)}},{"../../lib":719,"../../plots/cartesian/axes":767,"./draw":582}],578:[function(e,t){"use strict";function a(e,t){var a=e._fullLayout.annotations,o=[],n=[],l=[],s=(t||[]).length,d,c,p,u,g,h,m,y;for(d=0;d<a.length;d++)if(p=a[d],u=p.clicktoshow,u){for(c=0;c<s;c++)if(g=t[c],h=g.xaxis,m=g.yaxis,h._id===p.xref&&m._id===p.yref&&h.d2r(g.x)===r(p._xclick,h)&&m.d2r(g.y)===r(p._yclick,m)){y=p.visible?"onout"===u?n:l:o,y.push(d);break}c===s&&p.visible&&"onout"===u&&n.push(d)}return{on:o,off:n,explicitOff:l}}function r(e,t){return"log"===t.type?t.l2r(e):t.d2r(e)}var o=e("../../lib"),n=e("../../registry"),l=e("../../plot_api/plot_template").arrayEditor;t.exports={hasClickToShow:function(e,t){var r=a(e,t);return 0<r.on.length||0<r.explicitOff.length},onClick:function(e,t){var r=a(e,t),s=r.on,d=r.off.concat(r.explicitOff),c={},p=e._fullLayout.annotations,u,g;if(s.length||d.length){for(u=0;u<s.length;u++)g=l(e.layout,"annotations",p[s[u]]),g.modifyItem("visible",!0),o.extendFlat(c,g.getUpdateObj());for(u=0;u<d.length;u++)g=l(e.layout,"annotations",p[d[u]]),g.modifyItem("visible",!1),o.extendFlat(c,g.getUpdateObj());return n.call("update",e,{},c)}}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../registry":847}],579:[function(e,t){"use strict";var a=e("../../lib"),r=e("../color");t.exports=function(e,t,o,i){i("opacity");var n=i("bgcolor"),l=i("bordercolor"),s=r.opacity(l);i("borderpad");var d=i("borderwidth"),c=i("showarrow");i("text",c?" ":o._dfltTitle.annotation),i("textangle"),a.coerceFont(i,"font",o.font),i("width"),i("align");var p=i("height");if(p&&i("valign"),c){var u=i("arrowside"),g,h;-1!==u.indexOf("end")&&(g=i("arrowhead"),h=i("arrowsize")),-1!==u.indexOf("start")&&(i("startarrowhead",g),i("startarrowsize",h)),i("arrowcolor",s?t.bordercolor:r.defaultLine),i("arrowwidth",2*(s&&d||1)),i("standoff"),i("startstandoff")}var m=i("hovertext"),y=o.hoverlabel||{};if(m){var f=i("hoverlabel.bgcolor",y.bgcolor||(r.opacity(n)?r.rgb(n):r.defaultLine)),x=i("hoverlabel.bordercolor",y.bordercolor||r.contrast(f));a.coerceFont(i,"hoverlabel.font",{family:y.font.family,size:y.font.size,color:y.font.color||x})}i("captureevents",!!m)}},{"../../lib":719,"../color":593}],580:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../lib/to_log_range");t.exports=function(e,t,o,n){function l(e){var o=g[e],i=null;i=s?r(o,t.range):ya(10,o),a(i)||(i=null),n(h+e,i)}t=t||{};var s="log"===o&&"linear"===t.type,d="linear"===o&&"log"===t.type;if(s||d)for(var c=e._fullLayout.annotations,p=t._id.charAt(0),u=0,g,h;u<c.length;u++)g=c[u],h="annotations["+u+"].",g[p+"ref"]===t._id&&l(p),g["a"+p+"ref"]===t._id&&l("a"+p)}},{"../../lib/to_log_range":745,"fast-isnumeric":225}],581:[function(e,t){"use strict";function a(e,t,a){function s(a,o){return r.coerce(e,t,l,a,o)}var d=s("visible"),c=s("clicktoshow");if(d||c){n(e,t,a,s);for(var p=t.showarrow,u=["x","y"],g=[-10,-30],h={_fullLayout:a},m=0;2>m;m++){var y=u[m],f=o.coerceRef(e,t,h,y,"","paper");if("paper"!==f){var x=o.getFromId(h,f);x._annIndices.push(t._index)}if(o.coercePosition(t,h,s,f,y,.5),p){var _="a"+y,b=o.coerceRef(e,t,h,_,"pixel");"pixel"!==b&&b!==f&&(b=t[_]="pixel");var v="pixel"===b?g[m]:.4;o.coercePosition(t,h,s,b,_,v)}s(y+"anchor"),s(y+"shift")}if(r.noneOrAll(e,t,["x","y"]),p&&r.noneOrAll(e,t,["ax","ay"]),c){var k=s("xclick"),w=s("yclick");t._xclick=void 0===k?t.x:o.cleanPosition(k,h,t.xref),t._yclick=void 0===w?t.y:o.cleanPosition(w,h,t.yref)}}}var r=e("../../lib"),o=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./common_defaults"),l=e("./attributes");t.exports=function(e,t){i(e,t,{name:"annotations",handleItemDefaults:a})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"./attributes":576,"./common_defaults":579}],582:[function(e,t){"use strict";function a(e,t){var a=e._fullLayout,o=a.annotations[t]||{},i=s.getFromId(e,o.xref),n=s.getFromId(e,o.yref);i&&i.setScale(),n&&n.setScale(),r(e,o,t,!1,i,n)}function r(e,t,a,r,n,s){function f(e){var o={index:a,annotation:t._input,fullAnnotation:t,event:e};return r&&(o.subplotId=r),o}function x(a){return a.call(c.font,Y).attr({"text-anchor":{left:"start",right:"end"}[t.align]||"middle"}),u.convertToTspans(a,e,_),a}function _(){function a(e,t){return"auto"===t&&(e<1/3?t="left":e>2/3?t="right":t="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var o=X.selectAll("a");if(1===o.size()&&o.text()===X.text()){var p=j.insert("a",":first-child").attr({"xlink:xlink:href":o.attr("xlink:href"),"xlink:xlink:show":o.attr("xlink:show")}).style({cursor:"pointer"});p.node().appendChild(H.node())}for(var m=j.select(".annotation-text-math-group"),x=!m.empty(),_=c.bBox((x?m:X).node()),w=_.width,T=_.height,A=t.width||w,M=t.height||T,B=V(A+2*U),Y=V(M+2*U),W=!1,Z=["x","y"],K=0;K<Z.length;K++){var J=Z[K],Q=t[J+"ref"]||J,$=t["a"+J+"ref"],ee={x:n,y:s}[J],te=(z+("x"===J?0:-90))*Pe/180,ae=B*R(te),re=Y*De(te),oe=_a(ae)+_a(re),ie=t[J+"anchor"],ne=t[J+"shift"]*("x"===J?1:-1),le=I[J],se,de,ce,pe,ue;if(ee){var ge=ee.r2fraction(t[J]);(0>ge||1<ge)&&($===Q?(ge=ee.r2fraction(t["a"+J]),(0>ge||1<ge)&&(W=!0)):W=!0),se=ee._offset+ee.r2p(t[J]),pe=.5}else"x"===J?(ce=t[J],se=v.l+v.w*ce):(ce=1-t[J],se=v.t+v.h*ce),pe=t.showarrow?.5:ce;if(t.showarrow){le.head=se;var he=t["a"+J];ue=ae*a(.5,t.xanchor)-re*a(.5,t.yanchor),$===Q?(le.tail=ee._offset+ee.r2p(he),de=ue):(le.tail=se+he,de=ue+he),le.text=le.tail+ue;var me=b["x"===J?"width":"height"];if("paper"===Q&&(le.head=l.constrain(le.head,1,me-1)),"pixel"===$){var ye=-va(le.tail-3,le.text),fe=ea(le.tail+3,le.text)-me;0<ye?(le.tail+=ye,le.text+=ye):0<fe&&(le.tail-=fe,le.text-=fe)}le.tail+=ne,le.head+=ne}else ue=oe*a(pe,ie),de=ue,le.text=se+ue;le.text+=ne,ue+=ne,de+=ne,t["_"+J+"padplus"]=oe/2+de,t["_"+J+"padminus"]=oe/2-de,t["_"+J+"size"]=oe,t["_"+J+"shift"]=ue}if(!e._dragging&&W)return void j.remove();var xe=0,_e=0;if("left"!==t.align&&(xe=(A-w)*("center"===t.align?.5:1)),"top"!==t.valign&&(_e=(M-T)*("middle"===t.valign?.5:1)),x)m.select("svg").attr({x:U+xe-1,y:U+_e}).call(c.setClipUrl,G?E:null,e);else{var be=U+_e-_.top,ve=U+xe-_.left;X.call(u.positionText,ve,be).call(c.setClipUrl,G?E:null,e)}q.select("rect").call(c.setRect,U,U,A,M),H.call(c.setRect,F/2,F/2,B-F,Y-F),j.call(c.setTranslate,V(I.x.text-B/2),V(I.y.text-Y/2)),D.attr({transform:"rotate("+z+","+I.x.text+","+I.y.text+")"});var ke=function(a,o){P.selectAll(".annotation-arrow-g").remove();var u=I.x.head,g=I.y.head,m=I.x.tail+a,f=I.y.tail+o,x=I.x.text+a,_=I.y.text+o,b=l.rotationXYMatrix(z,x,_),w=l.apply2DTransform(b),T=l.apply2DTransform2(b),A=+H.attr("width"),E=+H.attr("height"),O=x-.5*A,R=O+A,M=_-.5*E,F=M+E,B=[[O,M,O,F],[O,F,R,F],[R,F,R,M],[R,M,O,M]].map(T);if(!B.reduce(function(e,t){return e^!!l.segmentsIntersect(u,g,u+1e6,g+1e6,t[0],t[1],t[2],t[3])},!1)){B.forEach(function(e){var t=l.segmentsIntersect(m,f,u,g,e[0],e[1],e[2],e[3]);t&&(m=t.x,f=t.y)});var V=t.arrowwidth,U=t.arrowcolor,G=t.arrowside,q=P.append("g").style({opacity:d.opacity(U)}).classed("annotation-arrow-g",!0),Y=q.append("path").attr("d","M"+m+","+f+"L"+u+","+g).style("stroke-width",V+"px").call(d.stroke,d.rgb(U));if(y(Y,G,t),k.annotationPosition&&Y.node().parentNode&&!r){var W=u,X=g;if(t.standoff){var Z=N(ya(u-m,2)+ya(g-f,2));W+=t.standoff*(m-u)/Z,X+=t.standoff*(f-g)/Z}var K=q.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(m-W)+","+(f-X),transform:"translate("+W+","+X+")"}).style("stroke-width",V+6+"px").call(d.stroke,"rgba(0,0,0,0)").call(d.fill,"rgba(0,0,0,0)"),J,Q;h.init({element:K.node(),gd:e,prepFn:function(){var e=c.getTranslate(j);J=e.x,Q=e.y,n&&n.autorange&&S(n._name+".autorange",!0),s&&s.autorange&&S(s._name+".autorange",!0)},moveFn:function(e,a){var r=w(J,Q),o=r[0]+e,i=r[1]+a;j.call(c.setTranslate,o,i),C("x",n?n.p2r(n.r2p(t.x)+e):t.x+e/v.w),C("y",s?s.p2r(s.r2p(t.y)+a):t.y-a/v.h),t.axref===t.xref&&C("ax",n.p2r(n.r2p(t.ax)+e)),t.ayref===t.yref&&C("ay",s.p2r(s.r2p(t.ay)+a)),q.attr("transform","translate("+e+","+a+")"),D.attr({transform:"rotate("+z+","+o+","+i+")"})},doneFn:function(){i.call("_guiRelayout",e,L());var t=document.querySelector(".js-notes-box-panel");t&&t.redraw(t.selectedObj)}})}}};if(t.showarrow&&ke(0,0),O){var we;h.init({element:j.node(),gd:e,prepFn:function(){we=D.attr("transform")},moveFn:function(e,a){var o="pointer";if(t.showarrow)t.axref===t.xref?C("ax",n.p2r(n.r2p(t.ax)+e)):C("ax",t.ax+e),t.ayref===t.yref?C("ay",s.p2r(s.r2p(t.ay)+a)):C("ay",t.ay+a),ke(e,a);else if(!r){var i,l;if(n)i=n.p2r(n.r2p(t.x)+e);else{var d=t._xsize/v.w,c=t.x+(t._xshift-t.xshift)/v.w-d/2;i=h.align(c+e/v.w,d,0,1,t.xanchor)}if(s)l=s.p2r(s.r2p(t.y)+a);else{var p=t._ysize/v.h,u=t.y-(t._yshift+t.yshift)/v.h-p/2;l=h.align(u-a/v.h,p,0,1,t.yanchor)}C("x",i),C("y",l),n&&s||(o=h.getCursor(n?.5:i,s?.5:l,t.xanchor,t.yanchor))}else return;D.attr({transform:"translate("+e+","+a+")"+we}),g(j,o)},clickFn:function(a,r){t.captureevents&&e.emit("plotly_clickannotation",f(r))},doneFn:function(){g(j),i.call("_guiRelayout",e,L());var t=document.querySelector(".js-notes-box-panel");t&&t.redraw(t.selectedObj)}})}}var b=e._fullLayout,v=e._fullLayout._size,k=e._context.edits,w,T;r?(w="annotation-"+r,T=r+".annotations"):(w="annotation",T="annotations");var A=m(e.layout,T,t),S=A.modifyBase,C=A.modifyItem,L=A.getUpdateObj;b._infolayer.selectAll("."+w+"[data-index=\""+a+"\"]").remove();var E="clip"+b._uid+"_ann"+a;if(!t._input||!1===t.visible)return void o.selectAll("#"+E).remove();var I={x:{},y:{}},z=+t.textangle||0,P=b._infolayer.append("g").classed(w,!0).attr("data-index",a+"").style("opacity",t.opacity),D=P.append("g").classed("annotation-text-g",!0),O=k[t.showarrow?"annotationTail":"annotationPosition"],M=t.captureevents||k.annotationText||O,j=D.append("g").style("pointer-events",M?"all":null).call(g,"pointer").on("click",function(){e._dragging=!1,e.emit("plotly_clickannotation",f(o.event))});t.hovertext&&j.on("mouseover",function(){var a=t.hoverlabel,r=a.font,o=this.getBoundingClientRect(),i=e.getBoundingClientRect();p.loneHover({x0:o.left-i.left,x1:o.right-i.left,y:(o.top+o.bottom)/2-i.top,text:t.hovertext,color:a.bgcolor,borderColor:a.bordercolor,fontFamily:r.family,fontSize:r.size,fontColor:r.color},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:e})}).on("mouseout",function(){p.loneUnhover(b._hoverlayer.node())});var F=t.borderwidth,B=t.borderpad,U=F+B,H=j.append("rect").attr("class","bg").style("stroke-width",F+"px").call(d.stroke,t.bordercolor).call(d.fill,t.bgcolor),G=t.width||t.height,q=b._topclips.selectAll("#"+E).data(G?[0]:[]);q.enter().append("clipPath").classed("annclip",!0).attr("id",E).append("rect"),q.exit().remove();var Y=t.font,W=b._meta?l.templateString(t.text,b._meta):t.text,X=j.append("text").classed("annotation-text",!0).text(W);k.annotationText?X.call(u.makeEditable,{delegate:j,gd:e}).call(x).on("edit",function(a){t.text=a,this.call(x),C("text",a),n&&n.autorange&&S(n._name+".autorange",!0),s&&s.autorange&&S(s._name+".autorange",!0),i.call("_guiRelayout",e,L())}):X.call(x)}var o=e("d3"),i=e("../../registry"),n=e("../../plots/plots"),l=e("../../lib"),s=e("../../plots/cartesian/axes"),d=e("../color"),c=e("../drawing"),p=e("../fx"),u=e("../../lib/svg_text_utils"),g=e("../../lib/setcursor"),h=e("../dragelement"),m=e("../../plot_api/plot_template").arrayEditor,y=e("./draw_arrow_head");t.exports={draw:function(e){var t=e._fullLayout;t._infolayer.selectAll(".annotation").remove();for(var r=0;r<t.annotations.length;r++)t.annotations[r].visible&&a(e,r);return n.previousPromises(e)},drawOne:a,drawRaw:r}},{"../../lib":719,"../../lib/setcursor":739,"../../lib/svg_text_utils":743,"../../plot_api/plot_template":757,"../../plots/cartesian/axes":767,"../../plots/plots":828,"../../registry":847,"../color":593,"../dragelement":611,"../drawing":614,"../fx":632,"./draw_arrow_head":583,d3:163}],583:[function(e,t){"use strict";var a=e("d3"),r=e("../color"),o=e("./arrow_paths");t.exports=function(e,t,i){function n(){e.style("stroke-dasharray","0px,100px")}function l(t,o,n,l){t.path&&(t.noRotate&&(n=0),a.select(s.parentNode).append("path").attr({class:e.attr("class"),d:t.path,transform:"translate("+o.x+","+o.y+")"+(n?"rotate("+180*n/Pe+")":"")+"scale("+l+")"}).style({fill:r.rgb(i.arrowcolor),"stroke-width":0}))}var s=e.node(),d=o[i.arrowhead||0],c=o[i.startarrowhead||0],p=(i.arrowwidth||1)*(i.arrowsize||1),u=(i.arrowwidth||1)*(i.startarrowsize||1),g=0<=t.indexOf("start"),h=0<=t.indexOf("end"),m=d.backoff*p+i.standoff,y=c.backoff*u+i.startstandoff,f,x,_,b;if("line"===s.nodeName){f={x:+e.attr("x1"),y:+e.attr("y1")},x={x:+e.attr("x2"),y:+e.attr("y2")};var v=f.x-x.x,k=f.y-x.y;if(_=L(k,v),b=_+Pe,m&&y&&m+y>N(v*v+k*k))return void n();if(m){if(m*m>v*v+k*k)return void n();var w=m*R(_),T=m*De(_);x.x+=w,x.y+=T,e.attr({x2:x.x,y2:x.y})}if(y){if(y*y>v*v+k*k)return void n();var A=y*R(_),S=y*De(_);f.x-=A,f.y-=S,e.attr({x1:f.x,y1:f.y})}}else if("path"===s.nodeName){var C=s.getTotalLength(),E="";if(C<m+y)return void n();var I=s.getPointAtLength(0),z=s.getPointAtLength(.1);_=L(I.y-z.y,I.x-z.x),f=s.getPointAtLength(ea(y,C)),E="0px,"+y+"px,";var P=s.getPointAtLength(C),D=s.getPointAtLength(C-.1);b=L(P.y-D.y,P.x-D.x),x=s.getPointAtLength(va(0,C-m));var O=E?y+m:m;E+=C-O+"px,"+C+"px",e.style("stroke-dasharray",E)}g&&l(c,f,_,u),h&&l(d,x,b,p)}},{"../color":593,"./arrow_paths":575,d3:163}],584:[function(e,t){"use strict";var a=e("./draw"),r=e("./click");t.exports={moduleType:"component",name:"annotations",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("annotations"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne,drawRaw:a.drawRaw,hasClickToShow:r.hasClickToShow,onClick:r.onClick,convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":777,"./attributes":576,"./calc_autorange":577,"./click":578,"./convert_coords":580,"./defaults":581,"./draw":582}],585:[function(e,t){"use strict";var a=e("../annotations/attributes"),r=e("../../plot_api/edit_types").overrideAll,o=e("../../plot_api/plot_template").templatedArray;t.exports=r(o("annotation",{visible:a.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:a.xanchor,xshift:a.xshift,yanchor:a.yanchor,yshift:a.yshift,text:a.text,textangle:a.textangle,font:a.font,width:a.width,height:a.height,opacity:a.opacity,align:a.align,valign:a.valign,bgcolor:a.bgcolor,bordercolor:a.bordercolor,borderpad:a.borderpad,borderwidth:a.borderwidth,showarrow:a.showarrow,arrowcolor:a.arrowcolor,arrowhead:a.arrowhead,startarrowhead:a.startarrowhead,arrowside:a.arrowside,arrowsize:a.arrowsize,startarrowsize:a.startarrowsize,arrowwidth:a.arrowwidth,standoff:a.standoff,startstandoff:a.startstandoff,hovertext:a.hovertext,hoverlabel:a.hoverlabel,captureevents:a.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../annotations/attributes":576}],586:[function(e,t){"use strict";function a(e,t){var a=t.fullSceneLayout,i=a.domain,n=t.fullLayout._size,l={pdata:null,type:"linear",autorange:!1,range:[-Infinity,1/0]};e._xa={},r.extendFlat(e._xa,l),o.setConvert(e._xa),e._xa._offset=n.l+i.x[0]*n.w,e._xa.l2p=function(){return .5*(1+e._pdata[0]/e._pdata[3])*n.w*(i.x[1]-i.x[0])},e._ya={},r.extendFlat(e._ya,l),o.setConvert(e._ya),e._ya._offset=n.t+(1-i.y[1])*n.h,e._ya.l2p=function(){return .5*(1-e._pdata[1]/e._pdata[3])*n.h*(i.y[1]-i.y[0])}}var r=e("../../lib"),o=e("../../plots/cartesian/axes");t.exports=function(e){for(var t=e.fullSceneLayout,r=t.annotations,o=0;o<r.length;o++)a(r[o],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()}},{"../../lib":719,"../../plots/cartesian/axes":767}],587:[function(e,t){"use strict";function a(e,t,a,i){function s(a,o){return r.coerce(e,t,l,a,o)}function d(e){var r=e+"axis",i={_fullLayout:{}};return i._fullLayout[r]=a[r],o.coercePosition(t,i,s,e,e,.5)}var c=s("visible");c&&(n(e,t,i.fullLayout,s),d("x"),d("y"),d("z"),r.noneOrAll(e,t,["x","y","z"]),t.xref="x",t.yref="y",t.zref="z",s("xanchor"),s("yanchor"),s("xshift"),s("yshift"),t.showarrow&&(t.axref="pixel",t.ayref="pixel",s("ax",-10),s("ay",-30),r.noneOrAll(e,t,["ax","ay"])))}var r=e("../../lib"),o=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("../annotations/common_defaults"),l=e("./attributes");t.exports=function(e,t,r){i(e,t,{name:"annotations",handleItemDefaults:a,fullLayout:r.fullLayout})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"../annotations/common_defaults":579,"./attributes":585}],588:[function(e,t){"use strict";var a=e("../annotations/draw").drawRaw,r=e("../../plots/gl3d/project"),o=["x","y","z"];t.exports=function(e){for(var t=e.fullSceneLayout,n=e.dataScale,l=t.annotations,s=0;s<l.length;s++){for(var d=l[s],c=!1,p=0;3>p;p++){var u=o[p],g=d[u],h=t[u+"axis"],m=h.r2fraction(g);if(0>m||1<m){c=!0;break}}c?e.fullLayout._infolayer.select(".annotation-"+e.id+"[data-index=\""+s+"\"]").remove():(d._pdata=r(e.glplot.cameraParams,[t.xaxis.r2l(d.x)*n[0],t.yaxis.r2l(d.y)*n[1],t.zaxis.r2l(d.z)*n[2]]),a(e.graphDiv,d,s,e.id,d._xa,d._ya))}}},{"../../plots/gl3d/project":816,"../annotations/draw":582}],589:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib");t.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),includeBasePlot:function(e,t){var o=a.subplotsRegistry.gl3d;if(o)for(var n=o.attrRegex,l=Object.keys(e),s=0,d;s<l.length;s++)d=l[s],n.test(d)&&(e[d].annotations||[]).length&&(r.pushUnique(t._basePlotModules,o),r.pushUnique(t._subplots.gl3d,d))},convert:e("./convert"),draw:e("./draw")}},{"../../lib":719,"../../registry":847,"./attributes":585,"./convert":586,"./defaults":587,"./draw":588}],590:[function(e,t){"use strict";t.exports=e("world-calendars/dist/main"),e("world-calendars/dist/plus"),e("world-calendars/dist/calendars/chinese"),e("world-calendars/dist/calendars/coptic"),e("world-calendars/dist/calendars/discworld"),e("world-calendars/dist/calendars/ethiopian"),e("world-calendars/dist/calendars/hebrew"),e("world-calendars/dist/calendars/islamic"),e("world-calendars/dist/calendars/julian"),e("world-calendars/dist/calendars/mayan"),e("world-calendars/dist/calendars/nanakshahi"),e("world-calendars/dist/calendars/nepali"),e("world-calendars/dist/calendars/persian"),e("world-calendars/dist/calendars/taiwan"),e("world-calendars/dist/calendars/thai"),e("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":557,"world-calendars/dist/calendars/coptic":558,"world-calendars/dist/calendars/discworld":559,"world-calendars/dist/calendars/ethiopian":560,"world-calendars/dist/calendars/hebrew":561,"world-calendars/dist/calendars/islamic":562,"world-calendars/dist/calendars/julian":563,"world-calendars/dist/calendars/mayan":564,"world-calendars/dist/calendars/nanakshahi":565,"world-calendars/dist/calendars/nepali":566,"world-calendars/dist/calendars/persian":567,"world-calendars/dist/calendars/taiwan":568,"world-calendars/dist/calendars/thai":569,"world-calendars/dist/calendars/ummalqura":570,"world-calendars/dist/main":571,"world-calendars/dist/plus":572}],591:[function(e,t){"use strict";function a(e){var t=h[e];return t?t:(t=h[e]=i.instance(e),t)}function r(e){return n.extendFlat({},c,{description:e})}function o(e){return"Sets the calendar system to use with `"+e+"` date data."}var i=e("./calendars"),n=e("../../lib"),l=e("../../constants/numerical"),s=l.EPOCHJD,d=l.ONEDAY,c={valType:"enumerated",values:Object.keys(i.calendars),editType:"calc",dflt:"gregorian"},p=function(e,t,a,r){var o={};return o[a]=c,n.coerce(e,t,o,a,r)},u="##",g={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:u,w:u,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},h={},m={xcalendar:r(o("x"))},y=n.extendFlat({},m,{ycalendar:r(o("y"))}),f=n.extendFlat({},y,{zcalendar:r(o("z"))}),x=r("Sets the calendar system to use for `range` and `tick0` if this is a date axis. This does not set the calendar for interpreting data on this axis, that's specified in the trace or via the global `layout.calendar`");t.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:y,bar:y,box:y,heatmap:y,contour:y,histogram:y,histogram2d:y,histogram2dcontour:y,scatter3d:f,surface:f,mesh3d:f,scattergl:y,ohlc:m,candlestick:m},layout:{calendar:r("Sets the default calendar system to use for interpreting and displaying dates throughout the plot.")},subplots:{xaxis:{calendar:x},yaxis:{calendar:x},scene:{xaxis:{calendar:x},yaxis:{calendar:x},zaxis:{calendar:x}},polar:{radialaxis:{calendar:x}}},transforms:{filter:{valuecalendar:r("Sets the calendar system to use for `value`, if it is a date."),targetcalendar:r("Sets the calendar system to use for `target`, if it is an array of dates. If `target` is a string (eg *x*) we use the corresponding trace attribute (eg `xcalendar`) if it exists, even if `targetcalendar` is provided.")}}},layoutAttributes:c,handleDefaults:p,handleTraceDefaults:function(e,t,a,r){for(var o=0;o<a.length;o++)p(e,t,a[o]+"calendar",r.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:a,worldCalFmt:function(e,t,r){for(var o=ba((t+.05)/d)+s,n=a(r).fromJD(o),l=0,c,p,u,h,m;-1!==(l=e.indexOf("%",l));)c=e.charAt(l+1),"0"===c||"-"===c||"_"===c?(u=3,p=e.charAt(l+2),"_"===c&&(c="-")):(p=c,c="0",u=2),h=g[p],h?(m="##"===h?"##":n.formatDate(h[c]),e=e.substr(0,l)+m+e.substr(l+u),l+=m.length):l+=u;return e}}},{"../../constants/numerical":695,"../../lib":719,"./calendars":590}],592:[function(e,t,a){"use strict";a.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a.defaultLine="#444",a.lightLine="#eee",a.background="#fff",a.borderLine="#BEC8D9",a.lightFraction=1000/11},{}],593:[function(e,t){"use strict";function a(e){if(o(e)||"string"!=typeof e)return e;var t=e.trim();if("rgb"!==t.substr(0,3))return e;var a=t.match(/^rgba?\s*\(([^()]*)\)$/);if(!a)return e;var r=a[1].trim().split(/\s*[\s,]\s*/),n="a"===t.charAt(3)&&4===r.length;if(!n&&3!==r.length)return e;for(var l=0;l<r.length;l++){if(!r[l].length)return e;if(r[l]=+r[l],!(0<=r[l]))return e;if(3==l)1<r[l]&&(r[l]=1);else if(1<=r[l])return e}var s=V(255*r[0])+", "+V(255*r[1])+", "+V(255*r[2]);return n?"rgba("+s+", "+r[3]+")":"rgb("+s+")"}var r=e("tinycolor2"),o=e("fast-isnumeric"),n=t.exports={},l=e("./attributes");n.defaults=l.defaults;var s=n.defaultLine=l.defaultLine;n.lightLine=l.lightLine;var d=n.background=l.background;n.tinyRGB=function(e){var t=e.toRgb();return"rgb("+V(t.r)+", "+V(t.g)+", "+V(t.b)+")"},n.rgb=function(e){return n.tinyRGB(r(e))},n.opacity=function(e){return e?r(e).getAlpha():0},n.addOpacity=function(e,t){var a=r(e).toRgb();return"rgba("+V(a.r)+", "+V(a.g)+", "+V(a.b)+", "+t+")"},n.combine=function(e,t){var a=r(e).toRgb();if(1===a.a)return r(e).toRgbString();var o=r(t||d).toRgb(),i=1===o.a?o:{r:255*(1-o.a)+o.r*o.a,g:255*(1-o.a)+o.g*o.a,b:255*(1-o.a)+o.b*o.a},n={r:i.r*(1-a.a)+a.r*a.a,g:i.g*(1-a.a)+a.g*a.a,b:i.b*(1-a.a)+a.b*a.a};return r(n).toRgbString()},n.contrast=function(e,t,a){var o=r(e);1!==o.getAlpha()&&(o=r(n.combine(e,d)));var i=o.isDark()?t?o.lighten(t):d:a?o.darken(a):s;return i.toString()},n.stroke=function(e,t){var a=r(t);e.style({stroke:n.tinyRGB(a),"stroke-opacity":a.getAlpha()})},n.fill=function(e,t){var a=r(t);e.style({fill:n.tinyRGB(a),"fill-opacity":a.getAlpha()})},n.clean=function(e){if(e&&"object"==typeof e){var t=Object.keys(e),r,o,l,s;for(r=0;r<t.length;r++)if(l=t[r],s=e[l],"color"===l.substr(l.length-5)){if(Array.isArray(s))for(o=0;o<s.length;o++)s[o]=a(s[o]);else e[l]=a(s);}else if("colorscale"===l.substr(l.length-10)&&Array.isArray(s))for(o=0;o<s.length;o++)Array.isArray(s[o])&&(s[o][1]=a(s[o][1]));else if(Array.isArray(s)){var d=s[0];if(!Array.isArray(d)&&d&&"object"==typeof d)for(o=0;o<s.length;o++)n.clean(s[o])}else s&&"object"==typeof s&&n.clean(s)}}},{"./attributes":592,"fast-isnumeric":225,tinycolor2:537}],594:[function(e,t){"use strict";var a=e("../../plots/cartesian/layout_attributes"),r=e("../../plots/font_attributes"),o=e("../../lib/extend").extendFlat,i=e("../../plot_api/edit_types").overrideAll;t.exports=i({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:a.linecolor,outlinewidth:a.linewidth,bordercolor:a.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:o({},a.ticks,{dflt:""}),ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:r({}),tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,separatethousands:a.separatethousands,exponentformat:a.exponentformat,showexponent:a.showexponent,title:{text:{valType:"string"},font:r({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:r({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/cartesian/layout_attributes":779,"../../plots/font_attributes":793}],595:[function(e,t){"use strict";t.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],596:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../plot_api/plot_template"),o=e("../../plots/cartesian/tick_value_defaults"),i=e("../../plots/cartesian/tick_mark_defaults"),n=e("../../plots/cartesian/tick_label_defaults"),l=e("./attributes");t.exports=function(e,t,s){function d(e,t){return a.coerce(p,c,l,e,t)}var c=r.newContainer(t,"colorbar"),p=e.colorbar||{},u=d("thicknessmode");d("thickness","fraction"===u?30/(s.width-s.margin.l-s.margin.r):30);var g=d("lenmode");d("len","fraction"===g?1:s.height-s.margin.t-s.margin.b),d("x"),d("xanchor"),d("xpad"),d("y"),d("yanchor"),d("ypad"),a.noneOrAll(p,c,["x","y"]),d("outlinecolor"),d("outlinewidth"),d("bordercolor"),d("borderwidth"),d("bgcolor"),o(p,c,d,"linear");var h={outerTicks:!1,font:s.font};n(p,c,d,"linear",h),i(p,c,d,"linear",h),d("title.text",s._dfltTitle.colorbar),a.coerceFont(d,"title.font",s.font),d("title.side")}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/cartesian/tick_label_defaults":786,"../../plots/cartesian/tick_mark_defaults":787,"../../plots/cartesian/tick_value_defaults":788,"./attributes":594}],597:[function(e,t){"use strict";function a(e){function t(e){return m(e,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function a(){"function"==typeof p.calc?p.calc(e,c,s):(s._fillgradient=d.reversescale?v(d.colorscale):d.colorscale,s._zrange=[d[p.min],d[p.max]])}for(var r=e._fullLayout,o=e.calcdata,n=[],l=0,s,d,c,p,u;l<o.length;l++){u=o[l],c=u[0].trace;var g=c._module.colorbar;if(!0===c.visible&&g)for(var h=Array.isArray(g),y=h?g:[g],f=0;f<y.length;f++){p=y[f];var x=p.container;d=x?c[x]:c,d&&d.showscale&&(s=t(d.colorbar),s._id="cb"+c.uid+(h&&x?"-"+x:""),s._traceIndex=c.index,s._propPrefix=(x?x+".":"")+"colorbar.",s._meta=c._meta,a(),n.push(s))}}for(var _ in r._colorAxes)if(d=r[_],d.showscale){var b=r._colorAxes[_];s=t(d.colorbar),s._id="cb"+_,s._propPrefix=_+".colorbar.",s._meta=r._meta,p={min:"cmin",max:"cmax"},"heatmap"!==b[0]&&(c=b[1],p.calc=c._module.colorbar.calc),a(),n.push(s)}return n}function r(e,t,a){function r(r,o){var i={propContainer:K,propName:t._propPrefix+"title",traceIndex:t._traceIndex,_meta:t._meta,placeholder:u._dfltTitle.colorbar,containerGroup:e.select("."+E.cbtitle)},n="h"===r.charAt(0)?r.substr(1):"h"+r;e.selectAll("."+n+",."+n+"-math-group").remove(),_.draw(a,r,m(i,o||{}))}function o(){if(-1!==["top","bottom"].indexOf(w)){var r=e.select("."+E.cbtitle),o=r.select("text"),i=[-t.outlinewidth/2,t.outlinewidth/2],n=r.select(".h"+K._id+"title-math-group").node(),d=15.6;if(o.node()&&(d=parseInt(o.node().style.fontSize,10)*S),n?(re=f.bBox(n).height,re>d&&(i[1]-=(re-d)/2)):o.node()&&!o.classed(E.jsPlaceholder)&&(re=f.bBox(o.node()).height),re){if(re+=5,"top"===w)K.domain[1]-=re/g.h,i[1]*=-1;else{K.domain[0]+=re/g.h;var c=b.lineCount(o);i[1]+=(1-c)*d}r.attr("transform","translate("+i+")"),K.setScale()}}e.selectAll("."+E.cbfills+",."+E.cblines).attr("transform","translate(0,"+V(g.h*(1-K.domain[1]))+")"),ae.attr("transform","translate(0,"+V(-g.t)+")");var u=e.select("."+E.cbfills).selectAll("rect."+E.cbfill).data(R);u.enter().append("rect").classed(E.cbfill,!0).style("stroke","none"),u.exit().remove();var m=T.map(K.c2p).map(Math.round).sort(function(e,t){return e-t});u.each(function(e,r){var o=[0===r?T[0]:(R[r]+R[r-1])/2,r===R.length-1?T[1]:(R[r]+R[r+1])/2].map(K.c2p).map(Math.round);o[1]=h.constrain(o[1]+(o[1]>o[0])?1:-1,m[0],m[1]);var i=l.select(this).attr({x:q,width:va(j,2),y:l.min(o),height:va(l.max(o)-l.min(o),2)});if(t._fillgradient)f.gradient(i,a,t._id,"vertical",t._fillgradient,"fill");else{var n=z(e).replace("e-","");i.attr("fill",s(n).toHexString())}});var y=e.select("."+E.cblines).selectAll("path."+E.cbline).data(v.color&&v.width?M:[]);y.enter().append("path").classed(E.cbline,!0),y.exit().remove(),y.each(function(e){l.select(this).attr("d","M"+q+","+(V(K.c2p(e))+v.width/2%1)+"h"+j).call(f.lineGroupStyle,v.width,A(e),v.dash)}),ae.selectAll("g."+K._id+"tick,path").remove();var x=q+j+(t.outlinewidth||0)/2-("outside"===t.ticks?1:0),_=p.calcTicks(K),k=p.makeTransFn(K),C=p.getTickSigns(K)[2];return p.drawTicks(a,K,{vals:"inside"===K.ticks?p.clipEnds(K,_):_,layer:ae,path:p.makeTickPath(K,x,C),transFn:k}),p.drawLabels(a,K,{vals:_,layer:ae,transFn:k,labelFns:p.makeLabelFns(K,x)})}function c(){var r=j+t.outlinewidth/2+f.bBox(ae.node()).width;if(oe=te.select("text"),oe.node()&&!oe.classed(E.jsPlaceholder)){var o=te.select(".h"+K._id+"title-math-group").node(),i;i=o&&-1!==["top","bottom"].indexOf(w)?f.bBox(o).width:f.bBox(te.node()).right-q-g.l,r=va(r,i)}var n=2*t.xpad+r+t.borderwidth+t.outlinewidth/2,l=X-Z;e.select("."+E.cbbg).attr({x:q-t.xpad-(t.borderwidth+t.outlinewidth)/2,y:Z-H,width:va(n,2),height:va(l+2*H,2)}).call(x.fill,t.bgcolor).call(x.stroke,t.bordercolor).style("stroke-width",t.borderwidth),e.selectAll("."+E.cboutline).attr({x:q,y:Z+t.ypad+("top"===w?re:0),width:va(j,2),height:va(l-2*t.ypad-re,2)}).call(x.stroke,t.outlinecolor).style({fill:"none","stroke-width":t.outlinewidth});var s=({center:.5,right:1}[t.xanchor]||0)*n;e.attr("transform","translate("+(g.l-s)+","+g.t+")");var c={},p=C[t.yanchor],u=L[t.yanchor];"pixels"===t.lenmode?(c.y=t.y,c.t=l*p,c.b=l*u):(c.t=c.b=0,c.yt=t.y+t.len*p,c.yb=t.y-t.len*u);var h=C[t.xanchor],m=L[t.xanchor];if("pixels"===t.thicknessmode)c.x=t.x,c.l=n*h,c.r=n*m;else{var y=n-j;c.l=y*h,c.r=y*m,c.xl=t.x-t.thickness*h,c.xr=t.x+t.thickness*m}d.autoMargin(a,t._id,c)}var u=a._fullLayout,g=u._size,y=t._fillcolor,v=t._line,k=t.title,w=k.side,T=t._zrange||l.extent(("function"==typeof y?y:v.color).domain()),A="function"==typeof v.color?v.color:function(){return v.color},z="function"==typeof y?y:function(){return y},D=t._levels,O=i(a,t,T),R=O.fill,M=O.line,j=V(t.thickness*("fraction"===t.thicknessmode?g.w:1)),F=j/g.w,B=V(t.len*("fraction"===t.lenmode?g.h:1)),N=B/g.h,U=t.xpad/g.w,H=(t.borderwidth+t.outlinewidth)/2,G=t.ypad/g.h,q=V(t.x*g.w+t.xpad),Y=t.x-F*({middle:.5,right:1}[t.xanchor]||0),W=t.y+N*(({top:-.5,bottom:.5}[t.yanchor]||0)-.5),X=V(g.h*(1-W)),Z=X-B;t._lenFrac=N,t._thickFrac=F,t._xLeftFrac=Y,t._yBottomFrac=W;var K=n(a,t,T);if(K.position=t.x+U+F,-1!==["top","bottom"].indexOf(w)&&(K.title.side=w,K.titlex=t.x+U,K.titley=W+("top"===k.side?N-G:G)),v.color&&"auto"===t.tickmode){K.tickmode="linear",K.tick0=D.start;var J=D.size,Q=h.constrain((X-Z)/50,4,15)+1,$=(T[1]-T[0])/((t.nticks||Q)*J);if(1<$){var ee=ya(10,ba(P($)/I));J*=ee*h.roundUp($/ee,[2,5,10]),2e-6>(_a(D.start)/D.size+1e-6)%1&&(K.tick0=0)}K.dtick=J}K.domain=[W+G,W+N-G],K.setScale(),e.attr("transform","translate("+V(g.l)+","+V(g.t)+")");var te=e.select("."+E.cbtitleunshift).attr("transform","translate(-"+V(g.l)+",-"+V(g.t)+")"),ae=e.select("."+E.cbaxis),re=0,oe;return h.syncOrAsync([d.previousPromises,function(){if(-1!==["top","bottom"].indexOf(w)){var e=g.l+(t.x+U)*g.w,a=K.title.font.size,o;o="top"===w?(1-(W+N-G))*g.h+g.t+3+.75*a:(1-(W+G))*g.h+g.t-3-.25*a,r(K._id+"title",{attributes:{x:e,y:o,"text-anchor":"start"}})}},o,function(){if(-1===["top","bottom"].indexOf(w)){var e=K.title.font.size,t=K._offset+K._length/2,o=g.l+(K.position||0)*g.w+("right"===K.side?10+e*(K.showticklabels?1:.5):-10-e*(K.showticklabels?.5:0));r("h"+K._id+"title",{avoid:{selection:l.select(a).selectAll("g."+K._id+"tick"),side:w,offsetLeft:g.l,offsetTop:0,maxShift:u.width},attributes:{x:o,y:t,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}},d.previousPromises,c],a)}function o(e,t,a){var r=a._fullLayout,o=r._size,i,n,l;u.init({element:e.node(),gd:a,prepFn:function(){i=e.attr("transform"),y(e)},moveFn:function(a,r){e.attr("transform",i+" translate("+a+","+r+")"),n=u.align(t._xLeftFrac+a/o.w,t._thickFrac,0,1,t.xanchor),l=u.align(t._yBottomFrac-r/o.h,t._lenFrac,0,1,t.yanchor);var s=u.getCursor(n,l,t.xanchor,t.yanchor);y(e,s)},doneFn:function(){if(y(e),void 0!==n&&void 0!==l){var r={};r[t._propPrefix+"x"]=n,r[t._propPrefix+"y"]=l,void 0===t._traceIndex?c.call("_guiRelayout",a,r):c.call("_guiRestyle",a,r,t._traceIndex)}}})}function i(e,t,a){var r=t._levels,o=[],n=[],s=r.end+r.size/100,d=r.size,c=1.001*a[0]-.001*a[1],p=1.001*a[1]-.001*a[0],u,g;for(g=0;1e5>g&&(u=r.start+g*d,0<d?!(u>=s):!(u<=s));g++)u>c&&u<p&&o.push(u);if(t._fillgradient)n=[0];else if("function"==typeof t._fillcolor){var h=t._filllevels;if(h)for(s=h.end+h.size/100,d=h.size,g=0;1e5>g&&(u=h.start+g*d,0<d?!(u>=s):!(u<=s));g++)u>a[0]&&u<a[1]&&n.push(u);else n=o.map(function(e){return e-r.size/2}),n.push(n[n.length-1]+r.size)}else t._fillcolor&&"string"==typeof t._fillcolor&&(n=[0]);return 0>r.size&&(o.reverse(),n.reverse()),{line:o,fill:n}}function n(e,t,a){function r(e,t){return h.coerce(i,n,T,e,t)}var o=e._fullLayout,i={type:"linear",range:a,tickmode:t.tickmode,nticks:t.nticks,tick0:t.tick0,dtick:t.dtick,tickvals:t.tickvals,ticktext:t.ticktext,ticks:t.ticks,ticklen:t.ticklen,tickwidth:t.tickwidth,tickcolor:t.tickcolor,showticklabels:t.showticklabels,tickfont:t.tickfont,tickangle:t.tickangle,tickformat:t.tickformat,exponentformat:t.exponentformat,separatethousands:t.separatethousands,showexponent:t.showexponent,showtickprefix:t.showtickprefix,tickprefix:t.tickprefix,showticksuffix:t.showticksuffix,ticksuffix:t.ticksuffix,title:t.title,showline:!0,anchor:"free",side:"right",position:1},n={type:"linear",_id:"y"+t._id},l={letter:"y",font:o.font,noHover:!0,noTickson:!0,calendar:o.calendar};return k(i,n,r,l,o),w(i,n,r,l),n}var l=e("d3"),s=e("tinycolor2"),d=e("../../plots/plots"),c=e("../../registry"),p=e("../../plots/cartesian/axes"),u=e("../dragelement"),h=e("../../lib"),m=e("../../lib/extend").extendFlat,y=e("../../lib/setcursor"),f=e("../drawing"),x=e("../color"),_=e("../titles"),b=e("../../lib/svg_text_utils"),v=e("../colorscale/helpers").flipScale,k=e("../../plots/cartesian/axis_defaults"),w=e("../../plots/cartesian/position_defaults"),T=e("../../plots/cartesian/layout_attributes"),A=e("../../constants/alignment"),S=A.LINE_SPACING,C=A.FROM_TL,L=A.FROM_BR,E=e("./constants").cn;t.exports={draw:function(e){var t=e._fullLayout,i=t._infolayer.selectAll("g."+E.colorbar).data(a(e),function(e){return e._id});i.enter().append("g").attr("class",function(e){return e._id}).classed(E.colorbar,!0),i.each(function(t){var a=l.select(this);h.ensureSingle(a,"rect",E.cbbg),h.ensureSingle(a,"g",E.cbfills),h.ensureSingle(a,"g",E.cblines),h.ensureSingle(a,"g",E.cbaxis,function(e){e.classed(E.crisp,!0)}),h.ensureSingle(a,"g",E.cbtitleunshift,function(e){e.append("g").classed(E.cbtitle,!0)}),h.ensureSingle(a,"rect",E.cboutline);var i=r(a,t,e);i&&i.then&&(e._promises||[]).push(i),e._context.edits.colorbarPosition&&o(a,t,e)}),i.exit().each(function(t){d.autoMargin(e,t._id)}).remove(),i.order()}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/extend":710,"../../lib/setcursor":739,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_defaults":769,"../../plots/cartesian/layout_attributes":779,"../../plots/cartesian/position_defaults":782,"../../plots/plots":828,"../../registry":847,"../color":593,"../colorscale/helpers":604,"../dragelement":611,"../drawing":614,"../titles":681,"./constants":595,d3:163,tinycolor2:537}],598:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e){return a.isPlainObject(e.colorbar)}},{"../../lib":719}],599:[function(e,t){"use strict";t.exports={moduleType:"component",name:"colorbar",attributes:e("./attributes"),supplyDefaults:e("./defaults"),draw:e("./draw").draw,hasColorbar:e("./has_colorbar")}},{"./attributes":594,"./defaults":596,"./draw":597,"./has_colorbar":598}],600:[function(e,t){"use strict";function a(e){return"`"+e+"`"}var r=e("../colorbar/attributes"),o=e("../../lib/regex").counter,i=e("./scales.js").scales,n=Object.keys(i);t.exports=function(e,t){e=e||"",t=t||{};var n=t.cLetter||"c",l="onlyIfNumerical"in t?t.onlyIfNumerical:!!e,s="noScale"in t?t.noScale:"marker.line"===e,d="showScaleDflt"in t?t.showScaleDflt:"z"===n,c="string"==typeof t.colorscaleDflt?i[t.colorscaleDflt]:null,p=t.editTypeOverride||"",u=e?e+".":"",g,h;"colorAttr"in t?(g=t.colorAttr,h=t.colorAttr):(g={z:"z",c:"color"}[n],h="in "+a(u+g));var m=l?" Has an effect only if "+h+"is set to a numerical array.":"",y=n+"auto",f=n+"min",x=n+"max",_=a(u+y),b=a(u+f),v=a(u+x),k={};k[f]=k[x]=void 0;var w={};w[y]=!1;var T={};return"color"===g&&(T.color={valType:"color",arrayOk:!0,editType:p||"style"},t.anim&&(T.color.anim=!0)),T[y]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:k},T[f]={valType:"number",dflt:null,editType:p||"plot",impliedEdits:w},T[x]={valType:"number",dflt:null,editType:p||"plot",impliedEdits:w},T[n+"mid"]={valType:"number",dflt:null,editType:"calc",impliedEdits:k},T.colorscale={valType:"colorscale",editType:"calc",dflt:c,impliedEdits:{autocolorscale:!1}},T.autocolorscale={valType:"boolean",dflt:!1!==t.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},T.reversescale={valType:"boolean",dflt:!1,editType:"plot"},s||(T.showscale={valType:"boolean",dflt:d,editType:"calc"},T.colorbar=r),t.noColorAxis||(T.coloraxis={valType:"subplotid",regex:o("coloraxis"),dflt:null,editType:"calc"}),T}},{"../../lib/regex":735,"../colorbar/attributes":594,"./scales.js":608}],601:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../lib"),o=e("./helpers").extractOpts;t.exports=function(e,t,i){var n=e._fullLayout,l=i.vals,s=i.containerStr,d=s?r.nestedProperty(t,s).get():t,c=o(d),p=!1!==c.auto,u=c.min,g=c.max,h=c.mid,m=function(){return r.aggNums(Math.min,null,l)},y=function(){return r.aggNums(Math.max,null,l)};if(void 0===u?u=m():p&&(d._colorAx&&a(u)?u=ea(u,m()):u=m()),void 0===g?g=y():p&&(d._colorAx&&a(g)?g=va(g,y()):g=y()),p&&void 0!==h&&(g-h>h-u?u=h-(g-h):g-h<h-u&&(g=h+(h-u))),u===g&&(u-=.5,g+=.5),c._sync("min",u),c._sync("max",g),c.autocolorscale){var f;f=0>u*g?n.colorscale.diverging:0<=u?n.colorscale.sequential:n.colorscale.sequentialminus,c._sync("colorscale",f)}}},{"../../lib":719,"./helpers":604,"fast-isnumeric":225}],602:[function(e,t){"use strict";var a=e("../../lib"),r=e("./helpers").hasColorscale,o=e("./helpers").extractOpts;t.exports=function(e,t){function n(e,t){var a=e["_"+t];a!==void 0&&(e[t]=a)}function l(e,r){var i=r.container?a.nestedProperty(e,r.container).get():e;if(i)if(i.coloraxis)i._colorAx=t[i.coloraxis];else{var l=o(i),s=l.auto;(s||void 0===l.min)&&n(i,r.min),(s||void 0===l.max)&&n(i,r.max),l.autocolorscale&&n(i,"colorscale")}}for(var s=0;s<e.length;s++){var d=e[s],c=d._module.colorbar;if(c)if(Array.isArray(c))for(var p=0;p<c.length;p++)l(d,c[p]);else l(d,c);r(d,"marker.line")&&l(d,{container:"marker.line",min:"cmin",max:"cmax"})}for(var u in t._colorAxes)l(t[u],{min:"cmin",max:"cmax"})}},{"../../lib":719,"./helpers":604}],603:[function(e,t){"use strict";function a(e,t){var a=t.slice(0,t.length-1);return t?o.nestedProperty(e,a).get()||{}:e}var r=e("fast-isnumeric"),o=e("../../lib"),i=e("../colorbar/has_colorbar"),n=e("../colorbar/defaults"),l=e("./scales").isValid,s=e("../../registry").traceIs;t.exports=function e(t,d,c,p,u){var g=u.prefix,h=u.cLetter,m="_module"in d,y=a(t,g),f=a(d,g),x=a(d._template||{},g)||{},_=function(){return delete t.coloraxis,delete d.coloraxis,e(t,d,c,p,u)};if(m){var b=c._colorAxes||{},v=p(g+"coloraxis");if(v){var k=s(d,"contour")&&o.nestedProperty(d,"contours.coloring").get()||"heatmap",w=b[v];return void(w?(w[2].push(_),w[0]!==k&&(w[0]=!1,o.warn(["Ignoring coloraxis:",v,"setting","as it is linked to incompatible colorscales."].join(" ")))):b[v]=[k,d,[_]])}}var T=y[h+"min"],A=y[h+"max"],S=r(T)&&r(A)&&T<A,C=p(g+h+"auto",!S);C?p(g+h+"mid"):(p(g+h+"min"),p(g+h+"max"));var L=y.colorscale,E=x.colorscale,I;if(void 0!==L&&(I=!l(L)),void 0!==E&&(I=!l(E)),p(g+"autocolorscale",I),p(g+"colorscale"),p(g+"reversescale"),"marker.line."!==g){var z;g&&m&&(z=i(y));var P=p(g+"showscale",z);P&&n(y,f,c)}}},{"../../lib":719,"../../registry":847,"../colorbar/defaults":596,"../colorbar/has_colorbar":598,"./scales":608,"fast-isnumeric":225}],604:[function(e,t){"use strict";function a(e){var t=e._colorAx,a=t?t:e,r={},o,n,l;for(n=0;n<g.length;n++)l=g[n],r[l]=a[l];if(t)for(o="c",n=0;n<h.length;n++)l=h[n],r[l]=a["c"+l];else{var s;for(n=0;n<h.length;n++){if(l=h[n],s="c"+l,s in a){r[l]=a[s];continue}s="z"+l,s in a&&(r[l]=a[s])}o=s.charAt(0)}return r._sync=function(e,t){var r=-1===h.indexOf(e)?e:o+e;a[r]=a["_"+r]=t},r}function r(e){for(var t=a(e),r=t.min,n=t.max,l=t.reversescale?o(t.colorscale):t.colorscale,s=l.length,d=Array(s),c=Array(s),p=0,u;p<s;p++)u=l[p],d[p]=r+u[0]*(n-r),c[p]=u[1];return{domain:d,range:c}}function o(e){for(var t=e.length,a=Array(t),r=t-1,o=0,n;0<=r;r--,o++)n=e[r],a[o]=[1-n[0],n[1]];return a}function i(e,t){t=t||{};for(var a=e.domain,r=e.range,o=r.length,c=Array(o),u=0,g;u<o;u++)g=s(r[u]).toRgb(),c[u]=[g.r,g.g,g.b,g.a];var h=l.scale.linear().domain(a).range(c).clamp(!0),m=t.noNumericCheck,y=t.returnArray,f;return f=m&&y?h:m?function(e){return n(h(e))}:y?function(e){return d(e)?h(e):s(e).isValid()?e:p.defaultLine}:function(e){return d(e)?n(h(e)):s(e).isValid()?e:p.defaultLine},f.domain=h.domain,f.range=function(){return r},f}function n(e){var t={r:e[0],g:e[1],b:e[2],a:e[3]};return s(t).toRgbString()}var l=e("d3"),s=e("tinycolor2"),d=e("fast-isnumeric"),c=e("../../lib"),p=e("../color"),u=e("./scales").isValid,g=["showscale","autocolorscale","colorscale","reversescale","colorbar"],h=["min","max","mid","auto"];t.exports={hasColorscale:function(e,t){var a=t?c.nestedProperty(e,t).get()||{}:e,r=a.color,o=!1;if(c.isArrayOrTypedArray(r))for(var n=0;n<r.length;n++)if(d(r[n])){o=!0;break}return c.isPlainObject(a)&&(o||!0===a.showscale||d(a.cmin)&&d(a.cmax)||u(a.colorscale)||c.isPlainObject(a.colorbar))},extractOpts:a,extractScale:r,flipScale:o,makeColorScaleFunc:i,makeColorScaleFuncFromTrace:function(e,t){return i(r(e),t)}}},{"../../lib":719,"../color":593,"./scales":608,d3:163,"fast-isnumeric":225,tinycolor2:537}],605:[function(e,t){"use strict";var a=e("./scales"),r=e("./helpers");t.exports={moduleType:"component",name:"colorscale",attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),handleDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc"),scales:a.scales,defaultScale:a.defaultScale,getScale:a.get,isValidScale:a.isValid,hasColorscale:r.hasColorscale,extractOpts:r.extractOpts,extractScale:r.extractScale,flipScale:r.flipScale,makeColorScaleFunc:r.makeColorScaleFunc,makeColorScaleFuncFromTrace:r.makeColorScaleFuncFromTrace}},{"./attributes":600,"./calc":601,"./cross_trace_defaults":602,"./defaults":603,"./helpers":604,"./layout_attributes":606,"./layout_defaults":607,"./scales":608}],606:[function(e,t){"use strict";var a=e("../../lib/extend").extendFlat,r=e("./attributes"),o=e("./scales").scales;t.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:o.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:o.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:o.RdBu,editType:"calc"}},coloraxis:a({_isSubplotObj:!0,editType:"calc"},r("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":710,"./attributes":600,"./scales":608}],607:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../plot_api/plot_template"),o=e("./layout_attributes"),n=e("./defaults");t.exports=function(e,t){function l(r,i){return a.coerce(e,t,o,r,i)}function s(e,t){return a.coerce(c,p,o.coloraxis,e,t)}l("colorscale.sequential"),l("colorscale.sequentialminus"),l("colorscale.diverging");var d=t._colorAxes,c,p;for(var u in d){var g=d[u];if(g[0])c=e[u]||{},p=r.newContainer(t,u,"coloraxis"),p._name=u,n(c,p,t,s,{prefix:"",cLetter:"c"});else{for(var h=0;h<g[2].length;h++)g[2][h]();delete t._colorAxes[u]}}}},{"../../lib":719,"../../plot_api/plot_template":757,"./defaults":603,"./layout_attributes":606}],608:[function(e,t){"use strict";function a(e){var t=0;if(!Array.isArray(e)||2>e.length)return!1;if(!e[0]||!e[e.length-1])return!1;if(0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var a=0,o;a<e.length;a++){if(o=e[a],2!==o.length||+o[0]<t||!r(o[1]).isValid())return!1;t=+o[0]}return!0}var r=e("tinycolor2"),o={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},i=o.RdBu;t.exports={scales:o,defaultScale:i,get:function(t,r){function n(){try{t=o[t]||JSON.parse(t)}catch(a){t=r}}return(r||(r=i),!t)?r:("string"==typeof t&&(n(),"string"==typeof t&&n()),a(t)?t:r)},isValid:function(e){return void 0!==o[e]||a(e)}}},{tinycolor2:537}],609:[function(e,t){"use strict";t.exports=function(e,t,a,r,o){var i=(e-a)/(r-a),n=i+t/(r-a),l=(i+n)/2;return"left"===o||"bottom"===o?i:"center"===o||"middle"===o?l:"right"===o||"top"===o?n:i<2/3-l?i:n>4/3-l?n:l}},{}],610:[function(e,t){"use strict";var a=e("../../lib"),r=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function(e,t,o,i){return e="left"===o?0:"center"===o?1:"right"===o?2:a.constrain(ba(3*e),0,2),t="bottom"===i?0:"middle"===i?1:"top"===i?2:a.constrain(ba(3*t),0,2),r[t][e]}},{"../../lib":719}],611:[function(e,t){"use strict";function a(){var e=document.createElement("div");e.className="dragcover";var t=e.style;return t.position="fixed",t.left=0,t.right=0,t.top=0,t.bottom=0,t.zIndex=999999999,t.background="none",document.body.appendChild(e),e}function r(t){return o(t.changedTouches?t.changedTouches[0]:t,document.body)}var o=e("mouse-event-offset"),i=e("has-hover"),n=e("has-passive-events"),l=e("../../lib").removeElement,s=e("../../plots/cartesian/constants"),d=t.exports={};d.align=e("./align"),d.getCursor=e("./cursor");var c=e("./unhover");d.unhover=c.wrapped,d.unhoverRaw=c.raw,d.init=function(t){function o(o){u._dragged=!1,u._dragging=!0;var e=r(o);return y=e[0],f=e[1],k=o.target,v=o,w=2===o.buttons||o.ctrlKey,"undefined"==typeof o.clientX&&"undefined"==typeof o.clientY&&(o.clientX=y,o.clientY=f),x=new Date().getTime(),x-u._mouseDownTime<h?g+=1:(g=1,u._mouseDownTime=x),t.prepFn&&t.prepFn(o,y,f),i&&!w?(b=a(),b.style.cursor=window.getComputedStyle(m).cursor):!i&&(b=document,_=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(m).cursor),document.addEventListener("mouseup",p),document.addEventListener("touchend",p),void(!1!==t.dragmode&&(o.preventDefault(),document.addEventListener("mousemove",c),document.addEventListener("touchmove",c)))}function c(a){a.preventDefault();var e=r(a),o=t.minDrag||s.MINDRAG,i=T(e[0]-y,e[1]-f,o),n=i[0],l=i[1];return(n||l)&&(u._dragged=!0,d.unhover(u)),void(u._dragged&&t.moveFn&&!w&&(u._dragdata={element:m,dx:n,dy:l},t.moveFn(n,l)))}function p(a){if(delete u._dragdata,!1!==t.dragmode&&(a.preventDefault(),document.removeEventListener("mousemove",c),document.removeEventListener("touchmove",c)),document.removeEventListener("mouseup",p),document.removeEventListener("touchend",p),i?l(b):_&&(b.documentElement.style.cursor=_,_=null),!u._dragging)return void(u._dragged=!1);if(u._dragging=!1,new Date().getTime()-u._mouseDownTime>h&&(g=va(g-1,1)),u._dragged)t.doneFn&&t.doneFn();else if(t.clickFn&&t.clickFn(g,v),!w){var e;try{e=new MouseEvent("click",a)}catch(t){var o=r(a);e=document.createEvent("MouseEvents"),e.initMouseEvent("click",a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,o[0],o[1],a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget)}k.dispatchEvent(e)}return u._dragging=!1,void(u._dragged=!1)}var u=t.gd,g=1,h=u._context.doubleClickDelay,m=t.element,y,f,x,_,b,v,k,w;u._mouseDownTime||(u._mouseDownTime=0),m.style.pointerEvents="all",m.onmousedown=o,n?(m._ontouchstart&&m.removeEventListener("touchstart",m._ontouchstart),m._ontouchstart=o,m.addEventListener("touchstart",o,{passive:!1})):m.ontouchstart=o;var T=t.clampFn||function(e,t,a){return _a(e)<a&&(e=0),_a(t)<a&&(t=0),[e,t]}},d.coverSlip=a},{"../../lib":719,"../../plots/cartesian/constants":773,"./align":609,"./cursor":610,"./unhover":612,"has-hover":410,"has-passive-events":411,"mouse-event-offset":436}],612:[function(e,t){"use strict";var a=e("../../lib/events"),r=e("../../lib/throttle"),o=e("../../lib/dom").getGraphDiv,i=e("../fx/constants"),n=t.exports={};n.wrapped=function(e,t,a){e=o(e),e._fullLayout&&r.clear(e._fullLayout._uid+i.HOVERID),n.raw(e,t,a)},n.raw=function(e,t){var r=e._fullLayout,o=e._hoverdata;t||(t={});t.target&&!1===a.triggerHandler(e,"plotly_beforehover",t)||(r._hoverlayer.selectAll("g").remove(),r._hoverlayer.selectAll("line").remove(),r._hoverlayer.selectAll("circle").remove(),e._hoverdata=void 0,t.target&&o&&e.emit("plotly_unhover",{event:t,points:o}))}},{"../../lib/dom":708,"../../lib/events":709,"../../lib/throttle":744,"../fx/constants":626}],613:[function(e,t,a){"use strict";a.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],614:[function(e,t){"use strict";function a(e,t){return T.symbolFuncs[e%100](t)+(200<=e?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}function r(e,t,a,o){var i=c.select(e.node().parentNode),n=-1===t.indexOf("top")?-1===t.indexOf("bottom")?"middle":"bottom":"top",l=-1===t.indexOf("left")?-1===t.indexOf("right")?"middle":"start":"end",s=o?o/.8+1:0,r=(m.lineCount(e)-1)*x+1,d=z[l]*s,p=.75*a+z[n]*s+(z[n]-1)*r*a/2;e.attr("text-anchor",l),i.attr("transform","translate("+d+","+p+")")}function o(e,t){var a=e.ts||t.textfont.size;return i(a)&&0<a?a:0}function n(e,t,a,r){var o=e[0]-t[0],i=e[1]-t[1],n=a[0]-t[0],l=a[1]-t[1],s=ya(o*o+i*i,P/2),d=ya(n*n+l*l,P/2),p=(d*d*o-s*s*n)*r,u=(d*d*i-s*s*l)*r,g=3*d*(s+d),h=3*s*(s+d);return[[c.round(t[0]+(g&&p/g),2),c.round(t[1]+(g&&u/g),2)],[c.round(t[0]-(h&&p/h),2),c.round(t[1]-(h&&u/h),2)]]}function l(e){var t=e.getAttribute("data-unformatted");return null===t?void 0:t+e.getAttribute("data-math")+e.getAttribute("text-anchor")+e.getAttribute("style")}function d(e,t){if(!e)return null;var a=t._context,r=a._exportedPlot?"":a._baseUrl||"";return"url('"+r+"#"+e+"')"}var c=e("d3"),i=e("fast-isnumeric"),s=e("tinycolor2"),p=e("../../registry"),u=e("../color"),g=e("../colorscale"),h=e("../../lib"),m=e("../../lib/svg_text_utils"),y=e("../../constants/xmlns_namespaces"),f=e("../../constants/alignment"),x=f.LINE_SPACING,_=e("../../constants/interactions").DESELECTDIM,b=e("../../traces/scatter/subtypes"),v=e("../../traces/scatter/make_bubble_size_func"),T=t.exports={};T.font=function(e,t,a,r){h.isPlainObject(t)&&(r=t.color,a=t.size,t=t.family),t&&e.style("font-family",t),a+1&&e.style("font-size",a+"px"),r&&e.call(u.fill,r)},T.setPosition=function(e,t,a){e.attr("x",t).attr("y",a)},T.setSize=function(e,t,a){e.attr("width",t).attr("height",a)},T.setRect=function(e,t,a,r,o){e.call(T.setPosition,t,a).call(T.setSize,r,o)},T.translatePoint=function(e,t,a,r){var o=a.c2p(e.x),n=r.c2p(e.y);if(i(o)&&i(n)&&t.node())"text"===t.node().nodeName?t.attr("x",o).attr("y",n):t.attr("transform","translate("+o+","+n+")");else return!1;return!0},T.translatePoints=function(e,t,a){e.each(function(e){var r=c.select(this);T.translatePoint(e,r,t,a)})},T.hideOutsideRangePoint=function(e,t,a,r,o,i){t.attr("display",a.isPtWithinRange(e,o)&&r.isPtWithinRange(e,i)?null:"none")},T.hideOutsideRangePoints=function(e,t){if(t._hasClipOnAxisFalse){var a=t.xaxis,r=t.yaxis;e.each(function(t){var o=t[0].trace,i=o.xcalendar,n=o.ycalendar,l=p.traceIs(o,"bar-like")?".bartext":".point,.textpoint";e.selectAll(l).each(function(e){T.hideOutsideRangePoint(e,c.select(this),a,r,i,n)})})}},T.crispRound=function(e,t,a){return t&&i(t)?e._context.staticPlot?t:1>t?1:V(t):a||0},T.singleLineStyle=function(e,t,a,r,o){t.style("fill","none");var i=(((e||[])[0]||{}).trace||{}).line||{},n=a||i.width||0,l=o||i.dash||"";u.stroke(t,r||i.color),T.dashLine(t,l,n)},T.lineGroupStyle=function(e,t,a,r){e.style("fill","none").each(function(e){var o=(((e||[])[0]||{}).trace||{}).line||{},i=t||o.width||0,n=r||o.dash||"";c.select(this).call(u.stroke,a||o.color).call(T.dashLine,n,i)})},T.dashLine=function(e,t,a){a=+a||0,t=T.dashStyle(t,a),e.style({"stroke-dasharray":t,"stroke-width":a+"px"})},T.dashStyle=function(e,t){t=+t||1;var a=va(t,3);return"solid"===e?e="":"dot"===e?e=a+"px,"+a+"px":"dash"===e?e=3*a+"px,"+3*a+"px":"longdash"===e?e=5*a+"px,"+5*a+"px":"dashdot"===e?e=3*a+"px,"+a+"px,"+a+"px,"+a+"px":"longdashdot"==e&&(e=5*a+"px,"+2*a+"px,"+a+"px,"+2*a+"px"),e},T.singleFillStyle=function(e){var t=c.select(e.node()),a=t.data(),r=(((a[0]||[])[0]||{}).trace||{}).fillcolor;r&&e.call(u.fill,r)},T.fillGroupStyle=function(e){e.style("stroke-width",0).each(function(e){var t=c.select(this);e[0].trace&&t.call(u.fill,e[0].trace.fillcolor)})};var A=e("./symbol_defs");T.symbolNames=[],T.symbolFuncs=[],T.symbolNeedLines={},T.symbolNoDot={},T.symbolNoFill={},T.symbolList=[],Object.keys(A).forEach(function(e){var t=A[e];T.symbolList=T.symbolList.concat([t.n,e,t.n+100,e+"-open"]),T.symbolNames[t.n]=e,T.symbolFuncs[t.n]=t.f,t.needLine&&(T.symbolNeedLines[t.n]=!0),t.noDot?T.symbolNoDot[t.n]=!0:T.symbolList=T.symbolList.concat([t.n+200,e+"-dot",t.n+300,e+"-open-dot"]),t.noFill&&(T.symbolNoFill[t.n]=!0)});var S=T.symbolNames.length;T.symbolNumber=function(e){if("string"==typeof e){var t=0;0<e.indexOf("-open")&&(t=100,e=e.replace("-open","")),0<e.indexOf("-dot")&&(t+=200,e=e.replace("-dot","")),e=T.symbolNames.indexOf(e),0<=e&&(e+=t)}return e%100>=S||400<=e?0:ba(va(e,0))};var C={x1:1,x2:0,y1:0,y2:0},L={x1:0,x2:0,y1:1,y2:0},E=c.format("~.1f"),I={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:C},horizontalreversed:{node:"linearGradient",attrs:C,reversed:!0},vertical:{node:"linearGradient",attrs:L},verticalreversed:{node:"linearGradient",attrs:L,reversed:!0}};T.gradient=function(e,t,a,r,o,n){for(var l=o.length,p=I[r],g=Array(l),m=0;m<l;m++)p.reversed?g[l-1-m]=[E(100*(1-o[m][0])),o[m][1]]:g[m]=[E(100*o[m][0]),o[m][1]];var y="g"+t._fullLayout._uid+"-"+a,f=t._fullLayout._defs.select(".gradients").selectAll("#"+y).data([r+g.join(";")],h.identity);f.exit().remove(),f.enter().append(p.node).each(function(){var e=c.select(this);p.attrs&&e.attr(p.attrs),e.attr("id",y);var t=e.selectAll("stop").data(g);t.exit().remove(),t.enter().append("stop"),t.each(function(e){var t=s(e[1]);c.select(this).attr({offset:e[0]+"%","stop-color":u.tinyRGB(t),"stop-opacity":t.getAlpha()})})}),e.style(n,d(y,t)).style(n+"-opacity",null)},T.initGradients=function(e){var t=h.ensureSingle(e._fullLayout._defs,"g","gradients");t.selectAll("linearGradient,radialGradient").remove()},T.pointStyle=function(e,t,a){if(e.size()){var r=T.makePointStyleFns(t);e.each(function(e){T.singlePointStyle(e,c.select(this),t,r,a)})}},T.singlePointStyle=function(e,t,o,i,n){var l=o.marker,s=l.line;if(t.style("opacity",i.selectedOpacityFn?i.selectedOpacityFn(e):void 0===e.mo?l.opacity:e.mo),i.ms2mrc){var d;d="various"===e.ms||"various"===l.size?3:i.ms2mrc(e.ms),e.mrc=d,i.selectedSizeFn&&(d=e.mrc=i.selectedSizeFn(e));var c=T.symbolNumber(e.mx||l.symbol)||0;e.om=100<=c%200,t.attr("d",a(c,d))}var p=!1,g,m,y;if(e.so)y=s.outlierwidth,m=s.outliercolor,g=l.outliercolor;else{var f=(s||{}).width;y=(e.mlw+1||f+1||(e.trace?(e.trace.marker.line||{}).width:0)+1)-1||0,m="mlc"in e?e.mlcc=i.lineScale(e.mlc):h.isArrayOrTypedArray(s.color)?u.defaultLine:s.color,h.isArrayOrTypedArray(l.color)&&(g=u.defaultLine,p=!0),g="mc"in e?e.mcc=i.markerScale(e.mc):l.color||"rgba(0,0,0,0)",i.selectedColorFn&&(g=i.selectedColorFn(e))}if(e.om)t.call(u.stroke,g).style({"stroke-width":(y||1)+"px",fill:"none"});else{t.style("stroke-width",y+"px");var x=l.gradient,_=e.mgt;if(_?p=!0:_=x&&x.type,Array.isArray(_)&&(_=_[0],!I[_]&&(_=0)),_&&"none"!==_){var b=e.mgc;b?p=!0:b=x.color;var v=o.uid;p&&(v+="-"+e.i),T.gradient(t,n,v,_,[[0,b],[1,g]],"fill")}else u.fill(t,g);y&&u.stroke(t,m)}},T.makePointStyleFns=function(e){var t={},a=e.marker;return t.markerScale=T.tryColorscale(a,""),t.lineScale=T.tryColorscale(a,"line"),p.traceIs(e,"symbols")&&(t.ms2mrc=b.isBubble(e)?v(e):function(){return(a.size||6)/2}),e.selectedpoints&&h.extendFlat(t,T.makeSelectedPointStyleFns(e)),t},T.makeSelectedPointStyleFns=function(e){var t={},a=e.selected||{},r=e.unselected||{},o=e.marker||{},i=a.marker||{},n=r.marker||{},l=o.opacity,s=i.opacity,c=n.opacity,u=void 0!==s,g=void 0!==c;(h.isArrayOrTypedArray(l)||u||g)&&(t.selectedOpacityFn=function(e){var t=void 0===e.mo?o.opacity:e.mo;return e.selected?u?s:t:g?c:_*t});var m=o.color,y=i.color,f=n.color;(y||f)&&(t.selectedColorFn=function(e){var t=e.mcc||m;return e.selected?y||t:f||t});var x=o.size,b=i.size,v=n.size,k=void 0!==b,w=void 0!==v;return p.traceIs(e,"symbols")&&(k||w)&&(t.selectedSizeFn=function(e){var t=e.mrc||x/2;return e.selected?k?b/2:t:w?v/2:t}),t},T.makeSelectedTextStyleFns=function(e){var t={},a=e.selected||{},r=e.unselected||{},o=e.textfont||{},i=a.textfont||{},n=r.textfont||{},l=o.color,s=i.color,c=n.color;return t.selectedTextColorFn=function(e){var t=e.tc||l;return e.selected?s||t:c?c:s?t:u.addOpacity(t,_)},t},T.selectedPointStyle=function(e,t){if(e.size()&&t.selectedpoints){var r=T.makeSelectedPointStyleFns(t),o=t.marker||{},n=[];r.selectedOpacityFn&&n.push(function(e,t){e.style("opacity",r.selectedOpacityFn(t))}),r.selectedColorFn&&n.push(function(e,t){u.fill(e,r.selectedColorFn(t))}),r.selectedSizeFn&&n.push(function(e,t){var i=t.mx||o.symbol||0,n=r.selectedSizeFn(t);e.attr("d",a(T.symbolNumber(i),n)),t.mrc2=n}),n.length&&e.each(function(e){for(var t=c.select(this),a=0;a<n.length;a++)n[a](t,e)})}},T.tryColorscale=function(e,t){var a=t?h.nestedProperty(e,t).get():e;if(a){var r=a.color;if((a.colorscale||a._colorAx)&&h.isArrayOrTypedArray(r))return g.makeColorScaleFuncFromTrace(a)}return h.identity};var z={start:1,end:-1,middle:0,bottom:1,top:-1};T.textPointStyle=function(e,t,a){if(e.size()){var i;if(t.selectedpoints){var n=T.makeSelectedTextStyleFns(t);i=n.selectedTextColorFn}e.each(function(e){var n=c.select(this),l=h.extractOption(e,t,"tx","text");if(!l&&0!==l)return void n.remove();var s=e.tp||t.textposition,d=o(e,t),p=i?i(e):e.tc||t.textfont.color;n.call(T.font,e.tf||t.textfont.family,d,p).text(l).call(m.convertToTspans,a).call(r,s,d,e.mrc)})}},T.selectedTextStyle=function(e,t){if(e.size()&&t.selectedpoints){var a=T.makeSelectedTextStyleFns(t);e.each(function(e){var i=c.select(this),n=a.selectedTextColorFn(e),l=e.tp||t.textposition,s=o(e,t);u.fill(i,n),r(i,l,s,e.mrc2||e.mrc)})}};var P=.5;T.smoothopen=function(e,t){if(3>e.length)return"M"+e.join("L");var a="M"+e[0],r=[],o;for(o=1;o<e.length-1;o++)r.push(n(e[o-1],e[o],e[o+1],t));for(a+="Q"+r[0][0]+" "+e[1],o=2;o<e.length-1;o++)a+="C"+r[o-2][1]+" "+r[o-1][0]+" "+e[o];return a+="Q"+r[e.length-3][1]+" "+e[e.length-1],a},T.smoothclosed=function(e,t){if(3>e.length)return"M"+e.join("L")+"Z";var a="M"+e[0],r=e.length-1,o=[n(e[r],e[0],e[1],t)],l;for(l=1;l<r;l++)o.push(n(e[l-1],e[l],e[l+1],t));for(o.push(n(e[r-1],e[r],e[0],t)),l=1;l<=r;l++)a+="C"+o[l-1][1]+" "+o[l][0]+" "+e[l];return a+="C"+o[r][1]+" "+o[0][0]+" "+e[0]+"Z",a};var D={hv:function(e,t){return"H"+c.round(t[0],2)+"V"+c.round(t[1],2)},vh:function(e,t){return"V"+c.round(t[1],2)+"H"+c.round(t[0],2)},hvh:function(e,t){return"H"+c.round((e[0]+t[0])/2,2)+"V"+c.round(t[1],2)+"H"+c.round(t[0],2)},vhv:function(e,t){return"V"+c.round((e[1]+t[1])/2,2)+"H"+c.round(t[0],2)+"V"+c.round(t[1],2)}},O=function(e,t){return"L"+c.round(t[0],2)+","+c.round(t[1],2)};T.steps=function(e){var t=D[e]||O;return function(e){for(var a="M"+c.round(e[0][0],2)+","+c.round(e[0][1],2),r=1;r<e.length;r++)a+=t(e[r-1],e[r]);return a}},T.makeTester=function(){var e=h.ensureSingleById(c.select("body"),"svg","js-plotly-tester",function(e){e.attr(y.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),t=h.ensureSingle(e,"path","js-reference-point",function(e){e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});T.tester=e,T.testref=t},T.savedBBoxes={};var R=0;T.bBox=function(e,t,a){a||(a=l(e));var r;if(a){if(r=T.savedBBoxes[a],r)return h.extendFlat({},r);}else if(1===e.childNodes.length){var o=e.childNodes[0];if(a=l(o),a){var i=+o.getAttribute("x")||0,n=+o.getAttribute("y")||0,s=o.getAttribute("transform");if(!s){var d=T.bBox(o,!1,a);return i&&(d.left+=i,d.right+=i),n&&(d.top+=n,d.bottom+=n),d}if(a+="~"+i+"~"+n+"~"+s,r=T.savedBBoxes[a],r)return h.extendFlat({},r)}}var p,u;t?p=e:(u=T.tester.node(),p=e.cloneNode(!0),u.appendChild(p)),c.select(p).attr("transform",null).call(m.positionText,0,0);var g=p.getBoundingClientRect(),y=T.testref.node().getBoundingClientRect();t||u.removeChild(p);var f={height:g.height,width:g.width,left:g.left-y.left,top:g.top-y.top,right:g.right-y.left,bottom:g.bottom-y.top};return R>=1e4&&(T.savedBBoxes={},R=0),a&&(T.savedBBoxes[a]=f),R++,h.extendFlat({},f)},T.setClipUrl=function(e,t,a){e.attr("clip-path",d(t,a))},T.getTranslate=function(e){var t=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,a=e.attr?"attr":"getAttribute",r=e[a]("transform")||"",o=r.replace(t,function(e,t,a){return[t,a].join(" ")}).split(" ");return{x:+o[0]||0,y:+o[1]||0}},T.setTranslate=function(e,t,a){var r=/(\btranslate\(.*?\);?)/,o=e.attr?"attr":"getAttribute",i=e.attr?"attr":"setAttribute",n=e[o]("transform")||"";return t=t||0,a=a||0,n=n.replace(r,"").trim(),n+=" translate("+t+", "+a+")",n=n.trim(),e[i]("transform",n),n},T.getScale=function(e){var t=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,a=e.attr?"attr":"getAttribute",r=e[a]("transform")||"",o=r.replace(t,function(e,t,a){return[t,a].join(" ")}).split(" ");return{x:+o[0]||1,y:+o[1]||1}},T.setScale=function(e,t,a){var r=/(\bscale\(.*?\);?)/,o=e.attr?"attr":"getAttribute",i=e.attr?"attr":"setAttribute",n=e[o]("transform")||"";return t=t||1,a=a||1,n=n.replace(r,"").trim(),n+=" scale("+t+", "+a+")",n=n.trim(),e[i]("transform",n),n};var M=/\s*sc.*/;T.setPointGroupScale=function(e,t,a){if(t=t||1,a=a||1,!!e){var r=1===t&&1===a?"":" scale("+t+","+a+")";e.each(function(){var e=(this.getAttribute("transform")||"").replace(M,"");e+=r,e=e.trim(),this.setAttribute("transform",e)})}};var j=/translate\([^)]*\)\s*$/;T.setTextPointsScale=function(e,t,a){e&&e.each(function(){var e=c.select(this),r=e.select("text"),o;if(r.node()){var i=parseFloat(r.attr("x")||0),n=parseFloat(r.attr("y")||0),l=(e.attr("transform")||"").match(j);o=1===t&&1===a?[]:["translate("+i+","+n+")","scale("+t+","+a+")","translate("+-i+","+-n+")"],l&&o.push(l),e.attr("transform",o.join(" "))}})}},{"../../constants/alignment":688,"../../constants/interactions":694,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../lib/svg_text_utils":743,"../../registry":847,"../../traces/scatter/make_bubble_size_func":1128,"../../traces/scatter/subtypes":1135,"../color":593,"../colorscale":605,"./symbol_defs":615,d3:163,"fast-isnumeric":225,tinycolor2:537}],615:[function(e,t){"use strict";var o=e("d3");t.exports={circle:{n:0,f:function(e){var t=o.round(e,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(e){var t=o.round(1.3*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(e){var t=o.round(.4*e,2),a=o.round(1.2*e,2);return"M"+a+","+t+"H"+t+"V"+a+"H-"+t+"V"+t+"H-"+a+"V-"+t+"H-"+t+"V-"+a+"H"+t+"V-"+t+"H"+a+"Z"}},x:{n:4,f:function(e){var t=o.round(.8*e/N(2),2),a="l"+t+","+t,r="l"+t+",-"+t,i="l-"+t+",-"+t,n="l-"+t+","+t;return"M0,"+t+a+r+i+r+i+n+i+n+a+n+a+"Z"}},"triangle-up":{n:5,f:function(e){var t=o.round(2*e/N(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M-"+t+","+a+"H"+t+"L0,-"+r+"Z"}},"triangle-down":{n:6,f:function(e){var t=o.round(2*e/N(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M-"+t+",-"+a+"H"+t+"L0,"+r+"Z"}},"triangle-left":{n:7,f:function(e){var t=o.round(2*e/N(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M"+a+",-"+t+"V"+t+"L-"+r+",0Z"}},"triangle-right":{n:8,f:function(e){var t=o.round(2*e/N(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M-"+a+",-"+t+"V"+t+"L"+r+",0Z"}},"triangle-ne":{n:9,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M-"+a+",-"+t+"H"+t+"V"+a+"Z"}},"triangle-se":{n:10,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M"+t+",-"+a+"V"+t+"H-"+a+"Z"}},"triangle-sw":{n:11,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M"+a+","+t+"H-"+t+"V-"+a+"Z"}},"triangle-nw":{n:12,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M-"+t+","+a+"V-"+t+"H"+a+"Z"}},pentagon:{n:13,f:function(e){var t=o.round(.951*e,2),a=o.round(.588*e,2),r=o.round(-e,2),i=o.round(-.309*e,2),n=o.round(.809*e,2);return"M"+t+","+i+"L"+a+","+n+"H-"+a+"L-"+t+","+i+"L0,"+r+"Z"}},hexagon:{n:14,f:function(e){var t=o.round(e,2),a=o.round(e/2,2),r=o.round(e*N(3)/2,2);return"M"+r+",-"+a+"V"+a+"L0,"+t+"L-"+r+","+a+"V-"+a+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(e){var t=o.round(e,2),a=o.round(e/2,2),r=o.round(e*N(3)/2,2);return"M-"+a+","+r+"H"+a+"L"+t+",0L"+a+",-"+r+"H-"+a+"L-"+t+",0Z"}},octagon:{n:16,f:function(e){var t=o.round(.924*e,2),a=o.round(.383*e,2);return"M-"+a+",-"+t+"H"+a+"L"+t+",-"+a+"V"+a+"L"+a+","+t+"H-"+a+"L-"+t+","+a+"V-"+a+"Z"}},star:{n:17,f:function(e){var t=1.4*e,a=o.round(.225*t,2),r=o.round(.951*t,2),i=o.round(.363*t,2),n=o.round(.588*t,2),l=o.round(-t,2),s=o.round(-.309*t,2),d=o.round(.118*t,2),c=o.round(.809*t,2),p=o.round(.382*t,2);return"M"+a+","+s+"H"+r+"L"+i+","+d+"L"+n+","+c+"L0,"+p+"L-"+n+","+c+"L-"+i+","+d+"L-"+r+","+s+"H-"+a+"L0,"+l+"Z"}},hexagram:{n:18,f:function(e){var t=o.round(.66*e,2),a=o.round(.38*e,2),r=o.round(.76*e,2);return"M-"+r+",0l-"+a+",-"+t+"h"+r+"l"+a+",-"+t+"l"+a+","+t+"h"+r+"l-"+a+","+t+"l"+a+","+t+"h-"+r+"l-"+a+","+t+"l-"+a+",-"+t+"h-"+r+"Z"}},"star-triangle-up":{n:19,f:function(e){var t=o.round(.8*(e*N(3)),2),a=o.round(.8*e,2),r=o.round(1.6*e,2),i=o.round(4*e,2),n="A "+i+","+i+" 0 0 1 ";return"M-"+t+","+a+n+t+","+a+n+"0,-"+r+n+"-"+t+","+a+"Z"}},"star-triangle-down":{n:20,f:function(e){var t=o.round(.8*(e*N(3)),2),a=o.round(.8*e,2),r=o.round(1.6*e,2),i=o.round(4*e,2),n="A "+i+","+i+" 0 0 1 ";return"M"+t+",-"+a+n+"-"+t+",-"+a+n+"0,"+r+n+t+",-"+a+"Z"}},"star-square":{n:21,f:function(e){var t=o.round(1.1*e,2),a=o.round(2*e,2),r="A "+a+","+a+" 0 0 1 ";return"M-"+t+",-"+t+r+"-"+t+","+t+r+t+","+t+r+t+",-"+t+r+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(e){var t=o.round(1.4*e,2),a=o.round(1.9*e,2),r="A "+a+","+a+" 0 0 1 ";return"M-"+t+",0"+r+"0,"+t+r+t+",0"+r+"0,-"+t+r+"-"+t+",0Z"}},"diamond-tall":{n:23,f:function(e){var t=o.round(.7*e,2),a=o.round(1.4*e,2);return"M0,"+a+"L"+t+",0L0,-"+a+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(e){var t=o.round(1.4*e,2),a=o.round(.7*e,2);return"M0,"+a+"L"+t+",0L0,-"+a+"L-"+t+",0Z"}},hourglass:{n:25,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:!0},bowtie:{n:26,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:!0},"circle-cross":{n:27,f:function(e){var t=o.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(e){var t=o.round(e,2),a=o.round(e/N(2),2);return"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(e){var t=o.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(e){var t=o.round(1.3*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(e){var t=o.round(1.3*e,2),a=o.round(.65*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM-"+a+",-"+a+"L"+a+","+a+"M-"+a+","+a+"L"+a+",-"+a},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(e){var t=o.round(1.4*e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(e){var t=o.round(1.2*e,2),a=o.round(.85*e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(e){var t=o.round(e/2,2),a=o.round(e,2);return"M"+t+","+a+"V-"+a+"m-"+a+",0V"+a+"M"+a+","+t+"H-"+a+"m0,-"+a+"H"+a},needLine:!0,noFill:!0},"y-up":{n:37,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+t+","+r+"L0,0M"+t+","+r+"L0,0M0,-"+a+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+t+",-"+r+"L0,0M"+t+",-"+r+"L0,0M0,"+a+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M"+r+","+t+"L0,0M"+r+",-"+t+"L0,0M-"+a+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+r+","+t+"L0,0M-"+r+",-"+t+"L0,0M"+a+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(e){var t=o.round(1.4*e,2);return"M"+t+",0H-"+t},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(e){var t=o.round(1.4*e,2);return"M0,"+t+"V-"+t},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(e){var t=o.round(e,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:!0,noDot:!0,noFill:!0}}},{d3:163}],616:[function(e,t){"use strict";t.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],617:[function(e,t){"use strict";function a(e,t,a,o){var d=t["error_"+o]||{},c=d.visible&&-1!==["linear","log"].indexOf(a.type),p=[];if(c){for(var u=s(d),g=0;g<e.length;g++){var h=e[g],m=h.i;if(void 0===m)m=g;else if(null===m)continue;var y=h[o];if(r(a.c2l(y))){var f=u(y,m);if(r(f[0])&&r(f[1])){var x=h[o+"s"]=y-f[0],_=h[o+"h"]=y+f[1];p.push(x,_)}}}var b=a._id,v=t._extremes[b],k=n.findExtremes(a,p,l.extendFlat({tozero:v.opts.tozero},{padded:!0}));v.min=v.min.concat(k.min),v.max=v.max.concat(k.max)}}var r=e("fast-isnumeric"),o=e("../../registry"),n=e("../../plots/cartesian/axes"),l=e("../../lib"),s=e("./compute_error");t.exports=function(e){for(var t=e.calcdata,r=0;r<t.length;r++){var l=t[r],s=l[0].trace;if(!0===s.visible&&o.traceIs(s,"errorBarsOK")){var d=n.getFromId(e,s.xaxis),c=n.getFromId(e,s.yaxis);a(l,s,d,"x"),a(l,s,c,"y")}}}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":847,"./compute_error":618,"fast-isnumeric":225}],618:[function(e,t){"use strict";function a(e,t){return"percent"===e?function(e){return _a(e*t/100)}:"constant"===e?function(){return _a(t)}:"sqrt"===e?function(e){return N(_a(e))}:void 0}t.exports=function(e){var t=e.type,r=e.symmetric;if("data"===t){var o=e.array||[];if(r)return function(e,t){var a=+o[t];return[a,a]};var i=e.arrayminus||[];return function(e,t){var a=+o[t],r=+i[t];return isNaN(a)&&isNaN(r)?[NaN,NaN]:[r||0,a||0]}}var n=a(t,e.value),l=a(t,e.valueminus);return r||void 0===e.valueminus?function(e){var t=n(e);return[t,t]}:function(e){return[l(e),n(e)]}}},{}],619:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../registry"),o=e("../../lib"),i=e("../../plot_api/plot_template"),n=e("./attributes");t.exports=function(e,t,l,s){function d(e,t){return o.coerce(u,p,n,e,t)}var c="error_"+s.axis,p=i.newContainer(t,c),u=e[c]||{},g=u.array!==void 0||u.value!==void 0||"sqrt"===u.type,h=d("visible",g);if(!1!==h){var m=d("type","array"in u?"data":"percent"),y=!0;"sqrt"!==m&&(y=d("symmetric",!(("data"===m?"arrayminus":"valueminus")in u))),"data"===m?(d("array"),d("traceref"),!y&&(d("arrayminus"),d("tracerefminus"))):("percent"===m||"constant"===m)&&(d("value"),!y&&d("valueminus"));var f="copy_"+s.inherit+"style";if(s.inherit){var x=t["error_"+s.inherit];(x||{}).visible&&d(f,!(u.color||a(u.thickness)||a(u.width)))}s.inherit&&p[f]||(d("color",l),d("thickness"),d("width",r.traceIs(t,"gl3d")?0:4))}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../registry":847,"./attributes":616,"fast-isnumeric":225}],620:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../plot_api/edit_types").overrideAll,o=e("./attributes"),i={error_x:a.extendFlat({},o),error_y:a.extendFlat({},o)};delete i.error_x.copy_zstyle,delete i.error_y.copy_zstyle,delete i.error_y.copy_ystyle;var n={error_x:a.extendFlat({},o),error_y:a.extendFlat({},o),error_z:a.extendFlat({},o)};delete n.error_x.copy_ystyle,delete n.error_y.copy_ystyle,delete n.error_z.copy_ystyle,delete n.error_z.copy_zstyle,t.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:i,bar:i,histogram:i,scatter3d:r(n,"calc","nested"),scattergl:r(i,"calc","nested")}},supplyDefaults:e("./defaults"),calc:e("./calc"),makeComputeError:e("./compute_error"),plot:e("./plot"),style:e("./style"),hoverInfo:function(e,t,a){(t.error_y||{}).visible&&(a.yerr=e.yh-e.y,!t.error_y.symmetric&&(a.yerrneg=e.y-e.ys)),(t.error_x||{}).visible&&(a.xerr=e.xh-e.x,!t.error_x.symmetric&&(a.xerrneg=e.x-e.xs))}}},{"../../lib":719,"../../plot_api/edit_types":750,"./attributes":616,"./calc":617,"./compute_error":618,"./defaults":619,"./plot":621,"./style":622}],621:[function(e,t){"use strict";function a(e,t,a){var r={x:t.c2p(e.x),y:a.c2p(e.y)};return void 0!==e.yh&&(r.yh=a.c2p(e.yh),r.ys=a.c2p(e.ys),!o(r.ys)&&(r.noYS=!0,r.ys=a.c2p(e.ys,!0))),void 0!==e.xh&&(r.xh=t.c2p(e.xh),r.xs=t.c2p(e.xs),!o(r.xs)&&(r.noXS=!0,r.xs=t.c2p(e.xs,!0))),r}var r=e("d3"),o=e("fast-isnumeric"),i=e("../drawing"),n=e("../../traces/scatter/subtypes");t.exports=function(e,t,l,s){var c=l.xaxis,p=l.yaxis,d=s&&0<s.duration,u;t.each(function(t){var g=t[0].trace,h=g.error_x||{},m=g.error_y||{},y;g.ids&&(y=function(e){return e.id});var f=n.hasMarkers(g)&&0<g.marker.maxdisplayed;m.visible||h.visible||(t=[]);var x=r.select(this).selectAll("g.errorbar").data(t,y);if(x.exit().remove(),!!t.length){h.visible||x.selectAll("path.xerror").remove(),m.visible||x.selectAll("path.yerror").remove(),x.style("opacity",1);var _=x.enter().append("g").classed("errorbar",!0);d&&_.style("opacity",0).transition().duration(s.duration).style("opacity",1),i.setClipUrl(x,l.layerClipId,e),x.each(function(e){var t=r.select(this),i=a(e,c,p);if(!f||e.vis){var n=t.select("path.yerror"),l;if(m.visible&&o(i.x)&&o(i.yh)&&o(i.ys)){var g=m.width;l="M"+(i.x-g)+","+i.yh+"h"+2*g+"m-"+g+",0V"+i.ys,i.noYS||(l+="m-"+g+",0h"+2*g),u=!n.size(),u?n=t.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):d&&(n=n.transition().duration(s.duration).ease(s.easing)),n.attr("d",l)}else n.remove();var y=t.select("path.xerror");if(h.visible&&o(i.y)&&o(i.xh)&&o(i.xs)){var x=(h.copy_ystyle?m:h).width;l="M"+i.xh+","+(i.y-x)+"v"+2*x+"m0,-"+x+"H"+i.xs,i.noXS||(l+="m0,-"+x+"v"+2*x),u=!y.size(),u?y=t.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):d&&(y=y.transition().duration(s.duration).ease(s.easing)),y.attr("d",l)}else y.remove()}})}})}},{"../../traces/scatter/subtypes":1135,"../drawing":614,d3:163,"fast-isnumeric":225}],622:[function(e,t){"use strict";var a=e("d3"),r=e("../color");t.exports=function(e){e.each(function(e){var t=e[0].trace,o=t.error_y||{},i=t.error_x||{},n=a.select(this);n.selectAll("path.yerror").style("stroke-width",o.thickness+"px").call(r.stroke,o.color),i.copy_ystyle&&(i=o),n.selectAll("path.xerror").style("stroke-width",i.thickness+"px").call(r.stroke,i.color)})}},{"../color":593,d3:163}],623:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("./layout_attributes").hoverlabel,o=e("../../lib/extend").extendFlat;t.exports={hoverlabel:{bgcolor:o({},r.bgcolor,{arrayOk:!0}),bordercolor:o({},r.bordercolor,{arrayOk:!0}),font:a({arrayOk:!0,editType:"none"}),align:o({},r.align,{arrayOk:!0}),namelength:o({},r.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":710,"../../plots/font_attributes":793,"./layout_attributes":633}],624:[function(e,t){"use strict";function a(e,t,a,o){o=o||r.identity,Array.isArray(e)&&(t[0][a]=o(e))}var r=e("../../lib"),o=e("../../registry");t.exports=function(e){function t(e){return function(t){return r.coerceHoverinfo({hoverinfo:t},{_module:e._module},l)}}for(var n=e.calcdata,l=e._fullLayout,s=0;s<n.length;s++){var d=n[s],c=d[0].trace;if(!o.traceIs(c,"pie-like")){var p=o.traceIs(c,"2dMap")?a:r.fillArray;p(c.hoverinfo,d,"hi",t(c)),c.hovertemplate&&p(c.hovertemplate,d,"ht"),c.hoverlabel&&(p(c.hoverlabel.bgcolor,d,"hbg"),p(c.hoverlabel.bordercolor,d,"hbc"),p(c.hoverlabel.font.size,d,"hts"),p(c.hoverlabel.font.color,d,"htc"),p(c.hoverlabel.font.family,d,"htf"),p(c.hoverlabel.namelength,d,"hnl"),p(c.hoverlabel.align,d,"hta"))}}}},{"../../lib":719,"../../registry":847}],625:[function(e,t){"use strict";var a=e("../../registry"),r=e("./hover").hover;t.exports=function(e,t,o){function i(){e.emit("plotly_click",{points:e._hoverdata,event:t})}var n=a.getComponentMethod("annotations","onClick")(e,e._hoverdata);o!==void 0&&r(e,t,o,!0),e._hoverdata&&t&&t.target&&(n&&n.then?n.then(i):i(),t.stopImmediatePropagation&&t.stopImmediatePropagation())}},{"../../registry":847,"./hover":629}],626:[function(e,t){"use strict";t.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],627:[function(e,t){"use strict";var a=e("../../lib"),r=e("./attributes"),o=e("./hoverlabel_defaults");t.exports=function(e,t,i,n){var l=a.extendFlat({},n.hoverlabel);t.hovertemplate&&(l.namelength=-1),o(e,t,function(o,i){return a.coerce(e,t,r,o,i)},l)}},{"../../lib":719,"./attributes":623,"./hoverlabel_defaults":630}],628:[function(e,t,a){"use strict";function r(e){return n[e]||e}function o(e,t){if(!Array.isArray(t))return e[t];else if(Array.isArray(e)&&Array.isArray(e[t[0]]))return e[t[0]][t[1]]}var i=e("../../lib");a.getSubplot=function(e){return e.subplot||e.xaxis+e.yaxis||e.geo},a.isTraceInSubplots=function(e,t){if("splom"===e.type){for(var r=e.xaxes||[],o=e.yaxes||[],n=0;n<r.length;n++)for(var l=0;l<o.length;l++)if(-1!==t.indexOf(r[n]+o[l]))return!0;return!1}return-1!==t.indexOf(a.getSubplot(e))},a.flat=function(e,t){for(var a=Array(e.length),r=0;r<e.length;r++)a[r]=t;return a},a.p2c=function(e,t){for(var a=Array(e.length),r=0;r<e.length;r++)a[r]=e[r].p2c(t);return a},a.getDistanceFunction=function(e,t,r,o){return"closest"===e?o||a.quadrature(t,r):"x"===e?t:r},a.getClosest=function(e,t,a){if(!1!==a.index)0<=a.index&&a.index<e.length?a.distance=0:a.index=!1;else for(var r=0,o;r<e.length;r++)o=t(e[r]),o<=a.distance&&(a.index=r,a.distance=o);return a},a.inbox=function(e,t,a){return 0>e*t||0===e?a:1/0},a.quadrature=function(e,t){return function(a){var r=e(a),o=t(a);return N(r*r+o*o)}},a.makeEventData=function(e,t,r){var o="index"in e?e.index:e.pointNumber,i={data:t._input,fullData:t,curveNumber:t.index,pointNumber:o};if(t._indexToPoints){var n=t._indexToPoints[o];1===n.length?i.pointIndex=n[0]:i.pointIndices=n}else i.pointIndex=o;return t._module.eventData?i=t._module.eventData(i,e,t,r,o):("xVal"in e?i.x=e.xVal:"x"in e&&(i.x=e.x),"yVal"in e?i.y=e.yVal:"y"in e&&(i.y=e.y),e.xa&&(i.xaxis=e.xa),e.ya&&(i.yaxis=e.ya),void 0!==e.zLabelVal&&(i.z=e.zLabelVal)),a.appendArrayPointValue(i,t,o),i},a.appendArrayPointValue=function(e,t,a){var n=t._arrayAttrs;if(n)for(var l=0;l<n.length;l++){var s=n[l],d=r(s);if(void 0===e[d]){var c=i.nestedProperty(t,s).get(),p=o(c,a);void 0!==p&&(e[d]=p)}}},a.appendArrayMultiPointValues=function(e,t,a){var n=t._arrayAttrs;if(n)for(var l=0;l<n.length;l++){var s=n[l],d=r(s);if(void 0===e[d]){for(var c=i.nestedProperty(t,s).get(),p=Array(a.length),u=0;u<a.length;u++)p[u]=o(c,a[u]);e[d]=p}}};var n={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"}},{"../../lib":719}],629:[function(e,t,a){"use strict";function r(e,t,a,r){function u(e,t){for(var a=null,r=1/0,o=0,n;o<e.length;o++)n=e[o].spikeDistance,n<r&&n<=t&&(a=e[o],r=n);return a}function g(e){return e?{xa:e.xa,ya:e.ya,x:void 0===e.xSpike?(e.x0+e.x1)/2:e.xSpike,y:void 0===e.ySpike?(e.y0+e.y1)/2:e.ySpike,distance:e.distance,spikeDistance:e.spikeDistance,curveNumber:e.trace.index,color:e.color,pointNumber:e.index}:null}a||(a="xy");var f=Array.isArray(a)?a:[a],_=e._fullLayout,A=_._plots||[],S=A[a],C=_._has("cartesian");if(S){var L=S.overlays.map(function(e){return e.id});f=f.concat(L)}for(var E=f.length,I=Array(E),z=Array(E),P=!1,D=0;D<E;D++){var O=f[D],R=A[O];if(R){P=!0,I[D]=k.getFromId(e,R.xaxis._id),z[D]=k.getFromId(e,R.yaxis._id);continue}var M=_[O]._subplot;I[D]=M.xaxis,z[D]=M.yaxis}var j=t.hovermode||_.hovermode;if(j&&!P&&(j="closest"),-1===["x","y","closest"].indexOf(j)||!e.calcdata||e.querySelector(".zoombox")||e._dragging)return v.unhoverRaw(e,t);var F=-1===_.hoverdistance?1/0:_.hoverdistance,B=-1===_.spikedistance?1/0:_.spikedistance,N=[],V=[],U={hLinePoint:null,vLinePoint:null},H=!1,G,q,Y,W,X,Z,K,J,Q,$,ee,te,ae;if(Array.isArray(t))for(j="array",Y=0;Y<t.length;Y++)X=e.calcdata[t[Y].curveNumber||0],X&&(Z=X[0].trace,"skip"!==X[0].trace.hoverinfo&&(V.push(X),"h"===Z.orientation&&(H=!0)));else{for(W=0;W<e.calcdata.length;W++)X=e.calcdata[W],Z=X[0].trace,"skip"!==Z.hoverinfo&&T.isTraceInSubplots(Z,f)&&(V.push(X),"h"===Z.orientation&&(H=!0));var re=!t.target,oe,ie;if(re)oe="xpx"in t?t.xpx:I[0]._length/2,ie="ypx"in t?t.ypx:z[0]._length/2;else{if(!1===y.triggerHandler(e,"plotly_beforehover",t))return;var ne=t.target.getBoundingClientRect();if(oe=t.clientX-ne.left,ie=t.clientY-ne.top,0>oe||oe>I[0]._length||0>ie||ie>z[0]._length)return v.unhoverRaw(e,t)}if(t.pointerX=oe+I[0]._offset,t.pointerY=ie+z[0]._offset,G="xval"in t?T.flat(f,t.xval):T.p2c(I,oe),q="yval"in t?T.flat(f,t.yval):T.p2c(z,ie),!i(G[0])||!i(q[0]))return m.warn("Fx.hover failed",t,e),v.unhoverRaw(e,t)}var le=1/0;for(W=0;W<V.length;W++)if(X=V[W],X&&X[0]&&X[0].trace&&(Z=X[0].trace,!0===Z.visible&&0!==Z._length&&-1===["carpet","contourcarpet"].indexOf(Z._module.name))){if("splom"===Z.type?(J=0,K=f[J]):(K=T.getSubplot(Z),J=f.indexOf(K)),Q=j,te={cd:X,trace:Z,xa:I[J],ya:z[J],maxHoverDistance:F,maxSpikeDistance:B,index:!1,distance:ea(le,F),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:b.defaultLine,name:Z.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},_[K]&&(te.subplot=_[K]._subplot),_._splomScenes&&_._splomScenes[Z.uid]&&(te.scene=_._splomScenes[Z.uid]),ae=N.length,"array"===Q){var se=t[W];"pointNumber"in se?(te.index=se.pointNumber,Q="closest"):(Q="","xval"in se&&($=se.xval,Q="x"),"yval"in se&&(ee=se.yval,Q=Q?"closest":"y"))}else $=G[J],ee=q[J];if(0!==F)if(Z._module&&Z._module.hoverPoints){var de=Z._module.hoverPoints(te,$,ee,Q,_._hoverlayer);if(de)for(var ce=0,pe;ce<de.length;ce++)pe=de[ce],i(pe.x0)&&i(pe.y0)&&N.push(s(pe,j))}else m.log("Unrecognized trace type in hover:",Z);if("closest"===j&&N.length>ae&&(N.splice(0,ae),le=N[0].distance),C&&0!==B&&0===N.length){te.distance=B,te.index=!1;var ue=Z._module.hoverPoints(te,$,ee,"closest",_._hoverlayer);if(ue&&(ue=ue.filter(function(e){return e.spikeDistance<=B})),ue&&ue.length){var ge=ue.filter(function(e){return e.xa.showspikes}),he;if(ge.length){var me=ge[0];i(me.x0)&&i(me.y0)&&(he=g(me),(!U.vLinePoint||U.vLinePoint.spikeDistance>he.spikeDistance)&&(U.vLinePoint=he))}var ye=ue.filter(function(e){return e.ya.showspikes});if(ye.length){var fe=ye[0];i(fe.x0)&&i(fe.y0)&&(he=g(fe),(!U.hLinePoint||U.hLinePoint.spikeDistance>he.spikeDistance)&&(U.hLinePoint=he))}}}}var xe={fullLayout:_,container:_._hoverlayer,outerContainer:_._paperdiv,event:t},_e=e._spikepoints,be={vLinePoint:U.vLinePoint,hLinePoint:U.hLinePoint};if(e._spikepoints=be,C&&0!==B&&0!==N.length){var ve=N.filter(function(e){return e.ya.showspikes}),ke=u(ve,B);U.hLinePoint=g(ke);var we=N.filter(function(e){return e.xa.showspikes}),Te=u(we,B);U.vLinePoint=g(Te)}if(0===N.length){var Ae=v.unhoverRaw(e,t);return C&&(null!==U.hLinePoint||null!==U.vLinePoint)&&p(_e)&&d(U,xe),Ae}C&&p(_e)&&d(U,xe),N.sort(function(e,t){return e.distance-t.distance});var Se=e._hoverdata,Ce=[];for(Y=0;Y<N.length;Y++){var Le=N[Y],Ee=T.makeEventData(Le,Le.trace,Le.cd);if(!1!==Le.hovertemplate){var Ie=!1;Le.cd[Le.index]&&Le.cd[Le.index].ht&&(Ie=Le.cd[Le.index].ht),Le.hovertemplate=Ie||Le.trace.hovertemplate||!1}Le.eventData=[Ee],Ce.push(Ee)}e._hoverdata=Ce;var ze="y"===j&&(1<V.length||1<N.length)||"closest"===j&&H&&1<N.length,Pe=b.combine(_.plot_bgcolor||b.background,_.paper_bgcolor),De={hovermode:j,rotateLabels:ze,bgColor:Pe,container:_._hoverlayer,outerContainer:_._paperdiv,commonLabelOpts:_.hoverlabel,hoverdistance:_.hoverdistance},Oe=o(N,De,e);if(n(Oe,ze?"xa":"ya",_),l(Oe,ze),t.target&&t.target.tagName){var Re=w.getComponentMethod("annotations","hasClickToShow")(e,Ce);x(h.select(t.target),Re?"pointer":"")}t.target&&!r&&c(e,t,Se)&&(Se&&e.emit("plotly_unhover",{event:t,points:Se}),e.emit("plotly_hover",{event:t,points:e._hoverdata,xaxes:I,yaxes:z,xvals:G,yvals:q}))}function o(e,t,a){var r=a._fullLayout,o=t.hovermode,n=t.rotateLabels,l=t.bgColor,s=t.container,d=t.outerContainer,c=t.commonLabelOpts||{},p=t.fontFamily||A.HOVERFONT,y=t.fontSize||A.HOVERFONTSIZE,x=e[0],g=x.xa,v=x.ya,k="y"===o?"yLabel":"xLabel",w=x[k],T=(w+""||"").split(" ")[0],C=d.node().getBoundingClientRect(),L=C.top,E=C.width,I=C.height,O=void 0!==w&&x.distance<=t.hoverdistance&&("x"===o||"y"===o);if(O){var R=!0,M,j;for(M=0;M<e.length;M++)if(R&&void 0===e[M].zLabel&&(R=!1),j=e[M].hoverinfo||e[M].trace.hoverinfo,j){var F=Array.isArray(j)?j:j.split("+");if(-1===F.indexOf("all")&&-1===F.indexOf(o)){O=!1;break}}R&&(O=!1)}var B=s.selectAll("g.axistext").data(O?[0]:[]);B.enter().append("g").classed("axistext",!0),B.exit().remove(),B.each(function(){var t=h.select(this),r=m.ensureSingle(t,"path","",function(e){e.style({"stroke-width":"1px"})}),i=m.ensureSingle(t,"text","",function(e){e.attr("data-notex",1)}),n=c.bgcolor||b.defaultLine,l=c.bordercolor||b.contrast(n),s=b.contrast(n);r.style({fill:n,stroke:l}),i.text(w).call(_.font,c.font.family||p,c.font.size||y,c.font.color||s).call(f.positionText,0,0).call(f.convertToTspans,a),t.attr("transform","");var d=i.node().getBoundingClientRect();if("x"===o){i.attr("text-anchor","middle").call(f.positionText,0,"top"===g.side?L-d.bottom-z-P:L-d.top+z+P);var u="top"===g.side?"-":"";r.attr("d","M0,0L"+z+","+u+z+"H"+(P+d.width/2)+"v"+u+(2*P+d.height)+"H-"+(P+d.width/2)+"V"+u+z+"H-"+z+"Z"),t.attr("transform","translate("+(g._offset+(x.x0+x.x1)/2)+","+(v._offset+("top"===g.side?0:v._length))+")")}else{i.attr("text-anchor","right"===v.side?"start":"end").call(f.positionText,("right"===v.side?1:-1)*(P+z),L-d.top-d.height/2);var A="right"===v.side?"":"-";r.attr("d","M0,0L"+A+z+","+z+"V"+(P+d.height/2)+"h"+A+(2*P+d.width)+"V-"+(P+d.height/2)+"H"+A+z+"V-"+z+"Z"),t.attr("transform","translate("+(g._offset+("right"===v.side?g._length:0))+","+(v._offset+(x.y0+x.y1)/2)+")")}e=e.filter(function(e){return void 0!==e.zLabelVal||(e[k]||"").split(" ")[0]===T})});var N=s.selectAll("g.hovertext").data(e,function(e){return[e.trace.index,e.index,e.x0,e.y0,e.name,e.attr,e.xa,e.ya||""].join(",")});return N.enter().append("g").classed("hovertext",!0).each(function(){var e=h.select(this);e.append("rect").call(b.fill,b.addOpacity(l,.8)),e.append("text").classed("name",!0),e.append("path").style("stroke-width","1px"),e.append("text").classed("nums",!0).call(_.font,p,y)}),N.exit().remove(),N.each(function(e){var t=h.select(this).attr("transform",""),i="",s="",d=e.bgcolor||e.color,c=b.combine(b.opacity(d)?d:b.defaultLine,l),g=b.combine(b.opacity(e.color)?e.color:b.defaultLine,l),x=e.borderColor||b.contrast(c);void 0!==e.nameOverride&&(e.name=e.nameOverride),e.name&&(e.trace._meta&&(e.name=m.templateString(e.name,e.trace._meta)),i=u(e.name,e.nameLength)),void 0===e.zLabel?O&&e[o+"Label"]===w?s=e[("x"===o?"y":"x")+"Label"]||"":void 0===e.xLabel?void 0!==e.yLabel&&"scattercarpet"!==e.trace.type&&(s=e.yLabel):void 0===e.yLabel?s=e.xLabel:s="("+e.xLabel+", "+e.yLabel+")":(void 0!==e.xLabel&&(s+="x: "+e.xLabel+"<br>"),void 0!==e.yLabel&&(s+="y: "+e.yLabel+"<br>"),"choropleth"!==e.trace.type&&"choroplethmapbox"!==e.trace.type&&(s+=(s?"z: ":"")+e.zLabel)),(e.text||0===e.text)&&!Array.isArray(e.text)&&(s+=(s?"<br>":"")+e.text),void 0!==e.extraText&&(s+=(s?"<br>":"")+e.extraText),""!==s||e.hovertemplate||(""===i&&t.remove(),s=i);var v=r._d3locale,k=e.hovertemplate||!1,T=e.hovertemplateLabels||e,A=e.eventData[0]||{};k&&(s=m.hovertemplateString(k,T,v,A,e.trace._meta),s=s.replace(D,function(t,a){return i=u(a,e.nameLength),""}));var C=t.select("text.nums").call(_.font,e.fontFamily||p,e.fontSize||y,e.fontColor||x).text(s).attr("data-notex",1).call(f.positionText,0,0).call(f.convertToTspans,a),R=t.select("text.name"),M=0,j=0;if(i&&i!==s){R.call(_.font,e.fontFamily||p,e.fontSize||y,g).text(i).attr("data-notex",1).call(f.positionText,0,0).call(f.convertToTspans,a);var F=R.node().getBoundingClientRect();M=F.width+2*P,j=F.height+2*P}else R.remove(),t.select("rect").remove();t.select("path").style({fill:c,stroke:x});var B=C.node().getBoundingClientRect(),N=e.xa._offset+(e.x0+e.x1)/2,V=e.ya._offset+(e.y0+e.y1)/2,U=_a(e.x1-e.x0),H=_a(e.y1-e.y0),G=B.width+z+P+M,q,Y;if(e.ty0=L-B.top,e.bx=B.width+2*P,e.by=va(B.height+2*P,j),e.anchor="start",e.txwidth=B.width,e.tx2width=M,e.offset=0,n)e.pos=N,q=V+H/2+G<=I,Y=0<=V-H/2-G,("top"===e.idealAlign||!q)&&Y?(V-=H/2,e.anchor="end"):q?(V+=H/2,e.anchor="start"):e.anchor="middle";else if(e.pos=V,q=N+U/2+G<=E,Y=0<=N-U/2-G,("left"===e.idealAlign||!q)&&Y)N-=U/2,e.anchor="end";else if(q)N+=U/2,e.anchor="start";else{e.anchor="middle";var W=G/2,X=N+W-E,Z=N-W;0<X&&(N-=X),0>Z&&(N+=-Z)}C.attr("text-anchor",e.anchor),M&&R.attr("text-anchor",e.anchor),t.attr("transform","translate("+N+","+V+")"+(n?"rotate("+S+")":""))}),N}function n(e,t,a){function r(e){var t=e[0],a=e[e.length-1];if(p=t.pmin-t.pos-t.dp+t.size,u=a.pos+a.dp+a.size-t.pmax,.01<p){for(h=e.length-1;0<=h;h--)e[h].dp+=p;d=!1}if(!(.01>u)){if(-.01>p){for(h=e.length-1;0<=h;h--)e[h].dp-=u;d=!1}if(d){var r=0;for(g=0;g<e.length;g++)m=e[g],m.pos+m.dp+m.size>t.pmax&&r++;for(g=e.length-1;0<=g&&!(0>=r);g--)m=e[g],m.pos>t.pmax-1&&(m.del=!0,r--);for(g=0;g<e.length&&!(0>=r);g++)if(m=e[g],m.pos<t.pmin+1)for(m.del=!0,r--,u=2*m.size,h=e.length-1;0<=h;h--)e[h].dp-=u;for(g=e.length-1;0<=g&&!(0>=r);g--)m=e[g],m.pos+m.dp+m.size>t.pmax&&(m.del=!0,r--)}}}var o=0,n=1,l=e.size(),s=Array(l),c=0;e.each(function(e){var r=e[t],o="x"===r._id.charAt(0),i=r.range;0===c&&i&&i[0]>i[1]!==o&&(n=-1),s[c++]=[{datum:e,traceIndex:e.trace.index,dp:0,pos:e.pos,posref:e.posref,size:e.by*(o?L:1)/2,pmin:0,pmax:o?a.width:a.height}]}),s.sort(function(e,t){return e[0].posref-t[0].posref||n*(t[0].traceIndex-e[0].traceIndex)});for(var d,p,u,g,h,m,y;!d&&o<=l;){for(o++,d=!0,g=0;g<s.length-1;){var f=s[g],x=s[g+1],_=f[f.length-1],b=x[0];if(p=_.pos+_.dp+_.size-b.pos-b.dp+b.size,.01<p&&_.pmin===b.pmin&&_.pmax===b.pmax){for(h=x.length-1;0<=h;h--)x[h].dp+=p;for(f.push.apply(f,x),s.splice(g+1,1),y=0,h=f.length-1;0<=h;h--)y+=f[h].dp;for(u=y/f.length,h=f.length-1;0<=h;h--)f[h].dp-=u;d=!1}else g++}s.forEach(r)}for(g=s.length-1;0<=g;g--){var v=s[g];for(h=v.length-1;0<=h;h--){var w=v[h],T=w.datum;T.offset=w.dp,T.del=w.del}}}function l(e,t){e.each(function(e){var a=h.select(this);if(e.del)return a.remove();var r=a.select("text.nums"),o=e.anchor,i="end"===o?-1:1,n={start:1,end:-1,middle:0}[o],l=n*(z+P),s=l+n*(e.txwidth+P),d=0,c=e.offset;"middle"===o&&(l-=e.tx2width/2,s+=e.txwidth/2+P),t&&(c*=-I,d=e.offset*E),a.select("path").attr("d","middle"===o?"M-"+(e.bx/2+e.tx2width/2)+","+(c-e.by/2)+"h"+e.bx+"v"+e.by+"h-"+e.bx+"Z":"M0,0L"+(i*z+d)+","+(z+c)+"v"+(e.by/2-z)+"h"+i*e.bx+"v-"+e.by+"H"+(i*z+d)+"V"+(c-z)+"Z");var p=l+d,u=c+e.ty0-e.by/2+P,g=e.textAlign||"auto";"auto"!==g&&("left"===g&&"start"!==o?(r.attr("text-anchor","start"),p="middle"===o?-e.bx/2-e.tx2width/2+P:-e.bx-P):"right"===g&&"end"!==o&&(r.attr("text-anchor","end"),p="middle"===o?e.bx/2-e.tx2width/2-P:e.bx+P)),r.call(f.positionText,p,u),e.tx2width&&(a.select("text.name").call(f.positionText,s+n*P+d,c+e.ty0-e.by/2+P),a.select("rect").call(_.setRect,s+(n-1)*e.tx2width/2+d,c-e.by/2-1,e.tx2width,e.by+2))})}function s(e,t){function a(e){return e||i(e)&&0===e}function r(t,r,o){var i=d(r,o);a(i)&&(e[t]=i)}var o=e.index,n=e.trace||{},l=e.cd[0],s=e.cd[o]||{},d=Array.isArray(o)?function(e,t){var r=m.castOption(l,o,e);return a(r)?r:m.extractOption({},n,"",t)}:function(e,t){return m.extractOption(s,n,e,t)};if(r("hoverinfo","hi","hoverinfo"),r("bgcolor","hbg","hoverlabel.bgcolor"),r("borderColor","hbc","hoverlabel.bordercolor"),r("fontFamily","htf","hoverlabel.font.family"),r("fontSize","hts","hoverlabel.font.size"),r("fontColor","htc","hoverlabel.font.color"),r("nameLength","hnl","hoverlabel.namelength"),r("textAlign","hta","hoverlabel.align"),e.posref="y"===t||"closest"===t&&"h"===n.orientation?e.xa._offset+(e.x0+e.x1)/2:e.ya._offset+(e.y0+e.y1)/2,e.x0=m.constrain(e.x0,0,e.xa._length),e.x1=m.constrain(e.x1,0,e.xa._length),e.y0=m.constrain(e.y0,0,e.ya._length),e.y1=m.constrain(e.y1,0,e.ya._length),void 0!==e.xLabelVal&&(e.xLabel="xLabel"in e?e.xLabel:k.hoverLabelText(e.xa,e.xLabelVal),e.xVal=e.xa.c2d(e.xLabelVal)),void 0!==e.yLabelVal&&(e.yLabel="yLabel"in e?e.yLabel:k.hoverLabelText(e.ya,e.yLabelVal),e.yVal=e.ya.c2d(e.yLabelVal)),void 0!==e.zLabelVal&&void 0===e.zLabel&&(e.zLabel=e.zLabelVal+""),!isNaN(e.xerr)&&!("log"===e.xa.type&&0>=e.xerr)){var c=k.tickText(e.xa,e.xa.c2l(e.xerr),"hover").text;e.xLabel+=void 0===e.xerrneg?" \xB1 "+c:" +"+c+" / -"+k.tickText(e.xa,e.xa.c2l(e.xerrneg),"hover").text,"x"===t&&(e.distance+=1)}if(!isNaN(e.yerr)&&!("log"===e.ya.type&&0>=e.yerr)){var p=k.tickText(e.ya,e.ya.c2l(e.yerr),"hover").text;e.yLabel+=void 0===e.yerrneg?" \xB1 "+p:" +"+p+" / -"+k.tickText(e.ya,e.ya.c2l(e.yerrneg),"hover").text,"y"===t&&(e.distance+=1)}var u=e.hoverinfo||e.trace.hoverinfo;return u&&"all"!==u&&(u=Array.isArray(u)?u:u.split("+"),-1===u.indexOf("x")&&(e.xLabel=void 0),-1===u.indexOf("y")&&(e.yLabel=void 0),-1===u.indexOf("z")&&(e.zLabel=void 0),-1===u.indexOf("text")&&(e.text=void 0),-1===u.indexOf("name")&&(e.name=void 0)),e}function d(e,t){var a=t.container,r=t.fullLayout,o=t.event,i=!!e.hLinePoint,n=!!e.vLinePoint,l,s;if(a.selectAll(".spikeline").remove(),!!(n||i)){var d=b.combine(r.plot_bgcolor,r.paper_bgcolor);if(i){var c=e.hLinePoint,p,u;l=c&&c.xa,s=c&&c.ya;var h=s.spikesnap;"cursor"===h?(p=o.pointerX,u=o.pointerY):(p=l._offset+c.x,u=s._offset+c.y);var m=1.5>g.readability(c.color,d)?b.contrast(d):c.color,y=s.spikemode,f=s.spikethickness,x=s.spikecolor||m,v=s._boundingBox,k=(v.left+v.right)/2<p?v.right:v.left,w,T;(-1!==y.indexOf("toaxis")||-1!==y.indexOf("across"))&&(-1!==y.indexOf("toaxis")&&(w=k,T=p),-1!==y.indexOf("across")&&(w=s._counterSpan[0],T=s._counterSpan[1]),a.insert("line",":first-child").attr({x1:w,x2:T,y1:u,y2:u,"stroke-width":f,stroke:x,"stroke-dasharray":_.dashStyle(s.spikedash,f)}).classed("spikeline",!0).classed("crisp",!0),a.insert("line",":first-child").attr({x1:w,x2:T,y1:u,y2:u,"stroke-width":f+2,stroke:d}).classed("spikeline",!0).classed("crisp",!0)),-1!==y.indexOf("marker")&&a.insert("circle",":first-child").attr({cx:k+("right"===s.side?-f:f),cy:u,r:f,fill:x}).classed("spikeline",!0)}if(n){var A=e.vLinePoint,S,C;l=A&&A.xa,s=A&&A.ya;var L=l.spikesnap;"cursor"===L?(S=o.pointerX,C=o.pointerY):(S=l._offset+A.x,C=s._offset+A.y);var E=1.5>g.readability(A.color,d)?b.contrast(d):A.color,I=l.spikemode,z=l.spikethickness,P=l.spikecolor||E,D=l._boundingBox,O=(D.top+D.bottom)/2<C?D.bottom:D.top,R,M;(-1!==I.indexOf("toaxis")||-1!==I.indexOf("across"))&&(-1!==I.indexOf("toaxis")&&(R=O,M=C),-1!==I.indexOf("across")&&(R=l._counterSpan[0],M=l._counterSpan[1]),a.insert("line",":first-child").attr({x1:S,x2:S,y1:R,y2:M,"stroke-width":z,stroke:P,"stroke-dasharray":_.dashStyle(l.spikedash,z)}).classed("spikeline",!0).classed("crisp",!0),a.insert("line",":first-child").attr({x1:S,x2:S,y1:R,y2:M,"stroke-width":z+2,stroke:d}).classed("spikeline",!0).classed("crisp",!0)),-1!==I.indexOf("marker")&&a.insert("circle",":first-child").attr({cx:S,cy:O-("top"===l.side?-z:z),r:z,fill:P}).classed("spikeline",!0)}}}function c(e,t,a){if(!a||a.length!==e._hoverdata.length)return!0;for(var r=a.length-1;0<=r;r--){var o=a[r],n=e._hoverdata[r];if(o.curveNumber!==n.curveNumber||o.pointNumber+""!==n.pointNumber+""||o.pointNumbers+""!==n.pointNumbers+"")return!0}return!1}function p(e,t){return!t||!(t.vLinePoint===e._spikepoints.vLinePoint&&t.hLinePoint===e._spikepoints.hLinePoint)}function u(e,t){return f.plainText(e||"",{len:t,allowedTags:["br","sub","sup","b","i","em"]})}var h=e("d3"),i=e("fast-isnumeric"),g=e("tinycolor2"),m=e("../../lib"),y=e("../../lib/events"),f=e("../../lib/svg_text_utils"),x=e("../../lib/override_cursor"),_=e("../drawing"),b=e("../color"),v=e("../dragelement"),k=e("../../plots/cartesian/axes"),w=e("../../registry"),T=e("./helpers"),A=e("./constants"),S=A.YANGLE,C=Pe*S/180,L=1/De(C),E=R(C),I=De(C),z=A.HOVERARROWSIZE,P=A.HOVERTEXTPAD;a.hover=function(e,t,a,o){e=m.getGraphDiv(e),m.throttle(e._fullLayout._uid+A.HOVERID,A.HOVERMINTIME,function(){r(e,t,a,o)})},a.loneHover=function(e,t){var a=!0;Array.isArray(e)||(a=!1,e=[e]);var r=e.map(function(e){return{color:e.color||b.defaultLine,x0:e.x0||e.x||0,x1:e.x1||e.x||0,y0:e.y0||e.y||0,y1:e.y1||e.y||0,xLabel:e.xLabel,yLabel:e.yLabel,zLabel:e.zLabel,text:e.text,name:e.name,idealAlign:e.idealAlign,borderColor:e.borderColor,fontFamily:e.fontFamily,fontSize:e.fontSize,fontColor:e.fontColor,nameLength:e.nameLength,textAlign:e.textAlign,trace:e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:e.hovertemplate||!1,eventData:e.eventData||!1,hovertemplateLabels:e.hovertemplateLabels||!1}}),i=h.select(t.container),n=t.outerContainer?h.select(t.outerContainer):i,s={hovermode:"closest",rotateLabels:!1,bgColor:t.bgColor||b.background,container:i,outerContainer:n},d=o(r,s,t.gd),c=5,p=0,u=0;return d.sort(function(e,t){return e.y0-t.y0}).each(function(e,a){var r=e.y0-e.by/2;e.offset=r-c<p?p-r+c:0,p=r+e.by+e.offset,(a===t.anchorIndex||0)&&(u=e.offset)}).each(function(e){e.offset-=u}),l(d,s.rotateLabels),a?d:d.node()};var D=/<extra>([\s\S]*)<\/extra>/},{"../../lib":719,"../../lib/events":709,"../../lib/override_cursor":730,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../registry":847,"../color":593,"../dragelement":611,"../drawing":614,"./constants":626,"./helpers":628,d3:163,"fast-isnumeric":225,tinycolor2:537}],630:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t,r,o){o=o||{},r("hoverlabel.bgcolor",o.bgcolor),r("hoverlabel.bordercolor",o.bordercolor),r("hoverlabel.namelength",o.namelength),a.coerceFont(r,"hoverlabel.font",o.font),r("hoverlabel.align",o.align)}},{"../../lib":719}],631:[function(e,t){"use strict";e("../../constants/docs").FORMAT_LINK;t.exports=function(e,t){e=e||{},t=t||{};var a=t.description?" "+t.description:"",r=t.keys||[];if(0<r.length){for(var o=[],n=0;n<r.length;n++)o[n]="`"+r[n]+"`";a+="Finally, the template string has access to ",a=1===r.length?"variable "+o[0]:"variables "+o.slice(0,-1).join(", ")+" and "+o.slice(-1)+"."}var l={valType:"string",dflt:"",editType:e.editType||"none"};return!1!==e.arrayOk&&(l.arrayOk=!0),l}},{"../../constants/docs":690}],632:[function(e,t){"use strict";var a=e("d3"),r=e("../../lib"),o=e("../dragelement"),i=e("./helpers"),n=e("./layout_attributes"),l=e("./hover");t.exports={moduleType:"component",name:"fx",constants:e("./constants"),schema:{layout:n},attributes:e("./attributes"),layoutAttributes:n,supplyLayoutGlobalDefaults:e("./layout_global_defaults"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),getDistanceFunction:i.getDistanceFunction,getClosest:i.getClosest,inbox:i.inbox,quadrature:i.quadrature,appendArrayPointValue:i.appendArrayPointValue,castHoverOption:function(e,t,a){return r.castOption(e,t,"hoverlabel."+a)},castHoverinfo:function(e,t,a){return r.castOption(e,a,"hoverinfo",function(a){return r.coerceHoverinfo({hoverinfo:a},{_module:e._module},t)})},hover:l.hover,unhover:o.unhover,loneHover:l.loneHover,loneUnhover:function(e){var t=r.isD3Selection(e)?e:a.select(e);t.selectAll("g.hovertext").remove(),t.selectAll(".spikeline").remove()},click:e("./click")}},{"../../lib":719,"../dragelement":611,"./attributes":623,"./calc":624,"./click":625,"./constants":626,"./defaults":627,"./helpers":628,"./hover":629,"./layout_attributes":633,"./layout_defaults":634,"./layout_global_defaults":635,d3:163}],633:[function(e,t){"use strict";var a=e("./constants"),r=e("../../plots/font_attributes")({editType:"none"});r.family.dflt=a.HOVERFONT,r.size.dflt=a.HOVERFONTSIZE,t.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:r,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":793,"./constants":626}],634:[function(e,t){"use strict";function a(e,t){for(var a=t._scatterStackOpts||{},r=0;r<e.length;r++){var o=e[r],n=o.xaxis+o.yaxis,l=a[n]||{},s=l[o.stackgroup]||{};if("h"!==o.orientation&&"h"!==s.orientation)return!1}return!0}var r=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t,i){function n(a,i){return r.coerce(e,t,o,a,i)}var l=n("clickmode"),s=n("dragmode");"select"===s&&n("selectdirection");var d;t._has("cartesian")?-1<l.indexOf("select")?d="closest":(t._isHoriz=a(i,t),d=t._isHoriz?"y":"x"):d="closest";var c=n("hovermode",d);c&&(n("hoverdistance"),n("spikedistance"));var p=t._has("mapbox"),u=t._has("geo"),g=t._basePlotModules.length;"zoom"===t.dragmode&&((p||u)&&1===g||p&&u&&2===g)&&(t.dragmode="pan")}},{"../../lib":719,"./layout_attributes":633}],635:[function(e,t){"use strict";var a=e("../../lib"),r=e("./hoverlabel_defaults"),o=e("./layout_attributes");t.exports=function(e,t){r(e,t,function(r,i){return a.coerce(e,t,o,r,i)})}},{"../../lib":719,"./hoverlabel_defaults":630,"./layout_attributes":633}],636:[function(e,t){"use strict";function a(e,t,a){var r=t[a+"axes"],o=Object.keys((e._splomAxes||{})[a]||{});return Array.isArray(r)?r:o.length?o:void 0}function r(e,t,a,r,o,n){var l=t(e+"gap",a),s=t("domain."+e);t(e+"side",r);for(var d=Array(o),c=s[0],p=(s[1]-c)/(o-l),u=0,g;u<o;u++)g=c+p*u,d[n?o-1-u:u]=[g,g+p*(1-l)];return d}function o(e,t,a,r,o){function n(e,a){-1!==t.indexOf(a)&&r[a]===void 0?(l[e]=a,r[a]=e):l[e]=""}var l=Array(a),s;if(Array.isArray(e))for(s=0;s<a;s++)n(s,e[s]);else for(n(0,o),s=1;s<a;s++)n(s,o+(s+1));return l}var i=e("../../lib"),n=e("../../lib/regex").counter,l=e("../../plots/domain").attributes,s=e("../../plots/cartesian/constants").idRegex,d=e("../../plot_api/plot_template"),c={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[n("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[s.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[s.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:l({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};t.exports={moduleType:"component",name:"grid",schema:{layout:{grid:c}},layoutAttributes:c,sizeDefaults:function(e,t){function o(e,t){return i.coerce(n,f,c,e,t)}var n=e.grid||{},l=a(t,n,"x"),s=a(t,n,"y");if(e.grid||l||s){var p=Array.isArray(n.subplots)&&Array.isArray(n.subplots[0]),u=Array.isArray(l),g=Array.isArray(s),h=u&&l!==n.xaxes&&g&&s!==n.yaxes,m,y;p?(m=n.subplots.length,y=n.subplots[0].length):(g&&(m=s.length),u&&(y=l.length));var f=d.newContainer(t,"grid"),x=o("rows",m),_=o("columns",y);if(!(1<x*_))return void delete t.grid;if(!p&&!u&&!g){var b="independent"===o("pattern");b&&(p=!0)}f._hasSubplotGrid=p;var v=o("roworder"),k=p?.2:.1,w=p?.3:.1,T,A;h&&t._splomGridDflt&&(T=t._splomGridDflt.xside,A=t._splomGridDflt.yside),f._domains={x:r("x",o,k,T,_),y:r("y",o,w,A,x,"top to bottom"===v)}}},contentDefaults:function(e,t){var r=t.grid;if(r&&r._domains){var n=e.grid||{},l=t._subplots,s=r._hasSubplotGrid,d=r.rows,c=r.columns,p="independent"===r.pattern,u=r._axisMap={},g,h,m,y,f,x,_;if(s){var b=n.subplots||[];x=r.subplots=Array(d);var v=1;for(g=0;g<d;g++){var k=x[g]=Array(c),w=b[g]||[];for(h=0;h<c;h++)if(p?(f=1==v?"xy":"x"+v+"y"+v,v++):f=w[h],k[h]="",-1!==l.cartesian.indexOf(f)){if(_=f.indexOf("y"),m=f.slice(0,_),y=f.slice(_),void 0!==u[m]&&u[m]!==h||void 0!==u[y]&&u[y]!==g)continue;k[h]=f,u[m]=h,u[y]=g}}}else{var T=a(t,n,"x"),A=a(t,n,"y");r.xaxes=o(T,l.xaxis,c,u,"x"),r.yaxes=o(A,l.yaxis,d,u,"y")}var S=r._anchors={},C="top to bottom"===r.roworder;for(var L in u){var E=L.charAt(0),I=r[E+"side"],z,P,D;if(8>I.length)S[L]="free";else if("x"===E){if("t"===I.charAt(0)===C?(z=0,P=1,D=d):(z=d-1,P=-1,D=-1),s){var O=u[L];for(g=z;g!==D;g+=P)if(f=x[g][O],f&&(_=f.indexOf("y"),f.slice(0,_)===L)){S[L]=f.slice(_);break}}else for(g=z;g!==D;g+=P)if(y=r.yaxes[g],-1!==l.cartesian.indexOf(L+y)){S[L]=y;break}}else if("l"===I.charAt(0)?(z=0,P=1,D=c):(z=c-1,P=-1,D=-1),s){var R=u[L];for(g=z;g!==D;g+=P)if(f=x[R][g],f&&(_=f.indexOf("y"),f.slice(_)===L)){S[L]=f.slice(0,_);break}}else for(g=z;g!==D;g+=P)if(m=r.xaxes[g],-1!==l.cartesian.indexOf(m+L)){S[L]=m;break}}}}}},{"../../lib":719,"../../lib/regex":735,"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773,"../../plots/domain":792}],637:[function(e,t){"use strict";var a=e("../../plots/cartesian/constants"),r=e("../../plot_api/plot_template").templatedArray;t.exports=r("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",a.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",a.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773}],638:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../lib/to_log_range");t.exports=function(e,t,o,n){t=t||{};var l="log"===o&&"linear"===t.type,s="linear"===o&&"log"===t.type;if(l||s)for(var d=e._fullLayout.images,c=t._id.charAt(0),p=0,u,g;p<d.length;p++)if(u=d[p],g="images["+p+"].",u[c+"ref"]===t._id){var h=u[c],m=u["size"+c],y=null,f=null;if(l){y=r(h,t.range);var x=m/ya(10,y)/2;f=2*P(x+N(1+x*x))/I}else y=ya(10,h),f=y*(ya(10,m/2)-ya(10,-m/2));a(y)?!a(f)&&(f=null):(y=null,f=null),n(g+c,y),n(g+"size"+c,f)}}},{"../../lib/to_log_range":745,"fast-isnumeric":225}],639:[function(e,t){"use strict";function a(e,t,a){function l(a,o){return r.coerce(e,t,n,a,o)}var s=l("source"),d=l("visible",!!s);if(!d)return t;l("layer"),l("xanchor"),l("yanchor"),l("sizex"),l("sizey"),l("sizing"),l("opacity");for(var c={_fullLayout:a},p=["x","y"],u=0;2>u;u++){var g=p[u],h=o.coerceRef(e,t,c,g,"paper");if("paper"!==h){var m=o.getFromId(c,h);m._imgIndices.push(t._index)}o.coercePosition(t,c,l,h,g,0)}return t}var r=e("../../lib"),o=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./attributes");t.exports=function(e,t){i(e,t,{name:"images",handleItemDefaults:a})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"./attributes":637}],640:[function(e,t){"use strict";var a=e("d3"),r=e("../drawing"),o=e("../../plots/cartesian/axes"),i=e("../../constants/xmlns_namespaces");t.exports=function(e){function t(t){var r=a.select(this);if(!(this.img&&this.img.src===t.source)){r.attr("xmlns",i.svg);var o=new Promise(function(e){function a(){r.remove(),e()}var o=new Image;this.img=o,o.setAttribute("crossOrigin","anonymous"),o.onerror=a,o.onload=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var a=t.getContext("2d");a.drawImage(this,0,0);var o=t.toDataURL("image/png");r.attr("xlink:href",o),e()},r.on("error",a),o.src=t.source}.bind(this));e._promises.push(o)}}function n(t){var i=a.select(this),n=o.getFromId(e,t.xref),s=o.getFromId(e,t.yref),d=l._size,c=n?_a(n.l2p(t.sizex)-n.l2p(0)):t.sizex*d.w,p=s?_a(s.l2p(t.sizey)-s.l2p(0)):t.sizey*d.h,u=c*m.x[t.xanchor].offset,g=p*m.y[t.yanchor].offset,h=m.x[t.xanchor].sizing+m.y[t.yanchor].sizing,y=(n?n.r2p(t.x)+n._offset:t.x*d.w+d.l)+u,f=(s?s.r2p(t.y)+s._offset:d.h-t.y*d.h+d.t)+g;switch(t.sizing){case"fill":h+=" slice";break;case"stretch":h="none";}i.attr({x:y,y:f,width:c,height:p,preserveAspectRatio:h,opacity:t.opacity});var x=n?n._id:"",_=s?s._id:"",b=x+_;r.setClipUrl(i,b?"clip"+l._uid+b:null,e)}var l=e._fullLayout,s=[],d={},c=[],p,u;for(u=0;u<l.images.length;u++){var g=l.images[u];if(g.visible)if("below"===g.layer&&"paper"!==g.xref&&"paper"!==g.yref){p=g.xref+g.yref;var h=l._plots[p];if(!h){c.push(g);continue}h.mainplot&&(p=h.mainplot.id),d[p]||(d[p]=[]),d[p].push(g)}else"above"===g.layer?s.push(g):c.push(g)}var m={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}},y=l._imageLowerLayer.selectAll("image").data(c),f=l._imageUpperLayer.selectAll("image").data(s);y.enter().append("image"),f.enter().append("image"),y.exit().remove(),f.exit().remove(),y.each(function(e){t.bind(this)(e),n.bind(this)(e)}),f.each(function(e){t.bind(this)(e),n.bind(this)(e)});var x=Object.keys(l._plots);for(u=0;u<x.length;u++){p=x[u];var _=l._plots[p];if(_.imagelayer){var b=_.imagelayer.selectAll("image").data(d[p]||[]);b.enter().append("image"),b.exit().remove(),b.each(function(e){t.bind(this)(e),n.bind(this)(e)})}}}},{"../../constants/xmlns_namespaces":696,"../../plots/cartesian/axes":767,"../drawing":614,d3:163}],641:[function(e,t){"use strict";t.exports={moduleType:"component",name:"images",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("images"),draw:e("./draw"),convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":777,"./attributes":637,"./convert_coords":638,"./defaults":639,"./draw":640}],642:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("../color/attributes");t.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:r.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:a({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},x:{valType:"number",min:-2,max:3,dflt:1.02,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,dflt:1,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":793,"../color/attributes":592}],643:[function(e,t){"use strict";t.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,textOffsetX:40}},{}],644:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib"),o=e("../../plot_api/plot_template"),i=e("./attributes"),n=e("../../plots/layout_attributes"),l=e("./helpers");t.exports=function(e,t,s){function d(e,t){return r.coerce(c,v,i,e,t)}for(var c=e.legend||{},p=0,u=!1,g="normal",h=0,m,y,f,x,_;h<s.length;h++)_=s[h],_.visible&&((_.showlegend||_._dfltShowLegend)&&(p++,_.showlegend&&(u=!0,(a.traceIs(_,"pie-like")||!0===_._input.showlegend)&&p++)),(a.traceIs(_,"bar")&&"stack"===t.barmode||-1!==["tonextx","tonexty"].indexOf(_.fill))&&(g=l.isGrouped({traceorder:g})?"grouped+reversed":"reversed"),void 0!==_.legendgroup&&""!==_.legendgroup&&(g=l.isReversed({traceorder:g})?"reversed+grouped":"grouped"));var b=r.coerce(e,t,n,"showlegend",u&&1<p);if(!1!==b||c.uirevision){var v=o.newContainer(t,"legend");if(d("uirevision",t.uirevision),!1!==b){if(d("bgcolor",t.paper_bgcolor),d("bordercolor"),d("borderwidth"),r.coerceFont(d,"font",t.font),d("orientation"),"h"===v.orientation){var k=e.xaxis;a.getComponentMethod("rangeslider","isVisible")(k)?(m=0,f="left",y=1.1,x="bottom"):(m=0,f="left",y=-.1,x="top")}d("traceorder",g),l.isGrouped(t.legend)&&d("tracegroupgap"),d("itemsizing"),d("itemclick"),d("itemdoubleclick"),d("x",m),d("xanchor",f),d("y",y),d("yanchor",x),d("valign"),r.noneOrAll(c,v,["x","y"])}}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/layout_attributes":819,"../../registry":847,"./attributes":642,"./helpers":648}],645:[function(e,t){"use strict";function a(e,t,a,r,o){var i=a.data()[0][0].trace,n={event:o,node:a.node(),curveNumber:i.index,expandedIndex:i._expandedIndex,data:e.data,layout:e.layout,frames:e._transitionData._frames,config:e._context,fullData:e._fullData,fullLayout:e._fullLayout};i._group&&(n.group=i._group),h.traceIs(i,"pie-like")&&(n.label=a.datum()[0].label);var l=m.triggerHandler(e,"plotly_legendclick",n);if(!1!==l)if(1===r)t._clickTimeout=setTimeout(function(){b(a,e,r)},e._context.doubleClickDelay);else if(2===r){t._clickTimeout&&clearTimeout(t._clickTimeout),e._legendMouseDownTime=0;var s=m.triggerHandler(e,"plotly_legenddoubleclick",n);!1!==s&&b(a,e,r)}}function r(e,t,a){function r(a){_.convertToTspans(a,t,function(){n(e,t)})}var i=e.data()[0][0],l=t._fullLayout,s=i.trace,d=h.traceIs(s,"pie-like"),c=s.index,u=t._context.edits.legendText&&!d,g=d?i.label:s.name;s._meta&&(g=p.templateString(g,s._meta));var m=p.ensureSingle(e,"text","legendtext");m.attr("text-anchor","start").classed("user-select-none",!0).call(f.font,l.legend.font).text(u?o(g,a):g),_.positionText(m,v.textOffsetX,0),u?m.call(_.makeEditable,{gd:t,text:g}).call(r).on("edit",function(e){this.text(o(e,a)).call(r);var n=i.trace._fullInput||{},l={};if(h.hasTransform(n,"groupby")){var s=h.getTransformIndices(n,"groupby"),d=s[s.length-1],u=p.keyedContainer(n,"transforms["+d+"].styles","target","value.name");u.set(i.trace._group,e),l=u.constructUpdate()}else l.name=e;return h.call("_guiRestyle",t,l,c)}):r(m)}function o(e,t){var a=va(4,t);if(e&&e.trim().length>=a/2)return e;e=e||"";for(var r=a-e.length;0<r;r--)e+=" ";return e}function i(e,t){var r=t._context.doubleClickDelay,o=1,i=p.ensureSingle(e,"rect","legendtoggle",function(e){e.style("cursor","pointer").attr("pointer-events","all").call(x.fill,"rgba(0,0,0,0)")}),n;i.on("mousedown",function(){n=new Date().getTime(),n-t._legendMouseDownTime<r?o+=1:(o=1,t._legendMouseDownTime=n)}),i.on("mouseup",function(){if(!(t._dragged||t._editing)){var i=t._fullLayout.legend;new Date().getTime()-t._legendMouseDownTime>r&&(o=va(o-1,1)),a(t,i,e,o,c.event)}})}function n(e,t){var a=e.data()[0][0];if(!a.trace.showlegend)return void e.remove();var r=e.select("g[class*=math-group]"),o=r.node(),i=t._fullLayout.legend,n=i.font.size*w,l,s;if(o){var d=f.bBox(o);l=d.height,s=d.width,f.setTranslate(r,0,l/4)}else{var c=e.select(".legendtext"),p=_.lineCount(c),u=c.node();l=n*p,s=u?f.bBox(u).width:0;_.positionText(c,v.textOffsetX,n*(.3+(1-p)/2))}a.lineHeight=n,a.height=va(l,16)+3,a.width=s}function l(e,t,a){var r=e._fullLayout,o=r.legend,n=o.borderwidth,l=L.isGrouped(o),s=0,u=5;if(o._width=0,o._height=0,L.isVertical(o))l&&t.each(function(e,t){f.setTranslate(this,0,t*o.tracegroupgap)}),a.each(function(e){var t=e[0],a=t.height,r=t.width;f.setTranslate(this,n,5+n+o._height+a/2),o._height+=a,o._width=va(o._width,r)}),o._width+=45+2*n,o._height+=10+2*n,l&&(o._height+=(o._lgroupsLength-1)*o.tracegroupgap),s=40;else if(l){var g=0,h=0,m=t.data(),y=0,x;for(x=0;x<m.length;x++){var d=m[x],_=d.map(function(e){return e[0].width}),b=p.aggNums(Math.max,null,_),v=d.reduce(function(e,t){return e+t[0].height},0);h=va(h,b),g=va(g,v),y=va(y,d.length)}h+=u,h+=40;var k=[o._width],w=[],T=0;for(x=0;x<m.length;x++){r._size.w<n+o._width+u+h?(k[k.length-1]=k[0],o._width=h,T++):o._width+=h+n;var A=T*g;A+=0<T?o.tracegroupgap:0,w.push(A),k.push(o._width)}t.each(function(e,t){f.setTranslate(this,k[t],w[t])}),t.each(function(){var e=c.select(this),t=e.selectAll("g.traces"),a=0;t.each(function(e){var t=e[0],r=t.height;f.setTranslate(this,0,5+n+a+r/2),a+=r})});var S=w[w.length-1]+g;o._height=10+2*n+S;var C=va.apply(null,k);o._width=C+h+40,o._width+=2*n}else{var E=0,I=0,z=0,P=0,D=0;a.each(function(e){z=va(40+e[0].width,z),D+=40+e[0].width+u});var O=r._size.w>n+D-u;a.each(function(e){var t=e[0],a=O?40+e[0].width:z;n+P+u+a>r._size.w&&(P=0,E+=I,o._height+=I,I=0),f.setTranslate(this,n+P,5+n+t.height/2+E),o._width+=u+a,P+=u+a,I=va(t.height,I)}),O?o._height=I:o._height+=I,o._width+=2*n,o._height+=10+2*n}o._width=M(o._width),o._height=M(o._height);var R=e._context.edits.legendText||e._context.edits.legendPosition;a.each(function(e){var t=e[0],a=c.select(this).select(".legendtoggle");f.setRect(a,0,-t.height/2,(R?0:o._width)+s,t.height)})}function s(e){var t=e._fullLayout,a=t.legend,r="left";p.isRightAnchor(a)?r="right":p.isCenterAnchor(a)&&(r="center");var o="top";p.isBottomAnchor(a)?o="bottom":p.isMiddleAnchor(a)&&(o="middle"),u.autoMargin(e,"legend",{x:a.x,y:a.y,l:a._width*T[r],r:a._width*A[r],b:a._height*A[o],t:a._height*T[o]})}function d(e){var t=e._fullLayout,a=t.legend,r="left";p.isRightAnchor(a)?r="right":p.isCenterAnchor(a)&&(r="center"),u.autoMargin(e,"legend",{x:a.x,y:.5,l:a._width*T[r],r:a._width*A[r],b:0,t:0})}var c=e("d3"),p=e("../../lib"),u=e("../../plots/plots"),h=e("../../registry"),m=e("../../lib/events"),y=e("../dragelement"),f=e("../drawing"),x=e("../color"),_=e("../../lib/svg_text_utils"),b=e("./handle_click"),v=e("./constants"),k=e("../../constants/alignment"),w=k.LINE_SPACING,T=k.FROM_TL,A=k.FROM_BR,S=e("./get_legend_data"),C=e("./style"),L=e("./helpers");t.exports=function(t){var o=t._fullLayout,n="legend"+o._uid;if(o._infolayer&&t.calcdata){t._legendMouseDownTime||(t._legendMouseDownTime=0);var g=o.legend,m=o.showlegend&&S(t.calcdata,g),_=o.hiddenlabels||[];if(!o.showlegend||!m.length)return o._infolayer.selectAll(".legend").remove(),o._topdefs.select("#"+n).remove(),void u.autoMargin(t,"legend");for(var b=0,k=0;k<m.length;k++)for(var e=0;e<m[k].length;e++){var w=m[k][e][0],T=w.trace,A=h.traceIs(T,"pie-like"),L=A?w.label:T.name;b=va(b,L&&L.length||0)}var E=!1,I=p.ensureSingle(o._infolayer,"g","legend",function(e){e.attr("pointer-events","all"),E=!0}),z=p.ensureSingleById(o._topdefs,"clipPath",n,function(e){e.append("rect")}),P=p.ensureSingle(I,"rect","bg",function(e){e.attr("shape-rendering","crispEdges")});P.call(x.stroke,g.bordercolor).call(x.fill,g.bgcolor).style("stroke-width",g.borderwidth+"px");var D=p.ensureSingle(I,"g","scrollbox"),O=p.ensureSingle(I,"rect","scrollbar",function(e){e.attr({rx:20,ry:3,width:0,height:0}).call(x.fill,"#808BA4")}),R=D.selectAll("g.groups").data(m);R.enter().append("g").attr("class","groups"),R.exit().remove();var M=R.selectAll("g.traces").data(p.identity);M.enter().append("g").attr("class","traces"),M.exit().remove(),M.style("opacity",function(e){var t=e[0].trace;return h.traceIs(t,"pie-like")?-1===_.indexOf(e[0].label)?1:.5:"legendonly"===t.visible?.5:1}).each(function(){c.select(this).call(r,t,b)}).call(C,t).each(function(){c.select(this).call(i,t)}),p.syncOrAsync([u.previousPromises,function(){function r(e,a,r){g._scrollY=t._fullLayout.legend._scrollY=e,f.setTranslate(D,0,-e),f.setRect(O,_,v.scrollBarMargin+e*r,v.scrollBarWidth,a),z.select("rect").attr({y:g.borderwidth+e})}E&&(l(t,R,M),s(t));var i=o.width,u=o.height;l(t,R,M),g._height>u?d(t):s(t);var m=o._size,e=m.l+m.w*g.x,x=m.t+m.h*(1-g.y);p.isRightAnchor(g)?e-=g._width:p.isCenterAnchor(g)&&(e-=g._width/2),p.isBottomAnchor(g)?x-=g._height:p.isMiddleAnchor(g)&&(x-=g._height/2);var _=g._width,b=m.w;_>b?(e=m.l,_=b):(e+_>i&&(e=i-_),0>e&&(e=0),_=ea(i-e,g._width));var k=g._height,w=m.h;if(k>w?(x=m.t,k=w):(x+k>u&&(x=u-k),x<0&&(x=0),k=ea(u-x,g._height)),f.setTranslate(I,e,x),O.on(".drag",null),I.on("wheel",null),g._height<=k||t._context.staticPlot)P.attr({width:_-g.borderwidth,height:k-g.borderwidth,x:g.borderwidth/2,y:g.borderwidth/2}),f.setTranslate(D,0,0),z.select("rect").attr({width:_-2*g.borderwidth,height:k-2*g.borderwidth,x:g.borderwidth,y:g.borderwidth}),f.setClipUrl(D,n,t),f.setRect(O,0,0,0,0),delete g._scrollY;else{var T=va(v.scrollBarMinHeight,k*k/g._height),A=k-T-2*v.scrollBarMargin,S=g._height-k,C=A/S,L=ea(g._scrollY||0,S);P.attr({width:_-2*g.borderwidth+v.scrollBarWidth+v.scrollBarMargin,height:k-g.borderwidth,x:g.borderwidth/2,y:g.borderwidth/2}),z.select("rect").attr({width:_-2*g.borderwidth+v.scrollBarWidth+v.scrollBarMargin,height:k-2*g.borderwidth,x:g.borderwidth,y:g.borderwidth+L}),f.setClipUrl(D,n,t),r(L,T,C),I.on("wheel",function(){L=p.constrain(g._scrollY+c.event.deltaY/A*S,0,S),r(L,T,C),0!==L&&L!==S&&c.event.preventDefault()});var j=c.behavior.drag().on("dragstart",function(){F=c.event.sourceEvent.clientY,B=L}).on("drag",function(){var t=c.event.sourceEvent;2===t.buttons||t.ctrlKey||(L=p.constrain((t.clientY-F)/C+B,0,S),r(L,T,C))}),F,B;O.call(j)}if(t._context.edits.legendPosition){var N,V,U,H;I.classed("cursor-move",!0),y.init({element:I.node(),gd:t,prepFn:function(){var e=f.getTranslate(I);U=e.x,H=e.y},moveFn:function(e,t){var a=U+e,r=H+t;f.setTranslate(I,a,r),N=y.align(a,0,m.l,m.l+m.w,g.xanchor),V=y.align(r,0,m.t+m.h,m.t,g.yanchor)},doneFn:function(){void 0!==N&&void 0!==V&&h.call("_guiRelayout",t,{"legend.x":N,"legend.y":V})},clickFn:function(r,i){var e=o._infolayer.selectAll("g.traces").filter(function(){var e=this.getBoundingClientRect();return i.clientX>=e.left&&i.clientX<=e.right&&i.clientY>=e.top&&i.clientY<=e.bottom});0<e.size()&&a(t,I,e,r,i)}})}}],t)}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/events":709,"../../lib/svg_text_utils":743,"../../plots/plots":828,"../../registry":847,"../color":593,"../dragelement":611,"../drawing":614,"./constants":643,"./get_legend_data":646,"./handle_click":647,"./helpers":648,"./style":650,d3:163}],646:[function(e,t){"use strict";var a=e("../../registry"),r=e("./helpers");t.exports=function(e,t){function o(e,a){if(""===e||!r.isGrouped(t)){var o="~~i"+c;l.push(o),n[o]=[[a]],c++}else-1===l.indexOf(e)?(l.push(e),s=!0,n[e]=[[a]]):n[e].push([a])}var n={},l=[],s=!1,d={},c=0,p,u;for(p=0;p<e.length;p++){var g=e[p],h=g[0],m=h.trace,y=m.legendgroup;if(m.visible&&m.showlegend)if(a.traceIs(m,"pie-like"))for(d[y]||(d[y]={}),u=0;u<g.length;u++){var f=g[u].label;d[y][f]||(o(y,{label:f,color:g[u].color,i:g[u].i,trace:m,pts:g[u].pts}),d[y][f]=!0)}else o(y,h)}if(!l.length)return[];var x=l.length,_,b;if(s&&r.isGrouped(t))for(b=Array(x),p=0;p<x;p++)_=n[l[p]],b[p]=r.isReversed(t)?_.reverse():_;else{for(b=[Array(x)],p=0;p<x;p++)_=n[l[p]][0],b[0][r.isReversed(t)?x-p-1:p]=_;x=1}return t._lgroupsLength=x,b}},{"../../registry":847,"./helpers":648}],647:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../registry"),o=!0;t.exports=function(e,t,n){function l(e,t,a){var r=_.indexOf(e),o=x[t];return o||(o=x[t]=[]),-1===_.indexOf(e)&&(_.push(e),r=_.length-1),o[r]=a,r}function s(e,t){var o=e._fullInput;if(r.hasTransform(o,"groupby")){var i=b[o.index];if(!i){var n=r.getTransformIndices(o,"groupby"),s=n[n.length-1];i=a.keyedContainer(o,"transforms["+s+"].styles","target","value.visible"),b[o.index]=i}var d=i.get(e._group);void 0===d&&(d=!0),!1!==d&&i.set(e._group,t),v[o.index]=l(o.index,"visible",!1!==o.visible)}else{var c=!1!==o.visible&&t;l(o.index,"visible",c)}}var d=t._fullLayout;if(!(t._dragged||t._editing)){var c=d.legend.itemclick,p=d.legend.itemdoubleclick;1===n&&"toggle"===c&&"toggleothers"===p&&o&&t.data&&t._context.showTips?(a.notifier(a._(t,"Double-click on legend to isolate one trace"),"long"),o=!1):o=!1;var u;if(1===n?u=c:2==n&&(u=p),!!u){var g=d.hiddenlabels?d.hiddenlabels.slice():[],h=e.data()[0][0],m=t._fullData,y=h.trace,f=y.legendgroup,x={},_=[],b=[],v=[],k,w,T,A,S,C;if(r.traceIs(y,"pie-like")){var L=h.label,E=g.indexOf(L);"toggle"===u?-1===E?g.push(L):g.splice(E,1):"toggleothers"===u&&(g=[],t.calcdata[0].forEach(function(e){L!==e.label&&g.push(e.label)}),t._fullLayout.hiddenlabels&&t._fullLayout.hiddenlabels.length===g.length&&-1===E&&(g=[])),r.call("_guiRelayout",t,"hiddenlabels",g)}else{var I=f&&f.length,z=[],P;if(I)for(k=0;k<m.length;k++)P=m[k],P.visible&&P.legendgroup===f&&z.push(k);if("toggle"===u){var D;switch(y.visible){case!0:D="legendonly";break;case!1:D=!1;break;case"legendonly":D=!0;}if(I)for(k=0;k<m.length;k++)!1!==m[k].visible&&m[k].legendgroup===f&&s(m[k],D);else s(y,D)}else if("toggleothers"===u){var O=!0,R,M,F;for(k=0;k<m.length;k++)if(R=m[k]===y,!R&&(M=I&&m[k].legendgroup===f,!M&&!0===m[k].visible&&!r.traceIs(m[k],"notLegendIsolatable"))){O=!1;break}for(k=0;k<m.length;k++)if(!1!==m[k].visible){if(r.traceIs(m[k],"notLegendIsolatable"))continue;switch(y.visible){case"legendonly":s(m[k],!0);break;case!0:F=!!O||"legendonly",R=m[k]===y,M=R||I&&m[k].legendgroup===f,s(m[k],!!M||F);}}}for(k=0;k<b.length;k++)if(T=b[k],T){var B=T.constructUpdate(),N=Object.keys(B);for(w=0;w<N.length;w++)A=N[w],C=x[A]=x[A]||[],C[v[k]]=B[A]}for(S=Object.keys(x),k=0;k<S.length;k++)for(A=S[k],w=0;w<_.length;w++)x[A].hasOwnProperty(w)||(x[A][w]=void 0);r.call("_guiRestyle",t,x,_)}}}}},{"../../lib":719,"../../registry":847}],648:[function(e,t,a){"use strict";a.isGrouped=function(e){return-1!==(e.traceorder||"").indexOf("grouped")},a.isVertical=function(e){return"h"!==e.orientation},a.isReversed=function(e){return-1!==(e.traceorder||"").indexOf("reversed")}},{}],649:[function(e,t){"use strict";t.exports={moduleType:"component",name:"legend",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw"),style:e("./style")}},{"./attributes":642,"./defaults":644,"./draw":645,"./style":650}],650:[function(e,t){"use strict";var a=e("d3"),r=e("../../registry"),o=e("../../lib"),n=e("../drawing"),l=e("../color"),s=e("../../traces/scatter/subtypes"),d=e("../../traces/pie/style_one"),c=e("../../traces/pie/helpers").castOption,p=12,u=5,g=2,h=5;t.exports=function(e,t){function m(e,t,a,r){var o;if(e+1)o=e;else if(t&&0<t.width)o=t.width;else return 0;return b?r:ea(o,a)}function y(e,t,o){var i=e[0].trace,n=i.marker||{},s=n.line||{},d=o?i.type===o&&i.visible:r.traceIs(i,"bar"),c=a.select(t).select("g.legendpoints").selectAll("path.legend"+o).data(d?[e]:[]);c.enter().append("path").classed("legend"+o,!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),c.exit().remove(),c.each(function(e){var t=a.select(this),r=e[0],o=m(r.mlw,n.line,h,g);t.style("stroke-width",o+"px").call(l.fill,r.mc||n.color),o&&l.stroke(t,r.mlc||s.color)})}function f(e,t,i){var n=e[0],l=n.trace,s=i?l.type===i&&l.visible:r.traceIs(l,i),p=a.select(t).select("g.legendpoints").selectAll("path.legend"+i).data(s?[e]:[]);if(p.enter().append("path").classed("legend"+i,!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),p.exit().remove(),p.size()){var u=(l.marker||{}).line,y=m(c(u.width,n.pts),u,h,g),f=o.minExtend(l,{marker:{line:{width:y}}});f.marker.line.color=u.color;var x=o.minExtend(n,{trace:f});d(p,x,f)}}var x=t._fullLayout,_=x.legend,b="constant"===_.itemsizing;e.each(function(e){var t=a.select(this),r=o.ensureSingle(t,"g","layers");r.style("opacity",e[0].trace.opacity);var i=_.valign,n=e[0].lineHeight,l=e[0].height;if("middle"===i||!n||!l)r.attr("transform",null);else{var s={top:1,bottom:-1}[i];r.attr("transform","translate(0,"+s*(.5*(n-l+3))+")")}var d=r.selectAll("g.legendfill").data([e]);d.enter().append("g").classed("legendfill",!0);var c=r.selectAll("g.legendlines").data([e]);c.enter().append("g").classed("legendlines",!0);var p=r.selectAll("g.legendsymbols").data([e]);p.enter().append("g").classed("legendsymbols",!0),p.selectAll("g.legendpoints").data([e]).enter().append("g").classed("legendpoints",!0)}).each(function(e){var t=e[0].trace,r=[];"waterfall"===t.type&&t.visible&&(r=e[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var o=a.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(r);o.enter().append("path").classed("legendwaterfall",!0).attr("transform","translate(20,0)").style("stroke-miterlimit",1),o.exit().remove(),o.each(function(e){var r=a.select(this),o=t[e[0]].marker,i=m(void 0,o.line,h,g);r.attr("d",e[1]).style("stroke-width",i+"px").call(l.fill,o.color),i&&r.call(l.stroke,o.line.color)})}).each(function(e){y(e,this,"funnel")}).each(function(e){y(e,this)}).each(function(e){var i=e[0].trace,s=a.select(this).select("g.legendpoints").selectAll("path.legendbox").data(r.traceIs(i,"box-violin")&&i.visible?[e]:[]);s.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),s.exit().remove(),s.each(function(){var e=a.select(this);if(("all"===i.boxpoints||"all"===i.points)&&0===l.opacity(i.fillcolor)&&0===l.opacity((i.line||{}).color)){var r=o.minExtend(i,{marker:{size:b?p:o.constrain(i.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});s.call(n.pointStyle,r,t)}else{var d=m(void 0,i.line,h,g);e.style("stroke-width",d+"px").call(l.fill,i.fillcolor),d&&l.stroke(e,i.line.color)}})}).each(function(e){f(e,this,"funnelarea")}).each(function(e){f(e,this,"pie")}).each(function(e){var r=e[0],i=r.trace,l=i.visible&&i.fill&&"none"!==i.fill,d=s.hasLines(i),c=i.contours,p=!1,g=!1,h,y;if(c){var f=c.coloring;"lines"===f?p=!0:d="none"===f||"heatmap"===f||c.showlines,"constraint"===c.type?l="="!==c._operation:("fill"===f||"heatmap"===f)&&(g=!0)}var x=s.hasMarkers(i)||s.hasText(i),_=l||g,b=d||p,v=x||!_?"M5,0":b?"M5,-2":"M5,-3",k=a.select(this),w=k.select(".legendfill").selectAll("path").data(l||g?[e]:[]);if(w.enter().append("path").classed("js-fill",!0),w.exit().remove(),w.attr("d",v+"h30v6h-30z").call(l?n.fillGroupStyle:function(e){if(e.size()){var a="legendfill-"+i.uid;n.gradient(e,t,a,"horizontalreversed",i.colorscale,"fill")}}),d||p){var T=m(void 0,i.line,10,u);y=o.minExtend(i,{line:{width:T}}),h=[o.minExtend(r,{trace:y})]}var A=k.select(".legendlines").selectAll("path").data(d||p?[h]:[]);A.enter().append("path").classed("js-line",!0),A.exit().remove(),A.attr("d",v+(p?"l30,0.0001":"h30")).call(d?n.lineGroupStyle:function(e){if(e.size()){var a="legendline-"+i.uid;n.lineGroupStyle(e),n.gradient(e,t,a,"horizontalreversed",i.colorscale,"stroke")}})}).each(function(e){function r(e,t,a,r){var i=o.nestedProperty(d,e).get(),n=o.isArrayOrTypedArray(i)&&t?t(i):i;if(b&&n&&void 0!==r&&(n=r),a){if(n<a[0])return a[0];if(n>a[1])return a[1]}return n}function i(e){return e[0]}var l=e[0],d=l.trace,c=s.hasMarkers(d),h=s.hasText(d),m=s.hasLines(d),y,f;if(c||h||m){var x={},_={};if(c){x.mc=r("marker.color",i),x.mx=r("marker.symbol",i),x.mo=r("marker.opacity",o.mean,[.2,1]),x.mlc=r("marker.line.color",i),x.mlw=r("marker.line.width",o.mean,[0,5],g),_.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var v=r("marker.size",o.mean,[2,16],p);x.ms=v,_.marker.size=v}m&&(_.line={width:r("line.width",i,[0,10],u)}),h&&(x.tx="Aa",x.tp=r("textposition",i),x.ts=10,x.tc=r("textfont.color",i),x.tf=r("textfont.family",i)),y=[o.minExtend(l,x)],f=o.minExtend(d,_),f.selectedpoints=null}var k=a.select(this).select("g.legendpoints"),w=k.selectAll("path.scatterpts").data(c?y:[]);w.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform","translate(20,0)"),w.exit().remove(),w.call(n.pointStyle,f,t),c&&(y[0].mrc=3);var T=k.selectAll("g.pointtext").data(h?y:[]);T.enter().append("g").classed("pointtext",!0).append("text").attr("transform","translate(20,0)"),T.exit().remove(),T.selectAll("text").call(n.textPointStyle,f,t)}).each(function(e){var t=e[0].trace,r=a.select(this).select("g.legendpoints").selectAll("path.legendcandle").data("candlestick"===t.type&&t.visible?[e,e]:[]);r.enter().append("path").classed("legendcandle",!0).attr("d",function(e,t){return t?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),r.exit().remove(),r.each(function(e,r){var o=a.select(this),i=t[r?"increasing":"decreasing"],n=m(void 0,i.line,h,g);o.style("stroke-width",n+"px").call(l.fill,i.fillcolor),n&&l.stroke(o,i.line.color)})}).each(function(e){var t=e[0].trace,r=a.select(this).select("g.legendpoints").selectAll("path.legendohlc").data("ohlc"===t.type&&t.visible?[e,e]:[]);r.enter().append("path").classed("legendohlc",!0).attr("d",function(e,t){return t?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),r.exit().remove(),r.each(function(e,r){var o=a.select(this),i=t[r?"increasing":"decreasing"],s=m(void 0,i.line,h,g);o.style("fill","none").call(n.dashLine,i.line.dash,s),s&&l.stroke(o,i.line.color)})})}},{"../../lib":719,"../../registry":847,"../../traces/pie/helpers":1091,"../../traces/pie/style_one":1097,"../../traces/scatter/subtypes":1135,"../color":593,"../drawing":614,d3:163}],651:[function(e,t){"use strict";function a(e,t){var a=t.currentTarget,r=a.getAttribute("data-attr"),o=a.getAttribute("data-val")||!0,n=e._fullLayout,l={},s=g.list(e,null,!0),d="on",c,u;if("zoom"===r){var h="in"===o?.5:2,m=(1+h)/2,y=(1-h)/2,f;for(u=0;u<s.length;u++)if(c=s[u],!c.fixedrange)if(f=c._name,"auto"===o)l[f+".autorange"]=!0;else if("reset"===o){if(void 0===c._rangeInitial)l[f+".autorange"]=!0;else{var x=c._rangeInitial.slice();l[f+".range[0]"]=x[0],l[f+".range[1]"]=x[1]}void 0!==c._showSpikeInitial&&(l[f+".showspikes"]=c._showSpikeInitial,"on"===d&&!c._showSpikeInitial&&(d="off"))}else{var _=[c.r2l(c.range[0]),c.r2l(c.range[1])],b=[m*_[0]+y*_[1],m*_[1]+y*_[0]];l[f+".range[0]"]=c.l2r(b[0]),l[f+".range[1]"]=c.l2r(b[1])}n._cartesianSpikesEnabled=d}else{if("hovermode"===r&&("x"===o||"y"===o))o=n._isHoriz?"y":"x",a.setAttribute("data-val",o);else if("hovermode"===r&&"closest"===o){for(u=0;u<s.length;u++)c=s[u],"on"!==d||c.showspikes||(d="off");n._cartesianSpikesEnabled=d}l[r]=o}p.call("_guiRelayout",e,l)}function r(e,t){for(var a=t.currentTarget,r=a.getAttribute("data-attr"),o=a.getAttribute("data-val")||!0,n=e._fullLayout._subplots.gl3d,l={},s=r.split("."),d=0;d<n.length;d++)l[n[d]+"."+s[1]]=o;var c="pan"===o?o:"zoom";l.dragmode=c,p.call("_guiRelayout",e,l)}function o(e,t){for(var a=t.currentTarget,r=a.getAttribute("data-attr"),o=e._fullLayout,n=o._subplots.gl3d,l={},s=0;s<n.length;s++){var d=n[s],c=d+".camera",u=o[d]._scene;"resetLastSave"===r?(l[c+".up"]=u.viewInitial.up,l[c+".eye"]=u.viewInitial.eye,l[c+".center"]=u.viewInitial.center):"resetDefault"===r&&(l[c+".up"]=null,l[c+".eye"]=null,l[c+".center"]=null)}p.call("_guiRelayout",e,l)}function i(e,t){var a=t.currentTarget,r=a._previousVal,o=e._fullLayout,n=o._subplots.gl3d,l=["xaxis","yaxis","zaxis"],s={},d={};if(r)d=r,a._previousVal=null;else{for(var c=0;c<n.length;c++){var p=n[c],u=o[p],g=p+".hovermode";s[g]=u.hovermode,d[g]=!1;for(var h=0;3>h;h++){var m=l[h],y=p+"."+m+".showspikes";d[y]=!1,s[y]=u[m].showspikes}}a._previousVal=s}return d}function n(e,t){for(var a=t.currentTarget,r=a.getAttribute("data-attr"),o=a.getAttribute("data-val")||!0,n=e._fullLayout,l=n._subplots.geo,s=0;s<l.length;s++){var d=l[s],u=n[d];if("zoom"===r){var g=u.projection.scale,h="in"===o?2*g:.5*g;p.call("_guiRelayout",e,d+".projection.scale",h)}else"reset"===r&&c(e,"geo")}}function l(e){var t=e._fullLayout;return!t.hovermode&&(t._has("cartesian")?t._isHoriz?"y":"x":"closest")}function s(e){var t=l(e);p.call("_guiRelayout",e,"hovermode",t)}function d(e){for(var t=e._fullLayout,a=g.list(e,null,!0),r={},o=0,n,l;o<a.length;o++)n=a[o],l=n._name,r[l+".showspikes"]="on"===t._cartesianSpikesEnabled||n._showSpikeInitial;return r}function c(e,t){for(var a=e._fullLayout,r=a._subplots[t],o={},n=0;n<r.length;n++)for(var l=r[n],s=a[l]._subplot,d=s.viewInitial,c=Object.keys(d),u=0,g;u<c.length;u++)g=c[u],o[l+"."+g]=d[g];p.call("_guiRelayout",e,o)}var p=e("../../registry"),u=e("../../plots/plots"),g=e("../../plots/cartesian/axis_ids"),h=e("../../lib"),m=e("../../fonts/ploticon"),y=h._,f=t.exports={};f.toImage={name:"toImage",title:function(e){var t=e._context.toImageButtonOptions||{},a=t.format||"png";return"png"===a?y(e,"Download plot as a png"):y(e,"Download plot")},icon:m.camera,click:function(e){var t=e._context.toImageButtonOptions,a={format:t.format||"png"};h.notifier(y(e,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==a.format&&h.isIE()&&(h.notifier(y(e,"IE only supports svg.  Changing format to svg."),"long"),a.format="svg"),["filename","width","height","scale"].forEach(function(e){e in t&&(a[e]=t[e])}),p.call("downloadImage",e,a).then(function(t){h.notifier(y(e,"Snapshot succeeded")+" - "+t,"long")}).catch(function(){h.notifier(y(e,"Sorry, there was a problem downloading your snapshot!"),"long")})}},f.sendDataToCloud={name:"sendDataToCloud",title:function(e){return y(e,"Edit in Chart Studio")},icon:m.disk,click:function(e){u.sendDataToCloud(e)}},f.editInChartStudio={name:"editInChartStudio",title:function(e){return y(e,"Edit in Chart Studio")},icon:m.pencil,click:function(e){u.sendDataToCloud(e)}},f.zoom2d={name:"zoom2d",title:function(e){return y(e,"Zoom")},attr:"dragmode",val:"zoom",icon:m.zoombox,click:a},f.pan2d={name:"pan2d",title:function(e){return y(e,"Pan")},attr:"dragmode",val:"pan",icon:m.pan,click:a},f.select2d={name:"select2d",title:function(e){return y(e,"Box Select")},attr:"dragmode",val:"select",icon:m.selectbox,click:a},f.lasso2d={name:"lasso2d",title:function(e){return y(e,"Lasso Select")},attr:"dragmode",val:"lasso",icon:m.lasso,click:a},f.zoomIn2d={name:"zoomIn2d",title:function(e){return y(e,"Zoom in")},attr:"zoom",val:"in",icon:m.zoom_plus,click:a},f.zoomOut2d={name:"zoomOut2d",title:function(e){return y(e,"Zoom out")},attr:"zoom",val:"out",icon:m.zoom_minus,click:a},f.autoScale2d={name:"autoScale2d",title:function(e){return y(e,"Autoscale")},attr:"zoom",val:"auto",icon:m.autoscale,click:a},f.resetScale2d={name:"resetScale2d",title:function(e){return y(e,"Reset axes")},attr:"zoom",val:"reset",icon:m.home,click:a},f.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(e){return y(e,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:m.tooltip_basic,gravity:"ne",click:a},f.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(e){return y(e,"Compare data on hover")},attr:"hovermode",val:function(e){return e._fullLayout._isHoriz?"y":"x"},icon:m.tooltip_compare,gravity:"ne",click:a},f.zoom3d={name:"zoom3d",title:function(e){return y(e,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:m.zoombox,click:r},f.pan3d={name:"pan3d",title:function(e){return y(e,"Pan")},attr:"scene.dragmode",val:"pan",icon:m.pan,click:r},f.orbitRotation={name:"orbitRotation",title:function(e){return y(e,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:m["3d_rotate"],click:r},f.tableRotation={name:"tableRotation",title:function(e){return y(e,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:m["z-axis"],click:r},f.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(e){return y(e,"Reset camera to default")},attr:"resetDefault",icon:m.home,click:o},f.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(e){return y(e,"Reset camera to last save")},attr:"resetLastSave",icon:m.movie,click:o},f.hoverClosest3d={name:"hoverClosest3d",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:function(e,t){var a=i(e,t);p.call("_guiRelayout",e,a)}},f.zoomInGeo={name:"zoomInGeo",title:function(e){return y(e,"Zoom in")},attr:"zoom",val:"in",icon:m.zoom_plus,click:n},f.zoomOutGeo={name:"zoomOutGeo",title:function(e){return y(e,"Zoom out")},attr:"zoom",val:"out",icon:m.zoom_minus,click:n},f.resetGeo={name:"resetGeo",title:function(e){return y(e,"Reset")},attr:"reset",val:null,icon:m.autoscale,click:n},f.hoverClosestGeo={name:"hoverClosestGeo",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:s},f.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:s},f.hoverClosestPie={name:"hoverClosestPie",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:m.tooltip_basic,gravity:"ne",click:s},f.resetViewSankey={name:"resetSankeyGroup",title:function(e){return y(e,"Reset view")},icon:m.home,click:function(e){for(var t={"node.groups":[],"node.x":[],"node.y":[]},a=0,r;a<e._fullData.length;a++)r=e._fullData[a]._viewInitial,t["node.groups"].push(r.node.groups.slice()),t["node.x"].push(r.node.x.slice()),t["node.y"].push(r.node.y.slice());p.call("restyle",e,t)}},f.toggleHover={name:"toggleHover",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:function(e,t){var a=i(e,t);a.hovermode=l(e),p.call("_guiRelayout",e,a)}},f.resetViews={name:"resetViews",title:function(e){return y(e,"Reset views")},icon:m.home,click:function(e,t){var r=t.currentTarget;r.setAttribute("data-attr","zoom"),r.setAttribute("data-val","reset"),a(e,t),r.setAttribute("data-attr","resetLastSave"),o(e,t),c(e,"geo"),c(e,"mapbox")}},f.toggleSpikelines={name:"toggleSpikelines",title:function(e){return y(e,"Toggle Spike Lines")},icon:m.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(e){var t=e._fullLayout;t._cartesianSpikesEnabled="on"===t._cartesianSpikesEnabled?"off":"on";var a=d(e);p.call("_guiRelayout",e,a)}},f.resetViewMapbox={name:"resetViewMapbox",title:function(e){return y(e,"Reset view")},attr:"reset",icon:m.home,click:function(e){c(e,"mapbox")}}},{"../../fonts/ploticon":699,"../../lib":719,"../../plots/cartesian/axis_ids":770,"../../plots/plots":828,"../../registry":847}],652:[function(e,t,a){"use strict";a.manage=e("./manage")},{"./manage":653}],653:[function(e,t){"use strict";function a(e){function t(e){if(e.length){for(var t=[],a=0,r;a<e.length;a++)r=e[a],-1===d.indexOf(r)&&t.push(u[r]);w.push(t)}}var a=e._fullLayout,l=e._fullData,s=e._context,d=s.modeBarButtonsToRemove,c=s.modeBarButtonsToAdd,p=a._has("cartesian"),g=a._has("gl3d"),h=a._has("geo"),m=a._has("pie"),y=a._has("funnelarea"),f=a._has("gl2d"),x=a._has("ternary"),_=a._has("mapbox"),b=a._has("polar"),v=a._has("sankey"),k=r(a),w=[],T=["toImage"];s.showEditInChartStudio?T.push("editInChartStudio"):s.showSendToCloud&&T.push("sendDataToCloud"),t(T);var A=[],S=[],C=[],L=[];return 1<(p||f||m||y||x)+h+g+_+b?(S=["toggleHover"],C=["resetViews"]):h?(A=["zoomInGeo","zoomOutGeo"],S=["hoverClosestGeo"],C=["resetGeo"]):g?(S=["hoverClosest3d"],C=["resetCameraDefault3d","resetCameraLastSave3d"]):_?(S=["toggleHover"],C=["resetViewMapbox"]):f?S=["hoverClosestGl2d"]:m?S=["hoverClosestPie"]:v?(S=["hoverClosestCartesian","hoverCompareCartesian"],C=["resetViewSankey"]):S=["toggleHover"],p&&(S=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),i(l)&&(S=[]),(p||f)&&!k&&(A=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==C[0]&&(C=["resetScale2d"])),g?L=["zoom3d","pan3d","orbitRotation","tableRotation"]:(p||f)&&!k||x?L=["zoom2d","pan2d"]:_||h?L=["pan2d"]:b&&(L=["zoom2d"]),o(l)&&L.push("select2d","lasso2d"),t(L),t(A.concat(C)),t(S),n(w,c)}function r(e){for(var t=s.list({_fullLayout:e},null,!0),a=0;a<t.length;a++)if(!t[a].fixedrange)return!1;return!0}function o(e){for(var t=!1,a=0;a<e.length&&!t;a++){var r=e[a];!r._module||!r._module.selectPoints||(c.traceIs(r,"scatter-like")?(d.hasMarkers(r)||d.hasText(r))&&(t=!0):c.traceIs(r,"box-violin")?("all"===r.boxpoints||"all"===r.points)&&(t=!0):t=!0)}return t}function i(e){for(var t=0;t<e.length;t++)if(!c.traceIs(e[t],"noHover"))return!1;return!0}function n(e,t){if(t.length)if(Array.isArray(t[0]))for(var a=0;a<t.length;a++)e.push(t[a]);else e.push(t);return e}function l(e){for(var t=0,a;t<e.length;t++){a=e[t];for(var r=0,o;r<a.length;r++)if(o=a[r],"string"==typeof o)if(void 0!==u[o])e[t][r]=u[o];else throw new Error("*modeBarButtons* configuration options invalid button name")}return e}var s=e("../../plots/cartesian/axis_ids"),d=e("../../traces/scatter/subtypes"),c=e("../../registry"),p=e("./modebar"),u=e("./buttons");t.exports=function(e){var t=e._fullLayout,r=e._context,o=t._modeBar;if(!r.displayModeBar&&!r.watermark)return void(o&&(o.destroy(),delete t._modeBar));if(!Array.isArray(r.modeBarButtonsToRemove))throw new Error("*modeBarButtonsToRemove* configuration options must be an array.");if(!Array.isArray(r.modeBarButtonsToAdd))throw new Error("*modeBarButtonsToAdd* configuration options must be an array.");var i=r.modeBarButtons,n;n=Array.isArray(i)&&i.length?l(i):!r.displayModeBar&&r.watermark?[]:a(e),o?o.update(e,n):t._modeBar=p(e,n)}},{"../../plots/cartesian/axis_ids":770,"../../registry":847,"../../traces/scatter/subtypes":1135,"./buttons":651,"./modebar":654}],654:[function(e,t){"use strict";function a(e){this.container=e.container,this.element=document.createElement("div"),this.update(e.graphInfo,e.buttons),this.container.appendChild(this.element)}var r=e("d3"),o=e("fast-isnumeric"),i=e("../../lib"),n=e("../../fonts/ploticon"),l=new DOMParser,s=a.prototype;s.update=function(e,t){this.graphInfo=e;var a=this.graphInfo._context,r=this.graphInfo._fullLayout,o="modebar-"+r._uid;this.element.setAttribute("id",o),this._uid=o,this.element.className="modebar","hover"===a.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===r.modebar.orientation&&(this.element.className+=" vertical",t=t.reverse());var n=r.modebar,l="hover"===a.displayModeBar?".js-plotly-plot .plotly:hover ":"";i.deleteRelatedStyleRule(o),i.addRelatedStyleRule(o,l+"#"+o+" .modebar-group","background-color: "+n.bgcolor),i.addRelatedStyleRule(o,"#"+o+" .modebar-btn .icon path","fill: "+n.color),i.addRelatedStyleRule(o,"#"+o+" .modebar-btn:hover .icon path","fill: "+n.activecolor),i.addRelatedStyleRule(o,"#"+o+" .modebar-btn.active .icon path","fill: "+n.activecolor);var s=!this.hasButtons(t),d=this.hasLogo!==a.displaylogo,c=this.locale!==a.locale;if(this.locale=a.locale,(s||d||c)&&(this.removeAllButtons(),this.updateButtons(t),a.watermark||a.displaylogo)){var p=this.getLogo();a.watermark&&(p.className+=" watermark"),"v"===r.modebar.orientation?this.element.insertBefore(p,this.element.childNodes[0]):this.element.appendChild(p),this.hasLogo=!0}this.updateActiveButton()},s.updateButtons=function(e){var t=this;this.buttons=e,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(e){var a=t.createGroup();e.forEach(function(e){var r=e.name;if(!r)throw new Error("must provide button 'name' in button config");if(-1!==t.buttonsNames.indexOf(r))throw new Error("button name '"+r+"' is taken");t.buttonsNames.push(r);var o=t.createButton(e);t.buttonElements.push(o),a.appendChild(o)}),t.element.appendChild(a)})},s.createGroup=function(){var e=document.createElement("div");return e.className="modebar-group",e},s.createButton=function(e){var t=this,a=document.createElement("a");a.setAttribute("rel","tooltip"),a.className="modebar-btn";var o=e.title;void 0===o?o=e.name:"function"==typeof o&&(o=o(this.graphInfo)),(o||0===o)&&a.setAttribute("data-title",o),void 0!==e.attr&&a.setAttribute("data-attr",e.attr);var i=e.val;void 0!==i&&("function"==typeof i&&(i=i(this.graphInfo)),a.setAttribute("data-val",i));var l=e.click;if("function"!=typeof l)throw new Error("must provide button 'click' function in button config");else a.addEventListener("click",function(a){e.click(t.graphInfo,a),t.updateActiveButton(a.currentTarget)});a.setAttribute("data-toggle",e.toggle||!1),e.toggle&&r.select(a).classed("active",!0);var s=e.icon;return"function"==typeof s?a.appendChild(s()):a.appendChild(this.createIcon(s||n.question)),a.setAttribute("data-gravity",e.gravity||"n"),a},s.createIcon=function(e){var t=o(e.height)?+e.height:e.ascent-e.descent,a="http://www.w3.org/2000/svg",r;if(e.path){r=document.createElementNS(a,"svg"),r.setAttribute("viewBox",[0,0,e.width,t].join(" ")),r.setAttribute("class","icon");var i=document.createElementNS(a,"path");i.setAttribute("d",e.path),e.transform?i.setAttribute("transform",e.transform):void 0!==e.ascent&&i.setAttribute("transform","matrix(1 0 0 -1 0 "+e.ascent+")"),r.appendChild(i)}if(e.svg){var n=l.parseFromString(e.svg,"application/xml");r=n.childNodes[0]}return r.setAttribute("height","1em"),r.setAttribute("width","1em"),r},s.updateActiveButton=function(e){var t=this.graphInfo._fullLayout,a=e===void 0?null:e.getAttribute("data-attr");this.buttonElements.forEach(function(e){var o=e.getAttribute("data-val")||!0,n=e.getAttribute("data-attr"),l="true"===e.getAttribute("data-toggle"),s=r.select(e);if(l)n===a&&s.classed("active",!s.classed("active"));else{var d=null===n?n:i.nestedProperty(t,n).get();s.classed("active",d===o)}})},s.hasButtons=function(e){var t=this.buttons;if(!t)return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a){if(e[a].length!==t[a].length)return!1;for(var r=0;r<e[a].length;r++)if(e[a][r].name!==t[a][r].name)return!1}return!0},s.getLogo=function(){var e=this.createGroup(),t=document.createElement("a");return t.href="https://plot.ly/",t.target="_blank",t.setAttribute("data-title",i._(this.graphInfo,"Produced with Plotly")),t.className="modebar-btn plotlyjsicon modebar-btn--logo",t.appendChild(this.createIcon(n.newplotlylogo)),e.appendChild(t),e},s.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},s.destroy=function(){i.removeElement(this.container.querySelector(".modebar")),i.deleteRelatedStyleRule(this._uid)},t.exports=function(e,t){var o=e._fullLayout,i=new a({graphInfo:e,container:o._modebardiv.node(),buttons:t});return o._privateplot&&r.select(i.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),i}},{"../../fonts/ploticon":699,"../../lib":719,d3:163,"fast-isnumeric":225}],655:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("../color/attributes"),o=e("../../plot_api/plot_template").templatedArray,i=o("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});t.exports={visible:{valType:"boolean",editType:"plot"},buttons:i,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:a({editType:"plot"}),bgcolor:{valType:"color",dflt:r.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:r.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":757,"../../plots/font_attributes":793,"../color/attributes":592}],656:[function(e,t){"use strict";t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],657:[function(e,t){"use strict";function a(e,t,a,r){function i(a,r){return o.coerce(e,t,s.buttons,a,r)}var n=r.calendar,l=i("visible");if(l){var d=i("step");"all"!==d&&(n&&"gregorian"!==n&&("month"===d||"year"===d)?t.stepmode="backward":i("stepmode"),i("count")),i("label")}}function r(e,t,a){for(var r=a.filter(function(a){return t[a].anchor===e._id}),o=0,n=0,l;n<r.length;n++)l=t[r[n]].domain,l&&(o=va(l[1],o));return[e.domain[0],o+d.yPad]}var o=e("../../lib"),i=e("../color"),n=e("../../plot_api/plot_template"),l=e("../../plots/array_container_defaults"),s=e("./attributes"),d=e("./constants");t.exports=function(e,t,c,p,u){function g(e,t){return o.coerce(h,m,s,e,t)}var h=e.rangeselector||{},m=n.newContainer(t,"rangeselector"),y=l(h,m,{name:"buttons",handleItemDefaults:a,calendar:u}),f=g("visible",0<y.length);if(f){var x=r(t,c,p);g("x",x[0]),g("y",x[1]),o.noneOrAll(e,t,["x","y"]),g("xanchor"),g("yanchor"),o.coerceFont(g,"font",c.font);var _=g("bgcolor");g("activecolor",i.contrast(_,d.lightAmount,d.darkAmount)),g("bordercolor"),g("borderwidth")}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/array_container_defaults":763,"../color":593,"./attributes":655,"./constants":656}],658:[function(e,t){"use strict";function a(e){for(var t=f.list(e,"x",!0),a=[],r=0,o;r<t.length;r++)o=t[r],o.rangeselector&&o.rangeselector.visible&&a.push(o);return a}function r(e){return e._id}function o(e,t,a){if("all"===t.step)return!0===e.autorange;var r=Object.keys(a);return e.range[0]===a[r[0]]&&e.range[1]===a[r[1]]}function i(e,t,a){var r=m.ensureSingle(e,"rect","selector-rect",function(e){e.attr("shape-rendering","crispEdges")});r.attr({rx:k.rx,ry:k.ry}),r.call(g.stroke,t.bordercolor).call(g.fill,n(t,a)).style("stroke-width",t.borderwidth+"px")}function n(e,t){return t._isActive||t._isHovered?e.activecolor:e.bgcolor}function l(e,t,a,r){var o=m.ensureSingle(e,"text","selector-text",function(e){e.classed("user-select-none",!0).attr("text-anchor","middle")});o.call(h.font,t.font).text(s(a,r._fullLayout._meta)).call(function(e){y.convertToTspans(e,r)})}function s(e,t){return e.label?t?m.templateString(e.label,t):e.label:"all"===e.step?"all":e.count+e.step.charAt(0)}function c(e,t,a,r,o){var i=0,n=0,l=a.borderwidth;t.each(function(){var e=p.select(this),t=e.select(".selector-text"),r=a.font.size*_,o=va(r*y.lineCount(t),16)+3;n=va(n,o)}),t.each(function(){var e=p.select(this),t=e.select(".selector-rect"),r=e.select(".selector-text"),o=r.node()&&h.bBox(r.node()).width,s=a.font.size*_,d=y.lineCount(r),c=va(o+10,k.minButtonWidth);e.attr("transform","translate("+(l+i)+","+l+")"),t.attr({x:0,y:0,width:c,height:n}),y.positionText(r,c/2,n/2-(d-1)*s/2+3),i+=c+5});var s=e._fullLayout._size,d=s.l+s.w*a.x,c=s.t+s.h*(1-a.y),g="left";m.isRightAnchor(a)&&(d-=i,g="right"),m.isCenterAnchor(a)&&(d-=i/2,g="center");var f="top";m.isBottomAnchor(a)&&(c-=n,f="bottom"),m.isMiddleAnchor(a)&&(c-=n/2,f="middle"),i=M(i),n=M(n),d=V(d),c=V(c),u.autoMargin(e,r+"-range-selector",{x:a.x,y:a.y,l:i*b[g],r:i*v[g],b:n*v[f],t:n*b[f]}),o.attr("transform","translate("+d+","+c+")")}var p=e("d3"),d=e("../../registry"),u=e("../../plots/plots"),g=e("../color"),h=e("../drawing"),m=e("../../lib"),y=e("../../lib/svg_text_utils"),f=e("../../plots/cartesian/axis_ids"),x=e("../../constants/alignment"),_=x.LINE_SPACING,b=x.FROM_TL,v=x.FROM_BR,k=e("./constants"),w=e("./get_update_object");t.exports=function(e){var t=e._fullLayout,n=t._infolayer.selectAll(".rangeselector").data(a(e),r);n.enter().append("g").classed("rangeselector",!0),n.exit().remove(),n.style({cursor:"pointer","pointer-events":"all"}),n.each(function(t){var a=p.select(this),r=t,n=r.rangeselector,s=a.selectAll("g.button").data(m.filterVisible(n.buttons));s.enter().append("g").classed("button",!0),s.exit().remove(),s.each(function(t){var a=p.select(this),s=w(r,t);t._isActive=o(r,t,s),a.call(i,n,t),a.call(l,n,t,e),a.on("click",function(){e._dragged||d.call("_guiRelayout",e,s)}),a.on("mouseover",function(){t._isHovered=!0,a.call(i,n,t)}),a.on("mouseout",function(){t._isHovered=!1,a.call(i,n,t)})}),c(e,s,n,r._name,a)})}},{"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axis_ids":770,"../../plots/plots":828,"../../registry":847,"../color":593,"../drawing":614,"./constants":656,"./get_update_object":659,d3:163}],659:[function(e,t){"use strict";function a(e,t){var a=e.range,o=new Date(e.r2l(a[1])),i=t.step,n=t.count,l;switch(t.stepmode){case"backward":l=e.l2r(+r.time[i].utc.offset(o,-n));break;case"todate":var s=r.time[i].utc.offset(o,-n);l=e.l2r(+r.time[i].utc.ceil(s));}var d=a[1];return[l,d]}var r=e("d3");t.exports=function(e,t){var r=e._name,o={};if("all"===t.step)o[r+".autorange"]=!0;else{var i=a(e,t);o[r+".range[0]"]=i[0],o[r+".range[1]"]=i[1]}return o}},{d3:163}],660:[function(e,t){"use strict";t.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":655,"./defaults":657,"./draw":658}],661:[function(e,t){"use strict";var a=e("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:a.background,editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":592}],662:[function(e,t){"use strict";var a=e("../../plots/cartesian/axis_ids").list,r=e("../../plots/cartesian/autorange").getAutoRange,o=e("./constants");t.exports=function(e){for(var t=a(e,"x",!0),n=0;n<t.length;n++){var l=t[n],s=l[o.name];s&&s.visible&&s.autorange&&(s._input.autorange=!0,s._input.range=s.range=r(e,l))}}},{"../../plots/cartesian/autorange":766,"../../plots/cartesian/axis_ids":770,"./constants":663}],663:[function(e,t){"use strict";t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],664:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../plot_api/plot_template"),o=e("../../plots/cartesian/axis_ids"),i=e("./attributes"),n=e("./oppaxis_attributes");t.exports=function(e,t,l){function s(e,t){return a.coerce(u,g,i,e,t)}function d(e,t){return a.coerce(m,y,n,e,t)}var c=e[l],p=t[l];if(c.rangeslider||t._requestRangeslider[p._id]){a.isPlainObject(c.rangeslider)||(c.rangeslider={});var u=c.rangeslider,g=r.newContainer(p,"rangeslider"),h=s("visible"),m,y;if(h){s("bgcolor",t.plot_bgcolor),s("bordercolor"),s("borderwidth"),s("thickness"),s("autorange",!p.isValidRange(u.range)),s("range");var f=t._subplots;if(f)for(var x=f.cartesian.filter(function(e){return e.substr(0,e.indexOf("y"))===o.name2id(l)}).map(function(e){return e.substr(e.indexOf("y"),e.length)}),_=a.simpleMap(x,o.id2name),b=0,v;b<_.length;b++){v=_[b],m=u[v]||{},y=r.newContainer(g,v,"yaxis");var k=t[v],w;m.range&&k.isValidRange(m.range)&&(w="fixed");var T=d("rangemode",w);"match"!==T&&d("range",k.range.slice())}g._input=u}}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/cartesian/axis_ids":770,"./attributes":661,"./oppaxis_attributes":668}],665:[function(e,t){"use strict";function a(t,a,o,i){var n=t.select("rect."+T.slideBoxClassName).node(),l=t.select("rect."+T.grabAreaMinClassName).node(),s=t.select("rect."+T.grabAreaMaxClassName).node();t.on("mousedown",function(){function e(d){var e=+d.clientX-g,c,m,_;switch(p){case n:_="ew-resize",c=y+e,m=f+e;break;case l:_="col-resize",c=y+e,m=f;break;case s:_="col-resize",c=y,m=f+e;break;default:_="ew-resize",c=h,m=h+e;}if(m<c){var b=m;m=c,c=b}i._pixelMin=c,i._pixelMax=m,w(u.select(x),_),r(t,a,o,i)}function d(){x.removeEventListener("mousemove",e),x.removeEventListener("mouseup",d),m.removeElement(x)}var c=u.event,p=c.target,g=c.clientX,h=g-t.node().getBoundingClientRect().left,y=i.d2p(o._rl[0]),f=i.d2p(o._rl[1]),x=k.coverSlip();x.addEventListener("mousemove",e),x.addEventListener("mouseup",d)})}function r(e,t,a,r){function o(e){return a.l2r(m.constrain(e,r._rl[0],r._rl[1]))}var i=o(r.p2d(r._pixelMin)),n=o(r.p2d(r._pixelMax));window.requestAnimationFrame(function(){g.call("_guiRelayout",t,a._name+".range",[i,n])})}function o(e,t,a,r,o,i){function n(e){return m.constrain(e,0,r._width)}function l(e){return m.constrain(e,0,r._height)}function s(e){return m.constrain(e,-d,r._width+d)}var d=T.handleWidth/2,c=n(r.d2p(a._rl[0])),p=n(r.d2p(a._rl[1]));if(e.select("rect."+T.slideBoxClassName).attr("x",c).attr("width",p-c),e.select("rect."+T.maskMinClassName).attr("width",c),e.select("rect."+T.maskMaxClassName).attr("x",p).attr("width",r._width-p),"match"!==i.rangemode){var u=r._height-l(r.d2pOppAxis(o._rl[1])),g=r._height-l(r.d2pOppAxis(o._rl[0]));e.select("rect."+T.maskMinOppAxisClassName).attr("x",c).attr("height",u).attr("width",p-c),e.select("rect."+T.maskMaxOppAxisClassName).attr("x",c).attr("y",g).attr("height",r._height-g).attr("width",p-c),e.select("rect."+T.slideBoxClassName).attr("y",u).attr("height",g-u)}var h=.5,y=V(s(c-d))-h,f=V(s(p-d))+h;e.select("g."+T.grabberMinClassName).attr("transform","translate("+y+","+h+")"),e.select("g."+T.grabberMaxClassName).attr("transform","translate("+f+","+h+")")}function i(e,t,a,r){var o=m.ensureSingle(e,"rect",T.bgClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),i=0==r.borderwidth%2?r.borderwidth:r.borderwidth-1,n=-r._offsetShift,l=y.crispRound(t,r.borderwidth);o.attr({width:r._width+i,height:r._height+i,transform:"translate("+n+","+n+")",fill:r.bgcolor,stroke:r.bordercolor,"stroke-width":l})}function n(e,t,a,r){var o=t._fullLayout,i=m.ensureSingleById(o._topdefs,"clipPath",r._clipId,function(e){e.append("rect").attr({x:0,y:0})});i.select("rect").attr({width:r._width,height:r._height})}function l(e,t,a,r){var o=t.calcdata,i=e.selectAll("g."+T.rangePlotClassName).data(a._subplotsWith,m.identity);i.enter().append("g").attr("class",function(e){return T.rangePlotClassName+" "+e}).call(y.setClipUrl,r._clipId,t),i.order(),i.exit().remove();var n;i.each(function(e,l){var i=u.select(this),d=v.getFromId(t,e,"y"),c=d._name,p=r[c],g={data:[],layout:{xaxis:{type:a.type,domain:[0,1],range:r.range.slice(),calendar:a.calendar},width:r._width,height:r._height,margin:{t:0,b:0,l:0,r:0}},_context:t._context};g.layout[c]={type:d.type,domain:[0,1],range:"match"===p.rangemode?d.range.slice():p.range.slice(),calendar:d.calendar},h.supplyDefaults(g);var m=g._fullLayout.xaxis,y=g._fullLayout[c];m.clearCalc(),m.setScale(),y.clearCalc(),y.setScale();var f={id:e,plotgroup:i,xaxis:m,yaxis:y,isRangePlot:!0};0===l?n=f:(f.mainplot="xy",f.mainplotinfo=n),b.rangePlot(t,f,s(o,e))})}function s(e,t){for(var a=[],r=0;r<e.length;r++){var o=e[r],n=o[0].trace;n.xaxis+n.yaxis===t&&a.push(o)}return a}function d(e,t,a,r,o){var i=m.ensureSingle(e,"rect",T.maskMinClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});i.attr("height",r._height).call(f.fill,T.maskColor);var n=m.ensureSingle(e,"rect",T.maskMaxClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});if(n.attr("height",r._height).call(f.fill,T.maskColor),"match"!==o.rangemode){var l=m.ensureSingle(e,"rect",T.maskMinOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});l.attr("width",r._width).call(f.fill,T.maskOppAxisColor);var s=m.ensureSingle(e,"rect",T.maskMaxOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});s.attr("width",r._width).style("border-top",T.maskOppBorder).call(f.fill,T.maskOppAxisColor)}}function c(e,t,a,r){if(!t._context.staticPlot){var o=m.ensureSingle(e,"rect",T.slideBoxClassName,function(e){e.attr({y:0,cursor:T.slideBoxCursor,"shape-rendering":"crispEdges"})});o.attr({height:r._height,fill:T.slideBoxFill})}}function p(e,t,a,r){var o=m.ensureSingle(e,"g",T.grabberMinClassName),i=m.ensureSingle(e,"g",T.grabberMaxClassName),n={x:0,width:T.handleWidth,rx:T.handleRadius,fill:f.background,stroke:f.defaultLine,"stroke-width":T.handleStrokeWidth,"shape-rendering":"crispEdges"},l={y:V(r._height/4),height:V(r._height/2)},s=m.ensureSingle(o,"rect",T.handleMinClassName,function(e){e.attr(n)});s.attr(l);var d=m.ensureSingle(i,"rect",T.handleMaxClassName,function(e){e.attr(n)});if(d.attr(l),!t._context.staticPlot){var c={width:T.grabAreaWidth,x:0,y:0,fill:T.grabAreaFill,cursor:T.grabAreaCursor},p=m.ensureSingle(o,"rect",T.grabAreaMinClassName,function(e){e.attr(c)});p.attr("height",r._height);var u=m.ensureSingle(i,"rect",T.grabAreaMaxClassName,function(e){e.attr(c)});u.attr("height",r._height)}}var u=e("d3"),g=e("../../registry"),h=e("../../plots/plots"),m=e("../../lib"),y=e("../drawing"),f=e("../color"),_=e("../titles"),b=e("../../plots/cartesian"),v=e("../../plots/cartesian/axis_ids"),k=e("../dragelement"),w=e("../../lib/setcursor"),T=e("./constants");t.exports=function(e){for(var t=e._fullLayout,r=t._rangeSliderData,s=0,g;s<r.length;s++)g=r[s][T.name],g._clipId=g._id+"-"+t._uid;var h=t._infolayer.selectAll("g."+T.containerClassName).data(r,function(e){return e._name});h.exit().each(function(e){var a=e[T.name];t._topdefs.select("#"+a._clipId).remove()}).remove();0===r.length||(h.enter().append("g").classed(T.containerClassName,!0).attr("pointer-events","all"),h.each(function(r){var s=u.select(this),g=r[T.name],h=t[v.id2name(r.anchor)],f=g[v.id2name(r.anchor)];if(g.range){var b=m.simpleMap(g.range,r.r2l),k=m.simpleMap(r.range,r.r2l),w;w=k[0]<k[1]?[ea(b[0],k[0]),va(b[1],k[1])]:[va(b[0],k[0]),ea(b[1],k[1])],g.range=g._input.range=m.simpleMap(w,r.l2r)}r.cleanRange("rangeslider.range");var A=t._size,S=r.domain,C=g._tickHeight,L=g._oppBottom;g._width=A.w*(S[1]-S[0]);var E=V(A.l+A.w*S[0]),x=V(A.t+A.h*(1-L)+C+g._offsetShift+T.extraPad);s.attr("transform","translate("+E+","+x+")");var y=r.r2l(g.range[0]),I=r.r2l(g.range[1]),z=I-y;if(g.p2d=function(e){return e/g._width*z+y},g.d2p=function(e){return(e-y)/z*g._width},g._rl=[y,I],"match"!==f.rangemode){var P=h.r2l(f.range[0]),D=h.r2l(f.range[1]);g.d2pOppAxis=function(e){return(e-P)/(D-P)*g._height}}s.call(i,e,r,g).call(n,e,r,g).call(l,e,r,g).call(d,e,r,g,f).call(c,e,r,g).call(p,e,r,g),a(s,e,r,g),o(s,e,r,g,h,f),"bottom"===r.side&&_.draw(e,r._id+"title",{propContainer:r,propName:r._name+".title",placeholder:t._dfltTitle.x,attributes:{x:r._offset+r._length/2,y:x+g._height+g._offsetShift+10+1.5*r.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":719,"../../lib/setcursor":739,"../../plots/cartesian":778,"../../plots/cartesian/axis_ids":770,"../../plots/plots":828,"../../registry":847,"../color":593,"../dragelement":611,"../drawing":614,"../titles":681,"./constants":663,d3:163}],666:[function(e,t,a){"use strict";function r(e){var t=e&&e[n];return t&&t.visible}var o=e("../../plots/cartesian/axis_ids"),i=e("./constants"),n=i.name;a.isVisible=r,a.makeData=function(e){var t=o.list({_fullLayout:e},"x",!0),a=e.margin,l=[];if(!e._has("gl2d"))for(var s=0,d;s<t.length;s++)if(d=t[s],r(d)){l.push(d);var c=d[n];c._id=n+d._id,c._height=(e.height-a.b-a.t)*c.thickness,c._offsetShift=ba(c.borderwidth/2)}e._rangeSliderData=l},a.autoMarginOpts=function(e,t){for(var a=t[n],r=1/0,l=t._counterAxes,s=0;s<l.length;s++){var d=l[s],c=o.getFromId(e,d);r=ea(r,c.domain[0])}a._oppBottom=r;var p="bottom"===t.side&&t._boundingBox.height||0;return a._tickHeight=p,{x:0,y:r,l:0,r:0,t:0,b:a._height+e._fullLayout.margin.b+p,pad:i.extraPad+2*a._offsetShift}}},{"../../plots/cartesian/axis_ids":770,"./constants":663}],667:[function(e,t){"use strict";var a=e("../../lib"),r=e("./attributes"),o=e("./oppaxis_attributes"),i=e("./helpers");t.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:a.extendFlat({},r,{yaxis:o})}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),calcAutorange:e("./calc_autorange"),draw:e("./draw"),isVisible:i.isVisible,makeData:i.makeData,autoMarginOpts:i.autoMarginOpts}},{"../../lib":719,"./attributes":661,"./calc_autorange":662,"./defaults":664,"./draw":665,"./helpers":666,"./oppaxis_attributes":668}],668:[function(e,t){"use strict";t.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],669:[function(e,t){"use strict";var a=e("../annotations/attributes"),r=e("../../traces/scatter/attributes").line,o=e("../drawing/attributes").dash,i=e("../../lib/extend").extendFlat,n=e("../../plot_api/plot_template").templatedArray;t.exports=n("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:i({},a.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:i({},a.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:i({},r.color,{editType:"arraydraw"}),width:i({},r.width,{editType:"calc+arraydraw"}),dash:i({},o,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},editType:"arraydraw"})},{"../../lib/extend":710,"../../plot_api/plot_template":757,"../../traces/scatter/attributes":1112,"../annotations/attributes":576,"../drawing/attributes":613}],670:[function(e,t){"use strict";function a(e){return o(e.line.width,e.xsizemode,e.x0,e.x1,e.path,!1)}function r(e){return o(e.line.width,e.ysizemode,e.y0,e.y1,e.path,!0)}function o(e,t,a,r,o,i){var l=e/2,c=i;if("pixel"===t){var p=o?d.extractPathCoords(o,i?s.paramIsY:s.paramIsX):[a,r],u=n.aggNums(Math.max,null,p),g=n.aggNums(Math.min,null,p),h=0>g?_a(g)+l:l,m=0<u?u+l:l;return{ppad:l,ppadplus:c?h:m,ppadminus:c?m:h}}return{ppad:l}}function i(e,t,a,r,o){var n="category"===e.type||"multicategory"===e.type?e.r2c:e.d2c;if(t!==void 0)return[n(t),n(a)];if(r){var l=1/0,c=-Infinity,p=r.match(s.segmentRE),u,g,h,m,y;for("date"===e.type&&(n=d.decodeDate(n)),u=0;u<p.length;u++)g=p[u],h=o[g.charAt(0)].drawn,void 0===h||(m=p[u].substr(1).match(s.paramRE),m&&!(m.length<h)&&(y=n(m[h]),y<l&&(l=y),y>c&&(c=y)));if(c>=l)return[l,c]}}var n=e("../../lib"),l=e("../../plots/cartesian/axes"),s=e("./constants"),d=e("./helpers");t.exports=function(e){var t=e._fullLayout,o=n.filterVisible(t.shapes);if(o.length&&e._fullData.length)for(var d=0,c;d<o.length;d++){c=o[d],c._extremes={};var p,u;if("paper"!==c.xref){var g="pixel"===c.xsizemode?c.xanchor:c.x0,h="pixel"===c.xsizemode?c.xanchor:c.x1;p=l.getFromId(e,c.xref),u=i(p,g,h,c.path,s.paramIsX),u&&(c._extremes[p._id]=l.findExtremes(p,u,a(c)))}if("paper"!==c.yref){var m="pixel"===c.ysizemode?c.yanchor:c.y0,y="pixel"===c.ysizemode?c.yanchor:c.y1;p=l.getFromId(e,c.yref),u=i(p,m,y,c.path,s.paramIsY),u&&(c._extremes[p._id]=l.findExtremes(p,u,r(c)))}}}},{"../../lib":719,"../../plots/cartesian/axes":767,"./constants":671,"./helpers":674}],671:[function(e,t){"use strict";t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],672:[function(e,t){"use strict";function a(e,t,a){function s(a,o){return r.coerce(e,t,n,a,o)}var d=s("visible");if(d){s("layer"),s("opacity"),s("fillcolor"),s("line.color"),s("line.width"),s("line.dash");for(var c=e.path?"path":"rect",p=s("type",c),u=s("xsizemode"),g=s("ysizemode"),h=["x","y"],m=0;2>m;m++){var y=h[m],f=y+"anchor",x="x"===y?u:g,_={_fullLayout:a},b=o.coerceRef(e,t,_,y,"","paper"),v,k,w;if("paper"===b?k=w=r.identity:(v=o.getFromId(_,b),v._shapeIndices.push(t._index),w=l.rangeToShapePosition(v),k=l.shapePositionToRange(v)),"path"!==p){var T=y+"0",A=y+"1",S=e[T],C=e[A];e[T]=k(e[T],!0),e[A]=k(e[A],!0),"pixel"===x?(s(T,0),s(A,10)):(o.coercePosition(t,_,s,b,T,.25),o.coercePosition(t,_,s,b,A,.75)),t[T]=w(t[T]),t[A]=w(t[A]),e[T]=S,e[A]=C}if("pixel"===x){var L=e[f];e[f]=k(e[f],!0),o.coercePosition(t,_,s,b,f,.25),t[f]=w(t[f]),e[f]=L}}"path"===p?s("path"):r.noneOrAll(e,t,["x0","x1","y0","y1"])}}var r=e("../../lib"),o=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("./helpers");t.exports=function(e,t){i(e,t,{name:"shapes",handleItemDefaults:a})}},{"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"./attributes":669,"./helpers":674}],673:[function(e,t){"use strict";function a(e,t){function a(a){var l={"data-index":t,"fill-rule":"evenodd",d:i(e,n)},s=n.line.width?n.line.color:"rgba(0,0,0,0)",d=a.append("path").attr(l).style("opacity",n.opacity).call(p.stroke,s).call(p.fill,n.fillcolor).call(u.dashLine,n.line.dash,n.line.width);r(d,e,n),e._context.edits.shapePosition&&o(e,d,n,t,a)}e._fullLayout._paperdiv.selectAll(".shapelayer [data-index=\""+t+"\"]").remove();var n=e._fullLayout.shapes[t]||{};if(n._input&&!1!==n.visible)if("below"!==n.layer)a(e._fullLayout._shapeUpperLayer);else if("paper"===n.xref||"paper"===n.yref)a(e._fullLayout._shapeLowerLayer);else{var l=e._fullLayout._plots[n.xref+n.yref];if(l){var s=l.mainplotinfo||l;a(s.shapelayer)}else a(e._fullLayout._shapeLowerLayer)}}function r(e,t,a){var r=(a.xref+a.yref).replace(/paper/g,"");u.setClipUrl(e,r?"clip"+t._fullLayout._uid+r:null,t)}function o(e,t,a,o,n){function p(){var e=va(a.line.width,10),r=n.append("g").attr("data-index",o);r.append("path").attr("d",t.attr("d")).style({cursor:"move","stroke-width":e,"stroke-opacity":"0"});var i={"fill-opacity":"0"},l=10<e/2?e/2:10;return r.append("circle").attr({"data-line-point":"start-point",cx:A?D(a.xanchor)+a.x0:D(a.x0),cy:S?O(a.yanchor)-a.y0:O(a.y0),r:l}).style(i).classed("cursor-grab",!0),r.append("circle").attr({"data-line-point":"end-point",cx:A?D(a.xanchor)+a.x1:D(a.x1),cy:S?O(a.yanchor)-a.y1:O(a.y1),r:l}).style(i).classed("cursor-grab",!0),r}function h(e){if(C)ee="path"===e.target.tagName?"move":"start-point"===e.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var a=F.element.getBoundingClientRect(),r=a.right-a.left,o=a.bottom-a.top,i=e.clientX-a.left,n=e.clientY-a.top,l=!L&&r>10&&o>10&&!e.shiftKey?m.getCursor(i/r,1-n/o):"move";f(t,l),ee=l.split("-")[0]}}function y(r){A&&(H=D(a.xanchor)),S&&(G=O(a.yanchor)),"path"===a.type?$=a.path:(B=A?a.x0:D(a.x0),N=S?a.y0:O(a.y0),V=A?a.x1:D(a.x1),U=S?a.y1:O(a.y1)),B<V?(W=B,J="x0",X=V,Q="x1"):(W=V,J="x1",X=B,Q="x0"),!S&&N<U||S&&N>U?(q=N,Z="y0",Y=U,K="y1"):(q=U,Z="y1",Y=N,K="y0"),h(r),k(n,a),T(t,a,e),F.moveFn="move"===ee?b:v}function b(r,o){if("path"===a.type){var s=function(e){return e},d=s,c=s;A?I("xanchor",a.xanchor=R(H+r)):(d=function(e){return R(D(e)+r)},z&&"date"===z.type&&(d=_.encodeDate(d))),S?I("yanchor",a.yanchor=M(G+o)):(c=function(e){return M(O(e)+o)},P&&"date"===P.type&&(c=_.encodeDate(c))),I("path",a.path=l($,d,c))}else A?I("xanchor",a.xanchor=R(H+r)):(I("x0",a.x0=R(B+r)),I("x1",a.x1=R(V+r))),S?I("yanchor",a.yanchor=M(G+o)):(I("y0",a.y0=M(N+o)),I("y1",a.y1=M(U+o)));t.attr("d",i(e,a)),k(n,a)}function v(r,o){if(L){var s=function(e){return e},d=s,c=s;A?I("xanchor",a.xanchor=R(H+r)):(d=function(e){return R(D(e)+r)},z&&"date"===z.type&&(d=_.encodeDate(d))),S?I("yanchor",a.yanchor=M(G+o)):(c=function(e){return M(O(e)+o)},P&&"date"===P.type&&(c=_.encodeDate(c))),I("path",a.path=l($,d,c))}else if(!C){var p=~ee.indexOf("n")?q+o:q,u=~ee.indexOf("s")?Y+o:Y,g=~ee.indexOf("w")?W+r:W,h=~ee.indexOf("e")?X+r:X;~ee.indexOf("n")&&S&&(p=q-o),~ee.indexOf("s")&&S&&(u=Y-o),(!S&&u-p>10||S&&p-u>10)&&(I(Z,a[Z]=S?p:M(p)),I(K,a[K]=S?u:M(u))),h-g>10&&(I(J,a[J]=A?g:R(g)),I(Q,a[Q]=A?h:R(h)))}else if("resize-over-start-point"===ee){var m=B+r,y=S?N-o:N+o;I("x0",a.x0=A?m:R(m)),I("y0",a.y0=S?y:M(y))}else if("resize-over-end-point"===ee){var f=V+r,x=S?U-o:U+o;I("x1",a.x1=A?f:R(f)),I("y1",a.y1=S?x:M(x))}t.attr("d",i(e,a)),k(n,a)}function k(e,t){(A||S)&&function(){var a="path"!==t.type,r=e.selectAll(".visual-cue").data([0]),o=1;r.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":o}).classed("visual-cue",!0);var i=D(A?t.xanchor:d.midRange(a?[t.x0,t.x1]:_.extractPathCoords(t.path,x.paramIsX))),n=O(S?t.yanchor:d.midRange(a?[t.y0,t.y1]:_.extractPathCoords(t.path,x.paramIsY)));if(i=_.roundPositionForSharpStrokeRendering(i,o),n=_.roundPositionForSharpStrokeRendering(n,o),A&&S){var l="M"+(i-1-o)+","+(n-1-o)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";r.attr("d",l)}else if(A){var s="M"+(i-1-o)+","+(n-9-o)+"v18 h2 v-18 Z";r.attr("d",s)}else{var c="M"+(i-9-o)+","+(n-1-o)+"h18 v2 h-18 Z";r.attr("d",c)}}()}function w(e){e.selectAll(".visual-cue").remove()}function T(e,t,a){var r=t.xref,o=t.yref,i=c.getFromId(a,r),n=c.getFromId(a,o),l="";"paper"===r||i.autorange||(l+=r),"paper"===o||n.autorange||(l+=o),u.setClipUrl(e,l?"clip"+a._fullLayout._uid+l:null,a)}var A="pixel"===a.xsizemode,S="pixel"===a.ysizemode,C="line"===a.type,L="path"===a.type,E=g(e.layout,"shapes",a),I=E.modifyItem,z=c.getFromId(e,a.xref),P=c.getFromId(e,a.yref),D=_.getDataToPixel(e,z),O=_.getDataToPixel(e,P,!0),R=_.getPixelToData(e,z),M=_.getPixelToData(e,P,!0),j=function(){return C?p():t}(),F={element:j.node(),gd:e,prepFn:y,doneFn:function(){f(t),w(n),r(t,e,a),s.call("_guiRelayout",e,E.getUpdateObj())},clickFn:function(){w(n)}},B,N,V,U,H,G,q,Y,W,X,Z,K,J,Q,$,ee;m.init(F),j.node().onmousemove=h}function i(e,t){var a=t.type,r=c.getFromId(e,t.xref),o=c.getFromId(e,t.yref),i=e._fullLayout._size,l,s,d,p,u,g,h,m;if(r?(l=_.shapePositionToRange(r),s=function(e){return r._offset+r.r2p(l(e,!0))}):s=function(e){return i.l+i.w*e},o?(d=_.shapePositionToRange(o),p=function(e){return o._offset+o.r2p(d(e,!0))}):p=function(e){return i.t+i.h*(1-e)},"path"===a)return r&&"date"===r.type&&(s=_.decodeDate(s)),o&&"date"===o.type&&(p=_.decodeDate(p)),n(t,s,p);if("pixel"===t.xsizemode){var y=s(t.xanchor);u=y+t.x0,g=y+t.x1}else u=s(t.x0),g=s(t.x1);if("pixel"===t.ysizemode){var f=p(t.yanchor);h=f-t.y0,m=f-t.y1}else h=p(t.y0),m=p(t.y1);if("line"===a)return"M"+u+","+h+"L"+g+","+m;if("rect"===a)return"M"+u+","+h+"H"+g+"V"+m+"H"+u+"Z";var x=(u+g)/2,b=(h+m)/2,v=_a(x-u),k=_a(b-h),w="A"+v+","+k,T=x+v+","+b;return"M"+T+w+" 0 1,1 "+(x+","+(b-k))+w+" 0 0,1 "+T+"Z"}function n(e,t,a){var r=e.path,o=e.xsizemode,i=e.ysizemode,n=e.xanchor,l=e.yanchor;return r.replace(x.segmentRE,function(e){var r=0,s=e.charAt(0),c=x.paramIsX[s],p=x.paramIsY[s],u=x.numParams[s],g=e.substr(1).replace(x.paramRE,function(e){return c[r]?"pixel"===o?e=t(n)+ +e:e=t(e):p[r]&&("pixel"===i?e=a(l)-+e:e=a(e)),r++,r>u&&(e="X"),e});return r>u&&(g=g.replace(/[\s,]*X.*/,""),d.log("Ignoring extra params in segment "+e)),s+g})}function l(e,t,a){return e.replace(x.segmentRE,function(e){var r=0,o=e.charAt(0),i=x.paramIsX[o],n=x.paramIsY[o],l=x.numParams[o],s=e.substr(1).replace(x.paramRE,function(e){return r>=l?e:(i[r]?e=t(e):n[r]&&(e=a(e)),r++,e)});return o+s})}var s=e("../../registry"),d=e("../../lib"),c=e("../../plots/cartesian/axes"),p=e("../color"),u=e("../drawing"),g=e("../../plot_api/plot_template").arrayEditor,m=e("../dragelement"),f=e("../../lib/setcursor"),x=e("./constants"),_=e("./helpers");t.exports={draw:function(e){var t=e._fullLayout;for(var r in t._shapeUpperLayer.selectAll("path").remove(),t._shapeLowerLayer.selectAll("path").remove(),t._plots){var o=t._plots[r].shapelayer;o&&o.selectAll("path").remove()}for(var n=0;n<t.shapes.length;n++)t.shapes[n].visible&&a(e,n)},drawOne:a}},{"../../lib":719,"../../lib/setcursor":739,"../../plot_api/plot_template":757,"../../plots/cartesian/axes":767,"../../registry":847,"../color":593,"../dragelement":611,"../drawing":614,"./constants":671,"./helpers":674}],674:[function(e,t,a){"use strict";var r=e("./constants"),o=e("../../lib");a.rangeToShapePosition=function(e){return"log"===e.type?e.r2d:function(e){return e}},a.shapePositionToRange=function(e){return"log"===e.type?e.d2r:function(e){return e}},a.decodeDate=function(e){return function(t){return t.replace&&(t=t.replace("_"," ")),e(t)}},a.encodeDate=function(e){return function(t){return e(t).replace(" ","_")}},a.extractPathCoords=function(e,t){var a=[],i=e.match(r.segmentRE);return i.forEach(function(e){var i=t[e.charAt(0)].drawn;if(void 0!==i){var n=e.substr(1).match(r.paramRE);!n||n.length<i||a.push(o.cleanNumber(n[i]))}}),a},a.getDataToPixel=function(e,t,r){var o=e._fullLayout._size,i;if(t){var n=a.shapePositionToRange(t);i=function(e){return t._offset+t.r2p(n(e,!0))},"date"===t.type&&(i=a.decodeDate(i))}else i=r?function(e){return o.t+o.h*(1-e)}:function(e){return o.l+o.w*e};return i},a.getPixelToData=function(e,t,r){var o=e._fullLayout._size,i;if(t){var n=a.rangeToShapePosition(t);i=function(e){return n(t.p2r(e-t._offset))}}else i=r?function(e){return 1-(e-o.t)/o.h}:function(e){return(e-o.l)/o.w};return i},a.roundPositionForSharpStrokeRendering=function(e,t){var a=1===V(t%2),r=V(e);return a?r+.5:r}},{"../../lib":719,"./constants":671}],675:[function(e,t){"use strict";var a=e("./draw");t.exports={moduleType:"component",name:"shapes",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("shapes"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne}},{"../../plots/cartesian/include_components":777,"./attributes":669,"./calc_autorange":670,"./defaults":672,"./draw":673}],676:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("../../plots/pad_attributes"),o=e("../../lib/extend").extendDeepAll,i=e("../../plot_api/edit_types").overrideAll,n=e("../../plots/animation_attributes"),l=e("../../plot_api/plot_template").templatedArray,s=e("./constants"),d=l("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});t.exports=i(l("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:d,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:o(r({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:n.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:a({})},font:a({}),activebgcolor:{valType:"color",dflt:s.gripBgActiveColor},bgcolor:{valType:"color",dflt:s.railBgColor},bordercolor:{valType:"color",dflt:s.railBorderColor},borderwidth:{valType:"number",min:0,dflt:s.railBorderWidth},ticklen:{valType:"number",min:0,dflt:s.tickLength},tickcolor:{valType:"color",dflt:s.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:s.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/animation_attributes":762,"../../plots/font_attributes":793,"../../plots/pad_attributes":827,"./constants":677}],677:[function(e,t){"use strict";t.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],678:[function(e,t){"use strict";function a(e,t,a){function s(a,r){return o.coerce(e,t,l,a,r)}for(var d=n(e,t,{name:"steps",handleItemDefaults:r}),c=0,p=0;p<d.length;p++)d[p].visible&&c++;var u;if(u=2>c?t.visible=!1:s("visible"),!!u){t._stepCount=c;var g=t._visibleSteps=o.filterVisible(d),h=s("active");(d[h]||{}).visible||(t.active=g[0]._index),s("x"),s("y"),o.noneOrAll(e,t,["x","y"]),s("xanchor"),s("yanchor"),s("len"),s("lenmode"),s("pad.t"),s("pad.r"),s("pad.b"),s("pad.l"),o.coerceFont(s,"font",a.font);var m=s("currentvalue.visible");m&&(s("currentvalue.xanchor"),s("currentvalue.prefix"),s("currentvalue.suffix"),s("currentvalue.offset"),o.coerceFont(s,"currentvalue.font",t.font)),s("transition.duration"),s("transition.easing"),s("bgcolor"),s("activebgcolor"),s("bordercolor"),s("borderwidth"),s("ticklen"),s("tickwidth"),s("tickcolor"),s("minorticklen")}}function r(e,t){function a(a,r){return o.coerce(e,t,c,a,r)}var r;if(r="skip"===e.method||Array.isArray(e.args)?a("visible"):t.visible=!1,r){a("method"),a("args");var i=a("label","step-"+t._index);a("value",i),a("execute")}}var o=e("../../lib"),n=e("../../plots/array_container_defaults"),l=e("./attributes"),s=e("./constants"),d=s.name,c=l.steps;t.exports=function(e,t){n(e,t,{name:d,handleItemDefaults:a})}},{"../../lib":719,"../../plots/array_container_defaults":763,"./attributes":676,"./constants":677}],679:[function(e,t){"use strict";function a(e){return L.autoMarginIdRoot+e._index}function r(e,t){for(var a=e[L.name],r=[],o=0,n;o<a.length;o++)n=a[o],n.visible&&(n._gd=t,r.push(n));return r}function o(e){return e._index}function n(e,t){var r=T.tester.selectAll("g."+L.labelGroupClass).data(t._visibleSteps);r.enter().append("g").classed(L.labelGroupClass,!0);var o=0,n=0;r.each(function(e){var a=w.select(this),r=c(a,{step:e},t),i=r.node();if(i){var l=T.bBox(i);n=va(n,l.height),o=va(o,l.width)}}),r.remove();var l=t._dims={};l.inputAreaWidth=va(L.railWidth,L.gripHeight);var d=e._fullLayout._size;l.lx=d.l+d.w*t.x,l.ly=d.t+d.h*(1-t.y),l.outerLength="fraction"===t.lenmode?V(d.w*t.len):t.len,l.inputAreaStart=0,l.inputAreaLength=V(l.outerLength-t.pad.l-t.pad.r);var p=l.inputAreaLength-2*L.stepInset,u=p/(t._stepCount-1),g=o+L.labelPadding;if(l.labelStride=va(1,M(g/u)),l.labelHeight=n,l.currentValueMaxWidth=0,l.currentValueHeight=0,l.currentValueTotalHeight=0,l.currentValueMaxLines=1,t.currentvalue.visible){var h=T.tester.append("g");r.each(function(e){var a=s(h,t,e.label),r=a.node()&&T.bBox(a.node())||{width:0,height:0},o=S.lineCount(a);l.currentValueMaxWidth=va(l.currentValueMaxWidth,M(r.width)),l.currentValueHeight=va(l.currentValueHeight,M(r.height)),l.currentValueMaxLines=va(l.currentValueMaxLines,o)}),l.currentValueTotalHeight=l.currentValueHeight+t.currentvalue.offset,h.remove()}l.height=l.currentValueTotalHeight+L.tickOffset+t.ticklen+L.labelOffset+l.labelHeight+t.pad.t+t.pad.b;var m="left";A.isRightAnchor(t)&&(l.lx-=l.outerLength,m="right"),A.isCenterAnchor(t)&&(l.lx-=l.outerLength/2,m="center");var y="top";A.isBottomAnchor(t)&&(l.ly-=l.height,y="bottom"),A.isMiddleAnchor(t)&&(l.ly-=l.height/2,y="middle"),l.outerLength=M(l.outerLength),l.height=M(l.height),l.lx=V(l.lx),l.ly=V(l.ly);var f={y:t.y,b:l.height*P[y],t:l.height*z[y]};"fraction"===t.lenmode?(f.l=0,f.xl=t.x-t.len*z[m],f.r=0,f.xr=t.x+t.len*P[m]):(f.x=t.x,f.l=l.outerLength*z[m],f.r=l.outerLength*P[m]),i.autoMargin(e,a(t),f)}function l(e,t,a){(a.steps[a.active]||{}).visible||(a.active=a._visibleSteps[0]._index),t.call(s,a).call(k,a).call(p,a).call(m,a).call(v,e,a).call(d,e,a);var r=a._dims;T.setTranslate(t,r.lx+a.pad.l,r.ly+a.pad.t),t.call(f,a,!1),t.call(s,a)}function s(e,t,a){if(t.currentvalue.visible){var r=t._dims,o,i;switch(t.currentvalue.xanchor){case"right":o=r.inputAreaLength-L.currentValueInset-r.currentValueMaxWidth,i="left";break;case"center":o=.5*r.inputAreaLength,i="middle";break;default:o=L.currentValueInset,i="left";}var n=A.ensureSingle(e,"text",L.labelClass,function(e){e.classed("user-select-none",!0).attr({"text-anchor":i,"data-notex":1})}),l=t.currentvalue.prefix?t.currentvalue.prefix:"";if("string"==typeof a)l+=a;else{var s=t.steps[t.active].label,d=t._gd._fullLayout._meta;d&&(s=A.templateString(s,d)),l+=s}t.currentvalue.suffix&&(l+=t.currentvalue.suffix),n.call(T.font,t.currentvalue.font).text(l).call(S.convertToTspans,t._gd);var c=S.lineCount(n),p=(r.currentValueMaxLines+1-c)*t.currentvalue.font.size*I;return S.positionText(n,o,p),n}}function d(e,t,a){var r=A.ensureSingle(e,"rect",L.gripRectClass,function(r){r.call(h,t,e,a).style("pointer-events","all")});r.attr({width:L.gripWidth,height:L.gripHeight,rx:L.gripRadius,ry:L.gripRadius}).call(x.stroke,a.bordercolor).call(x.fill,a.bgcolor).style("stroke-width",a.borderwidth+"px")}function c(e,t,a){var r=A.ensureSingle(e,"text",L.labelClass,function(e){e.classed("user-select-none",!0).attr({"text-anchor":"middle","data-notex":1})}),o=t.step.label,i=a._gd._fullLayout._meta;return i&&(o=A.templateString(o,i)),r.call(T.font,a.font).text(o).call(S.convertToTspans,a._gd),r}function p(e,t){var a=A.ensureSingle(e,"g",L.labelsClass),r=t._dims,o=a.selectAll("g."+L.labelGroupClass).data(r.labelSteps);o.enter().append("g").classed(L.labelGroupClass,!0),o.exit().remove(),o.each(function(e){var a=w.select(this);a.call(c,e,t),T.setTranslate(a,_(t,e.fraction),L.tickOffset+t.ticklen+t.font.size*I+L.labelOffset+r.currentValueTotalHeight)})}function u(e,t,a,r,o){var i=V(r*(a._stepCount-1)),n=a._visibleSteps[i]._index;n!==a.active&&g(e,t,a,n,!0,o)}function g(e,t,a,r,o,n){var l=a.active;a.active=r,C(e.layout,L.name,a).applyUpdate("active",r);var d=a.steps[a.active];t.call(f,a,n),t.call(s,a),e.emit("plotly_sliderchange",{slider:a,step:a.steps[a.active],interaction:o,previousActive:l}),d&&d.method&&o&&(t._nextMethod?(t._nextMethod.step=d,t._nextMethod.doCallback=o,t._nextMethod.doTransition=n):(t._nextMethod={step:d,doCallback:o,doTransition:n},t._nextMethodRaf=window.requestAnimationFrame(function(){var a=t._nextMethod.step;a.method&&(a.execute&&i.executeAPICommand(e,a.method,a.args),t._nextMethod=null,t._nextMethodRaf=null)})))}function h(e,t,a){function r(){return a.data()[0]}var o=a.node(),i=w.select(t);e.on("mousedown",function(){var e=r();t.emit("plotly_sliderstart",{slider:e});var n=a.select("."+L.gripRectClass);w.event.stopPropagation(),w.event.preventDefault(),n.call(x.fill,e.activebgcolor);var l=b(e,w.mouse(o)[0]);u(t,a,e,l,!0),e._dragging=!0,i.on("mousemove",function(){var e=r(),i=b(e,w.mouse(o)[0]);u(t,a,e,i,!1)}),i.on("mouseup",function(){var e=r();e._dragging=!1,n.call(x.fill,e.bgcolor),i.on("mouseup",null),i.on("mousemove",null),t.emit("plotly_sliderend",{slider:e,step:e.steps[e.active]})})})}function m(e,t){var a=e.selectAll("rect."+L.tickRectClass).data(t._visibleSteps),r=t._dims;a.enter().append("rect").classed(L.tickRectClass,!0),a.exit().remove(),a.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"}),a.each(function(e,a){var o=0==a%r.labelStride,i=w.select(this);i.attr({height:o?t.ticklen:t.minorticklen}).call(x.fill,o?t.tickcolor:t.tickcolor),T.setTranslate(i,_(t,a/(t._stepCount-1))-.5*t.tickwidth,(o?L.tickOffset:L.minorTickOffset)+r.currentValueTotalHeight)})}function y(e){var t=e._dims;t.labelSteps=[];for(var a=e._stepCount,r=0;r<a;r+=t.labelStride)t.labelSteps.push({fraction:r/(a-1),step:e._visibleSteps[r]})}function f(e,t,a){for(var r=e.select("rect."+L.gripRectClass),o=0,n=0;n<t._stepCount;n++)if(t._visibleSteps[n]._index===t.active){o=n;break}var l=_(t,o/(t._stepCount-1));if(!t._invokingCommand){var s=r;a&&0<t.transition.duration&&(s=s.transition().duration(t.transition.duration).ease(t.transition.easing)),s.attr("transform","translate("+(l-.5*L.gripWidth)+","+t._dims.currentValueTotalHeight+")")}}function _(e,t){var a=e._dims;return a.inputAreaStart+L.stepInset+(a.inputAreaLength-2*L.stepInset)*ea(1,va(0,t))}function b(e,t){var a=e._dims;return ea(1,va(0,(t-L.stepInset-a.inputAreaStart)/(a.inputAreaLength-2*L.stepInset-2*a.inputAreaStart)))}function v(e,t,a){var r=a._dims,o=A.ensureSingle(e,"rect",L.railTouchRectClass,function(r){r.call(h,t,e,a).style("pointer-events","all")});o.attr({width:r.inputAreaLength,height:va(r.inputAreaWidth,L.tickOffset+a.ticklen+r.labelHeight)}).call(x.fill,a.bgcolor).attr("opacity",0),T.setTranslate(o,0,r.currentValueTotalHeight)}function k(e,t){var a=t._dims,r=a.inputAreaLength-2*L.railInset,o=A.ensureSingle(e,"rect",L.railRectClass);o.attr({width:r,height:L.railWidth,rx:L.railRadius,ry:L.railRadius,"shape-rendering":"crispEdges"}).call(x.stroke,t.bordercolor).call(x.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px"),T.setTranslate(o,L.railInset,.5*(a.inputAreaWidth-L.railWidth)+a.currentValueTotalHeight)}var w=e("d3"),i=e("../../plots/plots"),x=e("../color"),T=e("../drawing"),A=e("../../lib"),S=e("../../lib/svg_text_utils"),C=e("../../plot_api/plot_template").arrayEditor,L=e("./constants"),E=e("../../constants/alignment"),I=E.LINE_SPACING,z=E.FROM_TL,P=E.FROM_BR;t.exports=function(e){function t(t){t._commandObserver&&(t._commandObserver.remove(),delete t._commandObserver),i.autoMargin(e,a(t))}var s=e._fullLayout,d=r(s,e),c=s._infolayer.selectAll("g."+L.containerClassName).data(0<d.length?[0]:[]);if(c.enter().append("g").classed(L.containerClassName,!0).style("cursor","ew-resize"),c.exit().each(function(){w.select(this).selectAll("g."+L.groupClassName).each(t)}).remove(),0!==d.length){var p=c.selectAll("g."+L.groupClassName).data(d,o);p.enter().append("g").classed(L.groupClassName,!0),p.exit().each(t).remove();for(var u=0,h;u<d.length;u++)h=d[u],n(e,h);p.each(function(t){var a=w.select(this);y(t),i.manageCommandObserver(e,t,t._visibleSteps,function(t){var r=a.data()[0];r.active===t.index||r._dragging||g(e,a,r,t.index,!1,!0)}),l(e,w.select(this),t)})}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plot_api/plot_template":757,"../../plots/plots":828,"../color":593,"../drawing":614,"./constants":677,d3:163}],680:[function(e,t){"use strict";var a=e("./constants");t.exports={moduleType:"component",name:a.name,layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":676,"./constants":677,"./defaults":678,"./draw":679}],681:[function(e,t){"use strict";var a=e("d3"),r=e("fast-isnumeric"),o=e("../../plots/plots"),i=e("../../registry"),n=e("../../lib"),l=e("../drawing"),s=e("../color"),c=e("../../lib/svg_text_utils"),p=e("../../constants/interactions");t.exports={draw:function(e,t,d){function g(e){n.syncOrAsync([h,m],e)}function h(t){var r;return k?(r="",k.rotate&&(r+="rotate("+[k.rotate,v.x,v.y]+")"),k.offset&&(r+="translate(0, "+k.offset+")")):r=null,t.attr("transform",r),t.style({"font-family":I,"font-size":a.round(z,2)+"px",fill:s.rgb(P),opacity:A*s.opacity(P),"font-weight":o.fontWeight}).attr(v).call(c.convertToTspans,e),o.previousPromises(e)}function m(e){var t=a.select(e.node().parentNode);if(b&&b.selection&&b.side&&L){t.attr("transform",null);var o=0,i={left:"right",right:"left",top:"bottom",bottom:"top"}[b.side],s=-1===["left","top"].indexOf(b.side)?1:-1,d=r(b.pad)?b.pad:2,c=l.bBox(t.node()),p={left:0,top:0,right:T.width,bottom:T.height},u=b.maxShift||(p[b.side]-c[b.side])*("left"===b.side||"top"===b.side?-1:1);if(0>u)o=u;else{var g=b.offsetLeft||0,h=b.offsetTop||0;c.left-=g,c.right-=g,c.top-=h,c.bottom-=h,b.selection.each(function(){var e=l.bBox(this);n.bBoxIntersect(c,e,d)&&(o=va(o,s*(e[b.side]-c[i])+d))}),o=ea(u,o)}if(0<o||0>u){var m={left:[-o,0],right:[o,0],top:[0,-o],bottom:[0,o]}[b.side];t.attr("transform","translate("+m+")")}}}var y=d.propContainer,f=d.propName,x=d.placeholder,_=d.traceIndex,b=d.avoid||{},v=d.attributes,k=d.transform,w=d.containerGroup,T=e._fullLayout,A=1,S=!1,C=y.title,L=(C&&C.text?C.text:"").trim(),E=C&&C.font?C.font:{},I=E.family,z=E.size,P=E.color,D;"title.text"===f?D="titleText":-1===f.indexOf("axis")?f.indexOf(!0)&&(D="colorbarTitleText"):D="axisTitleText";var O=e._context.edits[D];""===L?A=0:L.replace(u," % ")===x.replace(u," % ")&&(A=.2,S=!0,!O&&(L="")),d._meta?L=n.templateString(L,d._meta):T._meta&&(L=n.templateString(L,T._meta));var R=L||O;w||(w=n.ensureSingle(T._infolayer,"g","g-"+t));var M=w.selectAll("text").data(R?[0]:[]);return(M.enter().append("text"),M.text(L).attr("class",t),M.exit().remove(),!R)?w:(M.call(g),O&&(L?M.on(".opacity",null):function(){A=0,S=!0,M.text(x).on("mouseover.opacity",function(){a.select(this).transition().duration(p.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){a.select(this).transition().duration(p.HIDE_PLACEHOLDER).style("opacity",0)})}(),M.call(c.makeEditable,{gd:e}).on("edit",function(t){void 0===_?i.call("_guiRelayout",e,f,t):i.call("_guiRestyle",e,f,t,_)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(g)}).on("input",function(e){this.text(e||" ").call(c.positionText,v.x,v.y)})),M.classed("js-placeholder",S),w)}};var u=/ [XY][0-9]* /},{"../../constants/interactions":694,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/plots":828,"../../registry":847,"../color":593,"../drawing":614,d3:163,"fast-isnumeric":225}],682:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("../color/attributes"),o=e("../../lib/extend").extendFlat,i=e("../../plot_api/edit_types").overrideAll,n=e("../../plots/pad_attributes"),l=e("../../plot_api/plot_template").templatedArray,s=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});t.exports=i(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:s,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:o(n({editType:"arraydraw"}),{}),font:a({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:r.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/font_attributes":793,"../../plots/pad_attributes":827,"../color/attributes":592}],683:[function(e,t){"use strict";t.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],684:[function(e,t){"use strict";function a(e,t,a){function l(a,r){return o.coerce(e,t,n,a,r)}var s=i(e,t,{name:"buttons",handleItemDefaults:r}),d=l("visible",0<s.length);d&&(l("active"),l("direction"),l("type"),l("showactive"),l("x"),l("y"),o.noneOrAll(e,t,["x","y"]),l("xanchor"),l("yanchor"),l("pad.t"),l("pad.r"),l("pad.b"),l("pad.l"),o.coerceFont(l,"font",a.font),l("bgcolor",a.paper_bgcolor),l("bordercolor"),l("borderwidth"))}function r(e,t){function a(a,r){return o.coerce(e,t,d,a,r)}var r=a("visible","skip"===e.method||Array.isArray(e.args));r&&(a("method"),a("args"),a("label"),a("execute"))}var o=e("../../lib"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("./constants"),s=l.name,d=n.buttons;t.exports=function(e,t){i(e,t,{name:s,handleItemDefaults:a})}},{"../../lib":719,"../../plots/array_container_defaults":763,"./attributes":682,"./constants":683}],685:[function(e,t){"use strict";function a(e){return e._index}function r(e){return-1==+e.attr(L.menuIndexAttrName)}function o(e,t){return+e.attr(L.menuIndexAttrName)===t._index}function i(e,t,a,r,o,i,s,d){t.active=s,S(e.layout,L.name,t).applyUpdate("active",s),"buttons"===t.type?l(e,r,null,null,t):"dropdown"===t.type&&(o.attr(L.menuIndexAttrName,"-1"),n(e,r,o,i,t),!d&&l(e,r,o,i,t))}function n(e,t,a,r,i){var n=T.ensureSingle(t,"g",L.headerClassName,function(e){e.style("pointer-events","all")}),s=i._dims,d=i.active,p=i.buttons[d]||L.blankHeaderOpts,u={y:i.pad.t,yPad:0,x:i.pad.l,xPad:0,index:0},g={width:s.headerWidth,height:s.headerHeight};n.call(c,i,p,e).call(x,i,u,g);var y=T.ensureSingle(t,"text",L.headerArrowClassName,function(e){e.classed("user-select-none",!0).attr("text-anchor","end").call(w.font,i.font).text(L.arrowSymbol[i.direction])});y.attr({x:s.headerWidth-L.arrowOffsetX+i.pad.l,y:s.headerHeight/2+L.textOffsetY+i.pad.t}),n.on("click",function(){a.call(_,(o(a,i)?-1:i._index)+""),l(e,t,a,r,i)}),n.on("mouseover",function(){n.call(h)}),n.on("mouseout",function(){n.call(m,i)}),w.setTranslate(t,s.lx,s.ly)}function l(e,t,a,o,n){a||(a=t,a.attr("pointer-events","all"));var l=r(a)&&"buttons"!==n.type?[]:n.buttons,p="dropdown"===n.type?L.dropdownButtonClassName:L.buttonClassName,u=a.selectAll("g."+p).data(T.filterVisible(l)),y=u.enter().append("g").classed(p,!0),f=u.exit();"dropdown"===n.type?(y.attr("opacity","0").transition().attr("opacity","1"),f.transition().attr("opacity","0").remove()):f.remove();var _=0,k=0,w=n._dims,A=-1!==["up","down"].indexOf(n.direction);"dropdown"===n.type&&(A?k=w.headerHeight+L.gapButtonHeader:_=w.headerWidth+L.gapButtonHeader),"dropdown"===n.type&&"up"===n.direction&&(k=-L.gapButtonHeader+L.gapButton-w.openHeight),"dropdown"===n.type&&"left"===n.direction&&(_=-L.gapButtonHeader+L.gapButton-w.openWidth);var S={x:w.lx+_+n.pad.l,y:w.ly+k+n.pad.t,yPad:L.gapButton,xPad:L.gapButton,index:0},C={l:S.x+n.borderwidth,t:S.y+n.borderwidth};u.each(function(r,l){var s=b.select(this);s.call(c,n,r,e).call(x,n,S),s.on("click",function(){b.event.defaultPrevented||(i(e,n,r,t,a,o,l),r.execute&&v.executeAPICommand(e,r.method,r.args),e.emit("plotly_buttonclicked",{menu:n,button:r,active:n.active}))}),s.on("mouseover",function(){s.call(h)}),s.on("mouseout",function(){s.call(m,n),u.call(g,n)})}),u.call(g,n),A?(C.w=va(w.openWidth,w.headerWidth),C.h=S.y-C.t):(C.w=S.x-C.l,C.h=va(w.openHeight,w.headerHeight)),C.direction=n.direction,o&&(u.size()?s(e,t,a,o,n,C):d(o))}function s(e,t,a,r,o,n){var l=o.direction,s=o._dims,d=o.active,c,p,u;if("up"===l||"down"===l)for(p=0,u=0;u<d;u++)p+=s.heights[u]+L.gapButton;else for(c=0,u=0;u<d;u++)c+=s.widths[u]+L.gapButton;r.enable(n,c,p),r.hbar&&r.hbar.attr("opacity","0").transition().attr("opacity","1"),r.vbar&&r.vbar.attr("opacity","0").transition().attr("opacity","1")}function d(e){var t=!!e.hbar,a=!!e.vbar;t&&e.hbar.transition().attr("opacity","0").each("end",function(){t=!1,a||e.disable()}),a&&e.vbar.transition().attr("opacity","0").each("end",function(){a=!1,t||e.disable()})}function c(e,t,a,r){e.call(p,t).call(u,t,a,r)}function p(e,t){var a=T.ensureSingle(e,"rect",L.itemRectClassName,function(e){e.attr({rx:L.rx,ry:L.ry,"shape-rendering":"crispEdges"})});a.call(k.stroke,t.bordercolor).call(k.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function u(e,t,a,r){var o=T.ensureSingle(e,"text",L.itemTextClassName,function(e){e.classed("user-select-none",!0).attr({"text-anchor":"start","data-notex":1})}),i=a.label,n=r._fullLayout._meta;n&&(i=T.templateString(i,n)),o.call(w.font,t.font).text(i).call(A.convertToTspans,r)}function g(e,t){var a=t.active;e.each(function(e,r){var o=b.select(this);r===a&&t.showactive&&o.select("rect."+L.itemRectClassName).call(k.fill,L.activeColor)})}function h(e){e.select("rect."+L.itemRectClassName).call(k.fill,L.hoverColor)}function m(e,t){e.select("rect."+L.itemRectClassName).call(k.fill,t.bgcolor)}function y(e,t){var a=t._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},r=w.tester.selectAll("g."+L.dropdownButtonClassName).data(T.filterVisible(t.buttons));r.enter().append("g").classed(L.dropdownButtonClassName,!0);var o=-1!==["up","down"].indexOf(t.direction);r.each(function(r,n){var i=b.select(this);i.call(c,t,r,e);var l=i.select("."+L.itemTextClassName),s=l.node()&&w.bBox(l.node()).width,d=va(s+L.textPadX,L.minWidth),p=t.font.size*C,u=A.lineCount(l),g=va(p*u,L.minHeight)+L.textOffsetY;g=M(g),d=M(d),a.widths[n]=d,a.heights[n]=g,a.height1=va(a.height1,g),a.width1=va(a.width1,d),o?(a.totalWidth=va(a.totalWidth,d),a.openWidth=a.totalWidth,a.totalHeight+=g+L.gapButton,a.openHeight+=g+L.gapButton):(a.totalWidth+=d+L.gapButton,a.openWidth+=d+L.gapButton,a.totalHeight=va(a.totalHeight,g),a.openHeight=a.totalHeight)}),o?a.totalHeight-=L.gapButton:a.totalWidth-=L.gapButton,a.headerWidth=a.width1+L.arrowPadX,a.headerHeight=a.height1,"dropdown"===t.type&&(o?(a.width1+=L.arrowPadX,a.totalHeight=a.height1):a.totalWidth=a.width1,a.totalWidth+=L.arrowPadX),r.remove();var i=a.totalWidth+t.pad.l+t.pad.r,n=a.totalHeight+t.pad.t+t.pad.b,l=e._fullLayout._size;a.lx=l.l+l.w*t.x,a.ly=l.t+l.h*(1-t.y);var s="left";T.isRightAnchor(t)&&(a.lx-=i,s="right"),T.isCenterAnchor(t)&&(a.lx-=i/2,s="center");var d="top";T.isBottomAnchor(t)&&(a.ly-=n,d="bottom"),T.isMiddleAnchor(t)&&(a.ly-=n/2,d="middle"),a.totalWidth=M(a.totalWidth),a.totalHeight=M(a.totalHeight),a.lx=V(a.lx),a.ly=V(a.ly),v.autoMargin(e,f(t),{x:t.x,y:t.y,l:i*({right:1,center:.5}[s]||0),r:i*({left:1,center:.5}[s]||0),b:n*({top:1,middle:.5}[d]||0),t:n*({bottom:1,middle:.5}[d]||0)})}function f(e){return L.autoMarginIdRoot+e._index}function x(e,t,a,r){r=r||{};var o=e.select("."+L.itemRectClassName),i=e.select("."+L.itemTextClassName),n=t.borderwidth,l=a.index,s=t._dims;w.setTranslate(e,n+a.x,n+a.y);var d=-1!==["up","down"].indexOf(t.direction),c=r.height||(d?s.heights[l]:s.height1);o.attr({x:0,y:0,width:r.width||(d?s.width1:s.widths[l]),height:c});var p=t.font.size*C,u=A.lineCount(i);A.positionText(i,L.textOffsetX,c/2-(u-1)*p/2+L.textOffsetY),d?a.y+=s.heights[l]+a.yPad:a.x+=s.widths[l]+a.xPad,a.index++}function _(e,t){e.attr(L.menuIndexAttrName,t||"-1").selectAll("g."+L.dropdownButtonClassName).remove()}var b=e("d3"),v=e("../../plots/plots"),k=e("../color"),w=e("../drawing"),T=e("../../lib"),A=e("../../lib/svg_text_utils"),S=e("../../plot_api/plot_template").arrayEditor,C=e("../../constants/alignment").LINE_SPACING,L=e("./constants"),E=e("./scrollbox");t.exports=function(e){function t(t){v.autoMargin(e,f(t))}var r=e._fullLayout,s=T.filterVisible(r[L.name]),d=r._menulayer.selectAll("g."+L.containerClassName).data(0<s.length?[0]:[]);if(d.enter().append("g").classed(L.containerClassName,!0).style("cursor","pointer"),d.exit().each(function(){b.select(this).selectAll("g."+L.headerGroupClassName).each(t)}).remove(),0!==s.length){var c=d.selectAll("g."+L.headerGroupClassName).data(s,a);c.enter().append("g").classed(L.headerGroupClassName,!0);for(var p=T.ensureSingle(d,"g",L.dropdownButtonGroupClassName,function(e){e.style("pointer-events","all")}),u=0,g;u<s.length;u++)g=s[u],y(e,g);var h="updatemenus"+r._uid,m=new E(e,p,h);c.enter().size()&&(p.node().parentNode.appendChild(p.node()),p.call(_)),c.exit().each(function(e){p.call(_),t(e)}).remove(),c.each(function(t){var a=b.select(this),r="dropdown"===t.type?p:null;v.manageCommandObserver(e,t,t.buttons,function(o){i(e,t,t.buttons[o.index],a,r,m,o.index,!0)}),"dropdown"===t.type?(n(e,a,p,m,t),o(p,t)&&l(e,a,p,m,t)):l(e,a,null,null,t)})}}},{"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plot_api/plot_template":757,"../../plots/plots":828,"../color":593,"../drawing":614,"./constants":683,"./scrollbox":687,d3:163}],686:[function(e,t,a){arguments[4][680][0].apply(a,arguments)},{"./attributes":682,"./constants":683,"./defaults":684,"./draw":685,dup:680}],687:[function(e,t){"use strict";function a(e,t,a){this.gd=e,this.container=t,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}t.exports=a;var r=e("d3"),o=e("../color"),i=e("../drawing"),n=e("../../lib");a.barWidth=2,a.barLength=20,a.barRadius=2,a.barPad=1,a.barColor="#808BA4",a.prototype.enable=function(e,n,s){var d=this.gd._fullLayout,c=d.width,p=d.height;this.position=e;var u=this.position.l,l=this.position.w,g=this.position.t,t=this.position.h,h=this.position.direction,m="down"===h,y="left"===h,f="up"===h,x=l,_=t,b,v,k,w;m||y||"right"===h||f||(this.position.direction="down",m=!0);var T=m||f;T?(b=u,v=b+x,m?(k=g,w=ea(k+_,p),_=w-k):(w=g+_,k=va(w-_,0),_=w-k)):(k=g,w=k+_,y?(v=u+x,b=va(v-x,0),x=v-b):(b=u,v=ea(b+x,c),x=v-b)),this._box={l:b,t:k,w:x,h:_};var A=l>x,S=a.barLength+2*a.barPad,C=a.barWidth+2*a.barPad,L=u,E=g+t;E+C>p&&(E=p-C);var I=this.container.selectAll("rect.scrollbar-horizontal").data(A?[0]:[]);I.exit().on(".drag",null).remove(),I.enter().append("rect").classed("scrollbar-horizontal",!0).call(o.fill,a.barColor),A?(this.hbar=I.attr({rx:a.barRadius,ry:a.barRadius,x:L,y:E,width:S,height:C}),this._hbarXMin=L+S/2,this._hbarTranslateMax=x-S):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var z=t>_,P=a.barWidth+2*a.barPad,D=a.barLength+2*a.barPad,O=u+l,R=g;O+P>c&&(O=c-P);var j=this.container.selectAll("rect.scrollbar-vertical").data(z?[0]:[]);j.exit().on(".drag",null).remove(),j.enter().append("rect").classed("scrollbar-vertical",!0).call(o.fill,a.barColor),z?(this.vbar=j.attr({rx:a.barRadius,ry:a.barRadius,x:O,y:R,width:P,height:D}),this._vbarYMin=R+D/2,this._vbarTranslateMax=_-D):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var F=this.id,B=b-.5,N=z?v+P+.5:v+.5,V=k-.5,U=A?w+C+.5:w+.5,H=d._topdefs.selectAll("#"+F).data(A||z?[0]:[]);if(H.exit().remove(),H.enter().append("clipPath").attr("id",F).append("rect"),A||z?(this._clipRect=H.select("rect").attr({x:ba(B),y:ba(V),width:M(N)-ba(B),height:M(U)-ba(V)}),this.container.call(i.setClipUrl,F,this.gd),this.bg.attr({x:u,y:g,width:l,height:t})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null),delete this._clipRect),A||z){var G=r.behavior.drag().on("dragstart",function(){r.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(G);var q=r.behavior.drag().on("dragstart",function(){r.event.sourceEvent.preventDefault(),r.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));A&&this.hbar.on(".drag",null).call(q),z&&this.vbar.on(".drag",null).call(q)}this.setTranslate(n,s)},a.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},a.prototype._onBoxDrag=function(){var e=this.translateX,t=this.translateY;this.hbar&&(e-=r.event.dx),this.vbar&&(t-=r.event.dy),this.setTranslate(e,t)},a.prototype._onBoxWheel=function(){var e=this.translateX,t=this.translateY;this.hbar&&(e+=r.event.deltaY),this.vbar&&(t+=r.event.deltaY),this.setTranslate(e,t)},a.prototype._onBarDrag=function(){var e=this.translateX,t=this.translateY;if(this.hbar){var a=e+this._hbarXMin,o=a+this._hbarTranslateMax,i=n.constrain(r.event.x,a,o),l=this.position.w-this._box.w;e=(i-a)/(o-a)*l}if(this.vbar){var s=t+this._vbarYMin,d=s+this._vbarTranslateMax,c=n.constrain(r.event.y,s,d),p=this.position.h-this._box.h;t=(c-s)/(d-s)*p}this.setTranslate(e,t)},a.prototype.setTranslate=function(e,t){var a=this.position.w-this._box.w,r=this.position.h-this._box.h;if(e=n.constrain(e||0,0,a),t=n.constrain(t||0,0,r),this.translateX=e,this.translateY=t,this.container.call(i.setTranslate,this._box.l-this.position.l-e,this._box.t-this.position.t-t),this._clipRect&&this._clipRect.attr({x:ba(this.position.l+e-.5),y:ba(this.position.t+t-.5)}),this.hbar){var o=e/a;this.hbar.call(i.setTranslate,e+o*this._hbarTranslateMax,t)}if(this.vbar){var l=t/r;this.vbar.call(i.setTranslate,e,t+l*this._vbarTranslateMax)}}},{"../../lib":719,"../color":593,"../drawing":614,d3:163}],688:[function(e,t){"use strict";t.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],689:[function(e,t){"use strict";t.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],690:[function(e,t){"use strict";t.exports={FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format",DATE_FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Time-Formatting.md#format"}},{}],691:[function(e,t){"use strict";t.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],692:[function(e,t){"use strict";t.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],693:[function(e,t){"use strict";t.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],694:[function(e,t){"use strict";t.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],695:[function(e,t){"use strict";t.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],696:[function(e,t,a){"use strict";a.xmlns="http://www.w3.org/2000/xmlns/",a.svg="http://www.w3.org/2000/svg",a.xlink="http://www.w3.org/1999/xlink",a.svgAttrs={xmlns:a.svg,"xmlns:xlink":a.xlink}},{}],697:[function(e,t,a){"use strict";a.version="1.49.3",e("es6-promise").polyfill(),e("../build/plotcss"),e("./fonts/mathjax_config")();for(var r=e("./registry"),o=a.register=r.register,n=e("./plot_api"),l=Object.keys(n),s=0,d;s<l.length;s++)d=l[s],"_"!==d.charAt(0)&&(a[d]=n[d]),o({moduleType:"apiMethod",name:d,fn:n[d]});o(e("./traces/scatter")),o([e("./components/fx"),e("./components/legend"),e("./components/annotations"),e("./components/annotations3d"),e("./components/shapes"),e("./components/images"),e("./components/updatemenus"),e("./components/sliders"),e("./components/rangeslider"),e("./components/rangeselector"),e("./components/grid"),e("./components/errorbars"),e("./components/colorscale"),e("./components/colorbar")]),o([e("./locale-en"),e("./locale-en-us")]),a.Icons=e("./fonts/ploticon"),a.Plots=e("./plots/plots"),a.Fx=e("./components/fx"),a.Snapshot=e("./snapshot"),a.PlotSchema=e("./plot_api/plot_schema"),a.Queue=e("./lib/queue"),a.d3=e("d3")},{"../build/plotcss":1,"./components/annotations":584,"./components/annotations3d":589,"./components/colorbar":599,"./components/colorscale":605,"./components/errorbars":620,"./components/fx":632,"./components/grid":636,"./components/images":641,"./components/legend":649,"./components/rangeselector":660,"./components/rangeslider":667,"./components/shapes":675,"./components/sliders":680,"./components/updatemenus":686,"./fonts/mathjax_config":698,"./fonts/ploticon":699,"./lib/queue":734,"./locale-en":748,"./locale-en-us":747,"./plot_api":752,"./plot_api/plot_schema":756,"./plots/plots":828,"./registry":847,"./snapshot":852,"./traces/scatter":1123,d3:163,"es6-promise":218}],698:[function(e,t){"use strict";t.exports=function(){if("undefined"!=typeof MathJax){var e="local"!==(window.PlotlyConfig||{}).MathJaxConfig;e&&(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured())}}},{}],699:[function(e,t){"use strict";t.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #119dff;} .cls-2 {fill: #25fefd;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],700:[function(e,t,a){"use strict";a.isLeftAnchor=function(e){return"left"===e.xanchor||"auto"===e.xanchor&&e.x<=1/3},a.isCenterAnchor=function(e){return"center"===e.xanchor||"auto"===e.xanchor&&e.x>1/3&&e.x<2/3},a.isRightAnchor=function(e){return"right"===e.xanchor||"auto"===e.xanchor&&e.x>=2/3},a.isTopAnchor=function(e){return"top"===e.yanchor||"auto"===e.yanchor&&e.y>=2/3},a.isMiddleAnchor=function(e){return"middle"===e.yanchor||"auto"===e.yanchor&&e.y>1/3&&e.y<2/3},a.isBottomAnchor=function(e){return"bottom"===e.yanchor||"auto"===e.yanchor&&e.y<=1/3}},{}],701:[function(e,t){"use strict";function r(e){return _a(e[1]-e[0])>u-1e-14}function o(e,t){return d(t-e,u)}function i(e,t){if(r(t))return!0;var a,o;t[0]<t[1]?(a=t[0],o=t[1]):(a=t[1],o=t[0]),a=s(a,u),o=s(o,u),a>o&&(o+=u);var i=s(e,u),n=i+u;return i>=a&&i<=o||n>=a&&n<=o}function n(e,t,a,o,i,n,l){function s(e,t){return[e*R(t)+i,n-e*De(t)]}function d(e,t,a){return"A"+[e,e]+" "+[0,_,a]+" "+s(e,t)}i=i||0,n=n||0;var g=r([a,o]),h,m,y,f,x;g?(h=0,m=c,y=u):a<o?(h=a,y=o):(h=o,y=a),e<t?(f=e,x=t):(f=t,x=e);var _=_a(y-h)<=c?0:1,b;return g?null===f?b="M"+s(x,h)+d(x,m,0)+d(x,y,0)+"Z":b="M"+s(f,h)+d(f,m,0)+d(f,y,0)+"ZM"+s(x,h)+d(x,m,1)+d(x,y,1)+"Z":null===f?(b="M"+s(x,h)+d(x,y,0),l&&(b+="L0,0Z")):b="M"+s(f,h)+"L"+s(x,h)+d(x,y,0)+"L"+s(f,y)+d(f,h,1)+"Z",b}var l=e("./mod"),s=l.mod,d=l.modHalf,c=Pe,u=2*c;t.exports={deg2rad:function(e){return e/180*c},rad2deg:function(e){return 180*(e/c)},angleDelta:o,angleDist:function(e,t){return _a(o(e,t))},isFullCircle:r,isAngleInsideSector:i,isPtInsideSector:function(e,t,a,r){if(!i(t,r))return!1;var o,n;return a[0]<a[1]?(o=a[0],n=a[1]):(o=a[1],n=a[0]),e>=o&&e<=n},pathArc:function(e,t,a,r,o){return n(null,e,t,a,r,o,0)},pathSector:function(e,t,a,r,o){return n(null,e,t,a,r,o,1)},pathAnnulus:function(e,t,a,r,o,i){return n(e,t,a,r,o,i,1)}}},{"./mod":726}],702:[function(e,t,a){"use strict";function r(e){return s.isView(e)&&!(e instanceof n)}function o(e){return l(e)||r(e)}function i(e,t,a){if(o(e)){if(o(e[0])){for(var r=a,n=0;n<e.length;n++)r=t(r,e[n].length);return r}return e.length}return 0}var l=Array.isArray,s="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer:{isView:function(){return!1}},n="undefined"==typeof DataView?function(){}:DataView;a.isTypedArray=r,a.isArrayOrTypedArray=o,a.isArray1D=function(e){return!o(e[0])},a.ensureArray=function(e,t){return l(e)||(e=[]),e.length=t,e},a.concat=function(){var e=[],t=!0,a=0,r,o,n,s,d,c,p,u;for(n=0;n<arguments.length;n++)s=arguments[n],c=s.length,c&&(o?e.push(s):(o=s,d=c),l(s)?r=!1:(t=!1,a?r!==s.constructor&&(r=!1):r=s.constructor),a+=c);if(!a)return[];if(!e.length)return o;if(t)return o.concat.apply(o,e);if(r){for(p=new r(a),p.set(o),n=0;n<e.length;n++)s=e[n],p.set(s,d),d+=s.length;return p}for(p=Array(a),u=0;u<o.length;u++)p[u]=o[u];for(n=0;n<e.length;n++){for(s=e[n],u=0;u<s.length;u++)p[d+u]=s[u];d+=u}return p},a.maxRowLength=function(e){return i(e,Math.max,0)},a.minRowLength=function(e){return i(e,Math.min,1/0)}},{}],703:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../constants/numerical").BADNUM,o=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;t.exports=function(e){return"string"==typeof e&&(e=e.replace(o,"")),a(e)?+e:r}},{"../constants/numerical":695,"fast-isnumeric":225}],704:[function(e,t){"use strict";t.exports=function(e){var t=e._fullLayout;t._glcanvas&&t._glcanvas.size()&&t._glcanvas.each(function(e){e.regl&&e.regl.clear({color:!0,depth:!0})})}},{}],705:[function(e,t){"use strict";t.exports=function(e){e._responsiveChartHandler&&(window.removeEventListener("resize",e._responsiveChartHandler),delete e._responsiveChartHandler)}},{}],706:[function(e,t,a){"use strict";function r(e,t){var r=a.valObjectMeta[t.valType];if(t.arrayOk&&u(e))return!0;if(r.validateFunction)return r.validateFunction(e,t);var o={},i=o;return r.coerceFunction(e,{set:function(e){i=e}},o,t),i!==o}var o=e("fast-isnumeric"),i=e("tinycolor2"),n=e("../plots/attributes"),l=e("../components/colorscale/scales"),s=e("../constants/interactions").DESELECTDIM,d=e("./nested_property"),c=e("./regex").counter,p=e("./mod").modHalf,u=e("./array").isArrayOrTypedArray;a.valObjectMeta={data_array:{coerceFunction:function(e,t,a){u(e)?t.set(e):a!==void 0&&t.set(a)}},enumerated:{coerceFunction:function(e,t,a,r){r.coerceNumber&&(e=+e),-1===r.values.indexOf(e)?t.set(a):t.set(e)},validateFunction:function(e,t){t.coerceNumber&&(e=+e);for(var a=t.values,r=0,o;r<a.length;r++)if(o=a[r]+"","/"===o.charAt(0)&&"/"===o.charAt(o.length-1)){var n=new RegExp(o.substr(1,o.length-2));if(n.test(e))return!0}else if(e===a[r])return!0;return!1}},boolean:{coerceFunction:function(e,t,a){!0===e||!1===e?t.set(e):t.set(a)}},number:{coerceFunction:function(e,t,a,r){!o(e)||r.min!==void 0&&e<r.min||r.max!==void 0&&e>r.max?t.set(a):t.set(+e)}},integer:{coerceFunction:function(e,t,a,r){e%1||!o(e)||r.min!==void 0&&e<r.min||r.max!==void 0&&e>r.max?t.set(a):t.set(+e)}},string:{coerceFunction:function(e,t,a,r){if("string"!=typeof e){!0!==r.strict&&"number"==typeof e?t.set(e+""):t.set(a)}else r.noBlank&&!e?t.set(a):t.set(e)}},color:{coerceFunction:function(e,t,a){i(e).isValid()?t.set(e):t.set(a)}},colorlist:{coerceFunction:function(e,t,a){Array.isArray(e)&&e.length?e.every(function(e){return i(e).isValid()})?t.set(e):t.set(a):t.set(a)}},colorscale:{coerceFunction:function(e,t,a){t.set(l.get(e,a))}},angle:{coerceFunction:function(e,t,a){"auto"===e?t.set("auto"):o(e)?t.set(p(+e,360)):t.set(a)}},subplotid:{coerceFunction:function(e,t,a,r){var o=r.regex||c(a);return"string"==typeof e&&o.test(e)?void t.set(e):void t.set(a)},validateFunction:function(e,t){var a=t.dflt;return!(e!==a)||!("string"!=typeof e)&&!!c(a).test(e)}},flaglist:{coerceFunction:function(e,t,a,r){if("string"!=typeof e)return void t.set(a);if(-1!==(r.extras||[]).indexOf(e))return void t.set(e);for(var o=e.split("+"),n=0;n<o.length;){var l=o[n];-1===r.flags.indexOf(l)||o.indexOf(l)<n?o.splice(n,1):n++}o.length?t.set(o.join("+")):t.set(a)}},any:{coerceFunction:function(e,t,a){e===void 0?t.set(a):t.set(e)}},info_array:{coerceFunction:function(e,t,r,o){function n(e,t,r){var o;return void 0===r&&(r=t.dflt),a.valObjectMeta[t.valType].coerceFunction(e,{set:function(e){o=e}},r,t),o}var l=2===o.dimensions||"1-2"===o.dimensions&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e))return void t.set(r);var s=o.items,d=[],c=Array.isArray(s),p=c&&l&&Array.isArray(s[0]),u=l&&c&&!p,g=c&&!u?s.length:e.length,h,m,y,f,x,_;if(r=Array.isArray(r)?r:[],l)for(h=0;h<g;h++)for(d[h]=[],y=Array.isArray(e[h])?e[h]:[],x=u?s.length:c?s[h].length:y.length,m=0;m<x;m++)f=u?s[m]:c?s[h][m]:s,_=n(y[m],f,(r[h]||[])[m]),void 0!==_&&(d[h][m]=_);else for(h=0;h<g;h++)_=n(e[h],c?s[h]:s,r[h]),void 0!==_&&(d[h]=_);t.set(d)},validateFunction:function(e,t){if(!Array.isArray(e))return!1;var a=t.items,o=Array.isArray(a),n=2===t.dimensions;if(!t.freeLength&&e.length!==a.length)return!1;for(var l=0;l<e.length;l++)if(n){if(!Array.isArray(e[l])||!t.freeLength&&e[l].length!==a[l].length)return!1;for(var s=0;s<e[l].length;s++)if(!r(e[l][s],o?a[l][s]:a))return!1}else if(!r(e[l],o?a[l]:a))return!1;return!0}}},a.coerce=function(e,t,o,i,n){var l=d(o,i).get(),s=d(e,i),c=d(t,i),p=s.get(),g=t._template;if(void 0===p&&g&&(p=d(g,i).get(),g=0),void 0===n&&(n=l.dflt),l.arrayOk&&u(p))return c.set(p),p;var h=a.valObjectMeta[l.valType].coerceFunction;h(p,c,n,l);var m=c.get();return g&&m===n&&!r(p,l)&&(p=d(g,i).get(),h(p,c,n,l),m=c.get()),m},a.coerce2=function(e,t,r,o,i){var n=d(e,o),l=a.coerce(e,t,r,o,i),s=n.get();return!(s===void 0||null===s)&&l},a.coerceFont=function(e,t,a){var r={};return a=a||{},r.family=e(t+".family",a.family),r.size=e(t+".size",a.size),r.color=e(t+".color",a.color),r},a.coerceHoverinfo=function(e,t,r){var o=t._module.attributes,i=o.hoverinfo?o:n,l=i.hoverinfo,s;if(1===r._dataLength){var d="all"===l.dflt?l.flags.slice():l.dflt.split("+");d.splice(d.indexOf("name"),1),s=d.join("+")}return a.coerce(e,t,i,"hoverinfo",s)},a.coerceSelectionMarkerOpacity=function(e,t){if(e.marker){var a=e.marker.opacity;if(void 0!==a){var r,o;u(a)||e.selected||e.unselected||(r=a,o=s*a),t("selected.marker.opacity",r),t("unselected.marker.opacity",o)}}},a.validate=r},{"../components/colorscale/scales":608,"../constants/interactions":694,"../plots/attributes":764,"./array":702,"./mod":726,"./nested_property":727,"./regex":735,"fast-isnumeric":225,tinycolor2:537}],707:[function(e,t,a){"use strict";function o(e){return e&&w.componentsRegistry.calendars&&"string"==typeof e&&"gregorian"!==e}function i(e,t){return(e+ya(10,t)+"").substr(1)}function n(e,t,a,r,o){if((t||a||r||o)&&(e+=" "+i(t,2)+":"+i(a,2),(r||o)&&(e+=":"+i(r,2),o))){for(var n=4;0==o%10;)n-=1,o/=10;e+="."+i(o,n)}return e}function l(e,t,a,r){e=e.replace(O,function(e){var a=ea(+e.charAt(1)||6,6),r=(t/1e3%1+2).toFixed(a).substr(2).replace(/0+$/,"")||"0";return r});var i=new Date(ba(t+.05));if(o(r))try{e=w.getComponentMethod("calendars","worldCalFmt")(e,t,r)}catch(t){return"Invalid"}return a(e)(i)}function s(e,t){var a=p(e+.05,f),o=i(ba(a/_),2)+":"+i(p(ba(a/b),60),2);if("M"!==t){r(t)||(t=0);var n=ea(p(e/v,60),R[t]),l=(100+n).toFixed(t).substr(1);0<t&&(l=l.replace(/0+$/,"").replace(/[\.]$/,"")),o+=":"+l}return o}var c=e("d3"),r=e("fast-isnumeric"),d=e("./loggers"),p=e("./mod").mod,u=e("../constants/numerical"),g=u.BADNUM,f=u.ONEDAY,_=u.ONEHOUR,b=u.ONEMIN,v=u.ONESEC,k=u.EPOCHJD,w=e("../registry"),T=c.time.format.utc,A=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,C=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,L=new Date().getFullYear()-70;a.dateTick0=function(e,t){return o(e)?t?w.getComponentMethod("calendars","CANONICAL_SUNDAY")[e]:w.getComponentMethod("calendars","CANONICAL_TICK")[e]:t?"2000-01-02":"2000-01-01"},a.dfltRange=function(e){return o(e)?w.getComponentMethod("calendars","DFLTRANGE")[e]:["2000-01-01","2001-01-01"]},a.isJSDate=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.getTime};var E,I;a.dateTime2ms=function(e,t){if(a.isJSDate(e)){var r=e.getTimezoneOffset()*b,i=(e.getUTCMinutes()-e.getMinutes())*b+(e.getUTCSeconds()-e.getSeconds())*v+(e.getUTCMilliseconds()-e.getMilliseconds());if(i){var n=3*b;r=r-n/2+p(i-r+n/2,n)}return e=+e-r,e>=E&&e<=I?e:g}if("string"!=typeof e&&"number"!=typeof e)return g;e+="";var l=o(t),c=e.charAt(0);l&&("G"===c||"g"===c)&&(e=e.substr(1),t="");var u=l&&"chinese"===t.substr(0,7),h=e.match(u?C:A);if(!h)return g;var x=h[1],T=h[3]||"1",z=+(h[5]||1),d=+(h[7]||0),P=+(h[9]||0),D=+(h[11]||0);if(l){if(2===x.length)return g;x=+x;var S;try{var O=w.getComponentMethod("calendars","getCal")(t);if(u){var R="i"===T.charAt(T.length-1);T=parseInt(T,10),S=O.newDate(x,O.toMonthIndex(x,T,R),z)}else S=O.newDate(x,+T,z)}catch(t){return g}return S?(S.toJD()-k)*f+d*_+P*b+D*v:g}x=2===x.length?(+x+2e3-L)%100+L:+x,T-=1;var M=new Date(Date.UTC(2e3,T,z,d,P));return M.setUTCFullYear(x),M.getUTCMonth()===T?M.getUTCDate()===z?M.getTime()+D*v:g:g},E=a.MIN_MS=a.dateTime2ms("-9999"),I=a.MAX_MS=a.dateTime2ms("9999-12-31 23:59:59.9999"),a.isDateTime=function(e,t){return a.dateTime2ms(e,t)!==g};var z=90*f,P=3*_,D=5*b;a.ms2DateTime=function(e,t,a){if("number"!=typeof e||!(e>=E&&e<=I))return g;t||(t=0);var i=ba(10*p(e+.05,1)),l=V(e-i/10),c,u,y,x,A,S;if(o(a)){var C=ba(l/f)+k,L=ba(p(e,f));try{c=w.getComponentMethod("calendars","getCal")(a).fromJD(C).formatDate("yyyy-mm-dd")}catch(t){c=T("G%Y-%m-%d")(new Date(l))}if("-"===c.charAt(0))for(;11>c.length;)c="-0"+c.substr(1);else for(;10>c.length;)c="0"+c;u=t<z?ba(L/_):0,y=t<z?ba(L%_/b):0,x=t<P?ba(L%b/v):0,A=t<D?10*(L%v)+i:0}else S=new Date(l),c=T("%Y-%m-%d")(S),u=t<z?S.getUTCHours():0,y=t<z?S.getUTCMinutes():0,x=t<P?S.getUTCSeconds():0,A=t<D?10*S.getUTCMilliseconds()+i:0;return n(c,u,y,x,A)},a.ms2DateTimeLocal=function(e){if(!(e>=E+f&&e<=I-f))return g;var t=ba(10*p(e+.05,1)),a=new Date(V(e-t/10)),r=c.time.format("%Y-%m-%d")(a),o=a.getHours(),i=a.getMinutes(),l=a.getSeconds(),s=10*a.getUTCMilliseconds()+t;return n(r,o,i,l,s)},a.cleanDate=function(e,t,r){if(e===g)return t;if(a.isJSDate(e)||"number"==typeof e&&isFinite(e)){if(o(r))return d.error("JS Dates and milliseconds are incompatible with world calendars",e),t;if(e=a.ms2DateTimeLocal(+e),!e&&void 0!==t)return t}else if(!a.isDateTime(e,r))return d.error("unrecognized date",e),t;return e};var O=/%\d?f/g,R=[59,59.9,59.99,59.999,59.9999];a.formatDate=function(e,t,a,r,i,n){if(i=o(i)&&i,!t)if("y"===a)t=n.year;else if("m"===a)t=n.month;else if("d"===a)t=n.dayMonth+"\n"+n.year;else return s(e,a)+"\n"+l(n.dayMonthYear,e,r,i);return l(t,e,r,i)};var M=3*f;a.incrementMonth=function(t,e,a){a=o(a)&&a;var r=p(t,f);if(t=V(t-r),a)try{var i=V(t/f)+k,n=w.getComponentMethod("calendars","getCal")(a),l=n.fromJD(i);return e%12?n.add(l,e,"m"):n.add(l,e/12,"y"),(l.toJD()-k)*f+r}catch(r){d.error("invalid ms "+t+" in calendar "+a)}var s=new Date(t+M);return s.setUTCMonth(s.getUTCMonth()+e)+r-M},a.findExactDates=function(e,t){for(var a=0,n=0,l=0,s=0,c=o(t)&&w.getComponentMethod("calendars","getCal")(t),p=0,u,g;p<e.length;p++){if(g=e[p],!r(g)){s++;continue}if(!(g%f))if(c)try{u=c.fromJD(g/f+k),1===u.day()?1===u.month()?a++:n++:l++}catch(t){}else u=new Date(g),1===u.getUTCDate()?0===u.getUTCMonth()?a++:n++:l++}n+=a,l+=n;var h=e.length-s;return{exactYears:a/h,exactMonths:n/h,exactDays:l/h}}},{"../constants/numerical":695,"../registry":847,"./loggers":723,"./mod":726,d3:163,"fast-isnumeric":225}],708:[function(e,t){"use strict";function a(e){var t=e&&e.parentNode;t&&t.removeChild(e)}function r(e,t,a){var r="plotly.js-style-"+e,o=document.getElementById(r);o||(o=document.createElement("style"),o.setAttribute("id",r),o.appendChild(document.createTextNode("")),document.head.appendChild(o));var n=o.sheet;n.insertRule?n.insertRule(t+"{"+a+"}",0):n.addRule?n.addRule(t,a,0):i.warn("addStyleRule failed")}var o=e("d3"),i=e("./loggers");t.exports={getGraphDiv:function(e){var t;if("string"==typeof e){if(t=document.getElementById(e),null===t)throw new Error("No DOM element with id '"+e+"' exists on the page.");return t}if(null===e||void 0===e)throw new Error("DOM element provided is null or undefined");return e},isPlotDiv:function(e){var t=o.select(e);return t.node()instanceof HTMLElement&&t.size()&&t.classed("js-plotly-plot")},removeElement:a,addStyleRule:function(e,t){r("global",e,t)},addRelatedStyleRule:r,deleteRelatedStyleRule:function(e){var t=document.getElementById("plotly.js-style-"+e);t&&a(t)}}},{"./loggers":723,d3:163}],709:[function(e,t){"use strict";var a=e("events").EventEmitter;t.exports={init:function(e){if(e._ev instanceof a)return e;var t=new a,r=new a;return e._ev=t,e._internalEv=r,e.on=t.on.bind(t),e.once=t.once.bind(t),e.removeListener=t.removeListener.bind(t),e.removeAllListeners=t.removeAllListeners.bind(t),e._internalOn=r.on.bind(r),e._internalOnce=r.once.bind(r),e._removeInternalListener=r.removeListener.bind(r),e._removeAllInternalListeners=r.removeAllListeners.bind(r),e.emit=function(a,o){"undefined"!=typeof jQuery&&jQuery(e).trigger(a,o),t.emit(a,o),r.emit(a,o)},e},triggerHandler:function(e,t,a){function r(e){return e.listener?(l.removeListener(t,e.listener),!e.fired)?(e.fired=!0,e.listener.apply(l,[a])):void 0:e.apply(l,[a])}var o,n;"undefined"!=typeof jQuery&&(o=jQuery(e).triggerHandler(t,a));var l=e._ev;if(!l)return o;var s=l._events[t];if(!s)return o;s=Array.isArray(s)?s:[s];var d;for(d=0;d<s.length-1;d++)r(s[d]);return n=r(s[d]),void 0===o?n:o},purge:function(e){return delete e._ev,delete e.on,delete e.once,delete e.removeListener,delete e.removeAllListeners,delete e.emit,delete e._ev,delete e._internalEv,delete e._internalOn,delete e._internalOnce,delete e._removeInternalListener,delete e._removeAllInternalListeners,e}}},{events:104}],710:[function(e,t,a){"use strict";function r(e,t){var a,r;for(a=0;a<e.length;a++){if(r=e[a],null!==r&&"object"==typeof r)return!1;void 0!==r&&(t[a]=r)}return!0}function o(e,t,a,s){var d=e[0],c=e.length,p,u,g,h,m,y,f;if(2===c&&l(d)&&l(e[1])&&0===d.length){if(f=r(e[1],d),f)return d;d.splice(0,d.length)}for(var x=1;x<c;x++)for(u in p=e[x],p)g=d[u],h=p[u],s&&l(h)?d[u]=h:t&&h&&(n(h)||(m=l(h)))?(m?(m=!1,y=g&&l(g)?g:[]):y=g&&n(g)?g:{},d[u]=o([y,h],t,a,s)):("undefined"!=typeof h||a)&&(d[u]=h);return d}var n=e("./is_plain_object.js"),l=Array.isArray;a.extendFlat=function(){return o(arguments,!1,!1,!1)},a.extendDeep=function(){return o(arguments,!0,!1,!1)},a.extendDeepAll=function(){return o(arguments,!0,!0,!1)},a.extendDeepNoArrays=function(){return o(arguments,!0,!1,!0)}},{"./is_plain_object.js":720}],711:[function(e,t){"use strict";t.exports=function(e){for(var t={},a=[],r=0,o=0,n;o<e.length;o++)n=e[o],1!==t[n]&&(t[n]=1,a[r++]=n);return a}},{}],712:[function(e,t){"use strict";function a(e){return!0===e.visible}function r(e){var t=e[0].trace;return!0===t.visible&&0!==t._length}function o(e){return Array.isArray(e)&&Array.isArray(e[0])&&e[0][0]&&e[0][0].trace}t.exports=function(e){for(var t=o(e)?r:a,n=[],l=0,s;l<e.length;l++)s=e[l],t(s)&&n.push(s);return n}},{}],713:[function(e,t){"use strict";var a=e("country-regex"),r=e("../lib"),o=Object.keys(a),n={"ISO-3":r.identity,"USA-states":r.identity,"country names":function(e){for(var t=0;t<o.length;t++){var n=o[t],l=new RegExp(a[n]);if(l.test(e.trim().toLowerCase()))return n}return r.log("Unrecognized country name: "+e+"."),!1}};t.exports={locationToFeature:function(e,t,a){if(!t||"string"!=typeof t)return!1;var o=n[e](t),l,s,d;if(o){if("USA-states"===e)for(l=[],d=0;d<a.length;d++)s=a[d],s.properties&&s.properties.gu&&"USA"===s.properties.gu&&l.push(s);else l=a;for(d=0;d<l.length;d++)if(s=l[d],s.id===o)return s;r.log(["Location with id",o,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}}},{"../lib":719,"country-regex":134}],714:[function(e,t,a){"use strict";var r=e("../constants/numerical").BADNUM;a.calcTraceToLineCoords=function(e){for(var t=e[0].trace,a=t.connectgaps,o=[],n=[],l=0;l<e.length;l++){var s=e[l],d=s.lonlat;d[0]===r?!a&&0<n.length&&(o.push(n),n=[]):n.push(d)}return 0<n.length&&o.push(n),o},a.makeLine=function(e){return 1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e}},a.makePolygon=function(e){if(1===e.length)return{type:"Polygon",coordinates:e};for(var t=Array(e.length),a=0;a<e.length;a++)t[a]=[e[a]];return{type:"MultiPolygon",coordinates:t}},a.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":695}],715:[function(e,t,a){"use strict";function r(r,o,i,n,l,s,p,g){var h=i-r,a=l-r,m=p-l,c=n-o,d=s-o,e=g-s,y=h*e-m*c;if(0===y)return null;var f=(a*e-m*d)/y,t=(a*c-h*d)/y;return 0>t||1<t||0>f||1<f?null:{x:r+h*f,y:o+c*f}}function o(e,t,a,r,o){var i=r*e+o*t;if(0>i)return r*r+o*o;if(i>a){var n=r-e,l=o-t;return n*n+l*l}var s=r*t-o*e;return s*s/a}var i=e("./mod").mod;a.segmentsIntersect=r,a.segmentDistance=function(e,t,a,i,n,l,s,d){if(r(e,t,a,i,n,l,s,d))return 0;var c=a-e,p=i-t,u=s-n,g=d-l,h=c*c+p*p,m=u*u+g*g,y=ea(o(c,p,h,n-e,l-t),o(c,p,h,s-e,d-t),o(u,g,m,e-n,t-l),o(u,g,m,a-n,i-l));return N(y)};var n,l,s;a.getTextLocation=function(e,t,a,r){if((e!==l||r!==s)&&(n={},l=e,s=r),n[a])return n[a];var o=e.getPointAtLength(i(a-r/2,t)),d=e.getPointAtLength(i(a+r/2,t)),c=xa((d.y-o.y)/(d.x-o.x)),p=e.getPointAtLength(i(a,t)),u=(4*p.x+o.x+d.x)/6,g=(4*p.y+o.y+d.y)/6,h={x:u,y:g,theta:c};return n[a]=h,h},a.clearLocationCache=function(){l=null},a.getVisibleSegment=function(e,t,a){function r(t){var a=e.getPointAtLength(t);0===t?u=a:t===d&&(g=a);var r=a.x<o?o-a.x:a.x>i?a.x-i:0,s=a.y<n?n-a.y:a.y>l?a.y-l:0;return N(r*r+s*s)}for(var o=t.left,i=t.right,n=t.top,l=t.bottom,s=0,d=e.getTotalLength(),c=d,p=r(s),u,g;p;){if(s+=p+a,s>c)return;p=r(s)}for(p=r(c);p;){if(c-=p+a,s>c)return;p=r(c)}return{min:s,max:c,len:c-s,total:d,isClosed:0===s&&c===d&&.1>_a(u.x-g.x)&&.1>_a(u.y-g.y)}},a.findPointOnPath=function(e,t,a,r){r=r||{};for(var o=r.pathLength||e.getTotalLength(),n=r.tolerance||1e-3,l=r.iterationLimit||30,s=e.getPointAtLength(0)[a]>e.getPointAtLength(o)[a]?-1:1,d=0,c=0,p=o,u,g,h;d<l;){if(u=(c+p)/2,g=e.getPointAtLength(u),h=g[a]-t,_a(h)<n)return g;0<s*h?p=u:c=u,d++}return g}},{"./mod":726}],716:[function(e,t){"use strict";function a(e,t){var a=e;return a[3]*=t,a}function r(e){if(l(e))return g;var t=d(e);return t.length?t:g}function n(e){return l(e)?e:1}var l=e("fast-isnumeric"),s=e("tinycolor2"),d=e("color-normalize"),c=e("../components/colorscale"),p=e("../components/color/attributes").defaultLine,u=e("./array").isArrayOrTypedArray,g=d(p);t.exports={formatColor:function(e,t,o){var l=e.color,s=u(l),p=u(t),h=c.extractOpts(e),m=[],y,f,x,_,b;if(y=void 0===h.colorscale?r:c.makeColorScaleFuncFromTrace(e),f=s?function(e,t){return void 0===e[t]?g:d(y(e[t]))}:r,x=p?function(e,t){return void 0===e[t]?1:n(e[t])}:n,s||p)for(var v=0;v<o;v++)_=f(l,v),b=x(t,v),m[v]=a(_,b);else m=a(d(l),t);return m},parseColorScale:function(e,t){t===void 0&&(t=1);var a=c.extractOpts(e),r=a.reversescale?c.flipScale(a.colorscale):a.colorscale;return r.map(function(e){var a=e[0],r=s(e[1]),o=r.toRgb();return{index:a,rgb:[o.r,o.g,o.b,t]}})}}},{"../components/color/attributes":592,"../components/colorscale":605,"./array":702,"color-normalize":120,"fast-isnumeric":225,tinycolor2:537}],717:[function(e,t){"use strict";function a(e){return[e]}var r=e("./identity");t.exports={keyFun:function(e){return e.key},repeat:a,descend:r,wrap:a,unwrap:function(e){return e[0]}}},{"./identity":718}],718:[function(e,t){"use strict";t.exports=function(e){return e}},{}],719:[function(e,t){"use strict";function a(e){var t={};for(var a in e)for(var r=e[a],o=0;o<r.length;o++)t[r[o]]=+a;return t}var r=e("d3"),o=e("fast-isnumeric"),i=e("../constants/numerical"),n=i.FP_SAFE,l=i.BADNUM,s=t.exports={};s.nestedProperty=e("./nested_property"),s.keyedContainer=e("./keyed_container"),s.relativeAttr=e("./relative_attr"),s.isPlainObject=e("./is_plain_object"),s.toLogRange=e("./to_log_range"),s.relinkPrivateKeys=e("./relink_private");var d=e("./array");s.isTypedArray=d.isTypedArray,s.isArrayOrTypedArray=d.isArrayOrTypedArray,s.isArray1D=d.isArray1D,s.ensureArray=d.ensureArray,s.concat=d.concat,s.maxRowLength=d.maxRowLength,s.minRowLength=d.minRowLength;var c=e("./mod");s.mod=c.mod,s.modHalf=c.modHalf;var p=e("./coerce");s.valObjectMeta=p.valObjectMeta,s.coerce=p.coerce,s.coerce2=p.coerce2,s.coerceFont=p.coerceFont,s.coerceHoverinfo=p.coerceHoverinfo,s.coerceSelectionMarkerOpacity=p.coerceSelectionMarkerOpacity,s.validate=p.validate;var u=e("./dates");s.dateTime2ms=u.dateTime2ms,s.isDateTime=u.isDateTime,s.ms2DateTime=u.ms2DateTime,s.ms2DateTimeLocal=u.ms2DateTimeLocal,s.cleanDate=u.cleanDate,s.isJSDate=u.isJSDate,s.formatDate=u.formatDate,s.incrementMonth=u.incrementMonth,s.dateTick0=u.dateTick0,s.dfltRange=u.dfltRange,s.findExactDates=u.findExactDates,s.MIN_MS=u.MIN_MS,s.MAX_MS=u.MAX_MS;var g=e("./search");s.findBin=g.findBin,s.sorterAsc=g.sorterAsc,s.sorterDes=g.sorterDes,s.distinctVals=g.distinctVals,s.roundUp=g.roundUp,s.sort=g.sort,s.findIndexOfMin=g.findIndexOfMin;var h=e("./stats");s.aggNums=h.aggNums,s.len=h.len,s.mean=h.mean,s.median=h.median,s.midRange=h.midRange,s.variance=h.variance,s.stdev=h.stdev,s.interp=h.interp;var m=e("./matrix");s.init2dArray=m.init2dArray,s.transposeRagged=m.transposeRagged,s.dot=m.dot,s.translationMatrix=m.translationMatrix,s.rotationMatrix=m.rotationMatrix,s.rotationXYMatrix=m.rotationXYMatrix,s.apply2DTransform=m.apply2DTransform,s.apply2DTransform2=m.apply2DTransform2;var y=e("./angles");s.deg2rad=y.deg2rad,s.rad2deg=y.rad2deg,s.angleDelta=y.angleDelta,s.angleDist=y.angleDist,s.isFullCircle=y.isFullCircle,s.isAngleInsideSector=y.isAngleInsideSector,s.isPtInsideSector=y.isPtInsideSector,s.pathArc=y.pathArc,s.pathSector=y.pathSector,s.pathAnnulus=y.pathAnnulus;var f=e("./anchor_utils");s.isLeftAnchor=f.isLeftAnchor,s.isCenterAnchor=f.isCenterAnchor,s.isRightAnchor=f.isRightAnchor,s.isTopAnchor=f.isTopAnchor,s.isMiddleAnchor=f.isMiddleAnchor,s.isBottomAnchor=f.isBottomAnchor;var x=e("./geometry2d");s.segmentsIntersect=x.segmentsIntersect,s.segmentDistance=x.segmentDistance,s.getTextLocation=x.getTextLocation,s.clearLocationCache=x.clearLocationCache,s.getVisibleSegment=x.getVisibleSegment,s.findPointOnPath=x.findPointOnPath;var _=e("./extend");s.extendFlat=_.extendFlat,s.extendDeep=_.extendDeep,s.extendDeepAll=_.extendDeepAll,s.extendDeepNoArrays=_.extendDeepNoArrays;var b=e("./loggers");s.log=b.log,s.warn=b.warn,s.error=b.error;var v=e("./regex");s.counterRegex=v.counter;var k=e("./throttle");s.throttle=k.throttle,s.throttleDone=k.done,s.clearThrottle=k.clear;var w=e("./dom");s.getGraphDiv=w.getGraphDiv,s.isPlotDiv=w.isPlotDiv,s.removeElement=w.removeElement,s.addStyleRule=w.addStyleRule,s.addRelatedStyleRule=w.addRelatedStyleRule,s.deleteRelatedStyleRule=w.deleteRelatedStyleRule,s.clearResponsive=e("./clear_responsive"),s.makeTraceGroups=e("./make_trace_groups"),s._=e("./localize"),s.notifier=e("./notifier"),s.filterUnique=e("./filter_unique"),s.filterVisible=e("./filter_visible"),s.pushUnique=e("./push_unique"),s.cleanNumber=e("./clean_number"),s.ensureNumber=function(e){return o(e)?(e=+e,e<-n||e>n?l:o(e)?+e:l):l},s.isIndex=function(e,t){return!(void 0!==t&&e>=t)&&o(e)&&0<=e&&0==e%1},s.noop=e("./noop"),s.identity=e("./identity"),s.repeat=function(e,t){for(var a=Array(t),r=0;r<t;r++)a[r]=e;return a},s.swapAttrs=function(e,t,a,r){a||(a="x"),r||(r="y");for(var o=0;o<t.length;o++){var n=t[o],l=s.nestedProperty(e,n.replace("?",a)),d=s.nestedProperty(e,n.replace("?",r)),c=l.get();l.set(d.get()),d.set(c)}},s.raiseToTop=function(e){e.parentNode.appendChild(e)},s.cancelTransition=function(e){return e.transition().duration(0)},s.constrain=function(e,t,a){return t>a?va(a,ea(t,e)):va(t,ea(a,e))},s.bBoxIntersect=function(e,t,a){return a=a||0,e.left<=t.right+a&&t.left<=e.right+a&&e.top<=t.bottom+a&&t.top<=e.bottom+a},s.simpleMap=function(e,t,a,r){for(var o=e.length,n=Array(o),l=0;l<o;l++)n[l]=t(e[l],a,r);return n},s.randstr=function e(t,a,r,o){if(r||(r=16),void 0===a&&(a=24),0>=a)return"0";var n=P(ya(2,a))/P(r),l="",d,c,p;for(d=2;n==1/0;d*=2)n=P(ya(2,a/d))/P(r)*d;var u=n-ba(n);for(d=0;d<ba(n);d++)p=ba(Math.random()*r).toString(r),l=p+l;u&&(c=ya(r,u),p=ba(Math.random()*c).toString(r),l=p+l);var g=parseInt(l,r);return t&&t[l]||g!==1/0&&g>=ya(2,a)?10<o?(s.warn("randstr failed uniqueness"),l):e(t,a,r,(o||0)+1):l},s.OptionControl=function(e,t){e||(e={}),t||(t="opt");var a={};return a.optionList=[],a._newoption=function(r){r[t]=e,a[r.name]=r,a.optionList.push(r)},a["_"+t]=e,a},s.smooth=function(e,t){if(t=V(t)||0,2>t)return e;var a=e.length,r=2*a,o=2*t-1,n=Array(o),l=Array(a),s,d,c,p;for(s=0;s<o;s++)n[s]=(1-R(Pe*(s+1)/t))/(2*t);for(s=0;s<a;s++){for(p=0,d=0;d<o;d++)c=s+d+1-t,c<-a?c-=r*V(c/r):c>=r&&(c-=r*ba(c/r)),0>c?c=-1-c:c>=a&&(c=r-1-c),p+=e[c]*n[d];l[s]=p}return l},s.syncOrAsync=function(e,t,a){function r(){return s.syncOrAsync(e,t,a)}for(var o,i;e.length;)if(i=e.splice(0,1)[0],o=i(t),o&&o.then)return o.then(r).then(void 0,s.promiseError);return a&&a(t)},s.stripTrailingSlash=function(e){return"/"===e.substr(-1)?e.substr(0,e.length-1):e},s.noneOrAll=function(e,t,a){if(e){var r=!1,o=!0,n,l;for(n=0;n<a.length;n++)l=e[a[n]],void 0!==l&&null!==l?r=!0:o=!1;if(r&&!o)for(n=0;n<a.length;n++)e[a[n]]=t[a[n]]}},s.mergeArray=function(e,t,a,r){if(s.isArrayOrTypedArray(e))for(var o=ea(e.length,t.length),n=0,l;n<o;n++)l=e[n],t[n][a]="function"==typeof r?r(l):l},s.mergeArrayCastPositive=function(e,t,a){return s.mergeArray(e,t,a,function(e){var t=+e;return isFinite(t)?0<t?t:0:0})},s.fillArray=function(e,t,a,r){if(r=r||s.identity,s.isArrayOrTypedArray(e))for(var o=0;o<t.length;o++)t[o][a]=r(e[o])},s.castOption=function(e,t,a,r){r=r||s.identity;var o=s.nestedProperty(e,a).get();return s.isArrayOrTypedArray(o)?Array.isArray(t)&&s.isArrayOrTypedArray(o[t[0]])?r(o[t[0]][t[1]]):r(o[t]):o},s.extractOption=function(e,t,a,r){if(a in e)return e[a];var o=s.nestedProperty(t,r).get();if(!Array.isArray(o))return o},s.tagSelected=function(e,t,r){function o(t){return t!==void 0&&t<e.length}var n=t.selectedpoints,l=t._indexToPoints,d;l&&(d=a(l));for(var c=0,p;c<n.length;c++)if(p=n[c],s.isIndex(p)){var u=d?d[p]:p,g=r?r[u]:u;o(g)&&(e[g].selected=1)}},s.selIndices2selPoints=function(e){var t=e.selectedpoints,r=e._indexToPoints;if(r){for(var o=a(r),n=[],l=0,d;l<t.length;l++)if(d=t[l],s.isIndex(d)){var c=o[d];s.isIndex(c)&&n.push(c)}return n}return t},s.getTargetArray=function(e,t){var a=t.target;if("string"==typeof a&&a){var r=s.nestedProperty(e,a).get();return!!Array.isArray(r)&&r}return!!Array.isArray(a)&&a},s.minExtend=function(e,t){var a={};"object"!=typeof t&&(t={});var r=Object.keys(e),o,n,l;for(o=0;o<r.length;o++)if(n=r[o],l=e[n],"_"===n.charAt(0)||"function"==typeof l)continue;else a[n]="module"===n?l:Array.isArray(l)?"colorscale"===n?l.slice():l.slice(0,3):l&&"object"==typeof l?s.minExtend(e[n],t[n]):l;for(r=Object.keys(t),o=0;o<r.length;o++)n=r[o],l=t[n],"object"==typeof l&&n in a&&"object"==typeof a[n]||(a[n]=l);return a},s.titleCase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},s.containsAny=function(e,t){for(var a=0;a<t.length;a++)if(-1!==e.indexOf(t[a]))return!0;return!1},s.isIE=function(){return"undefined"!=typeof window.navigator.msSaveBlob};var T=/MSIE [1-9]\./;s.isIE9orBelow=function(){return s.isIE()&&T.test(window.navigator.userAgent)};var A=/Version\/[\d\.]+.*Safari/;s.isSafari=function(){return A.test(window.navigator.userAgent)},s.isD3Selection=function(e){return e&&"function"==typeof e.classed},s.ensureSingle=function(e,t,a,r){var o=e.select(t+(a?"."+a:""));if(o.size())return o;var i=e.append(t);return a&&i.classed(a,!0),r&&i.call(r),i},s.ensureSingleById=function(e,t,a,r){var o=e.select(t+"#"+a);if(o.size())return o;var i=e.append(t).attr("id",a);return r&&i.call(r),i},s.objectFromPath=function(e,t){for(var a=e.split("."),r=n={},o=0,n;o<a.length;o++){var l=a[o],s=null,d=a[o].match(/(.*)\[([0-9]+)\]/);d?(l=d[1],s=d[2],n=n[l]=[],n[s]=o==a.length-1?t:{},n=n[s]):(n[l]=o==a.length-1?t:{},n=n[l])}return r};var S=/^([^\[\.]+)\.(.+)?/,C=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;s.expandObjectPaths=function(e){var t,a,r,o,i,n,l;if("object"==typeof e&&!Array.isArray(e))for(a in e)e.hasOwnProperty(a)&&((t=a.match(S))?(o=e[a],r=t[1],delete e[a],e[r]=s.extendDeepNoArrays(e[r]||{},s.objectFromPath(a,s.expandObjectPaths(o))[r])):(t=a.match(C))?(o=e[a],r=t[1],i=parseInt(t[2]),delete e[a],e[r]=e[r]||[],"."===t[3]?(l=t[4],n=e[r][i]=e[r][i]||{},s.extendDeepNoArrays(n,s.objectFromPath(l,s.expandObjectPaths(o)))):e[r][i]=s.expandObjectPaths(o)):e[a]=s.expandObjectPaths(e[a]));return e},s.numSeparate=function(e,t,a){if(a||(a=!1),"string"!=typeof t||0===t.length)throw new Error("Separator string required for formatting!");"number"==typeof e&&(e+="");var r=/(\d+)(\d{3})/,o=t.charAt(0),i=t.charAt(1),n=e.split("."),l=n[0],s=1<n.length?o+n[1]:"";if(i&&(1<n.length||4<l.length||a))for(;r.test(l);)l=l.replace(r,"$1"+i+"$2");return l+s},s.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)(:[^}]*)?}/g;var L=/^\w*$/;s.templateString=function(e,t){var a={};return e.replace(s.TEMPLATE_STRING_REGEX,function(e,r){return L.test(r)?t[r]||"":(a[r]=a[r]||s.nestedProperty(t,r).get,a[r]()||"")})};var E=/^:/,I=0,z=10;s.hovertemplateString=function(e,t,a){var o=arguments,n={};return e.replace(s.TEMPLATE_STRING_REGEX,function(e,l,d){var c,p,u;for(u=3;u<o.length;u++){if(c=o[u],c.hasOwnProperty(l)){p=c[l];break}if(L.test(l)||(p=n[l]||s.nestedProperty(c,l).get(),p&&(n[l]=p)),void 0!==p)break}if(void 0===p&&(I<z&&(s.warn("Variable '"+l+"' in hovertemplate could not be found!"),p=e),I===z&&s.warn("Too many hovertemplate warnings - additional warnings will be suppressed"),I++),d){var g;g=a?a.numberFormat:r.format,p=g(d.replace(E,""))(p)}else t.hasOwnProperty(l+"Label")&&(p=t[l+"Label"]);return p})};var D=57;s.subplotSort=function(e,t){for(var a=ea(e.length,t.length)+1,r=0,o=0,n=0;n<a;n++){var l=e.charCodeAt(n)||0,s=t.charCodeAt(n)||0,d=48<=l&&l<=D,c=48<=s&&s<=D;if(d&&(r=10*r+l-48),c&&(o=10*o+s-48),!d||!c){if(r!==o)return r-o;if(l!==s)return l-s}}return o-r};var O=2e9;s.seedPseudoRandom=function(){O=2e9},s.pseudoRandom=function(){var e=O;return O=(69069*O+1)%4294967296,429496729>_a(O-e)?s.pseudoRandom():O/4294967296},s.fillText=function(e,t,a){var r=Array.isArray(a)?function(e){a.push(e)}:function(e){a.text=e},o=s.extractOption(e,t,"htx","hovertext");if(s.isValidTextValue(o))return r(o);var i=s.extractOption(e,t,"tx","text");if(s.isValidTextValue(i))return r(i)},s.isValidTextValue=function(e){return e||0===e},s.formatPercent=function(e,t){t=t||0;for(var a=(V(100*e*ya(10,t))*ya(.1,t)).toFixed(t)+"%",r=0;r<t;r++)-1!==a.indexOf(".")&&(a=a.replace("0%","%"),a=a.replace(".%","%"));return a},s.isHidden=function(e){var t=window.getComputedStyle(e).display;return!t||"none"===t}},{"../constants/numerical":695,"./anchor_utils":700,"./angles":701,"./array":702,"./clean_number":703,"./clear_responsive":705,"./coerce":706,"./dates":707,"./dom":708,"./extend":710,"./filter_unique":711,"./filter_visible":712,"./geometry2d":715,"./identity":718,"./is_plain_object":720,"./keyed_container":721,"./localize":722,"./loggers":723,"./make_trace_groups":724,"./matrix":725,"./mod":726,"./nested_property":727,"./noop":728,"./notifier":729,"./push_unique":733,"./regex":735,"./relative_attr":736,"./relink_private":737,"./search":738,"./stats":741,"./throttle":744,"./to_log_range":745,d3:163,"fast-isnumeric":225}],720:[function(e,t){"use strict";t.exports=function(e){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(e):"[object Object]"===Object.prototype.toString.call(e)&&Object.getPrototypeOf(e)===Object.prototype}},{}],721:[function(e,t){"use strict";var a=e("./nested_property"),r=/^\w*$/,o=1,n=2,l=3,s=4;t.exports=function(e,t,d,c){d=d||"name",c=c||"value";var p={},u,g,h;t&&t.length?(h=a(e,t),g=h.get()):g=e,t=t||"";var m={};if(g)for(u=0;u<g.length;u++)m[g[u][d]]=u;var y=r.test(c),f={set:function(e,t){var r=null===t?s:0;if(!g){if(!h||r===s)return;g=[],h.set(g)}var o=m[e];if(void 0===o){if(r===s)return;r|=l,o=g.length,m[e]=o}else t!==(y?g[o][c]:a(g[o],c).get())&&(r|=n);var i=g[o]=g[o]||{};return i[d]=e,y?i[c]=t:a(i,c).set(t),null!==t&&(r&=~s),p[o]|=r,f},get:function(e){if(g){var t=m[e];return void 0===t?void 0:y?g[t][c]:a(g[t],c).get()}},rename:function(e,t){var a=m[e];return void 0===a?f:(p[a]|=o,m[t]=a,delete m[e],g[a][d]=t,f)},remove:function(e){var t=m[e];if(t===void 0)return f;var r=g[t];if(2<Object.keys(r).length)return p[t]|=n,f.set(e,null);if(y){for(u=t;u<g.length;u++)p[u]|=l;for(u=t;u<g.length;u++)m[g[u][d]]--;g.splice(t,1),delete m[e]}else a(r,c).set(null),p[t]=p[t]|n|s;return f},constructUpdate:function(){for(var e={},r=Object.keys(p),l=0,u,h;l<r.length;l++)h=r[l],u=t+"["+h+"]",g[h]?(p[h]&o&&(e[u+"."+d]=g[h][d]),p[h]&n&&(y?e[u+"."+c]=p[h]&s?null:g[h][c]:e[u+"."+c]=p[h]&s?null:a(g[h],c).get())):e[u]=null;return e}};return f}},{"./nested_property":727}],722:[function(e,t){"use strict";var a=e("../registry");t.exports=function(e,t){for(var r=e._context.locale,o=0,n;2>o;o++){n=e._context.locales;for(var l=0,s;2>l;l++){if(s=(n[r]||{}).dictionary,s){var d=s[t];if(d)return d}n=a.localeRegistry}var c=r.split("-")[0];if(c===r)break;r=c}return t}},{"../registry":847}],723:[function(e,t){"use strict";function a(e,t){if(e&&e.apply)try{return void e.apply(console,t)}catch(t){}for(var a=0;a<t.length;a++)try{e(t[a])}catch(r){console.log(t[a])}}var r=e("../plot_api/plot_config").dfltConfig,o=t.exports={};o.log=function(){if(1<r.logging){for(var e=["LOG:"],t=0;t<arguments.length;t++)e.push(arguments[t]);a(console.trace||console.log,e)}},o.warn=function(){if(0<r.logging){for(var e=["WARN:"],t=0;t<arguments.length;t++)e.push(arguments[t]);a(console.trace||console.log,e)}},o.error=function(){if(0<r.logging){for(var e=["ERROR:"],t=0;t<arguments.length;t++)e.push(arguments[t]);a(console.error,e)}}},{"../plot_api/plot_config":755}],724:[function(e,t){"use strict";var a=e("d3");t.exports=function(e,t,r){var o=e.selectAll("g."+r.replace(/\s/g,".")).data(t,function(e){return e[0].trace.uid});o.exit().remove(),o.enter().append("g").attr("class",r),o.order();var i=e.classed("rangeplot")?"nodeRangePlot3":"node3";return o.each(function(e){e[0][i]=a.select(this)}),o}},{d3:163}],725:[function(e,t,r){"use strict";r.init2dArray=function(e,t){for(var a=Array(e),r=0;r<e;r++)a[r]=Array(t);return a},r.transposeRagged=function(e){var a=0,r=e.length,o,n;for(o=0;o<r;o++)a=va(a,e[o].length);var l=Array(a);for(o=0;o<a;o++)for(l[o]=Array(r),n=0;n<r;n++)l[o][n]=e[n][o];return l},r.dot=function(e,t){if(!(e.length&&t.length)||e.length!==t.length)return null;var a=e.length,o,n;if(e[0].length)for(o=Array(a),n=0;n<a;n++)o[n]=r.dot(e[n],t);else if(t[0].length){var l=r.transposeRagged(t);for(o=Array(l.length),n=0;n<l.length;n++)o[n]=r.dot(e,l[n])}else for(o=0,n=0;n<a;n++)o+=e[n]*t[n];return o},r.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]},r.rotationMatrix=function(e){var t=e*Pe/180;return[[R(t),-De(t),0],[De(t),R(t),0],[0,0,1]]},r.rotationXYMatrix=function(e,t,a){return r.dot(r.dot(r.translationMatrix(t,a),r.rotationMatrix(e)),r.translationMatrix(-t,-a))},r.apply2DTransform=function(e){return function(){var t=arguments;3===t.length&&(t=t[0]);var a=1===arguments.length?t[0]:[t[0],t[1]];return r.dot(e,[a[0],a[1],1]).slice(0,2)}},r.apply2DTransform2=function(e){var t=r.apply2DTransform(e);return function(e){return t(e.slice(0,2)).concat(t(e.slice(2,4)))}}},{}],726:[function(e,t){"use strict";t.exports={mod:function(e,t){var a=e%t;return 0>a?a+t:a},modHalf:function(e,t){return _a(e)>t/2?e-V(e/t)*t:e}}},{}],727:[function(e,t){"use strict";function a(e,t){return function(){var r=e,o,n,l,s,d;for(s=0;s<t.length-1;s++){if(o=t[s],-1===o){for(n=!0,l=[],d=0;d<r.length;d++)l[d]=a(r[d],t.slice(s+1))(),l[d]!==l[0]&&(n=!1);return n?l[0]:l}if("number"==typeof o&&!p(r))return;if(r=r[o],"object"!=typeof r||null===r)return}if("object"==typeof r&&null!==r)return l=r[t[s]],null===l?void 0:l}}function r(e,t){return e===void 0||null===e&&!t.match(u)}function o(e,t,a){return function(o){var d=e,c="",u=[[e,c]],g=r(o,a),h,m;for(m=0;m<t.length-1;m++){if(h=t[m],"number"==typeof h&&!p(d))throw"array index but container is not an array";if(-1===h)if(g=!l(d,t.slice(m+1),o,a),g)break;else return;if(!s(d,h,t[m+1],g))break;if(d=d[h],"object"!=typeof d||null===d)throw"container is not an object";c=n(c,h),u.push([d,c])}if(!g)d[t[m]]=o;else if(m===t.length-1&&(delete d[t[m]],Array.isArray(d)&&+t[m]==d.length-1))for(;d.length&&void 0===d[d.length-1];)d.pop()}}function n(e,t){var a=t;return c(t)?a="["+t+"]":e&&(a="."+t),e+a}function l(e,t,a,n){var l=p(a),d=!0,c=a,u=n.replace("-1",0),g=!l&&r(a,u),h=t[0],m;for(m=0;m<e.length;m++)(u=n.replace("-1",m),l&&(c=a[m%a.length],g=r(c,u)),g&&(d=!1),!!s(e,m,h,g))&&o(e[m],t,n.replace("-1",m))(c);return d}function s(e,t,a,r){if(e[t]===void 0){if(r)return!1;e[t]="number"==typeof a?[]:{}}return!0}function d(e,t,a){return{set:function(){throw"bad container"},get:function(){},astr:t,parts:a,obj:e}}var c=e("fast-isnumeric"),p=e("./array").isArrayOrTypedArray;t.exports=function(e,t){if(c(t))t=t+"";else if("string"!=typeof t||"[-1]"===t.substr(t.length-4))throw"bad property string";for(var r=0,n=t.split("."),l,s,p;r<n.length;){if(l=(n[r]+"").match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),l){if(l[1])n[r]=l[1];else if(0===r)n.splice(0,1);else throw"bad property string";for(s=l[2].substr(1,l[2].length-2).split("]["),p=0;p<s.length;p++)r++,n.splice(r,0,+s[p])}r++}return"object"==typeof e?{set:o(e,n,t),get:a(e,n),astr:t,parts:n,obj:e}:d(e,t,n)};var u=/(^|\.)args\[/},{"./array":702,"fast-isnumeric":225}],728:[function(e,t){"use strict";t.exports=function(){}},{}],729:[function(e,t){"use strict";var a=e("d3"),r=e("fast-isnumeric"),o=[];t.exports=function(e,t){function n(e){e.duration(700).style("opacity",0).each("end",function(e){var t=o.indexOf(e);-1!==t&&o.splice(t,1),a.select(this).remove()})}if(-1===o.indexOf(e)){o.push(e);var l=1e3;r(t)?l=t:"long"===t&&(l=3e3);var i=a.select("body").selectAll(".plotly-notifier").data([0]);i.enter().append("div").classed("plotly-notifier",!0);var s=i.selectAll(".notifier-note").data(o);s.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(e){var t=a.select(this);t.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){t.transition().call(n)});for(var r=t.append("p"),o=e.split(/<br\s*\/?>/g),s=0;s<o.length;s++)s&&r.append("br"),r.append("span").text(o[s]);t.transition().duration(700).style("opacity",1).transition().delay(l).call(n)})}}},{d3:163,"fast-isnumeric":225}],730:[function(e,t){"use strict";var a=e("./setcursor"),r="data-savedcursor",o="!!";t.exports=function(e,t){var n=e.attr(r);if(t){if(!n){for(var l=(e.attr("class")||"").split(" "),s=0,d;s<l.length;s++)d=l[s],0===d.indexOf("cursor-")&&e.attr(r,d.substr(7)).classed(d,!1);e.attr(r)||e.attr(r,o)}a(e,t)}else n&&(e.attr(r,null),n===o?a(e):a(e,n))}},{"./setcursor":739}],731:[function(e,t){"use strict";var a=e("./matrix").dot,r=e("../constants/numerical").BADNUM,o=t.exports={};o.tester=function(e){function t(e,t){var a=e[0],o=e[1];return!(a===r||a<n||a>l||o===r||o<s||o>d)&&!(t&&u(e))}function a(e,t){var a=e[0],c=e[1];if(a===r||a<n||a>l||c===r||c<s||c>d)return!1;var p=o.length,u=o[0][0],g=o[0][1],h=0,m,y,f,x,_;for(m=1;m<p;m++)if(y=u,f=g,u=o[m][0],g=o[m][1],x=ea(y,u),a<x||a>va(y,u)||c>va(f,g))continue;else if(c<ea(f,g))a!==x&&h++;else{if(_=u===y?c:f+(a-y)*(g-f)/(u-y),c===_)return!(1===m&&t);c<=_&&a!==x&&h++}return 1==h%2}var o=e.slice(),n=o[0][0],l=n,s=o[0][1],d=s,c;for(o.push(o[0]),c=1;c<o.length;c++)n=ea(n,o[c][0]),l=va(l,o[c][0]),s=ea(s,o[c][1]),d=va(d,o[c][1]);var p=!1,u;5===o.length&&(o[0][0]===o[1][0]?o[2][0]===o[3][0]&&o[0][1]===o[3][1]&&o[1][1]===o[2][1]&&(p=!0,u=function(e){return e[0]===o[0][0]}):o[0][1]===o[1][1]&&o[2][1]===o[3][1]&&o[0][0]===o[3][0]&&o[1][0]===o[2][0]&&(p=!0,u=function(e){return e[1]===o[0][1]}));var g=!0,h=o[0];for(c=1;c<o.length;c++)if(h[0]!==o[c][0]||h[1]!==o[c][1]){g=!1;break}return{xmin:n,xmax:l,ymin:s,ymax:d,pts:o,contains:p?t:a,isRect:p,degenerate:g}},o.isSegmentBent=function(e,t,r,o){var n=e[t],l=[e[r][0]-n[0],e[r][1]-n[1]],s=a(l,l),d=N(s),c=[-l[1]/d,l[0]/d],p,u,g;for(p=t+1;p<r;p++)if(u=[e[p][0]-n[0],e[p][1]-n[1]],g=a(u,l),0>g||g>s||_a(a(u,c))>o)return!0;return!1},o.filter=function(e,t){function a(a){e.push(a);var s=r.length,d=n;r.splice(l+1);for(var c=d+1;c<e.length;c++)(c===e.length-1||o.isSegmentBent(e,d,c+1,t))&&(r.push(e[c]),r.length<s-2&&(n=c,l=r.length-1),d=c)}var r=[e[0]],n=0,l=0;if(1<e.length){var s=e.pop();a(s)}return{addPt:a,raw:e,filtered:r}}},{"../constants/numerical":695,"./matrix":725}],732:[function(e,t){(function(a){"use strict";var r=e("./show_no_webgl_msg"),o=e("regl");t.exports=function(e,t){var i=e._fullLayout,n=!0;return i._glcanvas.each(function(r){if(!r.regl&&(!r.pick||i._has("parcoords"))){try{r.regl=o({canvas:this,attributes:{antialias:!r.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||a.devicePixelRatio,extensions:t||[]})}catch(t){n=!1}n&&this.addEventListener("webglcontextlost",function(t){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:t,layer:r.key})},!1)}}),n||r({container:i._glcontainer.node()}),n}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./show_no_webgl_msg":740,regl:502}],733:[function(e,t){"use strict";t.exports=function(e,t){if(t instanceof RegExp){for(var a=t.toString(),r=0;r<e.length;r++)if(e[r]instanceof RegExp&&e[r].toString()===a)return e;e.push(t)}else(t||0===t)&&-1===e.indexOf(t)&&e.push(t);return e}},{}],734:[function(e,t){"use strict";function a(e,t){for(var a=[],o=0,n;o<t.length;o++)n=t[o],a[o]=n===e?n:"object"==typeof n?Array.isArray(n)?r.extendDeep([],n):r.extendDeepAll({},n):n;return a}var r=e("../lib"),o=e("../plot_api/plot_config").dfltConfig,n={};n.add=function(e,t,a,r,i){var n,l;return e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},l=e.undoQueue.index,e.autoplay?void(e.undoQueue.inSequence||(e.autoplay=!1)):void(!e.undoQueue.sequence||e.undoQueue.beginSequence?(n={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(l,e.undoQueue.queue.length-l,n),e.undoQueue.index+=1):n=e.undoQueue.queue[l-1],e.undoQueue.beginSequence=!1,n&&(n.undo.calls.unshift(t),n.undo.args.unshift(a),n.redo.calls.push(r),n.redo.args.push(i)),e.undoQueue.queue.length>o.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--))},n.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},n.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},n.undo=function(e){var t,a;if(e.framework&&e.framework.isPolar)return void e.framework.undo();if(!(void 0===e.undoQueue||isNaN(e.undoQueue.index)||0>=e.undoQueue.index)){for(e.undoQueue.index--,t=e.undoQueue.queue[e.undoQueue.index],e.undoQueue.inSequence=!0,a=0;a<t.undo.calls.length;a++)n.plotDo(e,t.undo.calls[a],t.undo.args[a]);e.undoQueue.inSequence=!1,e.autoplay=!1}},n.redo=function(e){var t,a;if(e.framework&&e.framework.isPolar)return void e.framework.redo();if(!(void 0===e.undoQueue||isNaN(e.undoQueue.index)||e.undoQueue.index>=e.undoQueue.queue.length)){for(t=e.undoQueue.queue[e.undoQueue.index],e.undoQueue.inSequence=!0,a=0;a<t.redo.calls.length;a++)n.plotDo(e,t.redo.calls[a],t.redo.args[a]);e.undoQueue.inSequence=!1,e.autoplay=!1,e.undoQueue.index++}},n.plotDo=function(e,t,r){e.autoplay=!0,r=a(e,r),t.apply(null,r)},t.exports=n},{"../lib":719,"../plot_api/plot_config":755}],735:[function(e,t,a){"use strict";a.counter=function(e,t,a,r){var o=(t||"")+(a?"":"$"),i=!1===r?"":"^";return"xy"===e?new RegExp(i+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+o):new RegExp(i+e+"([2-9]|[1-9][0-9]+)?"+o)}},{}],736:[function(e,t){"use strict";var a=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,r=/^[^\.\[\]]+$/;t.exports=function(e,t){for(;t;){var o=e.match(a);if(o)e=o[1];else if(e.match(r))e="";else throw new Error("bad relativeAttr call:"+[e,t]);if("^"===t.charAt(0))t=t.slice(1);else break}return e&&"["!==t.charAt(0)?e+"."+t:e+t}},{}],737:[function(e,t){"use strict";var a=e("./array").isArrayOrTypedArray,r=e("./is_plain_object");t.exports=function e(t,o){for(var i in o){var n=o[i],l=t[i];if(l!==n)if("_"===i.charAt(0)||"function"==typeof n){if(i in t)continue;t[i]=n}else if(a(n)&&a(l)&&r(n[0])){if("customdata"==i||"ids"==i)continue;for(var s=ea(n.length,l.length),d=0;d<s;d++)l[d]!==n[d]&&r(n[d])&&r(l[d])&&e(l[d],n[d])}else r(n)&&r(l)&&(e(l,n),Object.keys(l).length||delete t[i])}}},{"./array":702,"./is_plain_object":720}],738:[function(e,t,a){"use strict";function r(e,t){return e<t}function o(e,t){return e<=t}function i(e,t){return e>t}function l(e,t){return e>=t}var s=e("fast-isnumeric"),d=e("./loggers"),c=e("./identity"),p=1e-9;a.findBin=function(e,t,a){if(s(t.start))return a?M((e-t.start)/t.size-p)-1:ba((e-t.start)/t.size+p);var u=0,g=t.length,h=0,m=1<g?(t[g-1]-t[0])/(g-1):1,y,f;for(f=0<=m?a?r:o:a?l:i,e+=m*p*(a?-1:1)*(0<=m?1:-1);u<g&&100>h++;)y=ba((u+g)/2),f(t[y],e)?u=y+1:g=y;return 90<h&&d.log("Long binary search..."),u-1},a.sorterAsc=function(e,t){return e-t},a.sorterDes=function(e,t){return t-e},a.distinctVals=function(e){var t=e.slice();t.sort(a.sorterAsc);for(var r=t.length-1,o=t[r]-t[0]||1,n=o/(r||1)/1e4,l=[t[0]],s=0;s<r;s++)t[s+1]>t[s]+n&&(o=ea(o,t[s+1]-t[s]),l.push(t[s+1]));return{vals:l,minDiff:o}},a.roundUp=function(e,t,a){for(var r=0,o=t.length-1,i=0,n=a?0:1,l=a?1:0,s=a?M:ba,d;r<o&&100>i++;)d=s((r+o)/2),t[d]<=e?r=d+n:o=d-l;return t[r]},a.sort=function(e,t){for(var a=0,r=0,o=1,n;o<e.length;o++)if(n=t(e[o],e[o-1]),0>n?a=1:0<n&&(r=1),a&&r)return e.sort(t);return r?e:e.reverse()},a.findIndexOfMin=function(e,t){t=t||c;for(var a=1/0,r=0,o,n;r<e.length;r++)n=t(e[r]),n<a&&(a=n,o=r);return o}},{"./identity":718,"./loggers":723,"fast-isnumeric":225}],739:[function(e,t){"use strict";t.exports=function(e,t){(e.attr("class")||"").split(" ").forEach(function(t){0===t.indexOf("cursor-")&&e.classed(t,!1)}),t&&e.classed("cursor-"+t,!0)}},{}],740:[function(e,t){"use strict";var a=e("../components/color"),r=function(){};t.exports=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=r);e.destroy=function(){e.container.parentNode.removeChild(e.container)};var o=document.createElement("div");o.className="no-webgl",o.style.cursor="pointer",o.style.fontSize="24px",o.style.color=a.defaults[0],o.style.position="absolute",o.style.left=o.style.top="0px",o.style.width=o.style.height="100%",o.style["background-color"]=a.lightLine,o.style["z-index"]=30;var i=document.createElement("p");return i.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",i.style.position="relative",i.style.top="50%",i.style.left="50%",i.style.height="30%",i.style.width="50%",i.style.margin="-15% 0 0 -25%",o.appendChild(i),e.container.appendChild(o),e.container.style.background="#FFFFFF",e.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":593}],741:[function(e,t,r){"use strict";var o=e("fast-isnumeric"),n=e("./array").isArrayOrTypedArray;r.aggNums=function(e,t,l,s){var d,c;if((!s||s>l.length)&&(s=l.length),o(t)||(t=!1),n(l[0])){for(c=Array(s),d=0;d<s;d++)c[d]=r.aggNums(e,t,l[d]);l=c}for(d=0;d<s;d++)o(t)?o(l[d])&&(t=e(+t,+l[d])):t=l[d];return t},r.len=function(e){return r.aggNums(function(e){return e+1},0,e)},r.mean=function(e,t){return t||(t=r.len(e)),r.aggNums(function(e,t){return e+t},0,e)/t},r.midRange=function(e){return void 0===e||0===e.length?void 0:(r.aggNums(Math.max,null,e)+r.aggNums(Math.min,null,e))/2},r.variance=function(e,t,i){return t||(t=r.len(e)),o(i)||(i=r.mean(e,t)),r.aggNums(function(e,t){return e+ya(t-i,2)},0,e)/t},r.stdev=function(e,t,a){return N(r.variance(e,t,a))},r.median=function(e){var t=e.slice().sort();return r.interp(t,.5)},r.interp=function(e,t){if(!o(t))throw"n should be a finite number";if(t=t*e.length-.5,0>t)return e[0];if(t>e.length-1)return e[e.length-1];var a=t%1;return a*e[M(t)]+(1-a)*e[ba(t)]}},{"./array":702,"fast-isnumeric":225}],742:[function(e,t){"use strict";var a=e("color-normalize");t.exports=function(e){return e?a(e):[0,0,0,1]}},{"color-normalize":120}],743:[function(e,t,a){"use strict";function r(e,t){return e.node().getBoundingClientRect()[t]}function o(e){return e.replace(y,"\\lt ").replace(f,"\\gt ")}function i(e,t,a){var r,i,n,l;MathJax.Hub.Queue(function(){return i=u.extendDeepAll({},MathJax.Hub.config),n=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if(r=MathJax.Hub.config.menuSettings.renderer,"SVG"!==r)return MathJax.Hub.setRenderer("SVG")},function(){var a="math-output-"+u.randstr({},64);return l=p.select("body").append("div").attr({id:a}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(o(e)),MathJax.Hub.Typeset(l.node())},function(){var t=p.select("body").select("#MathJax_SVG_glyphs");if(l.select(".MathJax_SVG").empty()||!l.select("svg").node())u.log("There was an error in the tex syntax.",e),a();else{var o=l.select("svg").node().getBoundingClientRect();a(l.select(".MathJax_SVG"),t,o)}return(l.remove(),"SVG"!==r)?MathJax.Hub.setRenderer(r):void 0},function(){return void 0!==n&&(MathJax.Hub.processSectionDelay=n),MathJax.Hub.Config(i)})}function n(e,t){if(!e)return null;var a=e.match(t),r=a&&(a[3]||a[4]);return r&&l(r)}function l(e){return e.replace(P,function(e,t){var a;return a="#"===t.charAt(0)?s("x"===t.charAt(1)?parseInt(t.substr(2),16):parseInt(t.substr(1),10)):z[t],a||e})}function s(e){var t=String.fromCodePoint;if(!(1114111<e)){var a=t;if(a)return a(e);var r=D;return 65535>=e?r(e):r((e>>10)+55232,e%1024+56320)}}function d(e,t){function a(){m++;var t=document.createElementNS(g.svg,"tspan");p.select(t).attr({class:"line",dy:m*h+"em"}),e.appendChild(t),f=t;var a=c;if(c=[{node:t}],1<a.length)for(var o=1;o<a.length;o++)r(a[o])}function r(e){var t=e.type,a={},r;if("a"===t){r="a";var i=e.target,n=e.href,l=e.popup;n&&(a={"xlink:xlink:show":"_blank"===i||"_"!==i.charAt(0)?"new":"replace",target:i,"xlink:xlink:href":n},l&&(a.onclick="window.open(this.href.baseVal,this.target.baseVal,\""+l+"\");return false;"))}else r="tspan";e.style&&(a.style=e.style);var s=document.createElementNS(g.svg,r);if("sup"===t||"sub"===t){o(f,"\u200B"),f.appendChild(s);var d=document.createElementNS(g.svg,"tspan");o(d,"\u200B"),p.select(d).attr("dy",b[t]),a.dy=_[t],f.appendChild(s),f.appendChild(d)}else f.appendChild(s);p.select(s).attr(a),f=e.node=s,c.push(e)}function o(e,t){e.appendChild(document.createTextNode(t))}function s(e){if(1===c.length)return void u.log("Ignoring unexpected end tag </"+e+">.",t);var a=c.pop();e!==a.type&&u.log("Start tag <"+a.type+"> doesnt match end tag <"+e+">. Pretending it did match.",t),f=c[c.length-1].node}t=t.replace(k," ");var d=!1,c=[],m=-1,y=A.test(t),f;y?a():(f=e,c=[{node:e}]);for(var z=t.split(w),P=0;P<z.length;P++){var D=z[P],O=D.match(T),R=O&&O[2].toLowerCase(),M=x[R];if("br"===R)a();else if(M===void 0)o(f,l(D));else if(O[1])s(R);else{var j=O[4],F={type:R},B=n(j,S);if(B?(B=B.replace(I,"$1 fill:"),M&&(B+=";"+M)):M&&(B=M),B&&(F.style=B),"a"===R){d=!0;var N=n(j,C);if(N){var V=document.createElement("a");V.href=N,-1!==v.indexOf(V.protocol)&&(F.href=encodeURI(decodeURI(N)),F.target=n(j,L)||"_blank",F.popup=n(j,E))}}r(F)}}return d}function c(e,t,a){var r=a.horizontalAlign,o=a.verticalAlign||"top",i=e.node().getBoundingClientRect(),n=t.node().getBoundingClientRect(),l,s,d;return s="bottom"===o?function(){return i.bottom-l.height}:"middle"===o?function(){return i.top+(i.height-l.height)/2}:function(){return i.top},d="right"===r?function(){return i.right-l.width}:"center"===r?function(){return i.left+(i.width-l.width)/2}:function(){return i.left},function(){return l=this.node().getBoundingClientRect(),this.style({top:s()-n.top+"px",left:d()-n.left+"px","z-index":1e3}),this}}var p=e("d3"),u=e("../lib"),g=e("../constants/xmlns_namespaces"),h=e("../constants/alignment").LINE_SPACING,m=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;a.convertToTspans=function(e,t,o){function n(){c.empty()||(u=e.attr("class")+"-math",c.select("svg."+u).remove()),e.text("").style("white-space","pre");var t=d(e.node(),l);t&&e.style("pointer-events","all"),a.positionText(e),o&&o.call(e)}var l=e.text(),s=!e.attr("data-notex")&&"undefined"!=typeof MathJax&&l.match(m),c=p.select(e.node().parentNode);if(!c.empty()){var u=e.attr("class")?e.attr("class").split(" ")[0]:"text";return u+="-math",c.selectAll("svg."+u).remove(),c.selectAll("g."+u+"-group").remove(),e.style("display",null).attr({"data-unformatted":l,"data-math":"N"}),s?(t&&t._promises||[]).push(new Promise(function(t){e.style("display","none");var a=parseInt(e.node().style.fontSize,10);i(s[2],{fontSize:a},function(i,s,d){c.selectAll("svg."+u).remove(),c.selectAll("g."+u+"-group").remove();var p=i&&i.select("svg");if(!p||!p.node())return n(),void t();var h=c.append("g").classed(u+"-group",!0).attr({"pointer-events":"none","data-unformatted":l,"data-math":"Y"});h.node().appendChild(p.node()),s&&s.node()&&p.node().insertBefore(s.node().cloneNode(!0),p.node().firstChild),p.attr({class:u,height:d.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var m=e.node().style.fill||"black",y=p.select("g");y.attr({fill:m,stroke:m});var g=r(y,"width"),f=r(y,"height"),x=+e.attr("x")-g*{start:0,middle:.5,end:1}[e.attr("text-anchor")||"start"],_=a||r(e,"height"),b=-_/4;"y"===u[0]?(h.attr({transform:"rotate("+[-90,+e.attr("x"),+e.attr("y")]+") translate("+[-g/2,b-f/2]+")"}),p.attr({x:+e.attr("x"),y:+e.attr("y")})):"l"===u[0]?p.attr({x:e.attr("x"),y:b-f/2}):"a"===u[0]&&0!==u.indexOf("atitle")?p.attr({x:0,y:b}):p.attr({x:x,y:+e.attr("y")+b-f/2}),o&&o.call(e,h),t(h)})})):n(),e}};var y=/(<|&lt;|&#60;)/g,f=/(>|&gt;|&#62;)/g,x={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},_={sub:"0.3em",sup:"-0.6em"},b={sub:"-0.21em",sup:"0.42em"},v=["http:","https:","mailto:","",void 0,":"],k=/(\r\n?|\n)/g,w=/(<[^<>]*>)/,T=/<(\/?)([^ >]*)(\s+(.*))?>/i,A=/<br(\s+.*)?>/i,S=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,C=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,L=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,E=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i,I=/(^|;)\s*color:/;a.plainText=function(e,t){t=t||{};for(var a=t.len!==void 0&&-1!==t.len?t.len:1/0,r=t.allowedTags===void 0?["br"]:t.allowedTags,o="...",n=o.length,s=e.split(w),d=[],c="",u=0,g=0;g<s.length;g++){var h=s[g],p=h.match(T),m=p&&p[2].toLowerCase();if(m)-1!==r.indexOf(m)&&(d.push(h),c=m);else{var y=h.length;if(u+y<a)d.push(h),u+=y;else if(u<a){var f=a-u;c&&("br"!==c||f<=n||y<=n)&&d.pop(),a>n?d.push(h.substr(0,f-n)+o):d.push(h.substr(0,f));break}c=""}}return d.join("")};var z={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},P=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;a.convertEntities=l,a.lineCount=function(e){return e.selectAll("tspan.line").size()||1},a.positionText=function(e,t,a){return e.each(function(){function e(e,t){return void 0===t?(t=r.attr(e),null===t&&(r.attr(e,0),t=0)):r.attr(e,t),t}var r=p.select(this),o=e("x",t),i=e("y",a);"text"===this.nodeName&&r.selectAll("tspan.line").attr({x:o,y:i})})},a.makeEditable=function(e,t){function a(){o(),e.style({opacity:0});var t=s.attr("class"),a;a=t?"."+t.split(" ")[0]+"-math-group":"[class*=-math-group]",a&&p.select(e.node().parentNode).select(a).style({opacity:0})}function r(e){var t=e.node(),a=document.createRange();a.selectNodeContents(t);var r=window.getSelection();r.removeAllRanges(),r.addRange(a),t.focus()}function o(){var a=p.select(i),o=a.select(".svg-container"),n=o.append("div"),s=e.node().style,d=parseFloat(s.fontSize||12),u=t.text;void 0===u&&(u=e.attr("data-unformatted")),n.classed("plugin-editable editable",!0).style({position:"absolute","font-family":s.fontFamily||"Arial","font-size":d,color:t.fill||s.fill||"black",opacity:1,"background-color":t.background||"transparent",outline:"#ffffff33 1px solid",margin:[-d/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(u).call(c(e,o,t)).on("blur",function(){i._editing=!1,e.text(this.textContent).style({opacity:1});var t=p.select(this).attr("class"),a;a=t?"."+t.split(" ")[0]+"-math-group":"[class*=-math-group]",a&&p.select(e.node().parentNode).select(a).style({opacity:0});var r=this.textContent;p.select(this).transition().duration(0).remove(),p.select(document).on("mouseup",null),l.edit.call(e,r)}).on("focus",function(){var e=this;i._editing=!0,p.select(document).on("mouseup",function(){return p.event.target!==e&&void(document.activeElement===n.node()&&n.node().blur())})}).on("keyup",function(){27===p.event.which?(i._editing=!1,e.style({opacity:1}),p.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),l.cancel.call(e,this.textContent)):(l.input.call(e,this.textContent),p.select(this).call(c(e,o,t)))}).on("keydown",function(){13===p.event.which&&this.blur()}).call(r)}var i=t.gd,n=t.delegate,l=p.dispatch("edit","input","cancel"),s=n||e;if(e.style({"pointer-events":n?"none":"all"}),1!==e.size())throw new Error("boo");return t.immediate?a():s.on("click",a),p.rebind(e,l,"on")}},{"../constants/alignment":688,"../constants/xmlns_namespaces":696,"../lib":719,d3:163}],744:[function(e,t,a){"use strict";function r(e){e&&null!==e.timer&&(clearTimeout(e.timer),e.timer=null)}var o={};a.throttle=function(e,t,a){function i(){a(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}var n=o[e],l=Date.now();if(!n){for(var s in o)o[s].ts<l-6e4&&delete o[s];n=o[e]={ts:0,timer:null}}return r(n),l>n.ts+t?void i():void(n.timer=setTimeout(function(){i(),n.timer=null},t))},a.done=function(e){var t=o[e];return t&&t.timer?new Promise(function(e){var a=t.onDone;t.onDone=function(){a&&a(),e(),t.onDone=null}}):Promise.resolve()},a.clear=function(e){if(e)r(o[e]),delete o[e];else for(var t in o)a.clear(t)}},{}],745:[function(e,t){"use strict";var a=e("fast-isnumeric");t.exports=function(e,t){if(0<e)return P(e)/I;var r=P(ea(t[0],t[1]))/I;return a(r)||(r=P(va(t[0],t[1]))/I-6),r}},{"fast-isnumeric":225}],746:[function(e,t){"use strict";var a=t.exports={},r=e("../plots/geo/constants").locationmodeToLayer,o=e("topojson-client").feature;a.getTopojsonName=function(e){return[e.scope.replace(/ /g,"-"),"_",e.resolution.toString(),"m"].join("")},a.getTopojsonPath=function(e,t){return e+t+".json"},a.getTopojsonFeatures=function(e,t){var a=r[e.locationmode],i=t.objects[a];return o(t,i).features}},{"../plots/geo/constants":795,"topojson-client":540}],747:[function(e,t){"use strict";t.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],748:[function(e,t){"use strict";t.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],749:[function(e,t){"use strict";var a=e("../registry");t.exports=function(e){for(var t=a.layoutArrayContainers,r=a.layoutArrayRegexes,o=e.split("[")[0],n=0,l,s;n<r.length;n++)if(s=e.match(r[n]),s&&0===s.index){l=s[0];break}if(l||(l=t[t.indexOf(o)]),!l)return!1;var d=e.substr(l.length);return d?(s=d.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),!!s&&{array:l,index:+s[1],property:s[3]||""}):{array:l,index:"",property:""}}},{"../registry":847}],750:[function(e,t){"use strict";function a(e){for(var t={},a=0;a<e.length;a++)t[e[a]]=!1;return t}function r(e,t,a){var r=n({},e);for(var i in r){var s=r[i];l(s)&&(r[i]=o(s,t,a,i))}return"from-root"===a&&(r.editType=t),r}function o(e,t,a,l){if(e.valType){var s=n({},e);if(s.editType=t,Array.isArray(e.items)){s.items=Array(e.items.length);for(var d=0;d<e.items.length;d++)s.items[d]=o(e.items[d],t,"from-root")}return s}return r(e,t,"_"===l.charAt(0)?"nested":"from-root")}var i=e("../lib"),n=i.extendFlat,l=i.isPlainObject,s={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},d={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},c=s.flags.slice().concat(["fullReplot"]),p=d.flags.slice().concat("layoutReplot");t.exports={traces:s,layout:d,traceFlags:function(){return a(c)},layoutFlags:function(){return a(p)},update:function(e,t){var a=t.editType;if(a&&"none"!==a)for(var r=a.split("+"),o=0;o<r.length;o++)e[r[o]]=!0},overrideAll:r}},{"../lib":719}],751:[function(e,t,a){"use strict";function r(e,t){var a=e[t],r=t.charAt(0);a&&"paper"!==a&&(e[t]=f(a,r))}function o(e){function t(t,a){var r=e[t],o=e.title&&e.title[a];r&&!o&&(!e.title&&(e.title={}),e.title[a]=e[t],delete e[t])}e&&(("string"==typeof e.title||"number"==typeof e.title)&&(e.title={text:e.title}),t("titlefont","font"),t("titleposition","position"),t("titleside","side"),t("titleoffset","offset"))}function i(e){if(!g.isPlainObject(e))return!1;var t=e.name;return delete e.name,delete e.showlegend,("string"==typeof t||"number"==typeof t)&&t+""}function n(e,t,a,r){if(a&&!r)return e;if(r&&!a)return t;if(!e.trim())return t;if(!t.trim())return e;var o=ea(e.length,t.length),n;for(n=0;n<o&&!(e.charAt(n)!==t.charAt(n));n++);var l=e.substr(0,n);return l.trim()}function l(e){var t="middle",a="center";return"string"==typeof e&&(-1===e.indexOf("top")?-1!==e.indexOf("bottom")&&(t="bottom"):t="top",-1===e.indexOf("left")?-1!==e.indexOf("right")&&(a="right"):a="left"),t+" "+a}function s(e,t){return t in e&&"object"==typeof e[t]&&0===Object.keys(e[t]).length}function d(e){var t=e.search(b);if(0<t)return e.substr(0,t)}var c=e("fast-isnumeric"),p=e("gl-mat4/fromQuat"),u=e("../registry"),g=e("../lib"),h=e("../plots/plots"),m=e("../plots/cartesian/axis_ids"),y=e("../components/color"),f=m.cleanId,x=m.getFromTrace,_=u.traceIs;a.clearPromiseQueue=function(e){Array.isArray(e._promises)&&0<e._promises.length&&g.log("Clearing previous rejected promises from queue."),e._promises=[]},a.cleanLayout=function(e){var t,n;e||(e={}),e.xaxis1&&(!e.xaxis&&(e.xaxis=e.xaxis1),delete e.xaxis1),e.yaxis1&&(!e.yaxis&&(e.yaxis=e.yaxis1),delete e.yaxis1),e.scene1&&(!e.scene&&(e.scene=e.scene1),delete e.scene1);var l=(h.subplotsRegistry.cartesian||{}).attrRegex,d=(h.subplotsRegistry.polar||{}).attrRegex,c=(h.subplotsRegistry.ternary||{}).attrRegex,u=(h.subplotsRegistry.gl3d||{}).attrRegex,m=Object.keys(e);for(t=0;t<m.length;t++){var x=m[t];if(l&&l.test(x)){var _=e[x];_.anchor&&"free"!==_.anchor&&(_.anchor=f(_.anchor)),_.overlaying&&(_.overlaying=f(_.overlaying)),_.type||(_.isdate?_.type="date":_.islog?_.type="log":!1===_.isdate&&!1===_.islog&&(_.type="linear")),("withzero"===_.autorange||"tozero"===_.autorange)&&(_.autorange=!0,_.rangemode="tozero"),delete _.islog,delete _.isdate,delete _.categories,s(_,"domain")&&delete _.domain,void 0!==_.autotick&&(void 0===_.tickmode&&(_.tickmode=_.autotick?"auto":"linear"),delete _.autotick),o(_)}else if(d&&d.test(x)){var b=e[x];o(b.radialaxis)}else if(c&&c.test(x)){var v=e[x];o(v.aaxis),o(v.baxis),o(v.caxis)}else if(u&&u.test(x)){var k=e[x],w=k.cameraposition;if(Array.isArray(w)&&4===w[0].length){var T=w[0],A=w[1],S=w[2],C=p([],T),L=[];for(n=0;3>n;++n)L[n]=A[n]+S*C[2+4*n];k.camera={eye:{x:L[0],y:L[1],z:L[2]},center:{x:A[0],y:A[1],z:A[2]},up:{x:0,y:0,z:1}},delete k.cameraposition}o(k.xaxis),o(k.yaxis),o(k.zaxis)}}var E=Array.isArray(e.annotations)?e.annotations.length:0;for(t=0;t<E;t++){var I=e.annotations[t];g.isPlainObject(I)&&(I.ref&&("paper"===I.ref?(I.xref="paper",I.yref="paper"):"data"===I.ref&&(I.xref="x",I.yref="y"),delete I.ref),r(I,"xref"),r(I,"yref"))}var z=Array.isArray(e.shapes)?e.shapes.length:0;for(t=0;t<z;t++){var P=e.shapes[t];g.isPlainObject(P)&&(r(P,"xref"),r(P,"yref"))}var D=e.legend;return D&&(3<D.x?(D.x=1.02,D.xanchor="left"):-2>D.x&&(D.x=-.02,D.xanchor="right"),3<D.y?(D.y=1.02,D.yanchor="bottom"):-2>D.y&&(D.y=-.02,D.yanchor="top")),o(e),"rotate"===e.dragmode&&(e.dragmode="orbit"),y.clean(e),e.template&&e.template.layout&&a.cleanLayout(e.template.layout),e},a.cleanData=function(e){for(var t=0;t<e.length;t++){var r=e[t],d;if("histogramy"===r.type&&"xbins"in r&&!("ybins"in r)&&(r.ybins=r.xbins,delete r.xbins),r.error_y&&"opacity"in r.error_y){var c=y.defaults,p=r.error_y.color||(_(r,"bar")?y.defaultLine:c[t%c.length]);r.error_y.color=y.addOpacity(y.rgb(p),y.opacity(p)*r.error_y.opacity),delete r.error_y.opacity}if("bardir"in r&&("h"===r.bardir&&(_(r,"bar")||"histogram"===r.type.substr(0,9))&&(r.orientation="h",a.swapXYData(r)),delete r.bardir),"histogramy"===r.type&&a.swapXYData(r),("histogramx"===r.type||"histogramy"===r.type)&&(r.type="histogram"),"scl"in r&&!("colorscale"in r)&&(r.colorscale=r.scl,delete r.scl),"reversescl"in r&&!("reversescale"in r)&&(r.reversescale=r.reversescl,delete r.reversescl),r.xaxis&&(r.xaxis=f(r.xaxis,"x")),r.yaxis&&(r.yaxis=f(r.yaxis,"y")),_(r,"gl3d")&&r.scene&&(r.scene=h.subplotsRegistry.gl3d.cleanId(r.scene)),!_(r,"pie-like")&&!_(r,"bar-like"))if(Array.isArray(r.textposition))for(d=0;d<r.textposition.length;d++)r.textposition[d]=l(r.textposition[d]);else r.textposition&&(r.textposition=l(r.textposition));var m=u.getModule(r);if(m&&m.colorbar){var x=m.colorbar.container,b=x?r[x]:r;b&&b.colorscale&&("YIGnBu"===b.colorscale&&(b.colorscale="YlGnBu"),"YIOrRd"===b.colorscale&&(b.colorscale="YlOrRd"))}if("surface"===r.type&&g.isPlainObject(r.contours)){var v=["x","y","z"];for(d=0;d<v.length;d++){var k=r.contours[v[d]];g.isPlainObject(k)&&(k.highlightColor&&(k.highlightcolor=k.highlightColor,delete k.highlightColor),k.highlightWidth&&(k.highlightwidth=k.highlightWidth,delete k.highlightWidth))}}if("candlestick"===r.type||"ohlc"===r.type){var w=!1!==(r.increasing||{}).showlegend,T=!1!==(r.decreasing||{}).showlegend,A=i(r.increasing),S=i(r.decreasing);if(!1!==A&&!1!==S){var C=n(A,S,w,T);C&&(r.name=C)}else(A||S)&&!r.name&&(r.name=A||S)}if(Array.isArray(r.transforms)){var L=r.transforms;for(d=0;d<L.length;d++){var E=L[d];if(g.isPlainObject(E))switch(E.type){case"filter":E.filtersrc&&(E.target=E.filtersrc,delete E.filtersrc),E.calendar&&(!E.valuecalendar&&(E.valuecalendar=E.calendar),delete E.calendar);break;case"groupby":if(E.styles=E.styles||E.style,E.styles&&!Array.isArray(E.styles)){var I=E.styles,z=Object.keys(I);E.styles=[];for(var P=0;P<z.length;P++)E.styles.push({target:z[P],value:I[z[P]]})}}}}s(r,"line")&&delete r.line,"marker"in r&&(s(r.marker,"line")&&delete r.marker.line,s(r,"marker")&&delete r.marker),y.clean(r),r.autobinx&&(delete r.autobinx,delete r.xbins),r.autobiny&&(delete r.autobiny,delete r.ybins),o(r),r.colorbar&&o(r.colorbar),r.marker&&r.marker.colorbar&&o(r.marker.colorbar),r.line&&r.line.colorbar&&o(r.line.colorbar),r.aaxis&&o(r.aaxis),r.baxis&&o(r.baxis)}},a.swapXYData=function(e){var t;if(g.swapAttrs(e,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(e.z)&&Array.isArray(e.z[0])&&(e.transpose?delete e.transpose:e.transpose=!0),e.error_x&&e.error_y){var a=e.error_y,r="copy_ystyle"in a?a.copy_ystyle:!(a.color||a.thickness||a.width);g.swapAttrs(e,["error_?.copy_ystyle"]),r&&g.swapAttrs(e,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof e.hoverinfo){var o=e.hoverinfo.split("+");for(t=0;t<o.length;t++)"x"===o[t]?o[t]="y":"y"===o[t]&&(o[t]="x");e.hoverinfo=o.join("+")}},a.coerceTraceIndices=function(e,t){if(c(t))return[t];if(!Array.isArray(t)||!t.length)return e.data.map(function(e,t){return t});if(Array.isArray(t)){for(var a=[],r=0;r<t.length;r++)g.isIndex(t[r],e.data.length)?a.push(t[r]):g.warn("trace index (",t[r],") is not a number or is out of bounds");return a}return t},a.manageArrayContainers=function(e,t,a){var r=e.obj,o=e.parts,i=o.length,n=o[i-1],l=c(n);if(l&&null===t){var s=o.slice(0,i-1).join("."),d=g.nestedProperty(r,s).get();d.splice(n,1)}else l&&void 0===e.get()?(void 0===e.get()&&(a[e.astr]=null),e.set(t)):e.set(t)};var b=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;a.hasParent=function(e,t){for(var a=d(t);a;){if(a in e)return!0;a=d(a)}return!1};var v=["x","y","z"];a.clearAxisTypes=function(e,t,a){for(var r=0,o;r<t.length;r++){o=e._fullData[r];for(var n=0,l;3>n;n++)if(l=x(e,o,v[n]),l&&"log"!==l.type){var s=l._name,d=l._id.substr(1);if("scene"===d.substr(0,5)){if(void 0!==a[d])continue;s=d+"."+s}var c=s+".type";void 0===a[s]&&void 0===a[c]&&g.nestedProperty(e.layout,c).set(null)}}}},{"../components/color":593,"../lib":719,"../plots/cartesian/axis_ids":770,"../plots/plots":828,"../registry":847,"fast-isnumeric":225,"gl-mat4/fromQuat":262}],752:[function(e,t,a){"use strict";var r=e("./plot_api");a.plot=r.plot,a.newPlot=r.newPlot,a.restyle=r.restyle,a.relayout=r.relayout,a.redraw=r.redraw,a.update=r.update,a._guiRestyle=r._guiRestyle,a._guiRelayout=r._guiRelayout,a._guiUpdate=r._guiUpdate,a._storeDirectGUIEdit=r._storeDirectGUIEdit,a.react=r.react,a.extendTraces=r.extendTraces,a.prependTraces=r.prependTraces,a.addTraces=r.addTraces,a.deleteTraces=r.deleteTraces,a.moveTraces=r.moveTraces,a.purge=r.purge,a.addFrames=r.addFrames,a.deleteFrames=r.deleteFrames,a.animate=r.animate,a.setPlotConfig=r.setPlotConfig,a.toImage=e("./to_image"),a.validate=e("./validate"),a.downloadImage=e("../snapshot/download");var o=e("./template_api");a.makeTemplate=o.makeTemplate,a.validateTemplate=o.validateTemplate},{"../snapshot/download":849,"./plot_api":754,"./template_api":759,"./to_image":760,"./validate":761}],753:[function(e,t,a){"use strict";var r=e("../lib/is_plain_object"),o=e("../lib/noop"),n=e("../lib/loggers"),l=e("../lib/search").sorterAsc,s=e("../registry");a.containerArrayMatch=e("./container_array_match");var d=a.isAddVal=function(e){return"add"===e||r(e)},c=a.isRemoveVal=function(e){return null===e||"remove"===e};a.applyContainerArrayChanges=function(e,t,a,r,p){var u=t.astr,g=s.getComponentMethod(u,"supplyLayoutDefaults"),h=s.getComponentMethod(u,"draw"),m=s.getComponentMethod(u,"drawOne"),y=r.replot||r.recalc||g===o||h===o,f=e.layout,x=e._fullLayout;if(a[""]){1<Object.keys(a).length&&n.warn("Full array edits are incompatible with other edits",u);var _=a[""][""];if(c(_))t.set(null);else if(Array.isArray(_))t.set(_);else return n.warn("Unrecognized full array edit value",u,_),!0;return!y&&(g(f,x),h(e),!0)}var b=Object.keys(a).map(Number).sort(l),v=t.get(),k=v||[],w=p(x,u).get(),T=[],A=-1,S=k.length,C,L,E,I,z,P,D,O;for(C=0;C<b.length;C++){if(E=b[C],I=a[E],z=Object.keys(I),P=I[""],D=d(P),0>E||E>k.length-(D?0:1)){n.warn("index out of range",u,E);continue}if(void 0!==P)1<z.length&&n.warn("Insertion & removal are incompatible with edits to the same index.",u,E),c(P)?T.push(E):D?("add"===P&&(P={}),k.splice(E,0,P),w&&w.splice(E,0,{})):n.warn("Unrecognized full object edit value",u,E,P),-1===A&&(A=E);else for(L=0;L<z.length;L++)O=u+"["+E+"].",p(k[E],z[L],O).set(I[z[L]])}for(C=T.length-1;0<=C;C--)k.splice(T[C],1),w&&w.splice(T[C],1);if(k.length?!v&&t.set(k):t.set(null),y)return!1;if(g(f,x),m!==o){var R;if(-1===A)R=b;else{for(S=va(k.length,S),R=[],C=0;C<b.length&&(E=b[C],!(E>=A));C++)R.push(E);for(C=A;C<S;C++)R.push(C)}for(C=0;C<R.length;C++)m(e,R[C])}else h(e);return!0}},{"../lib/is_plain_object":720,"../lib/loggers":723,"../lib/noop":728,"../lib/search":738,"../registry":847,"./container_array_match":749}],754:[function(e,t,a){"use strict";function r(e){var t=e._fullLayout;t._redrawFromAutoMarginCount?t._redrawFromAutoMarginCount--:e.emit("plotly_afterplot")}function o(e,t){try{e._fullLayout._paper.style("background",t)}catch(t){J.error(t)}}function n(e,t){var a=le.combine(t,"white");o(e,a)}function l(e,t){if(!e._context){e._context=J.extendDeep({},ue);var a=Z.select("base");e._context._baseUrl=a.size()&&a.attr("href")?window.location.href.split("#")[0]:""}var r=e._context,l,s,d;if(t){for(s=Object.keys(t),l=0;l<s.length;l++)d=s[l],"editable"!==d&&"edits"!==d&&d in r&&("setBackground"===d&&"opaque"===t[d]?r[d]=n:r[d]=t[d]);t.plot3dPixelRatio&&!r.plotGlPixelRatio&&(r.plotGlPixelRatio=r.plot3dPixelRatio);var c=t.editable;if(c!==void 0)for(r.editable=c,s=Object.keys(r.edits),l=0;l<s.length;l++)r.edits[s[l]]=c;if(t.edits)for(s=Object.keys(t.edits),l=0;l<s.length;l++)d=s[l],d in r.edits&&(r.edits[d]=t.edits[d]);r._exportedPlot=t._exportedPlot}r.staticPlot&&(r.editable=!1,r.edits={},r.autosizable=!1,r.scrollZoom=!1,r.doubleClick=!1,r.showTips=!1,r.showLink=!1,r.displayModeBar=!1),"hover"!==r.displayModeBar||K||(r.displayModeBar=!0),("transparent"===r.setBackground||"function"!=typeof r.setBackground)&&(r.setBackground=o),r._hasZeroHeight=r._hasZeroHeight||0===e.clientHeight,r._hasZeroWidth=r._hasZeroWidth||0===e.clientWidth;var p=r.scrollZoom,u=r._scrollZoom={};if(!0===p)u.cartesian=1,u.gl3d=1,u.geo=1,u.mapbox=1;else if("string"==typeof p){var g=p.split("+");for(l=0;l<g.length;l++)u[g[l]]=1}else!1!==p&&(u.gl3d=1,u.geo=1,u.mapbox=1)}function s(e,t,a){var r=Z.select(e).selectAll(".plot-container").data([0]);r.enter().insert("div",":first-child").classed("plot-container plotly",!0);var o=r.selectAll(".svg-container").data([0]);o.enter().append("div").classed("svg-container",!0).style("position","relative"),o.html(""),t&&(e.data=t),a&&(e.layout=a),oe.manager.fillLayout(e),o.style({width:e._fullLayout.width+"px",height:e._fullLayout.height+"px"}),e.framework=oe.manager.framework(e),e.framework({data:e.data,layout:e.layout},o.node()),e.framework.setUndoPoint();var i=e.framework.svg(),n=1,l=e._fullLayout.title?e._fullLayout.title.text:"";""!==l&&l||(n=0);var s=function(){this.call(ce.convertToTspans,e)},d=i.select(".title-group text").call(s);if(e._context.edits.titleText){var c=J._(e,"Click to enter Plot title");l&&l!==c||(n=.2,d.attr({"data-unformatted":c}).text(c).style({opacity:n}).on("mouseover.opacity",function(){Z.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){Z.select(this).transition().duration(1e3).style("opacity",0)}));var p=function(){this.call(ce.makeEditable,{gd:e}).on("edit",function(t){e.framework({layout:{title:{text:t}}}),this.text(t).call(s),this.call(p)}).on("cancel",function(){var e=this.attr("data-unformatted");this.text(e).call(s)})};d.call(p)}return e._context.setBackground(e,e._fullLayout.paper_bgcolor),re.addLinks(e),Promise.resolve()}function d(e,t){var a=[],r,o;for(r=0;r<e.length;r++)o=e[r],0>o?a.push(t+1+o):a.push(o);return a}function c(e,t,a){var r,o;for(r=0;r<t.length;r++){if(o=t[r],o!==parseInt(o,10))throw new Error("all values in "+a+" must be integers");if(o>=e.data.length||o<-e.data.length)throw new Error(a+" must be valid indices for gd.data.");if(-1<t.indexOf(o,r+1)||0<=o&&-1<t.indexOf(-e.data.length+o)||0>o&&-1<t.indexOf(e.data.length+o))throw new Error("each index in "+a+" must be unique.")}}function p(e,t,a){if(!Array.isArray(e.data))throw new Error("gd.data must be an array.");if("undefined"==typeof t)throw new Error("currentIndices is a required argument.");else Array.isArray(t)||(t=[t]);if(c(e,t,"currentIndices"),"undefined"==typeof a||Array.isArray(a)||(a=[a]),"undefined"!=typeof a&&c(e,a,"newIndices"),"undefined"!=typeof a&&t.length!==a.length)throw new Error("current and new indices must be of equal length.")}function u(e,t,a){var r,o;if(!Array.isArray(e.data))throw new Error("gd.data must be an array.");if("undefined"==typeof t)throw new Error("traces must be defined.");for(Array.isArray(t)||(t=[t]),r=0;r<t.length;r++)if(o=t[r],"object"!=typeof o||Array.isArray(o)||null===o)throw new Error("all values in traces array must be non-array objects");if("undefined"==typeof a||Array.isArray(a)||(a=[a]),"undefined"!=typeof a&&a.length!==t.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function g(e,t,a,r){var o=J.isPlainObject(r);if(!Array.isArray(e.data))throw new Error("gd.data must be an array");if(!J.isPlainObject(t))throw new Error("update must be a key:value object");if("undefined"==typeof a)throw new Error("indices must be an integer or array of integers");for(var i in c(e,a,"indices"),t){if(!Array.isArray(t[i])||t[i].length!==a.length)throw new Error("attribute "+i+" must be an array of length equal to indices array length");if(o&&(!(i in r)||!Array.isArray(r[i])||r[i].length!==t[i].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function h(e,t,a,r){var o=J.isPlainObject(r),n=[],l,s,c,p,u;for(var g in Array.isArray(a)||(a=[a]),a=d(a,e.data.length-1),t)for(var h=0;h<a.length;h++){if(l=e.data[a[h]],c=Q(l,g),s=c.get(),p=t[g][h],!J.isArrayOrTypedArray(p))throw new Error("attribute: "+g+" index: "+h+" must be an array");if(!J.isArrayOrTypedArray(s))throw new Error("cannot extend missing or non-array attribute: "+g);if(s.constructor!==p.constructor)throw new Error("cannot extend array with an array of a different type: "+g);u=o?r[g][h]:r,i(u)||(u=-1),n.push({prop:c,target:s,insert:p,maxp:ba(u)})}return n}function m(e,t,a,r,o){g(e,t,a,r);for(var n=h(e,t,a,r),l={},s={},d=0;d<n.length;d++){var c=n[d].prop,p=n[d].maxp,u=o(n[d].target,n[d].insert,p);c.set(u[0]),Array.isArray(l[c.astr])||(l[c.astr]=[]),l[c.astr].push(u[1]),Array.isArray(s[c.astr])||(s[c.astr]=[]),s[c.astr].push(n[d].target.length)}return{update:l,maxPoints:s}}function y(e,t){var a=new e.constructor(e.length+t.length);return a.set(e),a.set(t,e.length),a}function f(e,t,r,o){e=J.getGraphDiv(e);var i=m(e,t,r,o,function(e,t,a){var r,o;if(!J.isTypedArray(e))r=e.concat(t),o=0<=a&&a<r.length?r.splice(0,r.length-a):[];else if(0>a){var i=new e.constructor(0),n=y(e,t);0>a?(r=n,o=i):(r=i,o=n)}else if(r=new e.constructor(a),o=new e.constructor(e.length+t.length-a),a===t.length)r.set(t),o.set(e);else if(a<t.length){var l=t.length-a;r.set(t.subarray(l)),o.set(e),o.set(t.subarray(0,l),e.length)}else{var s=a-t.length,d=e.length-s;r.set(e.subarray(d)),r.set(t,s),o.set(e.subarray(0,d))}return[r,o]}),n=a.redraw(e),l=[e,i.update,r,i.maxPoints];return ee.add(e,a.prependTraces,l,f,arguments),n}function x(e,t,r,o){e=J.getGraphDiv(e);var i=m(e,t,r,o,function(e,t,a){var r,o;if(!J.isTypedArray(e))r=t.concat(e),o=0<=a&&a<r.length?r.splice(a,r.length):[];else if(0>=a){var i=new e.constructor(0),n=y(t,e);0>a?(r=n,o=i):(r=i,o=n)}else if(r=new e.constructor(a),o=new e.constructor(e.length+t.length-a),a===t.length)r.set(t),o.set(e);else if(a<t.length){var l=t.length-a;r.set(t.subarray(0,l)),o.set(t.subarray(l)),o.set(e,l)}else{var s=a-t.length;r.set(t),r.set(e.subarray(0,s),t.length),o.set(e.subarray(s))}return[r,o]}),n=a.redraw(e),l=[e,i.update,r,i.maxPoints];return ee.add(e,a.extendTraces,l,x,arguments),n}function _(e,t,r){e=J.getGraphDiv(e);var o=[],n=a.deleteTraces,l=_,s=[e,o],d=[e,t],c,g;for(u(e,t,r),Array.isArray(t)||(t=[t]),t=t.map(function(e){return J.extendFlat({},e)}),he.cleanData(t),c=0;c<t.length;c++)e.data.push(t[c]);for(c=0;c<t.length;c++)o.push(-t.length+c);if("undefined"==typeof r)return g=a.redraw(e),ee.add(e,n,s,l,d),g;Array.isArray(r)||(r=[r]);try{p(e,o,r)}catch(a){throw e.data.splice(e.data.length-t.length,t.length),a}return ee.startSequence(e),ee.add(e,n,s,l,d),g=a.moveTraces(e,o,r),ee.stopSequence(e),g}function b(e,t){e=J.getGraphDiv(e);var r=[],o=a.addTraces,n=[e,r,t],l=[e,t],s,p;if("undefined"==typeof t)throw new Error("indices must be an integer or array of integers.");else Array.isArray(t)||(t=[t]);for(c(e,t,"indices"),t=d(t,e.data.length-1),t.sort(J.sorterDes),s=0;s<t.length;s+=1)p=e.data.splice(t[s],1)[0],r.push(p);var u=a.redraw(e);return ee.add(e,o,n,b,l),u}function v(e,t,r){e=J.getGraphDiv(e);var o=[],n=[],l=[e,r,t],s=[e,t,r],c;if(p(e,t,r),t=Array.isArray(t)?t:[t],"undefined"==typeof r)for(r=[],c=0;c<t.length;c++)r.push(-t.length+c);for(r=Array.isArray(r)?r:[r],t=d(t,e.data.length-1),r=d(r,e.data.length-1),c=0;c<e.data.length;c++)-1===t.indexOf(c)&&o.push(e.data[c]);for(c=0;c<t.length;c++)n.push({newIndex:r[c],trace:e.data[t[c]]});for(n.sort(function(e,t){return e.newIndex-t.newIndex}),c=0;c<n.length;c+=1)o.splice(n[c].newIndex,0,n[c].trace);e.data=o;var u=a.redraw(e);return ee.add(e,v,l,v,s),u}function k(e,t,o,i){e=J.getGraphDiv(e),he.clearPromiseQueue(e);var n={};if("string"==typeof t)n[t]=o;else if(J.isPlainObject(t))n=J.extendFlat({},t),void 0===i&&(i=o);else return J.warn("Restyle fail.",t,o,i),Promise.reject();Object.keys(n).length&&(e.changed=!0);var l=he.coerceTraceIndices(e,i),s=S(e,n,l),d=s.flags;d.calc&&(e.calcdata=void 0),d.clearAxisTypes&&he.clearAxisTypes(e,l,{});var c=[];d.fullReplot?c.push(a.plot):(c.push(re.previousPromises),re.supplyDefaults(e),d.markerSize&&(re.doCalcdata(e),z(c)),d.style&&c.push(me.doTraceStyle),d.colorbars&&c.push(me.doColorBars),c.push(r)),c.push(re.rehover,re.redrag),ee.add(e,k,[e,s.undoit,s.traces],k,[e,s.redoit,s.traces]);var p=J.syncOrAsync(c,e);return p&&p.then||(p=Promise.resolve()),p.then(function(){return e.emit("plotly_restyle",s.eventData),e})}function w(e){return void 0===e?null:e}function T(e,t){return t?function(t,a,r){var o=Q(t,a),i=o.set;return o.set=function(t){A((r||"")+a,o.get(),t,e),i(t)},o}:Q}function A(e,t,a,r){if(Array.isArray(t)||Array.isArray(a))for(var o=Array.isArray(t)?t:[],n=Array.isArray(a)?a:[],l=va(o.length,n.length),s=0;s<l;s++)A(e+"["+s+"]",o[s],n[s],r);else if(J.isPlainObject(t)||J.isPlainObject(a)){var d=J.isPlainObject(t)?t:{},c=J.isPlainObject(a)?a:{},p=J.extendFlat({},d,c);for(var u in p)A(e+"."+u,d[u],c[u],r)}else void 0===r[e]&&(r[e]=w(t))}function S(e,t,a){function r(){return a.map(function(){})}function o(e){var t=ie.id2name(e);-1===k.indexOf(t)&&k.push(t)}function n(e){return"LAYOUT"+e+".autorange"}function l(e){return"LAYOUT"+e+".range"}function s(e){for(var t=e;t<g.length;t++)if(g[t]._input===h[e])return g[t]}function d(o,n,l){if(Array.isArray(o))return void o.forEach(function(e){d(e,n,l)});if(!(o in t||he.hasParent(t,o))){var i;if("LAYOUT"===o.substr(0,6))i=y(e.layout,o.replace("LAYOUT",""));else{var c=a[l],p=u._tracePreGUI[s(c)._fullInput.uid];i=T(p,m)(h[c],o)}o in v||(v[o]=r()),void 0===v[o][l]&&(v[o][l]=w(i.get())),void 0!==n&&i.set(n)}}function c(e){return function(t){return g[t][e]}}function p(e){return function(t,r){return!1===t?g[a[r]][e]:null}}var u=e._fullLayout,g=e._fullData,h=e.data,m=u._guiEditing,y=T(u._preGUI,m),f=J.extendDeepAll({},t),x;C(t);var _=ye.traceFlags(),b={},v={},k;for(var A in t){if(he.hasParent(t,A))throw new Error("cannot set "+A+" and a parent attribute simultaneously");var S=t[A],L,E,I,z,P,D;if(("autobinx"==A||"autobiny"==A)&&(A=A.charAt(A.length-1)+"bins",S=Array.isArray(S)?S.map(p(A)):!1===S?a.map(c(A)):null),b[A]=S,"LAYOUT"===A.substr(0,6)){I=y(e.layout,A.replace("LAYOUT","")),v[A]=[w(I.get())],I.set(Array.isArray(S)?S[0]:S),_.calc=!0;continue}for(v[A]=r(),x=0;x<a.length;x++){L=h[a[x]],E=s(a[x]);var O=u._tracePreGUI[E._fullInput.uid];if(I=T(O,m)(L,A),z=I.get(),P=Array.isArray(S)?S[x%S.length]:S,void 0!==P){var R=I.parts[I.parts.length-1],M=A.substr(0,A.length-R.length-1),j=M?M+".":"",F=M?Q(E,M).get():E;if(D=ae.getTraceValObject(E,I.parts),D&&D.impliedEdits&&null!==P)for(var B in D.impliedEdits)d(J.relativeAttr(A,B),D.impliedEdits[B],x);else if(("thicknessmode"===R||"lenmode"===R)&&z!==P&&("fraction"===P||"pixels"===P)&&F){var N=u._size,V=F.orient,U="top"===V||"bottom"===V;if("thicknessmode"===R){var H=U?N.h:N.w;d(j+"thickness",F.thickness*("fraction"===P?1/H:H),x)}else{var G=U?N.w:N.h;d(j+"len",F.len*("fraction"===P?1/G:G),x)}}else if("type"==A&&("pie"===P!=("pie"===z)||"funnelarea"===P!=("funnelarea"===z))){var q="x",Y="y";("bar"===P||"bar"===z)&&"h"===L.orientation&&(q="y",Y="x"),J.swapAttrs(L,["?","?src"],"labels",q),J.swapAttrs(L,["d?","?0"],"label",q),J.swapAttrs(L,["?","?src"],"values",Y),"pie"===z||"funnelarea"===z?(Q(L,"marker.color").set(Q(L,"marker.colors").get()),u._pielayer.selectAll("g.trace").remove()):te.traceIs(L,"cartesian")&&Q(L,"marker.colors").set(Q(L,"marker.color").get())}v[A][x]=w(z);if(-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(A)){if("orientation"==A){I.set(P);var W=L.x&&!L.y?"h":"v";if((I.get()||W)===E.orientation)continue}else"orientationaxes"==A&&(L.orientation={v:"h",h:"v"}[E.orientation]);he.swapXYData(L),_.calc=_.clearAxisTypes=!0}else-1===re.dataArrayContainers.indexOf(I.parts[0])?(D?D.arrayOk&&!te.traceIs(E,"regl")&&(J.isArrayOrTypedArray(P)||J.isArrayOrTypedArray(z))?_.calc=!0:ye.update(_,D):_.calc=!0,I.set(P)):(he.manageArrayContainers(I,P,v),_.calc=!0)}}if(-1!==["swapxyaxes","orientationaxes"].indexOf(A)&&ie.swap(e,a),"orientationaxes"==A){var X=Q(e.layout,"hovermode");"x"===X.get()?X.set("y"):"y"===X.get()&&X.set("x")}if(-1!==["orientation","type"].indexOf(A)){for(k=[],x=0;x<a.length;x++){var Z=h[a[x]];te.traceIs(Z,"cartesian")&&(o(Z.xaxis||"x"),o(Z.yaxis||"y"))}d(k.map(n),!0,0),d(k.map(l),[0,1],0)}}return(_.calc||_.plot)&&(_.fullReplot=!0),{flags:_,undoit:v,redoit:b,traces:a,eventData:J.extendDeepNoArrays([],[f,a])}}function C(e){function t(t,a){e[a]=e[t],delete e[t]}var a=J.counterRegex("axis",".title",!1,!1),r=/colorbar\.title$/,o=Object.keys(e),n,l,s;for(n=0;n<o.length;n++)l=o[n],s=e[l],("title"===l||a.test(l)||r.test(l))&&("string"==typeof s||"number"==typeof s)?t(l,l.replace("title","title.text")):-1<l.indexOf("titlefont")?t(l,l.replace("titlefont","title.font")):-1<l.indexOf("titleposition")?t(l,l.replace("titleposition","title.position")):-1<l.indexOf("titleside")?t(l,l.replace("titleside","title.side")):-1<l.indexOf("titleoffset")&&t(l,l.replace("titleoffset","title.offset"))}function L(e,t,a){if(e=J.getGraphDiv(e),he.clearPromiseQueue(e),e.framework&&e.framework.isPolar)return Promise.resolve(e);var o={};if("string"==typeof t)o[t]=a;else if(J.isPlainObject(t))o=J.extendFlat({},t);else return J.warn("Relayout fail.",t,a),Promise.reject();Object.keys(o).length&&(e.changed=!0);var i=D(e,o),n=i.flags;n.calc&&(e.calcdata=void 0);var l=[re.previousPromises];n.layoutReplot?l.push(me.layoutReplot):Object.keys(o).length&&(E(e,n,i)||re.supplyDefaults(e),n.legend&&l.push(me.doLegend),n.layoutstyle&&l.push(me.layoutStyles),n.axrange&&z(l,i.rangesAltered),n.ticks&&l.push(me.doTicksRelayout),n.modebar&&l.push(me.doModeBar),n.camera&&l.push(me.doCamera),n.colorbars&&l.push(me.doColorBars),l.push(r)),l.push(re.rehover,re.redrag),ee.add(e,L,[e,i.undoit],L,[e,i.redoit]);var s=J.syncOrAsync(l,e);return s&&s.then||(s=Promise.resolve(e)),s.then(function(){return e.emit("plotly_relayout",i.eventData),e})}function E(e,t,a){var r=e._fullLayout;if(!t.axrange)return!1;for(var o in t)if("axrange"!=o&&t[o])return!1;for(var i in a.rangesAltered){var n=ie.id2name(i),l=e.layout[n],s=r[n];if(s.autorange=l.autorange,s.range=l.range.slice(),s.cleanRange(),s._matchGroup)for(var d in s._matchGroup)if(d!=i){var c=r[ie.id2name(d)];c.autorange=s.autorange,c.range=s.range.slice(),c._input.range=s.range.slice()}}return!0}function z(e,t){var a=t?function(e){var a=[],r=!0;for(var o in t){var i=ie.getFromId(e,o);if(a.push(o),i._matchGroup)for(var n in i._matchGroup)t[n]||a.push(n);i.automargin&&(r=!1)}return ie.draw(e,a,{skipTitle:r})}:function(e){return ie.draw(e,"redraw")};e.push(pe,me.doAutoRangeAndConstraints,a,me.drawData,me.finalDraw)}function D(e,t){function r(e,o){if(Array.isArray(e))return void e.forEach(function(e){r(e,o)});if(!(e in t||he.hasParent(t,e))){var i=d(n,e);e in k||(k[e]=w(i.get())),void 0!==o&&i.set(o)}}function o(e){var t=ie.name2id(e.split(".")[0]);return A[t]=1,t}var n=e.layout,l=e._fullLayout,s=l._guiEditing,d=T(l._preGUI,s),c=Object.keys(t),u=ie.list(e),g=J.extendDeepAll({},t),h={},m,y,a;for(C(t),c=Object.keys(t),y=0;y<c.length;y++)if(0===c[y].indexOf("allaxes")){for(a=0;a<u.length;a++){var f=u[a]._id.substr(1),x=-1===f.indexOf("scene")?"":f+".",_=c[y].replace("allaxes",x+u[a]._name);t[_]||(t[_]=t[c[y]])}delete t[c[y]]}var b=ye.layoutFlags(),v={},k={},A={},S;for(var L in t){if(he.hasParent(t,L))throw new Error("cannot set "+L+" and a parent attribute simultaneously");for(var E=d(n,L),p=t[L],z=E.parts.length,D=z-1;0<D&&"string"!=typeof E.parts[D];)D--;var R=E.parts[D],M=E.parts[D-1]+"."+R,F=E.parts.slice(0,D).join("."),B=Q(e.layout,F).get(),N=Q(l,F).get(),V=E.get();if(void 0!==p){v[L]=p,k[L]="reverse"===R?p:w(V);var U=ae.getLayoutValObject(l,E.parts);if(U&&U.impliedEdits&&null!==p)for(var H in U.impliedEdits)r(J.relativeAttr(L,H),U.impliedEdits[H]);if(-1!==["width","height"].indexOf(L)){if(p){r("autosize",null);var G="height"==L?"width":"height";r(G,l[G])}else l[L]=e._initialAutoSize[L];}else if("autosize"==L)r("width",p?null:l.width),r("height",p?null:l.height);else if(M.match(_e))o(M),Q(l,F+"._inputRange").set(null);else if(M.match(be)){o(M),Q(l,F+"._inputRange").set(null);var q=Q(l,F).get();q._inputDomain&&(q._input.domain=q._inputDomain.slice())}else M.match(ve)&&Q(l,F+"._inputDomain").set(null);if("type"===R){var Y=B,W="linear"===N.type&&"log"===p,X="log"===N.type&&"linear"===p;if(W||X){if(!Y||!Y.range)r(F+".autorange",!0);else if(!N.autorange){var Z=Y.range[0],K=Y.range[1];W?(0>=Z&&0>=K&&r(F+".autorange",!0),0>=Z?Z=K/1e6:0>=K&&(K=Z/1e6),r(F+".range[0]",P(Z)/I),r(F+".range[1]",P(K)/I)):(r(F+".range[0]",ya(10,Z)),r(F+".range[1]",ya(10,K)))}else W&&(Y.range=Y.range[1]>Y.range[0]?[1,2]:[2,1]);Array.isArray(l._subplots.polar)&&l._subplots.polar.length&&l[E.parts[0]]&&"radialaxis"===E.parts[1]&&delete l[E.parts[0]]._subplot.viewInitial["radialaxis.range"],te.getComponentMethod("annotations","convertCoords")(e,N,p,r),te.getComponentMethod("images","convertCoords")(e,N,p,r)}else r(F+".autorange",!0),r(F+".range",null);Q(l,F+"._inputRange").set(null)}else if(R.match(fe)){var $=Q(l,L).get(),ee=(p||{}).type;ee&&"-"!==ee||(ee="linear"),te.getComponentMethod("annotations","convertCoords")(e,$,ee,r),te.getComponentMethod("images","convertCoords")(e,$,ee,r)}var re=ge.containerArrayMatch(L);if(re){m=re.array,y=re.index;var oe=re.property;""!==y&&""===oe&&(ge.isAddVal(p)?k[L]=null:ge.isRemoveVal(p)?k[L]=(Q(n,m).get()||[])[y]:J.warn("unrecognized full object value",t)),ye.update(b,U||{editType:"calc"}),h[m]||(h[m]={});var ne=h[m][y];ne||(ne=h[m][y]={}),ne[oe]=p,delete t[L]}else"reverse"===R?(B.range?B.range.reverse():(r(F+".autorange",!0),B.range=[1,0]),N.autorange?b.calc=!0:b.plot=!0):(l._has("scatter-like")&&l._has("regl")&&"dragmode"==L&&("lasso"===p||"select"===p)&&"lasso"!==V&&"select"!==V?b.plot=!0:l._has("gl2d")?b.plot=!0:U?ye.update(b,U):b.calc=!0,E.set(p))}}for(m in h){var le=ge.applyContainerArrayChanges(e,d(n,m),h[m],b,d);le||(b.plot=!0)}var se=l._axisConstraintGroups||[];for(S in A)for(y=0;y<se.length;y++){var de=se[y];if(de[S])for(var ce in b.calc=!0,de)A[ce]||(ie.getFromId(e,ce)._constraintShrinkable=!0)}return(O(e)||t.height||t.width)&&(b.plot=!0),(b.plot||b.calc)&&(b.layoutReplot=!0),{flags:b,rangesAltered:A,undoit:k,redoit:v,eventData:g}}function O(e){var t=e._fullLayout,a=t.width,r=t.height;return e.layout.autosize&&re.plotAutoSize(e,e.layout,t),t.width!==a||t.height!==r}function R(e,t,o,i){if(e=J.getGraphDiv(e),he.clearPromiseQueue(e),e.framework&&e.framework.isPolar)return Promise.resolve(e);J.isPlainObject(t)||(t={}),J.isPlainObject(o)||(o={}),Object.keys(t).length&&(e.changed=!0),Object.keys(o).length&&(e.changed=!0);var n=he.coerceTraceIndices(e,i),l=S(e,J.extendFlat({},t),n),s=l.flags,d=D(e,J.extendFlat({},o)),c=d.flags;(s.calc||c.calc)&&(e.calcdata=void 0),s.clearAxisTypes&&he.clearAxisTypes(e,n,o);var p=[];c.layoutReplot?p.push(me.layoutReplot):s.fullReplot?p.push(a.plot):(p.push(re.previousPromises),E(e,c,d)||re.supplyDefaults(e),s.style&&p.push(me.doTraceStyle),(s.colorbars||c.colorbars)&&p.push(me.doColorBars),c.legend&&p.push(me.doLegend),c.layoutstyle&&p.push(me.layoutStyles),c.axrange&&z(p,d.rangesAltered),c.ticks&&p.push(me.doTicksRelayout),c.modebar&&p.push(me.doModeBar),c.camera&&p.push(me.doCamera),p.push(r)),p.push(re.rehover,re.redrag),ee.add(e,R,[e,l.undoit,d.undoit,l.traces],R,[e,l.redoit,d.redoit,l.traces]);var u=J.syncOrAsync(p,e);return u&&u.then||(u=Promise.resolve(e)),u.then(function(){return e.emit("plotly_update",{data:l.eventData,layout:d.eventData}),e})}function M(e){return function(t){t._fullLayout._guiEditing=!0;var a=e.apply(null,arguments);return t._fullLayout._guiEditing=!1,a}}function j(e,t){for(var a=0;a<t.length;a++){var r=t[a],o=e.match(r.pattern);if(o)return{head:o[1],attr:r.attr}}}function F(e,t){var a=Q(t,e).get();if(a!==void 0)return a;var r=e.split(".");for(r.pop();1<r.length;)if(r.pop(),a=Q(t,r.join(".")+".uirevision").get(),void 0!==a)return a;return t.uirevision}function B(e,t){for(var a=0;a<t.length;a++)if(t[a]._fullInput.uid===e)return a;return-1}function N(e,t,a){for(var r=0;r<t.length;r++)if(t[r].uid===e)return r;return!t[a]||t[a].uid?-1:a}function V(e,t){var a=J.isPlainObject(e),r=Array.isArray(e);return a||r?(a&&J.isPlainObject(t)||r&&Array.isArray(t))&&JSON.stringify(e)===JSON.stringify(t):e===t}function U(e,t,a,r){var o=r._preGUI,n=[],l={},s,d,c,p,u,g,h,m;for(s in o){if(u=j(s,ke),!u)J.warn("unrecognized GUI edit: "+s);else if(d=u.attr||u.head+".uirevision",c=Q(r,d).get(),p=c&&F(d,t),p&&p===c&&(g=o[s],null===g&&(g=void 0),h=Q(t,s),m=h.get(),V(m,g))){void 0===m&&"autorange"===s.substr(s.length-9)&&n.push(s.substr(0,s.length-10)),h.set(w(Q(r,s).get()));continue}delete o[s],"range["===s.substr(s.length-8,6)&&(l[s.substr(0,s.length-9)]=1)}for(var y=0,f;y<n.length;y++)if(f=n[y],l[f]){var x=Q(t,f).get();x&&delete x.autorange}var _=r._tracePreGUI;for(var b in _){var v=_[b],k=null,T;for(s in v){if(!k){var A=B(b,a);if(0>A){delete _[b];break}var S=a[A];T=S._fullInput;var C=N(b,e,T.index);if(0>C){delete _[b];break}k=e[C]}if(u=j(s,we),!u)J.warn("unrecognized GUI edit: "+s+" in trace uid "+b);else if(u.attr?(c=Q(r,u.attr).get(),p=c&&F(u.attr,t)):(c=T.uirevision,p=k.uirevision,void 0===p&&(p=t.uirevision)),p&&p===c&&(g=v[s],null===g&&(g=void 0),h=Q(k,s),m=h.get(),V(m,g))){h.set(w(Q(T,s).get()));continue}delete v[s]}}}function H(e,t,a,r,o,n){function l(e){var t=ae.getTraceValObject(g,e);return!g._module.animatable&&t.anim&&(t.anim=!1),t}var s=t.length===a.length;if(!o&&!s)return{fullReplot:!0,calc:!0};var d=ye.traceFlags();d.arrays={},d.nChanges=0,d.nChangesAnim=0;var c={getValObject:l,flags:d,immutable:r,transition:o,newDataRevision:n,gd:e},p={},u,g;for(u=0;u<t.length;u++)if(a[u]){if(g=a[u]._fullInput,re.hasMakesDataTransform(g)&&(g=a[u]),p[g.uid])continue;p[g.uid]=1,q(t[u]._fullInput,g,[],c)}return(d.calc||d.plot)&&(d.fullReplot=!0),o&&d.nChanges&&d.nChangesAnim&&(d.anim=d.nChanges===d.nChangesAnim&&s?"all":"some"),d}function G(e,t,a,r,o){var i=ye.layoutFlags();i.arrays={},i.rangesAltered={},i.nChanges=0,i.nChangesAnim=0;return q(t,a,[],{getValObject:function(e){return ae.getLayoutValObject(a,e)},flags:i,immutable:r,transition:o,gd:e}),(i.plot||i.calc)&&(i.layoutReplot=!0),o&&i.nChanges&&i.nChangesAnim&&(i.anim=i.nChanges===i.nChangesAnim?"all":"some"),i}function q(e,t,a,r){function o(){var e=u.editType;return c&&-1!==e.indexOf("arraydraw")?void J.pushUnique(s.arrays[c],p):void(ye.update(s,u),"none"!==e&&s.nChanges++,r.transition&&u.anim&&s.nChangesAnim++,(_e.test(h)||be.test(h))&&(s.rangesAltered[a[0]]=1),ve.test(h)&&Q(t,"_inputDomain").set(null),"datarevision"===g&&(s.newDataRevision=1))}function n(e){return"data_array"===e.valType||e.arrayOk}var l=r.getValObject,s=r.flags,d=r.immutable,c=r.inArray,p=r.arrayIndex,u,g,h;for(g in e){if(s.calc&&!r.transition)return;var m=e[g],y=t[g],f=a.concat(g);if(h=f.join("."),"_"!==g.charAt(0)&&"function"!=typeof m&&m!==y){if(("tick0"===g||"dtick"===g)&&"geo"!==a[0]){var x=t.tickmode;if("auto"===x||"array"===x||!x)continue}if(!("range"===g&&t.autorange)&&("zmin"!==g&&"zmax"!==g||"contourcarpet"!==t.type)&&(u=l(f),u&&!(u._compareAsJSON&&JSON.stringify(m)===JSON.stringify(y)))){var _=u.valType,b=n(u),v=Array.isArray(m),k=Array.isArray(y),w;if(v&&k){var T="_input_"+g,A=e[T],S=t[T];if(Array.isArray(A)&&A===S)continue}if(void 0===y)b&&v?s.calc=!0:o();else if(u._isLinkedToArray){var C=[],L=!1;c||(s.arrays[g]=C);var E=ea(m.length,y.length),I=va(m.length,y.length);if(E!==I)if("arraydraw"===u.editType)L=!0;else{o();continue}for(w=0;w<E;w++)q(m[w],y[w],f.concat(w),J.extendFlat({inArray:g,arrayIndex:w},r));if(L)for(w=E;w<I;w++)C.push(w)}else!_&&J.isPlainObject(m)?q(m,y,f,r):b?v&&k?(d&&(s.calc=!0),(d||r.newDataRevision)&&o()):v===k?o():s.calc=!0:v&&k?(m.length!==y.length||m+""!==y+"")&&o():o()}}}for(g in t)if(!(g in e||"_"===g.charAt(0)||"function"==typeof t[g])){if(u=l(a.concat(g)),n(u)&&Array.isArray(t[g]))return void(s.calc=!0);o()}}function Y(e,t){for(var a in e)if("_"!==a.charAt(0)){var r=e[a],o=t[a];if(r!==o)if(J.isPlainObject(r)&&J.isPlainObject(o)){if(Y(r,o))return!0;}else if(Array.isArray(r)&&Array.isArray(o)){if(r.length!==o.length)return!0;for(var n=0;n<r.length;n++)if(r[n]!==o[n]){if(!(J.isPlainObject(r[n])&&J.isPlainObject(o[n])))return!0;if(Y(r[n],o[n]))return!0}}else return!0}}function W(e,t,a){if(e=J.getGraphDiv(e),null===t||void 0===t)return Promise.resolve();if(!J.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plot.ly/javascript/animations/");var r=e._transitionData._frames,o=e._transitionData._frameHash,n,l,s,d;if(!Array.isArray(t))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+t);var c=r.length+2*t.length,p=[],u={};for(n=t.length-1;0<=n;n--)if(J.isPlainObject(t[n])){var g=t[n].name,h=(o[g]||u[g]||{}).name,m=t[n].name,y=o[h]||u[h];h&&m&&"number"==typeof m&&y&&5>xe&&(xe++,J.warn("addFrames: overwriting frame \""+(o[h]||u[h]).name+"\" with a frame whose name of type \"number\" also equates to \""+h+"\". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings."),5===xe&&J.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),u[g]={name:g},p.push({frame:re.supplyFrameDefaults(t[n]),index:a&&void 0!==a[n]&&null!==a[n]?a[n]:c+n})}p.sort(function(e,t){return e.index>t.index?-1:e.index<t.index?1:0});var f=[],x=[],_=r.length;for(n=p.length-1;0<=n;n--){if(l=p[n].frame,"number"==typeof l.name&&J.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!l.name)for(;o[l.name="frame "+e._transitionData._counter++];);if(o[l.name]){for(s=0;s<r.length&&(r[s]||{}).name!==l.name;s++);f.push({type:"replace",index:s,value:l}),x.unshift({type:"replace",index:s,value:r[s]})}else d=va(0,ea(p[n].index,_)),f.push({type:"insert",index:d,value:l}),x.unshift({type:"delete",index:d}),_++}var b=re.modifyFrames,v=re.modifyFrames,k=[e,x],w=[e,f];return ee&&ee.add(e,b,k,v,w),re.modifyFrames(e,f)}function X(e){var t=Z.select(e),a=e._fullLayout;if(a._container=t.selectAll(".plot-container").data([0]),a._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),a._paperdiv=a._container.selectAll(".svg-container").data([0]),a._paperdiv.enter().append("div").classed("svg-container",!0).style("position","relative"),a._glcontainer=a._paperdiv.selectAll(".gl-container").data([{}]),a._glcontainer.enter().append("div").classed("gl-container",!0),a._paperdiv.selectAll(".main-svg").remove(),a._paperdiv.select(".modebar-container").remove(),a._paper=a._paperdiv.insert("svg",":first-child").classed("main-svg",!0),a._toppaper=a._paperdiv.append("svg").classed("main-svg",!0),a._modebardiv=a._paperdiv.append("div"),a._hoverpaper=a._paperdiv.append("svg").classed("main-svg",!0),!a._uid){var r={};Z.selectAll("defs").each(function(){this.id&&(r[this.id.split("-")[1]]=1)}),a._uid=J.randstr(r)}a._paperdiv.selectAll(".main-svg").attr(de.svgAttrs),a._defs=a._paper.append("defs").attr("id","defs-"+a._uid),a._clips=a._defs.append("g").classed("clips",!0),a._topdefs=a._toppaper.append("defs").attr("id","topdefs-"+a._uid),a._topclips=a._topdefs.append("g").classed("clips",!0),a._bgLayer=a._paper.append("g").classed("bglayer",!0),a._draggers=a._paper.append("g").classed("draglayer",!0);var o=a._paper.append("g").classed("layer-below",!0);a._imageLowerLayer=o.append("g").classed("imagelayer",!0),a._shapeLowerLayer=o.append("g").classed("shapelayer",!0),a._cartesianlayer=a._paper.append("g").classed("cartesianlayer",!0),a._polarlayer=a._paper.append("g").classed("polarlayer",!0),a._ternarylayer=a._paper.append("g").classed("ternarylayer",!0),a._geolayer=a._paper.append("g").classed("geolayer",!0),a._funnelarealayer=a._paper.append("g").classed("funnelarealayer",!0),a._pielayer=a._paper.append("g").classed("pielayer",!0),a._sunburstlayer=a._paper.append("g").classed("sunburstlayer",!0),a._indicatorlayer=a._toppaper.append("g").classed("indicatorlayer",!0),a._glimages=a._paper.append("g").classed("glimages",!0);var i=a._toppaper.append("g").classed("layer-above",!0);a._imageUpperLayer=i.append("g").classed("imagelayer",!0),a._shapeUpperLayer=i.append("g").classed("shapelayer",!0),a._infolayer=a._toppaper.append("g").classed("infolayer",!0),a._menulayer=a._toppaper.append("g").classed("menulayer",!0),a._zoomlayer=a._toppaper.append("g").classed("zoomlayer",!0),a._hoverlayer=a._hoverpaper.append("g").classed("hoverlayer",!0),a._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),e.emit("plotly_framework")}var Z=e("d3"),i=e("fast-isnumeric"),K=e("has-hover"),J=e("../lib"),Q=J.nestedProperty,$=e("../lib/events"),ee=e("../lib/queue"),te=e("../registry"),ae=e("./plot_schema"),re=e("../plots/plots"),oe=e("../plots/polar/legacy"),ie=e("../plots/cartesian/axes"),ne=e("../components/drawing"),le=e("../components/color"),se=e("../plots/cartesian/graph_interact").initInteractions,de=e("../constants/xmlns_namespaces"),ce=e("../lib/svg_text_utils"),pe=e("../plots/cartesian/select").clearSelect,ue=e("./plot_config").dfltConfig,ge=e("./manage_arrays"),he=e("./helpers"),me=e("./subroutines"),ye=e("./edit_types"),fe=e("../plots/cartesian/constants").AX_NAME_PATTERN,xe=0,_e=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,be=/^[xyz]axis[0-9]*\.autorange$/,ve=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/,ke=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],we=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];a.animate=function(e,t,a){function r(e){return Array.isArray(s)?e>=s.length?s[0]:s[e]:s}function o(e){return Array.isArray(d)?e>=d.length?d[0]:d[e]:d}function n(e,t){var a=0;return function(){if(e&&++a===t)return e()}}if(e=J.getGraphDiv(e),!J.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed to create a plot before animating it. For more details, see https://plot.ly/javascript/animations/");var l=e._transitionData;l._frameQueue||(l._frameQueue=[]),a=re.supplyAnimationDefaults(a);var s=a.transition,d=a.frame;return void 0===l._frameWaitingCnt&&(l._frameWaitingCnt=0),new Promise(function(d,c){function p(){if(0!==l._frameQueue.length){for(;l._frameQueue.length;){var t=l._frameQueue.pop();t.onInterrupt&&t.onInterrupt()}e.emit("plotly_animationinterrupted",[])}}function u(t){if(0!==t.length){for(var s=0;s<t.length;s++){var p="byname"===t[s].type?re.computeFrame(e,t[s].name):t[s].data;var u=o(s),g=r(s);g.duration=ea(g.duration,u.duration);var h={frame:p,name:t[s].name,frameOpts:u,transitionOpts:g};s==t.length-1&&(h.onComplete=n(d,2),h.onInterrupt=c),l._frameQueue.push(h)}"immediate"===a.mode&&(l._lastFrameAt=-Infinity),l._animationRaf||m()}}function g(){e.emit("plotly_animated"),window.cancelAnimationFrame(l._animationRaf),l._animationRaf=null}function h(){l._currentFrame&&l._currentFrame.onComplete&&l._currentFrame.onComplete();var t=l._currentFrame=l._frameQueue.shift();if(t){var a=t.name?t.name.toString():null;e._fullLayout._currentFrame=a,l._lastFrameAt=Date.now(),l._timeToNext=t.frameOpts.duration,re.transition(e,t.frame.data,t.frame.layout,he.coerceTraceIndices(e,t.frame.traces),t.frameOpts,t.transitionOpts).then(function(){t.onComplete&&t.onComplete()}),e.emit("plotly_animatingframe",{name:a,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}})}else g()}function m(){e.emit("plotly_animating"),l._lastFrameAt=-Infinity,l._timeToNext=0,l._runningTransitions=0,l._currentFrame=null;var t=function(){l._animationRaf=window.requestAnimationFrame(t),Date.now()-l._lastFrameAt>l._timeToNext&&h()};t()}function y(e){return e.transitionOpts=Array.isArray(s)?f>=s.length?s[f]:s[0]:s,f++,e}var f=0,x=[],_=void 0===t||null===t,b=Array.isArray(t),v=!_&&!b&&J.isPlainObject(t),k,w;if(v)x.push({type:"object",data:y(J.extendFlat({},t))});else if(_||-1!==["string","number"].indexOf(typeof t))for(k=0;k<l._frames.length;k++)w=l._frames[k],w&&(_||w.group+""===t+"")&&x.push({type:"byname",name:w.name+"",data:y({name:w.name})});else if(b)for(k=0;k<t.length;k++){var T=t[k];-1===["number","string"].indexOf(typeof T)?J.isPlainObject(T)&&x.push({type:"object",data:y(J.extendFlat({},T))}):(T+="",x.push({type:"byname",name:T,data:y({name:T})}))}for(k=0;k<x.length;k++)if(w=x[k],"byname"===w.type&&!l._frameHash[w.data.name])return J.warn("animate failure: frame not found: \""+w.data.name+"\""),void c();-1!==["next","immediate"].indexOf(a.mode)&&p(),"reverse"===a.direction&&x.reverse();var A=e._fullLayout._currentFrame;if(A&&a.fromcurrent){var S=-1;for(k=0;k<x.length;k++)if(w=x[k],"byname"===w.type&&w.name===A){S=k;break}if(0<S&&S<x.length-1){var C=[];for(k=0;k<x.length;k++)w=x[k],("byname"!==x[k].type||k>S)&&C.push(w);x=C}}0<x.length?u(x):(e.emit("plotly_animated"),d())})},a.addFrames=W,a.deleteFrames=function(e,t){if(e=J.getGraphDiv(e),!J.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e);var a=e._transitionData._frames,r=[],o=[],n,l;if(!t)for(t=[],n=0;n<a.length;n++)t.push(n);for(t=t.slice(),t.sort(),n=t.length-1;0<=n;n--)l=t[n],r.push({type:"delete",index:l}),o.unshift({type:"insert",index:l,value:a[l]});var s=re.modifyFrames,d=re.modifyFrames,c=[e,o],p=[e,r];return ee&&ee.add(e,s,c,d,p),re.modifyFrames(e,r)},a.addTraces=_,a.deleteTraces=b,a.extendTraces=f,a.moveTraces=v,a.prependTraces=x,a.newPlot=function(e,t,r,o){return e=J.getGraphDiv(e),re.cleanPlot([],{},e._fullData||[],e._fullLayout||{}),re.purge(e),a.plot(e,t,r,o)},a.plot=function(e,t,o,n){function d(){if(y)return a.addFrames(e,y)}function c(){for(var t=b._basePlotModules,a=0;a<t.length;a++)t[a].drawFramework&&t[a].drawFramework(e);if(!b._glcanvas&&b._has("gl")&&(b._glcanvas=b._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(e){return e.key}),b._glcanvas.enter().append("canvas").attr("class",function(e){return"gl-canvas gl-canvas-"+e.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"})),b._glcanvas){b._glcanvas.attr("width",b.width).attr("height",b.height);var r=b._glcanvas.data()[0].regl;if(r&&(ba(b.width)!==r._gl.drawingBufferWidth||ba(b.height)!==r._gl.drawingBufferHeight)){if(A)J.error("WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.");else return J.log("WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug. Clearing graph and plotting again."),re.cleanPlot([],{},e._fullData,b),re.supplyDefaults(e),b=e._fullLayout,re.doCalcdata(e),A++,c()}}return"h"===b.modebar.orientation?b._modebardiv.style("height",null).style("width","100%"):b._modebardiv.style("width",null).style("height",b.height+"px"),re.previousPromises(e)}function p(){return re.clearAutoMarginIds(e),me.drawMarginPushers(e),ie.allowAutoMargin(e),re.doAutoMargin(e),re.previousPromises(e)}function u(){return re.didMarginChange(T,b._size)?J.syncOrAsync([p,me.layoutStyles],e):void 0}function g(){return k?J.syncOrAsync([te.getComponentMethod("shapes","calcAutorange"),te.getComponentMethod("annotations","calcAutorange"),h],e):void h()}function h(){e._transitioning||(me.doAutoRangeAndConstraints(e),_&&ie.saveRangeInitial(e),te.getComponentMethod("rangeslider","calcAutorange")(e))}function m(){return ie.draw(e,_?"":"redraw")}var y;if(e=J.getGraphDiv(e),$.init(e),J.isPlainObject(t)){var f=t;t=f.data,o=f.layout,n=f.config,y=f.frames}var x=$.triggerHandler(e,"plotly_beforeplot",[t,o,n]);if(!1===x)return Promise.reject();t||o||J.isPlotDiv(e)||J.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",e),l(e,n),o||(o={}),Z.select(e).classed("js-plotly-plot",!0),ne.makeTester(),Array.isArray(e._promises)||(e._promises=[]);var _=0===(e.data||[]).length&&Array.isArray(t);Array.isArray(t)&&(he.cleanData(t),_?e.data=t:e.data.push.apply(e.data,t),e.empty=!1),(!e.layout||_)&&(e.layout=he.cleanLayout(o)),re.supplyDefaults(e);var b=e._fullLayout,v=b._has("cartesian");if(!b._has("polar")&&t&&t[0]&&t[0].r)return J.log("Legacy polar charts are deprecated!"),s(e,t,o);b._replotting=!0,_&&X(e),e.framework!==X&&(e.framework=X,X(e)),ne.initGradients(e),_&&ie.saveShowSpikeInitial(e);var k=!e.calcdata||e.calcdata.length!==(e._fullData||[]).length;k&&re.doCalcdata(e);for(var w=0;w<e.calcdata.length;w++)e.calcdata[w][0].trace=e._fullData[w];e._context.responsive?!e._responsiveChartHandler&&(e._responsiveChartHandler=function(){J.isHidden(e)||re.resize(e)},window.addEventListener("resize",e._responsiveChartHandler)):J.clearResponsive(e);var T=J.extendFlat({},b._size),A=0,S=[re.previousPromises,d,c,p,u];v&&S.push(g),S.push(me.layoutStyles),v&&S.push(m),S.push(me.drawData,me.finalDraw,se,re.addLinks,re.rehover,re.redrag,re.doAutoMargin,re.previousPromises);var C=J.syncOrAsync(S,e);return C&&C.then||(C=Promise.resolve()),C.then(function(){return r(e),e})},a.purge=function(e){e=J.getGraphDiv(e);var t=e._fullLayout||{},a=e._fullData||[];return re.cleanPlot([],{},a,t),re.purge(e),$.purge(e),t._container&&t._container.remove(),delete e._context,e},a.react=function(e,t,o,n){function s(){return a.addFrames(e,d)}var d,c;e=J.getGraphDiv(e);var p=e._fullData,u=e._fullLayout;if(!J.isPlotDiv(e)||!p||!u)c=a.newPlot(e,t,o,n);else{if(J.isPlainObject(t)){var g=t;t=g.data,o=g.layout,n=g.config,d=g.frames}var h=!1;if(n){var m=J.extendDeep({},e._context);e._context=void 0,l(e,n),h=Y(m,e._context)}e.data=t||[],he.cleanData(e.data),e.layout=o||{},he.cleanLayout(e.layout),U(e.data,e.layout,p,u),re.supplyDefaults(e,{skipUpdateCalc:!0});var y=e._fullData,f=e._fullLayout,x=void 0===f.datarevision,_=f.transition,b=G(e,u,f,x,_),v=b.newDataRevision,k=H(e,p,y,x,_,v);O(e)&&(b.layoutReplot=!0),k.calc||b.calc?e.calcdata=void 0:re.supplyDefaultsUpdateCalc(e.calcdata,y);var w=[];if(d&&(e._transitionData={},re.createTransitionData(e),w.push(s)),f.transition&&!h&&(k.anim||b.anim))re.doCalcdata(e),me.doAutoRangeAndConstraints(e),w.push(function(){return re.transitionFromReact(e,k,b,u)});else if(k.fullReplot||b.layoutReplot||h)e._fullLayout._skipDefaults=!0,w.push(a.plot);else{for(var T in b.arrays){var A=b.arrays[T];if(A.length){var S=te.getComponentMethod(T,"drawOne");if(S!==J.noop)for(var C=0;C<A.length;C++)S(e,A[C]);else{var L=te.getComponentMethod(T,"draw");if(L===J.noop)throw new Error("cannot draw components: "+T);L(e)}}}w.push(re.previousPromises),k.style&&w.push(me.doTraceStyle),(k.colorbars||b.colorbars)&&w.push(me.doColorBars),b.legend&&w.push(me.doLegend),b.layoutstyle&&w.push(me.layoutStyles),b.axrange&&z(w),b.ticks&&w.push(me.doTicksRelayout),b.modebar&&w.push(me.doModeBar),b.camera&&w.push(me.doCamera),w.push(r)}w.push(re.rehover,re.redrag),c=J.syncOrAsync(w,e),c&&c.then||(c=Promise.resolve(e))}return c.then(function(){return e.emit("plotly_react",{data:t,layout:o}),e})},a.redraw=function(e){if(e=J.getGraphDiv(e),!J.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e);return he.cleanData(e.data),he.cleanLayout(e.layout),e.calcdata=void 0,a.plot(e).then(function(){return e.emit("plotly_redraw"),e})},a.relayout=L,a.restyle=k,a.setPlotConfig=function(e){return J.extendFlat(ue,e)},a.update=R,a._guiRelayout=M(L),a._guiRestyle=M(k),a._guiUpdate=M(R),a._storeDirectGUIEdit=function(e,t,a){for(var r in a){var o=Q(e,r);A(r,o.get(),a[r],t)}}},{"../components/color":593,"../components/drawing":614,"../constants/xmlns_namespaces":696,"../lib":719,"../lib/events":709,"../lib/queue":734,"../lib/svg_text_utils":743,"../plots/cartesian/axes":767,"../plots/cartesian/constants":773,"../plots/cartesian/graph_interact":776,"../plots/cartesian/select":784,"../plots/plots":828,"../plots/polar/legacy":836,"../registry":847,"./edit_types":750,"./helpers":751,"./manage_arrays":753,"./plot_config":755,"./plot_schema":756,"./subroutines":758,d3:163,"fast-isnumeric":225,"has-hover":410}],755:[function(e,t){"use strict";function a(e,t){for(var r in e){var o=e[r];o.valType?t[r]=o.dflt:(!t[r]&&(t[r]={}),a(o,t[r]))}}var r={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:"https://plot.ly"},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"boolean",dflt:1},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},o={};a(r,o),t.exports={configAttributes:r,dfltConfig:o}},{}],756:[function(e,t,a){"use strict";function r(e,t){var a=e._basePlotModules,r,o,n,l;if(a){var s;for(r=0;r<a.length;r++){if(n=a[r],n.attrRegex&&n.attrRegex.test(t)){if(n.layoutAttrOverrides)return n.layoutAttrOverrides;!s&&n.layoutAttributes&&(s=n.layoutAttributes)}var d=n.baseLayoutAttrOverrides;if(d&&t in d)return d[t]}if(s)return s}var c=e._modules;if(c)for(r=0;r<c.length;r++)if(l=c[r].layoutAttributes,l&&t in l)return l[t];for(o in x.componentsRegistry){if(n=x.componentsRegistry[o],"colorscale"===n.name&&0===t.indexOf("coloraxis"))return n.layoutAttributes[t];if(!n.schema&&t===n.name)return n.layoutAttributes}return t in v?v[t]:"radialaxis"===t||"angularaxis"===t?S[t]:S.layout[t]||!1}function o(e,t,a){if(!e)return!1;if(e._isLinkedToArray)if(n(t[a]))a++;else if(a<t.length)return!1;for(;a<t.length;a++){var r=e[t[a]];if(I(r))e=r;else break;if(a===t.length-1)break;if(e._isLinkedToArray){if(a++,!n(t[a]))return!1;}else if("info_array"===e.valType){a++;var o=t[a];if(!n(o))return!1;var l=e.items;if(Array.isArray(l)){if(o>=l.length)return!1;if(2===e.dimensions){if(a++,t.length===a)return e;var s=t[a];if(!n(s))return!1;e=l[o][s]}else e=l[o]}else e=l}}return e}function n(e){return e===V(e)&&0<=e}function l(e){var t,r;"area"===e?(t={attributes:A},r={}):(t=x.modules[e]._module,r=t.basePlotModule);var o={type:null},i=E({},b),n=E({},t.attributes);a.crawl(n,function(e,t,a,r,o){P(i,o).set(void 0),void 0===e&&P(n,o).set(void 0)}),E(o,i),x.traceIs(e,"noOpacity")&&delete o.opacity,x.traceIs(e,"showLegend")||(delete o.showlegend,delete o.legendgroup),x.traceIs(e,"noHover")&&(delete o.hoverinfo,delete o.hoverlabel),t.selectPoints||delete o.selectedpoints,E(o,n),r.attributes&&E(o,r.attributes),o.type=e;var l={meta:t.meta||{},categories:t.categories||{},animatable:!!t.animatable,type:e,attributes:p(o)};if(t.layoutAttributes){var s={};E(s,t.layoutAttributes),l.layoutAttributes=p(s)}return t.animatable||a.crawl(l,function(e){a.isValObject(e)&&"anim"in e&&delete e.anim}),l}function s(){var e={},t,a;for(t in E(e,v),x.subplotsRegistry)if(a=x.subplotsRegistry[t],a.layoutAttributes)if(Array.isArray(a.attr))for(var r=0;r<a.attr.length;r++)y(e,a,a.attr[r]);else{var o="subplot"===a.attr?a.name:a.attr;y(e,a,o)}for(t in e=m(e),x.componentsRegistry){a=x.componentsRegistry[t];var n=a.schema;if(n&&(n.subplots||n.layout)){var l=n.subplots;if(l&&l.xaxis&&!l.yaxis)for(var s in l.xaxis)delete e.yaxis[s]}else"colorscale"===a.name?E(e,a.layoutAttributes):a.layoutAttributes&&f(e,a.layoutAttributes,a.name)}return{layoutAttributes:p(e)}}function d(e){var t=x.transformsRegistry[e],a=E({},t.attributes);return Object.keys(x.componentsRegistry).forEach(function(t){var r=x.componentsRegistry[t];r.schema&&r.schema.transforms&&r.schema.transforms[e]&&Object.keys(r.schema.transforms[e]).forEach(function(t){f(a,r.schema.transforms[e][t],t)})}),{attributes:p(a)}}function c(){var e={frames:E({},k)};return p(e),e.frames}function p(e){return u(e),g(e),h(e),e}function u(e){function t(){return{valType:"string",editType:"none"}}a.crawl(e,function(e,r,o){a.isValObject(e)?"data_array"===e.valType?(e.role="data",o[r+"src"]=t(r)):!0===e.arrayOk&&(o[r+"src"]=t(r)):I(e)&&(e.role="object")})}function g(e){a.crawl(e,function(e,t,a){if(e){var r=e._isLinkedToArray;r&&(delete e._isLinkedToArray,a[t]={items:{}},a[t].items[r]=e,a[t].role="object")}})}function h(e){function t(e){for(var a in e)if(I(e[a]))t(e[a]);else if(Array.isArray(e[a]))for(var r=0;r<e[a].length;r++)t(e[a][r]);else e[a]instanceof RegExp&&(e[a]=e[a].toString())}t(e)}function m(e){return L(e,{radialaxis:S.radialaxis,angularaxis:S.angularaxis}),L(e,S.layout),e}function y(e,t,a){var r=P(e,a),o=E({},t.layoutAttributes);o._isSubplotObj=!0,r.set(o)}function f(e,t,a){var r=P(e,a);r.set(E(r.get()||{},t))}var x=e("../registry"),_=e("../lib"),b=e("../plots/attributes"),v=e("../plots/layout_attributes"),k=e("../plots/frame_attributes"),w=e("../plots/animation_attributes"),T=e("./plot_config").configAttributes,A=e("../plots/polar/legacy/area_attributes"),S=e("../plots/polar/legacy/axis_attributes"),C=e("./edit_types"),L=_.extendFlat,E=_.extendDeepAll,I=_.isPlainObject,z=_.isArrayOrTypedArray,P=_.nestedProperty,D=_.valObjectMeta,O="_isSubplotObj",R="_isLinkedToArray",M="_deprecated",j=[O,R,"_arrayAttrRegexps",M];a.IS_SUBPLOT_OBJ=O,a.IS_LINKED_TO_ARRAY=R,a.DEPRECATED=M,a.UNDERSCORE_ATTRS=j,a.get=function(){var e={};x.allTypes.concat("area").forEach(function(t){e[t]=l(t)});var t={};return Object.keys(x.transformsRegistry).forEach(function(e){t[e]=d(e)}),{defs:{valObjects:D,metaKeys:j.concat(["description","role","editType","impliedEdits"]),editType:{traces:C.traces,layout:C.layout},impliedEdits:{}},traces:e,layout:s(),transforms:t,frames:c(),animation:p(w),config:p(T)}},a.crawl=function(e,t,r,o){var i=r||0;o=o||"",Object.keys(e).forEach(function(r){var n=e[r];if(-1===j.indexOf(r)){var l=(o?o+".":"")+r;t(n,r,e,i,l),a.isValObject(n)||I(n)&&"impliedEdits"!==r&&a.crawl(n,t,i+1,l)}})},a.isValObject=function(e){return e&&e.valType!==void 0},a.findArrayAttributes=function(e){function t(e,t,a,o){n=n.slice(0,o).concat([t]),l=l.slice(0,o).concat([e&&e._isLinkedToArray]);var i=e&&("data_array"===e.valType||!0===e.arrayOk)&&("colorbar"!==n[o-1]||"ticktext"!==t&&"tickvals"!==t);i&&r(s,0,"")}function r(e,t,a){var i=e[n[t]],s=a+n[t];if(t===n.length-1)z(i)&&o.push(d+s);else if(!l[t])I(i)&&r(i,t+1,s+".");else if(Array.isArray(i))for(var c=0;c<i.length;c++)I(i[c])&&r(i[c],t+1,s+"["+c+"].")}var o=[],n=[],l=[],s,d;s=e,d="",a.crawl(b,t),e._module&&e._module.attributes&&a.crawl(e._module.attributes,t);var c=e.transforms;if(c)for(var p=0;p<c.length;p++){var u=c[p],g=u._module;g&&(d="transforms["+p+"].",s=u,a.crawl(g.attributes,t))}return o},a.getTraceValObject=function(e,t){var a=t[0],r=1,l,s;if("transforms"===a){if(1===t.length)return b.transforms;var d=e.transforms;if(!Array.isArray(d)||!d.length)return!1;var c=t[1];if(!n(c)||c>=d.length)return!1;l=(x.transformsRegistry[d[c].type]||{}).attributes,s=l&&l[t[2]],r=3}else if("area"===e.type)s=A[a];else{var p=e._module;if(p||(p=(x.modules[e.type||b.type.dflt]||{})._module),!p)return!1;if(l=p.attributes,s=l&&l[a],!s){var u=p.basePlotModule;u&&u.attributes&&(s=u.attributes[a])}s||(s=b[a])}return o(s,t,r)},a.getLayoutValObject=function(e,t){var a=r(e,t[0]);return o(a,t,1)}},{"../lib":719,"../plots/animation_attributes":762,"../plots/attributes":764,"../plots/frame_attributes":794,"../plots/layout_attributes":819,"../plots/polar/legacy/area_attributes":834,"../plots/polar/legacy/axis_attributes":835,"../registry":847,"./edit_types":750,"./plot_config":755}],757:[function(e,t,a){"use strict";function r(e){return e&&"string"==typeof e}function o(e){var t=e.length-1;return"s"!==e.charAt(t)&&i.warn("bad argument to arrayDefaultKey: "+e),e.substr(0,e.length-1)+"defaults"}var i=e("../lib"),n=e("../plots/attributes"),l="templateitemname",s={name:{valType:"string",editType:"none"}};s[l]={valType:"string",editType:"calc"},a.templatedArray=function(e,t){return t._isLinkedToArray=e,t.name=s.name,t[l]=s[l],t},a.traceTemplater=function(e){function t(t){r=i.coerce(t,{},n,"type");var l={type:r,_template:null};if(r in a){o=e[r];var s=a[r]%o.length;a[r]++,l._template=o[s]}else;return l}var a={},r,o;for(r in e)o=e[r],Array.isArray(o)&&o.length&&(a[r]=0);return{newTrace:t}},a.newContainer=function(e,t,a){var r=e._template,o=r&&(r[t]||a&&r[a]);i.isPlainObject(o)||(o=null);var n=e[t]={_template:o};return n},a.arrayTemplater=function(e,t,a){function i(e){var t={name:e.name,_input:e},o=t[l]=e[l];if(!r(o))return t._template=d,t;for(var n=0,s;n<c.length;n++)if(s=c[n],s.name===o)return p[o]=1,t._template=s,t;return t[a]=e[a]||!1,t._template=!1,t}function n(){for(var e=[],t=0;t<c.length;t++){var a=c[t],o=a.name;if(r(o)&&!p[o]){var n={_template:a,name:o,_input:{_templateitemname:o}};n[l]=a[l],e.push(n),p[o]=1}}return e}var s=e._template,d=s&&s[o(t)],c=s&&s[t];Array.isArray(c)&&c.length||(c=[]);var p={};return{newItem:i,defaultItems:n}},a.arrayDefaultKey=o,a.arrayEditor=function(e,t,a){function r(){g={},p&&(g[u]={},g[u][l]=p)}function o(e,t){g[e]=t}function n(e,t){p?i.nestedProperty(g[u],e).set(t):g[u+"."+e]=t}function s(){var e=g;return r(),e}var d=(i.nestedProperty(e,t).get()||[]).length,c=a._index,p=c>=d&&(a._input||{})._templateitemname;p&&(c=d);var u=t+"["+c+"]",g;return r(),{modifyBase:o,modifyItem:n,getUpdateObj:s,applyUpdate:function(t,a){t&&n(t,a);var r=s();for(var o in r)i.nestedProperty(e,o).set(r[o])}}}},{"../lib":719,"../plots/attributes":764}],758:[function(e,t,a){"use strict";function r(e,t,a){for(var r=0;r<a.length;r++){var o=a[r][0],n=a[r][1];if(!(o[0]>=e[1]||o[1]<=e[0])&&n[0]<t[1]&&n[1]>t[0])return!0}return!1}function o(e){function t(e,t,a){var r=e._lw/2;return"x"===e._id.charAt(0)?t?"top"===a?t._offset-h-r:t._offset+t._length+h+r:g.t+g.h*(1-(e.position||0))+r%1:t?"right"===a?t._offset+t._length+h+r:t._offset-h-r:g.l+g.w*(e.position||0)+r%1}function o(e){return"M"+H+","+e+"H"+G}function n(e){return"M"+S._offset+","+e+"h"+S._length}function s(e){return"M"+e+","+K+"V"+Z}function d(e){return"M"+e+","+C._offset+"v"+C._length}function c(e,t,a){if(!e.showline||w!==e._mainSubplot)return"";if(!e._anchorAxis)return a(e._mainLinePosition);var r=t(e._mainLinePosition);return e.mirror&&(r+=t(e._mainMirrorPosition)),r}var p=e._fullLayout,g=p._size,h=g.p,y=v.list(e,"",!0),_,w,T,A,S,C;if(p._paperdiv.style({width:e._context.responsive&&p.autosize&&!e._context._hasZeroWidth&&!e.layout.width?"100%":p.width+"px",height:e._context.responsive&&p.autosize&&!e._context._hasZeroHeight&&!e.layout.height?"100%":p.height+"px"}).selectAll(".main-svg").call(x.setSize,p.width,p.height),e._context.setBackground(e,p.paper_bgcolor),a.drawMainTitle(e),b.manage(e),!p._has("cartesian"))return e._promises.length&&Promise.all(e._promises);for(_=0;_<y.length;_++){A=y[_];var L=A._anchorAxis;A._linepositions={},A._lw=x.crispRound(e,A.linewidth,1),A._mainLinePosition=t(A,L,A.side),A._mainMirrorPosition=A.mirror&&L?t(A,L,k.OPPOSITE_SIDE[A.side]):null}var E=[],I=[],z=[],P=1===f.opacity(p.paper_bgcolor)&&1===f.opacity(p.plot_bgcolor)&&p.paper_bgcolor===p.plot_bgcolor;for(w in p._plots)if(T=p._plots[w],T.mainplot)T.bg&&T.bg.remove(),T.bg=void 0;else{var D=T.xaxis.domain,O=T.yaxis.domain,R=T.plotgroup;if(r(D,O,z)){var M=R.node(),j=T.bg=m.ensureSingle(R,"rect","bg");M.insertBefore(j.node(),M.childNodes[0]),I.push(w)}else R.select("rect.bg").remove(),z.push([D,O]),P||(E.push(w),I.push(w))}var F=p._bgLayer.selectAll(".bg").data(E);for(F.enter().append("rect").classed("bg",!0),F.exit().remove(),F.each(function(e){p._plots[e].bg=u.select(this)}),_=0;_<I.length;_++)T=p._plots[I[_]],S=T.xaxis,C=T.yaxis,T.bg&&T.bg.call(x.setRect,S._offset-h,C._offset-h,S._length+2*h,C._length+2*h).call(f.fill,p.plot_bgcolor).style("stroke-width",0);if(!p._hasOnlyLargeSploms)for(w in p._plots){T=p._plots[w],S=T.xaxis,C=T.yaxis;var B=T.clipId="clip"+p._uid+w+"plot",N=m.ensureSingleById(p._clips,"clipPath",B,function(e){e.classed("plotclip",!0).append("rect")});T.clipRect=N.select("rect").attr({width:S._length,height:C._length}),x.setTranslate(T.plot,S._offset,C._offset);var V,U;T._hasClipOnAxisFalse?(V=null,U=B):(V=B,U=null),x.setClipUrl(T.plot,V,e),T.layerClipId=U}var H,G,q,Y,W,X,Z,K,J,Q,$,ee,te;for(w in p._plots){T=p._plots[w],S=T.xaxis,C=T.yaxis;var ae="M0,0";i(S,w)&&(W=l(S,"left",C,y),H=S._offset-(W?h+W:0),X=l(S,"right",C,y),G=S._offset+S._length+(X?h+X:0),q=t(S,C,"bottom"),Y=t(S,C,"top"),te=!S._anchorAxis||w!==S._mainSubplot,te&&("allticks"===S.mirror||"all"===S.mirror)&&(S._linepositions[w]=[q,Y]),ae=c(S,o,n),te&&S.showline&&("all"===S.mirror||"allticks"===S.mirror)&&(ae+=o(q)+o(Y)),T.xlines.style("stroke-width",S._lw+"px").call(f.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),T.xlines.attr("d",ae);var re="M0,0";i(C,w)&&($=l(C,"bottom",S,y),Z=C._offset+C._length+($?h:0),ee=l(C,"top",S,y),K=C._offset-(ee?h:0),J=t(C,S,"left"),Q=t(C,S,"right"),te=!C._anchorAxis||w!==C._mainSubplot,te&&("allticks"===C.mirror||"all"===C.mirror)&&(C._linepositions[w]=[J,Q]),re=c(C,s,d),te&&C.showline&&("all"===C.mirror||"allticks"===C.mirror)&&(re+=s(J)+s(Q)),T.ylines.style("stroke-width",C._lw+"px").call(f.stroke,C.showline?C.linecolor:"rgba(0,0,0,0)")),T.ylines.attr("d",re)}return v.makeClipPaths(e),e._promises.length&&Promise.all(e._promises)}function i(e,t){return(e.ticks||e.showline)&&(t===e._mainSubplot||"all"===e.mirror||"allticks"===e.mirror)}function n(e,t,a){if(!a.showline||!a._lw)return!1;if("all"===a.mirror||"allticks"===a.mirror)return!0;var r=a._anchorAxis;if(!r)return!1;var o=k.FROM_BL[t];return a.side===t?r.domain[o]===e.domain[o]:a.mirror&&r.domain[1-o]===e.domain[1-o]}function l(e,t,a,r){if(n(e,t,a))return a._lw;for(var o=0,l;o<r.length;o++)if(l=r[o],l._mainAxis===a._mainAxis&&n(e,t,l))return l._lw;return 0}function s(e,t){var a=e.title,r=e._size,o=0;switch("start"===t?o=a.pad.l:"end"===t&&(o=-a.pad.r),a.xref){case"paper":return r.l+r.w*a.x+o;case"container":default:return e.width*a.x+o;}}function d(e,t){var a=e.title,r=e._size,o=0;if("0em"!==t&&t?t===k.CAP_SHIFT+"em"&&(o=a.pad.t):o=-a.pad.b,"auto"===a.y)return r.t/2;switch(a.yref){case"paper":return r.t+r.h-r.h*a.y+o;case"container":default:return e.height-e.height*a.y+o;}}function c(e){var t=e.title,a="middle";return m.isRightAnchor(t)?a="end":m.isLeftAnchor(t)&&(a="start"),a}function p(e){var t=e.title,a="0em";return m.isTopAnchor(t)?a=k.CAP_SHIFT+"em":m.isMiddleAnchor(t)&&(a=k.MID_SHIFT+"em"),a}var u=e("d3"),g=e("../registry"),h=e("../plots/plots"),m=e("../lib"),y=e("../lib/clear_gl_canvases"),f=e("../components/color"),x=e("../components/drawing"),_=e("../components/titles"),b=e("../components/modebar"),v=e("../plots/cartesian/axes"),k=e("../constants/alignment"),w=e("../plots/cartesian/constraints"),T=w.enforce,A=w.clean,S=e("../plots/cartesian/autorange").doAutoRange;a.layoutStyles=function(e){return m.syncOrAsync([h.doAutoMargin,o],e)},a.drawMainTitle=function(e){var t=e._fullLayout,a=c(t),r=p(t);_.draw(e,"gtitle",{propContainer:t,propName:"title.text",placeholder:t._dfltTitle.plot,attributes:{x:s(t,a),y:d(t,r),"text-anchor":a,dy:r}})},a.doTraceStyle=function(e){var t=e.calcdata,r=[],o;for(o=0;o<t.length;o++){var n=t[o],l=n[0]||{},s=l.trace||{},d=s._module||{},c=d.arraysToCalcdata;c&&c(n,s);var p=d.editStyle;p&&r.push({fn:p,cd0:l})}if(r.length){for(o=0;o<r.length;o++){var u=r[o];u.fn(e,u.cd0)}y(e),a.redrawReglTraces(e)}return h.style(e),g.getComponentMethod("legend","draw")(e),h.previousPromises(e)},a.doColorBars=function(e){return g.getComponentMethod("colorbar","draw")(e),h.previousPromises(e)},a.layoutReplot=function(e){var t=e.layout;return e.layout=void 0,g.call("plot",e,"",t)},a.doLegend=function(e){return g.getComponentMethod("legend","draw")(e),h.previousPromises(e)},a.doTicksRelayout=function(e){return v.draw(e,"redraw"),e._fullLayout._hasOnlyLargeSploms&&(g.subplotsRegistry.splom.updateGrid(e),y(e),a.redrawReglTraces(e)),a.drawMainTitle(e),h.previousPromises(e)},a.doModeBar=function(e){var t=e._fullLayout;b.manage(e);for(var a=0,r;a<t._basePlotModules.length;a++)r=t._basePlotModules[a].updateFx,r&&r(e);return h.previousPromises(e)},a.doCamera=function(e){for(var t=e._fullLayout,a=t._subplots.gl3d,r=0;r<a.length;r++){var o=t[a[r]],n=o._scene,l=o.camera;n.setCamera(l)}},a.drawData=function(e){var t=e._fullLayout;y(e);for(var r=t._basePlotModules,o=0;o<r.length;o++)r[o].plot(e);return a.redrawReglTraces(e),h.style(e),g.getComponentMethod("shapes","draw")(e),g.getComponentMethod("annotations","draw")(e),t._replotting=!1,h.previousPromises(e)},a.redrawReglTraces=function(e){var t=e._fullLayout;if(t._has("regl")){var a=e._fullData,r=[],o=[],n,l;for(t._hasOnlyLargeSploms&&t._splomGrid.draw(),n=0;n<a.length;n++){var s=a[n];!0===s.visible&&0!==s._length&&("splom"===s.type?t._splomScenes[s.uid].draw():"scattergl"===s.type?m.pushUnique(r,s.xaxis+s.yaxis):"scatterpolargl"===s.type&&m.pushUnique(o,s.subplot))}for(n=0;n<r.length;n++)l=t._plots[r[n]],l._scene&&l._scene.draw();for(n=0;n<o.length;n++)l=t[o[n]]._subplot,l._scene&&l._scene.draw()}},a.doAutoRangeAndConstraints=function(e){for(var t=e._fullLayout,a=v.list(e,"",!0),r=t._axisMatchGroups||[],o=0,n,l;o<a.length;o++)n=a[o],A(e,n),S(e,n);T(e);groupLoop:for(var s=0;s<r.length;s++){var d=r[s],c=null,p;for(p in d){if(n=v.getFromId(e,p),!1===n.autorange)continue groupLoop;l=m.simpleMap(n.range,n.r2l),c?c[0]<c[1]?(c[0]=ea(c[0],l[0]),c[1]=va(c[1],l[1])):(c[0]=va(c[0],l[0]),c[1]=ea(c[1],l[1])):c=l}for(p in d)n=v.getFromId(e,p),n.range=m.simpleMap(c,n.l2r),n._input.range=n.range.slice(),n.setScale()}},a.finalDraw=function(e){g.getComponentMethod("shapes","draw")(e),g.getComponentMethod("images","draw")(e),g.getComponentMethod("annotations","draw")(e),g.getComponentMethod("rangeslider","draw")(e),g.getComponentMethod("rangeselector","draw")(e)},a.drawMarginPushers=function(e){g.getComponentMethod("legend","draw")(e),g.getComponentMethod("rangeselector","draw")(e),g.getComponentMethod("sliders","draw")(e),g.getComponentMethod("updatemenus","draw")(e),g.getComponentMethod("colorbar","draw")(e)}},{"../components/color":593,"../components/drawing":614,"../components/modebar":652,"../components/titles":681,"../constants/alignment":688,"../lib":719,"../lib/clear_gl_canvases":704,"../plots/cartesian/autorange":766,"../plots/cartesian/axes":767,"../plots/cartesian/constraints":774,"../plots/plots":828,"../registry":847,d3:163}],759:[function(e,t,a){"use strict";function r(e,t){function a(t,a,o){if(g(a)&&g(t))r(t,a);else if(Array.isArray(a)&&Array.isArray(t)){var i=f.arrayTemplater({_template:e},o);for(s=0;s<a.length;s++){var n=a[s],l=i.newItem(n)._template;l&&r(l,n)}var d=i.defaultItems();for(s=0;s<d.length;s++)a.push(d[s]._template);for(s=0;s<a.length;s++)delete a[s].templateitemname}}e=u.extendDeep({},e);var n=Object.keys(e).sort(),l,s;for(l=0;l<n.length;l++){var d=n[l],c=e[d];if(d in t?a(c,t[d],d):t[d]=c,o(d)===d)for(var p in t){var h=o(p);p===h||h!==d||p in e||a(c,t[p],d)}}}function o(e){return e.replace(/[0-9]+$/,"")}function n(e,t,a,r,l){var s=l&&a(l);for(var c in e){var p=e[c],h=d(e,c,r),m=d(e,c,l),y=a(m);if(!y){var x=o(c);x!==c&&(m=d(e,x,l),y=a(m))}if(!(s&&s===y)){if(!y||y._noTemplating||"data_array"===y.valType||y.arrayOk&&Array.isArray(p))continue;if(!y.valType&&g(p))n(p,t,a,h,m);else if(y._isLinkedToArray&&Array.isArray(p)){for(var _=!1,b=0,v={},k=0,w;k<p.length;k++)if(w=p[k],g(w)){var T=w.name;if(T)v[T]||(n(w,t,a,d(p,b,h),d(p,b,m)),b++,v[T]=1);else if(!_){var A=f.arrayDefaultKey(c),S=d(e,A,r),C=d(p,b,h);n(w,t,a,C,d(p,b,m));var L=u.nestedProperty(t,C),E=u.nestedProperty(t,S);E.set(L.get()),L.set(null),_=!0}}}else{var I=u.nestedProperty(t,h);I.set(p)}}}}function l(e,t){return h.getLayoutValObject(e,u.nestedProperty({},t).parts)}function s(e,t){return h.getTraceValObject(e,u.nestedProperty({},t).parts)}function d(e,t,a){var r;return r=a?Array.isArray(e)?a+"["+t+"]":a+"."+t:t,r}function c(e){for(var t=0;t<e.length;t++)if(g(e[t]))return!0}function p(e){var t;switch(e.code){case"data":t="The template has no key data.";break;case"layout":t="The template has no key layout.";break;case"missing":t=e.path?"There are no templates for item "+e.path+" with name "+e.templateitemname:"There are no templates for trace "+e.index+", of type "+e.traceType+".";break;case"unused":t=e.path?"The template item at "+e.path+" was not used in constructing the plot.":e.dataCount?"Some of the templates of type "+e.traceType+" were not used. The template has "+e.templateCount+" traces, the data only has "+e.dataCount+" of this type.":"The template has "+e.templateCount+" traces of type "+e.traceType+" but there are none in the data.";break;case"reused":t="Some of the templates of type "+e.traceType+" were used more than once. The template has "+e.templateCount+" traces, the data has "+e.dataCount+" of this type.";}return e.msg=t,e}var u=e("../lib"),g=u.isPlainObject,h=e("./plot_schema"),m=e("../plots/plots"),y=e("../plots/attributes"),f=e("./plot_template"),x=e("./plot_config").dfltConfig;a.makeTemplate=function(e){e=u.isPlainObject(e)?e:u.getGraphDiv(e),e=u.extendDeep({_context:x},{data:e.data,layout:e.layout}),m.supplyDefaults(e);var t=e.data||[],a=e.layout||{};a._basePlotModules=e._fullLayout._basePlotModules,a._modules=e._fullLayout._modules;var o={data:{},layout:{}};t.forEach(function(e){var t={};n(e,t,s.bind(null,e));var a=u.coerce(e,{},y,"type"),r=o.data[a];r||(r=o.data[a]=[]),r.push(t)}),n(a,o.layout,l.bind(null,a)),delete o.layout.template;var d=a.template;if(g(d)){var c=d.layout,p,h,f,_,b,v;g(c)&&r(c,o.layout);var k=d.data;if(g(k)){for(h in o.data)if(f=k[h],Array.isArray(f)){for(b=o.data[h],v=b.length,_=f.length,p=0;p<v;p++)r(f[p%_],b[p]);for(p=v;p<_;p++)b.push(u.extendDeep({},f[p]))}for(h in k)h in o.data||(o.data[h]=u.extendDeep([],k[h]))}}return o},a.validateTemplate=function(e,t){function a(e,t){for(var r in e)if("_"!==r.charAt(0)&&g(e[r])){var n=o(r),l=[],s;for(s=0;s<t.length;s++)l.push(d(e,r,t[s])),n!==r&&l.push(d(e,n,t[s]));for(s=0;s<l.length;s++)v[l[s]]=1;a(e[r],l)}}function r(e,t){for(var a in e)if(-1===a.indexOf("defaults")&&g(e[a])){var o=d(e,a,t);v[o]?r(e[a],o):f.push({code:"unused",path:o})}}function n(e,t){for(var a in e)if("_"!==a.charAt(0)){var r=e[a],o=d(e,a,t);g(r)?(Array.isArray(e)&&!1===r._template&&r.templateitemname&&f.push({code:"missing",path:o,templateitemname:r.templateitemname}),n(r,o)):Array.isArray(r)&&c(r)&&n(r,o)}}var l=u.extendDeep({},{_context:x,data:e.data,layout:e.layout}),s=l.layout||{};g(t)||(t=s.template||{});var h=t.layout,y=t.data,f=[];l.layout=s,l.layout.template=t,m.supplyDefaults(l);var _=l._fullLayout,b=l._fullData,v={};if(g(h)?(a(_,["layout"]),r(h,"layout")):f.push({code:"layout"}),!g(y))f.push({code:"data"});else{for(var k={},w=0,T,A;w<b.length;w++)A=b[w],T=A.type,k[T]=(k[T]||0)+1,A._fullInput._template||f.push({code:"missing",index:A._fullInput.index,traceType:T});for(T in y){var S=y[T].length,C=k[T]||0;S>C?f.push({code:"unused",traceType:T,templateCount:S,dataCount:C}):C>S&&f.push({code:"reused",traceType:T,templateCount:S,dataCount:C})}}return(n({data:b,layout:_},""),f.length)?f.map(p):void 0}},{"../lib":719,"../plots/attributes":764,"../plots/plots":828,"./plot_config":755,"./plot_schema":756,"./plot_template":757}],760:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("./plot_api"),o=e("../lib"),i=e("../snapshot/helpers"),n=e("../snapshot/tosvg"),l=e("../snapshot/svgtoimg"),s={format:{valType:"enumerated",values:["png","jpeg","webp","svg"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};t.exports=function(e,t){function d(e){return!(e in t)||o.validate(t[e],s[e])}function c(e,a){return o.coerce(t,x,s,e,a)}function p(){return new Promise(function(e){setTimeout(e,i.getDelay(A._fullLayout))})}function u(){return new Promise(function(e,t){var a=n(A,_,k),s=A._fullLayout.width,d=A._fullLayout.height;if(r.purge(A),document.body.removeChild(A),"svg"===_)return T?e(a):e(i.encodeSVG(a));var c=document.createElement("canvas");c.id=o.randstr(),l({format:_,width:s,height:d,scale:k,canvas:c,svg:a,promise:!0}).then(e).catch(t)})}function g(e){return T?e.replace(i.IMAGE_URL_PREFIX,""):e}t=t||{};var h,m,y,f;if(o.isPlainObject(e)?(h=e.data||[],m=e.layout||{},y=e.config||{},f={}):(e=o.getGraphDiv(e),h=o.extendDeep([],e.data),m=o.extendDeep({},e.layout),y=e._context,f=e._fullLayout||{}),!d("width")&&null!==t.width||!d("height")&&null!==t.height)throw new Error("Height and width should be pixel values.");if(!d("format"))throw new Error("Image format is not jpeg, png, svg or webp.");var x={},_=c("format"),b=c("width"),v=c("height"),k=c("scale"),w=c("setBackground"),T=c("imageDataOnly"),A=document.createElement("div");A.style.position="absolute",A.style.left="-5000px",document.body.appendChild(A);var S=o.extendFlat({},m);b?S.width=b:null===t.width&&a(f.width)&&(S.width=f.width),v?S.height=v:null===t.height&&a(f.height)&&(S.height=f.height);var C=o.extendFlat({},y,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),L=i.getRedrawFunc(A);return new Promise(function(e,t){r.plot(A,h,S,C).then(L).then(p).then(u).then(function(t){e(g(t))}).catch(function(e){t(e)})})}},{"../lib":719,"../snapshot/helpers":851,"../snapshot/svgtoimg":853,"../snapshot/tosvg":855,"./plot_api":754,"fast-isnumeric":225}],761:[function(e,t){"use strict";function a(e,t,r,o,c,g){g=g||[];for(var h=Object.keys(e),_=0,b;_<h.length;_++)if(b=h[_],"transforms"!==b){var v=g.slice();v.push(b);var p=e[b],w=t[b],T=d(r,b),A="info_array"===(T||{}).valType,S="colorscale"===(T||{}).valType,C=(T||{}).items;if(!s(r,b))o.push(l("schema",c,v));else if(y(p)&&y(w))a(p,w,T,o,c,v);else if(A&&f(p)){p.length>w.length&&o.push(l("unused",c,v.concat(w.length)));var L=w.length,E=Array.isArray(C);E&&(L=ea(L,C.length));var I,z,P,D,O;if(2===T.dimensions){for(z=0;z<L;z++)if(f(p[z])){p[z].length>w[z].length&&o.push(l("unused",c,v.concat(z,w[z].length)));var R=w[z].length;for(I=0;I<(E?ea(R,C[z].length):R);I++)P=E?C[z][I]:C,D=p[z][I],O=w[z][I],u.validate(D,P)?O!==D&&O!==+D&&o.push(l("dynamic",c,v.concat(z,I),D,O)):o.push(l("value",c,v.concat(z,I),D))}else o.push(l("array",c,v.concat(z),p[z]));}else for(z=0;z<L;z++)P=E?C[z]:C,D=p[z],O=w[z],u.validate(D,P)?O!==D&&O!==+D&&o.push(l("dynamic",c,v.concat(z),D,O)):o.push(l("value",c,v.concat(z),D))}else if(T.items&&!A&&f(p)){var M=C[Object.keys(C)[0]],F=[],B,N;for(B=0;B<w.length;B++){var V=w[B]._index||B;if(N=v.slice(),N.push(V),y(p[V])&&y(w[B])){F.push(V);var U=p[V],H=w[B];y(U)&&!1!==U.visible&&!1===H.visible?o.push(l("invisible",c,N)):a(U,H,M,o,c,N)}}for(B=0;B<p.length;B++)N=v.slice(),N.push(B),y(p[B])?-1===F.indexOf(B)&&o.push(l("unused",c,N)):o.push(l("object",c,N,p[B]))}else!y(p)&&y(w)?o.push(l("object",c,v,p)):x(p)||!x(w)||A||S?b in t?u.validate(p,T)?"enumerated"===T.valType&&(T.coerceNumber&&p!==+w||p!==w)&&o.push(l("dynamic",c,v,p,w)):o.push(l("value",c,v,p)):o.push(l("unused",c,v,p)):o.push(l("array",c,v,p))}return o}function r(e,t){for(var a=e.layout.layoutAttributes,r=0;r<t.length;r++){var o=t[r],n=e.traces[o.type],l=n.layoutAttributes;l&&(o.subplot?u.extendFlat(a[n.attributes.subplot.dflt],l):u.extendFlat(a,l))}return a}function o(e){return f(e)?"In data trace "+e[1]+", ":"In "+e+", "}function l(e,t,a,r,o){a=a||"";var i,n;f(t)?(i=t[0],n=t[1]):(i=t,n=null);var l=p(a),s=_[e](t,l,r,o);return u.log(s),{code:e,container:i,trace:n,path:a,astr:l,msg:s}}function s(e,t){var a=c(t),r=a.keyMinusId,o=a.id;return!!(r in e&&e[r]._isSubplotObj&&o)||t in e}function d(e,t){if(t in e)return e[t];var a=c(t);return e[a.keyMinusId]}function c(e){var t=e.match(b);return{keyMinusId:t&&t[1],id:t&&t[2]}}function p(e){if(!f(e))return e+"";for(var t="",a=0,r;a<e.length;a++)r=e[a],"number"==typeof r?t=t.substr(0,t.length-1)+"["+r+"]":t+=r,a<e.length-1&&(t+=".");return t}var u=e("../lib"),g=e("../plots/plots"),h=e("./plot_schema"),m=e("./plot_config").dfltConfig,y=u.isPlainObject,f=Array.isArray,x=u.isArrayOrTypedArray;t.exports=function(e,t){var o=h.get(),n=[],s={_context:u.extendFlat({},m)},d,c;f(e)?(s.data=u.extendDeep([],e),d=e):(s.data=[],d=[],n.push(l("array","data"))),y(t)?(s.layout=u.extendDeep({},t),c=t):(s.layout={},c={},1<arguments.length&&n.push(l("object","layout"))),g.supplyDefaults(s);for(var p=s._fullData,x=d.length,_=0;_<x;_++){var b=d[_],v=["data",_];if(!y(b)){n.push(l("object",v));continue}var k=p[_],w=k.type,T=o.traces[w].attributes;T.type={valType:"enumerated",values:[w]},!1===k.visible&&!1!==b.visible&&n.push(l("invisible",v)),a(b,k,T,n,v);var A=b.transforms,S=k.transforms;if(A){f(A)||n.push(l("array",v,["transforms"])),v.push("transforms");for(var C=0;C<A.length;C++){var L=["transforms",C],E=A[C].type;if(!y(A[C])){n.push(l("object",v,L));continue}var I=o.transforms[E]?o.transforms[E].attributes:{};I.type={valType:"enumerated",values:Object.keys(o.transforms)},a(A[C],S[C],I,n,v,L)}}}var z=s._fullLayout,P=r(o,p);return a(c,z,P,n,"layout"),0===n.length?void 0:n};var _={object:function(e,t){var a;return a="layout"===e&&""===t?"The layout argument":"data"===e[0]&&""===t?"Trace "+e[1]+" in the data argument":o(e)+"key "+t,a+" must be linked to an object container"},array:function(e,t){var a;return a="data"===e?"The data argument":o(e)+"key "+t,a+" must be linked to an array container"},schema:function(e,t){return o(e)+"key "+t+" is not part of the schema"},unused:function(e,t,a){var r=y(a)?"container":"key";return o(e)+r+" "+t+" did not get coerced"},dynamic:function(e,t,a,r){return[o(e)+"key",t,"(set to '"+a+"')","got reset to","'"+r+"'","during defaults."].join(" ")},invisible:function(e,t){return(t?o(e)+"item "+t:"Trace "+e[1])+" got defaulted to be not visible"},value:function(e,t,a){return[o(e)+"key "+t,"is set to an invalid value ("+a+")"].join(" ")}},b=u.counterRegex("([a-z]+)")},{"../lib":719,"../plots/plots":828,"./plot_config":755,"./plot_schema":756}],762:[function(e,t){"use strict";t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],763:[function(e,t){"use strict";var a=e("../lib"),r=e("../plot_api/plot_template");t.exports=function(e,t,o){var n=o.name,l=o.inclusionAttr||"visible",s=t[n],d=a.isArrayOrTypedArray(e[n])?e[n]:[],c=t[n]=[],p=r.arrayTemplater(t,n,l),u,g;for(u=0;u<d.length;u++){var h=d[u];a.isPlainObject(h)?g=p.newItem(h):(g=p.newItem({}),g[l]=!1),g._index=u,!1!==g[l]&&o.handleItemDefaults(h,g,t,o),c.push(g)}var m=p.defaultItems();for(u=0;u<m.length;u++)g=m[u],g._index=c.length,o.handleItemDefaults({},g,t,o,{}),c.push(g);if(a.isArrayOrTypedArray(s)){var y=ea(s.length,c.length);for(u=0;u<y;u++)a.relinkPrivateKeys(c[u],s[u])}return c}},{"../lib":719,"../plot_api/plot_template":757}],764:[function(e,t){"use strict";var a=e("../components/fx/attributes");t.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:a.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":623}],765:[function(e,t){"use strict";t.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],766:[function(e,t){"use strict";function a(e,t){function a(e,t){return va(e,l(t))}var n=[],l=r(t),s=o(e,t),d=s.min,c=s.max,p,u;if(0===d.length||0===c.length)return g.simpleMap(t.range,t.r2l);var h=d[0].val,m=c[0].val;for(p=1;p<d.length&&h===m;p++)h=ea(h,d[p].val);for(p=1;p<c.length&&h===m;p++)m=va(m,c[p].val);var y=!1;if(t.range){var f=g.simpleMap(t.range,t.r2l);y=f[1]<f[0]}"reversed"===t.autorange&&(y=!0,t.autorange=!0);var x=t.rangemode,_="tozero"===x,b="nonnegative"===x,v=t._length,k=0,w,T,A,S,C,L;for(p=0;p<d.length;p++)for(w=d[p],u=0;u<c.length;u++)T=c[u],L=T.val-w.val,0<L&&(C=v-l(w)-l(T),C>v/10?L/C>k&&(A=w,S=T,k=L/C):L/v>k&&(A={val:w.val,pad:0},S={val:T.val,pad:0},k=L/v));if(h===m){var E=h-1,I=h+1;if(!_)n=b?[va(0,E),va(1,I)]:[E,I];else if(0===h)n=[0,1];else{var z=(0<h?c:d).reduce(a,0),P=h/(1-ea(.5,z/v));n=0<h?[0,P]:[P,0]}}else _?(0<=A.val&&(A={val:0,pad:0}),0>=S.val&&(S={val:0,pad:0})):b&&(0>A.val-k*l(A)&&(A={val:0,pad:0}),0>=S.val&&(S={val:1,pad:0})),k=(S.val-A.val)/(v-l(A)-l(S)),n=[A.val-k*l(A),S.val+k*l(S)];return y&&n.reverse(),g.simpleMap(n,t.l2r||Number)}function r(e){var t=e._length/20;return"domain"===e.constrain&&e._inputDomain&&(t*=(e._inputDomain[1]-e._inputDomain[0])/(e.domain[1]-e.domain[0])),function(e){return e.pad+(e.extrapad?t:0)}}function o(e,t){function a(e,t){for(u=0;u<t.length;u++){var a=e[t[u]],o=(a._extremes||{})[r];if(!0===a.visible&&o){for(g=0;g<o.min.length;g++)h=o.min[g],n(c,h.val,h.pad,{extrapad:h.extrapad});for(g=0;g<o.max.length;g++)h=o.max[g],l(p,h.val,h.pad,{extrapad:h.extrapad})}}}var r=t._id,o=e._fullData,s=e._fullLayout,c=[],p=[],u,g,h;return a(o,t._traceIndices),a(s.annotations||[],t._annIndices||[]),a(s.shapes||[],t._shapeIndices||[]),{min:c,max:p}}function n(e,t,a,r){s(e,t,a,r,c)}function l(e,t,a,r){s(e,t,a,r,p)}function s(e,t,a,r,o){for(var i=r.tozero,n=r.extrapad,l=!0,s=0,d;s<e.length&&l;s++)if(d=e[s],o(d.val,t)&&d.pad>=a&&(d.extrapad||!n)){l=!1;break}else o(t,d.val)&&d.pad<=a&&(n||!d.extrapad)&&(e.splice(s,1),s--);if(l){var c=i&&0===t;e.push({val:t,pad:c?0:a,extrapad:!c&&n})}}function d(e){return u(e)&&_a(e)<h}function c(e,t){return e<=t}function p(e,t){return e>=t}var u=e("fast-isnumeric"),g=e("../../lib"),h=e("../../constants/numerical").FP_SAFE,m=e("../../registry");t.exports={getAutoRange:a,makePadFn:r,doAutoRange:function(e,t){if(t.setScale(),t.autorange){t.range=a(e,t),t._r=t.range.slice(),t._rl=g.simpleMap(t._r,t.r2l);var r=t._input,o={};o[t._attr+".range"]=t.range,o[t._attr+".autorange"]=t.autorange,m.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,o),r.range=t.range.slice(),r.autorange=t.autorange}var i=t._anchorAxis;if(i&&i.rangeslider){var n=i.rangeslider[t._name];n&&"auto"===n.rangemode&&(n.range=a(e,t)),i._input.rangeslider[t._name]=g.extendFlat({},n)}},findExtremes:function(e,t,a){function r(e){if(Array.isArray(e))return f=!0,function(t){return va(+(e[t]||0),0)};var t=va(+(e||0),0);return function(){return t}}function o(a){A=t[a];u(A)&&(L=x(a),E=_(a),I=A-k(a),z=A+b(a),y&&I<z/10&&(I=z/10),S=e.c2l(I),C=e.c2l(z),m&&(S=ea(0,S),C=va(0,C)),d(S)&&n(s,S,E,P),d(C)&&l(c,C,L,P))}a||(a={}),e._m||e.setScale();var s=[],c=[],p=t.length,g=a.padded||!1,m=a.tozero&&("linear"===e.type||"-"===e.type),y="log"===e.type,f=!1,x=r((0<e._m?a.ppadplus:a.ppadminus)||a.ppad||0),_=r((0<e._m?a.ppadminus:a.ppadplus)||a.ppad||0),b=r(a.vpadplus||a.vpad),k=r(a.vpadminus||a.vpad),w,T,A,S,C,L,E,I,z;if(!f){if(I=1/0,z=-Infinity,y)for(w=0;w<p;w++)T=t[w],T<I&&0<T&&(I=T),T>z&&T<h&&(z=T);else for(w=0;w<p;w++)T=t[w],T<I&&T>-h&&(I=T),T>z&&T<h&&(z=T);t=[I,z],p=2}var P={tozero:m,extrapad:g},D=ea(6,p);for(w=0;w<D;w++)o(w);for(w=p-1;w>=D;w--)o(w);return{min:s,max:c,opts:a}},concatExtremes:o}},{"../../constants/numerical":695,"../../lib":719,"../../registry":847,"fast-isnumeric":225}],767:[function(e,t){"use strict";function a(e){return+e}function r(e){return e+""}function o(e,t,a,r,o){function n(t){return 2>(1+100*(t-e)/a.dtick)%100}for(var l=0,s=0,d=0,c=0,p=0;p<t.length;p++)0==t[p]%1?d++:!Y(t[p])&&c++,n(t[p])&&l++,n(t[p]+a.dtick/2)&&s++;var u=t.length-c;if(d===u&&"date"!==a.type)1>a.dtick?e=r-.5*a.dtick:(e-=.5,e+a.dtick<r&&(e+=a.dtick));else if(s<.1*u&&(l>.3*u||n(r)||n(o))){var g=a.dtick/2;e+=e+g<r?g:-g}return e}function i(e,t,a,r,o){var i=Z.findExactDates(t,o),n=.8;if(i.exactDays>n){var l=+a.substr(1);i.exactYears>n&&0==l%12?e=ge.tickIncrement(e,"M6","reverse")+1.5*ie:i.exactMonths>n?e=ge.tickIncrement(e,"M1","reverse")+15.5*ie:e-=ie/2;var s=ge.tickIncrement(e,a);if(s<=r)return s}return e}function n(e){var t=e.tickvals,a=e.ticktext,r=Array(t.length),o=Z.simpleMap(e.range,e.r2l),n=1.0001*o[0]-1e-4*o[1],l=1.0001*o[1]-1e-4*o[0],s=ea(n,l),c=va(n,l),p=0;Array.isArray(a)||(a=[]);var u="category"===e.type?e.d2l_noadd:e.d2l;"log"===e.type&&"L"!==(e.dtick+"").charAt(0)&&(e.dtick="L"+ya(10,ba(ea(e.range[0],e.range[1]))-1));for(var g=0,h;g<t.length;g++)h=u(t[g]),h>s&&h<c&&(r[p]=void 0===a[g]?ge.tickText(e,h):d(e,h,a[g]+""),p++);return p<t.length&&r.splice(p,t.length-p),r}function l(e,t,a){return t*Z.roundUp(e/t,a)}function s(e){var t=e.dtick;if(e._tickexponent=0,Y(t)||"string"==typeof t||(t=1),("category"===e.type||"multicategory"===e.type)&&(e._tickround=null),"date"===e.type){var a=e.r2l(e.tick0),r=e.l2r(a).replace(/(^-|i)/g,""),o=r.length;if("M"===(t+"").charAt(0))e._tickround=10<o||"01-01"!==r.substr(5)?"d":0==+t.substr(1)%12?"y":"m";else if(t>=ie&&10>=o||t>=15*ie)e._tickround="d";else if(t>=le&&16>=o||t>=ne)e._tickround="M";else if(t>=se&&19>=o||t>=le)e._tickround="S";else{var i=e.l2r(a+t).replace(/^-/,"").length;e._tickround=va(o,i)-20,0>e._tickround&&(e._tickround=4)}}else if(Y(t)||"L"===t.charAt(0)){var n=e.range.map(e.r2d||Number);Y(t)||(t=+t.substr(1)),e._tickround=2-ba(P(t)/I+.01);var l=va(_a(n[0]),_a(n[1])),s=ba(P(l)/I+.01);3<_a(s)&&(f(e.exponentformat)&&!_(s)?e._tickexponent=3*V((s-1)/3):e._tickexponent=s)}else e._tickround=null}function d(e,t,a){var r=e.tickfont||{};return{x:t,dx:0,dy:0,text:a||"",fontSize:r.size,font:r.family,fontColor:r.color}}function c(e,t,a,r){var o=e._tickround,i=a&&e.hoverformat||ge.getTickFormat(e);r&&(Y(o)?o=4:o={y:"m",m:"d",d:"M",M:"S",S:4}[o]);var n=Z.formatDate(t.x,i,o,e._dateFormat,e.calendar,e._extraFormat),l=n.indexOf("\n"),s;-1!==l&&(s=n.substr(l+1),n=n.substr(0,l)),r&&("00:00:00"===n||"00:00"===n?(n=s,s=""):8===n.length&&(n=n.replace(/:00$/,""))),s&&(a?"d"===o?n+=", "+s:n=s+(n?", "+n:""):(!e._inCalcTicks||s!==e._prevDateHead)&&(n+="<br>"+s,e._prevDateHead=s)),t.text=n}function p(e,t,a,r,o){var i=e.dtick,n=t.x,l=e.tickformat,s="string"==typeof i&&i.charAt(0);if("never"===o&&(o=""),r&&"L"!==s&&(i="L3",s="L"),l||"L"===s)t.text=b(ya(10,n),e,o,r);else if(Y(i)||"D"===s&&.1>Z.mod(n+.01,1)){var d=V(n),c=_a(d),p=e.exponentformat;"power"===p||f(p)&&_(d)?(t.text=0===d?1:1===d?"10":"10<sup>"+(1<d?"":de)+c+"</sup>",t.fontSize*=1.25):("e"===p||"E"===p)&&2<c?t.text="1"+p+(0<d?"+":de)+c:(t.text=b(ya(10,n),e,"","fakehover"),"D1"===i&&"y"===e._id.charAt(0)&&(t.dy-=t.fontSize/6))}else if("D"===s)t.text=V(ya(10,Z.mod(n,1)))+"",t.fontSize*=.75;else throw"unrecognized dtick "+(i+"");if("D1"===e.dtick){var u=(t.text+"").charAt(0);("0"===u||"1"===u)&&("y"===e._id.charAt(0)?t.dx-=t.fontSize/4:(t.dy+=t.fontSize/2,t.dx+=(e.range[1]>e.range[0]?1:-1)*t.fontSize*(0>n?.5:.25)))}}function u(e,t){var a=e._categories[V(t.x)];a===void 0&&(a=""),t.text=a+""}function g(e,t,a){var r=V(t.x),o=e._categories[r]||[],i=o[1]===void 0?"":o[1]+"",n=o[0]===void 0?"":o[0]+"";a?t.text=n+" - "+i:(t.text=i,t.text2=n)}function h(e,t,a,r,o){"never"===o?o="":"all"===e.showexponent&&1e-6>_a(t.x/e.dtick)&&(o="hide"),t.text=b(t.x,e,o,r)}function m(e,t,a,r,o){if("radians"===e.thetaunit&&!a){var i=t.x/180;if(0==i)t.text="0";else{var n=y(i);if(100<=n[1])t.text=b(Z.deg2rad(t.x),e,o,r);else{var l=0>t.x;t.text=1===n[1]?1===n[0]?"\u03C0":n[0]+"\u03C0":["<sup>",n[0],"</sup>","\u2044","<sub>",n[1],"</sub>","\u03C0"].join(""),l&&(t.text=de+t.text)}}}else t.text=b(t.x,e,o,r)}function y(e){function t(e,t){return 1e-6>=_a(e-t)}function r(e,a){return t(a,0)?e:r(a,e%a)}var o=function(a){for(var r=1;!t(V(a*r)/r,a);)r*=10;return r}(e),i=e*o,n=_a(r(i,o));return[V(i/n),V(o/n)]}function f(e){return"SI"===e||"B"===e}function _(e){return 14<e||-15>e}function b(t,a,r,o){var n=0>t,l=a._tickround,d=r||a.exponentformat||"B",c=a._tickexponent,p=ge.getTickFormat(a),u=a.separatethousands;if(o){var g={exponentformat:d,dtick:"none"===a.showexponent?a.dtick:Y(t)?_a(t)||1:1,range:"none"===a.showexponent?a.range.map(a.r2d):[0,t||1]};s(g),l=(+g._tickround||0)+4,c=g._tickexponent,a.hoverformat&&(p=a.hoverformat)}if(p)return a._numFormat(p)(t).replace(/-/g,de);var h=ya(10,-l)/2;if("none"===d&&(c=0),t=_a(t),t<h)t="0",n=!1;else{if(t+=h,c&&(t*=ya(10,-c),l+=c),0===l)t=ba(t)+"";else if(0>l){t=V(t)+"",t=t.substr(0,t.length+l);for(var e=l;0>e;e++)t+="0"}else{t+="";var m=t.indexOf(".")+1;m&&(t=t.substr(0,m+l).replace(/\.?0+$/,""))}t=Z.numSeparate(t,a._separators,u)}if(c&&"hide"!==d){f(d)&&_(c)&&(d="power");var y;y=0>c?de+-c:"power"===d?c+"":"+"+c,"e"===d||"E"===d?t+=d+y:"power"===d?t+="\xD710<sup>"+y+"</sup>":"B"===d&&9===c?t+="B":f(d)&&(t+=Ae[c/3+5])}return n?de+t:t}function v(e,t){var a=[],r=function(e,t){var r=e.xbnd[t];null!==r&&a.push(Z.extendFlat({},e,{x:r}))},o;if(t.length){for(o=0;o<t.length;o++)r(t[o],0);r(t[o-1],1)}return a}function k(e,t){for(var a=[],r={},o=0,n;o<t.length;o++)n=t[o],r[n.text2]?r[n.text2].push(n.x):r[n.text2]=[n.x];for(var l in r)a.push(d(e,Z.interp(r[l],.5),l));return a}function w(e,t){var a=[],r=function(e,t){var r=e.xbnd[t];null!==r&&a.push(Z.extendFlat({},e,{x:r}))},o,n;if(e.showdividers&&t.length){for(o=0;o<t.length;o++){var l=t[o];l.text2!==n&&r(l,0),n=l.text2}r(t[o-1],1)}return a}function T(e,t){var a=e._id.charAt(0),r=e._tickAngles[t]||0,o=Z.deg2rad(r),i=De(o),n=R(o),l=0,s=0;return e._selections[t].each(function(){var e=O(this),t=$.bBox(e.node()),a=t.width,r=t.height;l=va(l,n*a,i*r),s=va(s,i*a,n*r)}),{x:s,y:l}[a]}function A(e){return[e.text,e.x,e.axInfo,e.font,e.fontSize,e.fontColor].join("_")}function S(e,t,a){var r=t._id+"divider",o=a.vals,i=a.layer.selectAll("path."+r).data(o,A);i.exit().remove(),i.enter().insert("path",":first-child").classed(r,1).classed("crisp",1).call(Q.stroke,t.dividercolor).style("stroke-width",$.crispRound(e,t.dividerwidth,1)+"px"),i.attr("transform",a.transFn).attr("d",a.path)}function C(e,t){var a=e._fullLayout._size,r=t._id.charAt(0),o=t.side,i;return("free"===t.anchor?"x"===r?i={_offset:a.t+(1-(t.position||0))*a.h,_length:0}:"y"===r&&(i={_offset:a.l+(t.position||0)*a.w,_length:0}):i=me.getFromId(e,t.anchor),"top"===o||"left"===o)?i._offset:"bottom"===o||"right"===o?i._offset+i._length:void 0}function L(e,t){var a=e._fullLayout,r=t._id,o=r.charAt(0),i=t.title.font.size,n;if("multicategory"===t.type)n=t._labelLength;else{n=10+i*1.5+(t.linewidth?t.linewidth-1:0)}var l=C(e,t),s,d,c;"x"===o?(d=t._offset+t._length/2,c="top"===t.side?-n-i*(t.showticklabels?1:0):n+i*(t.showticklabels?1.5:.5),c+=l):(c=t._offset+t._length/2,d="right"===t.side?n+i*(t.showticklabels?1:.5):-n-i*(t.showticklabels?.5:0),d+=l,s={rotate:"-90",offset:0});var p;if("multicategory"!==t.type){var u=t._selections[t._id+"tick"];if(p={selection:u,side:t.side},u&&u.node()&&u.node().parentNode){var g=$.getTranslate(u.node().parentNode);p.offsetLeft=g.x,p.offsetTop=g.y}}return J.draw(e,r+"title",{propContainer:t,propName:t._name+".title.text",placeholder:a._dfltTitle[o],avoid:p,transform:s,attributes:{x:d,y:c,"text-anchor":"middle"}})}function E(e,t){var a=e.l2p(t);return 1<a&&a<e._length-1}function z(e,t,a,r){function o(e){function a(e){return"number"==typeof e&&_a(e-c)<r}if(!e.showline||!e.linewidth)return!1;var r=va((e.linewidth+t.zerolinewidth)/2,1);if(a(e._mainLinePosition)||a(e._mainMirrorPosition))return!0;var o=e._linepositions||{};for(var i in o)if(a(o[i][0])||a(o[i][1]))return!0}var n=a._mainAxis;if(n){var l=e._fullLayout,s=t._id.charAt(0),d=ge.counterLetter(t._id),c=t._offset+(_a(r[0])<_a(r[1])==("x"===s)?0:t._length),p=l._plots[a._mainSubplot];if(!(p.mainplotinfo||p).overlays.length)return o(a,c);for(var u=ge.list(e,d),g=0,h;g<u.length;g++)if(h=u[g],h._mainAxis===n&&o(h,c))return!0}}function D(e,t){for(var a=e._fullData,r=t._mainSubplot,o=t._id.charAt(0),n=0,l;n<a.length;n++)if(l=a[n],!0===l.visible&&l.xaxis+l.yaxis===r){if(X.traceIs(l,"bar-like")&&l.orientation==={x:"h",y:"v"}[o])return!0;if(l.fill&&l.fill.charAt(l.fill.length-1)===o)return!0}return!1}function O(e){var t=q.select(e),a=t.select(".text-math-group");return a.empty()?t.select("text"):a}function j(e){return e._id+".automargin"}function F(e){return e._id+".rangeslider"}function B(e,t){var a=[],r,o;for(r=0;r<t.length;r++){var n=[],l=e._fullData[t[r]].xaxis,s=e._fullData[t[r]].yaxis;if(l&&s){for(o=0;o<a.length;o++)(-1!==a[o].x.indexOf(l)||-1!==a[o].y.indexOf(s))&&n.push(o);if(!n.length){a.push({x:[l],y:[s]});continue}var d=a[n[0]],c;if(1<n.length)for(o=1;o<n.length;o++)c=a[n[o]],N(d.x,c.x),N(d.y,c.y);N(d.x,[l]),N(d.y,[s])}}return a}function N(e,t){for(var a=0;a<t.length;a++)-1===e.indexOf(t[a])&&e.push(t[a])}function U(e,t,a){var r=[],o=[],n=e.layout,l,s;for(l=0;l<t.length;l++)r.push(ge.getFromId(e,t[l]));for(l=0;l<a.length;l++)o.push(ge.getFromId(e,a[l]));var d=Object.keys(ee),c=["anchor","domain","overlaying","position","side","tickangle","editType"],p=["linear","log"];for(l=0;l<d.length;l++){var u=d[l],g=r[0][u],h=o[0][u],m=!0,y=!1,f=!1;if("_"!==u.charAt(0)&&"function"!=typeof g&&-1===c.indexOf(u)){for(s=1;s<r.length&&m;s++){var x=r[s][u];"type"===u&&-1!==p.indexOf(g)&&-1!==p.indexOf(x)&&g!==x?y=!0:x!==g&&(m=!1)}for(s=1;s<o.length&&m;s++){var _=o[s][u];"type"===u&&-1!==p.indexOf(h)&&-1!==p.indexOf(_)&&h!==_?f=!0:o[s][u]!==h&&(m=!1)}m&&(y&&(n[r[0]._name].type="linear"),f&&(n[o[0]._name].type="linear"),H(n,u,r,o,e._fullLayout._dfltTitle))}}for(l=0;l<e._fullLayout.annotations.length;l++){var b=e._fullLayout.annotations[l];-1!==t.indexOf(b.xref)&&-1!==a.indexOf(b.yref)&&Z.swapAttrs(n.annotations[l],["?"])}}function H(e,t,a,r,o){var n=Z.nestedProperty,l=n(e[a[0]._name],t).get(),s=n(e[r[0]._name],t).get(),d;for("title"===t&&(l&&l.text===o.x&&(l.text=o.y),s&&s.text===o.y&&(s.text=o.x)),d=0;d<a.length;d++)n(e,a[d]._name+"."+t).set(s);for(d=0;d<r.length;d++)n(e,r[d]._name+"."+t).set(l)}function G(e){return"angularaxis"===e._id}var q=e("d3"),Y=e("fast-isnumeric"),W=e("../../plots/plots"),X=e("../../registry"),Z=e("../../lib"),K=e("../../lib/svg_text_utils"),J=e("../../components/titles"),Q=e("../../components/color"),$=e("../../components/drawing"),ee=e("./layout_attributes"),te=e("./clean_ticks"),ae=e("../../constants/numerical"),re=ae.ONEAVGYEAR,oe=ae.ONEAVGMONTH,ie=ae.ONEDAY,ne=ae.ONEHOUR,le=ae.ONEMIN,se=ae.ONESEC,de=ae.MINUS_SIGN,ce=ae.BADNUM,pe=e("../../constants/alignment").MID_SHIFT,ue=e("../../constants/alignment").LINE_SPACING,ge=t.exports={};ge.setConvert=e("./set_convert");var he=e("./axis_autotype"),me=e("./axis_ids");ge.id2name=me.id2name,ge.name2id=me.name2id,ge.cleanId=me.cleanId,ge.list=me.list,ge.listIds=me.listIds,ge.getFromId=me.getFromId,ge.getFromTrace=me.getFromTrace;var ye=e("./autorange");ge.getAutoRange=ye.getAutoRange,ge.findExtremes=ye.findExtremes,ge.coerceRef=function(e,t,a,r,o,i){var n=r.charAt(r.length-1),l=a._fullLayout._subplots[n+"axis"],s=r+"ref",d={};return o||(o=l[0]||i),i||(i=o),d[s]={valType:"enumerated",values:l.concat(i?[i]:[]),dflt:o},Z.coerce(e,t,d,s)},ge.coercePosition=function(e,t,a,r,o,i){var n,l;if("paper"===r||"pixel"===r)n=Z.ensureNumber,l=a(o,i);else{var s=ge.getFromId(t,r);i=s.fraction2r(i),l=a(o,i),n=s.cleanPos}e[o]=n(l)},ge.cleanPosition=function(e,t,a){var r="paper"===a||"pixel"===a?Z.ensureNumber:ge.getFromId(t,a).cleanPos;return r(e)},ge.redrawComponents=function(e,t){function a(a,o,n,l){for(var s=X.getComponentMethod(a,o),d={},c=0;c<t.length;c++)for(var p=r[ge.id2name(t[c])],u=p[n],g=0,h;g<u.length;g++)if(h=u[g],!d[h]&&(s(e,h),d[h]=1,l))return}t=t?t:ge.listIds(e);var r=e._fullLayout;a("annotations","drawOne","_annIndices"),a("shapes","drawOne","_shapeIndices"),a("images","draw","_imgIndices",!0)};var fe=ge.getDataConversions=function(e,t,o,n){var l="x"===o||"y"===o||"z"===o?o:n,s;if(!Array.isArray(l))s=ge.getFromTrace(e,t,l);else if(s={type:he(n),_categories:[]},ge.setConvert(s),"category"===s.type)for(var d=0;d<n.length;d++)s.d2c(n[d]);return s?{d2c:s.d2c,c2d:s.c2d}:"ids"===l?{d2c:r,c2d:r}:{d2c:a,c2d:a}};ge.getDataToCoordFunc=function(e,t,a,r){return fe(e,t,a,r).d2c},ge.counterLetter=function(e){var t=e.charAt(0);return"x"===t?"y":"y"===t?"x":void 0},ge.minDtick=function(e,t,a,r){-1===["log","category","multicategory"].indexOf(e.type)&&r?e._minDtick===void 0?(e._minDtick=t,e._forceTick0=a):e._minDtick&&(2e-6>(e._minDtick/t+1e-6)%1&&2e-6>((a-e._forceTick0)/t%1+1.000001)%1?(e._minDtick=t,e._forceTick0=a):(2e-6<(t/e._minDtick+1e-6)%1||2e-6<((a-e._forceTick0)/e._minDtick%1+1.000001)%1)&&(e._minDtick=0)):e._minDtick=0},ge.saveRangeInitial=function(e,t){for(var a=ge.list(e,"",!0),r=!1,o=0;o<a.length;o++){var n=a[o],l=n._rangeInitial===void 0,s=l||n.range[0]!==n._rangeInitial[0]||n.range[1]!==n._rangeInitial[1];(l&&!1===n.autorange||t&&s)&&(n._rangeInitial=n.range.slice(),r=!0)}return r},ge.saveShowSpikeInitial=function(e,t){for(var a=ge.list(e,"",!0),r=!1,o="on",n=0;n<a.length;n++){var l=a[n],s=void 0===l._showSpikeInitial,d=s||l.showspikes!==l._showspikes;(s||t&&d)&&(l._showSpikeInitial=l.showspikes,r=!0),"on"!==o||l.showspikes||(o="off")}return e._fullLayout._cartesianSpikesEnabled=o,r},ge.autoBin=function(e,t,a,r,n,l){var s=Z.aggNums(Math.min,null,e),d=Z.aggNums(Math.max,null,e);if("category"===t.type||"multicategory"===t.type)return{start:s-.5,end:d+.5,size:va(1,V(l)||1),_dataSpan:d-s};n||(n=t.calendar);var c;if(c="log"===t.type?{type:"linear",range:[s,d]}:{type:t.type,range:Z.simpleMap([s,d],t.c2r,0,n),calendar:n},ge.setConvert(c),l=l&&te.dtick(l,c.type),l)c.dtick=l,c.tick0=te.tick0(void 0,c.type,n);else{var p;if(a)p=(d-s)/a;else{var u=Z.distinctVals(e),g=ya(10,ba(P(u.minDiff)/I)),h=g*Z.roundUp(u.minDiff/g,[.9,1.9,4.9,9.9],!0);p=va(h,2*Z.stdev(e)/ya(e.length,r?.25:.4)),Y(p)||(p=1)}ge.autoTicks(c,p)}var m=c.dtick,y=ge.tickIncrement(ge.tickFirst(c),m,"reverse",n),f,x;if("number"==typeof m)y=o(y,e,c,s,d),x=1+ba((d-y)/m),f=y+x*m;else for("M"===c.dtick.charAt(0)&&(y=i(y,e,m,s,n)),f=y,x=0;f<=d;)f=ge.tickIncrement(f,m,!1,n),x++;return{start:t.c2r(y,0,n),end:t.c2r(f,0,n),size:m,_dataSpan:d-s}},ge.prepTicks=function(e){var t=Z.simpleMap(e.range,e.r2l);if("auto"===e.tickmode||!e.dtick){var a=e.nticks,r;a||("category"===e.type||"multicategory"===e.type?(r=e.tickfont?1.2*(e.tickfont.size||12):15,a=e._length/r):(r="y"===e._id.charAt(0)?40:80,a=Z.constrain(e._length/r,4,9)+1),"radialaxis"===e._name&&(a*=2)),"array"===e.tickmode&&(a*=100),ge.autoTicks(e,_a(t[1]-t[0])/a),0<e._minDtick&&e.dtick<2*e._minDtick&&(e.dtick=e._minDtick,e.tick0=e.l2r(e._forceTick0))}e.tick0||(e.tick0="date"===e.type?"2000-01-01":0),"date"===e.type&&.1>e.dtick&&(e.dtick=.1),s(e)},ge.calcTicks=function(e){ge.prepTicks(e);var t=Z.simpleMap(e.range,e.r2l);if("array"===e.tickmode)return n(e);e._tmin=ge.tickFirst(e);var a=1.0001*t[0]-1e-4*t[1],r=1.0001*t[1]-1e-4*t[0],o=t[1]<t[0];if(e._tmin<a!==o)return[];var l=[];("category"===e.type||"multicategory"===e.type)&&(r=o?va(-.5,r):ea(e._categories.length-.5,r));for(var s="log"===e.type&&!(Y(e.dtick)||"L"===e.dtick.charAt(0)),d=null,c=va(1e3,e._length||0),p=e._tmin;(o?p>=r:p<=r)&&!(l.length>c||p===d);p=ge.tickIncrement(p,e.dtick,o,e.calendar)){d=p;var u=!1;s&&p!==(0|p)&&(u=!0),l.push({minor:u,value:p})}G(e)&&360===_a(t[1]-t[0])&&l.pop(),e._tmax=(l[l.length-1]||{}).value,e._prevDateHead="",e._inCalcTicks=!0;for(var g=Array(l.length),h=0;h<l.length;h++)g[h]=ge.tickText(e,l[h].value,!1,l[h].minor);return e._inCalcTicks=!1,g};var xe=[2,5,10],_e=[1,2,3,6,12],be=[1,2,5,10,15,30],ve=[1,2,3,7,14],ke=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],we=[-.301,0,.301,.699,1],Te=[15,30,45,90,180];ge.autoTicks=function(e,t){function a(e){return ya(e,ba(P(t)/I))}var r;if("date"===e.type){e.tick0=Z.dateTick0(e.calendar);var o=2*t;o>re?(t/=re,r=a(10),e.dtick="M"+12*l(t,r,xe)):o>oe?(t/=oe,e.dtick="M"+l(t,1,_e)):o>ie?(e.dtick=l(t,ie,ve),e.tick0=Z.dateTick0(e.calendar,!0)):o>ne?e.dtick=l(t,ne,_e):o>le?e.dtick=l(t,le,be):o>se?e.dtick=l(t,se,be):(r=a(10),e.dtick=l(t,r,xe))}else if("log"===e.type){e.tick0=0;var i=Z.simpleMap(e.range,e.r2l);if(.7<t)e.dtick=M(t);else if(1>_a(i[1]-i[0])){var n=1.5*_a((i[1]-i[0])/t);t=_a(ya(10,i[1])-ya(10,i[0]))/n,r=a(10),e.dtick="L"+l(t,r,xe)}else e.dtick=.3<t?"D2":"D1"}else"category"===e.type||"multicategory"===e.type?(e.tick0=0,e.dtick=M(va(t,1))):G(e)?(e.tick0=0,r=1,e.dtick=l(t,r,Te)):(e.tick0=0,r=a(10),e.dtick=l(t,r,xe));if(0===e.dtick&&(e.dtick=1),!Y(e.dtick)&&"string"!=typeof e.dtick){var s=e.dtick;throw e.dtick=1,"ax.dtick error: "+(s+"")}},ge.tickIncrement=function(e,t,a,r){var o=a?-1:1;if(Y(t))return e+o*t;var i=t.charAt(0),n=o*+t.substr(1);if("M"===i)return Z.incrementMonth(e,n,r);if("L"===i)return P(ya(10,e)+n)/I;if("D"===i){var l="D2"===t?we:ke,s=e+.01*o,d=Z.roundUp(Z.mod(s,1),l,a);return ba(s)+P(q.round(ya(10,d),1))/I}throw"unrecognized dtick "+(t+"")},ge.tickFirst=function(e){var t=e.r2l||Number,a=Z.simpleMap(e.range,t),r=a[1]<a[0],o=r?ba:M,i=1.0001*a[0]-1e-4*a[1],n=e.dtick,l=t(e.tick0);if(Y(n)){var s=o((i-l)/n)*n+l;return("category"===e.type||"multicategory"===e.type)&&(s=Z.constrain(s,0,e._categories.length-1)),s}var d=n.charAt(0),c=+n.substr(1);if("M"===d){for(var p=0,u=l,g,h,m;10>p;){if(g=ge.tickIncrement(u,n,r,e.calendar),0>=(g-i)*(u-i))return r?ea(u,g):va(u,g);h=(i-(u+g)/2)/(g-u),m=d+(_a(V(h))||1)*c,u=ge.tickIncrement(u,m,0>h?!r:r,e.calendar),p++}return Z.error("tickFirst did not converge",e),u}if("L"===d)return P(o((ya(10,i)-l)/c)*c+l)/I;if("D"===d){var y="D2"===n?we:ke,f=Z.roundUp(Z.mod(i,1),y,r);return ba(i)+P(q.round(ya(10,f),1))/I}throw"unrecognized dtick "+(n+"")},ge.tickText=function(e,t,a,r){function o(r){if(void 0===r)return!0;if(a)return"none"===r;var o={first:e._tmin,last:e._tmax}[r];return"all"!==r&&t!==o}var n=d(e,t),l="array"===e.tickmode,s=a||l,y=e.type,f="category"===y?e.d2l_noadd:e.d2l,x;if(l&&Array.isArray(e.ticktext)){var _=Z.simpleMap(e.range,e.r2l),b=_a(_[1]-_[0])/1e4;for(x=0;x<e.ticktext.length&&!(_a(t-f(e.tickvals[x]))<b);x++);if(x<e.ticktext.length)return n.text=e.ticktext[x]+"",n}var v=a?"never":"none"!==e.exponentformat&&o(e.showexponent)?"hide":"";if("date"===y?c(e,n,a,s):"log"===y?p(e,n,a,s,v):"category"===y?u(e,n):"multicategory"===y?g(e,n,a):G(e)?m(e,n,a,s,v):h(e,n,a,s,v),r||(e.tickprefix&&!o(e.showtickprefix)&&(n.text=e.tickprefix+n.text),e.ticksuffix&&!o(e.showticksuffix)&&(n.text+=e.ticksuffix)),"boundaries"===e.tickson||e.showdividers){var k=function(t){var a=e.l2p(t);return 0<=a&&a<=e._length?t:null};n.xbnd=[k(n.x-.5),k(n.x+e.dtick-.5)]}return n},ge.hoverLabelText=function(e,t,a){if(a!==ce&&a!==t)return ge.hoverLabelText(e,t)+" - "+ge.hoverLabelText(e,a);var r="log"===e.type&&0>=t,o=ge.tickText(e,e.c2l(r?-t:t),"hover").text;return r?0===t?"0":de+o:o};var Ae=["f","p","n","\u03BC","m","","k","M","G","T"];ge.getTickFormat=function(e){function t(e){return"string"==typeof e?+e.replace("M","")*oe:e}function a(e,t){var a=["L","D"];if(typeof e==typeof t){if("number"==typeof e)return e-t;var r=a.indexOf(e.charAt(0)),o=a.indexOf(t.charAt(0));return r===o?+e.replace(/(L|D)/g,"")-+t.replace(/(L|D)/g,""):r-o}return"number"==typeof e?1:-1}function r(e,t,a){var r=a||function(e){return e},o=t[0],i=t[1];return(!o&&"number"!=typeof o||r(o)<=r(e))&&(!i&&"number"!=typeof i||r(i)>=r(e))}function o(e,t){var r=null===t[0],o=null===t[1],i=0<=a(e,t[0]),n=0>=a(e,t[1]);return(r||i)&&(o||n)}var n,l,s;if(e.tickformatstops&&0<e.tickformatstops.length)switch(e.type){case"date":case"linear":{for(n=0;n<e.tickformatstops.length;n++)if(s=e.tickformatstops[n],s.enabled&&r(e.dtick,s.dtickrange,t)){l=s;break}break}case"log":{for(n=0;n<e.tickformatstops.length;n++)if(s=e.tickformatstops[n],s.enabled&&o(e.dtick,s.dtickrange)){l=s;break}break}default:}return l?l.value:e.tickformat},ge.getSubplots=function(e,t){var a=e._fullLayout._subplots,r=a.cartesian.concat(a.gl2d||[]),o=t?ge.findSubplotsWithAxis(r,t):r;return o.sort(function(e,t){var a=e.substr(1).split("y"),r=t.substr(1).split("y");return a[0]===r[0]?+a[1]-+r[1]:+a[0]-+r[0]}),o},ge.findSubplotsWithAxis=function(e,t){for(var a=new RegExp("x"===t._id.charAt(0)?"^"+t._id+"y":t._id+"$"),r=[],o=0,n;o<e.length;o++)n=e[o],a.test(n)&&r.push(n);return r},ge.makeClipPaths=function(e){var t=e._fullLayout;if(!t._hasOnlyLargeSploms){var a={_offset:0,_length:t.width,_id:""},r={_offset:0,_length:t.height,_id:""},o=ge.list(e,"x",!0),n=ge.list(e,"y",!0),l=[],s,d;for(s=0;s<o.length;s++)for(l.push({x:o[s],y:r}),d=0;d<n.length;d++)0===s&&l.push({x:a,y:n[d]}),l.push({x:o[s],y:n[d]});var c=t._clips.selectAll(".axesclip").data(l,function(e){return e.x._id+e.y._id});c.enter().append("clipPath").classed("axesclip",!0).attr("id",function(e){return"clip"+t._uid+e.x._id+e.y._id}).append("rect"),c.exit().remove(),c.each(function(e){q.select(this).select("rect").attr({x:e.x._offset||0,y:e.y._offset||0,width:e.x._length||1,height:e.y._length||1})})}},ge.draw=function(e,t,a){var r=e._fullLayout;"redraw"===t&&r._paper.selectAll("g.subplot").each(function(e){var t=e[0],a=r._plots[t],o=a.xaxis,i=a.yaxis;a.xaxislayer.selectAll("."+o._id+"tick").remove(),a.yaxislayer.selectAll("."+i._id+"tick").remove(),a.xaxislayer.selectAll("."+o._id+"tick2").remove(),a.yaxislayer.selectAll("."+i._id+"tick2").remove(),a.xaxislayer.selectAll("."+o._id+"divider").remove(),a.yaxislayer.selectAll("."+i._id+"divider").remove(),a.gridlayer&&a.gridlayer.selectAll("path").remove(),a.zerolinelayer&&a.zerolinelayer.selectAll("path").remove(),r._infolayer.select(".g-"+o._id+"title").remove(),r._infolayer.select(".g-"+i._id+"title").remove()});var o=t&&"redraw"!==t?t:ge.listIds(e);return Z.syncOrAsync(o.map(function(t){return function(){if(t){var r=ge.getFromId(e,t),o=ge.drawOne(e,r,a);return r._r=r.range.slice(),r._rl=Z.simpleMap(r._r,r.r2l),o}}}))},ge.drawOne=function(e,t,a){function r(e,t){e[0]=ea(e[0],t[0]),e[1]=va(e[1],t[1])}function o(){if(t.showticklabels){var a=e.getBoundingClientRect(),o=x.node().getBoundingClientRect();t._boundingBox={width:o.width,height:o.height,left:o.left-a.left,right:o.right-a.left,top:o.top-a.top,bottom:o.bottom-a.top}}else{var n=c._size,l;"x"===u?(l="free"===t.anchor?n.t+n.h*(1-t.position):n.t+n.h*(1-t._anchorAxis.domain[{bottom:0,top:1}[t.side]]),t._boundingBox={top:l,bottom:l,left:t._offset,right:t._offset+t._length,width:t._length,height:0}):(l="free"===t.anchor?n.l+n.w*t.position:n.l+n.w*t._anchorAxis.domain[{left:0,right:1}[t.side]],t._boundingBox={left:l,right:l,bottom:t._offset+t._length,top:t._offset,height:t._length,width:0})}if(_){for(var s=t._counterSpan=[1/0,-Infinity],d=0;d<_.length;d++){var p=c._plots[_[d]],g=p["x"===u?"yaxis":"xaxis"];r(s,[g._offset,g._offset+g._length])}"free"===t.anchor&&r(s,"x"===u?[t._boundingBox.bottom,t._boundingBox.top]:[t._boundingBox.right,t._boundingBox.left])}}function n(){var a=t.side.charAt(0),r,o;if(re&&(o=X.getComponentMethod("rangeslider","autoMarginOpts")(e,t)),W.autoMargin(e,F(t),o),t.automargin&&(!re||"b"!==a)){r={x:0,y:0,r:0,l:0,t:0,b:0};var i=t._boundingBox,n=C(e,t),l,s;switch(u+a){case"xb":l=0,s=i.top-n,r[a]=i.height;break;case"xt":l=1,s=n-i.bottom,r[a]=i.height;break;case"yl":l=0,s=n-i.right,r[a]=i.width;break;case"yr":l=1,s=i.left-n,r[a]=i.width;}if(r[g]="free"===t.anchor?t.position:t._anchorAxis.domain[l],0<r[a]&&(r[a]+=s),t.title.text!==c._dfltTitle[u]&&(r[a]+=t.title.font.size),"x"===u&&0<i.width){var d=i.right-(t._offset+t._length);0<d&&(r.x=1,r.r=d);var p=t._offset-i.left;0<p&&(r.x=0,r.l=p)}else if("y"===u&&0<i.height){var h=i.bottom-(t._offset+t._length);0<h&&(r.y=0,r.b=h);var m=t._offset-i.top;0<m&&(r.y=1,r.t=m)}}W.autoMargin(e,j(t),r)}a=a||{};var l,s,d;t.setScale();var c=e._fullLayout,p=t._id,u=p.charAt(0),g=ge.counterLetter(p),h=t._mainSubplot,m=t._mainLinePosition,y=t._mainMirrorPosition,f=c._plots[h],x=f[u+"axislayer"],_=t._subplotsWith,b=t._vals=ge.calcTicks(t),A=[t.mirror,m,y].join("_");for(l=0;l<b.length;l++)b[l].axInfo=A;if(t.visible){t._selections={},t._tickAngles={};var E=ge.makeTransFn(t),I,z;if("boundaries"===t.tickson){var P=v(t,b);z=ge.clipEnds(t,P),I="inside"===t.ticks?z:P}else z=ge.clipEnds(t,b),I="inside"===t.ticks?z:b;var D=t._gridVals=z,O=w(t,b);if(!c._hasOnlyLargeSploms){var R={};for(l=0;l<_.length;l++){s=_[l],d=c._plots[s];var M=d[g+"axis"],B=M._mainAxis._id;if(!R[B]){R[B]=1;var N="x"===u?"M0,"+M._offset+"v"+M._length:"M"+M._offset+",0h"+M._length;ge.drawGrid(e,t,{vals:D,counterAxis:M,layer:d.gridlayer.select("."+p),path:N,transFn:E}),ge.drawZeroLine(e,t,{counterAxis:M,layer:d.zerolinelayer,path:N,transFn:E})}}}var V=ge.getTickSigns(t),U=[];if(t.ticks){var H=ge.makeTickPath(t,m,V[2]),G,q;t._anchorAxis&&t.mirror&&!0!==t.mirror?(G=ge.makeTickPath(t,y,V[3]),q=H+G):(G="",q=H);var Y;if(t.showdividers&&"outside"===t.ticks&&"boundaries"===t.tickson){var K={};for(l=0;l<O.length;l++)K[O[l].x]=1;Y=function(e){return K[e.x]?G:q}}else Y=q;ge.drawTicks(e,t,{vals:I,layer:x,path:Y,transFn:E}),U=Object.keys(t._linepositions||{})}for(l=0;l<U.length;l++){s=U[l],d=c._plots[s];var J=t._linepositions[s]||[],Q=ge.makeTickPath(t,J[0],V[0])+ge.makeTickPath(t,J[1],V[1]);ge.drawTicks(e,t,{vals:I,layer:d[u+"axislayer"],path:Q,transFn:E})}var $=[function(){return ge.drawLabels(e,t,{vals:b,layer:x,transFn:E,labelFns:ge.makeLabelFns(t,m)})}];if("multicategory"===t.type){var ee=0,te={x:2,y:10}[u],ae=V[2]*("inside"===t.ticks?-1:1);$.push(function(){return ee+=T(t,p+"tick")+te,ee+=t._tickAngles[p+"tick"]?t.tickfont.size*ue:0,ge.drawLabels(e,t,{vals:k(t,b),layer:x,cls:p+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:E,labelFns:ge.makeLabelFns(t,m+ee*ae)})}),$.push(function(){return ee+=T(t,p+"tick2"),t._labelLength=ee,S(e,t,{vals:O,layer:x,path:ge.makeTickPath(t,m,ae,ee),transFn:E})})}var re=X.getComponentMethod("rangeslider","isVisible")(t);return $.push(o,n),a.skipTitle||re&&t._boundingBox&&"bottom"===t.side||$.push(function(){return L(e,t)}),Z.syncOrAsync($)}},ge.getTickSigns=function(e){var t=e._id.charAt(0),a={x:"top",y:"right"}[t],r=e.side===a?1:-1,o=[-1,1,r,-r];return"inside"!==e.ticks==("x"===t)&&(o=o.map(function(e){return-e})),o},ge.makeTransFn=function(e){var t=e._id.charAt(0),a=e._offset;return"x"===t?function(t){return"translate("+(a+e.l2p(t.x))+",0)"}:function(t){return"translate(0,"+(a+e.l2p(t.x))+")"}},ge.makeTickPath=function(e,t,a,r){r=r===void 0?e.ticklen:r;var o=e._id.charAt(0),i=(e.linewidth||1)/2;return"x"===o?"M0,"+(t+i*a)+"v"+r*a:"M"+(t+i*a)+",0h"+r*a},ge.makeLabelFns=function(e,t,a){var r=e._id.charAt(0),o="boundaries"!==e.tickson&&"outside"===e.ticks,i=0,n=0;if(o&&(i+=e.ticklen),a&&"outside"===e.ticks){var l=Z.deg2rad(a);i=e.ticklen*R(l)+1,n=e.ticklen*De(l)}e.showticklabels&&(o||e.showline)&&(i+=.2*e.tickfont.size),i+=(e.linewidth||1)/2;var s={labelStandoff:i,labelShift:n},c,p,u,g;return"x"===r?(g="bottom"===e.side?1:-1,c=n*g,p=t+i*g,u="bottom"===e.side?1:-.2,s.xFn=function(e){return e.dx+c},s.yFn=function(e){return e.dy+p+e.fontSize*u},s.anchorFn=function(e,t){return Y(t)&&0!==t&&180!==t?0>t*g?"end":"start":"middle"},s.heightFn=function(t,r,a){return-60>r||60<r?-.5*a:"top"===e.side?-a:0}):"y"===r&&(g="right"===e.side?1:-1,c=i,p=-n*g,u=90===_a(e.tickangle)?.5:0,s.xFn=function(e){return e.dx+t+(c+e.fontSize*u)*g},s.yFn=function(e){return e.dy+p+e.fontSize*pe},s.anchorFn=function(t,r){return Y(r)&&90===_a(r)?"middle":"right"===e.side?"start":"end"},s.heightFn=function(t,r,o){return r*="left"===e.side?1:-1,-30>r?-o:30>r?-.5*o:0}),s},ge.drawTicks=function(e,t,a){a=a||{};var r=t._id+"tick",o=a.layer.selectAll("path."+r).data(t.ticks?a.vals:[],A);o.exit().remove(),o.enter().append("path").classed(r,1).classed("ticks",1).classed("crisp",!1!==a.crisp).call(Q.stroke,t.tickcolor).style("stroke-width",$.crispRound(e,t.tickwidth,1)+"px").attr("d",a.path),o.attr("transform",a.transFn)},ge.drawGrid=function(e,t,a){a=a||{};var r=t._id+"grid",o=a.vals,n=a.counterAxis;if(!1===t.showgrid)o=[];else if(n&&ge.shouldShowZeroLine(e,t,n))for(var l="array"===t.tickmode,s=0,d;s<o.length;s++)if(d=o[s].x,l?!d:_a(d)<t.dtick/100)if(o=o.slice(0,s).concat(o.slice(s+1)),l)s--;else break;var c=a.layer.selectAll("path."+r).data(o,A);c.exit().remove(),c.enter().append("path").classed(r,1).classed("crisp",!1!==a.crisp),t._gw=$.crispRound(e,t.gridwidth,1),c.attr("transform",a.transFn).attr("d",a.path).call(Q.stroke,t.gridcolor||"#ddd").style("stroke-width",t._gw+"px"),"function"==typeof a.path&&c.attr("d",a.path)},ge.drawZeroLine=function(e,t,a){a=a||a;var r=t._id+"zl",o=ge.shouldShowZeroLine(e,t,a.counterAxis),i=a.layer.selectAll("path."+r).data(o?[{x:0,id:t._id}]:[]);i.exit().remove(),i.enter().append("path").classed(r,1).classed("zl",1).classed("crisp",!1!==a.crisp).each(function(){a.layer.selectAll("path").sort(function(e,t){return me.idSort(e.id,t.id)})}),i.attr("transform",a.transFn).attr("d",a.path).call(Q.stroke,t.zerolinecolor||Q.defaultLine).style("stroke-width",$.crispRound(e,t.zerolinewidth,t._gw||1)+"px")},ge.drawLabels=function(e,t,a){function r(e,t){e.each(function(e){var r=q.select(this),o=r.select(".text-math-group"),i=c.anchorFn(e,t),n=a.transFn.call(r.node(),e)+(Y(t)&&0!=+t?" rotate("+t+","+c.xFn(e)+","+(c.yFn(e)-e.fontSize/2)+")":""),l=K.lineCount(r),s=ue*e.fontSize,d=c.heightFn(e,Y(t)?+t:0,(l-1)*s);if(d&&(n+=" translate(0, "+d+")"),o.empty())r.select("text").attr({transform:n,"text-anchor":i});else{var p=$.bBox(o.node()).width,u=p*{end:-.5,start:.5}[i];o.attr("transform",n+(u?"translate("+u+",0)":""))}})}function o(){r(g,p);var e=null;if(s.length&&"x"===n&&!Y(p)&&("log"!==t.type||"D"!==(t.dtick+"").charAt(0))){e=0;var o=0,c=[],u;if(g.each(function(e){o=va(o,e.fontSize);var a=t.l2p(e.x),r=O(this),i=$.bBox(r.node());c.push({top:0,bottom:10,height:10,left:a-i.width/2,right:a+i.width/2+2,width:i.width+2})}),("boundaries"===t.tickson||t.showdividers)&&!a.secondary){var d=2;for(t.ticks&&(d+=t.tickwidth/2),u=0;u<c.length;u++){var h=s[u].xbnd,m=c[u];if(null!==h[0]&&m.left-t.l2p(h[0])<d||null!==h[1]&&t.l2p(h[1])-m.right<d){e=90;break}}}else{var y=s.length,f=_a((s[y-1].x-s[0].x)*t._m)/(y-1),x=f<2.5*o||"multicategory"===t.type;for(u=0;u<c.length-1;u++)if(Z.bBoxIntersect(c[u],c[u+1])){e=x?90:30;break}}e&&r(g,e)}t._tickAngles&&(t._tickAngles[l]=null===e?Y(p)?p:0:e)}a=a||{};var i=t._id,n=i.charAt(0),l=a.cls||i+"tick",s=a.vals,c=a.labelFns,p=a.secondary?0:t.tickangle,u=(t._tickAngles||{})[l],g=a.layer.selectAll("g."+l).data(t.showticklabels?s:[],A),h=[];g.enter().append("g").classed(l,1).append("text").attr("text-anchor","middle").each(function(t){var a=q.select(this),o=e._promises.length;a.call(K.positionText,c.xFn(t),c.yFn(t)).call($.font,t.font,t.fontSize,t.fontColor).text(t.text).call(K.convertToTspans,e),e._promises[o]?h.push(e._promises.pop().then(function(){r(a,p)})):r(a,p)}),g.exit().remove(),a.repositionOnUpdate&&g.each(function(e){q.select(this).select("text").call(K.positionText,c.xFn(e),c.yFn(e))}),r(g,u||p),t._selections&&(t._selections[l]=g);var m=Z.syncOrAsync([function(){return h.length&&Promise.all(h)},o]);return m&&m.then&&e._promises.push(m),m},ge.shouldShowZeroLine=function(e,t,a){var r=Z.simpleMap(t.range,t.r2l);return 0>=r[0]*r[1]&&t.zeroline&&("linear"===t.type||"-"===t.type)&&t._gridVals.length&&(E(t,0)||!z(e,t,a,r)||D(e,t))},ge.clipEnds=function(e,t){return t.filter(function(t){return E(e,t.x)})},ge.allowAutoMargin=function(e){for(var t=ge.list(e,"",!0),a=0,r;a<t.length;a++)r=t[a],r.automargin&&W.allowAutoMargin(e,j(r)),X.getComponentMethod("rangeslider","isVisible")(r)&&W.allowAutoMargin(e,F(r))},ge.swap=function(e,t){for(var a=B(e,t),r=0;r<a.length;r++)U(e,a[r].x,a[r].y)}},{"../../components/color":593,"../../components/drawing":614,"../../components/titles":681,"../../constants/alignment":688,"../../constants/numerical":695,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/plots":828,"../../registry":847,"./autorange":766,"./axis_autotype":768,"./axis_ids":770,"./clean_ticks":772,"./layout_attributes":779,"./set_convert":785,d3:163,"fast-isnumeric":225}],768:[function(e,t){"use strict";function a(e){if(!e)return!1;for(var t=0;t<e.length;t++)if(n(e[t]))return!0;return!1}function r(e,t){for(var a=va(1,(e.length-1)/1e3),r=0,o=0,s={},d=0;d<e.length;d+=a){var c=e[V(d)],p=c+"";s[p]||(s[p]=1,l.isDateTime(c,t)&&(r+=1),n(c)&&(o+=1))}return r>2*o}function o(e){for(var t=va(1,(e.length-1)/1e3),a=0,r=0,o={},n=0;n<e.length;n+=t){var d=e[V(n)],c=d+"";o[c]||(o[c]=1,"boolean"==typeof d?r++:l.cleanNumber(d)===s?"string"==typeof d&&r++:a++)}return r>2*a}function i(e){return l.isArrayOrTypedArray(e[0])&&l.isArrayOrTypedArray(e[1])}var n=e("fast-isnumeric"),l=e("../../lib"),s=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){return n=n||{},!n.noMultiCategory&&i(e)?"multicategory":r(e,t)?"date":o(e)?"category":a(e)?"linear":"-"}},{"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":225}],769:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib"),o=e("./layout_attributes"),i=e("./tick_value_defaults"),n=e("./tick_mark_defaults"),l=e("./tick_label_defaults"),s=e("./category_order_defaults"),d=e("./line_grid_defaults"),c=e("./set_convert");t.exports=function(e,t,p,u,g){var h=u.letter,m=u.font||{},y=u.splomStash||{},f=p("visible",!u.visibleDflt),x=t.type;if("date"===x){var _=a.getComponentMethod("calendars","handleDefaults");_(e,t,"calendar",u.calendar)}c(t,g);var b=!t.isValidRange(e.range);b&&u.reverseDflt&&(b="reversed");var v=p("autorange",b);v&&("linear"===x||"-"===x)&&p("rangemode"),p("range"),t.cleanRange(),s(e,t,p,u),"category"===x||u.noHover||p("hoverformat");var k=p("color"),w=k===o.color.dflt?m.color:k,T=y.label||g._dfltTitle[h];if(l(e,t,p,x,u,{pass:1}),!f)return t;p("title.text",T),r.coerceFont(p,"title.font",{family:m.family,size:V(1.2*m.size),color:w}),i(e,t,p,x),l(e,t,p,x,u,{pass:2}),n(e,t,p,u),d(e,t,p,{dfltColor:k,bgColor:u.bgColor,showGrid:u.showGrid,attributes:o}),(t.showline||t.ticks)&&p("mirror"),u.automargin&&p("automargin");var A="multicategory"===t.type;if(!u.noTickson&&("category"===t.type||A)&&(t.ticks||t.showgrid)){var S;A&&(S="boundaries"),p("tickson",S)}if(A){var C=p("showdividers");C&&(p("dividercolor"),p("dividerwidth"))}return t}},{"../../lib":719,"../../registry":847,"./category_order_defaults":771,"./layout_attributes":779,"./line_grid_defaults":781,"./set_convert":785,"./tick_label_defaults":786,"./tick_mark_defaults":787,"./tick_value_defaults":788}],770:[function(e,t,a){"use strict";var r=e("../../registry"),o=e("./constants");a.id2name=function(e){if("string"==typeof e&&e.match(o.AX_ID_PATTERN)){var t=e.substr(1);return"1"===t&&(t=""),e.charAt(0)+"axis"+t}},a.name2id=function(e){if(e.match(o.AX_NAME_PATTERN)){var t=e.substr(5);return"1"===t&&(t=""),e.charAt(0)+t}},a.cleanId=function(e,t){if(e.match(o.AX_ID_PATTERN)&&!(t&&e.charAt(0)!==t)){var a=e.substr(1).replace(/^0+/,"");return"1"===a&&(a=""),e.charAt(0)+a}},a.list=function(e,t,r){var o=e._fullLayout;if(!o)return[];var n=a.listIds(e,t),l=Array(n.length),s;for(s=0;s<n.length;s++){var d=n[s];l[s]=o[d.charAt(0)+"axis"+d.substr(1)]}if(!r){var c=o._subplots.gl3d||[];for(s=0;s<c.length;s++){var p=o[c[s]];t?l.push(p[t+"axis"]):l.push(p.xaxis,p.yaxis,p.zaxis)}}return l},a.listIds=function(e,t){var a=e._fullLayout;if(!a)return[];var r=a._subplots;return t?r[t+"axis"]:r.xaxis.concat(r.yaxis)},a.getFromId=function(e,t,r){var o=e._fullLayout;return"x"===r?t=t.replace(/y[0-9]*/,""):"y"==r&&(t=t.replace(/x[0-9]*/,"")),o[a.id2name(t)]},a.getFromTrace=function(e,t,o){var i=e._fullLayout,n=null;if(r.traceIs(t,"gl3d")){var l=t.scene;"scene"===l.substr(0,5)&&(n=i[l][o+"axis"])}else n=a.getFromId(e,t[o+"axis"]||o);return n},a.idSort=function(e,t){var a=e.charAt(0),r=t.charAt(0);return a===r?+(e.substr(1)||1)-+(t.substr(1)||1):a>r?1:-1},a.getAxisGroup=function(e,t){for(var a=e._axisMatchGroups,r=0,o;r<a.length;r++)if(o=a[r],o[t])return"g"+r;return t}},{"../../registry":847,"./constants":773}],771:[function(e,t){"use strict";function a(e,t){var a=t.dataAttr||e._id.charAt(0),r={},o,n,l;if(t.axData)o=t.axData;else for(o=[],n=0;n<t.data.length;n++){var s=t.data[n];s[a+"axis"]===e._id&&o.push(s)}for(n=0;n<o.length;n++){var d=o[n][a];for(l=0;l<d.length;l++){var c=d[l];null!==c&&c!==void 0&&(r[c]=1)}}return Object.keys(r)}t.exports=function(e,t,r,o){if("category"===t.type){var i=e.categoryarray,n=Array.isArray(i)&&0<i.length,l;n&&(l="array");var s=r("categoryorder",l),d;"array"===s&&(d=r("categoryarray")),n||"array"!==s||(s=t.categoryorder="trace"),"trace"===s?t._initialCategories=[]:"array"===s?t._initialCategories=d.slice():(d=a(t,o).sort(),"category ascending"===s?t._initialCategories=d:"category descending"==s&&(t._initialCategories=d.reverse()))}}},{}],772:[function(e,t,a){"use strict";var r=e("fast-isnumeric"),o=e("../../lib"),i=e("../../constants/numerical").ONEDAY;a.dtick=function(e,t){var a="log"===t,o="date"===t,n=o?i:1;if(!e)return n;if(r(e))return e=+e,0>=e?n:"category"===t?va(1,V(e)):o?va(.1,e):e;if("string"!=typeof e||!(o||a))return n;var l=e.charAt(0),s=e.substr(1);return s=r(s)?+s:0,0>=s||!(o&&"M"===l&&s===V(s)||a&&"L"===l||a&&"D"===l&&(1===s||2===s))?n:e},a.tick0=function(e,t,a,i){return"date"===t?o.cleanDate(e,o.dateTick0(a)):"D1"===i||"D2"===i?void 0:r(e)?+e:0}},{"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":225}],773:[function(e,t){"use strict";var a=e("../../lib/regex").counter;t.exports={idRegex:{x:a("x"),y:a("y")},attrRegex:a("[xy]axis"),xAxisMatch:a("xaxis"),yAxisMatch:a("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":735}],774:[function(e,t,a){"use strict";function r(e,t,a,r,o){var n=r[l(t)].type,s=[],d,c,p,u;for(c=0;c<a.length;c++)if(p=a[c],p!==t&&(u=r[l(p)],u.type===n))if(!u.fixedrange)s.push(p);else if("range"!==o&&u.anchor){var g=r[l(u.anchor)];g.fixedrange&&s.push(p)}for(d=0;d<e.length;d++)if(e[d][t]){var h=e[d],m=[];for(c=0;c<s.length;c++)p=s[c],h[p]||m.push(p);return{linkableAxes:m,thisGroup:h}}return{linkableAxes:s,thisGroup:null}}function o(e,t,a,r,o){var n,l,s,d,c;null===t?(t={},t[a]=1,c=e.length,e.push(t)):c=e.indexOf(t);var p=Object.keys(t);for(n=0;n<e.length;n++)if(s=e[n],n!==c&&s[r]){var u=s[r];for(l=0;l<p.length;l++)d=p[l],s[d]=u*o*t[d];return void e.splice(c,1)}if(1!==o)for(l=0;l<p.length;l++)t[p[l]]*=o;t[r]=1}function i(e,t){var a=e._inputDomain,r=u[e.constraintoward],o=a[0]+(a[1]-a[0])*r;e.domain=e._input.domain=[o+(a[0]-o)/t,o+(a[1]-o)/t],e.setScale()}var n=e("../../lib"),l=e("./axis_ids").id2name,s=e("./scale_zoom"),d=e("./autorange").makePadFn,c=e("./autorange").concatExtremes,p=e("../../constants/numerical").ALMOST_EQUAL,u=e("../../constants/alignment").FROM_BL;a.handleConstraintDefaults=function(e,t,a,i,l){var s=l._axisConstraintGroups,d=l._axisMatchGroups,c=t._id,p=c.charAt(0),u=((l._splomAxes||{})[p]||{})[c]||{},g=t._id,h=g.charAt(0),m=a("constrain");n.coerce(e,t,{constraintoward:{valType:"enumerated",values:"x"===h?["left","center","right"]:["bottom","middle","top"],dflt:"x"===h?"center":"middle"}},"constraintoward");var y,f;(e.matches||u.matches)&&!t.fixedrange&&(f=r(d,g,i,l),y=n.coerce(e,t,{matches:{valType:"enumerated",values:f.linkableAxes||[],dflt:u.matches}},"matches"));var x,_;if(y||!e.scaleanchor||t.fixedrange&&"domain"!==m||(_=r(s,g,i,l,m),x=n.coerce(e,t,{scaleanchor:{valType:"enumerated",values:_.linkableAxes||[]}},"scaleanchor")),y?(delete t.constrain,o(d,f.thisGroup,g,y,1)):-1!==i.indexOf(e.matches)&&n.warn("ignored "+t._name+".matches: \""+e.matches+"\" to avoid either an infinite loop or because the target axis has fixed range."),x){var b=a("scaleratio");b||(b=t.scaleratio=1),o(s,_.thisGroup,g,x,b)}else-1!==i.indexOf(e.scaleanchor)&&n.warn("ignored "+t._name+".scaleanchor: \""+e.scaleanchor+"\" to avoid either an infinite loop and possibly inconsistent scaleratios, or because the target axis has fixed range or this axis declares a *matches* constraint.")},a.enforce=function(e){var t=e._fullLayout,a=t._axisConstraintGroups||[],r,o,n,u,g,h,y;for(r=0;r<a.length;r++){var f=a[r],x=Object.keys(f),_=1/0,b=0,v=1/0,w={},T={},A=!1;for(o=0;o<x.length;o++)n=x[o],T[n]=u=t[l(n)],u._inputDomain?u.domain=u._inputDomain.slice():u._inputDomain=u.domain.slice(),u._inputRange||(u._inputRange=u.range.slice()),u.setScale(),w[n]=g=_a(u._m)/f[n],_=ea(_,g),"domain"!==u.constrain&&u._constraintShrinkable||(v=ea(v,g)),delete u._constraintShrinkable,b=va(b,g),"domain"===u.constrain&&(A=!0);if(!(_>p*b)||A)for(o=0;o<x.length;o++)if(n=x[o],g=w[n],u=T[n],h=u.constrain,g!==v||"domain"===h)if(y=g/v,"range"===h)s(u,y);else{var S=u._inputDomain,C=(u.domain[1]-u.domain[0])/(S[1]-S[0]),L=(u.r2l(u.range[1])-u.r2l(u.range[0]))/(u.r2l(u._inputRange[1])-u.r2l(u._inputRange[0]));if(y/=C,1>y*L){u.domain=u._input.domain=S.slice(),s(u,y);continue}if(1>L&&(u.range=u._input.range=u._inputRange.slice(),y*=L),u.autorange){var E=u.r2l(u.range[0]),I=u.r2l(u.range[1]),z=(E+I)/2,P=z,D=z,O=_a(I-z),R=z-1.0001*(O*y),M=z+1.0001*(O*y),F=d(u);i(u,y);var B=_a(u._m),m=c(e,u),N=m.min,V=m.max,U,H;for(H=0;H<N.length;H++)U=N[H].val-F(N[H])/B,U>R&&U<P&&(P=U);for(H=0;H<V.length;H++)U=V[H].val+F(V[H])/B,U<M&&U>D&&(D=U);var G=(D-P)/(2*O);y/=G,P=u.l2r(P),D=u.l2r(D),u.range=u._input.range=E<I?[P,D]:[D,P]}i(u,y)}}},a.clean=function(e,t){if(t._inputDomain){for(var a=!1,r=t._id,o=e._fullLayout._axisConstraintGroups,i=0;i<o.length;i++)if(o[i][r]){a=!0;break}a&&"domain"===t.constrain||(t._input.domain=t.domain=t._inputDomain,delete t._inputDomain)}}},{"../../constants/alignment":688,"../../constants/numerical":695,"../../lib":719,"./autorange":766,"./axis_ids":770,"./scale_zoom":783}],775:[function(e,t){"use strict";function a(e,t,a,r){var o=L.ensureSingle(e.draglayer,t,a,function(t){t.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",e.id)});return o.call(j,r),o.node()}function r(e,t,r,o,i,n,l){var s=a(e,"rect",t,r);return T.select(s).call(D.setRect,o,i,n,l),s}function o(e,t){for(var a=0;a<e.length;a++)if(!e[a].fixedrange)return t;return""}function i(e,t){var a=e.range[t],r=_a(a-e.range[1-t]),o;return"date"===e.type?a:"log"===e.type?(o=M(va(0,-P(r)/I))+3,T.format("."+o+"g")(ya(10,a))):(o=ba(P(_a(a))/I)-ba(P(r)/I)+4,T.format("."+(o+"g"))(a))}function n(e,t,a,r,o){for(var l=0,s;l<e.length;l++)if(s=e[l],!s.fixedrange){var d=s._rl[0],c=s._rl[1]-d;r[s._name+".range[0]"]=s.l2r(d+c*t),r[s._name+".range[1]"]=s.l2r(d+c*a)}if(o&&o.length){var p=(t+(1-a))/2;n(o,p,1-p,r,[])}}function l(e,t){for(var a=0,r;a<e.length;a++)r=e[a],r.fixedrange||(r.range=[r.l2r(r._rl[0]-t/r._m),r.l2r(r._rl[1]-t/r._m)])}function s(e){return 1-(0<=e?ea(e,.9):1/(1/va(e,-.3)+3.222))}function d(e,t,a){return e?"nsew"===e?a?"":"pan"===t?"move":"crosshair":e.toLowerCase()+"-resize":"pointer"}function c(e,t,a,r,o){return e.append("path").attr("class","zoombox").style({fill:.2<t?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+a+", "+r+")").attr("d",o+"Z")}function p(e,t,a){return e.append("path").attr("class","zoombox-corners").style({fill:z.background,stroke:z.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+t+", "+a+")").attr("d","M0,0Z")}function u(e,t,a,r,o,i){e.attr("d",r+"M"+a.l+","+a.t+"v"+a.h+"h"+a.w+"v-"+a.h+"h-"+a.w+"Z"),g(e,t,o,i)}function g(e,t,a,r){a||(e.transition().style("fill",.2<r?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),t.transition().style("opacity",1).duration(200))}function h(e){T.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function y(e){J&&e.data&&e._context.showTips&&(L.notifier(L._(e,"Double-click to zoom back out"),"long"),J=!1)}function f(e){return"lasso"===e||"select"===e}function x(e,t){return"M"+(e.l-.5)+","+(t-K-.5)+"h-3v"+(2*K+1)+"h3ZM"+(e.r+.5)+","+(t-K-.5)+"h3v"+(2*K+1)+"h-3Z"}function _(e,t){return"M"+(t-K-.5)+","+(e.t-.5)+"v-3h"+(2*K+1)+"v3ZM"+(t-K-.5)+","+(e.b+.5)+"v3h"+(2*K+1)+"v-3Z"}function b(e){var t=ba(ea(e.b-e.t,e.r-e.l,K)/2);return"M"+(e.l-3.5)+","+(e.t-.5+t)+"h3v"+-t+"h"+t+"v-3h-"+(t+3)+"ZM"+(e.r+3.5)+","+(e.t-.5+t)+"h-3v"+-t+"h"+-t+"v-3h"+(t+3)+"ZM"+(e.r+3.5)+","+(e.b+.5-t)+"h-3v"+t+"h"+-t+"v3h"+(t+3)+"ZM"+(e.l-3.5)+","+(e.b+.5-t)+"h3v"+t+"h"+t+"v3h-"+(t+3)+"Z"}function v(e,t,a,r){for(var o=!1,n={},l={},s=0,d,c,p,u,g;s<t.length;s++){for(d in g=t[s],a)if(g[d]){for(p in g)("x"===p.charAt(0)?a:r)[p]||(n[p]=d);for(c in r)g[c]&&(o=!0)}for(c in r)if(g[c])for(u in g)("x"===u.charAt(0)?a:r)[u]||(l[u]=c)}o&&(L.extendFlat(n,l),l={});var h={},m=[];for(p in n){var y=H(e,p);m.push(y),h[y._id]=y}var f={},x=[];for(u in l){var _=H(e,u);x.push(_),f[_._id]=_}return{xaHash:h,yaHash:f,xaxes:m,yaxes:x,xLinks:n,yLinks:l,isSubplotConstrained:o}}function k(e,t){if(!S)void 0===e.onwheel?void 0!==e.onmousewheel&&(e.onmousewheel=t):e.onwheel=t;else{var a=e.onwheel===void 0?"mousewheel":"wheel";e._onwheel&&e.removeEventListener(a,e._onwheel),e._onwheel=t,e.addEventListener(a,t,{passive:!1})}}function w(e){var t=[];for(var a in e)t.push(e[a]);return t}var T=e("d3"),A=e("tinycolor2"),S=e("has-passive-events"),C=e("../../registry"),L=e("../../lib"),E=e("../../lib/svg_text_utils"),z=e("../../components/color"),D=e("../../components/drawing"),O=e("../../components/fx"),R=e("./axes"),j=e("../../lib/setcursor"),F=e("../../components/dragelement"),B=e("../../constants/alignment").FROM_TL,N=e("../../lib/clear_gl_canvases"),V=e("../../plot_api/subroutines").redrawReglTraces,U=e("../plots"),H=e("./axis_ids").getFromId,G=e("./select").prepSelect,q=e("./select").clearSelect,Y=e("./select").selectOnClick,W=e("./scale_zoom"),X=e("./constants"),Z=X.MINDRAG,K=X.MINZOOM,J=!0;t.exports={makeDragBox:function(t,e,a,g,S,I,z,P){function M(){if(me=e.xaxis,ye=e.yaxis,we=me._length,Te=ye._length,ve=me._offset,ke=ye._offset,fe={},fe[me._id]=me,xe={},xe[ye._id]=ye,z&&P)for(var a=e.overlays,r=0,n;r<a.length;r++){n=a[r].xaxis,fe[n._id]=n;var l=a[r].yaxis;xe[l._id]=l}_e=w(fe),be=w(xe),Ce=o(_e,P),Le=o(be,z),Ee=!Le&&!Ce,Ae=v(t,t._fullLayout._axisConstraintGroups,fe,xe),Se=v(t,t._fullLayout._axisMatchGroups,fe,xe),Ie=P||Ae.isSubplotConstrained||Se.isSubplotConstrained,ze=z||Ae.isSubplotConstrained||Se.isSubplotConstrained;var s=t._fullLayout;Pe=s._has("scattergl"),De=s._has("splom"),Oe=s._has("svg")}function j(){Fe.plotinfo.selection=!1,q(t)}function J(a,r){var o=t._fullLayout.clickmode;if(h(t),2!==a||he||ne(),ge)-1<o.indexOf("select")&&Y(r,t,_e,be,e.id,Fe),-1<o.indexOf("event")&&O.click(t,r,e.id);else if(1===a&&he){var n=z?ye:me,l="s"===z||"w"===P?0:1,s=n._name+".range["+l+"]",d=i(n,l),c="left",p="middle";if(n.fixedrange)return;z?(p="n"===z?"top":"bottom","right"===n.side&&(c="right")):"e"===P&&(c="right"),t._context.showAxisRangeEntryBoxes&&T.select(je).call(E.makeEditable,{gd:t,immediate:!0,background:t._fullLayout.paper_bgcolor,text:d+"",fill:n.tickfont?n.tickfont.color:"#444",horizontalAlign:c,verticalAlign:p}).on("edit",function(e){var a=n.d2r(e);void 0!==a&&C.call("_guiRelayout",t,s,a)})}}function Q(a,e,r){var o=je.getBoundingClientRect();He=e-o.left,Ge=r-o.top,qe={l:He,r:He,w:0,t:Ge,b:Ge,h:0},Ye=t._hmpixcount?t._hmlumcount/t._hmpixcount:A(t._fullLayout.plot_bgcolor).getLuminance(),We="M0,0H"+we+"V"+Te+"H0V0",Xe=!1,Ze="xy",Qe=!1,Ke=c(ue,Ye,ve,ke,We),Je=p(ue,ve,ke)}function $(e,a){function r(){Ze="",qe.r=qe.l,qe.t=qe.b,Je.attr("d","M0,0Z")}if(t._transitioningWithDuration)return!1;var o=va(0,ea(we,e+He)),i=va(0,ea(Te,a+Ge)),n=_a(o-He),l=_a(i-Ge);if(qe.l=ea(He,o),qe.r=va(He,o),qe.t=ea(Ge,i),qe.b=va(Ge,i),Ae.isSubplotConstrained)n>K||l>K?(Ze="xy",n/we>l/Te?(l=n*Te/we,Ge>i?qe.t=Ge-l:qe.b=Ge+l):(n=l*we/Te,He>o?qe.l=He-n:qe.r=He+n),Je.attr("d",b(qe))):r();else if(!Se.isSubplotConstrained)!Le||l<ea(va(.6*n,Z),K)?n<Z||!Ce?r():(qe.t=0,qe.b=Te,Ze="x",Je.attr("d",x(qe,Ge))):!Ce||n<ea(.6*l,K)?(qe.l=0,qe.r=we,Ze="y",Je.attr("d",_(qe,He))):(Ze="xy",Je.attr("d",b(qe)));else if(n>K||l>K){Ze="xy";var s=ea(qe.l/we,(Te-qe.b)/Te),d=va(qe.r/we,(Te-qe.t)/Te);qe.l=s*we,qe.r=d*we,qe.b=(1-s)*Te,qe.t=(1-d)*Te,Je.attr("d",b(qe))}else r();qe.w=qe.r-qe.l,qe.h=qe.b-qe.t,Ze&&(Qe=!0),t._dragged=Qe,u(Ke,Je,qe,We,Xe,Ye),ee(),t.emit("plotly_relayouting",Re),Xe=!0}function ee(){Re={},("xy"==Ze||"x"==Ze)&&(n(_e,qe.l/we,qe.r/we,Re,Ae.xaxes),oe("x",Re)),("xy"==Ze||"y"==Ze)&&(n(be,(Te-qe.b)/Te,(Te-qe.t)/Te,Re,Ae.yaxes),oe("y",Re))}function te(){return ea(qe.h,qe.w)<2*Z?h(t):void(ee(),h(t),le(),y(t))}function ae(a){function e(e,t,a){function r(t){return e.l2r(i+(t-i)*a)}if(!e.fixedrange){var o=L.simpleMap(e.range,e.r2l),i=o[0]+(o[1]-o[0])*t;e.range=o.map(r)}}if(t._context._scrollZoom.cartesian||t._fullLayout._enablescrollzoom){if(j(),t._transitioningWithDuration)return a.preventDefault(),void a.stopPropagation();M(),clearTimeout(Ne);var r=-a.deltaY;if(isFinite(r)||(r=a.wheelDelta/10),!isFinite(r))return void L.log("Did not find wheel motion attributes: ",a);var o=m(-ea(va(r,-20),20)/200),n=Ue.draglayer.select(".nsewdrag").node().getBoundingClientRect(),l=(a.clientX-n.left)/n.width,s=(n.bottom-a.clientY)/n.height,d;if(Ie){for(P||(l=.5),d=0;d<_e.length;d++)e(_e[d],l,o);oe("x"),Be[2]*=o,Be[0]+=Be[2]*l*(1/o-1)}if(ze){for(z||(s=.5),d=0;d<be.length;d++)e(be[d],s,o);oe("y"),Be[3]*=o,Be[1]+=Be[3]*(1-s)*(1/o-1)}return se(Be),ie(),t.emit("plotly_relayouting",Re),Ne=setTimeout(function(){Be=[0,0,we,Te],le()},Ve),void a.preventDefault()}}function re(e,a){function r(e,t,a){for(var r=1-t,o=0,n,l,d;o<e.length;o++)if(d=e[o],!d.fixedrange){n=d,l=d._rl[r]+(d._rl[t]-d._rl[r])/s(a/d._length);var c=d.l2r(l);!1!==c&&void 0!==c&&(d.range[t]=c)}return n._length*(n._rl[t]-l)/(n._rl[t]-n._rl[r])}if(!t._transitioningWithDuration){if(t._fullLayout._replotting=!0,"ew"===Ce||"ns"===Le)return Ce&&(l(_e,e),oe("x")),Le&&(l(be,a),oe("y")),se([Ce?-e:0,Le?-a:0,we,Te]),ie(),void t.emit("plotly_relayouting",Re);if(Ae.isSubplotConstrained&&Ce&&Le){var o="w"===Ce==("n"===Le)?1:-1,n=(e/we+o*a/Te)/2;e=n*we,a=o*n*Te}"w"===Ce?e=r(_e,0,e):"e"===Ce?e=r(_e,1,-e):!Ce&&(e=0),"n"===Le?a=r(be,1,a):"s"===Le?a=r(be,0,-a):!Le&&(a=0);var d="w"===Ce?e:0,c="n"===Le?a:0;if(Ae.isSubplotConstrained){var p;if(!Ce&&1===Le.length){for(p=0;p<_e.length;p++)_e[p].range=_e[p]._r.slice(),W(_e[p],1-a/Te);e=a*we/Te,d=e/2}if(!Le&&1===Ce.length){for(p=0;p<be.length;p++)be[p].range=be[p]._r.slice(),W(be[p],1-e/we);a=e*Te/we,c=a/2}}oe("x"),oe("y"),se([d,c,we-e,Te-a]),ie(),t.emit("plotly_relayouting",Re)}}function oe(e,t){for(var a=Se.isSubplotConstrained?{x:be,y:_e}[e]:Se[e+"axes"],r=Se.isSubplotConstrained?{x:_e,y:be}[e]:[],o=0;o<a.length;o++){var n=a[o],l=n._id,s=Se.xLinks[l]||Se.yLinks[l],d=r[0]||fe[s]||xe[s];d&&(t?(t[n._name+".range[0]"]=t[d._name+".range[0]"],t[n._name+".range[1]"]=t[d._name+".range[1]"]):n.range=d.range.slice())}}function ie(){function e(e){for(r=0;r<e.length;r++)e[r].fixedrange||a.push(e[r]._id)}var a=[],r;for(Ie&&(e(_e),e(Ae.xaxes),e(Se.xaxes)),ze&&(e(be),e(Ae.yaxes),e(Se.yaxes)),Re={},r=0;r<a.length;r++){var o=a[r],n=H(t,o);R.drawOne(t,n,{skipTitle:!0}),Re[n._name+".range[0]"]=n.range[0],Re[n._name+".range[1]"]=n.range[1]}R.redrawComponents(t,a)}function ne(){if(!t._transitioningWithDuration){var e=t._context.doubleClick,a=[];Ce&&(a=a.concat(_e)),Le&&(a=a.concat(be)),Se.xaxes&&(a=a.concat(Se.xaxes)),Se.yaxes&&(a=a.concat(Se.yaxes));var r={},o,n,l;if("reset+autosize"===e)for(e="autosize",n=0;n<a.length;n++)if(o=a[n],o._rangeInitial&&(o.range[0]!==o._rangeInitial[0]||o.range[1]!==o._rangeInitial[1])||!o._rangeInitial&&!o.autorange){e="reset";break}if("autosize"===e)for(n=0;n<a.length;n++)o=a[n],o.fixedrange||(r[o._name+".autorange"]=!0);else if("reset"===e)for((Ce||Ae.isSubplotConstrained)&&(a=a.concat(Ae.xaxes)),Le&&!Ae.isSubplotConstrained&&(a=a.concat(Ae.yaxes)),Ae.isSubplotConstrained&&(Ce?!Le&&(a=a.concat(be)):a=a.concat(_e)),n=0;n<a.length;n++)o=a[n],o.fixedrange||(o._rangeInitial?(l=o._rangeInitial,r[o._name+".range[0]"]=l[0],r[o._name+".range[1]"]=l[1]):r[o._name+".autorange"]=!0);t.emit("plotly_doubleclick",null),C.call("_guiRelayout",t,r)}}function le(){se([0,0,we,Te]),L.syncOrAsync([U.previousPromises,function(){t._fullLayout._replotting=!1,C.call("_guiRelayout",t,Re)}],t)}function se(e){var a=t._fullLayout,r=a._plots,o=a._subplots.cartesian,n,l,s,d;if(De&&C.subplotsRegistry.splom.drag(t),Pe)for(n=0;n<o.length;n++)if(l=r[o[n]],s=l.xaxis,d=l.yaxis,l._scene){var c=L.simpleMap(s.range,s.r2l),p=L.simpleMap(d.range,d.r2l);l._scene.update({range:[c[0],p[0],c[1],p[1]]})}if((De||Pe)&&(N(t),V(t)),Oe){var u=e[2]/me._length,g=e[3]/ye._length;for(n=0;n<o.length;n++){l=r[o[n]],s=l.xaxis,d=l.yaxis;var h=Ie&&!s.fixedrange&&fe[s._id],m=ze&&!d.fixedrange&&xe[d._id],y,f,x,_;if(h?(y=u,x=P?e[0]:pe(s,y)):Se.xaHash[s._id]?(y=u,x=e[0]*s._length/me._length):Se.yaHash[s._id]?(y=g,x="ns"===Le?-e[1]*s._length/ye._length:pe(s,y,{n:"top",s:"bottom"}[Le])):(y=de(s,u,g),x=ce(s,y)),m?(f=g,_=z?e[1]:pe(d,f)):Se.yaHash[d._id]?(f=g,_=e[1]*d._length/ye._length):Se.xaHash[d._id]?(f=u,_="ew"===Ce?-e[0]*d._length/me._length:pe(d,f,{e:"right",w:"left"}[Ce])):(f=de(d,u,g),_=ce(d,f)),y||f){y||(y=1),f||(f=1);var b=s._offset-x/y,v=d._offset-_/f;l.clipRect.call(D.setTranslate,x,_).call(D.setScale,y,f),l.plot.call(D.setTranslate,b,v).call(D.setScale,1/y,1/f),(y!==l.xScaleFactor||f!==l.yScaleFactor)&&(D.setPointGroupScale(l.zoomScalePts,y,f),D.setTextPointsScale(l.zoomScaleTxt,y,f)),D.hideOutsideRangePoints(l.clipOnAxisFalseTraces,l),l.xScaleFactor=y,l.yScaleFactor=f}}}}function de(e,t,a){return e.fixedrange?0:Ie&&Ae.xaHash[e._id]?t:ze&&(Ae.isSubplotConstrained?Ae.xaHash:Ae.yaHash)[e._id]?a:0}function ce(e,t){return t?(e.range=e._r.slice(),W(e,t),pe(e,t)):0}function pe(e,t,a){return e._length*(1-t)*B[a||e.constraintoward||"middle"]}var ue=t._fullLayout._zoomlayer,ge="nsew"===z+P,he=1===(z+P).length,me,ye,fe,xe,_e,be,ve,ke,we,Te,Ae,Se,Ce,Le,Ee,Ie,ze,Pe,De,Oe,Re;M();var Me=d(Le+Ce,t._fullLayout.dragmode,ge),je=r(e,z+P+"drag",Me,a,g,S,I);if(Ee&&!ge)return je.onmousedown=null,je.style.pointerEvents="none",je;var Fe={element:je,gd:t,plotinfo:e};Fe.prepFn=function(a,e,r){var o=Fe.dragmode,i=t._fullLayout.dragmode;i!==o&&(Fe.dragmode=i),M(),Ee||(ge?a.shiftKey?"pan"===i?i="zoom":!f(i)&&(i="pan"):a.ctrlKey&&(i="pan"):i="pan"),Fe.minDrag="lasso"===i?1:void 0,f(i)?(Fe.xaxes=_e,Fe.yaxes=be,G(a,e,r,Fe,i)):(Fe.clickFn=J,f(o)&&j(),!Ee&&("zoom"===i?(Fe.moveFn=$,Fe.doneFn=te,Fe.minDrag=1,Q(a,e,r)):"pan"===i&&(Fe.moveFn=re,Fe.doneFn=le))),t._fullLayout._redrag=function(){var e=t._dragdata;if(e&&e.element===je){var a=t._fullLayout.dragmode;f(a)||(M(),se([0,0,we,Te]),Fe.moveFn(e.dx,e.dy))}}},F.init(Fe);var Be=[0,0,we,Te],Ne=null,Ve=X.REDRAWDELAY,Ue=e.mainplot?t._fullLayout._plots[e.mainplot]:e,He,Ge,qe,Ye,We,Xe,Ze,Ke,Je,Qe;return 1!=z.length*P.length&&k(je,ae),je},makeDragger:a,makeRectDragger:r,makeZoombox:c,makeCorners:p,updateZoombox:u,xyCorners:b,transitionZoombox:g,removeZoombox:h,showDoubleClickNotifier:y,attachWheelEventHandler:k}},{"../../components/color":593,"../../components/dragelement":611,"../../components/drawing":614,"../../components/fx":632,"../../constants/alignment":688,"../../lib":719,"../../lib/clear_gl_canvases":704,"../../lib/setcursor":739,"../../lib/svg_text_utils":743,"../../plot_api/subroutines":758,"../../registry":847,"../plots":828,"./axes":767,"./axis_ids":770,"./constants":773,"./scale_zoom":783,"./select":784,d3:163,"has-passive-events":411,tinycolor2:537}],776:[function(e,t,a){"use strict";var r=e("d3"),o=e("../../components/fx"),i=e("../../components/dragelement"),n=e("../../lib/setcursor"),l=e("./dragbox").makeDragBox,s=e("./constants").DRAGGERSIZE;a.initInteractions=function(e){var t=e._fullLayout;if(e._context.staticPlot)return void r.select(e).selectAll(".drag").remove();if(t._has("cartesian")||t._has("splom")){var n=Object.keys(t._plots||{}).sort(function(e,a){if((t._plots[e].mainplot&&!0)===(t._plots[a].mainplot&&!0)){var r=e.split("y"),o=a.split("y");return r[0]===o[0]?+(r[1]||1)-+(o[1]||1):+(r[0]||1)-+(o[0]||1)}return t._plots[e].mainplot?1:-1});n.forEach(function(a){var r=t._plots[a],n=r.xaxis,d=r.yaxis;if(!r.mainplot){var c=l(e,r,n._offset,d._offset,n._length,d._length,"ns","ew");c.onmousemove=function(t){e._fullLayout._rehover=function(){e._fullLayout._hoversubplot===a&&o.hover(e,t,a)},o.hover(e,t,a),e._fullLayout._lasthover=c,e._fullLayout._hoversubplot=a},c.onmouseout=function(t){e._dragging||(e._fullLayout._hoversubplot=null,i.unhover(e,t))},e._context.showAxisDragHandles&&(l(e,r,n._offset-s,d._offset-s,s,s,"n","w"),l(e,r,n._offset+n._length,d._offset-s,s,s,"n","e"),l(e,r,n._offset-s,d._offset+d._length,s,s,"s","w"),l(e,r,n._offset+n._length,d._offset+d._length,s,s,"s","e"))}if(e._context.showAxisDragHandles){if(a===n._mainSubplot){var p=n._mainLinePosition;"top"===n.side&&(p-=s),l(e,r,n._offset+.1*n._length,p,.8*n._length,s,"","ew"),l(e,r,n._offset,p,.1*n._length,s,"","w"),l(e,r,n._offset+.9*n._length,p,.1*n._length,s,"","e")}if(a===d._mainSubplot){var u=d._mainLinePosition;"right"!==d.side&&(u-=s),l(e,r,u,d._offset+.1*d._length,s,.8*d._length,"ns",""),l(e,r,u,d._offset+.9*d._length,s,.1*d._length,"s",""),l(e,r,u,d._offset,s,.1*d._length,"n","")}}});var d=t._hoverlayer.node();d.onmousemove=function(a){a.target=e._fullLayout._lasthover,o.hover(e,a,t._hoversubplot)},d.onclick=function(t){t.target=e._fullLayout._lasthover,o.click(e,t)},d.onmousedown=function(t){e._fullLayout._lasthover.onmousedown(t)},a.updateFx(e)}},a.updateFx=function(e){var t=e._fullLayout,a="pan"===t.dragmode?"move":"crosshair";n(t._draggers,a)}},{"../../components/dragelement":611,"../../components/fx":632,"../../lib/setcursor":739,"./constants":773,"./dragbox":775,d3:163}],777:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib");t.exports=function(e){return function(t,o){var n=t[e];if(Array.isArray(n))for(var l=a.subplotsRegistry.cartesian,s=l.idRegex,d=o._subplots,c=d.xaxis,p=d.yaxis,u=d.cartesian,g=o._has("cartesian")||o._has("gl2d"),h=0,m;h<n.length;h++)if(m=n[h],r.isPlainObject(m)){var y=m.xref,f=m.yref,x=s.x.test(y),_=s.y.test(f);if(x||_){g||r.pushUnique(o._basePlotModules,l);var b=!1;x&&-1===c.indexOf(y)&&(c.push(y),b=!0),_&&-1===p.indexOf(f)&&(p.push(f),b=!0),b&&x&&_&&u.push(y+f)}}}}},{"../../lib":719,"../../registry":847}],778:[function(e,t,a){"use strict";function r(e,t,a){return p.ensureSingle(e,t,a,function(e){e.datum(a)})}function o(e,t,a,r,o){for(var n=y.traceLayerClasses,l=e._fullLayout,s=l._modules,p=[],u=[],m=0,f,x,_;m<s.length;m++){f=s[m];var b=f.name,v=d.modules[b].categories;if(v.svg){var k=f.layerName||b+"layer",w=f.plot;x=h(a,w),_=x[0],a=x[1],_.length&&p.push({i:n.indexOf(k),className:k,plotMethod:w,cdModule:_}),v.zoomScale&&u.push("."+k)}}p.sort(function(e,t){return e.i-t.i});var T=t.plot.selectAll("g.mlayer").data(p,function(e){return e.className});if(T.enter().append("g").attr("class",function(e){return e.className}).classed("mlayer",!0).classed("rangeplot",t.isRangePlot),T.exit().remove(),T.order(),T.each(function(a){var i=c.select(this),n=a.className;a.plotMethod(e,t,a.cdModule,i,r,o),-1===y.clipOnAxisFalseQuery.indexOf("."+n)&&g.setClipUrl(i,t.layerClipId,e)}),l._has("scattergl")&&(f=d.getModule("scattergl"),_=h(a,f)[0],f.plot(e,t,_)),!e._context.staticPlot&&(t._hasClipOnAxisFalse&&(t.clipOnAxisFalseTraces=t.plot.selectAll(y.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),u.length)){var A=t.plot.selectAll(u.join(",")).selectAll(".trace");t.zoomScalePts=A.selectAll("path.point"),t.zoomScaleTxt=A.selectAll(".textpoint")}}function i(e){var t=e._fullLayout,a=t._subplots.cartesian,r=a.length,o=[],n=[],l,s,c,p,u,g;for(l=0;l<r;l++){c=a[l],p=t._plots[c],u=p.xaxis,g=p.yaxis;var h=u._mainAxis,m=g._mainAxis,y=h._id+m._id,f=t._plots[y];p.overlays=[],y!==c&&f?(p.mainplot=y,p.mainplotinfo=f,n.push(c)):(p.mainplot=void 0,p.mainPlotinfo=void 0,o.push(c))}for(l=0;l<n.length;l++)c=n[l],p=t._plots[c],p.mainplotinfo.overlays.push(p);var x=o.concat(n),_=Array(r);for(l=0;l<r;l++){c=x[l],p=t._plots[c],u=p.xaxis,g=p.yaxis;var b=[c,u.layer,g.layer,u.overlaying||"",g.overlaying||""];for(s=0;s<p.overlays.length;s++)b.push(p.overlays[s].id);_[l]=b}return _}function n(e,t){var a=t.plotgroup,o=t.id,i=y.layerValue2layerClass[t.xaxis.layer],n=y.layerValue2layerClass[t.yaxis.layer],l=e._fullLayout._hasOnlyLargeSploms;if(!!t.mainplot){var s=t.mainplotinfo,d=s.plotgroup,c=o+"-x",p=o+"-y";t.gridlayer=s.gridlayer,t.zerolinelayer=s.zerolinelayer,x(s.overlinesBelow,"path",c),x(s.overlinesBelow,"path",p),x(s.overaxesBelow,"g",c),x(s.overaxesBelow,"g",p),t.plot=x(s.overplot,"g",o),x(s.overlinesAbove,"path",c),x(s.overlinesAbove,"path",p),x(s.overaxesAbove,"g",c),x(s.overaxesAbove,"g",p),t.xlines=d.select(".overlines-"+i).select("."+c),t.ylines=d.select(".overlines-"+n).select("."+p),t.xaxislayer=d.select(".overaxes-"+i).select("."+c),t.yaxislayer=d.select(".overaxes-"+n).select("."+p)}else if(l)t.xlines=x(a,"path","xlines-above"),t.ylines=x(a,"path","ylines-above"),t.xaxislayer=x(a,"g","xaxislayer-above"),t.yaxislayer=x(a,"g","yaxislayer-above");else{var u=x(a,"g","layer-subplot");t.shapelayer=x(u,"g","shapelayer"),t.imagelayer=x(u,"g","imagelayer"),t.gridlayer=x(a,"g","gridlayer"),t.zerolinelayer=x(a,"g","zerolinelayer"),x(a,"path","xlines-below"),x(a,"path","ylines-below"),t.overlinesBelow=x(a,"g","overlines-below"),x(a,"g","xaxislayer-below"),x(a,"g","yaxislayer-below"),t.overaxesBelow=x(a,"g","overaxes-below"),t.plot=x(a,"g","plot"),t.overplot=x(a,"g","overplot"),t.xlines=x(a,"path","xlines-above"),t.ylines=x(a,"path","ylines-above"),t.overlinesAbove=x(a,"g","overlines-above"),x(a,"g","xaxislayer-above"),x(a,"g","yaxislayer-above"),t.overaxesAbove=x(a,"g","overaxes-above"),t.xlines=a.select(".xlines-"+i),t.ylines=a.select(".ylines-"+n),t.xaxislayer=a.select(".xaxislayer-"+i),t.yaxislayer=a.select(".yaxislayer-"+n)}l||(r(t.gridlayer,"g",t.xaxis._id),r(t.gridlayer,"g",t.yaxis._id),t.gridlayer.selectAll("g").map(function(e){return e[0]}).sort(m.idSort)),t.xlines.style("fill","none").classed("crisp",!0),t.ylines.style("fill","none").classed("crisp",!0)}function l(e,t){if(e){var a={};for(var r in e.each(function(e){var r=e[0],o=c.select(this);o.remove(),s(r,t),a[r]=!0}),t._plots)for(var o=t._plots[r],i=o.overlays||[],n=0,l;n<i.length;n++)l=i[n],a[l.id]&&l.plot.selectAll(".trace").remove()}}function s(e,t){t._draggers.selectAll("g."+e).remove(),t._defs.select("#clip"+t._uid+e+"plot").remove()}var c=e("d3"),d=e("../../registry"),p=e("../../lib"),u=e("../plots"),g=e("../../components/drawing"),h=e("../get_data").getModuleCalcData,m=e("./axis_ids"),y=e("./constants"),f=e("../../constants/xmlns_namespaces"),x=p.ensureSingle;a.name="cartesian",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=y.idRegex,a.attrRegex=y.attrRegex,a.attributes=e("./attributes"),a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.transitionAxes=e("./transition_axes"),a.finalizeSubplots=function(e,t){var a=t._subplots,r=a.xaxis,o=a.yaxis,n=a.cartesian,l=n.concat(a.gl2d||[]),s={},d={},c,u,g;for(c=0;c<l.length;c++){var h=l[c].split("y");s[h[0]]=1,d["y"+h[1]]=1}for(c=0;c<r.length;c++)u=r[c],s[u]||(g=(e[m.id2name(u)]||{}).anchor,!y.idRegex.y.test(g)&&(g="y"),n.push(u+g),l.push(u+g),!d[g]&&(d[g]=1,p.pushUnique(o,g)));for(c=0;c<o.length;c++)g=o[c],d[g]||(u=(e[m.id2name(g)]||{}).anchor,!y.idRegex.x.test(u)&&(u="x"),n.push(u+g),l.push(u+g),!s[u]&&(s[u]=1,p.pushUnique(r,u)));if(!l.length){for(var f in u="",g="",e)if(y.attrRegex.test(f)){var x=f.charAt(0);"x"===x?(!u||+f.substr(5)<+u.substr(5))&&(u=f):(!g||+f.substr(5)<+g.substr(5))&&(g=f)}u=u?m.name2id(u):"x",g=g?m.name2id(g):"y",r.push(u),o.push(g),n.push(u+g)}},a.plot=function(e,t,a,r){var n=e._fullLayout,l=n._subplots.cartesian,s=e.calcdata,d;if(!Array.isArray(t))for(t=[],d=0;d<s.length;d++)t.push(d);for(d=0;d<l.length;d++){for(var c=l[d],p=n._plots[c],u=[],g=0,h;g<s.length;g++){var m=s[g],y=m[0].trace;y.xaxis+y.yaxis===c&&((-1!==t.indexOf(y.index)||y.carpet)&&(h&&h[0].trace.xaxis+h[0].trace.yaxis===c&&-1!==["tonextx","tonexty","tonext"].indexOf(y.fill)&&-1===u.indexOf(h)&&u.push(h),u.push(m)),h=m)}o(e,p,u,a,r)}},a.clean=function(e,t,a,r){var o=r._plots||{},n=t._plots||{},d=r._subplots||{},c,p,u;if(r._hasOnlyLargeSploms&&!t._hasOnlyLargeSploms)for(u in o)c=o[u],c.plotgroup&&c.plotgroup.remove();var g=r._has&&r._has("gl"),h=t._has&&t._has("gl");if(g&&!h)for(u in o)c=o[u],c._scene&&c._scene.destroy();if(d.xaxis&&d.yaxis){var y=m.listIds({_fullLayout:r});for(p=0;p<y.length;p++){var f=y[p];t[m.id2name(f)]||r._infolayer.selectAll(".g-"+f+"title").remove()}}var x=r._has&&r._has("cartesian"),_=t._has&&t._has("cartesian");if(x&&!_)l(r._cartesianlayer.selectAll(".subplot"),r),r._defs.selectAll(".axesclip").remove(),delete r._axisConstraintGroups;else if(d.cartesian)for(p=0;p<d.cartesian.length;p++){var b=d.cartesian[p];if(!n[b]){r._cartesianlayer.selectAll("."+b+",."+b+"-x,."+b+"-y").remove(),s(b,r)}}},a.drawFramework=function(e){var t=e._fullLayout,a=i(e),r=t._cartesianlayer.selectAll(".subplot").data(a,String);r.enter().append("g").attr("class",function(e){return"subplot "+e[0]}),r.order(),r.exit().call(l,t),r.each(function(a){var r=a[0],o=t._plots[r];o.plotgroup=c.select(this),n(e,o),o.draglayer=x(t._draggers,"g",r)})},a.rangePlot=function(e,t,a){n(e,t),o(e,t,a),u.style(e)},a.toSVG=function(e){var t=e._fullLayout._glimages,a=c.select(e).selectAll(".svg-container"),r=a.filter(function(e,t){return t===a.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");r.each(function(){var e=this,a=e.toDataURL("image/png"),r=t.append("svg:image");r.attr({xmlns:f.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})})},a.updateFx=e("./graph_interact").updateFx},{"../../components/drawing":614,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../registry":847,"../get_data":802,"../plots":828,"./attributes":765,"./axis_ids":770,"./constants":773,"./graph_interact":776,"./layout_attributes":779,"./layout_defaults":780,"./transition_axes":789,d3:163}],779:[function(e,t){"use strict";var a=e("../font_attributes"),r=e("../../components/color/attributes"),o=e("../../components/drawing/attributes").dash,i=e("../../lib/extend").extendFlat,n=e("../../plot_api/plot_template").templatedArray,l=e("../../constants/docs").FORMAT_LINK,s=e("../../constants/docs").DATE_FORMAT_LINK,d=e("./constants");t.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:r.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:a({editType:"ticks"}),editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[d.idRegex.x.toString(),d.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[d.idRegex.x.toString(),d.idRegex.y.toString()],editType:"calc"},tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:r.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:i({},o,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor"],dflt:"data",editType:"none"},tickfont:a({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:n("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:r.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:r.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:r.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:r.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",d.idRegex.x.toString(),d.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",d.idRegex.x.toString(),d.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:a({editType:"ticks"})}}},{"../../components/color/attributes":592,"../../components/drawing/attributes":613,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/plot_template":757,"../font_attributes":793,"./constants":773}],780:[function(e,t){"use strict";function a(e,t,a){Array.isArray(e[t])?e[t].push(a):e[t]=[a]}var r=e("../../lib"),o=e("../../components/color"),n=e("../../plot_api/plot_template"),l=e("../layout_attributes"),s=e("./layout_attributes"),d=e("./type_defaults"),c=e("./axis_defaults"),p=e("./constraints").handleConstraintDefaults,u=e("./position_defaults"),g=e("./axis_ids"),h=g.id2name,m=g.name2id,y=e("../../registry"),f=y.traceIs,x=y.getComponentMethod;t.exports=function(e,t,g){function y(e,t){return r.coerce(K,J,s,e,t)}function _(e,t){return r.coerce2(K,J,s,e,t)}function b(e){return"x"===e?N:B}function v(t,a){for(var r="x"===t?V:U,o=[],i=0,n;i<r.length;i++)n=r[i],n===a||(e[n]||{}).overlaying||o.push(m(n));return o}var k={},w={},T={},A={},S={},C={},L={},E={},I={},z,P;for(z=0;z<g.length;z++){var D=g[z];if(f(D,"cartesian")||f(D,"gl2d")){var O;if(D.xaxis)O=h(D.xaxis),a(k,O,D);else if(D.xaxes)for(P=0;P<D.xaxes.length;P++)a(k,h(D.xaxes[P]),D);var R;if(D.yaxis)R=h(D.yaxis),a(k,R,D);else if(D.yaxes)for(P=0;P<D.yaxes.length;P++)a(k,h(D.yaxes[P]),D);if("funnel"===D.type?"h"===D.orientation?(O&&(w[O]=!0),R&&(L[R]=!0)):R&&(T[R]=!0):(R&&(S[R]=!0,C[R]=!0),(!f(D,"carpet")||"carpet"===D.type&&!D._cheater)&&O&&(A[O]=!0)),"carpet"===D.type&&D._cheater&&O&&(w[O]=!0),f(D,"2dMap")&&(E[O]=!0,E[R]=!0),f(D,"oriented")){var M="h"===D.orientation?R:O;I[M]=!0}}}var F=t._subplots,B=F.xaxis,N=F.yaxis,V=r.simpleMap(B,h),U=r.simpleMap(N,h),H=V.concat(U),G=o.background;B.length&&N.length&&(G=r.coerce(e,t,l,"plot_bgcolor"));var q=o.combine(G,t.paper_bgcolor),Y={x:b("x"),y:b("y")},W=Y.x.concat(Y.y),X,Z,K,J;for(z=0;z<H.length;z++){X=H[z],Z=X.charAt(0),r.isPlainObject(e[X])||(e[X]={}),K=e[X],J=n.newContainer(t,X,Z+"axis");var Q=k[X]||[];J._traceIndices=Q.map(function(e){return e._expandedIndex}),J._annIndices=[],J._shapeIndices=[],J._imgIndices=[],J._subplotsWith=[],J._counterAxes=[],J._name=J._attr=X;var $=J._id=m(X),ee=v(Z,X),te="x"===Z&&!A[X]&&w[X]||"y"===Z&&!S[X]&&T[X],ae="y"===Z&&!C[X]&&L[X],re={letter:Z,font:t.font,outerTicks:E[X],showGrid:!I[X],data:Q,bgColor:q,calendar:t.calendar,automargin:!0,visibleDflt:te,reverseDflt:ae,splomStash:((t._splomAxes||{})[Z]||{})[$]};y("uirevision",t.uirevision),d(K,J,y,re),c(K,J,y,re,t);var oe=_("spikecolor"),ie=_("spikethickness"),ne=_("spikedash"),le=_("spikemode"),se=_("spikesnap"),de=y("showspikes",!!oe||!!ie||!!ne||!!le||!!se);de||(delete J.spikecolor,delete J.spikethickness,delete J.spikedash,delete J.spikemode,delete J.spikesnap),u(K,J,y,{letter:Z,counterAxes:Y[Z],overlayableAxes:ee,grid:t.grid}),J._input=K}var ce=x("rangeslider","handleDefaults"),pe=x("rangeselector","handleDefaults");for(z=0;z<V.length;z++)X=V[z],K=e[X],J=t[X],ce(e,t,X),"date"===J.type&&pe(K,J,t,U,J.calendar),y("fixedrange");for(z=0;z<U.length;z++){X=U[z],K=e[X],J=t[X];var ue=t[h(J.anchor)],ge=x("rangeslider","isVisible")(ue);y("fixedrange",ge)}var he=t._axisConstraintGroups=[],me=t._axisMatchGroups=[];for(z=0;z<H.length;z++)X=H[z],Z=X.charAt(0),K=e[X],J=t[X],p(K,J,y,W,t);for(z=0;z<me.length;z++){var ye=me[z],fe=null,xe=null,_e;for(_e in ye)J=t[h(_e)],J.matches||(fe=J.range,xe=J.autorange);if(null===fe||null===xe)for(_e in ye){J=t[h(_e)],fe=J.range,xe=J.autorange;break}for(_e in ye)J=t[h(_e)],J.matches&&(J.range=fe.slice(),J.autorange=xe),J._matchGroup=ye;if(he.length)for(_e in ye)for(P=0;P<he.length;P++){var be=he[P];for(var ve in be)_e===ve&&(r.warn("Axis "+ve+" is set with both a *scaleanchor* and *matches* constraint; ignoring the scale constraint."),delete be[ve],2>Object.keys(be).length&&he.splice(P,1))}}}},{"../../components/color":593,"../../lib":719,"../../plot_api/plot_template":757,"../../registry":847,"../layout_attributes":819,"./axis_defaults":769,"./axis_ids":770,"./constraints":774,"./layout_attributes":779,"./position_defaults":782,"./type_defaults":790}],781:[function(e,t){"use strict";var a=e("tinycolor2").mix,r=e("../../components/color/attributes").lightFraction,o=e("../../lib");t.exports=function(e,t,i,n){function l(a,r){return o.coerce2(e,t,n.attributes,a,r)}n=n||{};var s=n.dfltColor,d=l("linecolor",s),c=l("linewidth"),p=i("showline",n.showLine||!!d||!!c);p||(delete t.linecolor,delete t.linewidth);var u=a(s,n.bgColor,n.blend||r).toRgbString(),g=l("gridcolor",u),h=l("gridwidth"),m=i("showgrid",n.showGrid||!!g||!!h);if(m||(delete t.gridcolor,delete t.gridwidth),!n.noZeroLine){var y=l("zerolinecolor",s),f=l("zerolinewidth"),x=i("zeroline",n.showGrid||!!y||!!f);x||(delete t.zerolinecolor,delete t.zerolinewidth)}}},{"../../components/color/attributes":592,"../../lib":719,tinycolor2:537}],782:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../lib");t.exports=function(e,t,o,i){var n=i.counterAxes||[],l=i.overlayableAxes||[],s=i.letter,d=i.grid,c,p,u,g;d&&(p=d._domains[s][d._axisMap[t._id]],c=d._anchors[t._id],p&&(u=d[s+"side"].split(" ")[0],g=d.domain[s]["right"===u||"top"===u?1:0])),p=p||[0,1],c=c||(a(e.position)?"free":n[0]||"free"),u=u||("x"===s?"bottom":"left"),g=g||0;var h=r.coerce(e,t,{anchor:{valType:"enumerated",values:["free"].concat(n),dflt:c}},"anchor");"free"===h&&o("position",g),r.coerce(e,t,{side:{valType:"enumerated",values:"x"===s?["bottom","top"]:["left","right"],dflt:u}},"side");var m=!1;if(l.length&&(m=r.coerce(e,t,{overlaying:{valType:"enumerated",values:[!1].concat(l),dflt:!1}},"overlaying")),!m){var y=o("domain",p);y[0]>y[1]-1/4096&&(t.domain=p),r.noneOrAll(e.domain,t.domain,p)}return o("layer"),t}},{"../../lib":719,"fast-isnumeric":225}],783:[function(e,t){"use strict";var a=e("../../constants/alignment").FROM_BL;t.exports=function(e,t,r){r===void 0&&(r=a[e.constraintoward||"center"]);var o=[e.r2l(e.range[0]),e.r2l(e.range[1])],i=o[0]+(o[1]-o[0])*r;e.range=e._input.range=[e.l2r(i+(o[0]-i)*t),e.l2r(i+(o[1]-i)*t)]}},{"../../constants/alignment":688}],784:[function(e,t){"use strict";function a(e){return e._id}function r(e,t,a,r,n,l,_){var v=t._hoverdata,k=t._fullLayout.clickmode,w=-1<k.indexOf("event"),T=[],A,S,C,L,E,I,z,P,D,O;if(g(v)){d(e,t,l),A=p(t,a,r,n);var R=h(v,A),M=0<R.pointNumbers.length;if(M?y(A,R):f(A)&&(z=m(R))){for(_&&_.remove(),O=0;O<A.length;O++)S=A[O],S._module.selectPoints(S,!1);x(t,A),c(l),w&&t.emit("plotly_deselect",null)}else{P=e.shiftKey&&(z===void 0?m(R):z),C=o(R.pointNumber,R.searchInfo,P);var F=l.selectionDefs.concat([C]);for(L=s(F),O=0;O<A.length;O++)if(E=A[O]._module.selectPoints(A[O],L),I=b(E,A[O]),T.length)for(var B=0;B<I.length;B++)T.push(I[B]);else T=I;D={points:T},x(t,A,D),C&&l&&l.selectionDefs.push(C),_&&u(l.mergedPolygons,_),w&&t.emit("plotly_selected",D)}}}function o(e,t,a){return{pointNumber:e,searchInfo:t,subtract:a}}function n(e){return"pointNumber"in e&&"searchInfo"in e}function l(e){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(t,a,r,o){var i=e.searchInfo.cd[0].trace._expandedIndex,n=o.cd[0].trace._expandedIndex;return n===i&&r===e.pointNumber},isRect:!1,degenerate:!1,subtract:e.subtract}}function s(e){function t(e,t,r,o){for(var n=!1,l=0;l<a.length;l++)a[l].contains(e,t,r,o)&&(n=!1===a[l].subtract);return n}for(var a=[],r=n(e[0])?0:e[0][0][0],o=r,s=n(e[0])?0:e[0][0][1],d=s,c=0;c<e.length;c++)if(n(e[c]))a.push(l(e[c]));else{var p=C.tester(e[c]);p.subtract=e[c].subtract,a.push(p),r=ea(r,p.xmin),o=va(o,p.xmax),s=ea(s,p.ymin),d=va(d,p.ymax)}return{xmin:r,xmax:o,ymin:s,ymax:d,pts:[],contains:t,isRect:!1,degenerate:!1}}function d(e,t,a){var r=t._fullLayout,o=a.plotinfo,i=r._lastSelectedSubplot&&r._lastSelectedSubplot===o.id,n=e.shiftKey||e.altKey;i&&n&&o.selection&&o.selection.selectionDefs&&!a.selectionDefs?(a.selectionDefs=o.selection.selectionDefs,a.mergedPolygons=o.selection.mergedPolygons):(!n||!o.selection)&&c(a),i||(v(t),r._lastSelectedSubplot=o.id)}function c(e){var t=e.plotinfo;t.selection={},t.selection.selectionDefs=e.selectionDefs=[],t.selection.mergedPolygons=e.mergedPolygons=[]}function p(e,t,r,o){function n(e,t,a,r){return{_module:e,cd:t,xaxis:a,yaxis:r}}var l=[],s=t.map(a),d=r.map(a),c,p,u;for(u=0;u<e.calcdata.length;u++)if(c=e.calcdata[u],p=c[0].trace,!0===p.visible&&p._module&&p._module.selectPoints)if(o&&(p.subplot===o||p.geo===o))l.push(n(p._module,c,t[0],r[0]));else if("splom"===p.type&&p._xaxes[s[0]]&&p._yaxes[d[0]]){var g=n(p._module,c,t[0],r[0]);g.scene=e._fullLayout._splomScenes[p.uid],l.push(g)}else if("sankey"===p.type){var h=n(p._module,c,t[0],r[0]);l.push(h)}else{if(-1===s.indexOf(p.xaxis))continue;if(-1===d.indexOf(p.yaxis))continue;l.push(n(p._module,c,I(e,p.xaxis),I(e,p.yaxis)))}return l}function u(e,t){var a=[],r,o;for(r=0;r<e.length;r++){var n=e[r];a.push(n.join("L")+"L"+n[0])}o=0<e.length?"M"+a.join("M")+"Z":"M0,0Z",t.attr("d",o)}function g(e){return e&&Array.isArray(e)&&!0!==e[0].hoverOnBox}function h(e,t){var a=e[0],r=-1,o=[],n,l;for(l=0;l<t.length;l++)if(n=t[l],a.fullData._expandedIndex===n.cd[0].trace._expandedIndex){if(!0===a.hoverOnBox)break;void 0===a.pointNumber?void 0!==a.binNumber&&(r=a.binNumber,o=a.pointNumbers):r=a.pointNumber;break}return{pointNumber:r,pointNumbers:o,searchInfo:n}}function m(e){var t=e.searchInfo.cd[0].trace,a=e.pointNumber,r=e.pointNumbers,o=0<r.length,i=o?r[0]:a;return!!t.selectedpoints&&-1<t.selectedpoints.indexOf(i)}function y(e,t){var a=[],r,o,n,l;for(l=0;l<e.length;l++)r=e[l],r.cd[0].trace.selectedpoints&&0<r.cd[0].trace.selectedpoints.length&&a.push(r);if(1===a.length&&(n=a[0]===t.searchInfo,n&&(o=t.searchInfo.cd[0].trace,o.selectedpoints.length===t.pointNumbers.length))){for(l=0;l<t.pointNumbers.length;l++)if(0>o.selectedpoints.indexOf(t.pointNumbers[l]))return!1;return!0}return!1}function f(e){var t=0,a,r,o;for(o=0;o<e.length;o++)if(a=e[o],r=a.cd[0].trace,r.selectedpoints){if(1<r.selectedpoints.length)return!1;if(t+=r.selectedpoints.length,1<t)return!1}return 1===t}function x(e,t,a){var r,o,n,l;for(r=0;r<t.length;r++){var s=t[r].cd[0].trace._fullInput,d=e._fullLayout._tracePreGUI[s.uid]||{};d.selectedpoints===void 0&&(d.selectedpoints=s._input.selectedpoints||null)}if(a){var c=a.points||[];for(r=0;r<t.length;r++)l=t[r].cd[0].trace,l._input.selectedpoints=l._fullInput.selectedpoints=[],l._fullInput!==l&&(l.selectedpoints=[]);for(r=0;r<c.length;r++){var p=c[r],u=p.data,g=p.fullData;p.pointIndices?([].push.apply(u.selectedpoints,p.pointIndices),l._fullInput!==l&&[].push.apply(g.selectedpoints,p.pointIndices)):(u.selectedpoints.push(p.pointIndex),l._fullInput!==l&&g.selectedpoints.push(p.pointIndex))}}else for(r=0;r<t.length;r++)l=t[r].cd[0].trace,delete l.selectedpoints,delete l._input.selectedpoints,l._fullInput!==l&&delete l._fullInput.selectedpoints;var h=!1;for(r=0;r<t.length;r++){o=t[r],n=o.cd,l=n[0].trace,w.traceIs(l,"regl")&&(h=!0);var m=o._module,y=m.styleOnSelect||m.style;y&&(y(e,n,n[0].node3),n[0].nodeRangePlot3&&y(e,n,n[0].nodeRangePlot3))}h&&(z(e),P(e))}function _(e,t,a){var r;return a?(r=k.difference({regions:e,inverted:!1},{regions:[t],inverted:!1}),r.regions):(r=k.union({regions:e,inverted:!1},{regions:[t],inverted:!1}),r.regions)}function b(e,t){if(Array.isArray(e))for(var a=t.cd,r=t.cd[0].trace,o=0;o<e.length;o++)e[o]=E(e[o],r,a);return e}function v(e){var t=e._fullLayout||{},a=t._zoomlayer;a&&a.selectAll(".select-outline").remove()}var k=e("polybooljs"),w=e("../../registry"),T=e("../../components/color"),A=e("../../components/fx"),S=e("../../lib"),C=e("../../lib/polygon"),L=e("../../lib/throttle"),E=e("../../components/fx/helpers").makeEventData,I=e("./axis_ids").getFromId,z=e("../../lib/clear_gl_canvases"),P=e("../../plot_api/subroutines").redrawReglTraces,D=e("./constants"),O=D.MINSELECT,R=C.filter,M=C.tester;t.exports={prepSelect:function(t,e,a,o,n){function l(e,t){return"log"===e.type?e.p2d(t):e.p2r(t)}function g(e){var t="y"===e._id.charAt(0)?1:0;return function(a){return l(e,a[t])}}function h(e,t){return e-t}var m=o.gd,y=m._fullLayout,f=y._zoomlayer,v=o.element.getBoundingClientRect(),k=o.plotinfo,w=k.xaxis._offset,C=k.yaxis._offset,E=e-v.left,I=a-v.top,z=E,P=I,j=o.xaxes[0]._length,F=o.yaxes[0]._length,B=o.xaxes.concat(o.yaxes),N=t.altKey,V,U,H,G,q,Y,W;d(t,m,o),"lasso"===n&&(V=R([[E,I]],D.BENDPX));var X=f.selectAll("path.select-outline-"+k.id).data([1,2]);X.enter().append("path").attr("class",function(e){return"select-outline select-outline-"+e+" select-outline-"+k.id}).attr("transform","translate("+w+", "+C+")").attr("d","M"+E+","+I+"Z");var Z=f.append("path").attr("class","zoombox-corners").style({fill:T.background,stroke:T.defaultLine,"stroke-width":1}).attr("transform","translate("+w+", "+C+")").attr("d","M0,0Z"),K=y._uid+D.SELECTID,J=[],Q=p(m,o.xaxes,o.yaxes,o.subplot),$;$=k.fillRangeItems?k.fillRangeItems:"select"===n?function(e,t){var a=e.range={};for(q=0;q<B.length;q++){var r=B[q],o=r._id.charAt(0);a[r._id]=[l(r,t[o+"min"]),l(r,t[o+"max"])].sort(h)}}:function(e,t,a){var r=e.lassoPoints={};for(q=0;q<B.length;q++){var o=B[q];r[o._id]=a.filtered.map(g(o))}},o.moveFn=function(e,t){z=va(0,ea(j,e+E)),P=va(0,ea(F,t+I));var a=_a(z-E),r=_a(P-I);if("select"===n){var i=y.selectdirection;i="any"===y.selectdirection?r<ea(.6*a,O)?"h":a<ea(.6*r,O)?"v":"d":y.selectdirection,"h"===i?(G=[[E,0],[E,F],[z,F],[z,0]],G.xmin=ea(E,z),G.xmax=va(E,z),G.ymin=ea(0,F),G.ymax=va(0,F),Z.attr("d","M"+G.xmin+","+(I-O)+"h-4v"+2*O+"h4ZM"+(G.xmax-1)+","+(I-O)+"h4v"+2*O+"h-4Z")):"v"===i?(G=[[0,I],[0,P],[j,P],[j,I]],G.xmin=ea(0,j),G.xmax=va(0,j),G.ymin=ea(I,P),G.ymax=va(I,P),Z.attr("d","M"+(E-O)+","+G.ymin+"v-4h"+2*O+"v4ZM"+(E-O)+","+(G.ymax-1)+"v4h"+2*O+"v-4Z")):"d"===i&&(G=[[E,I],[E,P],[z,P],[z,I]],G.xmin=ea(E,z),G.xmax=va(E,z),G.ymin=ea(I,P),G.ymax=va(I,P),Z.attr("d","M0,0Z"))}else"lasso"===n&&(V.addPt([z,P]),G=V.filtered);o.selectionDefs&&o.selectionDefs.length?(H=_(o.mergedPolygons,G,N),G.subtract=N,U=s(o.selectionDefs.concat([G]))):(H=[G],U=M(G)),u(H,X),L.throttle(K,D.SELECTDELAY,function(){J=[];var e=[],t,a;for(q=0;q<Q.length;q++)if(Y=Q[q],a=Y._module.selectPoints(Y,U),e.push(a),t=b(a,Y),J.length)for(var r=0;r<t.length;r++)J.push(t[r]);else J=t;W={points:J},x(m,Q,W),$(W,G,V),o.gd.emit("plotly_selecting",W)})},o.clickFn=function(e,t){var a=y.clickmode;Z.remove(),L.done(K).then(function(){if(L.clear(K),2===e){for(X.remove(),q=0;q<Q.length;q++)Y=Q[q],Y._module.selectPoints(Y,!1);x(m,Q),c(o),m.emit("plotly_deselect",null)}else-1<a.indexOf("select")&&r(t,m,o.xaxes,o.yaxes,o.subplot,o,X),"event"===a&&m.emit("plotly_selected",void 0);A.click(m,t)}).catch(S.error)},o.doneFn=function(){Z.remove(),L.done(K).then(function(){L.clear(K),o.gd.emit("plotly_selected",W),G&&o.selectionDefs&&(G.subtract=N,o.selectionDefs.push(G),o.mergedPolygons.length=0,[].push.apply(o.mergedPolygons,H)),o.doneFnCompleted&&o.doneFnCompleted(J)}).catch(S.error)}},clearSelect:v,selectOnClick:r}},{"../../components/color":593,"../../components/fx":632,"../../components/fx/helpers":628,"../../lib":719,"../../lib/clear_gl_canvases":704,"../../lib/polygon":731,"../../lib/throttle":744,"../../plot_api/subroutines":758,"../../registry":847,"./axis_ids":770,"./constants":773,polybooljs:473}],785:[function(e,t){"use strict";function a(e){return ya(10,e)}function r(e){return null!==e&&e!==void 0}var o=e("d3"),n=e("fast-isnumeric"),l=e("../../lib"),s=l.cleanNumber,d=l.ms2DateTime,c=l.dateTime2ms,p=l.ensureNumber,u=l.isArrayOrTypedArray,g=e("../../constants/numerical"),h=g.FP_SAFE,m=g.BADNUM,y=g.LOG_CLIP,f=e("./constants"),x=e("./axis_ids");t.exports=function(e,t){function i(t,a){if(0<t)return P(t)/I;if(0>=t&&a&&e.range&&2===e.range.length){var r=e.range[0],o=e.range[1];return .5*(r+o-2*y*_a(r-o))}return m}function g(t,a,r){var o=c(t,r||e.calendar);if(o===m)if(n(t)){t=+t;var i=ba(10*l.mod(t+.05,1)),s=V(t-i/10);o=c(new Date(s))+i/10}else return m;return o}function _(t,a,r){return d(t,a,r||e.calendar)}function b(t){return e._categories[V(t)]}function v(t){if(r(t)){if(void 0===e._categoriesMap&&(e._categoriesMap={}),void 0!==e._categoriesMap[t])return e._categoriesMap[t];e._categories.push("number"==typeof t?t+"":t);var a=e._categories.length-1;return e._categoriesMap[t]=a,a}return m}function k(e,t){for(var a=Array(t),r=0;r<t;r++){var o=(e[0]||[])[r],n=(e[1]||[])[r];a[r]=w([o,n])}return a}function w(t){if(e._categoriesMap)return e._categoriesMap[t]}function T(e){var t=w(e);return void 0===t?n(e)?+e:void 0:t}function A(t){return n(t)?o.round(e._b+e._m*t,2):m}function S(t){return(t-e._b)/e._m}t=t||{};var C=e._id||"x",L=C.charAt(0);e.c2l="log"===e.type?i:p,e.l2c="log"===e.type?a:p,e.l2p=A,e.p2l=S,e.c2p="log"===e.type?function(e,t){return A(i(e,t))}:A,e.p2c="log"===e.type?function(e){return a(S(e))}:S,-1===["linear","-"].indexOf(e.type)?"log"===e.type?(e.d2r=e.d2l=function(e,t){return i(s(e),t)},e.r2d=e.r2c=function(e){return a(s(e))},e.d2c=e.r2l=s,e.c2d=e.l2r=p,e.c2r=i,e.l2d=a,e.d2p=function(t,a){return e.l2p(e.d2r(t,a))},e.p2d=function(e){return a(S(e))},e.r2p=function(t){return e.l2p(s(t))},e.p2r=S,e.cleanPos=p):"date"===e.type?(e.d2r=e.r2d=l.identity,e.d2c=e.r2c=e.d2l=e.r2l=g,e.c2d=e.c2r=e.l2d=e.l2r=_,e.d2p=e.r2p=function(t,a,r){return e.l2p(g(t,0,r))},e.p2d=e.p2r=function(e,t,a){return _(S(e),t,a)},e.cleanPos=function(t){return l.cleanDate(t,m,e.calendar)}):"category"===e.type?(e.d2c=e.d2l=v,e.r2d=e.c2d=e.l2d=b,e.d2r=e.d2l_noadd=T,e.r2c=function(t){var a=T(t);return a===void 0?e.fraction2r(.5):a},e.l2r=e.c2r=p,e.r2l=T,e.d2p=function(t){return e.l2p(e.r2c(t))},e.p2d=function(e){return b(S(e))},e.r2p=e.d2p,e.p2r=S,e.cleanPos=function(e){return"string"==typeof e&&""!==e?e:p(e)}):"multicategory"===e.type&&(e.r2d=e.c2d=e.l2d=b,e.d2r=e.d2l_noadd=T,e.r2c=function(t){var a=T(t);return a===void 0?e.fraction2r(.5):a},e.r2c_just_indices=w,e.l2r=e.c2r=p,e.r2l=T,e.d2p=function(t){return e.l2p(e.r2c(t))},e.p2d=function(e){return b(S(e))},e.r2p=e.d2p,e.p2r=S,e.cleanPos=function(e){return Array.isArray(e)||"string"==typeof e&&""!==e?e:p(e)},e.setupMultiCategory=function(a){var o=e._traceIndices,n=t._axisMatchGroups,s,d;if(n&&n.length&&0===e._categories.length)for(s=0;s<n.length;s++){var c=n[s];if(c[C])for(var p in c)if(p!==C){var g=t[x.id2name(p)];o=o.concat(g._traceIndices)}}var h=[[0,{}],[0,{}]],m=[];for(s=0;s<o.length;s++){var y=a[o[s]];if(L in y){var f=y[L],_=y._length||l.minRowLength(f);if(u(f[0])&&u(f[1]))for(d=0;d<_;d++){var b=f[0][d],k=f[1][d];r(b)&&r(k)&&(m.push([b,k]),!(b in h[0][1])&&(h[0][1][b]=h[0][0]++),!(k in h[1][1])&&(h[1][1][k]=h[1][0]++))}}}for(m.sort(function(e,t){var a=h[0][1],r=a[e[0]]-a[t[0]];if(r)return r;var o=h[1][1];return o[e[1]]-o[t[1]]}),s=0;s<m.length;s++)v(m[s])}):(e.d2r=e.r2d=e.d2c=e.r2c=e.d2l=e.r2l=s,e.c2d=e.c2r=e.l2d=e.l2r=p,e.d2p=e.r2p=function(t){return e.l2p(s(t))},e.p2d=e.p2r=S,e.cleanPos=p),e.fraction2r=function(t){var a=e.r2l(e.range[0]),r=e.r2l(e.range[1]);return e.l2r(a+t*(r-a))},e.r2fraction=function(t){var a=e.r2l(e.range[0]),r=e.r2l(e.range[1]);return(e.r2l(t)-a)/(r-a)},e.cleanRange=function(t,a){a||(a={}),t||(t="range");var r=l.nestedProperty(e,t).get(),o,s;if(s="date"===e.type?l.dfltRange(e.calendar):"y"===L?f.DFLTRANGEY:a.dfltRange||f.DFLTRANGEX,s=s.slice(),!r||2!==r.length)return void l.nestedProperty(e,t).set(s);for("date"!==e.type||e.autorange||(r[0]=l.cleanDate(r[0],m,e.calendar),r[1]=l.cleanDate(r[1],m,e.calendar)),o=0;2>o;o++)if("date"===e.type){if(!l.isDateTime(r[o],e.calendar)){e[t]=s;break}if(e.r2l(r[0])===e.r2l(r[1])){var d=l.constrain(e.r2l(r[0]),l.MIN_MS+1e3,l.MAX_MS-1e3);r[0]=e.l2r(d-1e3),r[1]=e.l2r(d+1e3);break}}else{if(!n(r[o]))if(n(r[1-o]))r[o]=r[1-o]*(o?10:.1);else{e[t]=s;break}if(r[o]<-h?r[o]=-h:r[o]>h&&(r[o]=h),r[0]===r[1]){var c=va(1,_a(1e-6*r[0]));r[0]-=c,r[1]+=c}}},e.setScale=function(a){var r=t._size;if(e.overlaying){var o=x.getFromId({_fullLayout:t},e.overlaying);e.domain=o.domain}var i=a&&e._r?"_r":"range",n=e.calendar;e.cleanRange(i);var l=e.r2l(e[i][0],n),s=e.r2l(e[i][1],n);if("y"===L?(e._offset=r.t+(1-e.domain[1])*r.h,e._length=r.h*(e.domain[1]-e.domain[0]),e._m=e._length/(l-s),e._b=-e._m*s):(e._offset=r.l+e.domain[0]*r.w,e._length=r.w*(e.domain[1]-e.domain[0]),e._m=e._length/(s-l),e._b=-e._m*l),!isFinite(e._m)||!isFinite(e._b)||0>e._length)throw t._replotting=!1,new Error("Something went wrong with axis scaling")},e.makeCalcdata=function(t,a){var r=e.type,o="date"===r&&t[a+"calendar"],n,s,d,c;if(a in t){if(n=t[a],c=t._length||l.minRowLength(n),l.isTypedArray(n)&&("linear"===r||"log"===r)){if(c===n.length)return n;if(n.subarray)return n.subarray(0,c)}if("multicategory"===r)return k(n,c);for(s=Array(c),d=0;d<c;d++)s[d]=e.d2c(n[d],0,o)}else{var p=a+"0"in t?e.d2c(t[a+"0"],0,o):0,u=t["d"+a]?+t["d"+a]:1;for(n=t[{x:"y",y:"x"}[a]],c=t._length||n.length,s=Array(c),d=0;d<c;d++)s[d]=p+d*u}return s},e.isValidRange=function(t){return Array.isArray(t)&&2===t.length&&n(e.r2l(t[0]))&&n(e.r2l(t[1]))},e.isPtWithinRange=function(t,a){var r=e.c2l(t[L],null,a),o=e.r2l(e.range[0]),i=e.r2l(e.range[1]);return o<i?o<=r&&r<=i:i<=r&&r<=o},e.clearCalc=function(){var a=function(){e._categories=[],e._categoriesMap={}},r=t._axisMatchGroups;if(r&&r.length){for(var o=!1,n=0,l;n<r.length;n++)if(l=r[n],l[C]){o=!0;var s=null,d=null;for(var c in l){var p=t[x.id2name(c)];if(p._categories){s=p._categories,d=p._categoriesMap;break}}s&&d?(e._categories=s,e._categoriesMap=d):a();break}o||a()}else a();if(e._initialCategories)for(var u=0;u<e._initialCategories.length;u++)v(e._initialCategories[u])},e.sortByInitialCategories=function(){var a=[];if(function(){e._categories=[],e._categoriesMap={}}(),e._initialCategories)for(var r=0;r<e._initialCategories.length;r++)v(e._initialCategories[r]);a=a.concat(e._traceIndices);var o=e._matchGroup;for(var i in o)if(C!==i){var n=t[x.id2name(i)];n._categories=e._categories,n._categoriesMap=e._categoriesMap,a=a.concat(n._traceIndices)}return a};var E=t._d3locale;"date"===e.type&&(e._dateFormat=E?E.timeFormat.utc:o.time.format.utc,e._extraFormat=t._extraFormat),e._separators=t.separators,e._numFormat=E?E.numberFormat:o.format,delete e._minDtick,delete e._forceTick0}},{"../../constants/numerical":695,"../../lib":719,"./axis_ids":770,"./constants":773,d3:163,"fast-isnumeric":225}],786:[function(e,t){"use strict";function a(e,t,a,r,i){var n=o(e),l=a("tickprefix");l&&a("showtickprefix",n);var s=a("ticksuffix",i.tickSuffixDflt);s&&a("showticksuffix",n)}function r(e,t,a,r,d){var c=o(e),p=a("tickprefix");p&&a("showtickprefix",c);var u=a("ticksuffix",d.tickSuffixDflt);u&&a("showticksuffix",c);var g=a("showticklabels");if(g){var h=d.font||{},m=t.color,y=m&&m!==l.color.dflt?m:h.color;if(n.coerceFont(a,"tickfont",{family:h.family,size:h.size,color:y}),a("tickangle"),"category"!==r){var f=a("tickformat"),x=e.tickformatstops;Array.isArray(x)&&x.length&&s(e,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:i}),f||"date"===r||(a("showexponent",c),a("exponentformat"),a("separatethousands"))}}}function o(e){var t=["showexponent","showtickprefix","showticksuffix"].filter(function(t){return e[t]!==void 0});if(t.every(function(r){return e[r]===e[t[0]]})||1===t.length)return e[t[0]]}function i(e,t){function a(a,r){return n.coerce(e,t,l.tickformatstops,a,r)}var r=a("enabled");r&&(a("dtickrange"),a("value"))}var n=e("../../lib"),l=e("./layout_attributes"),s=e("../array_container_defaults");t.exports=function(e,t,o,i,n,l){l&&1!==l.pass||a(e,t,o,i,n),l&&2!==l.pass||r(e,t,o,i,n)}},{"../../lib":719,"../array_container_defaults":763,"./layout_attributes":779}],787:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t,o,i){var n=a.coerce2(e,t,r,"ticklen"),l=a.coerce2(e,t,r,"tickwidth"),s=a.coerce2(e,t,r,"tickcolor",t.color),d=o("ticks",i.outerTicks||n||l||s?"outside":"");d||(delete t.ticklen,delete t.tickwidth,delete t.tickcolor)}},{"../../lib":719,"./layout_attributes":779}],788:[function(e,t){"use strict";var a=e("./clean_ticks");t.exports=function(e,t,r,o){var i;if("array"===e.tickmode&&("log"===o||"date"===o))i=t.tickmode="auto";else{var n=Array.isArray(e.tickvals)?"array":e.dtick?"linear":"auto";i=r("tickmode",n)}if("auto"===i)r("nticks");else if("linear"===i){var l=t.dtick=a.dtick(e.dtick,o);t.tick0=a.tick0(e.tick0,o,t.calendar,l)}else if("multicategory"!==o){var s=r("tickvals");void 0===s?t.tickmode="auto":r("ticktext")}}},{"./clean_ticks":772}],789:[function(e,t){"use strict";var a=e("d3"),r=e("../../registry"),o=e("../../components/drawing"),i=e("./axes");t.exports=function(e,t,n,l){function s(e){var t=e.xaxis,a=e.yaxis;g._defs.select("#"+e.clipId+"> rect").call(o.setTranslate,0,0).call(o.setScale,1,1),e.plot.call(o.setTranslate,t._offset,a._offset).call(o.setScale,1,1);var r=e.plot.selectAll(".scatterlayer .trace");r.selectAll(".point").call(o.setPointGroupScale,1,1),r.selectAll(".textpoint").call(o.setTextPointsScale,1,1),r.call(o.hideOutsideRangePoints,e)}function d(t,a){var r=t.plotinfo,n=r.xaxis,l=r.yaxis,s=t.xr0,d=t.xr1,c=n._length,p=t.yr0,u=t.yr1,g=l._length,h=!!d,m=!!u,y=[];if(h){var f=s[1]-s[0],x=d[1]-d[0];y[0]=(s[0]*(1-a)+a*d[0]-s[0])/(s[1]-s[0])*c,y[2]=c*(1-a+a*x/f),n.range[0]=s[0]*(1-a)+a*d[0],n.range[1]=s[1]*(1-a)+a*d[1]}else y[0]=0,y[2]=c;if(m){var _=p[1]-p[0],b=u[1]-u[0];y[1]=(p[1]*(1-a)+a*u[1]-p[1])/(p[0]-p[1])*g,y[3]=g*(1-a+a*b/_),l.range[0]=p[0]*(1-a)+a*u[0],l.range[1]=p[1]*(1-a)+a*u[1]}else y[1]=0,y[3]=g;i.drawOne(e,n,{skipTitle:!0}),i.drawOne(e,l,{skipTitle:!0}),i.redrawComponents(e,[n._id,l._id]);var v=h?c/y[2]:1,k=m?g/y[3]:1,w=h?y[0]:0,T=m?y[1]:0,A=h?y[0]/y[2]*c:0,S=m?y[1]/y[3]*g:0,C=n._offset-A,L=l._offset-S;r.clipRect.call(o.setTranslate,w,T).call(o.setScale,1/v,1/k),r.plot.call(o.setTranslate,C,L).call(o.setScale,v,k),o.setPointGroupScale(r.zoomScalePts,1/v,1/k),o.setTextPointsScale(r.zoomScaleTxt,1/v,1/k)}function c(){for(var a={},o=0,n;o<t.length;o++)n=t[o],n.xr1&&(a[n.plotinfo.xaxis._name+".range"]=n.xr1.slice()),n.yr1&&(a[n.plotinfo.yaxis._name+".range"]=n.yr1.slice());return h&&h(),r.call("relayout",e,a).then(function(){for(var e=0;e<t.length;e++)s(t[e].plotinfo)})}function p(){for(var a={},o=0,n;o<t.length;o++)n=t[o],n.xr0&&(a[n.plotinfo.xaxis._name+".range"]=n.xr0.slice()),n.yr0&&(a[n.plotinfo.yaxis._name+".range"]=n.yr0.slice());return r.call("relayout",e,a).then(function(){for(var e=0;e<t.length;e++)s(t[e].plotinfo)})}function u(){f=Date.now();for(var e=ea(1,(f-y)/n.duration),a=m(e),r=0;r<t.length;r++)d(t[r],a);f-y>n.duration?(c(),x=window.cancelAnimationFrame(u)):x=window.requestAnimationFrame(u)}var g=e._fullLayout;if(0===t.length)return void i.redrawComponents(e);var h;l&&(h=l());var m=a.ease(n.easing),y,f,x;return e._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(x),x=null,p()}),y=Date.now(),x=window.requestAnimationFrame(u),Promise.resolve()}},{"../../components/drawing":614,"../../registry":847,"./axes":767,d3:163}],790:[function(e,t){"use strict";function a(e,t){if("-"===e.type){var a=e._id,d=a.charAt(0);-1!==a.indexOf("scene")&&(a=d);var c=r(t,a,d);if(c){if("histogram"===c.type&&d==={v:"y",h:"x"}[c.orientation||"v"])return void(e.type="linear");var p=d+"calendar",u=c[p],g={noMultiCategory:!l(c,"cartesian")||l(c,"noMultiCategory")},h;if(n(c,d)){var m=o(c),y=[];for(h=0;h<t.length;h++){var f=t[h];!l(f,"box-violin")||(f[d+"axis"]||d)!==a||(void 0===f[m]?void 0===f.name?y.push("text"):y.push(f.name):y.push(f[m][0]),f[p]!==u&&(u=void 0))}e.type=s(y,u,g)}else if("splom"===c.type){var x=c.dimensions,_=x[c._axesDim[a]];_.visible&&(e.type=s(_.values,u,g))}else e.type=s(c[d]||[c[d+"0"]],u,g)}}}function r(e,t,a){for(var r=0,o;r<e.length;r++){if(o=e[r],"splom"===o.type&&0<o._length&&(o["_"+a+"axes"]||{})[t])return o;if((o[a+"axis"]||a)===t){if(n(o,a))return o;if((o[a]||[]).length||o[a+"0"])return o}}}function o(e){return{v:"x",h:"y"}[e.orientation||"v"]}function n(e,t){var a=o(e),r=l(e,"box-violin"),i=l(e._fullInput||{},"candlestick");return r&&!i&&t===a&&e[a]===void 0&&e[a+"0"]===void 0}var l=e("../../registry").traceIs,s=e("./axis_autotype");t.exports=function(e,t,r,o){var i=r("type",(o.splomStash||{}).type);"-"===i&&(a(t,o.data),"-"===t.type?t.type="linear":e.type=t.type)}},{"../../registry":847,"./axis_autotype":768}],791:[function(e,t,a){"use strict";function r(e,t,a){var r=!1,o,i,n;if("data"===t.type)o=e._fullData[null===t.traces?0:t.traces[0]];else if("layout"===t.type)o=e._fullLayout;else return!1;return i=d.nestedProperty(o,t.prop).get(),n=a[t.type]=a[t.type]||{},n.hasOwnProperty(t.prop)&&n[t.prop]!==i&&(r=!0),n[t.prop]=i,{changed:r,value:i}}function o(e,t){return Array.isArray(t[0])&&1===t[0].length&&-1!==["string","number"].indexOf(typeof t[0][0])?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function i(e,t){var a=[],r=t[0],o={};if("string"==typeof r)o[r]=t[1];else if(d.isPlainObject(r))o=r;else return a;return l(o,function(e,t,r){a.push({type:"layout",prop:e,value:r})},"",0),a}function n(e,t){var a=[],r,o,i,n;if(o=t[0],i=t[1],r=t[2],n={},"string"==typeof o)n[o]=i;else if(d.isPlainObject(o))n=o,void 0===r&&(r=i);else return a;return void 0===r&&(r=null),l(n,function(t,o,n){var l,s;if(Array.isArray(n)){s=n.slice();var d=ea(s.length,e.data.length);r&&(d=ea(d,r.length)),l=[];for(var c=0;c<d;c++)l[c]=r?r[c]:c}else s=n,l=r?r.slice():null;if(null===l)Array.isArray(s)&&(s=s[0]);else if(Array.isArray(l)){if(!Array.isArray(s)){var p=s;s=[];for(var u=0;u<l.length;u++)s[u]=p}s.length=ea(l.length,s.length)}a.push({type:"data",prop:t,traces:l,value:s})},"",0),a}function l(e,t,a,r){Object.keys(e).forEach(function(o){var i=e[o];if("_"!==o[0]){var n=a+(0<r?".":"")+o;d.isPlainObject(i)?l(i,t,n,r+1):t(n,o,i)}})}var s=e("../registry"),d=e("../lib");a.manageCommandObserver=function(e,t,o,n){var l={},s=!0;t&&t._commandObserver&&(l=t._commandObserver),l.cache||(l.cache={}),l.lookupTable={};var c=a.hasSimpleAPICommandBindings(e,o,l.lookupTable);if(t&&t._commandObserver){if(!!c)return l;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,l}if(c){r(e,c,l.cache),l.check=function(){if(s){var t=r(e,c,l.cache);return t.changed&&n&&void 0!==l.lookupTable[t.value]&&(l.disable(),Promise.resolve(n({value:t.value,type:c.type,prop:c.prop,traces:c.traces,index:l.lookupTable[t.value]})).then(l.enable,l.enable)),t.changed}};for(var p=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],u=0;u<p.length;u++)e._internalOn(p[u],l.check);l.remove=function(){for(var t=0;t<p.length;t++)e._removeInternalListener(p[t],l.check)}}else d.log("Unable to automatically bind plot updates to API command"),l.lookupTable={},l.remove=function(){};return l.disable=function(){s=!1},l.enable=function(){s=!0},t&&(t._commandObserver=l),l},a.hasSimpleAPICommandBindings=function(e,t,r){var o=t.length,n,l;for(n=0;n<o;n++){var s=t[n],d=s.method,c=s.args,p;if(Array.isArray(c)||(c=[]),!d)return!1;var u=a.computeAPICommandBindings(e,d,c);if(1!==u.length)return!1;if(!l)l=u[0],Array.isArray(l.traces)&&l.traces.sort();else{if(p=u[0],p.type!==l.type)return!1;if(p.prop!==l.prop)return!1;if(Array.isArray(l.traces)){if(Array.isArray(p.traces)){p.traces.sort();for(var g=0;g<l.traces.length;g++)if(l.traces[g]!==p.traces[g])return!1}else return!1;}else if(p.prop!==l.prop)return!1}p=u[0];var h=p.value;if(Array.isArray(h))if(1===h.length)h=h[0];else return!1;r&&(r[h]=n)}return l},a.executeAPICommand=function(e,t,a){if("skip"===t)return Promise.resolve();var r=s.apiMethodRegistry[t],o=[e];Array.isArray(a)||(a=[]);for(var n=0;n<a.length;n++)o.push(a[n]);return r.apply(null,o).catch(function(e){return d.warn("API call to Plotly."+t+" rejected.",e),Promise.reject(e)})},a.computeAPICommandBindings=function(e,t,a){var r;return Array.isArray(a)||(a=[]),r="restyle"===t?n(e,a):"relayout"===t?i(e,a):"update"===t?n(e,[a[0],a[2]]).concat(i(e,[a[1]])):"animate"===t?o(e,a):[],r}},{"../lib":719,"../registry":847}],792:[function(e,t,a){"use strict";var r=e("../lib/extend").extendFlat;a.attributes=function(e,t){e=e||{},t=t||{};var a={valType:"info_array",editType:e.editType,items:[{valType:"number",min:0,max:1,editType:e.editType},{valType:"number",min:0,max:1,editType:e.editType}],dflt:[0,1]},o=e.name?e.name+" ":"",i=e.trace?"trace ":"subplot ",n=t.description?" "+t.description:"",l={x:r({},a,{}),y:r({},a,{}),editType:e.editType};return e.noGridCell||(l.row={valType:"integer",min:0,dflt:0,editType:e.editType},l.column={valType:"integer",min:0,dflt:0,editType:e.editType}),l},a.defaults=function(e,t,a,r){var o=r&&r.x||[0,1],i=r&&r.y||[0,1],n=t.grid;if(n){var l=a("domain.column");l!==void 0&&(l<n.columns?o=n._domains.x[l]:delete e.domain.column);var s=a("domain.row");s!==void 0&&(s<n.rows?i=n._domains.y[s]:delete e.domain.row)}a("domain.x",o),a("domain.y",i)}},{"../lib/extend":710}],793:[function(e,t){"use strict";t.exports=function(e){var t=e.editType,a=e.colorEditType;void 0===a&&(a=t);var r={family:{valType:"string",noBlank:!0,strict:!0,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:a},editType:t};return e.arrayOk&&(r.family.arrayOk=!0,r.size.arrayOk=!0,r.color.arrayOk=!0),r}},{}],794:[function(e,t){"use strict";t.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],795:[function(e,t,a){"use strict";a.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"},a.axesNames=["lonaxis","lataxis"],a.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},a.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},a.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},a.clipPad=1e-3,a.precision=.1,a.landColor="#F0DC82",a.waterColor="#3399FF",a.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},a.sphereSVG={type:"Sphere"},a.fillLayers={ocean:1,land:1,lakes:1},a.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},a.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],a.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],a.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],796:[function(e,t){"use strict";function a(e){this.id=e.id,this.graphDiv=e.graphDiv,this.container=e.container,this.topojsonURL=e.topojsonURL,this.isStatic=e.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}function r(e){for(var t=e.projection,a=t.type,o=l.geo[_.projNames[a]](),n=e._isClipped?_.lonaxisSpan[a]/2:null,s=["center","rotate","parallels","clipExtent"],d=function(e){return e?o:[]},c=0,r;c<s.length;c++)r=s[c],"function"!=typeof o[r]&&(o[r]=d);return o.isLonLatOverEdges=function(e){if(null===o(e))return!0;if(n){var t=o.rotate(),a=l.geo.distance(e,[-t[0],-t[1]]);return a>n*Pe/180}return!1},o.getPath=function(){return l.geo.path().projection(o)},o.getBounds=function(e){return o.getPath().bounds(e)},o.fitExtent=function(e,t){var a=e[1][0]-e[0][0],r=e[1][1]-e[0][1],i=o.clipExtent&&o.clipExtent();o.scale(150).translate([0,0]),i&&o.clipExtent(null);var n=o.getBounds(t),l=ea(a/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),s=+e[0][0]+(a-l*(n[1][0]+n[0][0]))/2,d=+e[0][1]+(r-l*(n[1][1]+n[0][1]))/2;return i&&o.clipExtent(i),o.scale(150*l).translate([s,d])},o.precision(_.precision),n&&o.clipAngle(n-_.clipPad),o}function o(e,t,a){var r=2.5,o=t[e],n=_.scopeDefaults[t.scope],s,d,c;"lonaxis"===e?(s=n.lonaxisRange,d=n.lataxisRange,c=function(e,t){return[e,t]}):"lataxis"==e&&(s=n.lataxisRange,d=n.lonaxisRange,c=function(e,t){return[t,e]});var p={type:"linear",range:[s[0],s[1]-1e-6],tick0:o.tick0,dtick:o.dtick};h.setConvert(p,a);var u=h.calcTicks(p);t.isScoped||"lonaxis"!==e||u.pop();for(var g=u.length,m=Array(g),y=0;y<g;y++)for(var f=u[y].x,x=m[y]=[],b=d[0];b<d[1]+r;b+=r)x.push(c(f,b));return{type:"MultiLineString",coordinates:m}}function n(e,t){var a=_.clipPad,r=e[0]+a,o=e[1]-a,i=t[0]+a,n=t[1]-a;0<r&&0>o&&(o+=360);var l=(o-r)/4;return{type:"Polygon",coordinates:[[[r,i],[r,n],[r+l,n],[r+2*l,n],[r+3*l,n],[o,n],[o,i],[o-l,i],[o-2*l,i],[o-3*l,i],[r,i]]]}}var l=e("d3"),s=e("../../registry"),d=e("../../lib"),c=e("../../components/color"),p=e("../../components/drawing"),u=e("../../components/fx"),g=e("../plots"),h=e("../cartesian/axes"),m=e("../../components/dragelement"),y=e("../cartesian/select").prepSelect,f=e("../cartesian/select").selectOnClick,x=e("./zoom"),_=e("./constants"),b=e("../../lib/topojson_utils"),v=e("topojson-client").feature;e("./projections")(l);var k=a.prototype;t.exports=function(e){return new a(e)},k.plot=function(e,t,a){var r=this,o=t[this.id],n=!1;for(var l in _.layerNameToAdjective)if("frame"!=l&&o["show"+l]){n=!0;break}for(var s=0;s<e.length;s++)if(e[0][0].trace.locationmode){n=!0;break}if(!n)return r.update(e,t);var d=b.getTopojsonName(o);null===r.topojson||d!==r.topojsonName?(r.topojsonName=d,PlotlyGeoAssets.topojson[r.topojsonName]===void 0?a.push(r.fetchTopojson().then(function(a){PlotlyGeoAssets.topojson[r.topojsonName]=a,r.topojson=a,r.update(e,t)})):(r.topojson=PlotlyGeoAssets.topojson[r.topojsonName],r.update(e,t))):r.update(e,t)},k.fetchTopojson=function(){var e=b.getTopojsonPath(this.topojsonURL,this.topojsonName);return new Promise(function(t,a){l.json(e,function(r,o){return r?404===r.status?a(new Error(["plotly.js could not find topojson file at",e,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):a(new Error(["unexpected error while fetching topojson file at",e].join(" "))):void t(o)})})},k.update=function(e,t){var a=t[this.id],r=this.updateProjection(t,a);if(!r){this.hasChoropleth=!1;for(var o=0;o<e.length;o++)if("choropleth"===e[o][0].trace.type){this.hasChoropleth=!0;break}this.viewInitial&&this.scope===a.scope||this.saveViewInitial(a),this.scope=a.scope,this.updateBaseLayers(t,a),this.updateDims(t,a),this.updateFx(t,a),g.generalUpdatePerTraceModule(this.graphDiv,this,e,a);var n=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=n.selectAll(".point"),this.dataPoints.text=n.selectAll("text"),this.dataPaths.line=n.selectAll(".js-line");var l=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=l.selectAll("path"),this.render()}},k.updateProjection=function(e,a){var o=e._size,l=a.domain,c=a.projection,p=c.rotation||{},u=a.center||{},g=this.projection=r(a);g.center([u.lon-p.lon,u.lat-p.lat]).rotate([-p.lon,-p.lat,p.roll]).parallels(c.parallels);var h=[[o.l+o.w*l.x[0],o.t+o.h*(1-l.y[1])],[o.l+o.w*l.x[1],o.t+o.h*(1-l.y[0])]],m=a.lonaxis,y=a.lataxis,f=n(m.range,y.range);g.fitExtent(h,f);var x=this.bounds=g.getBounds(f),_=this.fitScale=g.scale(),b=g.translate();if(!isFinite(x[0][0])||!isFinite(x[0][1])||!isFinite(x[1][0])||!isFinite(x[1][1])||isNaN(b[0])||isNaN(b[0])){for(var t=this.graphDiv,v=["projection.rotation","center","lonaxis.range","lataxis.range"],k="Invalid geo settings, relayout'ing to default view.",w={},T=0;T<v.length;T++)w[this.id+"."+v[T]]=null;return this.viewInitial=null,d.warn(k),t._promises.push(s.call("relayout",t,w)),k}var A=this.midPt=[(x[0][0]+x[1][0])/2,(x[0][1]+x[1][1])/2];if(g.scale(c.scale*_).translate([b[0]+(A[0]-b[0]),b[1]+(A[1]-b[1])]).clipExtent(x),a._isAlbersUsa){var S=g([u.lon,u.lat]),C=g.translate();g.translate([C[0]-(S[0]-C[0]),C[1]-(S[1]-C[1])])}},k.updateBaseLayers=function(e,t){function a(e){return"lonaxis"===e||"lataxis"===e}function r(e){return!!_.lineLayers[e]}function i(e){return!!_.fillLayers[e]}var n=this,s=n.topojson,u=n.layers,g=n.basePaths,h=this.hasChoropleth?_.layersForChoropleth:_.layers,m=h.filter(function(e){return r(e)||i(e)?t["show"+e]:!a(e)||t[e].showgrid}),y=n.framework.selectAll(".layer").data(m,String);y.exit().each(function(e){delete u[e],delete g[e],l.select(this).remove()}),y.enter().append("g").attr("class",function(e){return"layer "+e}).each(function(e){var t=u[e]=l.select(this);"bg"===e?n.bgRect=t.append("rect").style("pointer-events","all"):a(e)?g[e]=t.append("path").style("fill","none"):"backplot"===e?t.append("g").classed("choroplethlayer",!0):"frontplot"===e?t.append("g").classed("scatterlayer",!0):r(e)?g[e]=t.append("path").style("fill","none").style("stroke-miterlimit",2):i(e)&&(g[e]=t.append("path").style("stroke","none"))}),y.order(),y.each(function(n){var l=g[n],d=_.layerNameToAdjective[n];"frame"===n?l.datum(_.sphereSVG):r(n)||i(n)?l.datum(v(s,s.objects[n])):a(n)&&l.datum(o(n,t,e)).call(c.stroke,t[n].gridcolor).call(p.dashLine,"",t[n].gridwidth),r(n)?l.call(c.stroke,t[d+"color"]).call(p.dashLine,"",t[d+"width"]):i(n)&&l.call(c.fill,t[d+"color"])})},k.updateDims=function(e,a){var r=this.bounds,o=(a.framewidth||0)/2,i=r[0][0]-o,n=r[0][1]-o,t=r[1][0]-i+o,l=r[1][1]-n+o;p.setRect(this.clipRect,i,n,t,l),this.bgRect.call(p.setRect,i,n,t,l).call(c.fill,a.bgcolor),this.xaxis._offset=i,this.xaxis._length=t,this.yaxis._offset=n,this.yaxis._length=l},k.updateFx=function(e,t){function a(){var e=o.viewInitial,t={};for(var a in e)t[o.id+"."+a]=e[a];s.call("_guiRelayout",i,t),i.emit("plotly_doubleclick",null)}function r(e){return o.projection.invert([e[0]+o.xaxis._offset,e[1]+o.yaxis._offset])}var o=this,i=o.graphDiv,n=o.bgRect,d=e.dragmode,c=e.clickmode;if(!o.isStatic){var p;"select"===d?p=function(e,t){var a=e.range={};a[o.id]=[r([t.xmin,t.ymin]),r([t.xmax,t.ymax])]}:"lasso"===d&&(p=function(e,t,a){var i=e.lassoPoints={};i[o.id]=a.filtered.map(r)});var g={element:o.bgRect.node(),gd:i,plotinfo:{id:o.id,xaxis:o.xaxis,yaxis:o.yaxis,fillRangeItems:p},xaxes:[o.xaxis],yaxes:[o.yaxis],subplot:o.id,clickFn:function(t){2===t&&e._zoomlayer.selectAll(".select-outline").remove()}};"pan"===d?(n.node().onmousedown=null,n.call(x(o,t)),n.on("dblclick.zoom",a),!i._context._scrollZoom.geo&&n.on("wheel.zoom",null)):("select"===d||"lasso"===d)&&(n.on(".zoom",null),g.prepFn=function(t,e,a){y(t,e,a,g,d)},m.init(g)),n.on("mousemove",function(){var e=o.projection.invert(l.mouse(this));return!e||isNaN(e[0])||isNaN(e[1])?m.unhover(i,l.event):void(o.xaxis.p2c=function(){return e[0]},o.yaxis.p2c=function(){return e[1]},u.hover(i,l.event,o.id))}),n.on("mouseout",function(){i._dragging||m.unhover(i,l.event)}),n.on("click",function(){"select"!==d&&"lasso"!==d&&(-1<c.indexOf("select")&&f(l.event,i,[o.xaxis],[o.yaxis],o.id,g),-1<c.indexOf("event")&&u.click(i,l.event))})}},k.makeFramework=function(){var e=this,t=e.graphDiv,a=t._fullLayout,r="clip"+a._uid+e.id;e.clipDef=a._clips.append("clipPath").attr("id",r),e.clipRect=e.clipDef.append("rect"),e.framework=l.select(e.container).append("g").attr("class","geo "+e.id).call(p.setClipUrl,r,t),e.project=function(t){var a=e.projection(t);return a?[a[0]-e.xaxis._offset,a[1]-e.yaxis._offset]:[null,null]},e.xaxis={_id:"x",c2p:function(t){return e.project(t)[0]}},e.yaxis={_id:"y",c2p:function(t){return e.project(t)[1]}},e.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},h.setConvert(e.mockAxis,a)},k.saveViewInitial=function(e){var t=e.center||{},a=e.projection,r=a.rotation||{};this.viewInitial=e._isScoped?{"center.lon":t.lon,"center.lat":t.lat,"projection.scale":a.scale}:e._isClipped?{"projection.scale":a.scale,"projection.rotation.lon":r.lon,"projection.rotation.lat":r.lat}:{"center.lon":t.lon,"center.lat":t.lat,"projection.scale":a.scale,"projection.rotation.lon":r.lon}},k.render=function(){function e(e){var t=a(e.lonlat);return t?"translate("+t[0]+","+t[1]+")":null}function t(e){return a.isLonLatOverEdges(e.lonlat)?"none":null}var a=this.projection,r=a.getPath(),o;for(o in this.basePaths)this.basePaths[o].attr("d",r);for(o in this.dataPaths)this.dataPaths[o].attr("d",function(e){return r(e.geojson)});for(o in this.dataPoints)this.dataPoints[o].attr("display",t).attr("transform",e)}},{"../../components/color":593,"../../components/dragelement":611,"../../components/drawing":614,"../../components/fx":632,"../../lib":719,"../../lib/topojson_utils":746,"../../registry":847,"../cartesian/axes":767,"../cartesian/select":784,"../plots":828,"./constants":795,"./projections":800,"./zoom":801,d3:163,"topojson-client":540}],797:[function(e,t){"use strict";var a=e("../../plots/get_data").getSubplotCalcData,r=e("../../lib").counterRegex,o=e("./geo"),i="geo",n=r(i),l={};l[i]={valType:"subplotid",dflt:i,editType:"calc"},t.exports={attr:i,name:i,idRoot:i,idRegex:n,attrRegex:n,attributes:l,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:function(e){for(var t=e._fullLayout,r=e.calcdata,n=t._subplots.geo,l=0;l<n.length;l++){var s=n[l],d=a(r,"geo",s),c=t[s],p=c._subplot;p||(p=o({id:s,graphDiv:e,container:t._geolayer.node(),topojsonURL:e._context.topojsonURL,staticPlot:e._context.staticPlot}),t[s]._subplot=p),p.plot(d,t,e._promises)}},updateFx:function(e){for(var t=e._fullLayout,a=t._subplots.geo,r=0;r<a.length;r++){var o=t[a[r]],n=o._subplot;n.updateFx(t,o)}},clean:function(e,t,a,r){for(var o=r._subplots.geo||[],n=0;n<o.length;n++){var l=o[n],s=r[l]._subplot;t[l]||!s||(s.framework.remove(),s.clipDef.remove())}}}},{"../../lib":719,"../../plots/get_data":802,"./geo":796,"./layout_attributes":798,"./layout_defaults":799}],798:[function(e,t){"use strict";var a=e("../../components/color/attributes"),r=e("../domain").attributes,o=e("./constants"),i=e("../../plot_api/edit_types").overrideAll,n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:a.lightLine},gridwidth:{valType:"number",min:0,dflt:1}},l=t.exports=i({domain:r({name:"geo"},{}),resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(o.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(o.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:a.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:o.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:o.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:o.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:o.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:a.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:a.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:a.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:a.background},lonaxis:n,lataxis:n},"plot","from-root");l.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":592,"../../plot_api/edit_types":750,"../domain":792,"./constants":795}],799:[function(e,t){"use strict";function a(e,t,a){var r=a("resolution"),l=a("scope"),s=o.scopeDefaults[l],d=a("projection.type",s.projType),c=t._isAlbersUsa="albers usa"===d,p;c&&(l=t.scope="usa");var u=t._isScoped="world"!==l,g=t._isConic=-1!==d.indexOf("conic");t._isClipped=!!o.lonaxisSpan[d];for(var h=0;h<n.length;h++){var m=n[h],y=[30,10][h],f;if(u)f=s[m+"Range"];else{var x=o[m+"Span"],_=(x[d]||x["*"])/2,b=a("projection.rotation."+m.substr(0,3),s.projRotate[h]);f=[b-_,b+_]}a(m+".range",f),a(m+".tick0"),a(m+".dtick",y),p=a(m+".showgrid"),p&&(a(m+".gridcolor"),a(m+".gridwidth"))}var v=t.lonaxis.range,k=t.lataxis.range,w=v[0],T=v[1];0<w&&0>T&&(T+=360);var A=(w+T)/2,S;if(!c){var C=u?s.projRotate:[A,0,0];S=a("projection.rotation.lon",C[0]),a("projection.rotation.lat",C[1]),a("projection.rotation.roll",C[2]),p=a("showcoastlines",!u),p&&(a("coastlinecolor"),a("coastlinewidth")),p=a("showocean"),p&&a("oceancolor")}var L,E;if(c?(L=-96.6,E=38.7):(L=u?A:S,E=(k[0]+k[1])/2),a("center.lon",L),a("center.lat",E),g){var I=s.projParallels||[0,60];a("projection.parallels",I)}a("projection.scale"),p=a("showland"),p&&a("landcolor"),p=a("showlakes"),p&&a("lakecolor"),p=a("showrivers"),p&&(a("rivercolor"),a("riverwidth")),p=a("showcountries",u&&"usa"!==l),p&&(a("countrycolor"),a("countrywidth")),("usa"===l||"north america"===l&&50===r)&&(a("showsubunits",!0),a("subunitcolor"),a("subunitwidth")),u||(p=a("showframe",!0),p&&(a("framecolor"),a("framewidth"))),a("bgcolor")}var r=e("../subplot_defaults"),o=e("./constants"),i=e("./layout_attributes"),n=o.axesNames;t.exports=function(e,t,o){r(e,t,o,{type:"geo",attributes:i,handleDefaults:a,partition:"y"})}},{"../subplot_defaults":842,"./constants":795,"./layout_attributes":798}],800:[function(e,t){"use strict";t.exports=function(e){function t(e,t){return{type:"Feature",id:e.id,properties:e.properties,geometry:a(e.geometry,t)}}function a(t,r){if(!t)return null;if("GeometryCollection"===t.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(e){return a(e,r)})};if(!I.hasOwnProperty(t.type))return null;var o=I[t.type];return e.geo.stream(t,r(o)),o.result()}function r(){}function i(e){if(4>(r=e.length))return!1;for(var t=0,a=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1],r;++t<r;)a+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return 0>=a}function n(e,t){for(var a=t[0],r=t[1],o=!1,l=0,s=e.length,n=s-1;l<s;n=l++){var d=e[l],c=d[0],p=d[1],u=e[n],g=u[0],h=u[1];p>r^h>r&&a<(g-c)*(r-p)/(h-p)+c&&(o=!o)}return o}function l(e){return e?e/De(e):1}function s(e){return 1<e?O:-1>e?-O:o(e)}function p(e){return 1<e?0:-1>e?D:d(e)}function u(e,t){var a=(2+O)*De(t);t/=2;for(var r=0,o=1/0,n;10>r&&_a(o)>z;r++)n=R(t),t-=o=(t+De(t)*(n+2)-a)/(2*n*(1+n));return[2/N(D*(4+D))*e*(1+R(t)),2*N(D/(4+D))*De(t)]}function g(e,t){function a(a,r){var o=V(a/t,r);return o[0]*=e,o}return(2>arguments.length&&(t=e),1===t)?V:t===1/0?h:(a.invert=function(a,r){var o=V.invert(a/e,r);return o[0]*=t,o},a)}function h(e,t){return[e*R(t)/R(t/=2),2*De(t)]}function y(e,t){return[3*e/(2*D)*N(D*D/3-t*t),t]}function f(e,t){return[e,1.25*P(fa(D/4+.4*t))]}function x(e){return function(t){var a=e*De(t),r=30,o;do t-=o=(t+De(t)-a)/(1+R(t));while(_a(o)>z&&0<--r);return t/2}}function _(e,t){var a=t*t,r=a*a;return[e*(.8707-.131979*a+r*(-.013791+r*(.003971*a-.001529*r))),t*(1.007226+a*(.015085+r*(-.044475+.028874*a-.005916*r)))]}function b(e,t){var a=ea(18,36*_a(t)/D),r=ba(a),o=a-r,i=(p=G[r])[0],n=p[1],l=(p=G[++r])[0],s=p[1],d=(p=G[ea(19,++r)])[0],c=p[1],p;return[e*(l+o*(d-i)/2+o*o*(d-2*l+i)/2),(0<t?O:-O)*(s+o*(c-n)/2+o*o*(c-2*s+n)/2)]}function v(e,t){return[e*R(t),t]}function k(e,t){var a=R(t),r=l(p(a*R(e/=2)));return[2*a*De(e)*r,De(t)*r]}function w(e,t){var a=k(e,t);return[(a[0]+e/O)/2,(a[1]+t)/2]}e.geo.project=function(e,t){var r=t.stream;if(!r)throw new Error("not yet supported");return(e&&T.hasOwnProperty(e.type)?T[e.type]:a)(e,r)};var T={Feature:t,FeatureCollection:function(e,a){return{type:"FeatureCollection",features:e.features.map(function(e){return t(e,a)})}}},A=[],S=[],C={point:function(e,t){A.push([e,t])},result:function(){var e=A.length?2>A.length?{type:"Point",coordinates:A[0]}:{type:"MultiPoint",coordinates:A}:null;return A=[],e}},L={lineStart:r,point:function(e,t){A.push([e,t])},lineEnd:function(){A.length&&(S.push(A),A=[])},result:function(){var e=S.length?2>S.length?{type:"LineString",coordinates:S[0]}:{type:"MultiLineString",coordinates:S}:null;return S=[],e}},E={polygonStart:r,lineStart:r,point:function(e,t){A.push([e,t])},lineEnd:function(){var e=A.length;if(e){do A.push(A[0].slice());while(4>++e);S.push(A),A=[]}},polygonEnd:r,result:function(){if(!S.length)return null;var e=[],t=[];return S.forEach(function(a){i(a)?e.push([a]):t.push(a)}),t.forEach(function(t){var a=t[0];e.some(function(e){if(n(e[0],a))return e.push(t),!0})||e.push([t])}),S=[],e.length?1<e.length?{type:"MultiPolygon",coordinates:e}:{type:"Polygon",coordinates:e[0]}:null}},I={Point:C,MultiPoint:C,LineString:L,MultiLineString:L,Polygon:E,MultiPolygon:E,Sphere:E},z=1e-6,D=Pe,O=D/2,M=N(D),j=e.geo.projection,F=e.geo.projectionMutator;e.geo.interrupt=function(a){function r(e,t){for(var r=0>t?-1:1,o=s[+(0>t)],l=0,d=o.length-1;l<d&&e>o[l][2][0];++l);var n=a(e-o[l][1][0],t);return n[0]+=a(o[l][1][0],r*t>r*o[l][0][1]?o[l][0][1]:t)[0],n}function o(){d=s.map(function(e){return e.map(function(e){var r=a(e[0][0],e[0][1])[0],o=a(e[2][0],e[2][1])[0],i=a(e[1][0],e[0][1])[1],n=a(e[1][0],e[1][1])[1],l;return i>n&&(l=i,i=n,n=l),[[r,i],[o,n]]})})}function i(){for(var t=1e-6,a=[],r=0,o=s[0].length;r<o;++r){var l=s[0][r],d=180*l[0][0]/D,c=180*l[0][1]/D,p=180*l[1][1]/D,u=180*l[2][0]/D,g=180*l[2][1]/D;a.push(n([[d+t,c+t],[d+t,p-t],[u-t,p-t],[u-t,g+t]],30))}for(var r=s[1].length-1;0<=r;--r){var l=s[1][r],d=180*l[0][0]/D,c=180*l[0][1]/D,p=180*l[1][1]/D,u=180*l[2][0]/D,g=180*l[2][1]/D;a.push(n([[u-t,g-t],[u-t,p+t],[d+t,p+t],[d+t,c-t]],30))}return{type:"Polygon",coordinates:[e.merge(a)]}}function n(e,t){for(var a=-1,r=e.length,o=e[0],n=[],l,s,d;++a<r;){l=e[a],s=(l[0]-o[0])/t,d=(l[1]-o[1])/t;for(var c=0;c<t;++c)n.push([o[0]+c*s,o[1]+c*d]);o=l}return n.push(l),n}function l(e,t){return _a(e[0]-t[0])<z&&_a(e[1]-t[1])<z}var s=[[[[-D,0],[0,O],[D,0]]],[[[-D,0],[0,-O],[D,0]]]],d;a.invert&&(r.invert=function(e,t){for(var o=d[+(0>t)],c=s[+(0>t)],p=0,u=o.length,n;p<u;++p)if(n=o[p],n[0][0]<=e&&e<n[1][0]&&n[0][1]<=t&&t<n[1][1]){var g=a.invert(e-a(c[p][1][0],0)[0],t);return g[0]+=c[p][1][0],l(r(g[0],g[1]),[e,t])?g:null}});var c=e.geo.projection(r),p=c.stream;return c.stream=function(t){var a=c.rotate(),r=p(t),o=(c.rotate([0,0]),p(t));return c.rotate(a),r.sphere=function(){e.geo.stream(i(),o)},r},c.lobes=function(e){return arguments.length?(s=e.map(function(e){return e.map(function(e){return[[e[0][0]*D/180,e[0][1]*D/180],[e[1][0]*D/180,e[1][1]*D/180],[e[2][0]*D/180,e[2][1]*D/180]]})}),o(),c):s.map(function(e){return e.map(function(e){return[[180*e[0][0]/D,180*e[0][1]/D],[180*e[1][0]/D,180*e[1][1]/D],[180*e[2][0]/D,180*e[2][1]/D]]})})},c},u.invert=function(e,t){var a=.5*t*N((4+D)/D),r=s(a),o=R(r);return[e/(2/N(D*(4+D))*(1+o)),s((r+a*(o+2))/(2+O))]},(e.geo.eckert4=function(){return j(u)}).raw=u;var V=e.geo.azimuthalEqualArea.raw;h.invert=function(e,t){var a=2*s(t/2);return[e*R(a/2)/R(a),a]},(e.geo.hammer=function(){var e=2,t=F(g),a=t(e);return a.coefficient=function(a){return arguments.length?t(e=+a):e},a}).raw=g,y.invert=function(e,t){return[2/3*D*e/N(D*D/3-t*t),t]},(e.geo.kavrayskiy7=function(){return j(y)}).raw=y,f.invert=function(e,t){return[e,2.5*xa(m(.8*t))-.625*D]},(e.geo.miller=function(){return j(f)}).raw=f;var U=x(D),H=function(e,t,a){function r(a,r){return[e*a*R(r=o(r)),t*De(r)]}var o=x(a);return r.invert=function(r,o){var i=s(o/t);return[r/(e*R(i)),s((2*i+De(2*i))/a)]},r}(c/O,Math.SQRT2,D);(e.geo.mollweide=function(){return j(H)}).raw=H,_.invert=function(e,t){var a=t,r=25,o;do{var n=a*a,l=n*n;a-=o=(a*(1.007226+n*(.015085+l*(-.044475+.028874*n-.005916*l)))-t)/(1.007226+n*(3*.015085+l*(7*-.044475+9*.028874*n-11*.005916*l)))}while(_a(o)>z&&0<--r);return[e/(.8707+(n=a*a)*(-.131979+n*(-.013791+n*n*n*(.003971-.001529*n)))),a]},(e.geo.naturalEarth=function(){return j(_)}).raw=_;var G=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];G.forEach(function(e){e[1]*=1.0144}),b.invert=function(e,a){var r=a/O,o=90*r,n=ea(18,_a(o/5)),l=va(0,ba(n));do{var s=G[l][1],d=G[l+1][1],p=G[ea(19,l+2)][1],g=p-s,u=p-2*d+s,h=2*(_a(r)-d)/g,t=u/g,c=h*(1-t*h*(1-2*t*h));if(0<=c||1===l){o=(0<=a?5:-5)*(c+n);var m=50,y;do n=ea(18,_a(o)/5),l=ba(n),c=n-l,s=G[l][1],d=G[l+1][1],p=G[ea(19,l+2)][1],o-=(y=(0<=a?O:-O)*(d+c*(p-s)/2+c*c*(p-2*d+s)/2)-a)*(180/D);while(_a(y)>z*z&&0<--m);break}}while(0<=--l);var f=G[l][0],x=G[l+1][0],_=G[ea(19,l+2)][0];return[e/(x+c*(_-f)/2+c*c*(_-2*x+f)/2),o*(D/180)]},(e.geo.robinson=function(){return j(b)}).raw=b,v.invert=function(e,t){return[e/R(t),t]},(e.geo.sinusoidal=function(){return j(v)}).raw=v,k.invert=function(e,t){if(!(e*e+4*t*t>D*D+z)){var a=e,r=t,o=25;do{var n=De(a),l=De(a/2),s=R(a/2),d=De(r),c=R(r),u=De(2*r),g=d*d,h=c*c,m=l*l,y=1-h*s*s,f=y?p(c*s)*N(A=1/y):A=0,x=2*f*c*l-e,_=f*d-t,b=A*(h*m+f*c*s*g),v=A*(.5*n*u-2*f*d*l),k=.25*A*(u*l-f*d*h*n),w=A*(g*s+f*m*c),T=v*k-w*b,A;if(!T)break;var S=(_*v-x*w)/T,C=(x*k-_*b)/T;a-=S,r-=C}while((_a(S)>z||_a(C)>z)&&0<--o);return[a,r]}},(e.geo.aitoff=function(){return j(k)}).raw=k,w.invert=function(e,t){var a=e,r=t,o=25;do{var n=R(r),l=De(r),s=De(2*r),d=l*l,c=n*n,u=De(a),g=R(a/2),h=De(a/2),m=h*h,y=1-c*g*g,f=y?p(n*g)*N(C=1/y):C=0,x=.5*(2*f*n*h+a/O)-e,_=.5*(f*l+r)-t,b=.5*C*(c*m+f*n*g*d)+.5/O,v=C*(u*s/4-f*l*h),k=.125*C*(s*h-f*l*c*u),w=.5*C*(d*g+f*m*n)+.5,T=v*k-w*b,A=(_*v-x*w)/T,S=(x*k-_*b)/T,C;a-=A,r-=S}while((_a(A)>z||_a(S)>z)&&0<--o);return[a,r]},(e.geo.winkel3=function(){return j(w)}).raw=w}},{}],801:[function(e,t){"use strict";function a(e,t){return S.behavior.zoom().translate(t.translate()).scale(t.scale())}function r(e,t,a){function r(e,t){c[o+"."+e]=h.nestedProperty(l,e).get(),f.call("_storeDirectGUIEdit",n,s._preGUI,c);var a=h.nestedProperty(d,e);a.get()!==t&&(a.set(t),h.nestedProperty(l,e).set(t),p[o+"."+e]=t)}var o=e.id,i=e.graphDiv,n=i.layout,l=n[o],s=i._fullLayout,d=s[o],c={},p={};a(r),r("projection.scale",t.scale()/e.fitScale),i.emit("plotly_relayout",p)}function i(e,t){function o(a){var r=t.invert(e.midPt);a("center.lon",r[0]),a("center.lat",r[1])}var i=a(e,t);return i.on("zoomstart",function(){S.select(this).style(C)}).on("zoom",function(){t.scale(S.event.scale).translate(S.event.translate),e.render();var a=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":a[0],"geo.center.lat":a[1]})}).on("zoomend",function(){S.select(this).style(E),r(e,t,o)}),i}function n(e,t){function o(e){return t.invert(e)}function i(e){var a=o(e);if(!a)return!0;var r=t(a);return 2<_a(r[0]-e[0])||2<_a(r[1]-e[1])}function n(){S.select(this).style(C),p=S.mouse(this),u=t.rotate(),g=t.translate(),h=u,m=o(p)}function l(){if(y=S.mouse(this),i(p))return c.scale(t.scale()),void c.translate(t.translate());t.scale(S.event.scale),t.translate([g[0],S.event.translate[1]]),m?o(y)&&(x=o(y),f=[h[0]+(x[0]-m[0]),u[1],u[2]],t.rotate(f),h=f):(p=y,m=o(p)),_=!0,e.render();var a=t.rotate(),r=t.invert(e.midPt);e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.center.lon":r[0],"geo.center.lat":r[1],"geo.projection.rotation.lon":-a[0]})}function s(){S.select(this).style(E),_&&r(e,t,d)}function d(a){var r=t.rotate(),o=t.invert(e.midPt);a("projection.rotation.lon",-r[0]),a("center.lon",o[0]),a("center.lat",o[1])}var c=a(e,t),p,u,g,h,m,y,f,x,_;return c.on("zoomstart",n).on("zoom",l).on("zoomend",s),c}function l(e,t){function o(e){y++||e({type:"zoomstart"})}function i(e){e({type:"zoom"})}function n(e){--y||e({type:"zoomend"})}function l(e){var a=t.rotate();e("projection.rotation.lon",-a[0]),e("projection.rotation.lat",-a[1])}var d={r:t.rotate(),k:t.scale()},h=a(e,t),m=A(h,"zoomstart","zoom","zoomend"),y=0,f=h.on,x;return h.on("zoomstart",function(){S.select(this).style(C);var e=S.mouse(this),a=t.rotate(),r=a,n=t.translate(),l=c(a);x=s(t,e),f.call(h,"zoom",function(){var o=S.mouse(this);if(t.scale(d.k=S.event.scale),!x)e=o,x=s(t,e);else if(s(t,o)){t.rotate(a).translate(n);var c=s(t,o),h=u(x,c),y=b(p(l,h)),f=d.r=g(y,x,r);isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])||(f=r),t.rotate(f),r=f}i(m.of(this,arguments))}),o(m.of(this,arguments))}).on("zoomend",function(){S.select(this).style(E),f.call(h,"zoom",null),n(m.of(this,arguments)),r(e,t,l)}).on("zoom.redraw",function(){e.render();var a=t.rotate();e.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":t.scale()/e.fitScale,"geo.projection.rotation.lon":-a[0],"geo.projection.rotation.lat":-a[1]})}),S.rebind(h,m,"on")}function s(e,t){var a=e.invert(t);return a&&isFinite(a[0])&&isFinite(a[1])&&v(a)}function c(e){var t=.5*e[0]*x,a=.5*e[1]*x,r=.5*e[2]*x,o=De(t),i=R(t),n=De(a),l=R(a),s=De(r),d=R(r);return[i*l*d+o*n*s,o*l*d-i*n*s,i*n*d+o*l*s,i*l*s-o*n*d]}function p(e,t){var a=e[0],r=e[1],o=e[2],i=e[3],n=t[0],l=t[1],s=t[2],d=t[3];return[a*n-r*l-o*s-i*d,a*l+r*n+o*d-i*s,a*s-r*d+o*n+i*l,a*d+r*s-o*l+i*n]}function u(e,t){if(e&&t){var a=T(e,t),r=N(w(a,a)),o=.5*d(va(-1,ea(1,w(e,t)))),i=De(o)/r;return r&&[R(o),a[2]*i,-a[1]*i,a[0]*i]}}function g(e,t,r){var i=_(t,2,e[0]);i=_(i,1,e[1]),i=_(i,0,e[2]-r[2]);var n=t[0],l=t[1],s=t[2],d=i[0],c=i[1],p=i[2],u=L(l,n)*k,g=N(n*n+l*l),a,h;_a(c)>g?(h=(0<c?90:-90)-u,a=0):(h=o(c/g)*k-u,a=N(g*g-c*c));var y=180-h-2*u,f=(L(p,d)-L(s,a))*k,x=(L(p,d)-L(s,-a))*k,v=m(r[0],r[1],h,f),w=m(r[0],r[1],y,x);return v<=w?[h,f,r[2]]:[y,x,r[2]]}function m(e,t,a,r){var o=y(a-e),i=y(r-t);return N(o*o+i*i)}function y(e){return(e%360+540)%360-180}function _(e,t,a){var r=a*x,o=e.slice(),i=0===t?1:0,n=2===t?1:2,l=R(r),s=De(r);return o[i]=e[i]*l-e[n]*s,o[n]=e[n]*l+e[i]*s,o}function b(e){return[L(2*(e[0]*e[1]+e[2]*e[3]),1-2*(e[1]*e[1]+e[2]*e[2]))*k,o(va(-1,ea(1,2*(e[0]*e[2]-e[3]*e[1]))))*k,L(2*(e[0]*e[3]+e[1]*e[2]),1-2*(e[2]*e[2]+e[3]*e[3]))*k]}function v(e){var t=e[0]*x,a=e[1]*x,r=R(a);return[r*R(t),r*De(t),De(a)]}function w(e,t){for(var a=0,r=0,o=e.length;r<o;++r)a+=e[r]*t[r];return a}function T(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function A(e){for(var t=0,a=arguments.length,r=[];++t<a;)r.push(arguments[t]);var o=S.dispatch.apply(null,r);return o.of=function(t,a){return function(r){var i;try{i=r.sourceEvent=S.event,r.target=e,S.event=r,o[r.type].apply(t,a)}finally{S.event=i}}},o}var S=e("d3"),h=e("../../lib"),f=e("../../registry"),x=Pe/180,k=180/Pe,C={cursor:"pointer"},E={cursor:"auto"};t.exports=function(e,t){var a=e.projection,r;return r=t._isScoped?i:t._isClipped?l:n,r(e,a)}},{"../../lib":719,"../../registry":847,d3:163}],802:[function(e,t,a){"use strict";var r=e("../registry"),o=e("./cartesian/constants").SUBPLOT_PATTERN;a.getSubplotCalcData=function(e,t,a){var o=r.subplotsRegistry[t];if(!o)return[];for(var n=o.attr,l=[],s=0;s<e.length;s++){var d=e[s],c=d[0].trace;c[n]===a&&l.push(d)}return l},a.getModuleCalcData=function(e,t){var a=[],o=[],n;if(n="string"==typeof t?r.getModule(t).plot:"function"==typeof t?t:t.plot,!n)return[a,e];for(var l=0;l<e.length;l++){var s=e[l],d=s[0].trace;!0!==d.visible||0===d._length||(d._module.plot===n?a.push(s):o.push(s))}return[a,o]},a.getSubplotData=function(e,t,a){if(!r.subplotsRegistry[t])return[];var n=r.subplotsRegistry[t].attr,l=[],s,d,c;if("gl2d"===t){var p=a.match(o);d="x"+p[1],c="y"+p[2]}for(var u=0;u<e.length;u++)s=e[u],"gl2d"===t&&r.traceIs(s,"gl2d")?s[n[0]]===d&&s[n[1]]===c&&l.push(s):s[n]===a&&l.push(s);return l}},{"../registry":847,"./cartesian/constants":773}],803:[function(e,t){"use strict";function a(e,t){this.element=e,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}var r=e("mouse-change"),o=e("mouse-wheel"),i=e("mouse-event-offset"),n=e("../cartesian/constants"),l=e("has-passive-events");t.exports=function(e){function t(){e.xaxis.autorange=!1,e.yaxis.autorange=!1}function s(){for(var t=e.graphDiv._fullLayout._axisConstraintGroups,a=e.xaxis._id,r=e.yaxis._id,o=0;o<t.length;o++)if(-1!==t[o][a]){if(-1!==t[o][r])return!0;break}return!1}function d(a,r,o){function i(t,a,r){var o=ea(a,r),i=va(a,r);o===i?(e.selectBox.selectBox=[0,0,1,1],e.glplot.setDirty()):(l[t]=o,l[t+2]=i,u.dataBox=l,e.setRanges(l))}var l=e.calcDataBox(),d=p.viewBox,c=u.lastPos[0],g=u.lastPos[1],h=n.MINDRAG*p.pixelRatio,m=n.MINZOOM*p.pixelRatio,f,_;switch(r*=p.pixelRatio,o*=p.pixelRatio,o=d[3]-d[1]-o,e.fullLayout.dragmode){case"zoom":if(a){var b=r/(d[2]-d[0])*(l[2]-l[0])+l[0],v=o/(d[3]-d[1])*(l[3]-l[1])+l[1];u.boxInited||(u.boxStart[0]=b,u.boxStart[1]=v,u.dragStart[0]=r,u.dragStart[1]=o),u.boxEnd[0]=b,u.boxEnd[1]=v,u.boxInited=!0,u.boxEnabled||u.boxStart[0]===u.boxEnd[0]&&u.boxStart[1]===u.boxEnd[1]||(u.boxEnabled=!0);var k=_a(u.dragStart[0]-r)<m,w=_a(u.dragStart[1]-o)<m;if(s()&&!(k&&w)){f=u.boxEnd[0]-u.boxStart[0],_=u.boxEnd[1]-u.boxStart[1];var T=(l[3]-l[1])/(l[2]-l[0]);_a(f*T)>_a(_)?(u.boxEnd[1]=u.boxStart[1]+_a(f)*T*(0<=_?1:-1),u.boxEnd[1]<l[1]?(u.boxEnd[1]=l[1],u.boxEnd[0]=u.boxStart[0]+(l[1]-u.boxStart[1])/_a(T)):u.boxEnd[1]>l[3]&&(u.boxEnd[1]=l[3],u.boxEnd[0]=u.boxStart[0]+(l[3]-u.boxStart[1])/_a(T))):(u.boxEnd[0]=u.boxStart[0]+_a(_)/T*(0<=f?1:-1),u.boxEnd[0]<l[0]?(u.boxEnd[0]=l[0],u.boxEnd[1]=u.boxStart[1]+(l[0]-u.boxStart[0])*_a(T)):u.boxEnd[0]>l[2]&&(u.boxEnd[0]=l[2],u.boxEnd[1]=u.boxStart[1]+(l[2]-u.boxStart[0])*_a(T)))}else k&&(u.boxEnd[0]=u.boxStart[0]),w&&(u.boxEnd[1]=u.boxStart[1])}else u.boxEnabled?(f=u.boxStart[0]!==u.boxEnd[0],_=u.boxStart[1]!==u.boxEnd[1],f||_?(f&&(i(0,u.boxStart[0],u.boxEnd[0]),e.xaxis.autorange=!1),_&&(i(1,u.boxStart[1],u.boxEnd[1]),e.yaxis.autorange=!1),e.relayoutCallback()):e.glplot.setDirty(),u.boxEnabled=!1,u.boxInited=!1):u.boxInited&&(u.boxInited=!1);break;case"pan":u.boxEnabled=!1,u.boxInited=!1,a?(!u.panning&&(u.dragStart[0]=r,u.dragStart[1]=o),_a(u.dragStart[0]-r)<h&&(r=u.dragStart[0]),_a(u.dragStart[1]-o)<h&&(o=u.dragStart[1]),f=(c-r)*(l[2]-l[0])/(p.viewBox[2]-p.viewBox[0]),_=(g-o)*(l[3]-l[1])/(p.viewBox[3]-p.viewBox[1]),l[0]+=f,l[2]+=f,l[1]+=_,l[3]+=_,e.setRanges(l),u.panning=!0,u.lastInputTime=Date.now(),t(),e.cameraChanged(),e.handleAnnotations()):u.panning&&(u.panning=!1,e.relayoutCallback());}u.lastPos[0]=r,u.lastPos[1]=o}var c=e.mouseContainer,p=e.glplot,u=new a(c,p);return u.mouseListener=r(c,d),c.addEventListener("touchstart",function(e){var t=i(e.changedTouches[0],c);d(0,t[0],t[1]),d(1,t[0],t[1]),e.preventDefault()},!!l&&{passive:!1}),c.addEventListener("touchmove",function(e){e.preventDefault();var t=i(e.changedTouches[0],c);d(1,t[0],t[1]),e.preventDefault()},!!l&&{passive:!1}),c.addEventListener("touchend",function(e){d(0,u.lastPos[0],u.lastPos[1]),e.preventDefault()},!!l&&{passive:!1}),u.wheelListener=o(c,function(a,r){if(!e.scrollZoom)return!1;var o=e.calcDataBox(),i=p.viewBox,n=u.lastPos[0],l=u.lastPos[1],s=m(5*r/(i[3]-i[1])),d=n/(i[2]-i[0])*(o[2]-o[0])+o[0],c=l/(i[3]-i[1])*(o[3]-o[1])+o[1];return o[0]=(o[0]-d)*s+d,o[2]=(o[2]-d)*s+d,o[1]=(o[1]-c)*s+c,o[3]=(o[3]-c)*s+c,e.setRanges(o),u.lastInputTime=Date.now(),t(),e.cameraChanged(),e.handleAnnotations(),e.relayoutCallback(),!0},!0),u}},{"../cartesian/constants":773,"has-passive-events":411,"mouse-change":435,"mouse-event-offset":436,"mouse-wheel":438}],804:[function(e,t){"use strict";function a(e){this.scene=e,this.gl=e.gl,this.pixelRatio=e.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Pe/2,0,3*Pe/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var r=e("../cartesian/axes"),o=e("../../lib/str2rgbarray"),i=a.prototype,n=["xaxis","yaxis"];i.merge=function(e){this.titleEnable=!1,this.backgroundColor=o(e.plot_bgcolor);var t,a,r,l,s,d,c,p,u,g,h;for(g=0;2>g;++g){t=n[g];var m=t.charAt(0);for(a=e[this.scene[t]._name],r=a.title.text===this.scene.fullLayout._dfltTitle[m]?"":a.title.text,h=0;2>=h;h+=2)this.labelEnable[g+h]=!1,this.labels[g+h]=r,this.labelColor[g+h]=o(a.title.font.color),this.labelFont[g+h]=a.title.font.family,this.labelSize[g+h]=a.title.font.size,this.labelPad[g+h]=this.getLabelPad(t,a),this.tickEnable[g+h]=!1,this.tickColor[g+h]=o((a.tickfont||{}).color),this.tickAngle[g+h]="auto"===a.tickangle?0:Pe*-a.tickangle/180,this.tickPad[g+h]=this.getTickPad(a),this.tickMarkLength[g+h]=0,this.tickMarkWidth[g+h]=a.tickwidth||0,this.tickMarkColor[g+h]=o(a.tickcolor),this.borderLineEnable[g+h]=!1,this.borderLineColor[g+h]=o(a.linecolor),this.borderLineWidth[g+h]=a.linewidth||0;c=this.hasSharedAxis(a),s=this.hasAxisInDfltPos(t,a)&&!c,d=this.hasAxisInAltrPos(t,a)&&!c,l=a.mirror||!1,p=c?-1!==(l+"").indexOf("all"):!!l,u=c?"allticks"===l:-1!==(l+"").indexOf("ticks"),s?this.labelEnable[g]=!0:d&&(this.labelEnable[g+2]=!0),s?this.tickEnable[g]=a.showticklabels:d&&(this.tickEnable[g+2]=a.showticklabels),(s||p)&&(this.borderLineEnable[g]=a.showline),(d||p)&&(this.borderLineEnable[g+2]=a.showline),(s||u)&&(this.tickMarkLength[g]=this.getTickMarkLength(a)),(d||u)&&(this.tickMarkLength[g+2]=this.getTickMarkLength(a)),this.gridLineEnable[g]=a.showgrid,this.gridLineColor[g]=o(a.gridcolor),this.gridLineWidth[g]=a.gridwidth,this.zeroLineEnable[g]=a.zeroline,this.zeroLineColor[g]=o(a.zerolinecolor),this.zeroLineWidth[g]=a.zerolinewidth}},i.hasSharedAxis=function(e){var t=this.scene,a=t.fullLayout._subplots.gl2d,o=r.findSubplotsWithAxis(a,e);return 0!==o.indexOf(t.id)},i.hasAxisInDfltPos=function(e,t){var a=t.side;if("xaxis"===e)return"bottom"===a;return"yaxis"===e?"left"===a:void 0},i.hasAxisInAltrPos=function(e,t){var a=t.side;if("xaxis"===e)return"top"===a;return"yaxis"===e?"right"===a:void 0},i.getLabelPad=function(e,t){var a=1.5,r=t.title.font.size,o=t.showticklabels;if("xaxis"===e)return"top"===t.side?-10+r*(a+(o?1:0)):-10+r*(a+(o?.5:0));return"yaxis"===e?"right"===t.side?10+r*(a+(o?1:.5)):10+r*(a+(o?.5:0)):void 0},i.getTickPad=function(e){return"outside"===e.ticks?10+e.ticklen:15},i.getTickMarkLength=function(e){if(!e.ticks)return 0;var t=e.ticklen;return"inside"===e.ticks?-t:t},t.exports=function(e){return new a(e)}},{"../../lib/str2rgbarray":742,"../cartesian/axes":767}],805:[function(e,t,a){"use strict";var r=e("../../plot_api/edit_types").overrideAll,o=e("./scene2d"),i=e("../layout_attributes"),n=e("../../constants/xmlns_namespaces"),l=e("../cartesian/constants"),s=e("../cartesian"),d=e("../../components/fx/layout_attributes"),c=e("../get_data").getSubplotData;a.name="gl2d",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=l.idRegex,a.attrRegex=l.attrRegex,a.attributes=e("../cartesian/attributes"),a.supplyLayoutDefaults=function(e,t,a){t._has("cartesian")||s.supplyLayoutDefaults(e,t,a)},a.layoutAttrOverrides=r(s.layoutAttributes,"plot","from-root"),a.baseLayoutAttrOverrides=r({plot_bgcolor:i.plot_bgcolor,hoverlabel:d.hoverlabel},"plot","nested"),a.plot=function(e){for(var t=e._fullLayout,a=e._fullData,r=t._subplots.gl2d,n=0;n<r.length;n++){var l=r[n],s=t._plots[l],d=c(a,"gl2d",l),p=s._scene2d;p===void 0&&(p=new o({id:l,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio},t),s._scene2d=p),p.plot(d,e.calcdata,t,e.layout)}},a.clean=function(e,t,a,r){for(var o=r._subplots.gl2d||[],n=0;n<o.length;n++){var l=o[n],d=r._plots[l];if(d._scene2d){var p=c(e,"gl2d",l);0===p.length&&(d._scene2d.destroy(),delete r._plots[l])}}s.clean.apply(this,arguments)},a.drawFramework=function(e){e._context.staticPlot||s.drawFramework(e)},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots.gl2d,r=0;r<a.length;r++){var o=t._plots[a[r]],l=o._scene2d,s=l.toImage("png"),d=t._glimages.append("svg:image");d.attr({xmlns:n.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),l.destroy()}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots.gl2d,r=0,o;r<a.length;r++)o=t._plots[a[r]]._scene2d,o.updateFx(t.dragmode)}},{"../../components/fx/layout_attributes":633,"../../constants/xmlns_namespaces":696,"../../plot_api/edit_types":750,"../cartesian":778,"../cartesian/attributes":765,"../cartesian/constants":773,"../get_data":802,"../layout_attributes":819,"./scene2d":806}],806:[function(e,t){"use strict";function a(e,t){this.container=e.container,this.graphDiv=e.graphDiv,this.pixelRatio=e.plotGlPixelRatio||window.devicePixelRatio,this.id=e.id,this.staticPlot=!!e.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(t),this.makeFramework();this.stopped||(this.glplotOptions=p(this),this.glplotOptions.merge(t),this.glplot=i(this.glplotOptions),this.camera=u(this),this.traces={},this.spikes=s(this.glplot),this.selectBox=d(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}function r(e,t){for(var a=0;2>a;++a){var r=e[a],o=t[a];if(r.length!==o.length)return!0;for(var n=0;n<r.length;++n)if(r[n].x!==o[n].x)return!0}return!1}var o=e("../../registry"),n=e("../../plots/cartesian/axes"),l=e("../../components/fx"),i=e("gl-plot2d"),s=e("gl-spikes2d"),d=e("gl-select-box"),c=e("webgl-context"),p=e("./convert"),u=e("./camera"),g=e("../../lib/show_no_webgl_msg"),h=e("../cartesian/constraints"),m=h.enforce,y=h.clean,f=e("../cartesian/autorange").doAutoRange,x=["xaxis","yaxis"],_=e("../cartesian/constants").SUBPLOT_PATTERN,b,v;t.exports=a;var k=a.prototype;k.makeFramework=function(){if(this.staticPlot){if(!v&&(b=document.createElement("canvas"),v=c({canvas:b,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!v))throw new Error("Error creating static canvas/context for image server");this.canvas=b,this.gl=v}else{var e=this.container.querySelector(".gl-canvas-focus"),t=c({canvas:e,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!t)return g(this),void(this.stopped=!0);this.canvas=e,this.gl=t}var a=this.canvas;a.style.width="100%",a.style.height="100%",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style["pointer-events"]="none",this.updateSize(a),a.className+=" user-select-none";var r=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.position="absolute",r.style.top=r.style.left="0px",r.style.width=r.style.height="100%",r.style["z-index"]=20,r.style["pointer-events"]="none";var o=this.mouseContainer=document.createElement("div");o.style.position="absolute",o.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var i=this.container;i.appendChild(r),i.appendChild(o);var n=this;o.addEventListener("mouseout",function(){n.isMouseOver=!1,n.unhover()}),o.addEventListener("mouseover",function(){n.isMouseOver=!0})},k.toImage=function(e){e||(e="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(b),this.updateSize(this.canvas);var t=this.glplot.gl,a=t.drawingBufferWidth,r=t.drawingBufferHeight;t.clearColor(1,1,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),t.bindFramebuffer(t.FRAMEBUFFER,null);var o=new Uint8Array(4*(a*r));t.readPixels(0,0,a,r,t.RGBA,t.UNSIGNED_BYTE,o);for(var n=0,s=r-1;n<s;++n,--s)for(var d=0;d<a;++d)for(var c=0,p;4>c;++c)p=o[4*(a*n+d)+c],o[4*(a*n+d)+c]=o[4*(a*s+d)+c],o[4*(a*s+d)+c]=p;var u=document.createElement("canvas");u.width=a,u.height=r;var g=u.getContext("2d"),h=g.createImageData(a,r);h.data.set(o),g.putImageData(h,0,0);var m;return m="jpeg"===e?u.toDataURL("image/jpeg"):"webp"===e?u.toDataURL("image/webp"):u.toDataURL("image/png"),this.staticPlot&&this.container.removeChild(b),m},k.updateSize=function(e){e||(e=this.canvas);var t=this.pixelRatio,a=this.fullLayout,r=a.width,o=a.height,i=0|M(t*r),n=0|M(t*o);return(e.width!==i||e.height!==n)&&(e.width=i,e.height=n),e},k.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var e=[n.calcTicks(this.xaxis),n.calcTicks(this.yaxis)],t=0;2>t;++t)for(var a=0;a<e[t].length;++a)e[t][a].text+="";return e},k.updateRefs=function(e){this.fullLayout=e;var t=this.id.match(_),a="xaxis"+t[1],r="yaxis"+t[2];this.xaxis=this.fullLayout[a],this.yaxis=this.fullLayout[r]},k.relayoutCallback=function(){var e=this.graphDiv,t=this.xaxis,a=this.yaxis,r=e.layout,i={},n=i[t._name+".range"]=t.range.slice(),l=i[a._name+".range"]=a.range.slice();i[t._name+".autorange"]=t.autorange,i[a._name+".autorange"]=a.autorange,o.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,i);var s=r[t._name];s.range=n,s.autorange=t.autorange;var d=r[a._name];d.range=l,d.autorange=a.autorange,i.lastInputTime=this.camera.lastInputTime,e.emit("plotly_relayout",i)},k.cameraChanged=function(){var e=this.camera;this.glplot.setDataBox(this.calcDataBox());var t=this.computeTickMarks(),a=this.glplotOptions.ticks;r(t,a)&&(this.glplotOptions.ticks=t,this.glplotOptions.dataBox=e.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},k.handleAnnotations=function(){for(var e=this.graphDiv,t=this.fullLayout.annotations,a=0,r;a<t.length;a++)r=t[a],r.xref===this.xaxis._id&&r.yref===this.yaxis._id&&o.getComponentMethod("annotations","drawOne")(e,a)},k.destroy=function(){if(this.glplot){var e=this.traces;e&&Object.keys(e).map(function(t){e[t].dispose(),delete e[t]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},k.plot=function(e,t,a){var r=this.glplot;this.updateRefs(a),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(e,t),this.updateFx(a.dragmode);var o=a.width,n=a.height;this.updateSize(this.canvas);var l=this.glplotOptions;l.merge(a),l.screenBox=[0,0,o,n];var s={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};y(s,this.xaxis),y(s,this.yaxis);var d=a._size,c=this.xaxis.domain,p=this.yaxis.domain;l.viewBox=[d.l+c[0]*d.w,d.b+p[0]*d.h,o-d.r-(1-c[1])*d.w,n-d.t-(1-p[1])*d.h],this.mouseContainer.style.width=d.w*(c[1]-c[0])+"px",this.mouseContainer.style.height=d.h*(p[1]-p[0])+"px",this.mouseContainer.height=d.h*(p[1]-p[0]),this.mouseContainer.style.left=d.l+c[0]*d.w+"px",this.mouseContainer.style.top=d.t+(1-p[1])*d.h+"px";var u,g;for(g=0;2>g;++g)u=this[x[g]],u._length=l.viewBox[g+2]-l.viewBox[g],f(this.graphDiv,u),u.setScale();m(s),l.ticks=this.computeTickMarks(),l.dataBox=this.calcDataBox(),l.merge(a),r.update(l),this.glplot.draw()},k.calcDataBox=function(){var e=this.xaxis,t=this.yaxis,a=e.range,r=t.range,o=e.r2l,i=t.r2l;return[o(a[0]),i(r[0]),o(a[1]),i(r[1])]},k.setRanges=function(e){var t=this.xaxis,a=this.yaxis,r=t.l2r,o=a.l2r;t.range=[r(e[0]),r(e[2])],a.range=[o(e[1]),o(e[3])]},k.updateTraces=function(e,t){var a=Object.keys(this.traces),r,o,n;this.fullData=e;traceIdLoop:for(r=0;r<a.length;r++){var l=a[r],s=this.traces[l];for(o=0;o<e.length;o++)if(n=e[o],n.uid===l&&n.type===s.type)continue traceIdLoop;s.dispose(),delete this.traces[l]}for(r=0;r<e.length;r++){n=e[r];var d=t[r],c=this.traces[n.uid];c?c.update(n,d):(c=n._module.plot(this,n,d),this.traces[n.uid]=c)}this.glplot.objects.sort(function(e,t){return e._trace.index-t._trace.index})},k.updateFx=function(e){"lasso"===e||"select"===e?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===e?"move":"zoom"===e?"crosshair":null},k.emitPointAction=function(e,t){for(var a=e.trace.uid,r=e.pointIndex,o=0,n;o<this.fullData.length;o++)this.fullData[o].uid===a&&(n=this.fullData[o]);var s={x:e.traceCoord[0],y:e.traceCoord[1],curveNumber:n.index,pointNumber:r,data:n._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};l.appendArrayPointValue(s,n,r),this.graphDiv.emit(t,{points:[s]})},k.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var e=this.glplot,t=this.camera,a=t.mouseListener,r=1===this.lastButtonState&&0===a.buttons,o=this.fullLayout;this.lastButtonState=a.buttons,this.cameraChanged();var n=a.x*e.pixelRatio,s=this.canvas.height-e.pixelRatio*a.y,d;if(t.boxEnabled&&"zoom"===o.dragmode){this.selectBox.enabled=!0;for(var c=this.selectBox.selectBox=[ea(t.boxStart[0],t.boxEnd[0]),ea(t.boxStart[1],t.boxEnd[1]),va(t.boxStart[0],t.boxEnd[0]),va(t.boxStart[1],t.boxEnd[1])],p=0;2>p;p++)t.boxStart[p]===t.boxEnd[p]&&(c[p]=e.dataBox[p],c[p+2]=e.dataBox[p+2]);e.setDirty()}else if(!t.panning&&this.isMouseOver){this.selectBox.enabled=!1;var u=o._size,g=this.xaxis.domain,h=this.yaxis.domain;d=e.pick(n/e.pixelRatio+u.l+g[0]*u.w,s/e.pixelRatio-(u.t+(1-h[1])*u.h));var m=d&&d.object._trace.handlePick(d);if(m&&r&&this.emitPointAction(m,"plotly_click"),d&&"skip"!==d.object._trace.hoverinfo&&o.hovermode&&m&&(!this.lastPickResult||this.lastPickResult.traceUid!==m.trace.uid||this.lastPickResult.dataCoord[0]!==m.dataCoord[0]||this.lastPickResult.dataCoord[1]!==m.dataCoord[1])){var y=m;this.lastPickResult={traceUid:m.trace?m.trace.uid:null,dataCoord:m.dataCoord.slice()},this.spikes.update({center:d.dataCoord}),y.screenCoord=[((e.viewBox[2]-e.viewBox[0])*(d.dataCoord[0]-e.dataBox[0])/(e.dataBox[2]-e.dataBox[0])+e.viewBox[0])/e.pixelRatio,(this.canvas.height-(e.viewBox[3]-e.viewBox[1])*(d.dataCoord[1]-e.dataBox[1])/(e.dataBox[3]-e.dataBox[1])-e.viewBox[1])/e.pixelRatio],this.emitPointAction(m,"plotly_hover");var f=this.fullData[y.trace.index]||{},x=y.pointIndex,_=l.castHoverinfo(f,o,x);if(_&&"all"!==_){var b=_.split("+");-1===b.indexOf("x")&&(y.traceCoord[0]=void 0),-1===b.indexOf("y")&&(y.traceCoord[1]=void 0),-1===b.indexOf("z")&&(y.traceCoord[2]=void 0),-1===b.indexOf("text")&&(y.textLabel=void 0),-1===b.indexOf("name")&&(y.name=void 0)}l.loneHover({x:y.screenCoord[0],y:y.screenCoord[1],xLabel:this.hoverFormatter("xaxis",y.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",y.traceCoord[1]),zLabel:y.traceCoord[2],text:y.textLabel,name:y.name,color:l.castHoverOption(f,x,"bgcolor")||y.color,borderColor:l.castHoverOption(f,x,"bordercolor"),fontFamily:l.castHoverOption(f,x,"font.family"),fontSize:l.castHoverOption(f,x,"font.size"),fontColor:l.castHoverOption(f,x,"font.color"),nameLength:l.castHoverOption(f,x,"namelength"),textAlign:l.castHoverOption(f,x,"align")},{container:this.svgContainer,gd:this.graphDiv})}}d||this.unhover(),e.draw()}},k.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),l.loneUnhover(this.svgContainer))},k.hoverFormatter=function(e,t){if(void 0!==t){var a=this[e];return n.tickText(a,a.c2l(t),"hover").text}}},{"../../components/fx":632,"../../lib/show_no_webgl_msg":740,"../../plots/cartesian/axes":767,"../../registry":847,"../cartesian/autorange":766,"../cartesian/constants":773,"../cartesian/constraints":774,"./camera":803,"./convert":804,"gl-plot2d":287,"gl-select-box":299,"gl-spikes2d":308,"webgl-context":556}],807:[function(e,t,a){"use strict";var r=e("../../plot_api/edit_types").overrideAll,o=e("../../components/fx/layout_attributes"),n=e("./scene"),l=e("../get_data").getSubplotData,s=e("../../lib"),d=e("../../constants/xmlns_namespaces"),c="gl3d",p="scene";a.name=c,a.attr=p,a.idRoot=p,a.idRegex=a.attrRegex=s.counterRegex("scene"),a.attributes=e("./layout/attributes"),a.layoutAttributes=e("./layout/layout_attributes"),a.baseLayoutAttrOverrides=r({hoverlabel:o.hoverlabel},"plot","nested"),a.supplyLayoutDefaults=e("./layout/defaults"),a.plot=function(e){for(var t=e._fullLayout,a=e._fullData,r=t._subplots[c],o=0;o<r.length;o++){var s=r[o],d=l(a,c,s),p=t[s],u=p.camera,g=p._scene;g||(g=new n({id:s,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio,camera:u},t),p._scene=g),g.viewInitial||(g.viewInitial={up:{x:u.up.x,y:u.up.y,z:u.up.z},eye:{x:u.eye.x,y:u.eye.y,z:u.eye.z},center:{x:u.center.x,y:u.center.y,z:u.center.z}}),g.plot(d,t,e.layout)}},a.clean=function(e,t,a,r){for(var o=r._subplots[c]||[],n=0,l;n<o.length;n++)l=o[n],t[l]||!r[l]._scene||(r[l]._scene.destroy(),r._infolayer&&r._infolayer.selectAll(".annotation-"+l).remove())},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots[c],r=t._size,o=0;o<a.length;o++){var n=t[a[o]],l=n.domain,s=n._scene,p=s.toImage("png"),u=t._glimages.append("svg:image");u.attr({xmlns:d.svg,"xlink:href":p,x:r.l+r.w*l.x[0],y:r.t+r.h*(1-l.y[1]),width:r.w*(l.x[1]-l.x[0]),height:r.h*(l.y[1]-l.y[0]),preserveAspectRatio:"none"}),s.destroy()}},a.cleanId=function(e){if(e.match(/^scene[0-9]*$/)){var t=e.substr(5);return"1"===t&&(t=""),p+t}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots[c],r=0,o;r<a.length;r++)o=t[a[r]]._scene,o.updateFx(t.dragmode,t.hovermode)}},{"../../components/fx/layout_attributes":633,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../plot_api/edit_types":750,"../get_data":802,"./layout/attributes":808,"./layout/defaults":812,"./layout/layout_attributes":813,"./scene":817}],808:[function(e,t){"use strict";t.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],809:[function(e,t){"use strict";var a=e("../../../components/color"),r=e("../../cartesian/layout_attributes"),o=e("../../../lib/extend").extendFlat,i=e("../../../plot_api/edit_types").overrideAll;t.exports=i({visible:r.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:a.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:r.color,categoryorder:r.categoryorder,categoryarray:r.categoryarray,title:r.title,type:o({},r.type,{values:["-","linear","log","date","category"]}),autorange:r.autorange,rangemode:r.rangemode,range:o({},r.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:r.tickmode,nticks:r.nticks,tick0:r.tick0,dtick:r.dtick,tickvals:r.tickvals,ticktext:r.ticktext,ticks:r.ticks,mirror:r.mirror,ticklen:r.ticklen,tickwidth:r.tickwidth,tickcolor:r.tickcolor,showticklabels:r.showticklabels,tickfont:r.tickfont,tickangle:r.tickangle,tickprefix:r.tickprefix,showtickprefix:r.showtickprefix,ticksuffix:r.ticksuffix,showticksuffix:r.showticksuffix,showexponent:r.showexponent,exponentformat:r.exponentformat,separatethousands:r.separatethousands,tickformat:r.tickformat,tickformatstops:r.tickformatstops,hoverformat:r.hoverformat,showline:r.showline,linecolor:r.linecolor,linewidth:r.linewidth,showgrid:r.showgrid,gridcolor:o({},r.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:r.gridwidth,zeroline:r.zeroline,zerolinecolor:r.zerolinecolor,zerolinewidth:r.zerolinewidth,_deprecated:{title:r._deprecated.title,titlefont:r._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":593,"../../../lib/extend":710,"../../../plot_api/edit_types":750,"../../cartesian/layout_attributes":779}],810:[function(e,t){"use strict";var a=e("tinycolor2").mix,r=e("../../../lib"),o=e("../../../plot_api/plot_template"),i=e("./axis_attributes"),n=e("../../cartesian/type_defaults"),l=e("../../cartesian/axis_defaults"),s=["xaxis","yaxis","zaxis"];t.exports=function(e,t,d){function c(e,t){return r.coerce(u,g,i,e,t)}for(var p=0,u,g,h;p<s.length;p++)h=s[p],u=e[h]||{},g=o.newContainer(t,h),g._id=h[0]+d.scene,g._name=h,n(u,g,c,d),l(u,g,c,{font:d.font,letter:h[0],data:d.data,showGrid:!0,noTickson:!0,bgColor:d.bgColor,calendar:d.calendar},d.fullLayout),c("gridcolor",a(g.color,d.bgColor,13600/187).toRgbString()),c("title.text",h[0]),g.setScale=r.noop,c("showspikes")&&(c("spikesides"),c("spikethickness"),c("spikecolor",g.color)),c("showaxeslabels"),c("showbackground")&&c("backgroundcolor")}},{"../../../lib":719,"../../../plot_api/plot_template":757,"../../cartesian/axis_defaults":769,"../../cartesian/type_defaults":790,"./axis_attributes":809,tinycolor2:537}],811:[function(e,t){"use strict";function a(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var r=e("../../../lib/str2rgbarray"),o=e("../../../lib"),n=["xaxis","yaxis","zaxis"],l=a.prototype;l.merge=function(e,t){for(var a=this,l=0,s;3>l;++l){if(s=t[n[l]],!s.visible){a.tickEnable[l]=!1,a.labelEnable[l]=!1,a.lineEnable[l]=!1,a.lineTickEnable[l]=!1,a.gridEnable[l]=!1,a.zeroEnable[l]=!1,a.backgroundEnable[l]=!1;continue}a.labels[l]=e._meta?o.templateString(s.title.text,e._meta):s.title.text,"font"in s.title&&(s.title.font.color&&(a.labelColor[l]=r(s.title.font.color)),s.title.font.family&&(a.labelFont[l]=s.title.font.family),s.title.font.size&&(a.labelSize[l]=s.title.font.size)),"showline"in s&&(a.lineEnable[l]=s.showline),"linecolor"in s&&(a.lineColor[l]=r(s.linecolor)),"linewidth"in s&&(a.lineWidth[l]=s.linewidth),"showgrid"in s&&(a.gridEnable[l]=s.showgrid),"gridcolor"in s&&(a.gridColor[l]=r(s.gridcolor)),"gridwidth"in s&&(a.gridWidth[l]=s.gridwidth),"log"===s.type?a.zeroEnable[l]=!1:"zeroline"in s&&(a.zeroEnable[l]=s.zeroline),"zerolinecolor"in s&&(a.zeroLineColor[l]=r(s.zerolinecolor)),"zerolinewidth"in s&&(a.zeroLineWidth[l]=s.zerolinewidth),a.lineTickEnable[l]="ticks"in s&&s.ticks,"ticklen"in s&&(a.lineTickLength[l]=a._defaultLineTickLength[l]=s.ticklen),"tickcolor"in s&&(a.lineTickColor[l]=r(s.tickcolor)),"tickwidth"in s&&(a.lineTickWidth[l]=s.tickwidth),"tickangle"in s&&(a.tickAngle[l]="auto"===s.tickangle?-3600:Pe*-s.tickangle/180),"showticklabels"in s&&(a.tickEnable[l]=s.showticklabels),"tickfont"in s&&(s.tickfont.color&&(a.tickColor[l]=r(s.tickfont.color)),s.tickfont.family&&(a.tickFont[l]=s.tickfont.family),s.tickfont.size&&(a.tickSize[l]=s.tickfont.size)),"mirror"in s?-1===["ticks","all","allticks"].indexOf(s.mirror)?!0===s.mirror?(a.lineTickMirror[l]=!1,a.lineMirror[l]=!0):(a.lineTickMirror[l]=!1,a.lineMirror[l]=!1):(a.lineTickMirror[l]=!0,a.lineMirror[l]=!0):a.lineMirror[l]=!1,"showbackground"in s&&!1!==s.showbackground?(a.backgroundEnable[l]=!0,a.backgroundColor[l]=r(s.backgroundcolor)):a.backgroundEnable[l]=!1}},t.exports=function(e,t){var r=new a;return r.merge(e,t),r}},{"../../../lib":719,"../../../lib/str2rgbarray":742}],812:[function(e,t){"use strict";function a(e,t,a,r){for(var n=a("bgcolor"),s=o.combine(n,r.paper_bgcolor),c=["up","center","eye"],p=0;p<c.length;p++)a("camera."+c[p]+".x"),a("camera."+c[p]+".y"),a("camera."+c[p]+".z");a("camera.projection.type");var u=!!a("aspectratio.x")&&!!a("aspectratio.y")&&!!a("aspectratio.z"),g=u?"manual":"auto",h=a("aspectmode",g);u||(e.aspectratio=t.aspectratio={x:1,y:1,z:1},"manual"===h&&(t.aspectmode="auto"),e.aspectmode=t.aspectmode);var m=d(r.fullData,"gl3d",r.id);l(e,t,{font:r.font,scene:r.id,data:m,bgColor:s,calendar:r.calendar,fullLayout:r.fullLayout}),i.getComponentMethod("annotations3d","handleDefaults")(e,t,r);var f=r.getDfltFromLayout("dragmode");if(!1!==f&&!f)if(f="orbit",e.camera&&e.camera.up){var _=e.camera.up.x,x=e.camera.up.y,y=e.camera.up.z;0!==y&&(_&&x&&y?.999<y/N(_*_+x*x+y*y)&&(f="turntable"):f="turntable")}else f="turntable";a("dragmode",f),a("hovermode",r.getDfltFromLayout("hovermode"))}var r=e("../../../lib"),o=e("../../../components/color"),i=e("../../../registry"),n=e("../../subplot_defaults"),l=e("./axis_defaults"),s=e("./layout_attributes"),d=e("../../get_data").getSubplotData;t.exports=function(e,t,o){var i=1<t._basePlotModules.length;n(e,t,o,{type:"gl3d",attributes:s,handleDefaults:a,fullLayout:t,font:t.font,fullData:o,getDfltFromLayout:function(t){if(!i){var a=r.validate(e[t],s[t]);if(a)return e[t]}},paper_bgcolor:t.paper_bgcolor,calendar:t.calendar})}},{"../../../components/color":593,"../../../lib":719,"../../../registry":847,"../../get_data":802,"../../subplot_defaults":842,"./axis_defaults":810,"./layout_attributes":813}],813:[function(e,t){"use strict";function a(e,t,a){return{x:{valType:"number",dflt:e,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}var r=e("./axis_attributes"),o=e("../../domain").attributes,i=e("../../../lib/extend").extendFlat,n=e("../../../lib").counterRegex;t.exports={_arrayAttrRegexps:[n("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:i(a(0,0,1),{}),center:i(a(0,0,0),{}),eye:i(a(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:o({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:r,yaxis:r,zaxis:r,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":719,"../../../lib/extend":710,"../../domain":792,"./axis_attributes":809}],814:[function(e,t){"use strict";function a(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var r=e("../../../lib/str2rgbarray"),o=["xaxis","yaxis","zaxis"],i=a.prototype;i.merge=function(e){for(var t=0,a;3>t;++t){if(a=e[o[t]],!a.visible){this.enabled[t]=!1,this.drawSides[t]=!1;continue}this.enabled[t]=a.showspikes,this.colors[t]=r(a.spikecolor),this.drawSides[t]=a.spikesides,this.lineWidth[t]=a.spikethickness}},t.exports=function(e){var t=new a;return t.merge(e),t}},{"../../../lib/str2rgbarray":742}],815:[function(e,t){"use strict";function a(e){for(var t=[,,,],a=0;3>a;++a){for(var r=e[a],o=Array(r.length),n=0;n<r.length;++n)o[n]=r[n].x;t[a]=o}return t}t.exports=function(e){for(var t=e.axesOptions,s=e.glplot.axesPixels,d=e.fullSceneLayout,c=[[],[],[]],p=0,u;3>p;++p)if(u=d[n[p]],u._length=(s[p].hi-s[p].lo)*s[p].pixelsPerDataUnit/e.dataScale[p],_a(u._length)===1/0||isNaN(u._length))c[p]=[];else{u._input_range=u.range.slice(),u.range[0]=s[p].lo/e.dataScale[p],u.range[1]=s[p].hi/e.dataScale[p],u._m=1/(e.dataScale[p]*s[p].pixelsPerDataUnit),u.range[0]===u.range[1]&&(u.range[0]-=1,u.range[1]+=1);var g=u.tickmode;if("auto"===u.tickmode){u.tickmode="linear";var h=u.nticks||o.constrain(u._length/40,4,9);r.autoTicks(u,_a(u.range[1]-u.range[0])/h)}for(var m=r.calcTicks(u),y=0;y<m.length;++y)m[y].x*=e.dataScale[p],"date"===u.type&&(m[y].text=m[y].text.replace(/\<br\>/g," "));c[p]=m,u.tickmode=g}t.ticks=c;for(var p=0;3>p;++p){l[p]=.5*(e.glplot.bounds[0][p]+e.glplot.bounds[1][p]);for(var y=0;2>y;++y)t.bounds[y][p]=e.glplot.bounds[y][p]}e.contourLevels=a(c)};var r=e("../../cartesian/axes"),o=e("../../../lib"),n=["xaxis","yaxis","zaxis"],l=[0,0,0]},{"../../../lib":719,"../../cartesian/axes":767}],816:[function(e,t){"use strict";function a(e,t){var a=[0,0,0,0],r,o;for(r=0;4>r;++r)for(o=0;4>o;++o)a[o]+=e[4*r+o]*t[r];return a}t.exports=function(e,t){var r=a(e.projection,a(e.view,a(e.model,[t[0],t[1],t[2],1])));return r}},{}],817:[function(e,t){"use strict";function a(e){function t(t,a){var r=e.fullSceneLayout[t];return y.tickText(r,r.d2l(a),"hover").text}var a=e.graphDiv,r=e.svgContainer,o=e.container.getBoundingClientRect(),n=o.width,l=o.height,s;r.setAttributeNS(null,"viewBox","0 0 "+n+" "+l),r.setAttributeNS(null,"width",n),r.setAttributeNS(null,"height",l),w(e),e.glplot.axes.update(e.axesOptions);for(var d=Object.keys(e.traces),c=null,p=e.glplot.selection,u=0;u<d.length;++u)s=e.traces[d[u]],"skip"!==s.data.hoverinfo&&s.handlePick(p)&&(c=s),s.setContourLevels&&s.setContourLevels();var g;if(null!==c){var h=b(e.glplot.cameraParams,p.dataCoordinate);s=c.data;var x=a._fullData[s.index],_=p.index,v={xLabel:t("xaxis",p.traceCoordinate[0]),yLabel:t("yaxis",p.traceCoordinate[1]),zLabel:t("zaxis",p.traceCoordinate[2])},k=f.castHoverinfo(x,e.fullLayout,_),T=(k||"").split("+"),A=k&&"all"===k;x.hovertemplate||A||(-1===T.indexOf("x")&&(v.xLabel=void 0),-1===T.indexOf("y")&&(v.yLabel=void 0),-1===T.indexOf("z")&&(v.zLabel=void 0),-1===T.indexOf("text")&&(p.textLabel=void 0),-1===T.indexOf("name")&&(c.name=void 0));var S=[],C;"cone"===s.type||"streamtube"===s.type?(v.uLabel=t("xaxis",p.traceCoordinate[3]),(A||-1!==T.indexOf("u"))&&S.push("u: "+v.uLabel),v.vLabel=t("yaxis",p.traceCoordinate[4]),(A||-1!==T.indexOf("v"))&&S.push("v: "+v.vLabel),v.wLabel=t("zaxis",p.traceCoordinate[5]),(A||-1!==T.indexOf("w"))&&S.push("w: "+v.wLabel),v.normLabel=p.traceCoordinate[6].toPrecision(3),(A||-1!==T.indexOf("norm"))&&S.push("norm: "+v.normLabel),"streamtube"===s.type&&(v.divergenceLabel=p.traceCoordinate[7].toPrecision(3),(A||-1!==T.indexOf("divergence"))&&S.push("divergence: "+v.divergenceLabel)),p.textLabel&&S.push(p.textLabel),C=S.join("<br>")):"isosurface"===s.type||"volume"===s.type?(v.valueLabel=y.tickText(e.mockAxis,e.mockAxis.d2l(p.traceCoordinate[3]),"hover").text,S.push("value: "+v.valueLabel),p.textLabel&&S.push(p.textLabel),C=S.join("<br>")):C=p.textLabel;var L={x:p.traceCoordinate[0],y:p.traceCoordinate[1],z:p.traceCoordinate[2],data:x._input,fullData:x,curveNumber:x.index,pointNumber:_};f.appendArrayPointValue(L,x,_),s._module.eventData&&(L=x._module.eventData(L,p,x,{},_));var E={points:[L]};e.fullSceneLayout.hovermode&&f.loneHover({trace:x,x:(.5+.5*h[0]/h[3])*n,y:(.5-.5*h[1]/h[3])*l,xLabel:v.xLabel,yLabel:v.yLabel,zLabel:v.zLabel,text:C,name:c.name,color:f.castHoverOption(x,_,"bgcolor")||c.color,borderColor:f.castHoverOption(x,_,"bordercolor"),fontFamily:f.castHoverOption(x,_,"font.family"),fontSize:f.castHoverOption(x,_,"font.size"),fontColor:f.castHoverOption(x,_,"font.color"),nameLength:f.castHoverOption(x,_,"namelength"),textAlign:f.castHoverOption(x,_,"align"),hovertemplate:m.castOption(x,_,"hovertemplate"),hovertemplateLabels:m.extendFlat({},L,v),eventData:[L]},{container:r,gd:a}),p.buttons&&5>p.distance?a.emit("plotly_click",E):a.emit("plotly_hover",E),g=E}else f.loneUnhover(r),a.emit("plotly_unhover",g);e.drawAnnotations(e)}function r(e,t,a,r,o){var i={canvas:r,gl:o,container:e.container,axes:e.axesOptions,spikes:e.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:t,pixelRatio:a};if(e.staticMode){if(!S&&(A=document.createElement("canvas"),S=u({canvas:A,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!S))throw new Error("error creating static canvas/context for image server");i.pixelRatio=e.pixelRatio,i.gl=S,i.canvas=A}try{e.glplot=p(i)}catch(t){return!1}return!0}function o(e,t,o,i){e.initializeGLCamera();var n=r(e,e.camera,t,o,i);if(!n)return _(e);var l=e.graphDiv,s=function(e){if(!1!==e.fullSceneLayout.dragmode){var t={};t[e.id+".camera"]=d(e.camera),e.saveCamera(l.layout),e.graphDiv.emit("plotly_relayout",t)}};return e.glplot.canvas.addEventListener("mouseup",function(){s(e)}),e.glplot.canvas.addEventListener("wheel",function(){l._context._scrollZoom.gl3d&&s(e)},!!g&&{passive:!1}),e.glplot.canvas.addEventListener("mousemove",function(){if(!1!==e.fullSceneLayout.dragmode&&0!==e.camera.mouseListener.buttons){var t={};t[e.id+".camera"]=d(e.camera),e.graphDiv.emit("plotly_relayouting",t)}}),e.staticMode||e.glplot.canvas.addEventListener("webglcontextlost",function(t){l&&l.emit&&l.emit("plotly_webglcontextlost",{event:t,layer:e.id})},!1),e.glplot.camera=e.camera,e.glplot.oncontextloss=function(){e.recoverContext()},e.glplot.onrender=a.bind(null,e),e.traces={},e.make4thDimension(),!0}function i(e,t){var a=document.createElement("div"),r=e.container;this.graphDiv=e.graphDiv;var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.style.position="absolute",i.style.top=i.style.left="0px",i.style.width=i.style.height="100%",i.style["z-index"]=20,i.style["pointer-events"]="none",a.appendChild(i),this.svgContainer=i,a.id=e.id,a.style.position="absolute",a.style.top=a.style.left="0px",a.style.width=a.style.height="100%",r.appendChild(a),this.fullLayout=t,this.id=e.id||"scene",this.fullSceneLayout=t[this.id],this.plotArgs=[[],{},{}],this.axesOptions=v(t,t[this.id]),this.spikeOptions=k(t[this.id]),this.container=a,this.staticMode=!!e.staticPlot,this.pixelRatio=this.pixelRatio||e.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=h.getComponentMethod("annotations3d","convert"),this.drawAnnotations=h.getComponentMethod("annotations3d","draw"),o(this,this.pixelRatio)}function n(e,t,a){for(var r=e.fullSceneLayout,o=0;3>o;o++){var n=C[o],l=n.charAt(0),s=r[n],c=t[l],p=t[l+"calendar"],u=t["_"+l+"length"];if(!m.isArrayOrTypedArray(c))a[0][o]=ea(a[0][o],0),a[1][o]=va(a[1][o],u-1);else for(var g=0,h;g<(u||c.length);g++)if(m.isArrayOrTypedArray(c[g]))for(var y=0;y<c[g].length;++y)h=s.d2l(c[g][y],0,p),!isNaN(h)&&isFinite(h)&&(a[0][o]=ea(a[0][o],h),a[1][o]=va(a[1][o],h));else h=s.d2l(c[g],0,p),!isNaN(h)&&isFinite(h)&&(a[0][o]=ea(a[0][o],h),a[1][o]=va(a[1][o],h))}}function l(e,t){for(var a=e.fullSceneLayout,r=a.annotations||[],o=0;3>o;o++)for(var i=C[o],n=i.charAt(0),l=a[i],s=0,c;s<r.length;s++)if(c=r[s],c.visible){var p=l.r2l(c[n]);!isNaN(p)&&isFinite(p)&&(t[0][o]=ea(t[0][o],p),t[1][o]=va(t[1][o],p))}}function s(e){return[[e.eye.x,e.eye.y,e.eye.z],[e.center.x,e.center.y,e.center.z],[e.up.x,e.up.y,e.up.z]]}function d(e){return{up:{x:e.up[0],y:e.up[1],z:e.up[2]},center:{x:e.center[0],y:e.center[1],z:e.center[2]},eye:{x:e.eye[0],y:e.eye[1],z:e.eye[2]},projection:{type:!0===e._ortho?"orthographic":"perspective"}}}var c=e("gl-plot3d").createCamera,p=e("gl-plot3d").createScene,u=e("webgl-context"),g=e("has-passive-events"),h=e("../../registry"),m=e("../../lib"),y=e("../../plots/cartesian/axes"),f=e("../../components/fx"),x=e("../../lib/str2rgbarray"),_=e("../../lib/show_no_webgl_msg"),b=e("./project"),v=e("./layout/convert"),k=e("./layout/spikes"),w=e("./layout/tick_marks"),T=i.prototype,A,S;T.initializeGLCamera=function(){var e=this.fullSceneLayout.camera,t="orthographic"===e.projection.type;this.camera=c(this.container,{center:[e.center.x,e.center.y,e.center.z],eye:[e.eye.x,e.eye.y,e.eye.z],up:[e.up.x,e.up.y,e.up.z],_ortho:t,zoomMin:.01,zoomMax:100,mode:"orbit"})},T.recoverContext=function(){function e(){return a.isContextLost()?void requestAnimationFrame(e):o(t,i,n,r,a)?void t.plot.apply(t,t.plotArgs):void m.error("Catastrophic and unrecoverable WebGL error. Context lost.")}var t=this,a=this.glplot.gl,r=this.glplot.canvas,i=this.glplot.camera,n=this.glplot.pixelRatio;this.glplot.dispose(),requestAnimationFrame(e)};var C=["xaxis","yaxis","zaxis"];T.plot=function(e,t,a){if(this.plotArgs=[e,t,a],!this.glplot.contextLost){var r=t[this.id],o=a[this.id],s,c,p,u,g,h;this.glplot.clearColor=r.bgcolor?x(r.bgcolor):[0,0,0,0],this.glplot.snapToData=!0,this.fullLayout=t,this.fullSceneLayout=r,this.glplotLayout=r,this.axesOptions.merge(t,r),this.spikeOptions.merge(r),this.setCamera(r.camera),this.updateFx(r.dragmode,r.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.update({}),this.setConvert(g),e?!Array.isArray(e)&&(e=[e]):e=[];var m=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(p=0;p<e.length;++p)s=e[p],!0!==s.visible||0===s._length||n(this,s,m);l(this,m);var y=[1,1,1];for(u=0;3>u;++u)y[u]=m[1][u]===m[0][u]?1:1/(m[1][u]-m[0][u]);for(this.dataScale=y,this.convertAnnotations(this),p=0;p<e.length;++p)(s=e[p],!0===s.visible&&0!==s._length)&&(c=this.traces[s.uid],c?c.data.type===s.type?c.update(s):(c.dispose(),c=s._module.plot(this,s),this.traces[s.uid]=c):(c=s._module.plot(this,s),this.traces[s.uid]=c),c.name=s.name);var f=Object.keys(this.traces);traceIdLoop:for(p=0;p<f.length;++p){for(u=0;u<e.length;++u)if(e[u].uid===f[p]&&!0===e[u].visible&&0!==e[u]._length)continue traceIdLoop;c=this.traces[f[p]],c.dispose(),delete this.traces[f[p]]}this.glplot.objects.sort(function(e,t){return e._trace.data.index-t._trace.data.index});var _=[[0,0,0],[0,0,0]],b=[],v={};for(p=0;3>p;++p){if(g=r[C[p]],h=g.type,h in v?(v[h].acc*=y[p],v[h].count+=1):v[h]={acc:y[p],count:1},g.autorange){_[0][p]=1/0,_[1][p]=-Infinity;var k=this.glplot.objects,w=this.fullSceneLayout.annotations||[],T=g._name.charAt(0);for(u=0;u<k.length;u++){var A=k[u],S=A.bounds,L=A._trace.data._pad||0;_[0][p]="ErrorBars"===A.constructor.name&&g._lowerLogErrorBound?ea(_[0][p],g._lowerLogErrorBound):ea(_[0][p],S[0][p]/y[p]-L),_[1][p]=va(_[1][p],S[1][p]/y[p]+L)}for(u=0;u<w.length;u++){var E=w[u];if(E.visible){var I=g.r2l(E[T]);_[0][p]=ea(_[0][p],I),_[1][p]=va(_[1][p],I)}}if("rangemode"in g&&"tozero"===g.rangemode&&(_[0][p]=ea(_[0][p],0),_[1][p]=va(_[1][p],0)),_[0][p]>_[1][p])_[0][p]=-1,_[1][p]=1;else{var z=_[1][p]-_[0][p];_[0][p]-=z/32,_[1][p]+=z/32}if("reversed"===g.autorange){var d=_[0][p];_[0][p]=_[1][p],_[1][p]=d}}else{var P=g.range;_[0][p]=g.r2l(P[0]),_[1][p]=g.r2l(P[1])}_[0][p]===_[1][p]&&(_[0][p]-=1,_[1][p]+=1),b[p]=_[1][p]-_[0][p],this.glplot.bounds[0][p]=_[0][p]*y[p],this.glplot.bounds[1][p]=_[1][p]*y[p]}var D=[1,1,1];for(p=0;3>p;++p){g=r[C[p]],h=g.type;var O=v[h];D[p]=ya(O.acc,1/O.count)/y[p]}var R;if("auto"===r.aspectmode)R=4>=va.apply(null,D)/ea.apply(null,D)?D:[1,1,1];else if("cube"===r.aspectmode)R=[1,1,1];else if("data"===r.aspectmode)R=D;else if("manual"===r.aspectmode){var M=r.aspectratio;R=[M.x,M.y,M.z]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");r.aspectratio.x=o.aspectratio.x=R[0],r.aspectratio.y=o.aspectratio.y=R[1],r.aspectratio.z=o.aspectratio.z=R[2],this.glplot.aspect=R;var F=r.domain||null,B=t._size||null;if(F&&B){var N=this.container.style;N.position="absolute",N.left=B.l+F.x[0]*B.w+"px",N.top=B.t+(1-F.y[1])*B.h+"px",N.width=B.w*(F.x[1]-F.x[0])+"px",N.height=B.h*(F.y[1]-F.y[0])+"px"}this.glplot.redraw()}},T.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=this.glplot.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},T.getCamera=function(){return this.glplot.camera.view.recalcMatrix(this.camera.view.lastT()),d(this.glplot.camera)},T.setCamera=function(e){this.glplot.camera.lookAt.apply(this,s(e));var t="orthographic"===e.projection.type,a=this.glplot.camera._ortho;if(t!==a){this.glplot.redraw();var r=this.glplot.pixelRatio,i=this.glplot.clearColor;this.glplot.gl.clearColor(i[0],i[1],i[2],i[3]),this.glplot.gl.clear(this.glplot.gl.DEPTH_BUFFER_BIT|this.glplot.gl.COLOR_BUFFER_BIT),this.glplot.dispose(),o(this,r),this.glplot.camera._ortho=t}},T.saveCamera=function(e){function t(e,t,a,r){var o=["up","center","eye"],i=["x","y","z"];return t[o[a]]&&e[o[a]][i[r]]===t[o[a]][i[r]]}var a=this.fullLayout,r=this.getCamera(),o=m.nestedProperty(e,this.id+".camera"),n=o.get(),l=!1;if(n===void 0)l=!0;else{for(var s=0;3>s;s++)for(var d=0;3>d;d++)if(!t(r,n,s,d)){l=!0;break}(!n.projection||r.projection&&r.projection.type!==n.projection.type)&&(l=!0)}if(l){var c={};c[this.id+".camera"]=n,h.call("_storeDirectGUIEdit",e,a._preGUI,c),o.set(r);var p=m.nestedProperty(a,this.id+".camera");p.set(r)}return l},T.updateFx=function(e,t){var a=this.camera;if(a)if("orbit"===e)a.mode="orbit",a.keyBindingMode="rotate";else if("turntable"===e){a.up=[0,0,1],a.mode="turntable",a.keyBindingMode="rotate";var r=this.graphDiv,o=r._fullLayout,i=this.fullSceneLayout.camera,n=i.up.x,l=i.up.y,s=i.up.z;if(.999>s/N(n*n+l*l+s*s)){var d=this.id+".camera.up",c={x:0,y:0,z:1},p={};p[d]=c;var u=r.layout;h.call("_storeDirectGUIEdit",u,o._preGUI,p),i.up=c,m.nestedProperty(u,d).set(c)}}else a.keyBindingMode=e;this.fullSceneLayout.hovermode=t},T.toImage=function(e){e||(e="png"),this.staticMode&&this.container.appendChild(A),this.glplot.redraw();var t=this.glplot.gl,a=t.drawingBufferWidth,r=t.drawingBufferHeight;t.bindFramebuffer(t.FRAMEBUFFER,null);var o=new Uint8Array(4*(a*r));t.readPixels(0,0,a,r,t.RGBA,t.UNSIGNED_BYTE,o);for(var n=0,s=r-1;n<s;++n,--s)for(var d=0;d<a;++d)for(var c=0,p;4>c;++c)p=o[4*(a*n+d)+c],o[4*(a*n+d)+c]=o[4*(a*s+d)+c],o[4*(a*s+d)+c]=p;var u=document.createElement("canvas");u.width=a,u.height=r;var g=u.getContext("2d"),h=g.createImageData(a,r);h.data.set(o),g.putImageData(h,0,0);var m;return m="jpeg"===e?u.toDataURL("image/jpeg"):"webp"===e?u.toDataURL("image/webp"):u.toDataURL("image/png"),this.staticMode&&this.container.removeChild(A),m},T.setConvert=function(){for(var e=0,t;3>e;e++)t=this.fullSceneLayout[C[e]],y.setConvert(t,this.fullLayout),t.setScale=m.noop},T.make4thDimension=function(){var e=this,t=e.graphDiv,a=t._fullLayout;e.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},y.setConvert(e.mockAxis,a)},t.exports=i},{"../../components/fx":632,"../../lib":719,"../../lib/show_no_webgl_msg":740,"../../lib/str2rgbarray":742,"../../plots/cartesian/axes":767,"../../registry":847,"./layout/convert":811,"./layout/spikes":814,"./layout/tick_marks":815,"./project":816,"gl-plot3d":290,"has-passive-events":411,"webgl-context":556}],818:[function(e,t){"use strict";t.exports=function(e,t,a,r){r=r||e.length;for(var o=Array(r),n=0;n<r;n++)o[n]=[e[n],t[n],a[n]];return o}},{}],819:[function(e,t){"use strict";var a=e("./font_attributes"),r=e("./animation_attributes"),o=e("../components/color/attributes"),i=e("./pad_attributes"),n=e("../lib/extend").extendFlat,l=a({editType:"calc"});l.family.dflt="\"Open Sans\", verdana, arial, sans-serif",l.size.dflt=12,l.color.dflt=o.defaultLine,t.exports={font:l,title:{text:{valType:"string",editType:"layoutstyle"},font:a({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(i({editType:"layoutstyle"}),{}),editType:"layoutstyle"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:o.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:o.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:o.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},modebar:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"modebar"},meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},r.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:a({editType:"layoutstyle"})}}},{"../components/color/attributes":592,"../lib/extend":710,"./animation_attributes":762,"./font_attributes":793,"./pad_attributes":827}],820:[function(e,t){"use strict";var a={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:"<a href=\"http://www.openstreetmap.org/about/\" target=\"_blank\">\xA9 OpenStreetMap</a>",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:"<a href=\"https://carto.com/\" target=\"_blank\">\xA9 CARTO</a>",tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:"<a href=\"https://carto.com/\" target=\"_blank\">\xA9 CARTO</a>",tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:"Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> | Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.",tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:"Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> | Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.",tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:"Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> | Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://creativecommons.org/licenses/by-sa/3.0\">CC BY SA</a>.",tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},r=Object.keys(a);t.exports={requiredVersion:"1.1.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:a,styleValuesNonMapbox:r,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:"Your custom plotly.js bundle is not using the correct mapbox-gl version\nPlease install mapbox-gl@1.1.1.",noAccessTokenErrorMsg:"Missing Mapbox access token.\nMapbox trace type require a Mapbox access token to be registered.\nFor example:\n  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });\nMore info here: https://www.mapbox.com/help/define-access-token/",missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",r.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:"Set multiple mapbox access token across different mapbox subplot,\nusing first token found as mapbox-gl does not allow multipleaccess tokens on the same page.",mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":"content: \"\"; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"%3E %3Cpath fill=\"%23333333\" fill-rule=\"evenodd\" d=\"M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0\"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;","ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":"display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version=\"1.0\" encoding=\"utf-8\"?%3E %3Csvg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 21 21\" style=\"enable-background:new 0 0 21 21;\" xml:space=\"preserve\"%3E%3Cg transform=\"translate(0,0.01)\"%3E%3Cpath d=\"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z\" style=\"opacity:0.9;fill:%23ffffff;enable-background:new\" class=\"st0\"/%3E%3Cpath d=\"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z\" style=\"opacity:0.35;enable-background:new\" class=\"st1\"/%3E%3Cpath d=\"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z\" style=\"opacity:0.35;enable-background:new\" class=\"st1\"/%3E%3Cpolygon points=\"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 \" style=\"opacity:0.9;fill:%23ffffff;enable-background:new\" class=\"st0\"/%3E%3C/g%3E%3C/svg%3E')"}}},{}],821:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){var r=e.split(" "),o=r[0],i=r[1],n=a.isArrayOrTypedArray(t)?a.mean(t):t,l=.5+n/100,s=1.5+n/100,d=["",""],c=[0,0];"top"===o?(d[0]="top",c[1]=-s):"bottom"===o?(d[0]="bottom",c[1]=s):void 0,"left"===i?(d[1]="right",c[0]=-l):"right"===i?(d[1]="left",c[0]=l):void 0;var p;return p=d[0]&&d[1]?d.join("-"):d[0]?d[0]:d[1]?d[1]:"center",{anchor:p,offset:c}}},{"../../lib":719}],822:[function(e,t,a){"use strict";function r(e,t){var a=e._fullLayout,r=e._context;if(""===r.mapboxAccessToken)return"";for(var n=[],s=[],d=!1,c=!1,p=0;p<t.length;p++){var u=a[t[p]],g=u.accesstoken;o(u.style)&&(g?l.pushUnique(n,g):(o(u._input.style)&&(l.error("Uses Mapbox map style, but did not set an access token."),d=!0),c=!0)),g&&l.pushUnique(s,g)}if(c){var h=d?m.noAccessTokenErrorMsg:m.missingStyleErrorMsg;throw new Error(h)}return n.length?(1<n.length&&l.warn(m.multipleTokensErrorMsg),n[0]):(s.length&&l.log(["Listed mapbox access token(s)",s.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function o(e){return"string"==typeof e&&-1!==m.styleValuesMapbox.indexOf(e)}var n=e("mapbox-gl"),l=e("../../lib"),s=e("../../plots/get_data").getSubplotCalcData,d=e("../../constants/xmlns_namespaces"),c=e("d3"),p=e("../../components/drawing"),u=e("../../lib/svg_text_utils"),g=e("./mapbox"),h="mapbox",m=a.constants=e("./constants");a.name=h,a.attr="subplot",a.idRoot=h,a.idRegex=a.attrRegex=l.counterRegex(h),a.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.plot=function(e){var t=e._fullLayout,a=e.calcdata,o=t._subplots[h];if(n.version!==m.requiredVersion)throw new Error(m.wrongVersionErrorMsg);var d=r(e,o);n.accessToken=d;for(var c=0;c<o.length;c++){var p=o[c],u=s(a,h,p),y=t[p],f=y._subplot;f||(f=new g(e,p),t[p]._subplot=f),f.viewInitial||(f.viewInitial={center:l.extendFlat({},y.center),zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),f.plot(u,t,e._promises)}},a.clean=function(e,t,a,r){for(var o=r._subplots[h]||[],n=0,l;n<o.length;n++)l=o[n],t[l]||!r[l]._subplot||r[l]._subplot.destroy()},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots[h],r=t._size,o=0;o<a.length;o++){var n=t[a[o]],l=n.domain,s=n._subplot,g=s.toImage("png"),y=t._glimages.append("svg:image");y.attr({xmlns:d.svg,"xlink:href":g,x:r.l+r.w*l.x[0],y:r.t+r.h*(1-l.y[1]),width:r.w*(l.x[1]-l.x[0]),height:r.h*(l.y[1]-l.y[0]),preserveAspectRatio:"none"});var f=c.select(n._subplot.div),x=null===f.select(".mapboxgl-ctrl-logo").node().offsetParent;if(!x){var _=t._glimages.append("g");_.attr("transform","translate("+(r.l+r.w*l.x[0]+10)+", "+(r.t+r.h*(1-l.y[0])-31)+")"),_.append("path").attr("d",m.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),_.append("path").attr("d",m.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),_.append("path").attr("d",m.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),_.append("polygon").attr("points",m.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var b=f.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),v=t._glimages.append("g"),k=v.append("text");k.text(b).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":b});var w=p.bBox(k.node()),T=r.w*(l.x[1]-l.x[0]);if(w.width>T/2){var A=b.split("|").join("<br>");k.text(A).attr("data-unformatted",A).call(u.convertToTspans,e),w=p.bBox(k.node())}k.attr("transform","translate(-3, "+(-w.height+8)+")"),v.insert("rect",".static-attribution").attr({x:-w.width-6,y:-w.height-3,width:w.width+6,height:w.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;w.width+6>T&&(S=T/(w.width+6));var C=[r.l+r.w*l.x[1],r.t+r.h*(1-l.y[0])];v.attr("transform","translate("+C[0]+","+C[1]+") scale("+S+")")}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots[h],r=0,o;r<a.length;r++)o=t[a[r]]._subplot,o.updateFx(t)}},{"../../components/drawing":614,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/get_data":802,"./constants":820,"./layout_attributes":824,"./layout_defaults":825,"./mapbox":826,d3:163,"mapbox-gl":426}],823:[function(e,t){"use strict";function a(e,t){this.subplot=e,this.uid=e.uid+"-"+t,this.index=t,this.idSource="source-"+this.uid,this.idLayer=s.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}function r(e){var t=e.source;return e.visible&&(n.isPlainObject(t)||("string"==typeof t||Array.isArray(t))&&0<t.length)}function o(e){var t={},a={};switch(e.type){case"circle":n.extendFlat(a,{"circle-radius":e.circle.radius,"circle-color":e.color,"circle-opacity":e.opacity});break;case"line":n.extendFlat(a,{"line-width":e.line.width,"line-color":e.color,"line-opacity":e.opacity,"line-dasharray":e.line.dash});break;case"fill":n.extendFlat(a,{"fill-color":e.color,"fill-outline-color":e.fill.outlinecolor,"fill-opacity":e.opacity});break;case"symbol":var r=e.symbol,o=l(r.textposition,r.iconsize);n.extendFlat(t,{"icon-image":r.icon+"-15","icon-size":r.iconsize/10,"text-field":r.text,"text-size":r.textfont.size,"text-anchor":o.anchor,"text-offset":o.offset,"symbol-placement":r.placement}),n.extendFlat(a,{"icon-color":e.color,"text-color":r.textfont.color,"text-opacity":e.opacity});}return{layout:t,paint:a}}function i(e){var t=e.sourcetype,a=e.source,r={type:t},o;return"geojson"===t?o="data":"vector"===t?o="string"==typeof a?"url":"tiles":"raster"===t?(o="tiles",r.tileSize=256):"image"===t&&(o="url",r.coordinates=e.coordinates),r[o]=a,e.sourceattribution&&(r.attribution=e.sourceattribution),r}var n=e("../../lib"),l=e("./convert_text_opts"),s=e("./constants"),d=a.prototype;d.update=function(e){this.visible?this.needsNewSource(e)?(this.removeLayer(),this.updateSource(e),this.updateLayer(e)):this.needsNewLayer(e)?this.updateLayer(e):this.updateStyle(e):(this.updateSource(e),this.updateLayer(e)),this.visible=r(e)},d.needsNewSource=function(e){return this.sourceType!==e.sourcetype||this.source!==e.source||this.layerType!==e.type},d.needsNewLayer=function(e){return this.layerType!==e.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},d.updateSource=function(e){var t=this.subplot.map;if(t.getSource(this.idSource)&&t.removeSource(this.idSource),this.sourceType=e.sourcetype,this.source=e.source,!!r(e)){var a=i(e);t.addSource(this.idSource,a)}},d.updateLayer=function(e){var t=this.subplot,a=o(e),n=this.subplot.belowLookup["layout-"+this.index],l;if("traces"===n){for(var d=t.getMapLayers(),c=0,p;c<d.length;c++)if(p=d[c].id,"string"==typeof p&&0===p.indexOf(s.traceLayerPrefix)){l=p;break}}else l=n;this.removeLayer(),r(e)&&t.addLayer({id:this.idLayer,source:this.idSource,"source-layer":e.sourcelayer||"",type:e.type,minzoom:e.minzoom,maxzoom:e.maxzoom,layout:a.layout,paint:a.paint},l),this.layerType=e.type,this.below=n},d.updateStyle=function(e){if(r(e)){var t=o(e);this.subplot.setOptions(this.idLayer,"setLayoutProperty",t.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",t.paint)}},d.removeLayer=function(){var e=this.subplot.map;e.getLayer(this.idLayer)&&e.removeLayer(this.idLayer)},d.dispose=function(){var e=this.subplot.map;e.removeLayer(this.idLayer),e.removeSource(this.idSource)},t.exports=function(e,t,r){var o=new a(e,t);return o.update(r),o}},{"../../lib":719,"./constants":820,"./convert_text_opts":821}],824:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/color").defaultLine,o=e("../domain").attributes,i=e("../font_attributes"),n=e("../../traces/scatter/attributes").textposition,l=e("../../plot_api/edit_types").overrideAll,s=e("../../plot_api/plot_template").templatedArray,d=e("./constants"),c=i({});c.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var p=t.exports=l({_arrayAttrRegexps:[a.counterRegex("mapbox",".layers",!0)],domain:o({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:d.styleValuesMapbox.concat(d.styleValuesNonMapbox),dflt:d.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:s("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:r},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:r}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:c,textposition:a.extendFlat({},n,{arrayOk:!1})}})},"plot","from-root");p.uirevision={valType:"any",editType:"none"}},{"../../components/color":593,"../../lib":719,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../traces/scatter/attributes":1112,"../domain":792,"../font_attributes":793,"./constants":820}],825:[function(e,t){"use strict";function a(e,t,a,o){a("accesstoken",o.accessToken),a("style"),a("center.lon"),a("center.lat"),a("zoom"),a("bearing"),a("pitch"),n(e,t,{name:"layers",handleItemDefaults:r}),t._input=e}function r(e,t){function a(a,r){return o.coerce(e,t,l.layers,a,r)}var r=a("visible");if(r){var i=a("sourcetype"),n="raster"===i||"image"===i;a("source"),a("sourceattribution"),"vector"===i&&a("sourcelayer"),"image"===i&&a("coordinates");var s;n&&(s="raster");var d=a("type",s);n&&"raster"!==d&&(d=t.type="raster",o.log("Source types *raster* and *image* must drawn *raster* layer type.")),a("below"),a("color"),a("opacity"),a("minzoom"),a("maxzoom"),"circle"===d&&a("circle.radius"),"line"===d&&(a("line.width"),a("line.dash")),"fill"===d&&a("fill.outlinecolor"),"symbol"===d&&(a("symbol.icon"),a("symbol.iconsize"),a("symbol.text"),o.coerceFont(a,"symbol.textfont"),a("symbol.textposition"),a("symbol.placement"))}}var o=e("../../lib"),i=e("../subplot_defaults"),n=e("../array_container_defaults"),l=e("./layout_attributes");t.exports=function(e,t,r){i(e,t,r,{type:"mapbox",attributes:l,handleDefaults:a,partition:"y",accessToken:t._mapboxAccessToken})}},{"../../lib":719,"../array_container_defaults":763,"../subplot_defaults":842,"./layout_attributes":824}],826:[function(e,t){"use strict";function a(e,t){this.id=t,this.gd=e;var a=e._fullLayout,r=e._context;this.container=a._glcontainer.node(),this.isStatic=r.staticPlot,this.uid=a._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(a),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={}}function r(e){var t={};return d.isPlainObject(e)?(t.id=e.id,t.style=e):"string"==typeof e?(t.id=e,t.style=-1===m.styleValuesMapbox.indexOf(e)?m.stylesNonMapbox[e]?m.stylesNonMapbox[e]:e:o(e)):(t.id=m.styleValueDflt,t.style=o(m.styleValueDflt)),t.transition={duration:0,delay:0},t}function o(e){return m.styleUrlPrefix+e+"-"+m.styleUrlSuffix}function i(e){return[e.lon,e.lat]}var n=e("mapbox-gl"),l=e("d3"),s=e("../../components/fx"),d=e("../../lib"),c=e("../../registry"),p=e("../cartesian/axes"),u=e("../../components/dragelement"),g=e("../cartesian/select").prepSelect,h=e("../cartesian/select").selectOnClick,m=e("./constants"),y=e("./layers"),f=a.prototype;f.plot=function(e,t,a){var r=this,o=t[r.id];r.map&&o.accesstoken!==r.accessToken&&(r.map.remove(),r.map=null,r.styleObj=null,r.traceHash=[],r.layerList={});var i;i=r.map?new Promise(function(a,o){r.updateMap(e,t,a,o)}):new Promise(function(a,o){r.createMap(e,t,a,o)}),a.push(i)},f.createMap=function(e,t,a,o){var l=this,s=t[l.id],d=l.styleObj=r(s.style);l.accessToken=s.accesstoken;var c=l.map=new n.Map({container:l.div,style:d.style,center:i(s.center),zoom:s.zoom,bearing:s.bearing,pitch:s.pitch,interactive:!l.isStatic,preserveDrawingBuffer:l.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new n.AttributionControl({compact:!0}));c._canvas.style.left="0px",c._canvas.style.top="0px",l.rejectOnError(o),l.isStatic||l.initFx(e,t);var p=[];p.push(new Promise(function(e){c.once("load",e)})),p=p.concat(l.fetchMapData(e,t)),Promise.all(p).then(function(){l.fillBelowLookup(e,t),l.updateData(e),l.updateLayout(t),l.resolveOnRender(a)}).catch(o)},f.fetchMapData=function(e){function t(e){return new Promise(function(t,a){l.json(e,function(r,o){if(r){delete PlotlyGeoAssets[e];var i=404===r.status?"GeoJSON at URL \""+e+"\" does not exist.":"Unexpected error while fetching from "+e;return a(new Error(i))}PlotlyGeoAssets[e]=o,t(o)})})}for(var a=[],r=0;r<e.length;r++){var o=e[r][0].trace,n=o.geojson;"string"!=typeof n||PlotlyGeoAssets[n]||(PlotlyGeoAssets[n]="pending",a.push(t(n)))}return a},f.updateMap=function(e,t,a,o){var i=this,n=i.map,l=t[this.id];i.rejectOnError(o);var s=[],d=r(l.style);i.styleObj.id!==d.id&&(i.styleObj=d,n.setStyle(d.style),i.traceHash={},s.push(new Promise(function(e){n.once("styledata",e)}))),s=s.concat(i.fetchMapData(e,t)),Promise.all(s).then(function(){i.fillBelowLookup(e,t),i.updateData(e),i.updateLayout(t),i.resolveOnRender(a)}).catch(o)},f.fillBelowLookup=function(e,t){var a=t[this.id],r=a.layers,o=this.belowLookup={},n=!1,l,s;for(l=0;l<e.length;l++){var d=e[l][0].trace,c=d._module;"string"==typeof d.below?s=d.below:c.getBelow&&(s=c.getBelow(d,this)),""===s&&(n=!0),o["trace-"+d.uid]=s||""}for(l=0;l<r.length;l++){var p=r[l];s="string"==typeof p.below?p.below:n?"traces":"",o["layout-"+l]=s}var u={},g,h;for(g in o)s=o[g],u[s]?u[s].push(g):u[s]=[g];for(s in u){var m=u[s];if(1<m.length)for(l=0;l<m.length;l++)g=m[l],0===g.indexOf("trace-")?(h=g.split("trace-")[1],this.traceHash[h]&&(this.traceHash[h].below=null)):0===g.indexOf("layout-")&&(h=g.split("layout-")[1],this.layerList[h]&&(this.layerList[h].below=null))}};var x={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};f.updateData=function(e){var t=this.traceHash,a=e.slice().sort(function(e,t){return x[e[0].trace.type]-x[t[0].trace.type]}),r,o,n,l;for(n=0;n<a.length;n++){var s=a[n];o=s[0].trace,r=t[o.uid],r?r.update(s):o._module&&(t[o.uid]=o._module.plot(this,s))}var d=Object.keys(t);idLoop:for(n=0;n<d.length;n++){var c=d[n];for(l=0;l<e.length;l++)if(o=e[l][0].trace,c===o.uid)continue idLoop;r=t[c],r.dispose(),delete t[c]}},f.updateLayout=function(e){var t=this.map,a=e[this.id];t.setCenter(i(a.center)),t.setZoom(a.zoom),t.setBearing(a.bearing),t.setPitch(a.pitch),this.updateLayers(e),this.updateFramework(e),this.updateFx(e),this.map.resize(),this.gd._context._scrollZoom.mapbox?t.scrollZoom.enable():t.scrollZoom.disable()},f.resolveOnRender=function(e){var t=this.map;t.on("render",function a(){t.loaded()&&(t.off("render",a),setTimeout(e,0))})},f.rejectOnError=function(e){function t(){e(new Error(m.mapOnErrorMsg))}var a=this.map;a.once("error",t),a.once("style.error",t),a.once("source.error",t),a.once("tile.error",t),a.once("layer.error",t)},f.createFramework=function(e){var t=this,a=t.div=document.createElement("div");a.id=t.uid,a.style.position="absolute",t.container.appendChild(a),t.xaxis={_id:"x",c2p:function(e){return t.project(e).x}},t.yaxis={_id:"y",c2p:function(e){return t.project(e).y}},t.updateFramework(e),t.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},p.setConvert(t.mockAxis,e)},f.initFx=function(e,t){function a(){s.loneUnhover(t._hoverlayer)}function r(){var e=o.getView();n.emit("plotly_relayouting",o.getViewEdits(e))}var o=this,n=o.gd,l=o.map,d=!1;l.on("moveend",function(e){if(o.map){var t=n._fullLayout;if(e.originalEvent||d){var a=t[o.id];c.call("_storeDirectGUIEdit",n.layout,t._preGUI,o.getViewEdits(a));var r=o.getView();a._input.center=a.center=r.center,a._input.zoom=a.zoom=r.zoom,a._input.bearing=a.bearing=r.bearing,a._input.pitch=a.pitch=r.pitch,n.emit("plotly_relayout",o.getViewEdits(r))}d=!1,t._rehover&&t._rehover()}}),l.on("wheel",function(){d=!0}),l.on("mousemove",function(e){var t=o.div.getBoundingClientRect();e.clientX=e.point.x+t.left,e.clientY=e.point.y+t.top,e.target.getBoundingClientRect=function(){return t},o.xaxis.p2c=function(){return e.lngLat.lng},o.yaxis.p2c=function(){return e.lngLat.lat},n._fullLayout._rehover=function(){n._fullLayout._hoversubplot===o.id&&s.hover(n,e,o.id)},s.hover(n,e,o.id),n._fullLayout._hoversubplot=o.id}),l.on("dragstart",a),l.on("zoomstart",a),l.on("mouseout",function(){n._fullLayout._hoversubplot=null}),l.on("drag",r),l.on("zoom",r),l.on("dblclick",function(){var e=n._fullLayout[o.id];c.call("_storeDirectGUIEdit",n.layout,n._fullLayout._preGUI,o.getViewEdits(e));var t=o.viewInitial;l.setCenter(i(t.center)),l.setZoom(t.zoom),l.setBearing(t.bearing),l.setPitch(t.pitch);var a=o.getView();e._input.center=e.center=a.center,e._input.zoom=e.zoom=a.zoom,e._input.bearing=e.bearing=a.bearing,e._input.pitch=e.pitch=a.pitch,n.emit("plotly_doubleclick",null),n.emit("plotly_relayout",o.getViewEdits(a))}),o.clearSelect=function(){n._fullLayout._zoomlayer.selectAll(".select-outline").remove()},o.onClickInPanFn=function(e){return function(t){var a=n._fullLayout.clickmode;-1<a.indexOf("select")&&h(t.originalEvent,n,[o.xaxis],[o.yaxis],o.id,e),-1<a.indexOf("event")&&s.click(n,t.originalEvent)}}},f.updateFx=function(e){function t(e){var t=a.map.unproject(e);return[t.lng,t.lat]}var a=this,r=a.map,o=a.gd;if(!a.isStatic){var i=e.dragmode,n;n="select"===i?function(e,r){var o=e.range={};o[a.id]=[t([r.xmin,r.ymin]),t([r.xmax,r.ymax])]}:function(e,r,o){var i=e.lassoPoints={};i[a.id]=o.filtered.map(t)};var l=a.dragOptions;a.dragOptions=d.extendDeep(l||{},{element:a.div,gd:o,plotinfo:{id:a.id,xaxis:a.xaxis,yaxis:a.yaxis,fillRangeItems:n},xaxes:[a.xaxis],yaxes:[a.yaxis],subplot:a.id}),r.off("click",a.onClickInPanHandler),"select"===i||"lasso"===i?(r.dragPan.disable(),r.on("zoomstart",a.clearSelect),a.dragOptions.prepFn=function(t,e,r){g(t,e,r,a.dragOptions,i)},u.init(a.dragOptions)):(r.dragPan.enable(),r.off("zoomstart",a.clearSelect),a.div.onmousedown=null,a.onClickInPanHandler=a.onClickInPanFn(a.dragOptions),r.on("click",a.onClickInPanHandler))}},f.updateFramework=function(e){var t=e[this.id].domain,a=e._size,r=this.div.style;r.width=a.w*(t.x[1]-t.x[0])+"px",r.height=a.h*(t.y[1]-t.y[0])+"px",r.left=a.l+t.x[0]*a.w+"px",r.top=a.t+(1-t.y[1])*a.h+"px",this.xaxis._offset=a.l+t.x[0]*a.w,this.xaxis._length=a.w*(t.x[1]-t.x[0]),this.yaxis._offset=a.t+(1-t.y[1])*a.h,this.yaxis._length=a.h*(t.y[1]-t.y[0])},f.updateLayers=function(e){var t=e[this.id],a=t.layers,r=this.layerList,o;if(a.length!==r.length){for(o=0;o<r.length;o++)r[o].dispose();for(r=this.layerList=[],o=0;o<a.length;o++)r.push(y(this,o,a[o]))}else for(o=0;o<a.length;o++)r[o].update(a[o])},f.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},f.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},f.setOptions=function(e,t,a){for(var r in a)this.map[t](e,r,a[r])},f.getMapLayers=function(){return this.map.getStyle().layers},f.addLayer=function(e,t){var a=this.map;if("string"==typeof t){if(""===t)return void a.addLayer(e,t);for(var r=this.getMapLayers(),o=0;o<r.length;o++)if(t===r[o].id)return void a.addLayer(e,t);d.warn(["Trying to add layer with *below* value",t,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}a.addLayer(e)},f.project=function(e){return this.map.project(new n.LngLat(e[0],e[1]))},f.getView=function(){var e=this.map,t=e.getCenter(),a={lon:t.lng,lat:t.lat};return{center:a,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch()}},f.getViewEdits=function(e){for(var t=this.id,a=["center","zoom","bearing","pitch"],r={},o=0,n;o<a.length;o++)n=a[o],r[t+"."+n]=e[n];return r},t.exports=a},{"../../components/dragelement":611,"../../components/fx":632,"../../lib":719,"../../registry":847,"../cartesian/axes":767,"../cartesian/select":784,"./constants":820,"./layers":823,d3:163,"mapbox-gl":426}],827:[function(e,t){"use strict";t.exports=function(e){var t=e.editType;return{t:{valType:"number",dflt:0,editType:t},r:{valType:"number",dflt:0,editType:t},b:{valType:"number",dflt:0,editType:t},l:{valType:"number",dflt:0,editType:t},editType:t}}},{}],828:[function(e,t){"use strict";function a(e,t){t.text("");var a=t.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(e._context.linkText+" "+D(187));if(e._context.sendData)a.on("click",function(){_.sendDataToCloud(e)});else{var r=window.location.pathname.split("/"),o=window.location.search;a.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+r[2].split(".")[0]+"/"+r[1]+o})}}function r(e,t){function a(e,t){p[t]=e,u[e]=1}function r(e,t){if(e&&"string"==typeof e&&!u[e])return a(e,t),!0}var o=t.length,n=[],l,s;for(l=0;l<e.length;l++){var d=e[l]._fullInput;d!==s&&n.push(d),s=d}var c=n.length,p=Array(o),u={};for(l=0;l<o;l++){var g=t[l].uid;"number"==typeof g&&(g=g+""),r(g,l)||l<c&&r(n[l].uid,l)||a(w.randstr(u),l)}return p}function o(){var e=b.collectableSubplotTypes,t={},a,r;if(!e){e=[];var o=b.subplotsRegistry;for(var n in o){var l=o[n],s=l.attr;if(s&&(e.push(n),Array.isArray(s)))for(r=0;r<s.length;r++)w.pushUnique(e,s[r])}}for(a=0;a<e.length;a++)t[e[a]]=[];return t}function n(e,t){function a(e){for(var a=!0,r=0,l;r<t.length;r++)l=t[r],n[l]||(e[l]?n[l]=e[l]:a=!1);a&&(o=!0)}var r=e._context.locale;for(var o=!1,n={},l=0,s;2>l;l++){s=e._context.locales;for(var d=0,c;2>d&&(c=(s[r]||{}).format,!(c&&(a(c),o)));d++)s=b.localeRegistry;var p=r.split("-")[0];if(o||p===r)break;r=p}return o||a(b.localeRegistry.en.format),n}function l(e,t){return e.decimal=t.charAt(0),e.thousands=t.charAt(1),f.locale(e)}function s(e,t){var a=[],r;t.meta&&(r=t._meta={meta:t.meta,layout:{meta:t.meta}});for(var o=0,n;o<e.length;o++)n=e[o],n.meta?a[n.index]=n._meta={meta:n.meta}:t.meta&&(n._meta={meta:t.meta}),t.meta&&(n._meta.layout={meta:t.meta});a.length&&(!r&&(r=t._meta={}),r.data=a)}function d(e,t){var a={_fullLayout:t},r="x"===e._id.charAt(0),o=e._mainAxis._anchorAxis,i="",n="",l="";if(o&&(l=o._mainAxis._id,i=r?e._id+l:l+e._id),!i||!t._plots[i]){i="";for(var s=e._counterAxes,d=0;d<s.length;d++){var c=s[d],p=r?e._id+c:c+e._id;n||(n=p);var u=S.getFromId(a,c);if(l&&u.overlaying===l){i=p;break}}}return i||n}function c(e){var t=e.transforms;if(Array.isArray(t)&&t.length)for(var a=0;a<t.length;a++){var r=t[a],o=r._module||z[r.type];if(o&&o.makesData)return!0}return!1}function p(e,t,a,r){for(var o=e.transforms,n=[e],l=0;l<o.length;l++){var s=o[l],d=z[s.type];d&&d.transform&&(n=d.transform(n,{transform:s,fullTrace:e,fullData:t,layout:a,fullLayout:r,transformIndex:l}))}return n}function u(e){var t=e.margin;if(!e._size){var a=e._size={l:V(t.l),r:V(t.r),t:V(t.t),b:V(t.b),p:V(t.pad)};a.w=V(e.width)-a.l-a.r,a.h=V(e.height)-a.t-a.b}e._pushmargin||(e._pushmargin={}),e._pushmarginIds||(e._pushmarginIds={})}function g(e,t,a){function r(e){var t=Promise.resolve();if(!e)return t;for(;e.length;)t=t.then(e.shift());return t}function o(e){if(e)for(;e.length;)e.shift()}function i(t){if(e._transitionData)return o(e._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(a.redraw)return b.call("redraw",e)}).then(function(){e._transitioning=!1,e._transitioningWithDuration=!1,e.emit("plotly_transitioned",[])}).then(t)}var n=!1,l=[_.previousPromises,function(){if(e._transitionData)return e._transitioning=!1,r(e._transitionData._interruptCallbacks)},a.prepareFn,_.rehover,function(){return e.emit("plotly_transitioning",[]),new Promise(function(r){function o(){return l++,function(){s++,n||s!==l||i(r)}}e._transitioning=!0,0<t.duration&&(e._transitioningWithDuration=!0),e._transitionData._interruptCallbacks.push(function(){n=!0}),a.redraw&&e._transitionData._interruptCallbacks.push(function(){return b.call("redraw",e)}),e._transitionData._interruptCallbacks.push(function(){e.emit("plotly_transitioninterrupted",[])});var l=0,s=0;a.runFn(o),setTimeout(o())})}],s=w.syncOrAsync(l,e);return s&&s.then||(s=Promise.resolve()),s.then(function(){return e})}function h(e,t){function a(e,a,r){var i=a._id.charAt(0);if("histogram2dcontour"===e){var n=a._counterAxes[0],l=S.getFromId(t,n),s="x"===i||"x"===n&&"category"===l.type,d="y"===i||"y"===n&&"category"===l.type;return function(e,t){return 0===e||0===t?-1:s&&e===r[t].length-1?-1:d&&t===r.length-1?-1:("y"===i?t:e)-1}}return function(e,t){return"y"===i?t:e}}var r=[],n={min:function(e){return w.aggNums(Math.min,null,e)},max:function(e){return w.aggNums(Math.max,null,e)},sum:function(e){return w.aggNums(function(e,t){return e+t},null,e)},total:function(e){return w.aggNums(function(e,t){return e+t},null,e)},mean:function(e){return w.mean(e)},median:function(e){return w.median(e)}},s,d,c,p,u;for(s=0;s<e.length;s++){var g=e[s];if("category"===g.type){var h=g.categoryorder.match(F);if(h){var m=h[1],y=h[2],f=[];for(d=0;d<g._categories.length;d++)f.push([g._categories[d],[]]);for(d=0;d<g._traceIndices.length;d++){var x=g._traceIndices[d],_=t._fullData[x],v=g._id.charAt(0);if(!0===_.visible){var T=_.type;b.traceIs(_,"histogram")&&(delete _._xautoBinFinished,delete _._yautoBinFinished);var A=t.calcdata[x];for(c=0;c<A.length;c++){var C=A[c],L,E,I;if("splom"===T){var z=_._axesDim[g._id];if("y"===v){var P=_._diag[z][0];P&&(g=t._fullLayout[S.id2name(P)])}var D=C.trace.dimensions[z].values;for(p=0;p<D.length;p++)for(L=D[p],E=g._categoriesMap[L],u=0;u<C.trace.dimensions.length;u++)if(u!==z){var O=C.trace.dimensions[u];f[E][1].push(O.values[p])}}else if("scattergl"===T){for(p=0;p<C.t.x.length;p++)"x"===v&&(L=C.t.x[p],E=L,I=C.t.y[p]),"y"===v&&(L=C.t.y[p],E=L,I=C.t.x[p]),f[E][1].push(I);C.t&&C.t._scene&&delete C.t._scene.dirty}else if(C.hasOwnProperty("z")){I=C.z;var R=a(_.type,g,I);for(p=0;p<I.length;p++)for(u=0;u<I[p].length;u++)E=R(u,p),E+1&&f[E][1].push(I[p][u])}else for("x"===v?(L=C.p+1?C.p:C.x,I=C.s||C.v||C.y):"y"===v&&(L=C.p+1?C.p:C.y,I=C.s||C.v||C.x),Array.isArray(I)||(I=[I]),p=0;p<I.length;p++)f[L][1].push(I[p])}}}g._categoriesValue=f;var M=[];for(d=0;d<f.length;d++)M.push([f[d][0],n[m](f[d][1])]);M.sort(function(e,t){return e[1]-t[1]}),g._categoriesAggregatedValue=M,g._initialCategories=M.map(function(e){return e[0]}),"descending"===y&&g._initialCategories.reverse(),r=r.concat(g.sortByInitialCategories())}}}return r}function m(e,t){for(var a=0,r;a<e.length;a++)r=e[a],r.clearCalc(),"multicategory"===r.type&&r.setupMultiCategory(t)}function y(e){var t=e._fullLayout,a=t._visibleModules,r={},o,n,l;for(n=0;n<a.length;n++){var s=a[n],d=s.crossTraceCalc;if(d){var c=s.basePlotModule.name;r[c]?w.pushUnique(r[c],d):r[c]=[d]}}for(l in r){var p=r[l],u=t._subplots[l];if(Array.isArray(u))for(o=0;o<u.length;o++){var g=u[o],h="cartesian"===l?t._plots[g]:t[g];for(n=0;n<p.length;n++)p[n](e,h,g)}else for(n=0;n<p.length;n++)p[n](e)}}var f=e("d3"),x=e("fast-isnumeric"),b=e("../registry"),v=e("../plot_api/plot_schema"),k=e("../plot_api/plot_template"),w=e("../lib"),T=e("../components/color"),A=e("../constants/numerical").BADNUM,S=e("./cartesian/axis_ids"),C=e("./animation_attributes"),L=e("./frame_attributes"),E=w.relinkPrivateKeys,I=w._,_=t.exports={};w.extendFlat(_,b),_.attributes=e("./attributes"),_.attributes.type.values=_.allTypes,_.fontAttrs=e("./font_attributes"),_.layoutAttributes=e("./layout_attributes"),_.fontWeight="normal";var z=_.transformsRegistry,P=e("./command");_.executeAPICommand=P.executeAPICommand,_.computeAPICommandBindings=P.computeAPICommandBindings,_.manageCommandObserver=P.manageCommandObserver,_.hasSimpleAPICommandBindings=P.hasSimpleAPICommandBindings,_.redrawText=function(e){e=w.getGraphDiv(e);var t=e._fullLayout||{},a=t._has&&t._has("polar"),r=!a&&e.data&&e.data[0]&&e.data[0].r;return r?void 0:new Promise(function(t){setTimeout(function(){b.getComponentMethod("annotations","draw")(e),b.getComponentMethod("legend","draw")(e),b.getComponentMethod("colorbar","draw")(e),t(_.previousPromises(e))},300)})},_.resize=function(e){return e=w.getGraphDiv(e),new Promise(function(t,a){(!e||w.isHidden(e))&&a(new Error("Resize must be passed a displayed plot div element.")),e._redrawTimer&&clearTimeout(e._redrawTimer),e._redrawTimer=setTimeout(function(){if(!e.layout||e.layout.width&&e.layout.height||w.isHidden(e))return void t(e);delete e.layout.width,delete e.layout.height;var a=e.changed;e.autoplay=!0,b.call("relayout",e,{autosize:!0}).then(function(){e.changed=a,t(e)})},100)})},_.previousPromises=function(e){if((e._promises||[]).length)return Promise.all(e._promises).then(function(){e._promises=[]})},_.addLinks=function(e){if(e._context.showLink||e._context.showSources){var t=e._fullLayout,r=w.ensureSingle(t._paper,"text","js-plot-link-container",function(e){e.style({"font-family":"\"Open Sans\", Arial, sans-serif","font-size":"12px",fill:T.defaultLine,"pointer-events":"all"}).each(function(){var e=f.select(this);e.append("tspan").classed("js-link-to-tool",!0),e.append("tspan").classed("js-link-spacer",!0),e.append("tspan").classed("js-sourcelinks",!0)})}),o=r.node(),i={y:t._paper.attr("height")-9};document.body.contains(o)&&o.getComputedTextLength()>=t.width-20?(i["text-anchor"]="start",i.x=5):(i["text-anchor"]="end",i.x=t._paper.attr("width")-7),r.attr(i);var n=r.select(".js-link-to-tool"),l=r.select(".js-link-spacer"),s=r.select(".js-sourcelinks");e._context.showSources&&e._context.showSources(e),e._context.showLink&&a(e,n),l.text(n.text()&&s.text()?" - ":"")}},_.sendDataToCloud=function(e){e.emit("plotly_beforeexport");var t=(window.PLOTLYENV||{}).BASE_URL||e._context.plotlyServerURL,a=f.select(e).append("div").attr("id","hiddenform").style("display","none"),r=a.append("form").attr({action:t+"/external",method:"post",target:"_blank"}),o=r.append("input").attr({type:"text",name:"data"});return o.node().value=_.graphJson(e,!1,"keepdata"),r.node().submit(),a.remove(),e.emit("plotly_afterexport"),!1};var O=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],R=["year","month","dayMonth","dayMonthYear"];_.supplyDefaults=function(e,t){var a=t&&t.skipUpdateCalc,d=e._fullLayout||{};if(d._skipDefaults)return void delete d._skipDefaults;var c=e._fullLayout={},p=e.layout||{},g=e._fullData||[],h=e._fullData=[],m=e.data||[],y=e.calcdata||[],f=e._context||{},x;e._transitionData||_.createTransitionData(e),c._dfltTitle={plot:I(e,"Click to enter Plot title"),x:I(e,"Click to enter X axis title"),y:I(e,"Click to enter Y axis title"),colorbar:I(e,"Click to enter Colorscale title"),annotation:I(e,"new text")},c._traceWord=I(e,"trace");var v=n(e,O);if(c._mapboxAccessToken=f.mapboxAccessToken,d._initialAutoSizeIsDone){var T=d.width,A=d.height;_.supplyLayoutGlobalDefaults(p,c,v),p.width||(c.width=T),p.height||(c.height=A),_.sanitizeMargins(c)}else{_.supplyLayoutGlobalDefaults(p,c,v);var S=!p.width||!p.height,C=c.autosize,L=f.autosizable;S&&(C||L)?_.plotAutoSize(e,p,c):S&&_.sanitizeMargins(c),!C&&S&&(p.width=c.width,p.height=c.height)}c._d3locale=l(v,c.separators),c._extraFormat=n(e,R),c._initialAutoSizeIsDone=!0,c._dataLength=m.length,c._modules=[],c._visibleModules=[],c._basePlotModules=[];var z=c._subplots=o(),P=c._splomAxes={x:{},y:{}},D=c._splomSubplots={};c._splomGridDflt={},c._scatterStackOpts={},c._firstScatter={},c._alignmentOpts={},c._colorAxes={},c._requestRangeslider={},c._traceUids=r(g,m),c._globalTransforms=(e._context||{}).globalTransforms,_.supplyDataDefaults(m,h,p,c);var M=Object.keys(P.x),j=Object.keys(P.y);if(1<M.length&&1<j.length){for(b.getComponentMethod("grid","sizeDefaults")(p,c),x=0;x<M.length;x++)w.pushUnique(z.xaxis,M[x]);for(x=0;x<j.length;x++)w.pushUnique(z.yaxis,j[x]);for(var F in D)w.pushUnique(z.cartesian,F)}if(c._has=_._hasPlotType.bind(c),g.length===h.length)for(x=0;x<h.length;x++)E(h[x],g[x]);_.supplyLayoutModuleDefaults(p,c,h,e._transitionData);var k=c._visibleModules,B=[];for(x=0;x<k.length;x++){var N=k[x].crossTraceDefaults;N&&w.pushUnique(B,N)}for(x=0;x<B.length;x++)B[x](h,c);c._hasOnlyLargeSploms=1===c._basePlotModules.length&&"splom"===c._basePlotModules[0].name&&15<M.length&&15<j.length&&0===c.shapes.length&&0===c.images.length,c._hasCartesian=c._has("cartesian"),c._hasGeo=c._has("geo"),c._hasGL3D=c._has("gl3d"),c._hasGL2D=c._has("gl2d"),c._hasTernary=c._has("ternary"),c._hasPie=c._has("pie"),_.linkSubplots(h,c,g,d),_.cleanPlot(h,c,g,d),d._zoomlayer&&!e._dragging&&d._zoomlayer.selectAll(".select-outline").remove(),s(h,c),E(c,d),b.getComponentMethod("colorscale","crossTraceDefaults")(h,c),c._preGUI||(c._preGUI={}),c._tracePreGUI||(c._tracePreGUI={});var V=c._tracePreGUI,U={},H;for(H in V)U[H]="old";for(x=0;x<h.length;x++)H=h[x]._fullInput.uid,U[H]||(V[H]={}),U[H]="new";for(H in U)"old"===U[H]&&delete V[H];u(c),b.getComponentMethod("rangeslider","makeData")(c),a||y.length!==h.length||_.supplyDefaultsUpdateCalc(y,h)},_.supplyDefaultsUpdateCalc=function(e,t){for(var a=0;a<t.length;a++){var r=t[a],o=(e[a]||[])[0];if(o&&o.trace){var n=o.trace;if(n._hasCalcTransform){var l=n._arrayAttrs,s,d,c;for(s=0;s<l.length;s++)d=l[s],c=w.nestedProperty(n,d).get().slice(),w.nestedProperty(r,d).set(c)}o.trace=r}}},_.createTransitionData=function(e){e._transitionData||(e._transitionData={}),e._transitionData._frames||(e._transitionData._frames=[]),e._transitionData._frameHash||(e._transitionData._frameHash={}),e._transitionData._counter||(e._transitionData._counter=0),e._transitionData._interruptCallbacks||(e._transitionData._interruptCallbacks=[])},_._hasPlotType=function(e){var t=this._basePlotModules||[],a;for(a=0;a<t.length;a++)if(t[a].name===e)return!0;var r=this._modules||[];for(a=0;a<r.length;a++){var o=r[a].name;if(o===e)return!0;var n=b.modules[o];if(n&&n.categories[e])return!0}return!1},_.cleanPlot=function(e,t,a,r){var o=r._basePlotModules||[],n,l;for(n=0;n<o.length;n++){var s=o[n];s.clean&&s.clean(e,t,a,r)}var d=r._has&&r._has("gl"),c=t._has&&t._has("gl");d&&!c&&r._glcontainer!==void 0&&(r._glcontainer.selectAll(".gl-canvas").remove(),r._glcontainer.selectAll(".no-webgl").remove(),r._glcanvas=null);var p=!!r._infolayer;oldLoop:for(n=0;n<a.length;n++){var u=a[n],g=u.uid;for(l=0;l<e.length;l++){var h=e[l];if(g===h.uid)continue oldLoop}p&&r._infolayer.select(".cb"+g).remove()}},_.linkSubplots=function(e,t,a,r){var o=r._plots||{},n=t._plots={},l=t._subplots,s={_fullData:e,_fullLayout:t},c=l.cartesian.concat(l.gl2d||[]),p,u;for(p=0;p<c.length;p++){var g=c[p],h=o[g],m=S.getFromId(s,g,"x"),y=S.getFromId(s,g,"y"),f;for(h?f=n[g]=h:(f=n[g]={},f.id=g),m._counterAxes.push(y._id),y._counterAxes.push(m._id),m._subplotsWith.push(g),y._subplotsWith.push(g),f.xaxis=m,f.yaxis=y,f._hasClipOnAxisFalse=!1,u=0;u<e.length;u++){var x=e[u];if(x.xaxis===f.xaxis._id&&x.yaxis===f.yaxis._id&&!1===x.cliponaxis){f._hasClipOnAxisFalse=!0;break}}}var _=S.list(s,null,!0),b;for(p=0;p<_.length;p++){b=_[p];var v=null;b.overlaying&&(v=S.getFromId(s,b.overlaying),v&&v.overlaying&&(b.overlaying=!1,v=null)),b._mainAxis=v||b,v&&(b.domain=v.domain.slice()),b._anchorAxis="free"===b.anchor?null:S.getFromId(s,b.anchor)}for(p=0;p<_.length;p++)b=_[p],b._counterAxes.sort(S.idSort),b._subplotsWith.sort(w.subplotSort),b._mainSubplot=d(b,t)},_.clearExpandedTraceDefaultColors=function(e){function t(e,t,o,i){r[i]=t,r.length=i+1,"color"===e.valType&&e.dflt===void 0&&a.push(r.join("."))}var a,r,o;for(r=[],a=e._module._colorAttrs,a||(e._module._colorAttrs=a=[],v.crawl(e._module.attributes,t)),o=0;o<a.length;o++){var n=w.nestedProperty(e,"_input."+a[o]);n.get()||w.nestedProperty(e,a[o]).set(null)}},_.supplyDataDefaults=function(e,t,a,r){function o(e){t.push(e);var a=e._module;a&&(w.pushUnique(n,a),!0===e.visible&&w.pushUnique(l,a),w.pushUnique(s,e._module.basePlotModule),d++,!1!==e._input.visible&&c++)}var n=r._modules,l=r._visibleModules,s=r._basePlotModules,d=0,c=0,u,g,h;r._transformModules=[];var m={},y=[],f=(a.template||{}).data||{},x=k.traceTemplater(f);for(u=0;u<e.length;u++){if(h=e[u],g=x.newTrace(h),g.uid=r._traceUids[u],_.supplyTraceDefaults(h,g,c,r,u),g.index=u,g._input=h,g._expandedIndex=d,g.transforms&&g.transforms.length)for(var v=!1!==h.visible&&!1===g.visible,T=p(g,t,a,r),A=0;A<T.length;A++){var S=T[A],C={_template:g._template,type:g.type,uid:g.uid+A};v&&!1===S.visible&&delete S.visible,_.supplyTraceDefaults(S,C,d,r,u),E(C,S),C.index=u,C._input=h,C._fullInput=g,C._expandedIndex=d,C._expandedInput=S,o(C)}else g._fullInput=g,g._expandedInput=g,o(g);b.traceIs(g,"carpetAxis")&&(m[g.carpet]=g),b.traceIs(g,"carpetDependent")&&y.push(u)}for(u=0;u<y.length;u++)if(g=t[y[u]],g.visible){var L=m[g.carpet];if(g._carpet=L,!L||!L.visible){g.visible=!1;continue}g.xaxis=L.xaxis,g.yaxis=L.yaxis}},_.supplyAnimationDefaults=function(e){function t(t,r){return w.coerce(e||{},a,C,t,r)}e=e||{};var a={},r;if(t("mode"),t("direction"),t("fromcurrent"),Array.isArray(e.frame))for(a.frame=[],r=0;r<e.frame.length;r++)a.frame[r]=_.supplyAnimationFrameDefaults(e.frame[r]||{});else a.frame=_.supplyAnimationFrameDefaults(e.frame||{});if(Array.isArray(e.transition))for(a.transition=[],r=0;r<e.transition.length;r++)a.transition[r]=_.supplyAnimationTransitionDefaults(e.transition[r]||{});else a.transition=_.supplyAnimationTransitionDefaults(e.transition||{});return a},_.supplyAnimationFrameDefaults=function(e){function t(t,r){return w.coerce(e||{},a,C.frame,t,r)}var a={};return t("duration"),t("redraw"),a},_.supplyAnimationTransitionDefaults=function(e){function t(t,r){return w.coerce(e||{},a,C.transition,t,r)}var a={};return t("duration"),t("easing"),a},_.supplyFrameDefaults=function(e){function t(t,r){return w.coerce(e,a,L,t,r)}var a={};return t("group"),t("name"),t("traces"),t("baseframe"),t("data"),t("layout"),a},_.supplyTraceDefaults=function(e,t,a,r,o){function n(a,r){return w.coerce(e,t,_.attributes,a,r)}var l=r.colorway||T.defaults,s=l[a%l.length],d=n("visible"),c;n("type"),n("name",r._traceWord+" "+o),n("uirevision",r.uirevision);var p=_.getModule(t);if(t._module=p,p){var u=p.basePlotModule,g=u.attr,h=u.attributes;if(g&&h){var m=r._subplots,y="";if("gl2d"!==u.name||d){if(Array.isArray(g))for(c=0;c<g.length;c++){var f=g[c],x=w.coerce(e,t,h,f);m[f]&&w.pushUnique(m[f],x),y+=x}else y=w.coerce(e,t,h,g);m[u.name]&&w.pushUnique(m[u.name],y)}}}return d&&(n("customdata"),n("ids"),n("meta"),b.traceIs(t,"showLegend")?(t._dfltShowLegend=!0,n("showlegend"),n("legendgroup")):t._dfltShowLegend=!1,p&&p.supplyDefaults(e,t,s,r),!b.traceIs(t,"noOpacity")&&n("opacity"),b.traceIs(t,"notLegendIsolatable")&&(t.visible=!!t.visible),!b.traceIs(t,"noHover")&&(!t.hovertemplate&&w.coerceHoverinfo(e,t,r),"parcats"!==t.type&&b.getComponentMethod("fx","supplyDefaults")(e,t,s,r)),p&&p.selectPoints&&n("selectedpoints"),_.supplyTransformDefaults(e,t,r)),t},_.hasMakesDataTransform=c,_.supplyTransformDefaults=function(e,t,a){if(t._length||c(e)){var r=a._globalTransforms||[],o=a._transformModules||[];if(Array.isArray(e.transforms)||0!==r.length)for(var n=e.transforms||[],l=r.concat(n),s=t.transforms=[],d=0;d<l.length;d++){var p=l[d],u=p.type,g=z[u],h=!(p._module&&p._module===g),m=g&&"function"==typeof g.transform,y;g||w.warn("Unrecognized transform type "+u+"."),g&&g.supplyDefaults&&(h||m)?(y=g.supplyDefaults(p,t,a,e),y.type=u,y._module=g,w.pushUnique(o,g)):y=w.extendFlat({},p),s.push(y)}}},_.supplyLayoutGlobalDefaults=function(e,t,a){function r(a,r){return w.coerce(e,t,_.layoutAttributes,a,r)}var o=e.template;w.isPlainObject(o)&&(t.template=o,t._template=o.layout,t._dataTemplate=o.data);var i=w.coerceFont(r,"font");r("title.text",t._dfltTitle.plot),w.coerceFont(r,"title.font",{family:i.family,size:V(1.4*i.size),color:i.color}),r("title.xref"),r("title.yref"),r("title.x"),r("title.y"),r("title.xanchor"),r("title.yanchor"),r("title.pad.t"),r("title.pad.r"),r("title.pad.b"),r("title.pad.l"),r("autosize",!(e.width&&e.height)),r("width"),r("height"),r("margin.l"),r("margin.r"),r("margin.t"),r("margin.b"),r("margin.pad"),r("margin.autoexpand"),e.width&&e.height&&_.sanitizeMargins(t),b.getComponentMethod("grid","sizeDefaults")(e,t),r("paper_bgcolor"),r("separators",a.decimal+a.thousands),r("hidesources"),r("colorway"),r("datarevision");var n=r("uirevision");r("editrevision",n),r("selectionrevision",n),r("modebar.orientation"),r("modebar.bgcolor",T.addOpacity(t.paper_bgcolor,.5));var l=T.contrast(T.rgb(t.modebar.bgcolor));r("modebar.color",T.addOpacity(l,.3)),r("modebar.activecolor",T.addOpacity(l,.7)),r("modebar.uirevision",n),r("meta"),w.isPlainObject(e.transition)&&(r("transition.duration"),r("transition.easing"),r("transition.ordering")),b.getComponentMethod("calendars","handleDefaults")(e,t,"calendar"),b.getComponentMethod("fx","supplyLayoutGlobalDefaults")(e,t,r)},_.plotAutoSize=function(e,t,a){var r=e._context||{},o=r.frameMargins,i=w.isPlotDiv(e),n,l;if(i&&e.emit("plotly_autosize"),r.fillFrame)n=window.innerWidth,l=window.innerHeight,document.body.style.overflow="hidden";else{var s=i?window.getComputedStyle(e):{};if(n=parseFloat(s.width)||parseFloat(s.maxWidth)||a.width,l=parseFloat(s.height)||parseFloat(s.maxHeight)||a.height,x(o)&&0<o){var d=1-2*o;n=V(d*n),l=V(d*l)}}var c=_.layoutAttributes.width.min,p=_.layoutAttributes.height.min;n<c&&(n=c),l<p&&(l=p);var u=!t.width&&1<_a(a.width-n),g=!t.height&&1<_a(a.height-l);(g||u)&&(u&&(a.width=n),g&&(a.height=l)),e._initialAutoSize||(e._initialAutoSize={width:n,height:l}),_.sanitizeMargins(a)},_.supplyLayoutModuleDefaults=function(e,t,a,r){var o=b.componentsRegistry,n=t._basePlotModules,l=b.subplotsRegistry.cartesian,s,d,c;for(s in o)c=o[s],c.includeBasePlot&&c.includeBasePlot(e,t);for(var p in n.length||n.push(l),t._has("cartesian")&&(b.getComponentMethod("grid","contentDefaults")(e,t),l.finalizeSubplots(e,t)),t._subplots)t._subplots[p].sort(w.subplotSort);for(d=0;d<n.length;d++)c=n[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a);var u=t._modules;for(d=0;d<u.length;d++)c=u[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a);var g=t._transformModules;for(d=0;d<g.length;d++)c=g[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a,r);for(s in o)c=o[s],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a)},_.purge=function(e){var t=e._fullLayout||{};t._glcontainer!==void 0&&(t._glcontainer.selectAll(".gl-canvas").remove(),t._glcontainer.remove(),t._glcanvas=null),t._geocontainer!==void 0&&t._geocontainer.remove(),t._modeBar&&t._modeBar.destroy(),e._transitionData&&(e._transitionData._interruptCallbacks&&(e._transitionData._interruptCallbacks.length=0),e._transitionData._animationRaf&&window.cancelAnimationFrame(e._transitionData._animationRaf)),w.clearThrottle(),w.clearResponsive(e),delete e.data,delete e.layout,delete e._fullData,delete e._fullLayout,delete e.calcdata,delete e.framework,delete e.empty,delete e.fid,delete e.undoqueue,delete e.undonum,delete e.autoplay,delete e.changed,delete e._promises,delete e._redrawTimer,delete e._hmlumcount,delete e._hmpixcount,delete e._transitionData,delete e._transitioning,delete e._initialAutoSize,delete e._transitioningWithDuration,delete e._dragging,delete e._dragged,delete e._dragdata,delete e._hoverdata,delete e._snapshotInProgress,delete e._editing,delete e._mouseDownTime,delete e._legendMouseDownTime,e.removeAllListeners&&e.removeAllListeners()},_.style=function(e){var t=e._fullLayout._visibleModules,a=[],r;for(r=0;r<t.length;r++){var o=t[r];o.style&&w.pushUnique(a,o.style)}for(r=0;r<a.length;r++)a[r](e)},_.sanitizeMargins=function(e){if(e&&e.margin){var t=e.width,a=e.height,r=e.margin,o=t-(r.l+r.r),i=a-(r.t+r.b),n;0>o&&(n=(t-1)/(r.l+r.r),r.l=ba(n*r.l),r.r=ba(n*r.r)),0>i&&(n=(a-1)/(r.t+r.b),r.t=ba(n*r.t),r.b=ba(n*r.b))}},_.clearAutoMarginIds=function(e){e._fullLayout._pushmarginIds={}},_.allowAutoMargin=function(e,t){e._fullLayout._pushmarginIds[t]=1},_.autoMargin=function(e,t,a){var r=e._fullLayout,o=r._pushmargin,i=r._pushmarginIds;if(!1!==r.margin.autoexpand){if(!a)delete o[t],delete i[t];else{var n=a.pad;if(n===void 0){var l=r.margin;n=ea(12,l.l,l.r,l.t,l.b)}a.l+a.r>.5*r.width&&(a.l=a.r=0),a.b+a.t>.5*r.height&&(a.b=a.t=0);var s=a.xl===void 0?a.x:a.xl,d=a.xr===void 0?a.x:a.xr,c=a.yt===void 0?a.y:a.yt,p=a.yb===void 0?a.y:a.yb;o[t]={l:{val:s,size:a.l+n},r:{val:d,size:a.r+n},b:{val:p,size:a.b+n},t:{val:c,size:a.t+n}},i[t]=1}r._replotting||_.doAutoMargin(e)}},_.doAutoMargin=function(e){var t=e._fullLayout;t._size||(t._size={}),u(t);var a=t._size,r=t.margin,o=w.extendFlat({},a),i=r.l,n=r.r,l=r.t,s=r.b,d=t.width,c=t.height,p=t._pushmargin,g=t._pushmarginIds;if(!1!==t.margin.autoexpand){for(var h in p)g[h]||delete p[h];for(var m in p.base={l:{val:0,size:i},r:{val:1,size:n},t:{val:1,size:l},b:{val:0,size:s}},p){var y=p[m].l||{},f=p[m].b||{},v=y.val,k=y.size,T=f.val,A=f.size;for(var S in p){if(x(k)&&p[S].r){var C=p[S].r.val,L=p[S].r.size;if(C>v){var E=(k*C+(L-d)*v)/(C-v),I=(L*(1-v)+(k-d)*(1-C))/(C-v);0<=E&&0<=I&&0<d-(E+I)&&E+I>i+n&&(i=E,n=I)}}if(x(A)&&p[S].t){var z=p[S].t.val,P=p[S].t.size;if(z>T){var D=(A*z+(P-c)*T)/(z-T),O=(P*(1-T)+(A-c)*(1-z))/(z-T);0<=D&&0<=O&&0<c-(O+D)&&D+O>s+l&&(s=D,l=O)}}}}}return(a.l=V(i),a.r=V(n),a.t=V(l),a.b=V(s),a.p=V(r.pad),a.w=V(d)-a.l-a.r,a.h=V(c)-a.t-a.b,!t._replotting&&_.didMarginChange(o,a))?("_redrawFromAutoMarginCount"in t?t._redrawFromAutoMarginCount++:t._redrawFromAutoMarginCount=1,b.call("plot",e)):void 0};var M=["l","r","t","b","p","w","h"];_.didMarginChange=function(e,t){for(var a=0;a<M.length;a++){var r=M[a],o=e[r],n=t[r];if(!x(o)||1<_a(n-o))return!0}return!1},_.graphJson=function(e,t,a,r,o){function i(e){if("function"==typeof e)return null;if(w.isPlainObject(e)){var t={},r,o;for(r in e)if("function"!=typeof e[r]&&-1===["_","["].indexOf(r.charAt(0))){if("keepdata"===a){if("src"===r.substr(r.length-3))continue;}else if("keepstream"===a){if(o=e[r+"src"],"string"==typeof o&&0<o.indexOf(":")&&!w.isPlainObject(e.stream))continue;}else if("keepall"!==a&&(o=e[r+"src"],"string"==typeof o&&0<o.indexOf(":")))continue;t[r]=i(e[r])}return t}return Array.isArray(e)?e.map(i):w.isTypedArray(e)?w.simpleMap(e,w.identity):w.isJSDate(e)?w.ms2DateTimeLocal(+e):e}(o&&t&&!e._fullData||o&&!t&&!e._fullLayout)&&_.supplyDefaults(e);var n=o?e._fullData:e.data,l=o?e._fullLayout:e.layout,s=(e._transitionData||{})._frames,d={data:(n||[]).map(function(e){var a=i(e);return t&&delete a.fit,a})};return t||(d.layout=i(l)),e.framework&&e.framework.isPolar&&(d=e.framework.getConfig()),s&&(d.frames=i(s)),"object"===r?d:JSON.stringify(d)},_.modifyFrames=function(e,t){var a=e._transitionData._frames,r=e._transitionData._frameHash,o,n,l;for(o=0;o<t.length;o++)switch(n=t[o],n.type){case"replace":l=n.value;var s=(a[n.index]||{}).name,d=l.name;a[n.index]=r[d]=l,d!==s&&(delete r[s],r[d]=l);break;case"insert":l=n.value,r[l.name]=l,a.splice(n.index,0,l);break;case"delete":l=a[n.index],delete r[l.name],a.splice(n.index,1);}return Promise.resolve()},_.computeFrame=function(e,t){var a=e._transitionData._frameHash,r,o,n,l;if(!t)throw new Error("computeFrame must be given a string frame name");var s=a[t.toString()];if(!s)return!1;for(var d=[s],c=[s.name];s.baseframe&&(s=a[s.baseframe.toString()])&&!(-1!==c.indexOf(s.name));)d.push(s),c.push(s.name);for(var p={};s=d.pop();)if(s.layout&&(p.layout=_.extendLayout(p.layout,s.layout)),s.data){if(p.data||(p.data=[]),o=s.traces,!o)for(o=[],r=0;r<s.data.length;r++)o[r]=r;for(p.traces||(p.traces=[]),r=0;r<s.data.length;r++)(n=o[r],void 0!==n&&null!==n)&&(l=p.traces.indexOf(n),-1===l&&(l=p.data.length,p.traces[l]=n),p.data[l]=_.extendTrace(p.data[l],s.data[r]))}return p},_.recomputeFrameHash=function(e){for(var t=e._transitionData._frameHash={},a=e._transitionData._frames,r=0,o;r<a.length;r++)o=a[r],o&&o.name&&(t[o.name]=o)},_.extendObjectWithContainers=function(e,t,a){var r=w.extendDeepNoArrays({},t||{}),o=w.expandObjectPaths(r),n={},l,s,d,c,p,u,g,h;if(a&&a.length)for(d=0;d<a.length;d++)l=w.nestedProperty(o,a[d]),s=l.get(),void 0===s?w.nestedProperty(n,a[d]).set(null):(l.set(null),w.nestedProperty(n,a[d]).set(s));if(e=w.extendDeepNoArrays(e||{},o),a&&a.length)for(d=0;d<a.length;d++)if(p=w.nestedProperty(n,a[d]),g=p.get(),g){for(u=w.nestedProperty(e,a[d]),h=u.get(),Array.isArray(h)||(h=[],u.set(h)),c=0;c<g.length;c++){var m=g[c];h[c]=null===m?null:_.extendObjectWithContainers(h[c],m)}u.set(h)}return e},_.dataArrayContainers=["transforms","dimensions"],_.layoutArrayContainers=b.layoutArrayContainers,_.extendTrace=function(e,t){return _.extendObjectWithContainers(e,t,_.dataArrayContainers)},_.extendLayout=function(e,t){return _.extendObjectWithContainers(e,t,_.layoutArrayContainers)},_.transition=function(e,t,a,r,o,l){var s={redraw:o.redraw},d={},c=[];return s.prepareFn=function(){for(var o=Array.isArray(t)?t.length:0,l=r.slice(0,o),s=0;s<l.length;s++){var p=l[s],u=e._fullData[p],g=u._module;if(g){if(g.animatable){var h=g.basePlotModule.name;d[h]||(d[h]=[]),d[h].push(p)}e.data[l[s]]=_.extendTrace(e.data[l[s]],t[s])}}var n=w.expandObjectPaths(w.extendDeepNoArrays({},a)),m=/^[xy]axis[0-9]*$/;for(var y in n)m.test(y)&&delete n[y].range;_.extendLayout(e.layout,n),delete e.calcdata,_.supplyDefaults(e),_.doCalcdata(e);var f=w.expandObjectPaths(a);if(f){var x=e._fullLayout._plots;for(var b in x){var v=x[b],k=v.xaxis,T=v.yaxis,A=k.range.slice(),S=T.range.slice(),C;Array.isArray(f[k._name+".range"])?C=f[k._name+".range"].slice():Array.isArray((f[k._name]||{}).range)&&(C=f[k._name].range.slice());var L;Array.isArray(f[T._name+".range"])?L=f[T._name+".range"].slice():Array.isArray((f[T._name]||{}).range)&&(L=f[T._name].range.slice());var E;A&&C&&(A[0]!==C[0]||A[1]!==C[1])&&(E={xr0:A,xr1:C});var I;S&&L&&(S[0]!==L[0]||S[1]!==L[1])&&(I={yr0:S,yr1:L}),(E||I)&&c.push(w.extendFlat({plotinfo:v},E,I))}}return Promise.resolve()},s.runFn=function(t){var r=e._fullLayout._basePlotModules,o=c.length,s,p;if(a)for(p=0;p<r.length;p++)r[p].transitionAxes&&r[p].transitionAxes(e,c,l,t);for(var u in o?(s=w.extendFlat({},l),s.duration=0,delete d.cartesian):s=l,d){var n=d[u],g=e._fullData[n[0]]._module;g.basePlotModule.plot(e,n,s,t)}},g(e,l,s)},_.transitionFromReact=function(e,t,a,r){var o=e._fullLayout,n=o.transition,l={},s=[];return l.prepareFn=function(){var e=o._plots;for(var i in l.redraw=!1,"some"===t.anim&&(l.redraw=!0),"some"===a.anim&&(l.redraw=!0),e){var n=e[i],d=n.xaxis,c=n.yaxis,p=r[d._name].range.slice(),u=r[c._name].range.slice(),g=d.range.slice(),h=c.range.slice();d.setScale(),c.setScale();var m;(p[0]!==g[0]||p[1]!==g[1])&&(m={xr0:p,xr1:g});var y;(u[0]!==h[0]||u[1]!==h[1])&&(y={yr0:u,yr1:h}),(m||y)&&s.push(w.extendFlat({plotinfo:n},m,y))}return Promise.resolve()},l.runFn=function(a){function r(){for(var t=0;t<c.length;t++)c[t].transitionAxes&&c[t].transitionAxes(e,s,g,a)}function o(){for(var t=0;t<c.length;t++)c[t].plot(e,m,h,a)}for(var l=e._fullData,d=e._fullLayout,c=d._basePlotModules,p=[],u=0,g,h,m;u<l.length;u++)p.push(u);s.length&&t.anim?"traces first"===n.ordering?(g=w.extendFlat({},n,{duration:0}),m=p,h=n,o(),setTimeout(r,n.duration)):(g=n,m=null,h=w.extendFlat({},n,{duration:0}),r(),o()):s.length?(g=n,r()):t.anim&&(m=p,h=n,o())},g(e,n,l)},_.doCalcdata=function(e,t){function a(t){if(c=n[t],p=c._module,!0===c.visible&&c.transforms){if(p&&p.calc){var a=p.calc(e,c);a[0]&&a[0].t&&a[0].t._scene&&delete a[0].t._scene.dirty}for(g=0;g<c.transforms.length;g++){var r=c.transforms[g];p=z[r.type],p&&p.calcTransform&&(c._hasCalcTransform=!0,x=!0,p.calcTransform(e,c,r))}}}function r(t,a){if(c=n[t],p=c._module,!!p.isContainer===a){var r=[];if(!0===c.visible&&0!==c._length){delete c._indexToPoints;var o=c.transforms||[];for(g=o.length-1;0<=g;g--)if(o[g].enabled){c._indexToPoints=o[g]._indexToPoints;break}p&&p.calc&&(r=p.calc(e,c))}Array.isArray(r)&&r[0]||(r=[{x:A,y:A}]),r[0].t||(r[0].t={}),r[0].trace=c,s[t]=r}}var o=S.list(e),n=e._fullData,l=e._fullLayout,s=Array(n.length),d=(e.calcdata||[]).slice(),c,p,u,g;for(e.calcdata=s,l._numBoxes=0,l._numViolins=0,l._violinScaleGroupStats={},e._hmpixcount=0,e._hmlumcount=0,l._piecolormap={},l._sunburstcolormap={},l._funnelareacolormap={},u=0;u<n.length;u++)if(Array.isArray(t)&&-1===t.indexOf(u)){s[u]=d[u];continue}for(u=0;u<n.length;u++)c=n[u],c._arrayAttrs=v.findArrayAttributes(c),c._extremes={};var f=l._subplots.polar||[];for(u=0;u<f.length;u++)o.push(l[f[u]].radialaxis,l[f[u]].angularaxis);var x=!1;for(m(o,n),u=0;u<n.length;u++)r(u,!0);for(u=0;u<n.length;u++)a(u);for(x&&m(o,n),u=0;u<n.length;u++)r(u,!0);for(u=0;u<n.length;u++)r(u,!1);y(e);var _=h(o,e);if(_.length){for(l._numBoxes=0,l._numViolins=0,u=0;u<_.length;u++)r(_[u],!0);for(u=0;u<_.length;u++)r(_[u],!1);y(e)}b.getComponentMethod("fx","calc")(e),b.getComponentMethod("errorbars","calc")(e)};var F=/(total|sum|min|max|mean|median) (ascending|descending)/;_.rehover=function(e){e._fullLayout._rehover&&e._fullLayout._rehover()},_.redrag=function(e){e._fullLayout._redrag&&e._fullLayout._redrag()},_.generalUpdatePerTraceModule=function(e,t,a,r){var o=t.traceHash,n={},l;for(l=0;l<a.length;l++){var s=a[l],d=s[0].trace;d.visible&&(n[d.type]=n[d.type]||[],n[d.type].push(s))}for(var c in o)if(!n[c]){var p=o[c][0],u=p[0].trace;u.visible=!1,n[c]=[p]}for(var g in n){var h=n[g],m=h[0][0].trace._module;m.plot(e,t,w.filterVisible(h),r)}t.traceHash=n}},{"../components/color":593,"../constants/numerical":695,"../lib":719,"../plot_api/plot_schema":756,"../plot_api/plot_template":757,"../registry":847,"./animation_attributes":762,"./attributes":764,"./cartesian/axis_ids":770,"./command":791,"./font_attributes":793,"./frame_attributes":794,"./layout_attributes":819,d3:163,"fast-isnumeric":225}],829:[function(e,t){"use strict";t.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],830:[function(e,t){"use strict";function a(e,t,r,a){var o=a[0],i=a[1],n=l(De(t)-De(e)),s=l(R(t)-R(e)),d=fa(r),c=l(1/d),p=n/s,u=i-p*o,g,h;return c?n&&s?(g=u/(d-p),h=d*g):s?(g=i*c,h=i):(g=o,h=o*d):n&&s?(g=0,h=u):s?(g=0,h=i):g=h=NaN,[g,h]}function o(e,t){var a=t.length,r=Array(a+1),o;for(o=0;o<a;o++){var n=t[o];r[o]=[e*R(n),e*De(n)]}return r[o]=r[0].slice(),r}function i(e,t,r,o){function n(t){return[e*R(t),e*De(t)]}function l(e,t,r){return a(e,t,r,n(e))}function s(e){return d.mod(e,g)}function c(e){return u(e,[t,r])}var g=o.length,m=[],y=p(o,function(e){return c(e)?h(e,t):1/0}),f=l(o[y],o[s(y-1)],t),x,_;for(m.push(f),x=y,_=0;_<g;x++,_++){var b=o[s(x)];if(!c(b))break;m.push(n(b))}var v=p(o,function(e){return c(e)?h(e,r):1/0}),k=l(o[v],o[s(v+1)],r);return m.push(k),m.push([0,0]),m.push(m[0].slice()),m}function n(e,t,a,r){return d.isFullCircle([t,a])?o(e,r):i(e,t,a,r)}function l(e){return 1e-10<_a(e)?e:0}function s(e,t,a){t=t||0,a=a||0;for(var r=e.length,o=Array(r),n=0,l;n<r;n++)l=e[n],o[n]=[t+l[0],a-l[1]];return o}var d=e("../../lib"),c=e("../../lib/polygon").tester,p=d.findIndexOfMin,u=d.isAngleInsideSector,g=d.angleDelta,h=d.angleDist;t.exports={isPtInsidePolygon:function(e,t,a,r,o){if(!u(t,r))return!1;var i,l;a[0]<a[1]?(i=a[0],l=a[1]):(i=a[1],l=a[0]);var s=c(n(i,r[0],r[1],o)),d=c(n(l,r[0],r[1],o)),p=[e*R(t),e*De(t)];return d.contains(p)&&!s.contains(p)},findPolygonOffset:function(e,t,a,r){for(var o=1/0,l=1/0,s=n(e,t,a,r),d=0,c;d<s.length;d++)c=s[d],o=ea(o,c[0]),l=ea(l,-c[1]);return[o,l]},findEnclosingVertexAngles:function(e,t){var a=p(t,function(t){var a=g(t,e);return 0<a?a:1/0}),r=d.mod(a+1,t.length);return[t[a],t[r]]},findIntersectionXY:a,findXYatLength:function(e,r,o,i){var n=-r*o,t=r*r+1,a=2*(r*n-o),l=N(a*a-4*t*(n*n+o*o-e*e)),s=(-a+l)/(2*t),d=(-a-l)/(2*t);return[[s,r*s+n+i],[d,r*d+n+i]]},clampTiny:l,pathPolygon:function(e,t,a,r,o,i){var l=n(e,t,a,r);return"M"+s(l,o,i).join("L")},pathPolygonAnnulus:function(e,t,a,r,o,i,l){var d,c;e<t?(d=e,c=t):(d=t,c=e);var p=s(n(d,a,r,o),i,l),u=s(n(c,a,r,o),i,l);return"M"+u.reverse().join("L")+"M"+p.join("L")}}},{"../../lib":719,"../../lib/polygon":731}],831:[function(e,t){"use strict";var a=e("../get_data").getSubplotCalcData,r=e("../../lib").counterRegex,o=e("./polar"),i=e("./constants"),n=i.attr,l=i.name,s=r(l),d={};d[n]={valType:"subplotid",dflt:l,editType:"calc"},t.exports={attr:n,name:l,idRoot:l,idRegex:s,attrRegex:s,attributes:d,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:function(e){for(var t=e._fullLayout,r=e.calcdata,n=t._subplots[l],s=0;s<n.length;s++){var d=n[s],c=a(r,l,d),p=t[d]._subplot;p||(p=o(e,d),t[d]._subplot=p),p.plot(c,t,e._promises)}},clean:function(e,t,a,r){for(var o=r._subplots[l]||[],n=r._has&&r._has("gl"),s=t._has&&t._has("gl"),d=0;d<o.length;d++){var c=o[d],p=r[c]._subplot;if(!t[c]&&!!p)for(var u in p.framework.remove(),p.layers["radial-axis-title"].remove(),p.clipPaths)p.clipPaths[u].remove();n&&!s&&p._scene&&(p._scene.destroy(),p._scene=null)}},toSVG:e("../cartesian").toSVG}},{"../../lib":719,"../cartesian":778,"../get_data":802,"./constants":829,"./layout_attributes":832,"./layout_defaults":833,"./polar":840}],832:[function(e,t){"use strict";var a=e("../../components/color/attributes"),r=e("../cartesian/layout_attributes"),o=e("../domain").attributes,i=e("../../lib").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=n({color:r.color,showline:i({},r.showline,{dflt:!0}),linecolor:r.linecolor,linewidth:r.linewidth,showgrid:i({},r.showgrid,{dflt:!0}),gridcolor:r.gridcolor,gridwidth:r.gridwidth},"plot","from-root"),s=n({tickmode:r.tickmode,nticks:r.nticks,tick0:r.tick0,dtick:r.dtick,tickvals:r.tickvals,ticktext:r.ticktext,ticks:r.ticks,ticklen:r.ticklen,tickwidth:r.tickwidth,tickcolor:r.tickcolor,showticklabels:r.showticklabels,showtickprefix:r.showtickprefix,tickprefix:r.tickprefix,showticksuffix:r.showticksuffix,ticksuffix:r.ticksuffix,showexponent:r.showexponent,exponentformat:r.exponentformat,separatethousands:r.separatethousands,tickfont:r.tickfont,tickangle:r.tickangle,tickformat:r.tickformat,tickformatstops:r.tickformatstops,layer:r.layer},"plot","from-root"),d={visible:i({},r.visible,{dflt:!0}),type:i({},r.type,{values:["-","linear","log","date","category"]}),autorange:i({},r.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:i({},r.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:r.categoryorder,categoryarray:r.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:n(r.title,"plot","from-root"),hoverformat:r.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:r._deprecated.title,titlefont:r._deprecated.titlefont}};d.title.text.dflt="",i(d,l,s);var c={visible:i({},r.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},categoryorder:r.categoryorder,categoryarray:r.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:r.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};i(c,l,s),t.exports={domain:o({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:a.background},radialaxis:d,angularaxis:c,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":592,"../../lib":719,"../../plot_api/edit_types":750,"../cartesian/layout_attributes":779,"../domain":792}],833:[function(e,t){"use strict";function a(e,t,a,s){function m(e,t){return a(A+"."+e,t)}var b=a("bgcolor");s.bgColor=n.combine(b,s.paper_bgcolor);var v=a("sector");a("hole");for(var k=d(s.fullData,x.name,s.id),w=s.layoutOut,T=0,A;T<_.length;T++){A=_[T],o.isPlainObject(e[A])||(e[A]={});var S=e[A],C=l.newContainer(t,A);C._id=C._name=A,C._attr=s.id+"."+A,C._traceIndices=k.map(function(e){return e._expandedIndex});var L=x.axisName2dataArray[A],E=r(S,C,m,k,L);g(S,C,m,{axData:k,dataAttr:L});var I=m("visible");f(C,t,w),m("uirevision",t.uirevision);var z,P;switch(I&&(z=m("color"),P=z===S.color?z:s.font.color),C._m=1,A){case"radialaxis":var D=m("autorange",!C.isValidRange(S.range));S.autorange=D,D&&("linear"===E||"-"===E)&&m("rangemode"),"reversed"===D&&(C._m=-1),m("range"),C.cleanRange("range",{dfltRange:[0,1]}),I&&(m("side"),m("angle",v[0]),m("title.text"),o.coerceFont(m,"title.font",{family:s.font.family,size:V(1.2*s.font.size),color:P}));break;case"angularaxis":if("date"===E){o.log("Polar plots do not support date angular axes yet.");for(var O=0;O<k.length;O++)k[O].visible=!1;E=S.type=C.type="linear"}"linear"===E?m("thetaunit"):m("period");var R=m("direction");m("rotation",{counterclockwise:0,clockwise:90}[R]);}if(I){c(S,C,m,C.type),u(S,C,m,C.type,{tickSuffixDflt:"degrees"===C.thetaunit?"\xB0":void 0}),p(S,C,m,{outerTicks:!0});var M=m("showticklabels");M&&(o.coerceFont(m,"tickfont",{family:s.font.family,size:s.font.size,color:P}),m("tickangle"),m("tickformat")),h(S,C,m,{dfltColor:z,bgColor:s.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y[A]}),m("layer")}"category"!==E&&m("hoverformat"),C._input=S}"category"===t.angularaxis.type&&a("gridshape")}function r(e,t,a,r,o){var n=a("type");if("-"===n){for(var l=0,s;l<r.length;l++)if(r[l].visible){s=r[l];break}s&&s[o]&&(t.type=m(s[o],"gregorian")),"-"===t.type?t.type="linear":e.type=t.type}return t.type}var o=e("../../lib"),n=e("../../components/color"),l=e("../../plot_api/plot_template"),s=e("../subplot_defaults"),d=e("../get_data").getSubplotData,c=e("../cartesian/tick_value_defaults"),p=e("../cartesian/tick_mark_defaults"),u=e("../cartesian/tick_label_defaults"),g=e("../cartesian/category_order_defaults"),h=e("../cartesian/line_grid_defaults"),m=e("../cartesian/axis_autotype"),y=e("./layout_attributes"),f=e("./set_convert"),x=e("./constants"),_=x.axisNames;t.exports=function(e,t,r){s(e,t,r,{type:x.name,attributes:y,handleDefaults:a,font:t.font,paper_bgcolor:t.paper_bgcolor,fullData:r,layoutOut:t})}},{"../../components/color":593,"../../lib":719,"../../plot_api/plot_template":757,"../cartesian/axis_autotype":768,"../cartesian/category_order_defaults":771,"../cartesian/line_grid_defaults":781,"../cartesian/tick_label_defaults":786,"../cartesian/tick_mark_defaults":787,"../cartesian/tick_value_defaults":788,"../get_data":802,"../subplot_defaults":842,"./constants":829,"./layout_attributes":832,"./set_convert":841}],834:[function(e,t){"use strict";var a=e("../../../traces/scatter/attributes"),r=a.marker,o=e("../../../lib/extend").extendFlat;t.exports={r:o({},a.r,{}),t:o({},a.t,{}),marker:{color:o({},r.color,{}),size:o({},r.size,{}),symbol:o({},r.symbol,{}),opacity:o({},r.opacity,{}),editType:"calc"}}},{"../../../lib/extend":710,"../../../traces/scatter/attributes":1112}],835:[function(e,t){"use strict";function a(e,t){return o({},t,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number",description:n},visible:{valType:"boolean"}})}var r=e("../../cartesian/layout_attributes"),o=e("../../../lib/extend").extendFlat,i=e("../../../plot_api/edit_types").overrideAll,n="Legacy polar charts are deprecated! Please switch to *polar* subplots.",l=o({},r.domain,{});t.exports=i({radialaxis:a("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:l,orientation:{valType:"number"}}),angularaxis:a("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:l}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":710,"../../../plot_api/edit_types":750,"../../cartesian/layout_attributes":779}],836:[function(e,t){"use strict";var a=t.exports=e("./micropolar");a.manager=e("./micropolar_manager")},{"./micropolar":837,"./micropolar_manager":838}],837:[function(e,t){var o=e("d3"),a=e("../../../lib"),n=a.extendDeepAll,l=e("../../../constants/alignment").MID_SHIFT,s=t.exports={version:"0.2.2"};s.Axis=function(){function e(e){p=e||p;var a=t.data,h=t.layout;return("string"==typeof p||p.nodeName)&&(p=o.select(p)),p.datum(a).each(function(e){function t(e){return g(e)%360+h.orientation}var a=e.slice();r={data:s.util.cloneJson(a),layout:s.util.cloneJson(h)};var p=0;a.forEach(function(e,t){e.color||(e.color=h.defaultColorRange[p],p=(p+1)%h.defaultColorRange.length),e.strokeColor||(e.strokeColor="LinePlot"===e.geometry?e.color:o.rgb(e.color).darker().toString()),r.data[t].color=e.color,r.data[t].strokeColor=e.strokeColor,r.data[t].strokeDash=e.strokeDash,r.data[t].strokeSize=e.strokeSize});var m=a.filter(function(e){var t=e.visible;return"undefined"==typeof t||!0===t}),y=!1,f=m.map(function(e){return y=y||"undefined"!=typeof e.groupId,e});if(y){var x=o.nest().key(function(e){return"undefined"==typeof e.groupId?"unstacked":e.groupId}).entries(f),_=[],b=x.map(function(e){if("unstacked"===e.key)return e.values;var t=e.values[0].r.map(function(){return 0});return e.values.forEach(function(e){e.yStack=[t],_.push(t),t=s.util.sumArrays(e.r,t)}),e.values});m=o.merge(b)}m.forEach(function(e){e.t=Array.isArray(e.t[0])?e.t:[e.t],e.r=Array.isArray(e.r[0])?e.r:[e.r]});var v=ea(h.width-h.margin.left-h.margin.right,h.height-h.margin.top-h.margin.bottom)/2;v=va(10,v);var k=[h.margin.left+v,h.margin.top+v],w;if(y){var T=o.max(s.util.sumArrays(s.util.arrayLast(m).r[0],s.util.arrayLast(_)));w=[0,T]}else w=o.extent(s.util.flattenArray(m.map(function(e){return e.r})));h.radialAxis.domain!=s.DATAEXTENT&&(w[0]=0),u=o.scale.linear().domain(h.radialAxis.domain!=s.DATAEXTENT&&h.radialAxis.domain?h.radialAxis.domain:w).range([0,v]),r.layout.radialAxis.domain=u.domain();var A=s.util.flattenArray(m.map(function(e){return e.t})),S="string"==typeof A[0],C;S&&(A=s.util.deduplicate(A),C=A.slice(),A=o.range(A.length),m=m.map(function(e){var t=e;return e.t=[A],y&&(t.yStack=e.yStack),t}));var L=m.filter(function(e){return"LinePlot"===e.geometry||"DotPlot"===e.geometry}).length===m.length,E=null===h.needsEndSpacing?S||!L:h.needsEndSpacing,I=h.angularAxis.domain&&h.angularAxis.domain!=s.DATAEXTENT&&!S&&0<=h.angularAxis.domain[0],z=I?h.angularAxis.domain:o.extent(A),P=_a(A[1]-A[0]);L&&!S&&(P=0);var D=z.slice();E&&S&&(D[1]+=P);var O=h.angularAxis.ticksCount||4;8<O&&(O=O/(O/8)+O%8),h.angularAxis.ticksStep&&(O=(D[1]-D[0])/O);var R=h.angularAxis.ticksStep||(D[1]-D[0])/(O*(h.minorTicks+1));C&&(R=va(V(R),1)),D[2]||(D[2]=R);var M=o.range.apply(this,D);if(M=M.map(function(e){return parseFloat(e.toPrecision(12))}),g=o.scale.linear().domain(D.slice(0,2)).range("clockwise"===h.direction?[0,360]:[360,0]),r.layout.angularAxis.domain=g.domain(),r.layout.angularAxis.endPadding=E?P:0,c=o.select(this).select("svg.chart-root"),"undefined"==typeof c||c.empty()){var j=new DOMParser().parseFromString("<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>","application/xml"),F=this.appendChild(this.ownerDocument.importNode(j.documentElement,!0));c=o.select(F)}c.select(".guides-group").style({"pointer-events":"none"}),c.select(".angular.axis-group").style({"pointer-events":"none"}),c.select(".radial.axis-group").style({"pointer-events":"none"});var B=c.select(".chart-group"),N={fill:"none",stroke:h.tickColor},U={"font-size":h.font.size,"font-family":h.font.family,fill:h.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(e){return" "+e+" 0 "+h.font.outlineColor}).join(",")},H;if(h.showLegend){H=c.select(".legend-group").attr({transform:"translate("+[v,h.margin.top]+")"}).style({display:"block"});var G=m.map(function(e){var t=s.util.cloneJson(e);return t.symbol="DotPlot"===e.geometry?e.dotType||"circle":"LinePlot"==e.geometry?"line":"square",t.visibleInLegend="undefined"==typeof e.visibleInLegend||e.visibleInLegend,t.color="LinePlot"===e.geometry?e.strokeColor:e.color,t});s.Legend().config({data:m.map(function(e,t){return e.name||"Element"+t}),legendConfig:n({},s.Legend.defaultConfig().legendConfig,{container:H,elements:G,reverseOrder:h.legend.reverseOrder})})();var q=H.node().getBBox();v=ea(h.width-q.width-h.margin.left-h.margin.right,h.height-h.margin.top-h.margin.bottom)/2,v=va(10,v),k=[h.margin.left+v,h.margin.top+v],u.range([0,v]),r.layout.radialAxis.domain=u.domain(),H.attr("transform","translate("+[k[0]+v,k[1]-v]+")")}else H=c.select(".legend-group").style({display:"none"});c.attr({width:h.width,height:h.height}).style({opacity:h.opacity}),B.attr("transform","translate("+k+")").style({cursor:"crosshair"});var Y=[(h.width-(h.margin.left+h.margin.right+2*v+(q?q.width:0)))/2,(h.height-(h.margin.top+h.margin.bottom+2*v))/2];if(Y[0]=va(0,Y[0]),Y[1]=va(0,Y[1]),c.select(".outer-group").attr("transform","translate("+Y+")"),h.title&&h.title.text){var W=c.select("g.title-group text").style(U).text(h.title.text),X=W.node().getBBox();W.attr({x:k[0]-X.width/2,y:k[1]-v-20})}var Z=c.select(".radial.axis-group");if(h.radialAxis.gridLinesVisible){var K=Z.selectAll("circle.grid-circle").data(u.ticks(5));K.enter().append("circle").attr({class:"grid-circle"}).style(N),K.attr("r",u),K.exit().remove()}Z.select("circle.outside-circle").attr({r:v}).style(N);var J=c.select("circle.background-circle").attr({r:v}).style({fill:h.backgroundColor,stroke:h.stroke});if(h.radialAxis.visible){var Q=o.svg.axis().scale(u).ticks(5).tickSize(5);Z.call(Q).attr({transform:"rotate("+h.radialAxis.orientation+")"}),Z.selectAll(".domain").style(N),Z.selectAll("g>text").text(function(){return this.textContent+h.radialAxis.ticksSuffix}).style(U).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(){return"horizontal"===h.radialAxis.tickOrientation?"rotate("+-h.radialAxis.orientation+") translate("+[0,U["font-size"]]+")":"translate("+[0,U["font-size"]]+")"}}),Z.selectAll("g>line").style({stroke:"black"})}var $=c.select(".angular.axis-group").selectAll("g.angular-tick").data(M),ee=$.enter().append("g").classed("angular-tick",!0);$.attr({transform:function(e,a){return"rotate("+t(e,a)+")"}}).style({display:h.angularAxis.visible?"block":"none"}),$.exit().remove(),ee.append("line").classed("grid-line",!0).classed("major",function(e,t){return 0==t%(h.minorTicks+1)}).classed("minor",function(e,t){return 0!=t%(h.minorTicks+1)}).style(N),ee.selectAll(".minor").style({stroke:h.minorTickColor}),$.select("line.grid-line").attr({x1:h.tickLength?v-h.tickLength:0,x2:v}).style({display:h.angularAxis.gridLinesVisible?"block":"none"}),ee.append("text").classed("axis-text",!0).style(U);var te=$.select("text.axis-text").attr({x:v+h.labelOffset,dy:l+"em",transform:function(e,a){var r=t(e,a),o=v+h.labelOffset,i=h.angularAxis.tickOrientation;return"horizontal"==i?"rotate("+-r+" "+o+" 0)":"radial"==i?270>r&&90<r?"rotate(180 "+o+" 0)":null:"rotate("+(180>=r&&0<r?-90:90)+" "+o+" 0)"}}).style({"text-anchor":"middle",display:h.angularAxis.labelsVisible?"block":"none"}).text(function(e,t){return 0==t%(h.minorTicks+1)?C?C[e]+h.angularAxis.ticksSuffix:e+h.angularAxis.ticksSuffix:""}).style(U);h.angularAxis.rewriteTicks&&te.text(function(e,t){return 0==t%(h.minorTicks+1)?h.angularAxis.rewriteTicks(this.textContent,t):""});var ae=o.max(B.selectAll(".angular-tick text")[0].map(function(e){return e.getCTM().e+e.getBBox().width}));H.attr({transform:"translate("+[v+ae,h.margin.top]+")"});var re=0<c.select("g.geometry-group").selectAll("g").size(),oe=c.select("g.geometry-group").selectAll("g.geometry").data(m);if(oe.enter().append("g").attr({class:function(e,t){return"geometry geometry"+t}}),oe.exit().remove(),m[0]||re){var ie=[];m.forEach(function(e,t){var a={};a.radialScale=u,a.angularScale=g,a.container=oe.filter(function(e,a){return a==t}),a.geometry=e.geometry,a.orientation=h.orientation,a.direction=h.direction,a.index=t,ie.push({data:e,geometryConfig:a})});var ne=o.nest().key(function(e){return"undefined"!=typeof e.data.groupId||"unstacked"}).entries(ie),le=[];ne.forEach(function(e){"unstacked"===e.key?le=le.concat(e.values.map(function(e){return[e]})):le.push(e.values)}),le.forEach(function(e){var t=Array.isArray(e)?e[0].geometryConfig.geometry:e.geometryConfig.geometry;var a=e.map(function(e){return n(s[t].defaultConfig(),e)});s[t]().config(a)()})}var se=c.select(".guides-group"),de=c.select(".tooltips-group"),ce=s.tooltipPanel().config({container:de,fontSize:8})(),pe=s.tooltipPanel().config({container:de,fontSize:8})(),ue=s.tooltipPanel().config({container:de,hasTick:!0})(),ge,he;if(!S){var me=se.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});B.on("mousemove.angular-guide",function(){var e=s.util.getMousePos(J).angle;me.attr({x2:-v,transform:"rotate("+e+")"}).style({opacity:.5});var t=(e+180+360-h.orientation)%360;ge=g.invert(t);var a=s.util.convertToCartesian(v+12,e+180);ce.text(s.util.round(ge)).move([a[0]+k[0],a[1]+k[1]])}).on("mouseout.angular-guide",function(){se.select("line").style({opacity:0})})}var ye=se.select("circle").style({stroke:"grey",fill:"none"});B.on("mousemove.radial-guide",function(){var e=s.util.getMousePos(J).radius;ye.attr({r:e}).style({opacity:.5}),he=u.invert(s.util.getMousePos(J).radius);var t=s.util.convertToCartesian(e,h.radialAxis.orientation);pe.text(s.util.round(he)).move([t[0]+k[0],t[1]+k[1]])}).on("mouseout.radial-guide",function(){ye.style({opacity:0}),ue.hide(),ce.hide(),pe.hide()}),c.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(e){var t=o.select(this),a=this.style.fill,r="black",i=this.style.opacity||1;if(t.attr({"data-opacity":i}),a&&"none"!==a){t.attr({"data-fill":a}),r=o.hsl(a).darker().toString(),t.style({fill:r,opacity:1});var n={t:s.util.round(e[0]),r:s.util.round(e[1])};S&&(n.t=C[e[0]]);var l="t: "+n.t+", r: "+n.r,d=this.getBoundingClientRect(),p=c.node().getBoundingClientRect(),u=[d.left+d.width/2-Y[0]-p.left,d.top+d.height/2-Y[1]-p.top];ue.config({color:r}).text(l),ue.move(u)}else a=this.style.stroke||"black",t.attr({"data-stroke":a}),r=o.hsl(a).darker().toString(),t.style({stroke:r,opacity:1})}).on("mousemove.tooltip",function(){return 0==o.event.which&&void(o.select(this).attr("data-fill")&&ue.show())}).on("mouseout.tooltip",function(){ue.hide();var e=o.select(this),t=e.attr("data-fill");t?e.style({fill:t,opacity:e.attr("data-opacity")}):e.style({stroke:e.attr("data-stroke"),opacity:e.attr("data-opacity")})})}),d}var t={data:[],layout:{}},a={},r={},i=o.dispatch("hover"),d={},c,p,u,g;return d.render=function(t){return e(t),this},d.config=function(e){if(!arguments.length)return t;var a=s.util.cloneJson(e);return a.data.forEach(function(e,a){t.data[a]||(t.data[a]={}),n(t.data[a],s.Axis.defaultConfig().data[0]),n(t.data[a],e)}),n(t.layout,s.Axis.defaultConfig().layout),n(t.layout,a.layout),this},d.getLiveConfig=function(){return r},d.getinputConfig=function(){return a},d.radialScale=function(){return u},d.angularScale=function(){return g},d.svg=function(){return c},o.rebind(d,i,"on"),d},s.Axis.defaultConfig=function(){var e={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:o.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}};return e},s.util={},s.DATAEXTENT="dataExtent",s.AREA="AreaChart",s.LINE="LinePlot",s.DOT="DotPlot",s.BAR="BarChart",s.util._override=function(e,t){for(var a in e)a in t&&(t[a]=e[a])},s.util._extend=function(e,t){for(var a in e)t[a]=e[a]},s.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},s.util.dataFromEquation2=function(e,t){var a=t||6,r=o.range(0,360+a,a).map(function(t){var a=e(t*Pe/180);return[t,a]});return r},s.util.dataFromEquation=function(e,a,i){var n=a||6,l=[],t=[];o.range(0,360+n,n).forEach(function(a){var r=e(a*Pe/180);l.push(a),t.push(r)});var r={t:l,r:t};return i&&(r.name=i),r},s.util.ensureArray=function(e,t){if("undefined"==typeof e)return null;var a=[].concat(e);return o.range(t).map(function(e,t){return a[t]||a[0]})},s.util.fillArrays=function(e,t,a){return t.forEach(function(t){e[t]=s.util.ensureArray(e[t],a)}),e},s.util.cloneJson=function(e){return JSON.parse(JSON.stringify(e))},s.util.validateKeys=function(e,t){"string"==typeof t&&(t=t.split("."));var a=t.shift();return e[a]&&(!t.length||objHasKeys(e[a],t))},s.util.sumArrays=function(e,t){return o.zip(e,t).map(function(e){return o.sum(e)})},s.util.arrayLast=function(e){return e[e.length-1]},s.util.arrayEqual=function(e,t){for(var a=va(e.length,t.length,1);0<=a--&&e[a]===t[a];);return-2===a},s.util.flattenArray=function(e){for(var t=[];!s.util.arrayEqual(t,e);)t=e,e=[].concat.apply([],e);return e},s.util.deduplicate=function(e){return e.filter(function(e,t,r){return r.indexOf(e)==t})},s.util.convertToCartesian=function(e,t){var a=t*Pe/180,r=e*R(a),o=e*De(a);return[r,o]},s.util.round=function(e,t){var a=ya(10,t||2);return V(e*a)/a},s.util.getMousePos=function(e){var t=o.mouse(e.node()),a=t[0],r=t[1],i={};return i.x=a,i.y=r,i.pos=t,i.angle=180*(L(r,a)+Pe)/Pe,i.radius=N(a*a+r*r),i},s.util.duplicatesCount=function(e){for(var t={},a={},r=0,o=e.length,n;r<o;r++)n=e[r],n in t?(t[n]++,a[n]=t[n]):t[n]=1;return a},s.util.duplicates=function(e){return Object.keys(s.util.duplicatesCount(e))},s.util.translator=function(e,t,a,r){if(r){var o=a.slice();a=t,t=o}var i=t.reduce(function(e,t){if("undefined"!=typeof e)return e[t]},e);"undefined"==typeof i||(t.reduce(function(e,a,r){if("undefined"!=typeof e)return r===t.length-1&&delete e[a],e[a]},e),a.reduce(function(e,t,r){return"undefined"==typeof e[t]&&(e[t]={}),r===a.length-1&&(e[t]=i),e[t]},e))},s.PolyChart=function(){function e(){var e=t[0].geometryConfig,a=e.container;"string"==typeof a&&(a=o.select(a)),a.datum(t).each(function(t){function a(a){var o=e.radialScale(a[1]),r=(e.angularScale(a[0])+e.orientation)*Pe/180;return{r:o,t:r}}function i(e){var t=e.r*R(e.t),a=e.r*De(e.t);return{x:t,y:a}}var n=!!t[0].data.yStack,l=t.map(function(e){return n?o.zip(e.data.t[0],e.data.r[0],e.data.yStack[0]):o.zip(e.data.t[0],e.data.r[0])}),s=e.angularScale,c=e.radialScale.domain()[0],p={};p.bar=function(a,r,i){var n=t[i].data,l=e.radialScale(a[1])-e.radialScale(0),d=e.radialScale(a[2]||0),c=n.barWidth;o.select(this).attr({class:"mark bar",d:"M"+[[l+d,-c/2],[l+d,c/2],[d,c/2],[d,-c/2]].join("L")+"Z",transform:function(t){return"rotate("+(e.orientation+s(t[0]))+")"}})},p.dot=function(e,r,n){var l=e[2]?[e[0],e[1]+e[2]]:e,s=o.svg.symbol().size(t[n].data.dotSize).type(t[n].data.dotType)(e,r);o.select(this).attr({class:"mark dot",d:s,transform:function(){var e=i(a(l));return"translate("+[e.x,e.y]+")"}})};var u=o.svg.line.radial().interpolate(t[0].data.lineInterpolation).radius(function(t){return e.radialScale(t[1])}).angle(function(t){return e.angularScale(t[0])*Pe/180});p.line=function(a,r,i){var n=a[2]?l[i].map(function(e){return[e[0],e[1]+e[2]]}):l[i];if(o.select(this).each(p.dot).style({opacity:function(){return+t[i].data.dotVisible},fill:y.stroke(a,r,i)}).attr({class:"mark dot"}),!(0<r)){var s=o.select(this.parentNode).selectAll("path.line").data([0]);s.enter().insert("path"),s.attr({class:"line",d:u(n),transform:function(){return"rotate("+(e.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(){return y.fill(a,r,i)},"fill-opacity":0,stroke:function(){return y.stroke(a,r,i)},"stroke-width":function(){return y["stroke-width"](a,r,i)},"stroke-dasharray":function(){return y["stroke-dasharray"](a,r,i)},opacity:function(){return y.opacity(a,r,i)},display:function(){return y.display(a,r,i)}})}};var g=e.angularScale.range(),h=_a(g[1]-g[0])/l[0].length*Pe/180,m=o.svg.arc().startAngle(function(){return-h/2}).endAngle(function(){return h/2}).innerRadius(function(t){return e.radialScale(c+(t[2]||0))}).outerRadius(function(t){return e.radialScale(c+(t[2]||0))+e.radialScale(t[1])});p.arc=function(){o.select(this).attr({class:"mark arc",d:m,transform:function(t){return"rotate("+(e.orientation+s(t[0])+90)+")"}})};var y={fill:function(e,a,r){return t[r].data.color},stroke:function(e,a,r){return t[r].data.strokeColor},"stroke-width":function(e,a,r){return t[r].data.strokeSize+"px"},"stroke-dasharray":function(e,a,o){return r[t[o].data.strokeDash]},opacity:function(e,a,r){return t[r].data.opacity},display:function(e,a,r){return"undefined"==typeof t[r].data.visible||t[r].data.visible?"block":"none"}},f=o.select(this).selectAll("g.layer").data(l);f.enter().append("g").attr({class:"layer"});var x=f.selectAll("path.mark").data(function(e){return e});x.enter().append("path").attr({class:"mark"}),x.style(y).each(p[e.geometryType]),x.exit().remove(),f.exit().remove()})}var t=[s.PolyChart.defaultConfig()],a=o.dispatch("hover"),r={solid:"none",dash:[5,2],dot:[2,5]},i;return e.config=function(e){return arguments.length?(e.forEach(function(e,a){t[a]||(t[a]={}),n(t[a],s.PolyChart.defaultConfig()),n(t[a],e)}),this):t},e.getColorScale=function(){return i},o.rebind(e,a,"on"),e},s.PolyChart.defaultConfig=function(){var e={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:o.scale.category20()}};return e},s.BarChart=function(){return s.PolyChart()},s.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}},s.AreaChart=function(){return s.PolyChart()},s.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}},s.DotPlot=function(){return s.PolyChart()},s.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}},s.LinePlot=function(){return s.PolyChart()},s.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}},s.Legend=function(){function e(){var a=t.legendConfig,r=t.data.map(function(e,t){return[].concat(e).map(function(e,r){var o=n({},a.elements[t]);return o.name=e,o.color=[].concat(a.elements[t].color)[r],o})}),l=o.merge(r);l=l.filter(function(e,t){return a.elements[t]&&(a.elements[t].visibleInLegend||"undefined"==typeof a.elements[t].visibleInLegend)}),a.reverseOrder&&(l=l.reverse());var s=a.container;("string"==typeof s||s.nodeName)&&(s=o.select(s));var c=l.map(function(e){return e.color}),p=a.fontSize,u=null==a.isContinuous?"number"==typeof l[0]:a.isContinuous,g=u?a.height:p*l.length,h=s.classed("legend-group",!0),m=h.selectAll("svg").data([0]),y=m.enter().append("svg").attr({width:300,height:g+p,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});y.append("g").classed("legend-axis",!0),y.append("g").classed("legend-marks",!0);var f=o.range(l.length),x=o.scale[u?"linear":"ordinal"]().domain(f).range(c),_=o.scale[u?"linear":"ordinal"]().domain(f)[u?"range":"rangePoints"]([0,g]),b=function(e,t){var a=3*t;return"line"===e?"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z":-1==o.svg.symbolTypes.indexOf(e)?o.svg.symbol().type("square").size(a)():o.svg.symbol().type(e).size(a)()};if(u){var v=m.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(c);v.enter().append("stop"),v.attr({offset:function(e,t){return 100*(t/(c.length-1))+"%"}}).style({"stop-color":function(e){return e}}),m.append("rect").classed("legend-mark",!0).attr({height:a.height,width:a.colorBandWidth,fill:"url(#grad1)"})}else{var k=m.select(".legend-marks").selectAll("path.legend-mark").data(l);k.enter().append("path").classed("legend-mark",!0),k.attr({transform:function(e,t){return"translate("+[p/2,_(t)+p/2]+")"},d:function(e){var t=e.symbol;return b(t,p)},fill:function(e,t){return x(t)}}),k.exit().remove()}var w=o.svg.axis().scale(_).orient("right"),T=m.select("g.legend-axis").attr({transform:"translate("+[u?a.colorBandWidth:p,p/2]+")"}).call(w);return T.selectAll(".domain").style({fill:"none",stroke:"none"}),T.selectAll("line").style({fill:"none",stroke:u?a.textColor:"none"}),T.selectAll("text").style({fill:a.textColor,"font-size":a.fontSize}).text(function(e,t){return l[t].name}),e}var t=s.Legend.defaultConfig(),a=o.dispatch("hover");return e.config=function(e){return arguments.length?(n(t,e),this):t},o.rebind(e,a,"on"),e},s.Legend.defaultConfig=function(){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}},s.tooltipPanel=function(){var e={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},t="tooltip-"+s.tooltipPanel.uid++,a=10,r=function(){i=e.container.selectAll("g."+t).data([0]);var o=i.enter().append("g").classed(t,!0).style({"pointer-events":"none",display:"none"});return c=o.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),d=o.append("text").attr({dx:e.padding+a,dy:.3*+e.fontSize}),r},i,d,c;return r.text=function(t){var n=o.hsl(e.color).l,l=.5<=n?"#aaa":"white",s=.5<=n?"black":"white";d.style({fill:s,"font-size":e.fontSize+"px"}).text(t||"");var p=e.padding,u=d.node().getBBox(),g={fill:e.color,stroke:l,"stroke-width":"2px"},h=u.width+2*p+a,m=u.height+2*p;return c.attr({d:"M"+[[a,-m/2],[a,-m/4],[e.hasTick?0:a,0],[a,m/4],[a,m/2],[h,m/2],[h,-m/2]].join("L")+"Z"}).style(g),i.attr({transform:"translate("+[a,-m/2+2*p]+")"}),i.style({display:"block"}),r},r.move=function(e){if(i)return i.attr({transform:"translate("+[e[0],e[1]]+")"}).style({display:"block"}),r},r.hide=function(){if(i)return i.style({display:"none"}),r},r.show=function(){if(i)return i.style({display:"block"}),r},r.config=function(t){return n(e,t),r},r},s.tooltipPanel.uid=1,s.adapter={},s.adapter.plotly=function(){return{convert:function(e,t){var a={};if(e.data&&(a.data=e.data.map(function(e){var a=n({},e);return[[a,["marker","color"],["color"]],[a,["marker","opacity"],["opacity"]],[a,["marker","line","color"],["strokeColor"]],[a,["marker","line","dash"],["strokeDash"]],[a,["marker","line","width"],["strokeSize"]],[a,["marker","symbol"],["dotType"]],[a,["marker","size"],["dotSize"]],[a,["marker","barWidth"],["barWidth"]],[a,["line","interpolation"],["lineInterpolation"]],[a,["showlegend"],["visibleInLegend"]]].forEach(function(e){s.util.translator.apply(null,e.concat(t))}),t||delete a.marker,t&&delete a.groupId,t?("LinePlot"===a.geometry?(a.type="scatter",!0===a.dotVisible?(delete a.dotVisible,a.mode="lines+markers"):a.mode="lines"):"DotPlot"===a.geometry?(a.type="scatter",a.mode="markers"):"AreaChart"===a.geometry?a.type="area":"BarChart"===a.geometry&&(a.type="bar"),delete a.geometry):("scatter"===a.type?"lines"===a.mode?a.geometry="LinePlot":"markers"===a.mode?a.geometry="DotPlot":"lines+markers"===a.mode&&(a.geometry="LinePlot",a.dotVisible=!0):"area"===a.type?a.geometry="AreaChart":"bar"===a.type&&(a.geometry="BarChart"),delete a.mode,delete a.type),a}),!t&&e.layout&&"stack"===e.layout.barmode)){var l=s.util.duplicates(a.data.map(function(e){return e.geometry}));a.data.forEach(function(e,t){var r=l.indexOf(e.geometry);-1!=r&&(a.data[t].groupId=r)})}if(e.layout){var d=n({},e.layout),r=[[d,["plot_bgcolor"],["backgroundColor"]],[d,["showlegend"],["showLegend"]],[d,["radialaxis"],["radialAxis"]],[d,["angularaxis"],["angularAxis"]],[d.angularaxis,["showline"],["gridLinesVisible"]],[d.angularaxis,["showticklabels"],["labelsVisible"]],[d.angularaxis,["nticks"],["ticksCount"]],[d.angularaxis,["tickorientation"],["tickOrientation"]],[d.angularaxis,["ticksuffix"],["ticksSuffix"]],[d.angularaxis,["range"],["domain"]],[d.angularaxis,["endpadding"],["endPadding"]],[d.radialaxis,["showline"],["gridLinesVisible"]],[d.radialaxis,["tickorientation"],["tickOrientation"]],[d.radialaxis,["ticksuffix"],["ticksSuffix"]],[d.radialaxis,["range"],["domain"]],[d.angularAxis,["showline"],["gridLinesVisible"]],[d.angularAxis,["showticklabels"],["labelsVisible"]],[d.angularAxis,["nticks"],["ticksCount"]],[d.angularAxis,["tickorientation"],["tickOrientation"]],[d.angularAxis,["ticksuffix"],["ticksSuffix"]],[d.angularAxis,["range"],["domain"]],[d.angularAxis,["endpadding"],["endPadding"]],[d.radialAxis,["showline"],["gridLinesVisible"]],[d.radialAxis,["tickorientation"],["tickOrientation"]],[d.radialAxis,["ticksuffix"],["ticksSuffix"]],[d.radialAxis,["range"],["domain"]],[d.font,["outlinecolor"],["outlineColor"]],[d.legend,["traceorder"],["reverseOrder"]],[d,["labeloffset"],["labelOffset"]],[d,["defaultcolorrange"],["defaultColorRange"]]];if(r.forEach(function(e){s.util.translator.apply(null,e.concat(t))}),t?("undefined"!=typeof d.tickLength&&(d.angularaxis.ticklen=d.tickLength,delete d.tickLength),d.tickColor&&(d.angularaxis.tickcolor=d.tickColor,delete d.tickColor)):(d.angularAxis&&"undefined"!=typeof d.angularAxis.ticklen&&(d.tickLength=d.angularAxis.ticklen),d.angularAxis&&"undefined"!=typeof d.angularAxis.tickcolor&&(d.tickColor=d.angularAxis.tickcolor)),d.legend&&"boolean"!=typeof d.legend.reverseOrder&&(d.legend.reverseOrder="normal"!=d.legend.reverseOrder),d.legend&&"boolean"==typeof d.legend.traceorder&&(d.legend.traceorder=d.legend.traceorder?"reversed":"normal",delete d.legend.reverseOrder),d.margin&&"undefined"!=typeof d.margin.t){var i=["t","r","b","l","pad"],c=["top","right","bottom","left","pad"],p={};o.entries(d.margin).forEach(function(e){p[c[i.indexOf(e.key)]]=e.value}),d.margin=p}t&&(delete d.needsEndSpacing,delete d.minorTickColor,delete d.minorTicks,delete d.angularaxis.ticksCount,delete d.angularaxis.ticksCount,delete d.angularaxis.ticksStep,delete d.angularaxis.rewriteTicks,delete d.angularaxis.nticks,delete d.radialaxis.ticksCount,delete d.radialaxis.ticksCount,delete d.radialaxis.ticksStep,delete d.radialaxis.rewriteTicks,delete d.radialaxis.nticks),a.layout=d}return a}}}},{"../../../constants/alignment":688,"../../../lib":719,d3:163}],838:[function(e,t){"use strict";var a=e("d3"),r=e("../../../lib"),o=e("../../../components/color"),i=e("./micropolar"),n=e("./undo_manager"),l=r.extendDeepAll,s=t.exports={};s.framework=function(e){function t(t,r){return r&&(u=r),a.select(a.select(u).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),o=o?l(o,t):t,c||(c=i.Axis()),p=i.adapter.plotly().convert(o),c.config(p).render(u),e.data=o.data,e.layout=o.layout,s.fillLayout(e),o}var r=new n,o,d,c,p,u;return t.isPolar=!0,t.svg=function(){return c.svg()},t.getConfig=function(){return o},t.getLiveConfig=function(){return i.adapter.plotly().convert(c.getLiveConfig(),!0)},t.getLiveScales=function(){return{t:c.angularScale(),r:c.radialScale()}},t.setUndoPoint=function(){var e=this,t=i.util.cloneJson(o);(function(t,a){r.add({undo:function(){a&&e(a)},redo:function(){e(t)}})})(t,d),d=i.util.cloneJson(t)},t.undo=function(){r.undo()},t.redo=function(){r.redo()},t},s.fillLayout=function(e){var t=a.select(e).selectAll(".plot-container"),r=t.selectAll(".svg-container"),i=e.framework&&e.framework.svg&&e.framework.svg(),n={width:800,height:600,paper_bgcolor:o.background,_container:t,_paperdiv:r,_paper:i};e._fullLayout=l(n,e.layout)}},{"../../../components/color":593,"../../../lib":719,"./micropolar":837,"./undo_manager":839,d3:163}],839:[function(e,t){"use strict";t.exports=function(){function e(e,t){return e?(r=!0,e[t](),r=!1,this):this}var t=[],a=-1,r=!1,o;return{add:function(e){return r?this:(t.splice(a+1,t.length-a),t.push(e),a=t.length-1,this)},setCallback:function(e){o=e},undo:function(){var r=t[a];return r?(e(r,"undo"),a-=1,o&&o(r.undo),this):this},redo:function(){var r=t[a+1];return r?(e(r,"redo"),a+=1,o&&o(r.redo),this):this},clear:function(){t=[],a=-1},hasUndo:function(){return-1!==a},hasRedo:function(){return a<t.length-1},getCommands:function(){return t},getPreviousCommand:function(){return t[a-1]},getIndex:function(){return a}}}},{}],840:[function(e,t){"use strict";function a(e,t){this.id=t,this.gd=e,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var a=e._fullLayout,r="clip"+a._uid+t;this.clipIds.forTraces=r+"-for-traces",this.clipPaths.forTraces=a._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=a._polarlayer.append("g").attr("class",t),this.radialTickLayout=null,this.angularTickLayout=null}function r(e){var t=e.ticks+(e.ticklen+"")+(e.showticklabels+"");return"side"in e&&(t+=e.side),t}function o(e){var t=e[0],a=e[1],r=h(t,360),o=r+(a-t),i=R(_(r)),n=De(_(r)),l=R(_(o)),s=De(_(o)),d,c,p,u;return u=90>=r&&90<=o||90<r&&450<=o?1:0>=n&&0>=s?0:va(n,s),d=180>=r&&180<=o||180<r&&540<=o?-1:0<=i&&0<=l?0:ea(i,l),c=270>=r&&270<=o||270<r&&630<=o?-1:0<=n&&0<=s?0:ea(n,s),p=360<=o?1:0>=i&&0>=l?0:va(i,l),[d,c,p,u]}function i(e,t){var a=u.findIndexOfMin(t,function(t){return u.angleDist(e,t)});return t[a]}function n(e,t,a){return t?(e.attr("display",null),e.attr(a)):e&&e.attr("display","none"),e}function l(e,t){return"translate("+e+","+t+")"}function s(e){return"rotate("+e+")"}var c=e("d3"),d=e("tinycolor2"),p=e("../../registry"),u=e("../../lib"),g=e("../../components/color"),m=e("../../components/drawing"),y=e("../plots"),f=e("../../plots/cartesian/axes"),x=e("../cartesian/set_convert"),b=e("./set_convert"),v=e("../cartesian/autorange").doAutoRange,w=e("../cartesian/dragbox"),T=e("../../components/dragelement"),A=e("../../components/fx"),k=e("../../components/titles"),S=e("../cartesian/select").prepSelect,C=e("../cartesian/select").selectOnClick,E=e("../cartesian/select").clearSelect,I=e("../../lib/setcursor"),z=e("../../lib/clear_gl_canvases"),P=e("../../plot_api/subroutines").redrawReglTraces,D=e("../../constants/alignment").MID_SHIFT,O=e("./constants"),M=e("./helpers"),j=u._,h=u.mod,_=u.deg2rad,F=u.rad2deg,B=a.prototype;t.exports=function(e,t){return new a(e,t)},B.plot=function(e,t){var a=this,r=t[a.id];a._hasClipOnAxisFalse=!1;for(var o=0,n;o<e.length;o++)if(n=e[o][0].trace,!1===n.cliponaxis){a._hasClipOnAxisFalse=!0;break}a.updateLayers(t,r),a.updateLayout(t,r),y.generalUpdatePerTraceModule(a.gd,a,e,r),a.updateFx(t,r)},B.updateLayers=function(e,t){var a=this,r=a.layers,o=t.radialaxis,i=t.angularaxis,n=O.layerNames,l=n.indexOf("frontplot"),s=n.slice(0,l),d="below traces"===i.layer,p="below traces"===o.layer;d&&s.push("angular-line"),p&&s.push("radial-line"),d&&s.push("angular-axis"),p&&s.push("radial-axis"),s.push("frontplot"),d||s.push("angular-line"),p||s.push("radial-line"),d||s.push("angular-axis"),p||s.push("radial-axis");var u=a.framework.selectAll(".polarsublayer").data(s,String);u.enter().append("g").attr("class",function(e){return"polarsublayer "+e}).each(function(e){var t=r[e]=c.select(this);"frontplot"===e?(t.append("g").classed("barlayer",!0),t.append("g").classed("scatterlayer",!0)):"backplot"===e?t.append("g").classed("maplayer",!0):"plotbg"===e?r.bg=t.append("path"):"radial-grid"===e?t.style("fill","none"):"angular-grid"===e?t.style("fill","none"):"radial-line"===e?t.append("line").style("fill","none"):"angular-line"===e?t.append("path").style("fill","none"):void 0}),u.order()},B.updateLayout=function(e,t){var a=this,r=a.layers,i=e._size,n=t.radialaxis,s=t.angularaxis,d=t.domain.x,c=t.domain.y;a.xOffset=i.l+i.w*d[0],a.yOffset=i.t+i.h*(1-c[1]);var p=a.xLength=i.w*(d[1]-d[0]),u=a.yLength=i.h*(c[1]-c[0]),h=t.sector;a.sectorInRad=h.map(_);var y=a.sectorBBox=o(h),f=y[2]-y[0],x=y[3]-y[1],b=_a(x/f),v,k,w,T,A;u/p>b?(v=p,k=p*b,A=(u-k)/i.h/2,w=[d[0],d[1]],T=[c[0]+A,c[1]-A]):(v=u/b,k=u,A=(p-v)/i.w/2,w=[d[0]+A,d[1]-A],T=[c[0],c[1]]),a.xLength2=v,a.yLength2=k,a.xDomain2=w,a.yDomain2=T;var S=a.xOffset2=i.l+i.w*w[0],C=a.yOffset2=i.t+i.h*(1-T[1]),L=a.radius=v/f,E=a.innerRadius=t.hole*L,I=a.cx=S-L*y[0],z=a.cy=C+L*y[3],P=a.cxx=I-S,D=a.cyy=z-C;a.radialAxis=a.mockAxis(e,t,n,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[n.side],domain:[E/i.w,L/i.w]}),a.angularAxis=a.mockAxis(e,t,s,{side:"right",domain:[0,Pe],autorange:!1}),a.doAutoRange(e,t),a.updateAngularAxis(e,t),a.updateRadialAxis(e,t),a.updateRadialAxisTitle(e,t),a.xaxis=a.mockCartesianAxis(e,t,{_id:"x",domain:w}),a.yaxis=a.mockCartesianAxis(e,t,{_id:"y",domain:T});var O=a.pathSubplot();a.clipPaths.forTraces.select("path").attr("d",O).attr("transform",l(P,D)),r.frontplot.attr("transform",l(S,C)).call(m.setClipUrl,a._hasClipOnAxisFalse?null:a.clipIds.forTraces,a.gd),r.bg.attr("d",O).attr("transform",l(I,z)).call(g.fill,t.bgcolor)},B.mockAxis=function(e,t,a,r){var o=u.extendFlat({anchor:"free",position:0},a,r);return b(o,t,e),o},B.mockCartesianAxis=function(e,t,a){var r=this,o=a._id,i=u.extendFlat({type:"linear"},a);x(i,e);var n={x:[0,2],y:[1,3]};return i.setRange=function(){var e=r.sectorBBox,a=n[o],l=r.radialAxis._rl,s=(l[1]-l[0])/(1-t.hole);i.range=[e[a[0]]*s,e[a[1]]*s]},i.isPtWithinRange="x"===o?function(e){return r.isPtInside(e)}:function(){return!0},i.setRange(),i.setScale(),i},B.doAutoRange=function(e,t){var a=this.gd,r=this.radialAxis,o=t.radialaxis;r.setScale(),v(a,r);var i=r.range;o.range=i.slice(),o._input.range=i.slice(),r._rl=[r.r2l(i[0],null,"gregorian"),r.r2l(i[1],null,"gregorian")]},B.updateRadialAxis=function(e,t){var a=this,o=a.gd,d=a.layers,c=a.radius,p=a.innerRadius,m=a.cx,y=a.cy,x=t.radialaxis,b=h(t.sector[0],360),v=a.radialAxis,k=p<c;a.fillViewInitialKey("radialaxis.angle",x.angle),a.fillViewInitialKey("radialaxis.range",v.range.slice()),v.setGeometry(),"auto"===v.tickangle&&90<b&&270>=b&&(v.tickangle=180);var w=function(e){return"translate("+(v.l2p(e.x)+p)+",0)"},T=function(e){return a.pathArc(v.r2p(e.x)+p)},A=r(x);if(a.radialTickLayout!==A&&(d["radial-axis"].selectAll(".xtick").remove(),a.radialTickLayout=A),k){v.setScale();var S=f.calcTicks(v),C=f.clipEnds(v,S),L=f.getTickSigns(v)[2];f.drawTicks(o,v,{vals:S,layer:d["radial-axis"],path:f.makeTickPath(v,0,L),transFn:w,crisp:!1}),f.drawGrid(o,v,{vals:C,layer:d["radial-grid"],path:T,transFn:u.noop,crisp:!1}),f.drawLabels(o,v,{vals:S,layer:d["radial-axis"],transFn:w,labelFns:f.makeLabelFns(v,0)})}var E=a.radialAxisAngle=a.vangles?F(i(_(x.angle),a.vangles)):x.angle,I=l(m,y),z=I+s(-E);n(d["radial-axis"],k&&(x.showticklabels||x.ticks),{transform:z}),n(d["radial-grid"],k&&x.showgrid,{transform:I}),n(d["radial-line"].select("line"),k&&x.showline,{x1:p,y1:0,x2:c,y2:0,transform:z}).attr("stroke-width",x.linewidth).call(g.stroke,x.linecolor)},B.updateRadialAxisTitle=function(e,t,a){var r=this,o=r.gd,i=r.radius,n=r.cx,l=r.cy,s=t.radialaxis,d=r.id+"title",c=a===void 0?r.radialAxisAngle:a,p=_(c),u=R(p),g=De(p),y=0;if(s.title){var f=m.bBox(r.layers["radial-axis"].node()).height,h=s.title.font.size;y="counterclockwise"===s.side?-f-.4*h:f+.8*h}r.layers["radial-axis-title"]=k.draw(o,d,{propContainer:s,propName:r.id+".radialaxis.title",placeholder:j(o,"Click to enter radial axis title"),attributes:{x:n+i/2*u+y*g,y:l-i/2*g+y*u,"text-anchor":"middle"},transform:{rotate:-c}})},B.updateAngularAxis=function(e,t){var a=this,o=a.gd,i=a.layers,c=a.radius,p=a.innerRadius,h=a.cx,m=a.cy,d=t.angularaxis,y=a.angularAxis;a.fillViewInitialKey("angularaxis.rotation",d.rotation),y.setGeometry(),y.setScale();var x=function(e){return y.t2g(e.x)};"linear"===y.type&&"radians"===y.thetaunit&&(y.tick0=F(y.tick0),y.dtick=F(y.dtick));var _=function(e){return l(h+c*R(e),m-c*De(e))},b=function(e){return _(x(e))},v=function(e){var t=x(e);return _(t)+s(-F(t))},k=function(e){var t=x(e),a=R(t),r=De(t);return"M"+[h+p*a,m-p*r]+"L"+[h+c*a,m-c*r]},w=f.makeLabelFns(y,0),T=w.labelStandoff,A={};A.xFn=function(e){var t=x(e);return R(t)*T},A.yFn=function(e){var t=x(e),a=0<De(t)?.2:1;return-De(t)*(T+e.fontSize*a)+_a(R(t))*(e.fontSize*D)},A.anchorFn=function(e){var t=x(e),a=R(t);return .1>_a(a)?"middle":0<a?"start":"end"},A.heightFn=function(e,t,a){var r=x(e);return-.5*(1+De(r))*a};var S=r(d);a.angularTickLayout!==S&&(i["angular-axis"].selectAll("."+y._id+"tick").remove(),a.angularTickLayout=S);var C=f.calcTicks(y),L;if("linear"===t.gridshape?(L=C.map(x),0>u.angleDelta(L[0],L[1])&&(L=L.slice().reverse())):L=null,a.vangles=L,"category"===y.type&&(C=C.filter(function(e){return u.isAngleInsideSector(x(e),a.sectorInRad)})),y.visible){var E="inside"===y.ticks?-1:1,I=(y.linewidth||1)/2;f.drawTicks(o,y,{vals:C,layer:i["angular-axis"],path:"M"+E*I+",0h"+E*y.ticklen,transFn:v,crisp:!1}),f.drawGrid(o,y,{vals:C,layer:i["angular-grid"],path:k,transFn:u.noop,crisp:!1}),f.drawLabels(o,y,{vals:C,layer:i["angular-axis"],repositionOnUpdate:!0,transFn:b,labelFns:A})}n(i["angular-line"].select("path"),d.showline,{d:a.pathSubplot(),transform:l(h,m)}).attr("stroke-width",d.linewidth).call(g.stroke,d.linecolor)},B.updateFx=function(e,t){this.gd._context.staticPlot||(this.updateAngularDrag(e),this.updateRadialDrag(e,t,0),this.updateRadialDrag(e,t,1),this.updateMainDrag(e))},B.updateMainDrag=function(e){function t(e,t){return N(e*e+t*t)}function a(e,a){return t(e-V,a-U)}function r(e,t){return L(U-t,e-V)}function o(e,t){return[e*R(t),e*De(-t)]}function i(e,t){if(0===e)return b.pathSector(2*Z);var a=K/e,r=t-a,i=t+a,n=va(0,ea(e,D)),l=n-Z,s=n+Z;return"M"+o(l,r)+"A"+[l,l]+" 0,0,0 "+o(l,i)+"L"+o(s,i)+"A"+[s,s]+" 0,0,1 "+o(s,r)+"Z"}function n(e,t,a){if(0===e)return b.pathSector(2*Z);var r=o(e,t),i=o(e,a),n=Y((r[0]+i[0])/2),l=Y((r[1]+i[1])/2),s,d;if(n&&l){var c=l/n,p=-1/c,u=W(Z,c,n,l);s=W(K,p,u[0][0],u[0][1]),d=W(K,p,u[1][0],u[1][1])}else{var g,h;l?(g=K,h=Z):(g=Z,h=K),s=[[n-g,l-h],[n+g,l-h]],d=[[n-g,l+h],[n+g,l+h]]}return"M"+s.join("L")+"L"+d.reverse().join("L")+"Z"}function s(){te=null,ae=null,re=b.pathSubplot(),oe=!1;var e=v._fullLayout[b.id];ie=d(e.bgcolor).getLuminance(),ne=w.makeZoombox(I,ie,F,B,re),ne.attr("fill-rule","evenodd"),le=w.makeCorners(I,F,B),E(v)}function u(e,t){return t=va(ea(t,D),j),e<P?e=0:D-e<P?e=D:t<P?t=0:D-t<P&&(t=D),_a(t-e)>z?(e<t?(te=e,ae=t):(te=t,ae=e),!0):(te=null,ae=null,!1)}function g(e,t){e=e||re,t=t||"M0,0Z",ne.attr("d",e),le.attr("d",t),w.transitionZoombox(ne,le,oe,ie),oe=!0;var a={};x(a),v.emit("plotly_relayouting",a)}function h(e,t){var o=$+e,n=ee+t,l=a($,ee),s=ea(a(o,n),D),d=r($,ee),c,p;u(l,s)&&(c=re+b.pathSector(ae),te&&(c+=b.pathSector(te)),p=i(te,d)+i(ae,d)),g(c,p)}function m(e,a,r,o){var i=M.findIntersectionXY(r,o,r,[e-V,U-a]);return t(i[0],i[1])}function y(e,t){var a=$+e,o=ee+t,i=r($,ee),l=r(a,o),s=X(i,G),d=X(l,G),c=m($,ee,s[0],s[1]),p=ea(m(a,o,d[0],d[1]),D),h,y;u(c,p)&&(h=re+b.pathSector(ae),te&&(h+=b.pathSector(te)),y=[n(te,s[0],s[1]),n(ae,s[0],s[1])].join(" ")),g(h,y)}function f(){if(w.removeZoombox(v),null!==te&&null!==ae){var e={};x(e),w.showDoubleClickNotifier(v),p.call("_guiRelayout",v,e)}}function x(e){var t=q._rl,a=(t[1]-t[0])/(1-j/D)/D,r=[t[0]+(te-j)*a,t[0]+(ae-j)*a];e[b.id+".radialaxis.range"]=r}function _(e,t){var a=v._fullLayout.clickmode;if(w.removeZoombox(v),2===e){var r={};for(var o in b.viewInitial)r[b.id+"."+o]=b.viewInitial[o];v.emit("plotly_doubleclick",null),p.call("_guiRelayout",v,r)}-1<a.indexOf("select")&&1===e&&C(t,v,[b.xaxis],[b.yaxis],b.id,Q),-1<a.indexOf("event")&&A.click(v,t,b.id)}var b=this,v=b.gd,k=b.layers,I=e._zoomlayer,z=O.MINZOOM,P=O.OFFEDGE,D=b.radius,j=b.innerRadius,F=b.cx,B=b.cy,V=b.cxx,U=b.cyy,H=b.sectorInRad,G=b.vangles,q=b.radialAxis,Y=M.clampTiny,W=M.findXYatLength,X=M.findEnclosingVertexAngles,Z=O.cornerHalfWidth,K=O.cornerLen/2,J=w.makeDragger(k,"path","maindrag","crosshair");c.select(J).attr("d",b.pathSubplot()).attr("transform",l(F,B));var Q={element:J,gd:v,subplot:b.id,plotinfo:{id:b.id,xaxis:b.xaxis,yaxis:b.yaxis},xaxes:[b.xaxis],yaxes:[b.yaxis]},$,ee,te,ae,re,oe,ie,ne,le;Q.prepFn=function(e,t,a){var r=v._fullLayout.dragmode,o=J.getBoundingClientRect();if($=t-o.left,ee=a-o.top,G){var i=M.findPolygonOffset(D,H[0],H[1],G);$+=V+i[0],ee+=U+i[1]}"zoom"===r?(Q.moveFn=G?y:h,Q.clickFn=_,Q.doneFn=f,s(e,t,a)):"select"===r||"lasso"===r?S(e,t,a,Q,r):void 0},J.onmousemove=function(e){A.hover(v,e,b.id),v._fullLayout._lasthover=J,v._fullLayout._hoversubplot=b.id},J.onmouseout=function(e){v._dragging||T.unhover(v,e)},T.init(Q)},B.updateRadialDrag=function(e,t,a){function r(e,t){if(W)W(e,t);else{var a=[e,-t],r=[R(D),De(D)],i=_a(u.dot(a,r)/N(u.dot(a,a)));isNaN(i)||(W=.5>i?g:h)}var n={};o(n),f.emit("plotly_relayouting",n)}function o(e){null===X?null!==Z&&(e[y.id+".radialaxis.range["+a+"]"]=Z):e[y.id+".radialaxis.angle"]=X}function d(){null===X?null!==Z&&p.call("_guiRelayout",f,y.id+".radialaxis.range["+a+"]",Z):p.call("_guiRelayout",f,y.id+".radialaxis.angle",X)}function g(e,t){if(0!==a){var r=m+e,o=H+t;X=L(A-o,r-k),y.vangles&&(X=i(X,y.vangles)),X=F(X);var n=l(k,A)+s(-X);x["radial-axis"].attr("transform",n),x["radial-line"].select("line").attr("transform",n);var d=y.gd._fullLayout,c=d[y.id];y.updateRadialAxisTitle(d,c,X)}}function h(e,t){var r=u.dot([e,-t],[R(D),De(D)]);if(Z=V-U*r,0<U!=(a?Z>j:Z<B))return void(Z=null);var o=f._fullLayout,i=o[y.id];S.range[a]=Z,S._rl[a]=Z,y.updateRadialAxis(o,i),y.xaxis.setRange(),y.xaxis.setScale(),y.yaxis.setRange(),y.yaxis.setScale();var n=!1;for(var l in y.traceHash){var s=y.traceHash[l],d=u.filterVisible(s),c=s[0][0].trace._module;c.plot(f,y,d,i),p.traceIs(l,"gl")&&d.length&&(n=!0)}n&&(z(f),P(f))}var y=this,f=y.gd,x=y.layers,b=y.radius,v=y.innerRadius,k=y.cx,A=y.cy,S=y.radialAxis,C=O.radialDragBoxSize,I=C/2;if(S.visible){var D=_(y.radialAxisAngle),M=S._rl,j=M[0],B=M[1],V=M[a],U=.75*(M[1]-M[0])/(1-t.hole)/b,m,H,G;a?(m=k+(b+I)*R(D),H=A-(b+I)*De(D),G="radialdrag"):(m=k+(v-I)*R(D),H=A-(v-I)*De(D),G="radialdrag-inner");var q=w.makeRectDragger(x,G,"crosshair",-I,-I,C,C),Y={element:q,gd:f};n(c.select(q),S.visible&&v<b,{transform:l(m,H)});var W,X,Z;Y.prepFn=function(){W=null,X=null,Z=null,Y.moveFn=r,Y.doneFn=d,E(f)},Y.clampFn=function(e,t){return N(e*e+t*t)<O.MINDRAG&&(e=0,t=0),[e,t]},T.init(Y)}},B.updateAngularDrag=function(e){function t(e,t){return L(b+v-t,e-_-v)}function a(e,a){var o=i.gd._fullLayout,g=o[i.id],v=R+e,k=x+a,w=t(v,k),T=F(w-N);if(j=M+T,d.frontplot.attr("transform",l(i.xOffset2,i.yOffset2)+s([-T,_,b])),i.vangles){B=i.radialAxisAngle+T;var A=l(y,f)+s(-T),L=l(y,f)+s(-B);d.bg.attr("transform",A),d["radial-grid"].attr("transform",A),d["radial-axis"].attr("transform",L),d["radial-line"].select("line").attr("transform",L),i.updateRadialAxisTitle(o,g,B)}else i.clipPaths.forTraces.select("path").attr("transform",l(_,b)+s(T));C.each(function(){var e=c.select(this),t=m.getTranslate(e);e.attr("transform",l(t.x,t.y)+s([T]))}),D.each(function(){var e=c.select(this),t=e.select("text"),a=m.getTranslate(e);e.attr("transform",s([T,t.attr("x"),t.attr("y")])+l(a.x,a.y))}),h.rotation=u.modHalf(j,360),i.updateAngularAxis(o,g),i._hasClipOnAxisFalse&&!u.isFullCircle(i.sectorInRad)&&S.call(m.hideOutsideRangePoints,i);var E=!1;for(var I in i.traceHash)if(p.traceIs(I,"gl")){var O=i.traceHash[I],V=u.filterVisible(O),U=O[0][0].trace._module;U.plot(n,i,V,g),V.length&&(E=!0)}E&&(z(n),P(n));var H={};r(H),n.emit("plotly_relayouting",H)}function r(e){e[i.id+".angularaxis.rotation"]=j,i.vangles&&(e[i.id+".radialaxis.angle"]=B)}function o(){D.select("text").attr("transform",null);var e={};r(e),p.call("_guiRelayout",n,e)}var i=this,n=i.gd,d=i.layers,g=i.radius,h=i.angularAxis,y=i.cx,f=i.cy,_=i.cxx,b=i.cyy,v=O.angularDragBoxSize,k=w.makeDragger(d,"path","angulardrag","move"),A={element:k,gd:n};c.select(k).attr("d",i.pathAnnulus(g,g+v)).attr("transform",l(y,f)).call(I,"move");var S=d.frontplot.select(".scatterlayer").selectAll(".trace"),C=S.selectAll(".point"),D=S.selectAll(".textpoint"),R,x,M,j,B,N;A.prepFn=function(r,l,s){var d=e[i.id];M=d.angularaxis.rotation;var c=k.getBoundingClientRect();R=l-c.left,x=s-c.top,N=t(R,x),A.moveFn=a,A.doneFn=o,E(n)},i.vangles&&!u.isFullCircle(i.sectorInRad)&&(A.prepFn=u.noop,I(c.select(k),null)),T.init(A)},B.isPtInside=function(e){var t=this.sectorInRad,a=this.vangles,o=this.angularAxis.c2g(e.theta),i=this.radialAxis,n=i.c2l(e.r),r=i._rl,l=a?M.isPtInsidePolygon:u.isPtInsideSector;return l(n,o,r,t,a)},B.pathArc=function(e){var t=this.sectorInRad,a=this.vangles,r=a?M.pathPolygon:u.pathArc;return r(e,t[0],t[1],a)},B.pathSector=function(e){var t=this.sectorInRad,a=this.vangles,r=a?M.pathPolygon:u.pathSector;return r(e,t[0],t[1],a)},B.pathAnnulus=function(e,t){var a=this.sectorInRad,r=this.vangles,o=r?M.pathPolygonAnnulus:u.pathAnnulus;return o(e,t,a[0],a[1],r)},B.pathSubplot=function(){var e=this.innerRadius,t=this.radius;return e?this.pathAnnulus(e,t):this.pathSector(t)},B.fillViewInitialKey=function(e,t){e in this.viewInitial||(this.viewInitial[e]=t)}},{"../../components/color":593,"../../components/dragelement":611,"../../components/drawing":614,"../../components/fx":632,"../../components/titles":681,"../../constants/alignment":688,"../../lib":719,"../../lib/clear_gl_canvases":704,"../../lib/setcursor":739,"../../plot_api/subroutines":758,"../../plots/cartesian/axes":767,"../../registry":847,"../cartesian/autorange":766,"../cartesian/dragbox":775,"../cartesian/select":784,"../cartesian/set_convert":785,"../plots":828,"./constants":829,"./helpers":830,"./set_convert":841,d3:163,tinycolor2:537}],841:[function(e,t){"use strict";function a(e,t){var a=t._subplot;e.setGeometry=function(){var t=e._rl[0],r=e._rl[1],o=a.innerRadius,i=(a.radius-o)/(r-t),n=o/i,l=t>r?function(e){return 0>=e}:function(e){return 0<=e};e.c2g=function(a){var o=e.c2l(a)-t;return(l(o)?o:0)+n},e.g2c=function(a){return e.l2c(a+t-n)},e.g2p=function(e){return e*i},e.c2p=function(t){return e.g2p(e.c2g(t))}}}function r(e,t){return"degrees"===t?s(e):e}function o(e,t){return"degrees"===t?d(e):e}function i(e,t){var a=e.type;if("linear"===a){var i=e.d2c,l=e.c2d;e.d2c=function(e,t){return r(i(e),t)},e.c2d=function(e,t){return l(o(e,t))}}e.makeCalcdata=function(t,r){var o=t[r],l=t._length,s=function(a){return e.d2c(a,t.thetaunit)},d,c;if(o){if(n.isTypedArray(o)&&"linear"===a){if(l===o.length)return o;if(o.subarray)return o.subarray(0,l)}for(d=Array(l),c=0;c<l;c++)d[c]=s(o[c])}else{var p=r+"0",u="d"+r,g=p in t?s(t[p]):0,h=t[u]?s(t[u]):(e.period||2*Pe)/l;for(d=Array(l),c=0;c<l;c++)d[c]=g+c*h}return d},e.setGeometry=function(){var r=t.sector,o=r.map(s),i={clockwise:-1,counterclockwise:1}[e.direction],l=s(e.rotation),c=function(e){return i*e+l},p=function(e){return(e-l)/i},u,g,h,m;switch(a){case"linear":g=u=n.identity,m=s,h=d,e.range=n.isFullCircle(o)?[r[0],r[0]+360]:o.map(p).map(d);break;case"category":var y=e._categories.length,f=e.period?va(e.period,y):y;0===f&&(f=1),g=m=function(e){return 2*e*Pe/f},u=h=function(e){return e*f/Pe/2},e.range=[0,f];}e.c2g=function(e){return c(g(e))},e.g2c=function(e){return u(p(e))},e.t2g=function(e){return c(m(e))},e.g2t=function(e){return h(p(e))}}}var n=e("../../lib"),l=e("../cartesian/set_convert"),s=n.deg2rad,d=n.rad2deg;t.exports=function(e,t,r){switch(l(e,r),e._id){case"x":case"radialaxis":a(e,t);break;case"angularaxis":i(e,t);}}},{"../../lib":719,"../cartesian/set_convert":785}],842:[function(e,t){"use strict";var a=e("../lib"),r=e("../plot_api/plot_template"),o=e("./domain").defaults;t.exports=function(e,t,n,l){function s(e,t){return a.coerce(f,x,c,e,t)}for(var d=l.type,c=l.attributes,p=l.handleDefaults,u=l.partition||"x",g=t._subplots[d],h=g.length,m=h&&g[0].replace(/\d+$/,""),y=0,f,x,_;y<h;y++){_=g[y],f=e[_]?e[_]:e[_]={},x=r.newContainer(t,_,m),s("uirevision",t.uirevision);var b={};b[u]=[y/h,(y+1)/h],o(x,t,s,b),l.id=_,p(f,x,s,l)}}},{"../lib":719,"../plot_api/plot_template":757,"./domain":792}],843:[function(e,t,a){"use strict";var r=e("./ternary"),o=e("../../plots/get_data").getSubplotCalcData,i=e("../../lib").counterRegex,n="ternary";a.name=n;var l=a.attr="subplot";a.idRoot=n,a.idRegex=a.attrRegex=i(n);var s=a.attributes={};s[l]={valType:"subplotid",dflt:"ternary",editType:"calc"},a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.plot=function(e){for(var t=e._fullLayout,a=e.calcdata,l=t._subplots[n],s=0;s<l.length;s++){var d=l[s],c=o(a,n,d),p=t[d]._subplot;p||(p=new r({id:d,graphDiv:e,container:t._ternarylayer.node()},t),t[d]._subplot=p),p.plot(c,t,e._promises)}},a.clean=function(e,t,a,r){for(var o=r._subplots[n]||[],l=0;l<o.length;l++){var s=o[l],d=r[s]._subplot;t[s]||!d||(d.plotContainer.remove(),d.clipDef.remove(),d.clipDefRelative.remove(),d.layers["a-title"].remove(),d.layers["b-title"].remove(),d.layers["c-title"].remove())}}},{"../../lib":719,"../../plots/get_data":802,"./layout_attributes":844,"./layout_defaults":845,"./ternary":846}],844:[function(e,t){"use strict";var a=e("../../components/color/attributes"),r=e("../domain").attributes,o=e("../cartesian/layout_attributes"),i=e("../../plot_api/edit_types").overrideAll,n=e("../../lib/extend").extendFlat,l={title:o.title,color:o.color,tickmode:o.tickmode,nticks:n({},o.nticks,{dflt:6,min:1}),tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:o.ticks,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,showtickprefix:o.showtickprefix,tickprefix:o.tickprefix,showticksuffix:o.showticksuffix,ticksuffix:o.ticksuffix,showexponent:o.showexponent,exponentformat:o.exponentformat,separatethousands:o.separatethousands,tickfont:o.tickfont,tickangle:o.tickangle,tickformat:o.tickformat,tickformatstops:o.tickformatstops,hoverformat:o.hoverformat,showline:n({},o.showline,{dflt:!0}),linecolor:o.linecolor,linewidth:o.linewidth,showgrid:n({},o.showgrid,{dflt:!0}),gridcolor:o.gridcolor,gridwidth:o.gridwidth,layer:o.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:o._deprecated.title,titlefont:o._deprecated.titlefont}},s=t.exports=i({domain:r({name:"ternary"}),bgcolor:{valType:"color",dflt:a.background},sum:{valType:"number",dflt:1,min:0},aaxis:l,baxis:l,caxis:l},"plot","from-root");s.uirevision={valType:"any",editType:"none"},s.aaxis.uirevision=s.baxis.uirevision=s.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":592,"../../lib/extend":710,"../../plot_api/edit_types":750,"../cartesian/layout_attributes":779,"../domain":792}],845:[function(e,t){"use strict";function a(e,t,a,n){var l=a("bgcolor"),s=a("sum");n.bgColor=o.combine(l,n.paper_bgcolor);for(var d=0,c,p,u;d<g.length;d++)c=g[d],p=e[c]||{},u=i.newContainer(t,c),u._name=c,r(p,u,n,t);var h=t.aaxis,m=t.baxis,y=t.caxis;h.min+m.min+y.min>=s&&(h.min=0,m.min=0,y.min=0,e.aaxis&&delete e.aaxis.min,e.baxis&&delete e.baxis.min,e.caxis&&delete e.caxis.min)}function r(e,t,a,r){function o(a,r){return n.coerce(e,t,i,a,r)}var i=u[t._name];o("uirevision",r.uirevision),t.type="linear";var l=o("color"),g=l===i.color.dflt?a.font.color:l,h=t._name,m=h.charAt(0).toUpperCase(),y="Component "+m,f=o("title.text",y);t._hovertitle=f===y?f:m,n.coerceFont(o,"title.font",{family:a.font.family,size:V(1.2*a.font.size),color:g}),o("min"),c(e,t,o,"linear"),s(e,t,o,"linear",{}),d(e,t,o,{outerTicks:!0});var x=o("showticklabels");x&&(n.coerceFont(o,"tickfont",{family:a.font.family,size:a.font.size,color:g}),o("tickangle"),o("tickformat")),p(e,t,o,{dfltColor:l,bgColor:a.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:i}),o("hoverformat"),o("layer")}var o=e("../../components/color"),i=e("../../plot_api/plot_template"),n=e("../../lib"),l=e("../subplot_defaults"),s=e("../cartesian/tick_label_defaults"),d=e("../cartesian/tick_mark_defaults"),c=e("../cartesian/tick_value_defaults"),p=e("../cartesian/line_grid_defaults"),u=e("./layout_attributes"),g=["aaxis","baxis","caxis"];t.exports=function(e,t,r){l(e,t,r,{type:"ternary",attributes:u,handleDefaults:a,font:t.font,paper_bgcolor:t.paper_bgcolor})}},{"../../components/color":593,"../../lib":719,"../../plot_api/plot_template":757,"../cartesian/line_grid_defaults":781,"../cartesian/tick_label_defaults":786,"../cartesian/tick_mark_defaults":787,"../cartesian/tick_value_defaults":788,"../subplot_defaults":842,"./layout_attributes":844}],846:[function(e,t){"use strict";function a(e,t){this.id=e.id,this.graphDiv=e.graphDiv,this.init(t),this.makeFramework(t),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}function r(e){return e.ticks+(e.ticklen+"")+(e.showticklabels+"")}function o(e){i.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}var i=e("d3"),n=e("tinycolor2"),l=e("../../registry"),s=e("../../lib"),d=s._,c=e("../../components/color"),p=e("../../components/drawing"),u=e("../cartesian/set_convert"),g=e("../../lib/extend").extendFlat,h=e("../plots"),m=e("../cartesian/axes"),y=e("../../components/dragelement"),f=e("../../components/fx"),x=e("../../components/titles"),_=e("../cartesian/select").prepSelect,b=e("../cartesian/select").selectOnClick,v=e("../cartesian/select").clearSelect,k=e("../cartesian/constants");t.exports=a;var w=a.prototype;w.init=function(e){this.container=e._ternarylayer,this.defs=e._defs,this.layoutId=e._uid,this.traceHash={},this.layers={}},w.plot=function(e,t){var a=this,r=t[a.id],o=t._size;a._hasClipOnAxisFalse=!1;for(var n=0,l;n<e.length;n++)if(l=e[n][0].trace,!1===l.cliponaxis){a._hasClipOnAxisFalse=!0;break}a.updateLayers(r),a.adjustLayout(r,o),h.generalUpdatePerTraceModule(a.graphDiv,a,e,r),a.layers.plotbg.select("path").call(c.fill,r.bgcolor)},w.makeFramework=function(e){var t=this,a=t.graphDiv,r=e[t.id],o=t.clipId="clip"+t.layoutId+t.id,i=t.clipIdRelative="clip-relative"+t.layoutId+t.id;t.clipDef=s.ensureSingleById(e._clips,"clipPath",o,function(e){e.append("path").attr("d","M0,0Z")}),t.clipDefRelative=s.ensureSingleById(e._clips,"clipPath",i,function(e){e.append("path").attr("d","M0,0Z")}),t.plotContainer=s.ensureSingle(t.container,"g",t.id),t.updateLayers(r),p.setClipUrl(t.layers.backplot,o,a),p.setClipUrl(t.layers.grids,o,a)},w.updateLayers=function(e){var t=this,a=t.layers,r=["draglayer","plotbg","backplot","grids"];"below traces"===e.aaxis.layer&&r.push("aaxis","aline"),"below traces"===e.baxis.layer&&r.push("baxis","bline"),"below traces"===e.caxis.layer&&r.push("caxis","cline"),r.push("frontplot"),"above traces"===e.aaxis.layer&&r.push("aaxis","aline"),"above traces"===e.baxis.layer&&r.push("baxis","bline"),"above traces"===e.caxis.layer&&r.push("caxis","cline");var o=t.plotContainer.selectAll("g.toplevel").data(r,String),n=["agrid","bgrid","cgrid"];o.enter().append("g").attr("class",function(e){return"toplevel "+e}).each(function(e){var t=i.select(this);a[e]=t,"frontplot"===e?t.append("g").classed("scatterlayer",!0):"backplot"===e?t.append("g").classed("maplayer",!0):"plotbg"===e?t.append("path").attr("d","M0,0Z"):"aline"===e||"bline"===e||"cline"===e?t.append("path"):"grids"===e&&n.forEach(function(e){a[e]=t.append("g").classed("grid "+e,!0)})}),o.order()};var T=N(4/3);w.adjustLayout=function(e,t){var a=this,r=e.domain,o=(r.x[0]+r.x[1])/2,i=(r.y[0]+r.y[1])/2,n=r.x[1]-r.x[0],l=r.y[1]-r.y[0],s=n*t.w,d=l*t.h,m=e.sum,y=e.aaxis.min,f=e.baxis.min,x=e.caxis.min,_,b,v,k,A,S;s>T*d?(k=d,v=k*T):(v=s,k=v/T),A=n*v/s,S=l*k/d,_=t.l+t.w*o-v/2,b=t.t+t.h*(1-i)-k/2,a.x0=_,a.y0=b,a.w=v,a.h=k,a.sum=m,a.xaxis={type:"linear",range:[y+2*x-m,m-y-2*f],domain:[o-A/2,o+A/2],_id:"x"},u(a.xaxis,a.graphDiv._fullLayout),a.xaxis.setScale(),a.xaxis.isPtWithinRange=function(e){return e.a>=a.aaxis.range[0]&&e.a<=a.aaxis.range[1]&&e.b>=a.baxis.range[1]&&e.b<=a.baxis.range[0]&&e.c>=a.caxis.range[1]&&e.c<=a.caxis.range[0]},a.yaxis={type:"linear",range:[y,m-f-x],domain:[i-S/2,i+S/2],_id:"y"},u(a.yaxis,a.graphDiv._fullLayout),a.yaxis.setScale(),a.yaxis.isPtWithinRange=function(){return!0};var C=a.yaxis.domain[0],L=a.aaxis=g({},e.aaxis,{range:[y,m-f-x],side:"left",tickangle:(+e.aaxis.tickangle||0)-30,domain:[C,C+S*T],anchor:"free",position:0,_id:"y",_length:v});u(L,a.graphDiv._fullLayout),L.setScale();var E=a.baxis=g({},e.baxis,{range:[m-y-x,f],side:"bottom",domain:a.xaxis.domain,anchor:"free",position:0,_id:"x",_length:v});u(E,a.graphDiv._fullLayout),E.setScale();var I=a.caxis=g({},e.caxis,{range:[m-y-f,x],side:"right",tickangle:(+e.caxis.tickangle||0)+30,domain:[C,C+S*T],anchor:"free",position:0,_id:"y",_length:v});u(I,a.graphDiv._fullLayout),I.setScale();var z="M"+_+","+(b+k)+"h"+v+"l-"+v/2+",-"+k+"Z";a.clipDef.select("path").attr("d",z),a.layers.plotbg.select("path").attr("d",z);var P="M0,"+k+"h"+v+"l-"+v/2+",-"+k+"Z";a.clipDefRelative.select("path").attr("d",P);var D="translate("+_+","+b+")";a.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",D),a.clipDefRelative.select("path").attr("transform",null);var O="translate("+(_-E._offset)+","+(b+k)+")";a.layers.baxis.attr("transform",O),a.layers.bgrid.attr("transform",O);var R="translate("+(_+v/2)+","+b+")rotate(30)translate(0,"+-L._offset+")";a.layers.aaxis.attr("transform",R),a.layers.agrid.attr("transform",R);var M="translate("+(_+v/2)+","+b+")rotate(-30)translate(0,"+-I._offset+")";a.layers.caxis.attr("transform",M),a.layers.cgrid.attr("transform",M),a.drawAxes(!0),a.layers.aline.select("path").attr("d",L.showline?"M"+_+","+(b+k)+"l"+v/2+",-"+k:"M0,0").call(c.stroke,L.linecolor||"#000").style("stroke-width",(L.linewidth||0)+"px"),a.layers.bline.select("path").attr("d",E.showline?"M"+_+","+(b+k)+"h"+v:"M0,0").call(c.stroke,E.linecolor||"#000").style("stroke-width",(E.linewidth||0)+"px"),a.layers.cline.select("path").attr("d",I.showline?"M"+(_+v/2)+","+b+"l"+v/2+","+k:"M0,0").call(c.stroke,I.linecolor||"#000").style("stroke-width",(I.linewidth||0)+"px"),a.graphDiv._context.staticPlot||a.initInteractions(),p.setClipUrl(a.layers.frontplot,a._hasClipOnAxisFalse?null:a.clipId,a.graphDiv)},w.drawAxes=function(e){var t=this,a=t.graphDiv,r=t.id.substr(7)+"title",o=t.layers,i=t.aaxis,n=t.baxis,l=t.caxis;if(t.drawAx(i),t.drawAx(n),t.drawAx(l),e){var s=va(i.showticklabels?i.tickfont.size/2:0,(l.showticklabels?.75*l.tickfont.size:0)+("outside"===l.ticks?.87*l.ticklen:0)),c=(n.showticklabels?n.tickfont.size:0)+("outside"===n.ticks?n.ticklen:0)+3;o["a-title"]=x.draw(a,"a"+r,{propContainer:i,propName:t.id+".aaxis.title",placeholder:d(a,"Click to enter Component A title"),attributes:{x:t.x0+t.w/2,y:t.y0-i.title.font.size/3-s,"text-anchor":"middle"}}),o["b-title"]=x.draw(a,"b"+r,{propContainer:n,propName:t.id+".baxis.title",placeholder:d(a,"Click to enter Component B title"),attributes:{x:t.x0-c,y:t.y0+t.h+.83*n.title.font.size+c,"text-anchor":"middle"}}),o["c-title"]=x.draw(a,"c"+r,{propContainer:l,propName:t.id+".caxis.title",placeholder:d(a,"Click to enter Component C title"),attributes:{x:t.x0+t.w+c,y:t.y0+t.h+.83*l.title.font.size+c,"text-anchor":"middle"}})}},w.drawAx=function(e){var t=this,a=t.graphDiv,o=e._name,i=o.charAt(0),n=e._id,l=t.layers[o],d=30,c=i+"tickLayout",p=r(e);t[c]!==p&&(l.selectAll("."+n+"tick").remove(),t[c]=p),e.setScale();var u=m.calcTicks(e),g=m.clipEnds(e,u),y=m.makeTransFn(e),f=m.getTickSigns(e)[2],x=s.deg2rad(d),_=f*(e.linewidth||1)/2,b=f*e.ticklen,v=t.w,k=t.h,h="b"===i?"M0,"+_+"l"+De(x)*b+","+R(x)*b:"M"+_+",0l"+R(x)*b+","+-De(x)*b,w={a:"M0,0l"+k+",-"+v/2,b:"M0,0l-"+v/2+",-"+k,c:"M0,0l-"+k+","+v/2}[i];m.drawTicks(a,e,{vals:"inside"===e.ticks?g:u,layer:l,path:h,transFn:y,crisp:!1}),m.drawGrid(a,e,{vals:g,layer:t.layers[i+"grid"],path:w,transFn:y,crisp:!1}),m.drawLabels(a,e,{vals:u,layer:l,transFn:y,labelFns:m.makeLabelFns(e,0,d)})};var A=k.MINZOOM/2+.87,S=!0;w.initInteractions=function(){function e(e){var t={};return t[C.id+".aaxis.min"]=e.a,t[C.id+".baxis.min"]=e.b,t[C.id+".caxis.min"]=e.c,t}function t(t,a){var r=E._fullLayout.clickmode;o(E),2===t&&(E.emit("plotly_doubleclick",null),l.call("_guiRelayout",E,e({a:0,b:0,c:0}))),-1<r.indexOf("select")&&1===t&&b(a,E,[C.xaxis],[C.yaxis],C.id,z),-1<r.indexOf("event")&&f.click(E,a,C.id)}function a(t,e,a){var r=L.getBoundingClientRect();P=e-r.left,D=a-r.top,O={a:C.aaxis.range[0],b:C.baxis.range[1],c:C.caxis.range[1]},M=O,R=C.aaxis.range[1]-O.a,j=n(C.graphDiv._fullLayout[C.id].bgcolor).getLuminance(),F="M0,"+C.h+"L"+C.w/2+", 0L"+C.w+","+C.h+"Z",B=!1,V=I.append("path").attr("class","zoombox").attr("transform","translate("+C.x0+", "+C.y0+")").style({fill:.2<j?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",F),U=I.append("path").attr("class","zoombox-corners").attr("transform","translate("+C.x0+", "+C.y0+")").style({fill:c.background,stroke:c.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),v(E)}function r(e,t){return 1-t/C.h}function i(e,t){return 1-(e+(C.h-t)/N(3))/C.w}function u(e,t){return(e-(C.h-t)/N(3))/C.w}function g(t,a){var o=P+t,n=D+a,l=va(0,ea(1,r(P,D),r(o,n))),s=va(0,ea(1,i(P,D),i(o,n))),d=va(0,ea(1,u(P,D),u(o,n))),c=(l/2+d)*C.w,p=(1-l/2-s)*C.w,g=(c+p)/2,h=p-c,m=(1-l)*C.h,y=m-h/T;h<k.MINZOOM?(M=O,V.attr("d",F),U.attr("d","M0,0Z")):(M={a:O.a+l*R,b:O.b+s*R,c:O.c+d*R},V.attr("d",F+"M"+c+","+m+"H"+p+"L"+g+","+y+"L"+c+","+m+"Z"),U.attr("d","M"+P+","+D+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z"+"M"+c+","+m+("m-0.87,.5h"+A+"v3h-"+(A+5.2)+"l"+(A/2+2.6)+",-"+(.87*A+4.5)+"l2.6,1.5l-"+A/2+","+.87*A+"Z")+"M"+p+","+m+("m0.87,.5h-"+A+"v3h"+(A+5.2)+"l-"+(A/2+2.6)+",-"+(.87*A+4.5)+"l-2.6,1.5l"+A/2+","+.87*A+"Z")+"M"+g+","+y+("m0,1l"+A/2+","+.87*A+"l2.6,-1.5l-"+(A/2+2.6)+",-"+(.87*A+4.5)+"l-"+(A/2+2.6)+","+(.87*A+4.5)+"l2.6,1.5l"+A/2+",-"+.87*A+"Z"))),B||(V.transition().style("fill",.2<j?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),U.transition().style("opacity",1).duration(200),B=!0),E.emit("plotly_relayouting",e(M))}function h(){o(E);M===O||(l.call("_guiRelayout",E,e(M)),S&&E.data&&E._context.showTips&&(s.notifier(d(E,"Double-click to zoom back out"),"long"),S=!1))}function m(){O={a:C.aaxis.range[0],b:C.baxis.range[1],c:C.caxis.range[1]},M=O}function x(t,a){var r=t/C.xaxis._m,o=a/C.yaxis._m;M={a:O.a-o,b:O.b+(r+o)/2,c:O.c-(r-o)/2};var i=[M.a,M.b,M.c].sort(),n={a:i.indexOf(M.a),b:i.indexOf(M.b),c:i.indexOf(M.c)};0>i[0]&&(0>i[1]+i[0]/2?(i[2]+=i[0]+i[1],i[0]=i[1]=0):(i[2]+=i[0]/2,i[1]+=i[0]/2,i[0]=0),M={a:i[n.a],b:i[n.b],c:i[n.c]},a=(O.a-M.a)*C.yaxis._m,t=(O.c-M.c-O.b+M.b)*C.xaxis._m);var l="translate("+(C.x0+t)+","+(C.y0+a)+")";C.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",l);var s="translate("+-t+","+-a+")";C.clipDefRelative.select("path").attr("transform",s),C.aaxis.range=[M.a,C.sum-M.b-M.c],C.baxis.range=[C.sum-M.a-M.c,M.b],C.caxis.range=[C.sum-M.a-M.b,M.c],C.drawAxes(!1),C._hasClipOnAxisFalse&&C.plotContainer.select(".scatterlayer").selectAll(".trace").call(p.hideOutsideRangePoints,C),E.emit("plotly_relayouting",e(M))}function w(){l.call("_guiRelayout",E,e(M))}var C=this,L=C.layers.plotbg.select("path").node(),E=C.graphDiv,I=E._fullLayout._zoomlayer,z={element:L,gd:E,plotinfo:{id:C.id,xaxis:C.xaxis,yaxis:C.yaxis},subplot:C.id,prepFn:function(r,e,o){z.xaxes=[C.xaxis],z.yaxes=[C.yaxis];var i=E._fullLayout.dragmode;z.minDrag="lasso"===i?1:void 0,"zoom"===i?(z.moveFn=g,z.clickFn=t,z.doneFn=h,a(r,e,o)):"pan"===i?(z.moveFn=x,z.clickFn=t,z.doneFn=w,m(),v(E)):("select"===i||"lasso"===i)&&_(r,e,o,z,i)}},P,D,O,R,M,j,F,B,V,U;L.onmousemove=function(e){f.hover(E,e,C.id),E._fullLayout._lasthover=L,E._fullLayout._hoversubplot=C.id},L.onmouseout=function(e){E._dragging||y.unhover(E,e)},y.init(z)}},{"../../components/color":593,"../../components/dragelement":611,"../../components/drawing":614,"../../components/fx":632,"../../components/titles":681,"../../lib":719,"../../lib/extend":710,"../../registry":847,"../cartesian/axes":767,"../cartesian/constants":773,"../cartesian/select":784,"../cartesian/set_convert":785,"../plots":828,d3:163,tinycolor2:537}],847:[function(e,t,a){"use strict";function r(e){var t=e.name,r=e.categories,n=e.meta;if(a.modules[t])return void g.log("Type "+t+" already registered");a.subplotsRegistry[e.basePlotModule.name]||o(e.basePlotModule);for(var l={},s=0;s<r.length;s++)l[r[s]]=!0,a.allCategories[r[s]]=!0;for(var c in a.modules[t]={_module:e,categories:l},n&&Object.keys(n).length&&(a.modules[t].meta=n),a.allTypes.push(t),a.componentsRegistry)d(c,t);e.layoutAttributes&&v(a.traceLayoutAttributes,e.layoutAttributes);var p=e.basePlotModule,u=p.name;if("mapbox"===u){var h=p.constants.styleRules;for(var m in h)f(".js-plotly-plot .plotly .mapboxgl-"+m,h[m])}("geo"===u||"mapbox"===u)&&void 0!==typeof window&&void 0===window.PlotlyGeoAssets&&(window.PlotlyGeoAssets={topojson:{}})}function o(e){var t=e.name;if(a.subplotsRegistry[t])return void g.log("Plot type "+t+" already registered.");for(var r in s(e),a.subplotsRegistry[t]=e,a.componentsRegistry)p(r,e.name)}function i(e){if("string"!=typeof e.name)throw new Error("Component module *name* must be a string.");var t=e.name;for(var r in a.componentsRegistry[t]=e,e.layoutAttributes&&(e.layoutAttributes._isLinkedToArray&&m(a.layoutArrayContainers,t),s(e)),a.modules)d(t,r);for(var o in a.subplotsRegistry)p(t,o);for(var i in a.transformsRegistry)c(t,i);e.schema&&e.schema.layout&&k(b,e.schema.layout)}function n(e){if("string"!=typeof e.name)throw new Error("Transform module *name* must be a string.");var t="Transform module "+e.name,r="function"==typeof e.transform,o="function"==typeof e.calcTransform;if(!r&&!o)throw new Error(t+" is missing a *transform* or *calcTransform* method.");for(var i in r&&o&&g.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),y(e.attributes)||g.log(t+" registered without an *attributes* object."),"function"!=typeof e.supplyDefaults&&g.log(t+" registered without a *supplyDefaults* method."),a.transformsRegistry[e.name]=e,a.componentsRegistry)c(i,e.name)}function l(e){var t=e.name,r=t.split("-")[0],o=e.dictionary,i=e.format,n=o&&Object.keys(o).length,l=i&&Object.keys(i).length,s=a.localeRegistry,d=s[t];if(d||(s[t]=d={}),r!==t){var c=s[r];c||(s[r]=c={}),n&&c.dictionary===d.dictionary&&(c.dictionary=o),l&&c.format===d.format&&(c.format=i)}n&&(d.dictionary=o),l&&(d.format=i)}function s(e){if(e.layoutAttributes){var t=e.layoutAttributes._arrayAttrRegexps;if(t)for(var r=0;r<t.length;r++)m(a.layoutArrayRegexes,t[r])}}function d(e,t){var r=a.componentsRegistry[e].schema;if(r&&r.traces){var o=r.traces[t];o&&k(a.modules[t]._module.attributes,o)}}function c(e,t){var r=a.componentsRegistry[e].schema;if(r&&r.transforms){var o=r.transforms[t];o&&k(a.transformsRegistry[t].attributes,o)}}function p(e,t){var r=a.componentsRegistry[e].schema;if(r&&r.subplots){var o=a.subplotsRegistry[t],i=o.layoutAttributes,n="subplot"===o.attr?o.name:o.attr;Array.isArray(n)&&(n=n[0]);var l=r.subplots[n];i&&l&&k(i,l)}}function u(e){return"object"==typeof e&&(e=e.type),e}var g=e("./lib/loggers"),h=e("./lib/noop"),m=e("./lib/push_unique"),y=e("./lib/is_plain_object"),f=e("./lib/dom").addStyleRule,x=e("./lib/extend"),_=e("./plots/attributes"),b=e("./plots/layout_attributes"),v=x.extendFlat,k=x.extendDeepAll;a.modules={},a.allCategories={},a.allTypes=[],a.subplotsRegistry={},a.transformsRegistry={},a.componentsRegistry={},a.layoutArrayContainers=[],a.layoutArrayRegexes=[],a.traceLayoutAttributes={},a.localeRegistry={},a.apiMethodRegistry={},a.collectableSubplotTypes=null,a.register=function(e){if(a.collectableSubplotTypes=null,!e)throw new Error("No argument passed to Plotly.register.");else e&&!Array.isArray(e)&&(e=[e]);for(var t=0,o;t<e.length;t++){if(o=e[t],!o)throw new Error("Invalid module was attempted to be registered!");switch(o.moduleType){case"trace":r(o);break;case"transform":n(o);break;case"component":i(o);break;case"locale":l(o);break;case"apiMethod":var s=o.name;a.apiMethodRegistry[s]=o.fn;break;default:throw new Error("Invalid module was attempted to be registered!");}}},a.getModule=function(e){var t=a.modules[u(e)];return!!t&&t._module},a.traceIs=function(e,t){if(e=u(e),"various"===e)return!1;var r=a.modules[e];return r||(e&&"area"!==e&&g.log("Unrecognized trace type "+e+"."),r=a.modules[_.type.dflt]),!!r.categories[t]},a.getTransformIndices=function(e,t){for(var a=[],r=e.transforms||[],o=0;o<r.length;o++)r[o].type===t&&a.push(o);return a},a.hasTransform=function(e,t){for(var a=e.transforms||[],r=0;r<a.length;r++)if(a[r].type===t)return!0;return!1},a.getComponentMethod=function(e,t){var r=a.componentsRegistry[e];return r?r[t]||h:h},a.call=function(){var e=arguments[0],t=[].slice.call(arguments,1);return a.apiMethodRegistry[e].apply(null,t)}},{"./lib/dom":708,"./lib/extend":710,"./lib/is_plain_object":720,"./lib/loggers":723,"./lib/noop":728,"./lib/push_unique":733,"./plots/attributes":764,"./plots/layout_attributes":819}],848:[function(e,t){"use strict";function a(e){var t;return t="themes__thumb"===e?{autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]}:"thumbnail"===e?{title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]}:{},t}function r(e){return-1<["xaxis","yaxis","zaxis"].indexOf(e.slice(0,5))}var o=e("../registry"),i=e("../lib"),n=i.extendFlat,l=i.extendDeep;t.exports=function(e,t){e.framework&&e.framework.isPolar&&(e=e.framework.getConfig());var s=e.data,d=e.layout,c=l([],s),p=l({},d,a(t.tileClass)),u=e._context||{},g;if(t.width&&(p.width=t.width),t.height&&(p.height=t.height),"thumbnail"===t.tileClass||"themes__thumb"===t.tileClass){p.annotations=[];var h=Object.keys(p);for(g=0;g<h.length;g++)r(h[g])&&(p[h[g]].title={text:""});for(g=0;g<c.length;g++){var m=c[g];m.showscale=!1,m.marker&&(m.marker.showscale=!1),o.traceIs(m,"pie-like")&&(m.textposition="none")}}if(Array.isArray(t.annotations))for(g=0;g<t.annotations.length;g++)p.annotations.push(t.annotations[g]);var y=Object.keys(p).filter(function(e){return e.match(/^scene\d*$/)});if(y.length){var f={};for("thumbnail"===t.tileClass&&(f={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),g=0;g<y.length;g++){var x=p[y[g]];x.xaxis||(x.xaxis={}),x.yaxis||(x.yaxis={}),x.zaxis||(x.zaxis={}),n(x.xaxis,f),n(x.yaxis,f),n(x.zaxis,f),x._scene=null}}var _=document.createElement("div");t.tileClass&&(_.className=t.tileClass);var b={gd:_,td:_,layout:p,data:c,config:{staticPlot:void 0===t.staticPlot||t.staticPlot,plotGlPixelRatio:void 0===t.plotGlPixelRatio?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:u.mapboxAccessToken}};return"transparent"!==t.setBackground&&(b.config.setBackground=t.setBackground||"opaque"),b.gd.defaultLayout=a(t.tileClass),b}},{"../lib":719,"../registry":847}],849:[function(e,t){"use strict";var a=e("../lib"),r=e("../plot_api/to_image"),o=e("./filesaver"),i=e("./helpers");t.exports=function(e,t){var n;return a.isPlainObject(e)||(n=a.getGraphDiv(e)),t=t||{},t.format=t.format||"png",t.imageDataOnly=!0,new Promise(function(l,s){n&&n._snapshotInProgress&&s(new Error("Snapshotting already in progress.")),a.isIE()&&"svg"!==t.format&&s(new Error(i.MSG_IE_BAD_FORMAT)),n&&(n._snapshotInProgress=!0);var d=r(e,t),c=t.filename||e.fn||"newplot";c+="."+t.format,d.then(function(e){return n&&(n._snapshotInProgress=!1),o(e,c,t.format)}).then(function(e){l(e)}).catch(function(e){n&&(n._snapshotInProgress=!1),s(e)})})}},{"../lib":719,"../plot_api/to_image":760,"./filesaver":850,"./helpers":851}],850:[function(e,t){"use strict";function a(e,t,a){var i=document.createElement("a"),n="download"in i,l=/CyBrowser/.test(navigator.userAgent),s=new Promise(function(s,d){var c,p;if(r.isIE9orBelow()&&d(new Error("IE < 10 unsupported")),r.isSafari()){var u="svg"===a?",":";base64,";return o.octetStream(u+encodeURIComponent(e)),s(t)}return r.isIE()?(c=o.createBlob(e,"svg"),window.navigator.msSaveBlob(c,t),c=null,s(t)):(l&&(cybrowser.downloadFile(e,t),s(t)),n?(c=o.createBlob(e,a),p=o.createObjectURL(c),i.href=p,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),o.revokeObjectURL(p),c=null,s(t)):void d(new Error("download error")))});return s}var r=e("../lib"),o=e("./helpers");t.exports=a},{"../lib":719,"./helpers":851}],851:[function(e,t,a){"use strict";function r(e){for(var t=e.length,a=new ArrayBuffer(t),r=new Uint8Array(a),o=0;o<t;o++)r[o]=e.charCodeAt(o);return a}var o=e("../registry");a.getDelay=function(e){return e._has?e._has("gl3d")||e._has("gl2d")||e._has("mapbox")?500:0:0},a.getRedrawFunc=function(e){return function(){var t=e._fullLayout||{},a=t._has&&t._has("polar"),r=!a&&e.data&&e.data[0]&&e.data[0].r;r||o.getComponentMethod("colorbar","draw")(e)}},a.encodeSVG=function(e){return"data:image/svg+xml,"+encodeURIComponent(e)};var i=window.URL||window.webkitURL;a.createObjectURL=function(e){return i.createObjectURL(e)},a.revokeObjectURL=function(e){return i.revokeObjectURL(e)},a.createBlob=function(e,t){if("svg"===t)return new window.Blob([e],{type:"image/svg+xml;charset=utf-8"});var a=r(window.atob(e));return new window.Blob([a],{type:"image/"+t})},a.octetStream=function(e){document.location.href="data:application/octet-stream"+e},a.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,a.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":847}],852:[function(e,t){"use strict";var a=e("./helpers"),r={getDelay:a.getDelay,getRedrawFunc:a.getRedrawFunc,clone:e("./cloneplot"),toSVG:e("./tosvg"),svgToImg:e("./svgtoimg"),toImage:e("./toimage"),downloadImage:e("./download")};t.exports=r},{"./cloneplot":848,"./download":849,"./helpers":851,"./svgtoimg":853,"./toimage":854,"./tosvg":855}],853:[function(e,t){"use strict";var a=e("../lib"),r=e("events").EventEmitter,o=e("./helpers");t.exports=function(e){var t=e.emitter||new r,i=new Promise(function(r,n){var l=window.Image,s=e.svg,d=e.format||"png";if(a.isIE()&&"svg"!==d){var c=new Error(o.MSG_IE_BAD_FORMAT);return n(c),e.promise?i:t.emit("error",c)}var p=e.canvas,u=e.scale||1,g=e.width||300,h=e.height||150,m=u*g,y=u*h,f=p.getContext("2d"),x=new l,_,b;"svg"===d||a.isIE9orBelow()||a.isSafari()?b=o.encodeSVG(s):(_=o.createBlob(s,"svg"),b=o.createObjectURL(_)),p.width=m,p.height=y,x.onload=function(){var a;switch(_=null,o.revokeObjectURL(b),"svg"!==d&&f.drawImage(x,0,0,m,y),d){case"jpeg":a=p.toDataURL("image/jpeg");break;case"png":a=p.toDataURL("image/png");break;case"webp":a=p.toDataURL("image/webp");break;case"svg":a=b;break;default:var i="Image format is not jpeg, png, svg or webp.";if(n(new Error(i)),!e.promise)return t.emit("error",i);}r(a),e.promise||t.emit("success",a)},x.onerror=function(a){if(_=null,o.revokeObjectURL(b),n(a),!e.promise)return t.emit("error",a)},x.src=b});return e.promise?i:t}},{"../lib":719,"./helpers":851,events:104}],854:[function(e,t){"use strict";var a=e("events").EventEmitter,r=e("../registry"),o=e("../lib"),i=e("./helpers"),n=e("./cloneplot"),l=e("./tosvg"),s=e("./svgtoimg");t.exports=function(e,t){var d=new a,c=n(e,{format:"png"}),p=c.gd;p.style.position="absolute",p.style.left="-5000px",document.body.appendChild(p);var u=i.getRedrawFunc(p);return r.call("plot",p,c.data,c.layout,c.config).then(u).then(function(){var e=i.getDelay(p._fullLayout);setTimeout(function(){var e=l(p),a=document.createElement("canvas");a.id=o.randstr(),d=s({format:t.format,width:p._fullLayout.width,height:p._fullLayout.height,canvas:a,emitter:d,svg:e}),d.clean=function(){p&&document.body.removeChild(p)}},e)}).catch(function(e){d.emit("error",e)}),d}},{"../lib":719,"../registry":847,"./cloneplot":848,"./helpers":851,"./svgtoimg":853,"./tosvg":855,events:104}],855:[function(e,t){"use strict";function a(e){var t=o.select("body").append("div").style({display:"none"}).html(""),a=e.replace(/(&[^;]*;)/gi,function(e){return"&lt;"===e?"&#60;":"&rt;"===e?"&#62;":-1!==e.indexOf("<")||-1!==e.indexOf(">")?"":t.html(e).text()});return t.remove(),a}function r(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}var o=e("d3"),n=e("../lib"),l=e("../components/drawing"),d=e("../components/color"),c=e("../constants/xmlns_namespaces"),p=/"/g,u="TOBESTRIPPED",g=new RegExp("(\""+u+")|("+u+"\")","g");t.exports=function(e,t,h){var m=e._fullLayout,y=m._paper,f=m._toppaper,x=m.width,_=m.height,b;y.insert("rect",":first-child").call(l.setRect,0,0,x,_).call(d.fill,m.paper_bgcolor);var v=m._basePlotModules||[];for(b=0;b<v.length;b++){var k=v[b];k.toSVG&&k.toSVG(e)}if(f){var w=f.node().childNodes,T=Array.prototype.slice.call(w);for(b=0;b<T.length;b++){var A=T[b];A.childNodes.length&&y.node().appendChild(A)}}m._draggers&&m._draggers.remove(),y.node().style.background="",y.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var e=o.select(this);if("hidden"===this.style.visibility||"none"===this.style.display)return void e.remove();e.style({visibility:null,display:null});var t=this.style.fontFamily;t&&-1!==t.indexOf("\"")&&e.style("font-family",t.replace(p,u))}),y.selectAll(".point, .scatterpts, .legendfill>path, .legendlines>path, .cbfill").each(function(){var e=o.select(this),t=this.style.fill;t&&-1!==t.indexOf("url(")&&e.style("fill",t.replace(p,u));var a=this.style.stroke;a&&-1!==a.indexOf("url(")&&e.style("stroke",a.replace(p,u))}),("pdf"===t||"eps"===t)&&y.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),y.node().setAttributeNS(c.xmlns,"xmlns",c.svg),y.node().setAttributeNS(c.xmlns,"xmlns:xlink",c.xlink),"svg"===t&&h&&(y.attr("width",h*x),y.attr("height",h*_),y.attr("viewBox","0 0 "+x+" "+_));var S=new window.XMLSerializer().serializeToString(y.node());return S=a(S),S=r(S),S=S.replace(g,"'"),n.isIE()&&(S=S.replace(/"/gi,"'"),S=S.replace(/(\('#)([^']*)('\))/gi,"(\"#$2\")"),S=S.replace(/(\\')/gi,"\"")),S}},{"../components/color":593,"../components/drawing":614,"../constants/xmlns_namespaces":696,"../lib":719,d3:163}],856:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){for(var r=0;r<e.length;r++)e[r].i=r;a.mergeArray(t.text,e,"tx"),a.mergeArray(t.hovertext,e,"htx");var o=t.marker;if(o){a.mergeArray(o.opacity,e,"mo",!0),a.mergeArray(o.color,e,"mc");var n=o.line;n&&(a.mergeArray(n.color,e,"mlc"),a.mergeArrayCastPositive(n.width,e,"mlw"))}}},{"../../lib":719}],857:[function(e,t){"use strict";var a=e("../scatter/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("../../components/colorscale/attributes"),i=e("../../plots/font_attributes"),n=e("./constants.js"),l=e("../../lib/extend").extendFlat,s=i({editType:"calc",arrayOk:!0,colorEditType:"style"}),d=a.marker,c=d.line,p=l({},c.width,{dflt:0}),u=l({width:p,editType:"calc"},o("marker.line")),g=l({line:u,editType:"calc"},o("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"}});t.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:a.text,hovertext:a.hovertext,hovertemplate:r({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:l({},s,{}),insidetextfont:l({},s,{}),outsidetextfont:l({},s,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:l({},a.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:g,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,color:a.selected.marker.color,editType:"style"},textfont:a.selected.textfont,editType:"style"},unselected:{marker:{opacity:a.unselected.marker.opacity,color:a.unselected.marker.color,editType:"style"},textfont:a.unselected.textfont,editType:"style"},r:a.r,t:a.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/font_attributes":793,"../scatter/attributes":1112,"./constants.js":859}],858:[function(e,t){"use strict";var a=e("../../plots/cartesian/axes"),r=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/calc"),n=e("./arrays_to_calcdata"),l=e("../scatter/calc_selection");t.exports=function(e,t){var s=a.getFromId(e,t.xaxis||"x"),d=a.getFromId(e,t.yaxis||"y"),c,p;"h"===t.orientation?(c=s.makeCalcdata(t,"x"),p=d.makeCalcdata(t,"y")):(c=d.makeCalcdata(t,"y"),p=s.makeCalcdata(t,"x"));for(var u=ea(p.length,c.length),g=Array(u),h=0;h<u;h++)g[h]={p:p[h],s:c[h]},t.ids&&(g[h].id=t.ids[h]+"");return r(t,"marker")&&o(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),r(t,"marker.line")&&o(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),n(g,t),l(g,t),g}},{"../../components/colorscale/calc":601,"../../components/colorscale/helpers":604,"../../plots/cartesian/axes":767,"../scatter/calc_selection":1114,"./arrays_to_calcdata":856}],859:[function(e,t){"use strict";t.exports={eventDataKeys:[]}},{}],860:[function(e,t){"use strict";function a(e,t,a,s,d){if(s.length){var c,p,u,g,h;switch(r(a,s),d.mode){case"overlay":o(t,a,s,d);break;case"group":for(c=[],p=[],u=0;u<s.length;u++)g=s[u],h=g[0].trace,void 0===h.offset?p.push(g):c.push(g);p.length&&n(e,t,a,p,d),c.length&&o(t,a,c,d);break;case"stack":case"relative":for(c=[],p=[],u=0;u<s.length;u++)g=s[u],h=g[0].trace,void 0===h.base?p.push(g):c.push(g);p.length&&l(e,t,a,p,d),c.length&&o(t,a,c,d);}x(s,t)}}function r(e,t){var a,r;for(a=0;a<t.length;a++){var o=t[a],n=o[0].trace,l="funnel"===n.type?n._base:n.base,s="h"===n.orientation?n.xcalendar:n.ycalendar,d="category"===e.type||"multicategory"===e.type?function(){return null}:e.d2c,c;if(w(l)){for(r=0;r<ea(l.length,o.length);r++)c=d(l[r],0,s),k(c)?(o[r].b=+c,o[r].hasB=1):o[r].b=0;for(;r<o.length;r++)o[r].b=0}else{c=d(l,0,s);var p=k(c);for(c=p?c:0,r=0;r<o.length;r++)o[r].b=c,p&&(o[r].hasB=1)}}}function o(e,t,a,r){for(var o=0;o<a.length;o++){var n=a[o],l=new L([n],{sepNegVal:!1,overlapNoMerge:!r.norm});s(e,l,r),r.norm?(m(l),f(t,l,r)):g(t,l)}}function n(e,t,a,r,o){var i=new L(r,{sepNegVal:!1,overlapNoMerge:!o.norm});d(e,t,i,o),y(i),o.norm?(m(i),f(a,i,o)):g(a,i)}function l(e,t,a,r,o){var n=new L(r,{sepNegVal:"relative"===o.mode,overlapNoMerge:!(o.norm||"stack"===o.mode||"relative"===o.mode)});s(t,n,o),h(a,n,o);for(var l=0,d;l<r.length;l++){d=r[l];for(var c=0,p;c<d.length;c++)if(p=d[c],p.s!==T){var u=p.b+p.s===n.get(p.p,p.s);u&&(p._outmost=!0)}}o.norm&&f(a,n,o)}function s(e,a,r){for(var o=a.minDiff,n=a.traces,l=o*(1-r.gap),s=l*(1-(r.groupgap||0)),d=0;d<n.length;d++){var g=n[d],h=g[0].t;h.barwidth=s,h.poffset=-s/2,h.bargroupwidth=l,h.bardelta=o}a.binWidth=n[0][0].t.barwidth/100,c(a),p(e,a),u(e,a)}function d(e,a,r,o){for(var n=e._fullLayout,l=r.positions,s=r.distinctPositions,d=r.minDiff,g=r.traces,h=g.length,m=l.length!==s.length,y=d*(1-o.gap),f=C(n,a._id)+g[0][0].trace.orientation,x=n._alignmentOpts[f]||{},_=0;_<h;_++){var b=g[_],v=b[0].trace,k=x[v.alignmentgroup]||{},w=Object.keys(k.offsetGroups||{}).length,T;T=w?y/w:m?y/h:y;var A=T*(1-(o.groupgap||0)),S;S=w?((2*v._offsetIndex+1-w)*T-A)/2:m?((2*_+1-h)*T-A)/2:-A/2;var L=b[0].t;L.barwidth=A,L.poffset=S,L.bargroupwidth=y,L.bardelta=d}r.binWidth=g[0][0].t.barwidth/100,c(r),p(a,r),u(a,r,m)}function c(e){var a=e.traces,r,o;for(r=0;r<a.length;r++){var n=a[r],l=n[0],s=l.trace,d=l.t,t=s._offset||s.offset,c=d.poffset,p;if(w(t)){for(p=Array.prototype.slice.call(t,0,n.length),o=0;o<p.length;o++)k(p[o])||(p[o]=c);for(o=p.length;o<n.length;o++)p.push(c);d.poffset=p}else void 0!==t&&(d.poffset=t);var u=s._width||s.width,g=d.barwidth;if(w(u)){var h=Array.prototype.slice.call(u,0,n.length);for(o=0;o<h.length;o++)k(h[o])||(h[o]=g);for(o=h.length;o<n.length;o++)h.push(g);if(d.barwidth=h,void 0===t){for(p=[],o=0;o<n.length;o++)p.push(c+(g-h[o])/2);d.poffset=p}}else void 0!==u&&(d.barwidth=u,void 0===t&&(d.poffset=c+(g-u)/2))}}function p(e,a){for(var r=a.traces,o=_(e),n=0;n<r.length;n++)for(var l=r[n],s=l[0].t,t=s.poffset,d=Array.isArray(t),c=s.barwidth,p=Array.isArray(c),u=0;u<l.length;u++){var g=l[u],h=g.w=p?c[u]:c;g[o]=g.p+(d?t[u]:t)+h/2}}function u(e,a,o){var n=a.traces,s=a.minDiff,d=s/2;S.minDtick(e,a.minDiff,a.distinctPositions[0],o);for(var c=0;c<n.length;c++){var p=n[c],u=p[0],g=u.trace,h=[],m,y,f,x;for(x=0;x<p.length;x++)m=p[x],y=m.p-d,f=m.p+d,h.push(y,f);if(g.width||g.offset){var _=u.t,t=_.poffset,b=_.barwidth,v=Array.isArray(t),k=Array.isArray(b);for(x=0;x<p.length;x++){m=p[x];var w=v?t[x]:t,T=k?b[x]:b;y=m.p+w,f=y+T,h.push(y,f)}}g._extremes[e._id]=S.findExtremes(e,h,{padded:!1})}}function g(e,t){for(var a=t.traces,r=_(e),o=0;o<a.length;o++){for(var n=a[o],l=n[0].trace,s=[],d=!0,c=0;c<n.length;c++){var p=n[c],u=p.b,g=u+p.s;p[r]=g,s.push(g),p.hasB&&s.push(u),p.hasB&&0<p.b&&0<p.s||(d=!1)}l._extremes[e._id]=S.findExtremes(e,s,{tozero:!d,padded:!0})}}function h(e,t,a){var r=_(e),o=t.traces,n,l,s,d,c,p;for(d=0;d<o.length;d++)if(n=o[d],l=n[0].trace,"funnel"===l.type)for(c=0;c<n.length;c++)p=n[c],p.s!==T&&t.put(p.p,-.5*p.s);for(d=0;d<o.length;d++){n=o[d],l=n[0].trace,s="funnel"===l.type;var u=[];for(c=0;c<n.length;c++)if(p=n[c],p.s!==T){var g=s?p.s:p.s+p.b;var h=t.put(p.p,g),m=h+g;p.b=h,p[r]=m,a.norm||(u.push(m),p.hasB&&u.push(h))}a.norm||(l._extremes[e._id]=S.findExtremes(e,u,{tozero:!0,padded:!0}))}}function m(e){for(var t=e.traces,a=0,r;a<t.length;a++){r=t[a];for(var o=0,n;o<r.length;o++)n=r[o],n.s!==T&&e.put(n.p,n.b+n.s)}}function y(e){for(var t=e.traces,a=0;a<t.length;a++){var r=t[a],o=r[0].trace;if(o.base===void 0)for(var n=new L([r],{sepNegVal:!0,overlapNoMerge:!0}),l=0,s;l<r.length;l++)if(s=r[l],s.p!==T){var d=n.put(s.p,s.b+s.s);d&&(s.b=d)}}}function f(e,t,a){function r(t){return k(e.c2l(t))&&(t<d-s||t>c+s||!k(d))}for(var o=t.traces,n=_(e),l="fraction"===a.norm?1:100,s=l/1e9,d=e.l2c(e.c2l(0)),c="stack"===a.mode?l:d,p=0;p<o.length;p++){for(var u=o[p],g=u[0].trace,h=[],m=!0,y=!1,f=0,x;f<u.length;f++)if(x=u[f],x.s!==T){var b=_a(l/t.get(x.p,x.s));x.b*=b,x.s*=b;var v=x.b,w=v+x.s;x[n]=w,h.push(w),y=y||r(w),x.hasB&&(h.push(v),y=y||r(v)),x.hasB&&0<x.b&&0<x.s||(m=!1)}g._extremes[e._id]=S.findExtremes(e,h,{tozero:!m,padded:y})}}function x(e,t){var a=_(t),r={},o=1/0,n=-Infinity,l,s,d;for(l=0;l<e.length;l++)for(d=e[l],s=0;s<d.length;s++){var c=d[s].p;k(c)&&(o=ea(o,c),n=va(n,c))}var u=1e4/(n-o),g=r.round=function(e){return V(u*(e-o))+""};for(l=0;l<e.length;l++){d=e[l],d[0].t.extents=r;var h=d[0].t.poffset,m=Array.isArray(h);for(s=0;s<d.length;s++){var y=d[s],p=y[a]-y.w/2;if(k(p)){var f=y[a]+y.w/2,x=g(y.p);r[x]=r[x]?[ea(p,r[x][0]),va(f,r[x][1])]:[p,f]}y.p0=y.p+(m?h[s]:h),y.p1=y.p0+y.w,y.s0=y.b,y.s1=y.s0+y.s}}}function _(e){return e._id.charAt(0)}var k=e("fast-isnumeric"),w=e("../../lib").isArrayOrTypedArray,T=e("../../constants/numerical").BADNUM,A=e("../../registry"),S=e("../../plots/cartesian/axes"),C=e("../../plots/cartesian/axis_ids").getAxisGroup,L=e("./sieve.js");t.exports={crossTraceCalc:function(e,t){for(var r=t.xaxis,o=t.yaxis,n=e._fullLayout,l=e._fullData,s=e.calcdata,d=[],c=[],p=0,u;p<l.length;p++)u=l[p],!0===u.visible&&A.traceIs(u,"bar")&&u.xaxis===r._id&&u.yaxis===o._id&&("h"===u.orientation?d.push(s[p]):c.push(s[p]));var g={mode:n.barmode,norm:n.barnorm,gap:n.bargap,groupgap:n.bargroupgap};a(e,r,o,c,g),a(e,o,r,d,g)},setGroupPositions:a}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_ids":770,"../../registry":847,"./sieve.js":869,"fast-isnumeric":225}],861:[function(e,t){"use strict";function a(e,t,a,r){var o=t.orientation,i=t[{v:"x",h:"y"}[o]+"axis"],n=d(a,i)+o,l=a._alignmentOpts||{},s=r("alignmentgroup"),c=l[n];c||(c=l[n]={});var p=c[s];p?p.traces.push(t):p=c[s]={traces:[t],alignmentIndex:Object.keys(c).length,offsetGroups:{}};var u=r("offsetgroup"),g=p.offsetGroups,h=g[u];u&&(!h&&(h=g[u]={offsetIndex:Object.keys(g).length}),t._offsetIndex=h.offsetIndex)}function r(e,t,a,r,i,n){n=n||{};var l=!1!==n.moduleHasSelected,s=!1!==n.moduleHasUnselected,d=!1!==n.moduleHasConstrain,c=!1!==n.moduleHasCliponaxis,u=!1!==n.moduleHasTextangle,g=!1!==n.moduleHasInsideanchor,h=Array.isArray(i)||"auto"===i,m=h||"inside"===i,y=h||"outside"===i;if(m||y){var f=p(r,"textfont",a.font),x=o.extendFlat({},f),_=e.textfont&&e.textfont.color;!_&&delete x.color,p(r,"insidetextfont",x),y&&p(r,"outsidetextfont",f),l&&r("selected.textfont.color"),s&&r("unselected.textfont.color"),d&&r("constraintext"),c&&r("cliponaxis"),u&&r("textangle")}m&&g&&r("insidetextanchor")}var o=e("../../lib"),i=e("../../components/color"),n=e("../../registry"),l=e("../scatter/xy_defaults"),s=e("./style_defaults"),d=e("../../plots/cartesian/axis_ids").getAxisGroup,c=e("./attributes"),p=o.coerceFont;t.exports={supplyDefaults:function(e,t,a,d){function p(a,r){return o.coerce(e,t,c,a,r)}var u=l(e,t,d,p);if(!u)return void(t.visible=!1);p("orientation",t.x&&!t.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var g=p("textposition");r(e,t,d,p,g,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),s(e,t,p,a,d);var h=(t.marker.line||{}).color,m=n.getComponentMethod("errorbars","supplyDefaults");m(e,t,h||i.defaultLine,{axis:"y"}),m(e,t,h||i.defaultLine,{axis:"x",inherit:"y"}),o.coerceSelectionMarkerOpacity(t,p)},crossTraceDefaults:function(e,t){function r(e){return o.coerce(l._input,l,c,e)}var n,l;if("group"===t.barmode)for(var s=0;s<e.length;s++)l=e[s],"bar"===l.type&&(n=l._input,a(n,l,t,r))},handleGroupingDefaults:a,handleText:r}},{"../../components/color":593,"../../lib":719,"../../plots/cartesian/axis_ids":770,"../../registry":847,"../scatter/xy_defaults":1137,"./attributes":857,"./style_defaults":871}],862:[function(e,t,a){"use strict";var r=e("fast-isnumeric"),o=e("tinycolor2"),i=e("../../lib").isArrayOrTypedArray;a.coerceString=function(e,t,a){if("string"==typeof t){if(t||!e.noBlank)return t;}else if(("number"==typeof t||!0===t)&&!e.strict)return t+"";return a===void 0?e.dflt:a},a.coerceNumber=function(e,t,a){if(r(t)){t=+t;var o=e.min,i=e.max,n=o!==void 0&&t<o||i!==void 0&&t>i;if(!n)return t}return a===void 0?e.dflt:a},a.coerceColor=function(e,t,a){return o(t).isValid()?t:a===void 0?e.dflt:a},a.coerceEnumerated=function(e,t,a){return e.coerceNumber&&(t=+t),-1===e.values.indexOf(t)?void 0===a?e.dflt:a:t},a.getValue=function(e,t){var a;return Array.isArray(e)?t<e.length&&(a=e[t]):a=e,a},a.getLineWidth=function(e,t){var a=0<t.mlw?t.mlw:i(e.marker.line.width)?0:e.marker.line.width;return a}},{"../../lib":719,"fast-isnumeric":225,tinycolor2:537}],863:[function(e,t){"use strict";function a(e,a,r,i){function n(e){return e[T]-e.w/2}function s(e){return e[T]+e.w/2}function d(e,t){return o.inbox(e-k,t-k,x+ea(1,_a(t-e)/L)-1)}function c(e){return d(b(e),v(e))}function p(e){return d(n(e),s(e))}function u(e){var t=w,a=e.b,r=e[A];return f&&(r+=_a(e.rawS||0)),o.inbox(a-t,r-t,x+(r-t)/(r-a)-1)}function g(e){return(S(e)+C(e))/2}var h=e.cd,m=h[0].trace,y=h[0].t,t="closest"===i,f="waterfall"===m.type,x=e.maxHoverDistance,_=e.maxSpikeDistance,b=t?n:function(e){return ea(n(e),e.p-y.bardelta/2)},v=t?s:function(e){return va(s(e),e.p+y.bardelta/2)},k,w,T,A,S,C,L;"h"===m.orientation?(k=r,w=a,T="y",A="x",S=u,C=c):(k=a,w=r,T="x",A="y",C=u,S=c);var E=e[T+"a"],I=e[A+"a"];L=_a(E.r2c(E.range[1])-E.r2c(E.range[0]));var z=o.getDistanceFunction(i,S,C,g);if(o.getClosest(h,z,e),!1!==e.index){t||(b=function(e){return ea(n(e),e.p-y.bargroupwidth/2)},v=function(e){return va(s(e),e.p+y.bargroupwidth/2)});var P=e.index,D=h[P],O=m.base?D.b+D.s:D.s;e[A+"0"]=e[A+"1"]=I.c2p(D[A],!0),e[A+"LabelVal"]=O;var R=y.extents[y.extents.round(D.p)];return e[T+"0"]=E.c2p(t?b(D):R[0],!0),e[T+"1"]=E.c2p(t?v(D):R[1],!0),e[T+"LabelVal"]=D.p,e.spikeDistance=(u(D)+p(D))/2+_-x,e[T+"Spike"]=E.c2p(D.p,!0),l(D,m,e),e.hovertemplate=m.hovertemplate,e}}function r(e,t){var a=t.mcc||e.marker.color,r=t.mlcc||e.marker.line.color,o=s(e,t);if(n.opacity(a))return a;return n.opacity(r)&&o?r:void 0}var o=e("../../components/fx"),i=e("../../registry"),n=e("../../components/color"),l=e("../../lib").fillText,s=e("./helpers").getLineWidth;t.exports={hoverPoints:function(e,t,o,n){var l=a(e,t,o,n);if(l){var s=l.cd,d=s[0].trace,c=s[l.index];return l.color=r(d,c),i.getComponentMethod("errorbars","hoverInfo")(c,d,l),[l]}},hoverOnBars:a,getTraceColor:r}},{"../../components/color":593,"../../components/fx":632,"../../lib":719,"../../registry":847,"./helpers":862}],864:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,colorbar:e("../scatter/marker_colorbar"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select"),moduleType:"trace",name:"bar",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../scatter/marker_colorbar":1129,"./arrays_to_calcdata":856,"./attributes":857,"./calc":858,"./cross_trace_calc":860,"./defaults":861,"./hover":863,"./layout_attributes":865,"./layout_defaults":866,"./plot":867,"./select":868,"./style":870}],865:[function(e,t){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],866:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../plots/cartesian/axes"),o=e("../../lib"),i=e("./layout_attributes");t.exports=function(e,t,n){function l(a,r){return o.coerce(e,t,i,a,r)}for(var s=!1,d=!1,c=!1,p={},u=l("barmode"),g=0,h;g<n.length;g++){if(h=n[g],a.traceIs(h,"bar")&&h.visible)s=!0;else continue;if("group"===u){var m=h.xaxis+h.yaxis;p[m]&&(c=!0),p[m]=!0}if(h.visible&&"histogram"===h.type){var y=r.getFromId({_fullLayout:t},h["v"===h.orientation?"xaxis":"yaxis"]);"category"!==y.type&&(d=!0)}}return s?void("overlay"!==u&&l("barnorm"),l("bargap",d&&!c?0:.2),l("bargroupgap")):void delete t.barmode}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":847,"./layout_attributes":865}],867:[function(e,t){"use strict";function a(e,t){return e<t?1:-1}function r(e,t,a,r){var o=[],i=[],n=r?t:a,l=r?a:t;return o[0]=n.c2p(e.s0,!0),i[0]=l.c2p(e.p0,!0),o[1]=n.c2p(e.s1,!0),i[1]=l.c2p(e.p1,!0),r?[o,i]:[i,o]}function o(e,t,a,r,o,i,p,u,g,y){function x(t,a,r){var o=h.ensureSingle(t,"text").text(a).attr({class:"bartext bartext-"+S,transform:"","text-anchor":"middle","data-notex":1}).call(f.font,r).call(m.convertToTspans,e);return o}var _=t.xaxis,v=t.yaxis,k=e._fullLayout,w=r[0].trace,T="h"===w.orientation,A=d(r,o,_,v),S;S=c(w,o);var C="stack"===y.mode||"relative"===y.mode,L=r[o],E=!C||L._outmost;if(!A||"none"===S||(L.isBlank||i===p||u===g)&&("auto"===S||"inside"===S))return void a.select("text").remove();var I=k.font,z=b.getBarColor(r[o],w),P=b.getInsideTextFont(w,o,I,z),D=b.getOutsideTextFont(w,o,I),O=a.datum();T?"log"===_.type&&0>=O.s0&&(_.range[0]<_.range[1]?i=0:i=_._length):"log"===v.type&&0>=O.s0&&(v.range[0]<v.range[1]?u=v._length:u=0);var R=_a(p-i)-6,M=_a(g-u)-6,j,F,B,N;if("outside"!==S||E||L.hasB||(S="inside"),"auto"===S)if(E){S="inside",j=x(a,A,P),F=f.bBox(j.node()),B=F.width,N=F.height;var V=0<B&&0<N,U=B<=R&&N<=M,H=B<=M&&N<=R,G=T?R>=B*(M/N):M>=N*(R/B);V&&(U||H||G)?S="inside":(S="outside",j.remove(),j=null)}else S="inside";if(!j&&(j=x(a,A,"outside"===S?D:P),F=f.bBox(j.node()),B=F.width,N=F.height,0>=B||0>=N))return void j.remove();var q,Y;"outside"===S?(Y="both"===w.constraintext||"outside"===w.constraintext,q=s(l(i,p,u,g,F,{isHorizontal:T,constrained:Y,angle:w.textangle}))):(Y="both"===w.constraintext||"inside"===w.constraintext,q=s(n(i,p,u,g,F,{isHorizontal:T,constrained:Y,angle:w.textangle,anchor:w.insidetextanchor}))),j.attr("transform",q)}function i(e){return"auto"===e?0:e}function n(e,t,r,o,n,l){var s=!!l.isHorizontal,d=!!l.constrained,c=l.angle||0,p=l.anchor||0,u=n.width,g=n.height,h=_a(t-e),m=_a(o-r),y=6<h&&6<m?3:0;h-=2*y,m-=2*y;var f=!1;if("auto"===c&&!(u<=h&&g<=m)&&(u>h||g>m)&&(!(u>m||g>h)||u<g!=h<m)&&(f=!0),f){var x=m;m=h,h=x}var _=i(c),b=_a(De(Pe/180*_)),v=_a(R(Pe/180*_)),k=va(h*v,m*b),w=va(h*b,m*v),T=d?ea(k/u,w/g):va(v,b);T=ea(1,T);var A=(e+t)/2,S=(r+o)/2;if("middle"!==p){var C=T*(s===f?u:g),L=T*(s===f?g:u);y+=.5*(C*b+L*v),s?(y*=a(e,t),A="start"===p?e+y:t-y):(y*=a(r,o),S="start"===p?r+y:o-y)}var E=(n.left+n.right)/2,I=(n.top+n.bottom)/2;return f&&(_+=90),{textX:E,textY:I,targetX:A,targetY:S,scale:T,rotate:_}}function l(e,t,r,o,n,l){var s=!!l.isHorizontal,d=!!l.constrained,c=l.angle||0,p=n.width,u=n.height,g=_a(t-e),h=_a(o-r),m;m=s?6<h?3:0:6<g?3:0;var y=1;d&&(y=s?ea(1,h/u):ea(1,g/p));var f=i(c),x=_a(De(Pe/180*f)),_=_a(R(Pe/180*f)),b=y*(s?u:p),v=y*(s?p:u);m+=.5*(b*x+v*_);var k=(e+t)/2,w=(r+o)/2;s?k=t-m*a(t,e):w=o+m*a(r,o);var T=(n.left+n.right)/2,A=(n.top+n.bottom)/2;return{textX:T,textY:A,targetX:k,targetY:w,scale:y,rotate:f}}function s(e){var t=e.textX,a=e.textY,r=e.targetX,o=e.targetY,i=e.scale,n=e.rotate,l,s,d;1>i?l="scale("+i+") ":(i=1,l=""),s=n?"rotate("+n+" "+t+" "+a+") ":"";var c=r-i*t,p=o-i*a;return d="translate("+c+" "+p+")",d+l+s}function d(e,t,a,r){var o=e[0].trace,i;return i=o.textinfo?p(e,t,a,r):v.getValue(o.text,t),v.coerceString(w,i)}function c(e,t){var a=v.getValue(e.textposition,t);return v.coerceEnumerated(T,a)}function p(e,t,a,r){function o(e){var t=n?a:r;return _(t,+e,!0).text}var i=e[0].trace,n="h"===i.orientation,l="waterfall"===i.type,s="funnel"===i.type,d=i.textinfo,c=e[t],p=d.split("+"),u=[],g=function(e){return-1!==p.indexOf(e)},m;if(g("label")&&u.push(function(e){var t=n?r:a;return _(t,e,!0).text}(e[t].p)),g("text")&&(m=h.castOption(i,c.i,"text"),(0===m||m)&&u.push(m)),l){var y=+c.rawS||c.s,f=c.v;g("initial")&&u.push(o(f-y)),g("delta")&&u.push(o(y)),g("final")&&u.push(o(f))}if(s){g("value")&&u.push(o(c.s));var x=0;g("percent initial")&&x++,g("percent previous")&&x++,g("percent total")&&x++;var b=1<x;g("percent initial")&&(m=h.formatPercent(c.begR),b&&(m+=" of initial"),u.push(m)),g("percent previous")&&(m=h.formatPercent(c.difR),b&&(m+=" of previous"),u.push(m)),g("percent total")&&(m=h.formatPercent(c.sumR),b&&(m+=" of total"),u.push(m))}return u.join("<br>")}var u=e("d3"),g=e("fast-isnumeric"),h=e("../../lib"),m=e("../../lib/svg_text_utils"),y=e("../../components/color"),f=e("../../components/drawing"),x=e("../../registry"),_=e("../../plots/cartesian/axes").tickText,b=e("./style"),v=e("./helpers"),k=e("./attributes"),w=k.text,T=k.textposition;t.exports={plot:function(e,t,i,n,l){var s=t.xaxis,d=t.yaxis,c=e._fullLayout;l||(l={mode:c.barmode,norm:c.barmode,gap:c.bargap,groupgap:c.bargroupgap});var p=h.makeTraceGroups(n,i,"trace bars").each(function(n){var i=u.select(this),c=n[0].trace,p="waterfall"===c.type,m="funnel"===c.type,x="bar"===c.type,_=0;p&&c.connector.visible&&"between"===c.connector.mode&&(_=c.connector.line.width/2);var b="h"===c.orientation,k=h.ensureSingle(i,"g","points"),w=k.selectAll("g.point").data(h.identity);w.enter().append("g").classed("point",!0),w.exit().remove(),w.each(function(p,k){function i(e){return 0===l.gap&&0===l.groupgap?u.round(V(e)-O,2):e}function w(e,t){return 2<=_a(e-t)?i(e):e>t?M(e):ba(e)}var T=u.select(this),A=r(p,s,d,b),S=A[0][0],C=A[0][1],L=A[1][0],E=A[1][1],I=S===C||L===E||!g(S)||!g(C)||!g(L)||!g(E);I&&(x||m)&&v.getLineWidth(c,p)&&(b?0==C-S:0==E-L)&&(I=!1),p.isBlank=I,_&&(b?(S-=a(S,C)*_,C+=a(S,C)*_):(L-=a(L,E)*_,E+=a(L,E)*_));var z,P;if(!("waterfall"===c.type))z=v.getLineWidth(c,p),P=p.mc||c.marker.color;else if(!I){var D=c[p.dir].marker;z=D.line.width,P=D.color}var O=u.round(z/2%1,2);if(!e._context.staticPlot){var R=y.opacity(P),j=1>R||.01<z?i:w;S=j(S,C),C=j(C,S),L=j(L,E),E=j(E,L)}h.ensureSingle(T,"path").style("vector-effect","non-scaling-stroke").attr("d",I?"M0,0Z":"M"+S+","+L+"V"+E+"H"+C+"V"+L+"Z").call(f.setClipUrl,t.layerClipId,e),o(e,t,T,n,k,S,C,L,E,l),t.layerClipId&&f.hideOutsideRangePoint(p,T.select("text"),s,d,c.xcalendar,c.ycalendar)});var T=!1===c.cliponaxis;f.setClipUrl(i,T?null:t.layerClipId,e)});x.getComponentMethod("errorbars","plot")(e,p,t)},getTransform:s,toMoveInsideBar:n,toMoveOutsideBar:l}},{"../../components/color":593,"../../components/drawing":614,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../registry":847,"./attributes":857,"./helpers":862,"./style":870,d3:163,"fast-isnumeric":225}],868:[function(e,t){"use strict";function a(e,t,a,r,o){var i=t.c2p(r?e.s0:e.p0,!0),n=t.c2p(r?e.s1:e.p1,!0),l=a.c2p(r?e.p0:e.s0,!0),s=a.c2p(r?e.p1:e.s1,!0);return o?[(i+n)/2,(l+s)/2]:r?[n,(l+s)/2]:[(i+n)/2,s]}t.exports=function(e,t){var r=e.cd,o=e.xaxis,n=e.yaxis,l=r[0].trace,s="funnel"===l.type,d="h"===l.orientation,c=[],p;if(!1===t)for(p=0;p<r.length;p++)r[p].selected=0;else for(p=0;p<r.length;p++){var u=r[p],g="ct"in u?u.ct:a(u,o,n,d,s);t.contains(g,!1,p,e)?(c.push({pointNumber:p,x:o.c2d(u.x),y:n.c2d(u.y)}),u.selected=1):u.selected=0}return c}},{}],869:[function(e,t){"use strict";function a(e,t){this.traces=e,this.sepNegVal=t.sepNegVal,this.overlapNoMerge=t.overlapNoMerge;for(var a=1/0,n=[],l=0,s;l<e.length;l++){s=e[l];for(var d=0,c;d<s.length;d++)c=s[d],c.p!==o&&n.push(c.p);s[0]&&s[0].width1&&(a=ea(s[0].width1,a))}this.positions=n;var p=r(n);this.distinctPositions=p.vals,this.minDiff=1===p.vals.length&&a!==1/0?a:ea(p.minDiff,a),this.binWidth=this.minDiff,this.bins={}}t.exports=a;var r=e("../../lib").distinctVals,o=e("../../constants/numerical").BADNUM;a.prototype.put=function(e,t){var a=this.getLabel(e,t),r=this.bins[a]||0;return this.bins[a]=r+t,r},a.prototype.get=function(e,t){var a=this.getLabel(e,t);return this.bins[a]||0},a.prototype.getLabel=function(e,t){var a=0>t&&this.sepNegVal?"v":"^",r=this.overlapNoMerge?e:V(e/this.binWidth);return a+r}},{"../../constants/numerical":695,"../../lib":719}],870:[function(e,t){"use strict";function a(e,t,a){h.pointStyle(e.selectAll("path"),t,a),r(e,t,a)}function r(e,t,a){e.selectAll("text").each(function(e){var r=g.select(this),o=n(r,e,t,a);h.font(r,o)})}function o(e,t,a){h.selectedPointStyle(e.selectAll("path"),t),i(e.selectAll("text"),t,a)}function i(e,t,a){e.each(function(e){var r=g.select(this),o;if(e.selected){o=m.extendFlat({},n(r,e,t,a));var i=t.selected.textfont&&t.selected.textfont.color;i&&(o.color=i),h.font(r,o)}else h.selectedTextStyle(r,t)})}function n(e,t,a,r){var o=r._fullLayout.font,i=a.textfont;if(e.classed("bartext-inside")){var n=u(t,a);i=s(a,t.i,o,n)}else e.classed("bartext-outside")&&(i=c(a,t.i,o));return i}function l(e,t,a){return p(x,e.textfont,t,a)}function s(e,t,a,r){var o=l(e,t,a),i=void 0===e._input.textfont||void 0===e._input.textfont.color||Array.isArray(e.textfont.color)&&void 0===e.textfont.color[t];return i&&(o={color:d.contrast(r),family:o.family,size:o.size}),p(_,e.insidetextfont,t,o)}function c(e,t,a){var r=l(e,t,a);return p(b,e.outsidetextfont,t,r)}function p(e,t,a,r){t=t||{};var o=v.getValue(t.family,a),i=v.getValue(t.size,a),n=v.getValue(t.color,a);return{family:v.coerceString(e.family,o,r.family),size:v.coerceNumber(e.size,i,r.size),color:v.coerceColor(e.color,n,r.color)}}function u(e,t){return"waterfall"===t.type?t[e.dir].marker.color:e.mc||t.marker.color}var g=e("d3"),d=e("../../components/color"),h=e("../../components/drawing"),m=e("../../lib"),y=e("../../registry"),f=e("./attributes"),x=f.textfont,_=f.insidetextfont,b=f.outsidetextfont,v=e("./helpers");t.exports={style:function(e){var t=g.select(e).selectAll("g.barlayer").selectAll("g.trace"),r=t.size(),o=e._fullLayout;t.style("opacity",function(e){return e[0].trace.opacity}).each(function(e){("stack"===o.barmode&&1<r||0===o.bargap&&0===o.bargroupgap&&!e[0].trace.marker.line.width)&&g.select(this).attr("shape-rendering","crispEdges")}),t.selectAll("g.points").each(function(t){var r=g.select(this),o=t[0].trace;a(r,o,e)}),y.getComponentMethod("errorbars","style")(t)},styleTextPoints:r,styleOnSelect:function(e,t,r){var i=t[0].trace;i.selectedpoints?o(r,i,e):(a(r,i,e),y.getComponentMethod("errorbars","style")(r))},getInsideTextFont:s,getOutsideTextFont:c,getBarColor:u}},{"../../components/color":593,"../../components/drawing":614,"../../lib":719,"../../registry":847,"./attributes":857,"./helpers":862,d3:163}],871:[function(e,t){"use strict";var a=e("../../components/color"),r=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/defaults");t.exports=function(e,t,i,n,l){i("marker.color",n),r(e,"marker")&&o(e,t,l,i,{prefix:"marker.",cLetter:"c"}),i("marker.line.color",a.defaultLine),r(e,"marker.line")&&o(e,t,l,i,{prefix:"marker.line.",cLetter:"c"}),i("marker.line.width"),i("marker.opacity"),i("selected.marker.color"),i("unselected.marker.color")}},{"../../components/color":593,"../../components/colorscale/defaults":603,"../../components/colorscale/helpers":604}],872:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),r=e("../../lib/extend").extendFlat,o=e("../scatterpolar/attributes"),i=e("../bar/attributes");t.exports={r:o.r,theta:o.theta,r0:o.r0,dr:o.dr,theta0:o.theta0,dtheta:o.dtheta,thetaunit:o.thetaunit,base:r({},i.base,{}),offset:r({},i.offset,{}),width:r({},i.width,{}),text:r({},i.text,{}),hovertext:r({},i.hovertext,{}),marker:i.marker,hoverinfo:o.hoverinfo,hovertemplate:a(),selected:i.selected,unselected:i.unselected}},{"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../bar/attributes":857,"../scatterpolar/attributes":1179}],873:[function(e,t){"use strict";var a=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/calc"),o=e("../bar/arrays_to_calcdata"),n=e("../bar/cross_trace_calc").setGroupPositions,l=e("../scatter/calc_selection"),s=e("../../registry").traceIs,d=e("../../lib").extendFlat;t.exports={calc:function(e,t){function n(e){var a=t[e];void 0!==a&&(t["_"+e]=Array.isArray(a)?p.makeCalcdata(t,e):p.d2c(a,t.thetaunit))}for(var s=e._fullLayout,d=t.subplot,c=s[d].radialaxis,p=s[d].angularaxis,u=c.makeCalcdata(t,"r"),g=p.makeCalcdata(t,"theta"),h=t._length,m=Array(h),y=0;y<h;y++)m[y]={p:g[y],s:u[y]};return"linear"===p.type&&(n("width"),n("offset")),a(t,"marker")&&r(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),a(t,"marker.line")&&r(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),o(m,t),l(m,t),m},crossTraceCalc:function(e,t,a){for(var r=e.calcdata,o=[],l=0;l<r.length;l++){var c=r[l],p=c[0].trace;!0===p.visible&&s(p,"bar")&&p.subplot===a&&o.push(c)}var u=d({},t.radialaxis,{_id:"x"}),g=t.angularaxis;n(e,g,u,o,{mode:t.barmode,norm:t.barnorm,gap:t.bargap,groupgap:t.bargroupgap})}}},{"../../components/colorscale/calc":601,"../../components/colorscale/helpers":604,"../../lib":719,"../../registry":847,"../bar/arrays_to_calcdata":856,"../bar/cross_trace_calc":860,"../scatter/calc_selection":1114}],874:[function(e,t){"use strict";var a=e("../../lib"),r=e("../scatterpolar/defaults").handleRThetaDefaults,o=e("../bar/style_defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(r,o){return a.coerce(e,t,i,r,o)}var d=r(e,t,l,s);return d?void(s("thetaunit"),s("base"),s("offset"),s("width"),s("text"),s("hovertext"),s("hovertemplate"),o(e,t,s,n,l),a.coerceSelectionMarkerOpacity(t,s)):void(t.visible=!1)}},{"../../lib":719,"../bar/style_defaults":871,"../scatterpolar/defaults":1181,"./attributes":872}],875:[function(e,t){"use strict";var a=e("../../components/fx"),r=e("../../lib"),o=e("../bar/hover").getTraceColor,i=r.fillText,n=e("../scatterpolar/hover").makeHoverPointText,l=e("../../plots/polar/helpers").isPtInsidePolygon;t.exports=function(e,t,s){var d=e.cd,c=d[0].trace,p=e.subplot,u=p.radialAxis,g=p.angularAxis,h=p.vangles,m=h?l:r.isPtInsideSector,y=e.maxHoverDistance,f=g._period||2*Pe,x=_a(u.g2p(N(t*t+s*s))),_=L(s,t);u.range[0]>u.range[1]&&(_+=Pe);var b=function(e){return m(x,_,[e.rp0,e.rp1],[e.thetag0,e.thetag1],h)?y+ea(1,_a(e.thetag1-e.thetag0)/f)-1+(e.rp1-x)/(e.rp1-e.rp0)-1:1/0};if(a.getClosest(d,b,e),!1!==e.index){var v=e.index,k=d[v];e.x0=e.x1=k.ct[0],e.y0=e.y1=k.ct[1];var w=r.extendFlat({},k,{r:k.s,theta:k.p});return i(k,c,e),n(w,c,p,e),e.hovertemplate=c.hovertemplate,e.color=o(c,k),e.xLabelVal=e.yLabelVal=void 0,0>k.s&&(e.idealAlign="left"),[e]}}},{"../../components/fx":632,"../../lib":719,"../../plots/polar/helpers":830,"../bar/hover":863,"../scatterpolar/hover":1182}],876:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"barpolar",basePlotModule:e("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),colorbar:e("../scatter/marker_colorbar"),style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../bar/select"),meta:{}}},{"../../plots/polar":831,"../bar/select":868,"../bar/style":870,"../scatter/marker_colorbar":1129,"./attributes":872,"./calc":873,"./defaults":874,"./hover":875,"./layout_attributes":877,"./layout_defaults":878,"./plot":879}],877:[function(e,t){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],878:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t,o){function n(o,i){return a.coerce(e[d]||{},t[d],r,o,i)}for(var l={},s=0,d,c;s<o.length;s++)c=o[s],"barpolar"===c.type&&!0===c.visible&&(d=c.subplot,!l[d]&&(n("barmode"),n("bargap"),l[d]=1))}},{"../../lib":719,"./layout_attributes":877}],879:[function(e,t){"use strict";function a(e){var t=e.cxx,a=e.cyy;return e.vangles?function(r,o,n,s){var d,c;0<i.angleDelta(n,s)?(d=n,c=s):(d=s,c=n);var p=l.findEnclosingVertexAngles(d,e.vangles)[0],u=l.findEnclosingVertexAngles(c,e.vangles)[1],g=[p,(d+c)/2,u];return l.pathPolygonAnnulus(r,o,d,c,g,t,a)}:function(e,r,o,n){return i.pathAnnulus(e,r,o,n,t,a)}}var r=e("d3"),o=e("fast-isnumeric"),i=e("../../lib"),n=e("../../components/drawing"),l=e("../../plots/polar/helpers");t.exports=function(e,t,l){var s=t.xaxis,d=t.yaxis,c=t.radialAxis,p=t.angularAxis,u=a(t),g=t.layers.frontplot.select("g.barlayer");i.makeTraceGroups(g,l,"trace bars").each(function(){var a=r.select(this),l=i.ensureSingle(a,"g","points"),g=l.selectAll("g.point").data(i.identity);g.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),g.exit().remove(),g.each(function(e){var t=r.select(this),a=e.rp0=c.c2p(e.s0),n=e.rp1=c.c2p(e.s1),l=e.thetag0=p.c2g(e.p0),g=e.thetag1=p.c2g(e.p1),h;if(!o(a)||!o(n)||!o(l)||!o(g)||a===n||l===g)h="M0,0Z";else{var m=c.c2g(e.s1),y=(l+g)/2;e.ct=[s.c2p(m*R(y)),d.c2p(m*De(y))],h=u(a,n,l,g)}i.ensureSingle(t,"path").attr("d",h)}),n.setClipUrl(a,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,e)})}},{"../../components/drawing":614,"../../lib":719,"../../plots/polar/helpers":830,d3:163,"fast-isnumeric":225}],880:[function(e,t){"use strict";var a=e("../scatter/attributes"),r=e("../bar/attributes"),o=e("../../components/color/attributes"),i=e("../../components/fx/hovertemplate_attributes"),n=e("../../lib/extend").extendFlat,l=a.marker,s=l.line;t.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},name:{valType:"string",editType:"calc+clearAxisTypes"},text:n({},a.text,{}),hovertext:n({},a.hovertext,{}),hovertemplate:i({}),whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],dflt:"outliers",editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],dflt:!1,editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:n({},l.symbol,{arrayOk:!1,editType:"plot"}),opacity:n({},l.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:n({},l.size,{arrayOk:!1,editType:"calc"}),color:n({},l.color,{arrayOk:!1,editType:"style"}),line:{color:n({},s.color,{arrayOk:!1,dflt:o.defaultLine,editType:"style"}),width:n({},s.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,offsetgroup:r.offsetgroup,alignmentgroup:r.alignmentgroup,selected:{marker:a.selected.marker,editType:"style"},unselected:{marker:a.unselected.marker,editType:"style"},hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":592,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../bar/attributes":857,"../scatter/attributes":1112}],881:[function(e,t){"use strict";function a(e,t,a,r,o){if(t in e)return a.makeCalcdata(e,t);var i=t+"0"in e?e[t+"0"]:"name"in e&&("category"===a.type||p(e.name)&&-1!==["linear","log"].indexOf(a.type)||u.isDateTime(e.name)&&"date"===a.type)?e.name:o;var n="multicategory"===a.type?a.r2c_just_indices(i):a.d2c(i,0,e[t+"calendar"]);return r.map(function(){return n})}function r(e,t){for(var a=e.length,r=Array(a+1),o=0;o<a;o++)r[o]=e[o]-t;return r[a]=e[a-1]+t,r}function o(e){for(var t=Array(e),a=0;a<e;a++)t[a]=[];return t}function l(e,t,a){var r={text:"tx",hovertext:"htx"};for(var o in r)Array.isArray(t[o])&&(e[r[o]]=t[o][a])}function s(e,t){if(u.isArrayOrTypedArray(t.selectedpoints))for(var a=0;a<e.length;a++){for(var r=e[a].pts||[],o={},n=0;n<r.length;n++)o[r[n].i]=n;u.tagSelected(r,t,o)}}function d(e,t){return e.v-t.v}function c(e){return e.v}var p=e("fast-isnumeric"),u=e("../../lib"),g=u._,h=e("../../plots/cartesian/axes");t.exports=function(e,t){var m=e._fullLayout,y=h.getFromId(e,t.xaxis||"x"),f=h.getFromId(e,t.yaxis||"y"),x=[],_="violin"===t.type?"_numViolins":"_numBoxes",b,k,w,T,A;"h"===t.orientation?(k=y,w="x",T=f,A="y"):(k=f,w="y",T=y,A="x");var S=k.makeCalcdata(t,w),C=a(t,A,T,S,m[_]),L=u.distinctVals(C),E=L.vals,I=L.minDiff/2,z=r(E,I),P=E.length,D=o(P);for(b=0;b<t._length;b++){var O=S[b];if(p(O)){var v=u.findBin(C[b],z);if(0<=v&&v<P){var n={v:O,i:b};l(n,t,b),D[v].push(n)}}}var R="all"===(t.boxpoints||t.points)?u.identity:function(e){return e.v<M.lf||e.v>M.uf},M;for(b=0;b<P;b++)if(0<D[b].length){var j=D[b].sort(d),F=j.map(c),B=F.length;M={},M.pos=E[b],M.pts=j,M[A]=M.pos,M[w]=M.pts.map(function(e){return e.v}),M.min=F[0],M.max=F[B-1],M.mean=u.mean(F,B),M.sd=u.stdev(F,B,M.mean),M.q1=u.interp(F,.25),M.med=u.interp(F,.5),M.q3=u.interp(F,.75),M.lf=ea(M.q1,F[ea(u.findBin(2.5*M.q1-1.5*M.q3,F,!0)+1,B-1)]),M.uf=va(M.q3,F[va(u.findBin(2.5*M.q3-1.5*M.q1,F),0)]),M.lo=4*M.q1-3*M.q3,M.uo=4*M.q3-3*M.q1;var V=M.q3-M.q1,U=1.57*V/N(B);M.ln=M.med-U,M.un=M.med+U,M.pts2=j.filter(R),x.push(M)}s(x,t);var H=h.findExtremes(k,S,{padded:!0});return t._extremes[k._id]=H,0<x.length?(x[0].t={num:m[_],dPos:I,posLetter:A,valLetter:w,labels:{med:g(e,"median:"),min:g(e,"min:"),q1:g(e,"q1:"),q3:g(e,"q3:"),max:g(e,"max:"),mean:"sd"===t.boxmean?g(e,"mean \xB1 \u03C3:"):g(e,"mean:"),lf:g(e,"lower fence:"),uf:g(e,"upper fence:")}},m[_]++,x):[{t:{empty:!0}}]}},{"../../lib":719,"../../plots/cartesian/axes":767,"fast-isnumeric":225}],882:[function(e,t){"use strict";function a(e,a,n,l){var s=a.calcdata,d=a._fullLayout,c=l._id,p=c.charAt(0),u=[],g=0,h,m,y;for(h=0;h<n.length;h++)for(y=s[n[h]],m=0;m<y.length;m++)u.push(y[m].pos),g+=(y[m].pts2||[]).length;if(u.length){var f=o.distinctVals(u),x=f.minDiff/2;r.minDtick(l,f.minDiff,f.vals[0],!0);var _="violin"===e?"_numViolins":"_numBoxes",b=d[_],v="group"===d[e+"mode"]&&1<b,k=1-d[e+"gap"],w=1-d[e+"groupgap"];for(h=0;h<n.length;h++){y=s[n[h]];var T=y[0].trace,A=y[0].t,t=T.width,S=T.side,C,L,E,I;if(t)C=L=I=t/2,E=0;else if(C=x,v){var z=i(d,l._id)+T.orientation,P=d._alignmentOpts[z]||{},D=P[T.alignmentgroup]||{},O=Object.keys(D.offsetGroups||{}).length,R=O||b,M=O?T._offsetIndex:A.num;L=C*k*w/R,E=2*C*(-.5+(M+.5)/R)*k,I=C*k/R}else L=C*k*w,E=0,I=C;A.dPos=C,A.bPos=E,A.bdPos=L,A.wHover=I;var F=E+L,B=!!t,N=(T.boxpoints||T.points)&&0<g,V,U,H,G,q,Y,W,X;if("positive"===S?(V=C*(t?1:.5),H=F,U=H=E):"negative"===S?(V=H=E,U=C*(t?1:.5),G=F):(V=U=C,H=G=F),N){var Z=T.pointpos,K=T.jitter,J=T.marker.size/2,Q=0;0<=Z+K&&(Q=F*(Z+K),Q>V?(B=!0,W=J,q=Q):Q>H&&(W=J,q=V)),Q<=V&&(q=V);var $=0;0>=Z-K&&($=-F*(Z-K),$>U?(B=!0,X=J,Y=$):$>G&&(X=J,Y=U)),$<=U&&(Y=U)}else q=V,Y=U;var ee=Array(y.length);for(m=0;m<y.length;m++)ee[m]=y[m].pos;T._extremes[c]=r.findExtremes(l,ee,{padded:B,vpadminus:Y,vpadplus:q,ppadminus:{x:X,y:W}[p],ppadplus:{x:W,y:X}[p]})}}}var r=e("../../plots/cartesian/axes"),o=e("../../lib"),i=e("../../plots/cartesian/axis_ids").getAxisGroup,n=["v","h"];t.exports={crossTraceCalc:function(e,r){for(var o=e.calcdata,l=r.xaxis,s=r.yaxis,d=0;d<n.length;d++){for(var c=n[d],p="h"===c?s:l,u=[],g=0;g<o.length;g++){var h=o[g],m=h[0].t,t=h[0].trace;!0!==t.visible||"box"!==t.type&&"candlestick"!==t.type||m.empty||(t.orientation||"v")!==c||t.xaxis!==l._id||t.yaxis!==s._id||u.push(g)}a("box",e,u,p)}},setPositionOffset:a}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_ids":770}],883:[function(e,t){"use strict";function a(e,t,a,r){var n=a("y"),l=a("x"),s=l&&l.length,d,c;if(n&&n.length)d="v",s?c=ea(o.minRowLength(l),o.minRowLength(n)):(a("x0"),c=o.minRowLength(n));else if(s)d="h",a("y0"),c=o.minRowLength(l);else return void(t.visible=!1);t._length=c;var p=i.getComponentMethod("calendars","handleTraceDefaults");p(e,t,["x","y"],r),a("orientation",d)}function r(e,t,a,r){var i=r.prefix,n=o.coerce2(e,t,s,"marker.outliercolor"),l=a("marker.line.outliercolor"),d=a(i+"points",n||l?"suspectedoutliers":void 0);d?(a("jitter","all"===d?.3:0),a("pointpos","all"===d?-1.5:0),a("marker.symbol"),a("marker.opacity"),a("marker.size"),a("marker.color",t.line.color),a("marker.line.color"),a("marker.line.width"),"suspectedoutliers"===d&&(a("marker.line.outliercolor",t.marker.color),a("marker.line.outlierwidth")),a("selected.marker.color"),a("unselected.marker.color"),a("selected.marker.size"),a("unselected.marker.size"),a("text"),a("hovertext")):delete t.marker;var c=a("hoveron");("all"===c||-1!==c.indexOf("points"))&&a("hovertemplate"),o.coerceSelectionMarkerOpacity(t,a)}var o=e("../../lib"),i=e("../../registry"),n=e("../../components/color"),l=e("../bar/defaults").handleGroupingDefaults,s=e("./attributes");t.exports={supplyDefaults:function(e,t,i,l){function d(a,r){return o.coerce(e,t,s,a,r)}if(a(e,t,d,l),!1!==t.visible){d("line.color",(e.marker||{}).color||i),d("line.width"),d("fillcolor",n.addOpacity(t.line.color,.5)),d("whiskerwidth"),d("boxmean"),d("width");var c=d("notched",void 0!==e.notchwidth);c&&d("notchwidth"),r(e,t,d,{prefix:"box"})}},crossTraceDefaults:function(e,t){function a(e){return o.coerce(d._input,d,s,e)}for(var r=0,n,d;r<e.length;r++){d=e[r];var c=d.type;("box"===c||"violin"===c)&&(n=d._input,"group"===t[c+"mode"]&&l(n,d,t,a))}},handleSampleDefaults:a,handlePointsDefaults:r}},{"../../components/color":593,"../../lib":719,"../../registry":847,"../bar/defaults":861,"./attributes":880}],884:[function(e,t){"use strict";t.exports=function(e,t){return t.hoverOnBox&&(e.hoverOnBox=t.hoverOnBox),"xVal"in t&&(e.x=t.xVal),"yVal"in t&&(e.y=t.yVal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},{}],885:[function(e,t){"use strict";function a(e,a,r,d){function c(e){return(S(e)+C(e))/2}var p=e.cd,u=e.xa,g=e.ya,h=p[0].trace,m=p[0].t,t="violin"===h.type,y=[],f=m.bdPos,x=m.wHover,_=function(e){return e.pos+m.bPos-A},b,v,k,w,T,A,S,C,L,E,I,z,P;t&&"both"!==h.side?("positive"===h.side&&(L=function(e){var t=_(e);return l.inbox(t,t+x,E)},z=f,P=0),"negative"===h.side&&(L=function(e){var t=_(e);return l.inbox(t-x,t,E)},z=0,P=f)):(L=function(e){var t=_(e);return l.inbox(t-x,t+x,E)},z=P=f);var D;D=t?function(e){return l.inbox(e.span[0]-T,e.span[1]-T,E)}:function(e){return l.inbox(e.min-T,e.max-T,E)},"h"===h.orientation?(T=a,A=r,S=D,C=L,b="y",k=g,v="x",w=u):(T=r,A=a,S=L,C=D,b="x",k=u,v="y",w=g);var O=ea(1,f/_a(k.r2c(k.range[1])-k.r2c(k.range[0])));E=e.maxHoverDistance-O,I=e.maxSpikeDistance-O;var R=l.getDistanceFunction(d,S,C,c);if(l.getClosest(p,R,e),!1===e.index)return[];var M=p[e.index],j=h.line.color,F=(h.marker||{}).color;e.color=s.opacity(j)&&h.line.width?j:s.opacity(F)&&h.boxpoints?F:h.fillcolor,e[b+"0"]=k.c2p(M.pos+m.bPos-P,!0),e[b+"1"]=k.c2p(M.pos+m.bPos+z,!0),e[b+"LabelVal"]=M.pos;var B=b+"Spike";e.spikeDistance=c(M)*I/E,e[B]=k.c2p(M.pos,!0);var N={},V=["med","q1","q3","min","max"];(h.boxmean||(h.meanline||{}).visible)&&V.push("mean"),(h.boxpoints||h.points)&&V.push("lf","uf");for(var U=0,H;U<V.length;U++)if(H=V[U],H in M&&!(M[H]in N)){N[M[H]]=!0;var G=M[H],q=w.c2p(G,!0),Y=n.extendFlat({},e);Y.attr=H,Y[v+"0"]=Y[v+"1"]=q,Y[v+"LabelVal"]=G,Y[v+"Label"]=(m.labels?m.labels[H]+" ":"")+o.hoverLabelText(w,G),Y.hoverOnBox=!0,"mean"===H&&"sd"in M&&"sd"===h.boxmean&&(Y[v+"err"]=M.sd),e.name="",e.spikeDistance=void 0,e[B]=void 0,Y.hovertemplate=!1,y.push(Y)}return y}function r(e,t,a){for(var r=e.cd,o=e.xa,s=e.ya,c=r[0].trace,p=o.c2p(t),u=s.c2p(a),g=function(e){var t=va(3,e.mrc||0);return va(_a(o.c2p(e.x)-p)-t,1-3/t)},h=function(e){var t=va(3,e.mrc||0);return va(_a(s.c2p(e.y)-u)-t,1-3/t)},m=l.quadrature(g,h),y=!1,f=0,x,_,b;f<r.length;f++){_=r[f];for(var v=0;v<(_.pts||[]).length;v++){b=_.pts[v];var k=m(b);k<=e.distance&&(e.distance=k,y=[f,v])}}if(!y)return!1;_=r[y[0]],b=_.pts[y[1]];var w=o.c2p(b.x,!0),T=s.c2p(b.y,!0),A=b.mrc||1;x=n.extendFlat({},e,{index:b.i,color:(c.marker||{}).color,name:c.name,x0:w-A,x1:w+A,y0:T-A,y1:T+A,spikeDistance:e.distance,hovertemplate:c.hovertemplate});var S;"h"===c.orientation?(S=s,x.xLabelVal=b.x,x.yLabelVal=_.pos):(S=o,x.xLabelVal=_.pos,x.yLabelVal=b.y);var C=S._id.charAt(0);return x[C+"Spike"]=S.c2p(_.pos,!0),d(b,c,x),x}var o=e("../../plots/cartesian/axes"),n=e("../../lib"),l=e("../../components/fx"),s=e("../../components/color"),d=n.fillText;t.exports={hoverPoints:function(e,t,o,i){var n=e.cd,l=n[0].trace,s=l.hoveron,d=[],c;return-1!==s.indexOf("boxes")&&(d=d.concat(a(e,t,o,i))),-1!==s.indexOf("points")&&(c=r(e,t,o)),"closest"===i?c?[c]:d:c?(d.push(c),d):d},hoverOnBoxes:a,hoverOnPoints:r}},{"../../components/color":593,"../../components/fx":632,"../../lib":719,"../../plots/cartesian/axes":767}],886:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults").supplyLayoutDefaults,calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"box",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"./attributes":880,"./calc":881,"./cross_trace_calc":882,"./defaults":883,"./event_data":884,"./hover":885,"./layout_attributes":887,"./layout_defaults":888,"./plot":889,"./select":890,"./style":891}],887:[function(e,t){"use strict";t.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],888:[function(e,t){"use strict";function a(e,t,a,o,n){for(var l=!1,s=0,d;s<a.length;s++)if(d=a[s],r.traceIs(d,n+"Layout")){l=!0;break}l&&(o(n+"mode"),o(n+"gap"),o(n+"groupgap"))}var r=e("../../registry"),o=e("../../lib"),i=e("./layout_attributes");t.exports={supplyLayoutDefaults:function(e,t,r){a(e,t,r,function(a,r){return o.coerce(e,t,i,a,r)},"box")},_supply:a}},{"../../lib":719,"../../registry":847,"./layout_attributes":887}],889:[function(e,t){"use strict";function a(e,a,r,o){var t=a.pos,l=a.val,s=o.bPos,c=o.wdPos||0,p=o.bPosPxOffset||0,u=r.whiskerwidth||0,g=r.notched||!1,h=g?1-2*r.notchwidth:1,y,f;Array.isArray(o.bdPos)?(y=o.bdPos[0],f=o.bdPos[1]):(y=o.bdPos,f=o.bdPos);var x=e.selectAll("path.box").data("violin"!==r.type||r.box.visible?n.identity:[]);x.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),x.exit().remove(),x.each(function(e){if(e.empty)return"M0,0Z";var a=e.pos,o=t.c2p(a+s,!0)+p,d=t.c2p(a+s-y,!0)+p,x=t.c2p(a+s+f,!0)+p,_=t.c2p(a+s-c,!0)+p,b=t.c2p(a+s+c,!0)+p,v=t.c2p(a+s-y*h,!0)+p,k=t.c2p(a+s+f*h,!0)+p,w=l.c2p(e.q1,!0),T=l.c2p(e.q3,!0),A=n.constrain(l.c2p(e.med,!0),ea(w,T)+1,va(w,T)-1),m=e.lf===void 0||!1===r.boxpoints,S=l.c2p(m?e.min:e.lf,!0),C=l.c2p(m?e.max:e.uf,!0),L=l.c2p(e.ln,!0),E=l.c2p(e.un,!0);"h"===r.orientation?i.select(this).attr("d","M"+A+","+v+"V"+k+"M"+w+","+d+"V"+x+(g?"H"+L+"L"+A+","+k+"L"+E+","+x:"")+"H"+T+"V"+d+(g?"H"+E+"L"+A+","+v+"L"+L+","+d:"")+"ZM"+w+","+o+"H"+S+"M"+T+","+o+"H"+C+(0===u?"":"M"+S+","+_+"V"+b+"M"+C+","+_+"V"+b)):i.select(this).attr("d","M"+v+","+A+"H"+k+"M"+d+","+w+"H"+x+(g?"V"+L+"L"+k+","+A+"L"+x+","+E:"")+"V"+T+"H"+d+(g?"V"+E+"L"+v+","+A+"L"+d+","+L:"")+"ZM"+o+","+w+"V"+S+"M"+o+","+T+"V"+C+(0===u?"":"M"+_+","+S+"H"+b+"M"+_+","+C+"H"+b))})}function r(e,a,r,o){var t=a.x,i=a.y,c=o.bdPos,p=o.bPos,u=r.boxpoints||r.points;n.seedPseudoRandom();var g=e.selectAll("g.points").data(u?function(e){return e.forEach(function(e){e.t=o,e.trace=r}),e}:[]);g.enter().append("g").attr("class","points"),g.exit().remove();var h=g.selectAll("path").data(function(e){var t=e.pts2,a=va((e.max-e.min)/10,e.q3-e.q1),o=[],l=0,d,g;if(r.jitter){if(0===a)for(l=1,o=Array(t.length),d=0;d<t.length;d++)o[d]=1;else for(d=0;d<t.length;d++){var h=va(0,d-5),m=t[h].v,y=ea(t.length-1,d+5),f=t[y].v;"all"!==u&&(t[d].v<e.lf?f=ea(f,e.lf):m=va(m,e.uf));var x=N(a*s*(y-h)/(f-m+1e-9*a))||0;x=n.constrain(_a(x),0,1),o.push(x),l=va(x,l)}g=2*r.jitter/(l||1)}for(d=0;d<t.length;d++){var _=t[d],b=_.v,v=r.jitter?g*o[d]*(n.pseudoRandom()-.5):0,k=e.pos+p+c*(r.pointpos+v);"h"===r.orientation?(_.y=k,_.x=b):(_.x=k,_.y=b),"suspectedoutliers"===u&&b<e.uo&&b>e.lo&&(_.so=!0)}return t});h.enter().append("path").classed("point",!0),h.exit().remove(),h.call(l.translatePoints,t,i)}function o(e,a,r,o){var t=a.pos,l=a.val,s=o.bPos,c=o.bPosPxOffset||0,p=r.boxmean||(r.meanline||{}).visible,u,g;Array.isArray(o.bdPos)?(u=o.bdPos[0],g=o.bdPos[1]):(u=o.bdPos,g=o.bdPos);var h=e.selectAll("path.mean").data("box"===r.type&&r.boxmean||"violin"===r.type&&r.box.visible&&r.meanline.visible?n.identity:[]);h.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),h.exit().remove(),h.each(function(e){var a=t.c2p(e.pos+s,!0)+c,o=t.c2p(e.pos+s-u,!0)+c,n=t.c2p(e.pos+s+g,!0)+c,d=l.c2p(e.mean,!0),h=l.c2p(e.mean-e.sd,!0),m=l.c2p(e.mean+e.sd,!0);"h"===r.orientation?i.select(this).attr("d","M"+d+","+o+"V"+n+("sd"===p?"m0,0L"+h+","+a+"L"+d+","+o+"L"+m+","+a+"Z":"")):i.select(this).attr("d","M"+o+","+d+"H"+n+("sd"===p?"m0,0L"+a+","+h+"L"+o+","+d+"L"+a+","+m+"Z":""))})}var i=e("d3"),n=e("../../lib"),l=e("../../components/drawing"),s=.01;t.exports={plot:function(e,t,l,s){var d=t.xaxis,c=t.yaxis;n.makeTraceGroups(s,l,"trace boxes").each(function(e){var n=i.select(this),l=e[0],s=l.t,t=l.trace;if(s.wdPos=s.bdPos*t.whiskerwidth,!0!==t.visible||s.empty)return void n.remove();var p,u;"h"===t.orientation?(p=c,u=d):(p=d,u=c),a(n,{pos:p,val:u},t,s),r(n,{x:d,y:c},t,s),o(n,{pos:p,val:u},t,s)})},plotBoxAndWhiskers:a,plotPoints:r,plotBoxMean:o}},{"../../components/drawing":614,"../../lib":719,d3:163}],890:[function(e,t){"use strict";t.exports=function(e,t){var a=e.cd,r=e.xaxis,o=e.yaxis,n=[],l,s;if(!1===t)for(l=0;l<a.length;l++)for(s=0;s<(a[l].pts||[]).length;s++)a[l].pts[s].selected=0;else for(l=0;l<a.length;l++)for(s=0;s<(a[l].pts||[]).length;s++){var d=a[l].pts[s],c=r.c2p(d.x),p=o.c2p(d.y);t.contains([c,p],null,d.i,e)?(n.push({pointNumber:d.i,x:r.c2d(d.x),y:o.c2d(d.y)}),d.selected=1):d.selected=0}return n}},{}],891:[function(e,t){"use strict";var a=e("d3"),r=e("../../components/color"),o=e("../../components/drawing");t.exports={style:function(e,t,i){var n=i?i:a.select(e).selectAll("g.trace.boxes");n.style("opacity",function(e){return e[0].trace.opacity}),n.each(function(t){function i(e,t,a,o){e.style("stroke-width",t+"px").call(r.stroke,a).call(r.fill,o)}var n=a.select(this),l=t[0].trace,s=l.line.width,d=n.selectAll("path.box");if("candlestick"===l.type)d.each(function(e){if(!e.empty){var t=a.select(this),r=l[e.dir];i(t,r.line.width,r.line.color,r.fillcolor),t.style("opacity",l.selectedpoints&&!e.selected?.3:1)}});else{i(d,s,l.line.color,l.fillcolor),n.selectAll("path.mean").style({"stroke-width":s,"stroke-dasharray":2*s+"px,"+s+"px"}).call(r.stroke,l.line.color);var c=n.selectAll("path.point");o.pointStyle(c,l,e)}})},styleOnSelect:function(e,t,a){var r=t[0].trace,i=a.selectAll("path.point");r.selectedpoints?o.selectedPointStyle(i,r):o.pointStyle(i,r,e)}}},{"../../components/color":593,"../../components/drawing":614,d3:163}],892:[function(e,t){"use strict";function a(e){return{line:{color:r({},i.line.color,{dflt:e}),width:i.line.width,editType:"style"},fillcolor:i.fillcolor,editType:"style"}}var r=e("../../lib").extendFlat,o=e("../ohlc/attributes"),i=e("../box/attributes");t.exports={x:o.x,open:o.open,high:o.high,low:o.low,close:o.close,line:{width:r({},i.line.width,{}),editType:"style"},increasing:a(o.increasing.line.color.dflt),decreasing:a(o.decreasing.line.color.dflt),text:o.text,hovertext:o.hovertext,whiskerwidth:r({},i.whiskerwidth,{dflt:0}),hoverlabel:o.hoverlabel}},{"../../lib":719,"../box/attributes":880,"../ohlc/attributes":1058}],893:[function(e,t){"use strict";function a(e,t,a,r){return{min:a,q1:ea(e,r),med:r,q3:va(e,r),max:t}}var r=e("../../lib"),o=e("../../plots/cartesian/axes"),i=e("../ohlc/calc").calcCommon;t.exports=function(e,t){var n=e._fullLayout,l=o.getFromId(e,t.xaxis),s=o.getFromId(e,t.yaxis),d=l.makeCalcdata(t,"x"),c=i(e,t,d,s,a);return c.length?(r.extendFlat(c[0].t,{num:n._numBoxes,dPos:r.distinctVals(d).minDiff/2,posLetter:"x",valLetter:"y"}),n._numBoxes++,c):[{t:{empty:!0}}]}},{"../../lib":719,"../../plots/cartesian/axes":767,"../ohlc/calc":1059}],894:[function(e,t){"use strict";function a(e,t,a,r){var i=a(r+".line.color");a(r+".line.width",t.line.width),a(r+".fillcolor",o.addOpacity(i,.5))}var r=e("../../lib"),o=e("../../components/color"),i=e("../ohlc/ohlc_defaults"),n=e("./attributes");t.exports=function(e,t,o,l){function s(a,o){return r.coerce(e,t,n,a,o)}var d=i(e,t,s,l);return d?void(s("line.width"),a(e,t,s,"increasing"),a(e,t,s,"decreasing"),s("text"),s("hovertext"),s("whiskerwidth"),l._requestRangeslider[t.xaxis]=!0):void(t.visible=!1)}},{"../../components/color":593,"../../lib":719,"../ohlc/ohlc_defaults":1063,"./attributes":892}],895:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"candlestick",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:e("./attributes"),layoutAttributes:e("../box/layout_attributes"),supplyLayoutDefaults:e("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:e("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("../box/plot").plot,layerName:"boxlayer",style:e("../box/style").style,hoverPoints:e("../ohlc/hover").hoverPoints,selectPoints:e("../ohlc/select")}},{"../../plots/cartesian":778,"../box/cross_trace_calc":882,"../box/layout_attributes":887,"../box/layout_defaults":888,"../box/plot":889,"../box/style":891,"../ohlc/hover":1061,"../ohlc/select":1065,"./attributes":892,"./calc":893,"./defaults":894}],896:[function(e,t){"use strict";function r(e,t,a,r){["aaxis","baxis"].forEach(function(n){var l=n.charAt(0),s=e[n]||{},d=i.newContainer(t,n),c={tickfont:"x",id:l+"axis",letter:l,font:t.font,name:n,data:e[l],calendar:t.calendar,dfltColor:r,bgColor:a.paper_bgcolor,fullLayout:a};o(s,d,c),d._categories=d._categories||[],e[n]||"-"===s.type||(e[n]={type:s.type})})}var o=e("./axis_defaults"),i=e("../../plot_api/plot_template");t.exports=function(e,t,o,i,n){var l=i("a");l||(i("da"),i("a0"));var a=i("b");a||(i("db"),i("b0")),r(e,t,o,n)}},{"../../plot_api/plot_template":757,"./axis_defaults":901}],897:[function(e,t){"use strict";function r(e,t){if(!o(e)||10<=t)return null;for(var a=1/0,l=-Infinity,s=e.length,n=0,d;n<s;n++)if(d=e[n],o(d)){var c=r(d,t+1);c&&(a=ea(c[0],a),l=va(c[1],l))}else a=ea(d,a),l=va(d,l);return[a,l]}var o=e("../../lib").isArrayOrTypedArray;t.exports=function(e){return r(e,0)}},{"../../lib":719}],898:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("./axis_attributes"),o=e("../../components/color/attributes"),i=a({editType:"calc"});i.family.dflt="\"Open Sans\", verdana, arial, sans-serif",i.size.dflt=12,i.color.dflt=o.defaultLine,t.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:r,baxis:r,font:i,color:{valType:"color",dflt:o.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":592,"../../plots/font_attributes":793,"./axis_attributes":900}],899:[function(e,t){"use strict";var r=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,o,a){var i=r(o)?"a":"b",l="a"===i?e.aaxis:e.baxis,s=l.smoothing,d="a"===i?e.a2i:e.b2j,c="a"===i?o:a,p="a"===i?a:o,u="a"===i?t.a.length:t.b.length,n="a"===i?t.b.length:t.a.length,g=ba("a"===i?e.b2j(p):e.a2i(p)),h="a"===i?function(t){return e.evalxy([],t,g)}:function(t){return e.evalxy([],g,t)},m,y,f,x,_,b,v,k,w,T,A,S,C;s&&(f=va(0,ea(n-2,g)),x=g-f,y="a"===i?function(t,a){return e.dxydi([],t,f,a,x)}:function(t,a){return e.dxydj([],f,t,x,a)});var L=d(c[0]),E=d(c[1]),I=L<E?1:-1,z=1e-8*(E-L),P=0<I?ba:M,D=0<I?M:ba,O=0<I?ea:va,R=0<I?va:ea,j=P(L+z),F=D(E-z);v=h(L);var B=[[v]];for(m=j;m*I<F*I;m+=I)_=[],A=R(L,m),S=O(E,m+I),C=S-A,b=va(0,ea(u-2,ba(.5*(A+S)))),k=h(S),s&&(w=y(b,A-b),T=y(b,S-b),_.push([v[0]+w[0]/3*C,v[1]+w[1]/3*C]),_.push([k[0]-T[0]/3*C,k[1]-T[1]/3*C])),_.push(k),B.push(_),v=k;return B}},{"../../lib":719}],900:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("../../components/color/attributes"),o=e("../../plots/cartesian/layout_attributes"),i=e("../../plot_api/edit_types").overrideAll,n=e("../../constants/docs").FORMAT_LINK,l=e("../../constants/docs").TIME_FORMAT_LINK;t.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:a({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:a({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:i(o.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:r.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:r.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:a({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":592,"../../constants/docs":690,"../../plot_api/edit_types":750,"../../plots/cartesian/layout_attributes":779,"../../plots/font_attributes":793}],901:[function(e,t){"use strict";function a(e,t){if("-"===e.type){var a=e._id,r=a.charAt(0),o=e[r+"calendar"];e.type=p(t,o)}}var r=e("./attributes"),o=e("../../components/color").addOpacity,i=e("../../registry"),n=e("../../lib"),l=e("../../plots/cartesian/tick_value_defaults"),s=e("../../plots/cartesian/tick_label_defaults"),d=e("../../plots/cartesian/category_order_defaults"),c=e("../../plots/cartesian/set_convert"),p=e("../../plots/cartesian/axis_autotype");t.exports=function(e,t,p){function u(a,r){return n.coerce(e,t,y,a,r)}function g(a,r){return n.coerce2(e,t,y,a,r)}var h=p.letter,m=p.font||{},y=r[h+"axis"];p.name&&(t._name=p.name,t._id=p.name);var f=u("type");if("-"===f&&(p.data&&a(t,p.data),"-"===t.type?t.type="linear":f=e.type=t.type),u("smoothing"),u("cheatertype"),u("showticklabels"),u("labelprefix",h+" = "),u("labelsuffix"),u("showtickprefix"),u("showticksuffix"),u("separatethousands"),u("tickformat"),u("exponentformat"),u("showexponent"),u("categoryorder"),u("tickmode"),u("tickvals"),u("ticktext"),u("tick0"),u("dtick"),"array"===t.tickmode&&(u("arraytick0"),u("arraydtick")),u("labelpadding"),t._hovertitle=h,"date"===f){var x=i.getComponentMethod("calendars","handleDefaults");x(e,t,"calendar",p.calendar)}c(t,p.fullLayout),t.c2p=n.identity;var _=u("color",p.dfltColor),b=_===e.color?_:m.color,v=u("title.text");v&&(n.coerceFont(u,"title.font",{family:m.family,size:V(1.2*m.size),color:b}),u("title.offset")),u("tickangle");var k=u("autorange",!t.isValidRange(e.range));k&&u("rangemode"),u("range"),t.cleanRange(),u("fixedrange"),l(e,t,u,f),s(e,t,u,f,p),d(e,t,u,{data:p.data,dataAttr:h});var w=g("gridcolor",o(_,.3)),T=g("gridwidth"),A=u("showgrid");A||(delete t.gridcolor,delete t.gridwidth);var S=g("startlinecolor",_),C=g("startlinewidth",T),L=u("startline",t.showgrid||!!S||!!C);L||(delete t.startlinecolor,delete t.startlinewidth);var E=g("endlinecolor",_),I=g("endlinewidth",T),z=u("endline",t.showgrid||!!E||!!I);return z||(delete t.endlinecolor,delete t.endlinewidth),A?(u("minorgridcount"),u("minorgridwidth",T),u("minorgridcolor",o(w,.06)),!t.minorgridcount&&(delete t.minorgridwidth,delete t.minorgridcolor)):(delete t.gridcolor,delete t.gridWidth),"none"===t.showticklabels&&(delete t.tickfont,delete t.tickangle,delete t.showexponent,delete t.exponentformat,delete t.tickformat,delete t.showticksuffix,delete t.showtickprefix),t.showticksuffix||delete t.ticksuffix,t.showtickprefix||delete t.tickprefix,u("tickmode"),t}},{"../../components/color":593,"../../lib":719,"../../plots/cartesian/axis_autotype":768,"../../plots/cartesian/category_order_defaults":771,"../../plots/cartesian/set_convert":785,"../../plots/cartesian/tick_label_defaults":786,"../../plots/cartesian/tick_value_defaults":788,"../../registry":847,"./attributes":898}],902:[function(e,t){"use strict";var r=e("../../plots/cartesian/axes"),o=e("../../lib").isArray1D,i=e("./cheater_basis"),n=e("./array_minmax"),l=e("./calc_gridlines"),s=e("./calc_labels"),d=e("./calc_clippath"),c=e("../heatmap/clean_2d_array"),p=e("./smooth_fill_2d_array"),u=e("../heatmap/convert_column_xyz"),g=e("./set_convert");t.exports=function(e,h){var m=r.getFromId(e,h.xaxis),f=r.getFromId(e,h.yaxis),_=h.aaxis,v=h.baxis,k=h.x,w=h.y,T=[];k&&o(k)&&T.push("x"),w&&o(w)&&T.push("y"),T.length&&u(h,_,v,"a","b",T);var A=h._a=h._a||h.a,a=h._b=h._b||h.b;k=h._x||h.x,w=h._y||h.y;var b={};if(h._cheater){var t="index"===_.cheatertype?A.length:A,S="index"===v.cheatertype?a.length:a;k=i(t,S,h.cheaterslope)}h._x=k=c(k),h._y=w=c(w),p(k,A,a),p(w,A,a),g(h),h.setScale();var C=n(k),L=n(w),E=.5*(C[1]-C[0]),I=.5*(C[1]+C[0]),z=.5*(L[1]-L[0]),P=.5*(L[1]+L[0]),D=1.3;return C=[I-E*D,I+E*D],L=[P-z*D,P+z*D],h._extremes[m._id]=r.findExtremes(m,C,{padded:!0}),h._extremes[f._id]=r.findExtremes(f,L,{padded:!0}),l(h,"a","b"),l(h,"b","a"),s(h,_),s(h,v),b.clipsegments=d(h._xctrl,h._yctrl,_,v),b.x=k,b.y=w,b.a=A,b.b=a,[b]}},{"../../lib":719,"../../plots/cartesian/axes":767,"../heatmap/clean_2d_array":1003,"../heatmap/convert_column_xyz":1005,"./array_minmax":897,"./calc_clippath":903,"./calc_gridlines":904,"./calc_labels":905,"./cheater_basis":907,"./set_convert":920,"./smooth_fill_2d_array":921}],903:[function(e,t){"use strict";t.exports=function(e,t,a,r){var o=[],n=!!a.smoothing,l=!!r.smoothing,s=e[0].length-1,d=e.length-1,c,p,u;for(c=0,p=[],u=[];c<=s;c++)p[c]=e[0][c],u[c]=t[0][c];for(o.push({x:p,y:u,bicubic:n}),c=0,p=[],u=[];c<=d;c++)p[c]=e[c][s],u[c]=t[c][s];for(o.push({x:p,y:u,bicubic:l}),c=s,p=[],u=[];0<=c;c--)p[s-c]=e[d][c],u[s-c]=t[d][c];for(o.push({x:p,y:u,bicubic:n}),c=d,p=[],u=[];0<=c;c--)p[d-c]=e[c][0],u[d-c]=t[c][0];return o.push({x:p,y:u,bicubic:l}),o}},{}],904:[function(e,t){"use strict";var a=e("../../plots/cartesian/axes"),r=e("../../lib/extend").extendFlat;t.exports=function(e,t,o){function l(a){var r=[],n=[],l={},s,d,c,u,g,h,m,f,x,_,b,v;if("b"===t)for(d=e.b2j(a),c=ba(va(0,ea(B-2,d))),u=d-c,l.length=B,l.crossLength=F,l.xy=function(t){return e.evalxy([],t,d)},l.dxy=function(t,a){return e.dxydi([],t,c,a,u)},s=0;s<F;s++)h=ea(F-2,s),m=s-h,f=e.evalxy([],s,d),y.smoothing&&0<s&&(x=e.dxydi([],s-1,c,0,u),r.push(g[0]+x[0]/3),n.push(g[1]+x[1]/3),_=e.dxydi([],s-1,c,1,u),r.push(f[0]-_[0]/3),n.push(f[1]-_[1]/3)),r.push(f[0]),n.push(f[1]),g=f;else for(s=e.a2i(a),h=ba(va(0,ea(F-2,s))),m=s-h,l.length=F,l.crossLength=B,l.xy=function(t){return e.evalxy([],s,t)},l.dxy=function(t,a){return e.dxydj([],h,t,m,a)},d=0;d<B;d++)c=ea(B-2,d),u=d-c,f=e.evalxy([],s,d),y.smoothing&&0<d&&(b=e.dxydj([],h,d-1,m,0),r.push(g[0]+b[0]/3),n.push(g[1]+b[1]/3),v=e.dxydj([],h,d-1,m,1),r.push(f[0]-v[0]/3),n.push(f[1]-v[1]/3)),r.push(f[0]),n.push(f[1]),g=f;return l.axisLetter=t,l.axis=p,l.crossAxis=y,l.value=a,l.constvar=o,l.index=A,l.x=r,l.y=n,l.smoothing=y.smoothing,l}function s(a){var r=[],i=[],n={},l,s,d,u,g;if(n.length=c.length,n.crossLength=m.length,"b"===t)for(d=va(0,ea(B-2,a)),g=ea(1,va(0,a-d)),n.xy=function(t){return e.evalxy([],t,a)},n.dxy=function(t,a){return e.dxydi([],t,d,a,g)},l=0;l<O;l++)r[l]=P[a*N][l],i[l]=D[a*N][l];else for(s=va(0,ea(F-2,a)),u=ea(1,va(0,a-s)),n.xy=function(t){return e.evalxy([],a,t)},n.dxy=function(t,a){return e.dxydj([],s,t,u,a)},l=0;l<R;l++)r[l]=P[l][a*N],i[l]=D[l][a*N];return n.axisLetter=t,n.axis=p,n.crossAxis=y,n.value=c[a],n.constvar=o,n.index=a,n.x=r,n.y=i,n.smoothing=y.smoothing,n}var c=e["_"+t],p=e[t+"axis"],u=p._gridlines=[],g=p._minorgridlines=[],h=p._boundarylines=[],m=e["_"+o],y=e[o+"axis"],f,x,_,b,k,w,T,A,S,C,L,E,I,z;"array"===p.tickmode&&(p.tickvals=c.slice());var P=e._xctrl,D=e._yctrl,O=P[0].length,R=P.length,F=e._a.length,B=e._b.length;a.prepTicks(p),"array"===p.tickmode&&delete p.tickvals;var N=p.smoothing?3:1;if("array"===p.tickmode){for(b=5e-15,k=[ba((c.length-1-p.arraytick0)/p.arraydtick*(1+b)),M(-p.arraytick0/p.arraydtick/(1+b))].sort(function(e,t){return e-t}),w=k[0]-1,T=k[1]+1,A=w;A<T;A++)x=p.arraytick0+p.arraydtick*A,0>x||x>c.length-1||u.push(r(s(x),{color:p.gridcolor,width:p.gridwidth}));for(A=w;A<T;A++)if(_=p.arraytick0+p.arraydtick*A,L=ea(_+p.arraydtick,c.length-1),!(0>_||_>c.length-1)&&!(0>L||L>c.length-1))for(E=c[_],I=c[L],f=0;f<p.minorgridcount;f++)z=L-_,0>=z||(C=E+(I-E)*(f+1)/(p.minorgridcount+1)*(p.arraydtick/z),!(C<c[0]||C>c[c.length-1])&&g.push(r(l(C),{color:p.minorgridcolor,width:p.minorgridwidth})));p.startline&&h.push(r(s(0),{color:p.startlinecolor,width:p.startlinewidth})),p.endline&&h.push(r(s(c.length-1),{color:p.endlinecolor,width:p.endlinewidth}))}else{for(b=5e-15,k=[ba((c[c.length-1]-p.tick0)/p.dtick*(1+b)),M((c[0]-p.tick0)/p.dtick/(1+b))].sort(function(e,t){return e-t}),w=k[0],T=k[1],A=w;A<=T;A++)S=p.tick0+p.dtick*A,u.push(r(l(S),{color:p.gridcolor,width:p.gridwidth}));for(A=w-1;A<T+1;A++)for(S=p.tick0+p.dtick*A,f=0;f<p.minorgridcount;f++)C=S+p.dtick*(f+1)/(p.minorgridcount+1),C<c[0]||C>c[c.length-1]||g.push(r(l(C),{color:p.minorgridcolor,width:p.minorgridwidth}));p.startline&&h.push(r(l(c[0]),{color:p.startlinecolor,width:p.startlinewidth})),p.endline&&h.push(r(l(c[c.length-1]),{color:p.endlinecolor,width:p.endlinewidth}))}}},{"../../lib/extend":710,"../../plots/cartesian/axes":767}],905:[function(e,t){"use strict";var a=e("../../plots/cartesian/axes"),r=e("../../lib/extend").extendFlat;t.exports=function(e,t){var o=t._labels=[],n=t._gridlines,l,s,d,c,p;for(l=0;l<n.length;l++)p=n[l],-1!==["start","both"].indexOf(t.showticklabels)&&(s=a.tickText(t,p.value),r(s,{prefix:d,suffix:c,endAnchor:!0,xy:p.xy(0),dxy:p.dxy(0,0),axis:p.axis,length:p.crossAxis.length,font:p.axis.tickfont,isFirst:0===l,isLast:l===n.length-1}),o.push(s)),-1!==["end","both"].indexOf(t.showticklabels)&&(s=a.tickText(t,p.value),r(s,{endAnchor:!1,xy:p.xy(p.crossLength-1),dxy:p.dxy(p.crossLength-2,1),axis:p.axis,length:p.crossAxis.length,font:p.axis.tickfont,isFirst:0===l,isLast:l===n.length-1}),o.push(s))}},{"../../lib/extend":710,"../../plots/cartesian/axes":767}],906:[function(e,t){"use strict";var a=.5;t.exports=function(e,t,r,o){var i=e[0]-t[0],n=e[1]-t[1],l=r[0]-t[0],s=r[1]-t[1],d=ya(i*i+n*n,a/2),c=ya(l*l+s*s,a/2),p=(c*c*i-d*d*l)*o,u=(c*c*n-d*d*s)*o,g=3*(c*(d+c)),h=3*(d*(d+c));return[[t[0]+(g&&p/g),t[1]+(g&&u/g)],[t[0]-(h&&p/h),t[1]-(h&&u/h)]]}},{}],907:[function(e,t){"use strict";var r=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,a){var o=[],n=r(e)?e.length:e,l=r(t)?t.length:t,s=r(e)?e:null,d=r(t)?t:null,c,p,u,g,h,m;s&&(u=(s.length-1)/(s[s.length-1]-s[0])/(n-1)),d&&(g=(d.length-1)/(d[d.length-1]-d[0])/(l-1));var y=1/0,f=-Infinity,x;for(p=0;p<l;p++)for(o[p]=[],m=d?(d[p]-d[0])*g:p/(l-1),c=0;c<n;c++)h=s?(s[c]-s[0])*u:c/(n-1),x=h-m*a,y=ea(x,y),f=va(x,f),o[p][c]=x;var _=1/(f-y),b=-y*_;for(p=0;p<l;p++)for(c=0;c<n;c++)o[p][c]=_*o[p][c]+b;return o}},{"../../lib":719}],908:[function(e,t){"use strict";function a(e,t,a){var r=-.5*a[0]+1.5*t[0],o=-.5*a[1]+1.5*t[1];return[(2*r+e[0])/3,(2*o+e[1])/3]}var r=e("./catmull_rom"),o=e("../../lib").ensureArray;t.exports=function(e,t,n,l,s,d){var c=n[0].length,p=n.length,u=s?3*c-2:c,g=d?3*p-2:p,h,m,y,f,x,_,b,v,k,w;for(e=o(e,g),t=o(t,g),y=0;y<g;y++)e[y]=o(e[y],u),t[y]=o(t[y],u);for(m=0,f=0;m<p;m++,f+=d?3:1)for(x=e[f],_=t[f],b=n[m],v=l[m],(h=0,y=0);h<c;h++,y+=s?3:1)x[y]=b[h],_[y]=v[h];if(s)for(m=0,f=0;m<p;m++,f+=d?3:1){for(h=1,y=3;h<c-1;h++,y+=3)k=r([n[m][h-1],l[m][h-1]],[n[m][h],l[m][h]],[n[m][h+1],l[m][h+1]],s),e[f][y-1]=k[0][0],t[f][y-1]=k[0][1],e[f][y+1]=k[1][0],t[f][y+1]=k[1][1];w=a([e[f][0],t[f][0]],[e[f][2],t[f][2]],[e[f][3],t[f][3]]),e[f][1]=w[0],t[f][1]=w[1],w=a([e[f][u-1],t[f][u-1]],[e[f][u-3],t[f][u-3]],[e[f][u-4],t[f][u-4]]),e[f][u-2]=w[0],t[f][u-2]=w[1]}if(d)for(y=0;y<u;y++){for(f=3;f<g-3;f+=3)k=r([e[f-3][y],t[f-3][y]],[e[f][y],t[f][y]],[e[f+3][y],t[f+3][y]],d),e[f-1][y]=k[0][0],t[f-1][y]=k[0][1],e[f+1][y]=k[1][0],t[f+1][y]=k[1][1];w=a([e[0][y],t[0][y]],[e[2][y],t[2][y]],[e[3][y],t[3][y]]),e[1][y]=w[0],t[1][y]=w[1],w=a([e[g-1][y],t[g-1][y]],[e[g-3][y],t[g-3][y]],[e[g-4][y],t[g-4][y]]),e[g-2][y]=w[0],t[g-2][y]=w[1]}if(s&&d)for(f=1;f<g;f+=0==(f+1)%3?2:1){for(y=3;y<u-3;y+=3)k=r([e[f][y-3],t[f][y-3]],[e[f][y],t[f][y]],[e[f][y+3],t[f][y+3]],s),e[f][y-1]=.5*(e[f][y-1]+k[0][0]),t[f][y-1]=.5*(t[f][y-1]+k[0][1]),e[f][y+1]=.5*(e[f][y+1]+k[1][0]),t[f][y+1]=.5*(t[f][y+1]+k[1][1]);w=a([e[f][0],t[f][0]],[e[f][2],t[f][2]],[e[f][3],t[f][3]]),e[f][1]=.5*(e[f][1]+w[0]),t[f][1]=.5*(t[f][1]+w[1]),w=a([e[f][u-1],t[f][u-1]],[e[f][u-3],t[f][u-3]],[e[f][u-4],t[f][u-4]]),e[f][u-2]=.5*(e[f][u-2]+w[0]),t[f][u-2]=.5*(t[f][u-2]+w[1])}return[e,t]}},{"../../lib":719,"./catmull_rom":906}],909:[function(e,t){"use strict";t.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],910:[function(e,t){"use strict";t.exports=function(e,t,a){return t&&a?function(t,r,o,i,n){t||(t=[]);var l,s,p,u,g,h;r*=3,o*=3;var m=i*i,y=1-i,f=y*y,x=2*(y*i),_=-3*f,a=3*(f-x),b=3*(x-m),c=3*m,d=n*n,v=1-n,w=v*v;for(h=0;h<e.length;h++)g=e[h],l=_*g[o][r]+a*g[o][r+1]+b*g[o][r+2]+c*g[o][r+3],s=_*g[o+1][r]+a*g[o+1][r+1]+b*g[o+1][r+2]+c*g[o+1][r+3],p=_*g[o+2][r]+a*g[o+2][r+1]+b*g[o+2][r+2]+c*g[o+2][r+3],u=_*g[o+3][r]+a*g[o+3][r+1]+b*g[o+3][r+2]+c*g[o+3][r+3],t[h]=w*v*l+3*(w*n*s+v*d*p)+d*n*u;return t}:t?function(t,r,o,i,n){t||(t=[]);var l,s,p,u;r*=3;var g=i*i,h=1-i,m=h*h,y=2*(h*i),f=-3*m,a=3*(m-y),x=3*(y-g),c=3*g;for(p=0;p<e.length;p++)u=e[p],l=f*u[o][r]+a*u[o][r+1]+x*u[o][r+2]+c*u[o][r+3],s=f*u[o+1][r]+a*u[o+1][r+1]+x*u[o+1][r+2]+c*u[o+1][r+3],t[p]=(1-n)*l+n*s;return t}:a?function(t,a,r,o,i){t||(t=[]);var n,l,s,d,c,p;r*=3;var u=i*i,g=1-i,h=g*g;for(c=0;c<e.length;c++)p=e[c],n=p[r][a+1]-p[r][a],l=p[r+1][a+1]-p[r+1][a],s=p[r+2][a+1]-p[r+2][a],d=p[r+3][a+1]-p[r+3][a],t[c]=h*g*n+3*(h*i*l+g*u*s)+u*i*d;return t}:function(t,a,r,o,i){t||(t=[]);var n,l,s,d;for(s=0;s<e.length;s++)d=e[s],n=d[r][a+1]-d[r][a],l=d[r+1][a+1]-d[r+1][a],t[s]=(1-i)*n+i*l;return t}}},{}],911:[function(e,t){"use strict";t.exports=function(e,t,a){return t&&a?function(t,r,o,i,n){t||(t=[]);var l,s,p,u,g,h;r*=3,o*=3;var m=i*i,y=1-i,f=y*y,x=n*n,_=1-n,v=_*_,w=2*(_*n),T=-3*v,a=3*(v-w),b=3*(w-x),c=3*x;for(h=0;h<e.length;h++)g=e[h],l=T*g[o][r]+a*g[o+1][r]+b*g[o+2][r]+c*g[o+3][r],s=T*g[o][r+1]+a*g[o+1][r+1]+b*g[o+2][r+1]+c*g[o+3][r+1],p=T*g[o][r+2]+a*g[o+1][r+2]+b*g[o+2][r+2]+c*g[o+3][r+2],u=T*g[o][r+3]+a*g[o+1][r+3]+b*g[o+2][r+3]+c*g[o+3][r+3],t[h]=f*y*l+3*(f*i*s+y*m*p)+m*i*u;return t}:t?function(t,a,r,o,i){t||(t=[]);var n,l,s,d,c,p;a*=3;var u=i*i,g=1-i,h=g*g;for(c=0;c<e.length;c++)p=e[c],n=p[r+1][a]-p[r][a],l=p[r+1][a+1]-p[r][a+1],s=p[r+1][a+2]-p[r][a+2],d=p[r+1][a+3]-p[r][a+3],t[c]=h*g*n+3*(h*i*l+g*u*s)+u*i*d;return t}:a?function(t,r,o,i,n){t||(t=[]);var l,s,p,u;o*=3;var g=n*n,h=1-n,m=h*h,y=2*(h*n),f=-3*m,a=3*(m-y),x=3*(y-g),c=3*g;for(p=0;p<e.length;p++)u=e[p],l=f*u[o][r]+a*u[o+1][r]+x*u[o+2][r]+c*u[o+3][r],s=f*u[o][r+1]+a*u[o+1][r+1]+x*u[o+2][r+1]+c*u[o+3][r+1],t[p]=(1-i)*l+i*s;return t}:function(t,a,r,o){t||(t=[]);var i,n,l,s;for(l=0;l<e.length;l++)s=e[l],i=s[r+1][a]-s[r][a],n=s[r+1][a+1]-s[r][a+1],t[l]=(1-o)*i+o*n;return t}}},{}],912:[function(e,t){"use strict";t.exports=function(e,t,a,r,o){var n=t-2,l=a-2;return r&&o?function(t,a,r){t||(t=[]);var o=va(0,ea(ba(a),n)),i=va(0,ea(ba(r),l)),s=va(0,ea(1,a-o)),d=va(0,ea(1,r-i)),c,p,u,g,h,m;o*=3,i*=3;var y=s*s,f=y*s,x=1-s,_=x*x,b=_*x,v=d*d,w=1-d,T=w*w;for(m=0;m<e.length;m++)h=e[m],c=b*h[i][o]+3*(_*s*h[i][o+1]+x*y*h[i][o+2])+f*h[i][o+3],p=b*h[i+1][o]+3*(_*s*h[i+1][o+1]+x*y*h[i+1][o+2])+f*h[i+1][o+3],u=b*h[i+2][o]+3*(_*s*h[i+2][o+1]+x*y*h[i+2][o+2])+f*h[i+2][o+3],g=b*h[i+3][o]+3*(_*s*h[i+3][o+1]+x*y*h[i+3][o+2])+f*h[i+3][o+3],t[m]=T*w*c+3*(T*d*p+w*v*u)+v*d*g;return t}:r?function(t,a,r){t||(t=[]);var o=va(0,ea(ba(a),n)),i=va(0,ea(ba(r),l)),s=va(0,ea(1,a-o)),d=va(0,ea(1,r-i)),c,p,u,g,h,m;o*=3;var y=s*s,f=1-s,x=f*f,_=1-d;for(h=0;h<e.length;h++)m=e[h],c=_*m[i][o]+d*m[i+1][o],p=_*m[i][o+1]+d*m[i+1][o+1],u=_*m[i][o+2]+d*m[i+1][o+1],g=_*m[i][o+3]+d*m[i+1][o+1],t[h]=x*f*c+3*(x*s*p+f*y*u)+y*s*g;return t}:o?function(t,a,r){t||(t=[]);var o=va(0,ea(ba(a),n)),i=va(0,ea(ba(r),l)),s=va(0,ea(1,a-o)),d=va(0,ea(1,r-i)),c,p,u,g,h,m;i*=3;var y=d*d,f=1-d,x=f*f,_=1-s;for(h=0;h<e.length;h++)m=e[h],c=_*m[i][o]+s*m[i][o+1],p=_*m[i+1][o]+s*m[i+1][o+1],u=_*m[i+2][o]+s*m[i+2][o+1],g=_*m[i+3][o]+s*m[i+3][o+1],t[h]=x*f*c+3*(x*d*p+f*y*u)+y*d*g;return t}:function(t,a,r){t||(t=[]);var o=va(0,ea(ba(a),n)),i=va(0,ea(ba(r),l)),s=va(0,ea(1,a-o)),d=va(0,ea(1,r-i)),c=1-s,p,u,g,h;for(g=0;g<e.length;g++)h=e[g],p=c*h[i][o]+s*h[i][o+1],u=c*h[i+1][o]+s*h[i+1][o+1],t[g]=(1-d)*p+d*u;return t}}},{}],913:[function(e,t){"use strict";var a=e("../../lib"),r=e("./xy_defaults"),o=e("./ab_defaults"),i=e("./attributes"),n=e("../../components/color/attributes");t.exports=function(e,t,l,s){function d(r,o){return a.coerce(e,t,i,r,o)}t._clipPathId="clip"+t.uid+"carpet";var c=d("color",n.defaultLine);if(a.coerceFont(d,"font"),d("carpet"),o(e,t,s,d,c),!t.a||!t.b)return void(t.visible=!1);3>t.a.length&&(t.aaxis.smoothing=0),3>t.b.length&&(t.baxis.smoothing=0);var p=r(e,t,d);p||(t.visible=!1),t._cheater&&d("cheaterslope")}},{"../../components/color/attributes":592,"../../lib":719,"./ab_defaults":896,"./attributes":898,"./xy_defaults":922}],914:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),plot:e("./plot"),calc:e("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory"],meta:{}}},{"../../plots/cartesian":778,"./attributes":898,"./calc":902,"./defaults":913,"./plot":919}],915:[function(e,t){"use strict";t.exports=function(e,t){for(var a=e._fullData.length,r=0,o,n;r<a;r++)if(n=e._fullData[r],n.index!==t.index&&"carpet"===n.type&&(o||(o=n),n.carpet===t.carpet))return n;return o}},{}],916:[function(e,t){"use strict";t.exports=function(e,t,a){if(0===e.length)return"";var r=[],o=a?3:1,n;for(n=0;n<e.length;n+=o)r.push(e[n]+","+t[n]),a&&n<e.length-o&&(r.push("C"),r.push([e[n+1]+","+t[n+1],e[n+2]+","+t[n+2]+" "].join(" ")));return r.join(a?"":"L")}},{}],917:[function(e,t){"use strict";var a=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r){var o;for(a(e)?e.length>t.length&&(e=e.slice(0,t.length)):e=[],o=0;o<t.length;o++)e[o]=r(t[o]);return e}},{"../../lib":719}],918:[function(e,t){"use strict";t.exports=function(e,t,a,r,o,i){var n=o[0]*e.dpdx(t),l=o[1]*e.dpdy(a),s=1,d=1;if(i){var c=N(o[0]*o[0]+o[1]*o[1]),p=N(i[0]*i[0]+i[1]*i[1]),u=(o[0]*i[0]+o[1]*i[1])/c/p;d=va(0,u)}var g=180*L(l,n)/Pe;return-90>g?(g+=180,s=-s):90<g&&(g-=180,s=-s),{angle:g,flip:s,p:e.c2p(r,t,a),offsetMultplier:d}}},{}],919:[function(e,t){"use strict";function a(e,a,t,r,o){var n=t.select("#"+e._clipPathId),l,s,d,u;n.size()||(n=t.append("clipPath").classed("carpetclip",!0));var g=h.ensureSingle(n,"path","carpetboundary"),m=a.clipsegments,y=[];for(u=0;u<m.length;u++)l=m[u],s=c([],l.x,r.c2p),d=c([],l.y,o.c2p),y.push(p(s,d,l.bicubic));var f="M"+y.join("L")+"Z";n.attr("id",e._clipPathId),g.attr("d",f)}function r(e,t,a,r,o,i){var n="const-"+o+"-lines",s=a.selectAll("."+n).data(i);s.enter().append("path").classed(n,!0).style("vector-effect","non-scaling-stroke"),s.each(function(a){var r=a,o=r.x,i=r.y,n=c([],o,e.c2p),s=c([],i,t.c2p),d="M"+p(n,s,r.smoothing),u=l.select(this);u.attr("d",d).style("stroke-width",r.width).style("stroke",r.color).style("fill","none")}),s.exit().remove()}function o(e,a,r,o,i,t,n,d){var c=t.selectAll("text."+d).data(n);c.enter().append("text").classed(d,!0);var p=0,h={};return c.each(function(t,n){var i;if("auto"===t.axis.tickangle)i=u(o,a,r,t.xy,t.dxy);else{var d=(t.axis.tickangle+180)*Pe/180;i=u(o,a,r,t.xy,[R(d),De(d)])}n||(h={angle:i.angle,flip:i.flip});var c=(t.endAnchor?-1:1)*i.flip,m=l.select(this).attr({"text-anchor":0<c?"start":"end","data-notex":1}).call(s.font,t.font).text(t.text).call(g.convertToTspans,e),y=s.bBox(this);m.attr("transform","translate("+i.p[0]+","+i.p[1]+") rotate("+i.angle+")translate("+t.axis.labelpadding*c+","+.3*y.height+")"),p=va(p,y.width+t.axis.labelpadding)}),c.exit().remove(),h.maxExtent=p,h}function i(e,r,o,i,t,l,s,d){var c=h.aggNums(Math.min,null,o.a),p=h.aggNums(Math.max,null,o.a),g=h.aggNums(Math.min,null,o.b),m=h.aggNums(Math.max,null,o.b),y,f,x,_;y=.5*(c+p),f=g,x=o.ab2xy(y,f,!0),_=o.dxyda_rough(y,f),s.angle===void 0&&h.extendFlat(s,u(o,t,l,x,o.dxydb_rough(y,f))),n(e,r,o,i,x,_,o.aaxis,t,l,s,"a-title"),y=c,f=.5*(g+m),x=o.ab2xy(y,f,!0),_=o.dxydb_rough(y,f),d.angle===void 0&&h.extendFlat(d,u(o,t,l,x,o.dxyda_rough(y,f))),n(e,r,o,i,x,_,o.baxis,t,l,d,"b-title")}function n(e,a,r,o,t,i,n,d,c,p,h){var m=[];n.title.text&&m.push(n.title.text);var x=a.selectAll("text."+h).data(m),_=p.maxExtent;x.enter().append("text").classed(h,!0),x.each(function(){var a=u(r,d,c,t,i);-1===["start","both"].indexOf(n.showticklabels)&&(_=0);var o=n.title.font.size;_+=o+n.title.offset;var h=p.angle+(0>p.flip?180:0),m=(h-a.angle+450)%360,x=l.select(this);x.text(n.title.text).call(g.convertToTspans,e),90<m&&270>m&&(_=(-g.lineCount(x)+f)*y*o-_),x.attr("transform","translate("+a.p[0]+","+a.p[1]+") rotate("+a.angle+") translate(0,"+_+")").classed("user-select-none",!0).attr("text-anchor","middle").call(s.font,n.title.font)}),x.exit().remove()}var l=e("d3"),s=e("../../components/drawing"),c=e("./map_1d_array"),p=e("./makepath"),u=e("./orient_text"),g=e("../../lib/svg_text_utils"),h=e("../../lib"),m=e("../../constants/alignment");t.exports=function(e,t,n,s){var d=t.xaxis,c=t.yaxis,p=e._fullLayout,u=p._clips;h.makeTraceGroups(s,n,"trace").each(function(t){var n=l.select(this),s=t[0],p=s.trace,g=p.aaxis,m=p.baxis,y=h.ensureSingle(n,"g","minorlayer"),f=h.ensureSingle(n,"g","majorlayer"),x=h.ensureSingle(n,"g","boundarylayer"),_=h.ensureSingle(n,"g","labellayer");n.style("opacity",p.opacity),r(d,c,f,g,"a",g._gridlines,!0),r(d,c,f,m,"b",m._gridlines,!0),r(d,c,y,g,"a",g._minorgridlines,!0),r(d,c,y,m,"b",m._minorgridlines,!0),r(d,c,x,g,"a-boundary",g._boundarylines),r(d,c,x,m,"b-boundary",m._boundarylines);var b=o(e,d,c,p,s,_,g._labels,"a-label"),v=o(e,d,c,p,s,_,m._labels,"b-label");i(e,_,p,s,d,c,b,v),a(p,s,u,d,c)})};var y=m.LINE_SPACING,f=(1-m.MID_SHIFT)/y+1},{"../../components/drawing":614,"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"./makepath":916,"./map_1d_array":917,"./orient_text":918,d3:163}],920:[function(e,t){"use strict";var r=e("./constants"),o=e("../../lib/search").findBin,i=e("./compute_control_points"),n=e("./create_spline_evaluator"),l=e("./create_i_derivative_evaluator"),s=e("./create_j_derivative_evaluator");t.exports=function(e){var t=e._a,a=e._b,d=t.length,c=a.length,p=e.aaxis,u=e.baxis,g=t[0],h=t[d-1],m=a[0],y=a[c-1],f=t[t.length-1]-t[0],x=a[a.length-1]-a[0],_=f*r.RELATIVE_CULL_TOLERANCE,b=x*r.RELATIVE_CULL_TOLERANCE;g-=_,h+=_,m-=b,y+=b,e.isVisible=function(e,t){return e>g&&e<h&&t>m&&t<y},e.isOccluded=function(e,t){return e<g||e>h||t<m||t>y},e.setScale=function(){var t=e._x,a=e._y,r=i(e._xctrl,e._yctrl,t,a,p.smoothing,u.smoothing);e._xctrl=r[0],e._yctrl=r[1],e.evalxy=n([e._xctrl,e._yctrl],d,c,p.smoothing,u.smoothing),e.dxydi=l([e._xctrl,e._yctrl],p.smoothing,u.smoothing),e.dxydj=s([e._xctrl,e._yctrl],p.smoothing,u.smoothing)},e.i2a=function(e){var a=va(0,ba(e[0]),d-2),r=e[0]-a;return(1-r)*t[a]+r*t[a+1]},e.j2b=function(e){var t=va(0,ba(e[1]),d-2),r=e[1]-t;return(1-r)*a[t]+r*a[t+1]},e.ij2ab=function(t){return[e.i2a(t[0]),e.j2b(t[1])]},e.a2i=function(e){var a=va(0,ea(o(e,t),d-2)),r=t[a],i=t[a+1];return va(0,ea(d-1,a+(e-r)/(i-r)))},e.b2j=function(e){var t=va(0,ea(o(e,a),c-2)),r=a[t],i=a[t+1];return va(0,ea(c-1,t+(e-r)/(i-r)))},e.ab2ij=function(t){return[e.a2i(t[0]),e.b2j(t[1])]},e.i2c=function(t,a){return e.evalxy([],t,a)},e.ab2xy=function(r,o,n){if(!n&&(r<t[0]||r>t[d-1]|o<a[0]||o>a[c-1]))return[!1,!1];var l=e.a2i(r),i=e.b2j(o),s=e.evalxy([],l,i);if(n){var p=0,u=0,g=[],h,m,y,f;r<t[0]?(h=0,m=0,p=(r-t[0])/(t[1]-t[0])):r>t[d-1]?(h=d-2,m=1,p=(r-t[d-1])/(t[d-1]-t[d-2])):(h=va(0,ea(d-2,ba(l))),m=l-h),o<a[0]?(y=0,f=0,u=(o-a[0])/(a[1]-a[0])):o>a[c-1]?(y=c-2,f=1,u=(o-a[c-1])/(a[c-1]-a[c-2])):(y=va(0,ea(c-2,ba(i))),f=i-y),p&&(e.dxydi(g,h,y,m,f),s[0]+=g[0]*p,s[1]+=g[1]*p),u&&(e.dxydj(g,h,y,m,f),s[0]+=g[0]*u,s[1]+=g[1]*u)}return s},e.c2p=function(e,t,a){return[t.c2p(e[0]),a.c2p(e[1])]},e.p2x=function(e,t,a){return[t.p2c(e[0]),a.p2c(e[1])]},e.dadi=function(e){var a=va(0,ea(t.length-2,e));return t[a+1]-t[a]},e.dbdj=function(e){var t=va(0,ea(a.length-2,e));return a[t+1]-a[t]},e.dxyda=function(t,a,r,o){var i=e.dxydi(null,t,a,r,o),n=e.dadi(t,r);return[i[0]/n,i[1]/n]},e.dxydb=function(t,a,r,o){var i=e.dxydj(null,t,a,r,o),n=e.dbdj(a,o);return[i[0]/n,i[1]/n]},e.dxyda_rough=function(t,a,r){var o=f*(r||.1),i=e.ab2xy(t+o,a,!0),n=e.ab2xy(t-o,a,!0);return[.5*(i[0]-n[0])/o,.5*(i[1]-n[1])/o]},e.dxydb_rough=function(t,a,r){var o=x*(r||.1),i=e.ab2xy(t,a+o,!0),n=e.ab2xy(t,a-o,!0);return[.5*(i[0]-n[0])/o,.5*(i[1]-n[1])/o]},e.dpdx=function(e){return e._m},e.dpdy=function(e){return e._m}}},{"../../lib/search":738,"./compute_control_points":908,"./constants":909,"./create_i_derivative_evaluator":910,"./create_j_derivative_evaluator":911,"./create_spline_evaluator":912}],921:[function(e,t){"use strict";var r=e("../../lib");t.exports=function(e,t,a){function o(t,a){var r=0,o=0,i;return 0<t&&void 0!==(i=e[a][t-1])&&(o++,r+=i),t<p-1&&void 0!==(i=e[a][t+1])&&(o++,r+=i),0<a&&void 0!==(i=e[a-1][t])&&(o++,r+=i),a<u-1&&void 0!==(i=e[a+1][t])&&(o++,r+=i),r/va(1,o)}var l=[],s=[],p=e[0].length,u=e.length,g=0,h,m,y;for(h=0;h<p;h++)for(m=0;m<u;m++)void 0===e[m][h]&&(l.push(h),s.push(m),e[m][h]=o(h,m)),g=va(g,_a(e[m][h]));if(!l.length)return e;var f=0,x=0,_=l.length,n,b,v,w,T,A,S,C,L,E,I;do{for(f=0,y=0;y<_;y++){h=l[y],m=s[y];var z=0,P=0,D,O,R,M,F,B;0===h?(F=ea(p-1,2),R=t[F],M=t[1],D=e[m][F],O=e[m][1],P+=O+(O-D)*(t[0]-M)/(M-R),z++):h===p-1&&(F=va(0,p-3),R=t[F],M=t[p-2],D=e[m][F],O=e[m][p-2],P+=O+(O-D)*(t[p-1]-M)/(M-R),z++),(0===h||h===p-1)&&0<m&&m<u-1&&(n=a[m+1]-a[m],b=a[m]-a[m-1],P+=(b*e[m+1][h]+n*e[m-1][h])/(b+n),z++),0===m?(B=ea(u-1,2),R=a[B],M=a[1],D=e[B][h],O=e[1][h],P+=O+(O-D)*(a[0]-M)/(M-R),z++):m===u-1&&(B=va(0,u-3),R=a[B],M=a[u-2],D=e[B][h],O=e[u-2][h],P+=O+(O-D)*(a[u-1]-M)/(M-R),z++),(0===m||m===u-1)&&0<h&&h<p-1&&(n=t[h+1]-t[h],b=t[h]-t[h-1],P+=(b*e[m][h+1]+n*e[m][h-1])/(b+n),z++),z?P/=z:(v=t[h+1]-t[h],w=t[h]-t[h-1],T=a[m+1]-a[m],A=a[m]-a[m-1],S=v*w*(v+w),C=T*A*(T+A),P=(S*(A*e[m+1][h]+T*e[m-1][h])+C*(w*e[m][h+1]+v*e[m][h-1]))/(C*(w+v)+S*(A+T))),L=P-e[m][h],E=L/g,f+=E*E,I=z?0:.85,e[m][h]+=L*(1+I)}f=N(f)}while(x++<100&&f>1e-5);return r.log("Smoother converged to",f,"after",x,"iterations"),e}},{"../../lib":719}],922:[function(e,t){"use strict";var a=e("../../lib").isArray1D;t.exports=function(e,t,r){var o=r("x"),i=o&&o.length,n=r("y"),l=n&&n.length;if(!i&&!l)return!1;if(t._cheater=!o,(!i||a(o))&&(!l||a(n))){var s=i?o.length:1/0;l&&(s=ea(s,n.length)),t.a&&t.a.length&&(s=ea(s,t.a.length)),t.b&&t.b.length&&(s=ea(s,t.b.length)),t._length=s}else t._length=null;return!0}},{"../../lib":719}],923:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),r=e("../scattergeo/attributes"),o=e("../../components/colorscale/attributes"),i=e("../../plots/attributes"),n=e("../../components/color/attributes").defaultLine,l=e("../../lib/extend").extendFlat,s=r.marker.line;t.exports=l({locations:{valType:"data_array",editType:"calc"},locationmode:r.locationmode,z:{valType:"data_array",editType:"calc"},text:l({},r.text,{}),hovertext:l({},r.hovertext,{}),marker:{line:{color:l({},s.color,{dflt:n}),width:l({},s.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:r.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:r.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:l({},i.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:a()},o("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":592,"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../scattergeo/attributes":1151}],924:[function(e,t){"use strict";function a(e){return e&&"string"==typeof e}var r=e("fast-isnumeric"),o=e("../../constants/numerical").BADNUM,n=e("../../components/colorscale/calc"),l=e("../scatter/arrays_to_calcdata"),s=e("../scatter/calc_selection");t.exports=function(e,t){var d=t._length,c=Array(d),p;p=t.geojson?function(e){return a(e)||r(e)}:a;for(var u=0;u<d;u++){var g=c[u]={},h=t.locations[u],m=t.z[u];p(h)&&r(m)?(g.loc=h,g.z=m):(g.loc=null,g.z=o),g.index=u}return l(c,t),n(e,t,{vals:t.z,containerStr:"",cLetter:"z"}),s(c,t),c}},{"../../components/colorscale/calc":601,"../../constants/numerical":695,"../scatter/arrays_to_calcdata":1111,"../scatter/calc_selection":1114,"fast-isnumeric":225}],925:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/colorscale/defaults"),o=e("./attributes");t.exports=function(e,t,i,n){function l(r,i){return a.coerce(e,t,o,r,i)}var s=l("locations"),d=l("z");if(!(s&&s.length&&a.isArrayOrTypedArray(d)&&d.length))return void(t.visible=!1);t._length=ea(s.length,d.length),l("locationmode"),l("text"),l("hovertext"),l("hovertemplate");var c=l("marker.line.width");c&&l("marker.line.color"),l("marker.opacity"),r(e,t,n,l,{prefix:"",cLetter:"z"}),a.coerceSelectionMarkerOpacity(t,l)}},{"../../components/colorscale/defaults":603,"../../lib":719,"./attributes":923}],926:[function(e,t){"use strict";t.exports=function(e,t,a,r,o){e.location=t.location,e.z=t.z;var i=r[o];return i.fIn&&(e.properties=i.fIn.properties),e}},{}],927:[function(e,t){"use strict";function a(e,t,a){if(!t.hovertemplate){var r=a.hi||t.hoverinfo,n="all"===r?o.hoverinfo.flags:r.split("+"),l=-1!==n.indexOf("name"),s=-1!==n.indexOf("location"),d=-1!==n.indexOf("z"),c=-1!==n.indexOf("text"),p=[];!l&&s?e.nameOverride=a.loc:(l&&(e.nameOverride=t.name),s&&p.push(a.loc)),d&&p.push(e.zLabel),c&&i(a,t,p),e.extraText=p.join("<br>")}}var r=e("../../plots/cartesian/axes"),o=e("./attributes"),i=e("../../lib").fillText;t.exports=function(e,t,o){var n=e.cd,l=n[0].trace,s=e.subplot,d,c,p,u;for(c=0;c<n.length;c++)if(d=n[c],u=!1,d._polygons){for(p=0;p<d._polygons.length;p++)d._polygons[p].contains([t,o])&&(u=!u),d._polygons[p].contains([t+360,o])&&(u=!u);if(u)break}if(u&&d)return e.x0=e.x1=e.xa.c2p(d.ct),e.y0=e.y1=e.ya.c2p(d.ct),e.index=d.index,e.location=d.loc,e.z=d.z,e.zLabel=r.tickText(s.mockAxis,s.mockAxis.c2l(d.z),"hover").text,e.hovertemplate=d.hovertemplate,a(e,l,d,s.mockAxis),[e]}},{"../../lib":719,"../../plots/cartesian/axes":767,"./attributes":923}],928:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("./calc"),plot:e("./plot").plot,style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"choropleth",basePlotModule:e("../../plots/geo"),categories:["geo","noOpacity"],meta:{}}},{"../../plots/geo":797,"../heatmap/colorbar":1004,"./attributes":923,"./calc":924,"./defaults":925,"./event_data":926,"./hover":927,"./plot":929,"./select":930,"./style":931}],929:[function(e,t){"use strict";function a(e,t){for(var a=e[0].trace,o=e.length,n=s(a,t),l=0;l<o;l++){var c=e[l],p=d(a.locationmode,c.loc,n);if(!p){c.geojson=null;continue}c.geojson=p,c.ct=p.properties.ct,c._polygons=r(p)}}function r(e){function t(e){for(var t=0;t<e.length-1;t++)if(0<e[t][0]&&0>e[t+1][0])return t;return null}var a=e.geometry,r=a.coordinates,o=e.id,i=[],n,s,d,c;switch(n="RUS"===o||"FJI"===o?function(e){var a;if(null===t(e))a=e;else for(a=Array(e.length),c=0;c<e.length;c++)a[c]=[0>e[c][0]?e[c][0]+360:e[c][0],e[c][1]];i.push(l.tester(a))}:"ATA"===o?function(e){var a=t(e);if(null===a)return i.push(l.tester(e));var r=Array(e.length+1),o=0;for(c=0;c<e.length;c++)c>a?r[o++]=[e[c][0]+360,e[c][1]]:c===a?(r[o++]=e[c],r[o++]=[e[c][0],-90]):r[o++]=e[c];var n=l.tester(r);n.pts.pop(),i.push(n)}:function(e){i.push(l.tester(e))},a.type){case"MultiPolygon":for(s=0;s<r.length;s++)for(d=0;d<r[s].length;d++)n(r[s][d]);break;case"Polygon":for(s=0;s<r.length;s++)n(r[s]);}return i}var o=e("d3"),n=e("../../lib"),l=e("../../lib/polygon"),s=e("../../lib/topojson_utils").getTopojsonFeatures,d=e("../../lib/geo_location_utils").locationToFeature,c=e("./style").style;t.exports={plot:function(e,t,r){for(var l=0;l<r.length;l++)a(r[l],t.topojson);var s=t.layers.backplot.select(".choroplethlayer");n.makeTraceGroups(s,r,"trace choropleth").each(function(t){var a=o.select(this),r=a.selectAll("path.choroplethlocation").data(n.identity);r.enter().append("path").classed("choroplethlocation",!0),r.exit().remove(),c(e,t)})},feature2polygons:r}},{"../../lib":719,"../../lib/geo_location_utils":713,"../../lib/polygon":731,"../../lib/topojson_utils":746,"./style":931,d3:163}],930:[function(e,t){"use strict";t.exports=function(e,t){var a=e.cd,r=e.xaxis,o=e.yaxis,n=[],l,s,d,c,p;if(!1===t)for(l=0;l<a.length;l++)a[l].selected=0;else for(l=0;l<a.length;l++)s=a[l],d=s.ct,d&&(c=r.c2p(d),p=o.c2p(d),t.contains([c,p],null,l,e)?(n.push({pointNumber:l,lon:d[0],lat:d[1]}),s.selected=1):s.selected=0);return n}},{}],931:[function(e,t){"use strict";function a(e,t){var a=t[0].trace,l=t[0].node3,s=l.selectAll(".choroplethlocation"),c=a.marker||{},p=c.line||{},u=n.makeColorScaleFuncFromTrace(a);s.each(function(e){r.select(this).attr("fill",u(e.z)).call(o.stroke,e.mlc||p.color).call(i.dashLine,"",e.mlw||p.width||0).style("opacity",c.opacity)}),i.selectedPointStyle(s,a,e)}var r=e("d3"),o=e("../../components/color"),i=e("../../components/drawing"),n=e("../../components/colorscale");t.exports={style:function(e,t){t&&a(e,t)},styleOnSelect:function(e,t){var r=t[0].node3,o=t[0].trace;o.selectedpoints?i.selectedPointStyle(r.selectAll(".choroplethlocation"),o,e):a(e,t)}}},{"../../components/color":593,"../../components/colorscale":605,"../../components/drawing":614,d3:163}],932:[function(e,t){"use strict";var a=e("../choropleth/attributes"),r=e("../../components/colorscale/attributes"),o=e("../../components/fx/hovertemplate_attributes"),i=e("../../lib/extend").extendFlat;t.exports=i({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},below:{valType:"string",editType:"plot"},text:a.text,hovertext:a.hovertext,marker:{line:{color:i({},a.marker.line.color,{editType:"plot"}),width:i({},a.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:i({},a.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:i({},a.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:i({},a.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:a.hoverinfo,hovertemplate:o({},{keys:["properties"]})},r("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../choropleth/attributes":923}],933:[function(e,t){"use strict";function a(e){var t=e[0].trace,a=t._opts,r;if(t.selectedpoints){for(var o=c.makeSelectedPointStyleFns(t),n=0,l;n<e.length;n++)l=e[n],l.fOut&&(l.fOut.properties.mo2=o.selectedOpacityFn(l));r={type:"identity",property:"mo2"}}else r=s.isArrayOrTypedArray(t.marker.opacity)?{type:"identity",property:"mo"}:t.marker.opacity;return s.extendFlat(a.fill.paint,{"fill-opacity":r}),s.extendFlat(a.line.paint,{"line-opacity":r}),a}function r(e){var t=e.geometry,a;if("MultiPolygon"===t.type)for(var r=t.coordinates,o=0,s=0;s<r.length;s++){var d={type:"Polygon",coordinates:r[s]},c=n.default(d);c>o&&(o=c,a=d)}else a=t;return l.default(a).geometry.coordinates}var o=e("fast-isnumeric"),n=e("@turf/area"),l=e("@turf/centroid"),s=e("../../lib"),d=e("../../components/colorscale"),c=e("../../components/drawing"),p=e("../../lib/geojson_utils").makeBlank,u=e("../choropleth/plot").feature2polygons;t.exports={convert:function(e){function t(e){var t=y[e.id];if(t){var a=e.geometry;if("Polygon"===a.type||"MultiPolygon"===a.type){var o={fc:b(t.z)};w&&(o.mo=w(t)),T&&(o.mlc=T(t)),A&&(o.mlw=A(t));var i={type:"Feature",geometry:a,properties:o};t._polygons=u(i),t.ct=r(i),t.fIn=e,t.fOut=i,f.push(i)}else s.log(["Location with id",t.loc,"does not have a valid GeoJSON geometry,","choroplethmapbox traces only support *Polygon* and *MultiPolygon* geometries."].join(" "))}delete y[e.id]}var n=e[0].trace,l=!0===n.visible&&0!==n._length,c={layout:{visibility:"none"},paint:{}},g={layout:{visibility:"none"},paint:{}},h=n._opts={fill:c,line:g,geojson:p()};if(!l)return h;var m="string"==typeof n.geojson?(window.PlotlyGeoAssets||{})[n.geojson]:n.geojson;if(!s.isPlainObject(m))return s.error("Oops ... something when wrong when fetching "+n.geojson),h;var y={},f=[],x;for(x=0;x<e.length;x++){var _=e[x];_.loc&&(y[_.loc]=_)}var b=d.makeColorScaleFuncFromTrace(n),v=n.marker,k=v.line||{},w;s.isArrayOrTypedArray(v.opacity)&&(w=function(e){var t=e.mo;return o(t)?+s.constrain(t,0,1):0});var T;s.isArrayOrTypedArray(k.color)&&(T=function(e){return e.mlc});var A;switch(s.isArrayOrTypedArray(k.width)&&(A=function(e){return e.mlw}),m.type){case"FeatureCollection":var S=m.features;for(x=0;x<S.length;x++)t(S[x]);break;case"Feature":t(m);break;default:return s.warn(["Invalid GeoJSON type",(m.type||"none")+",","choroplethmapbox traces only support *FeatureCollection* and *Feature* types."].join(" ")),h;}for(var C in y)s.log("Location with id "+C+" does not have a matching feature");var L=w?{type:"identity",property:"mo"}:v.opacity;return s.extendFlat(c.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),s.extendFlat(g.paint,{"line-color":T?{type:"identity",property:"mlc"}:k.color,"line-width":A?{type:"identity",property:"mlw"}:k.width,"line-opacity":L}),c.layout.visibility="visible",g.layout.visibility="visible",h.geojson={type:"FeatureCollection",features:f},a(e),h},convertOnSelect:a}},{"../../components/colorscale":605,"../../components/drawing":614,"../../lib":719,"../../lib/geojson_utils":714,"../choropleth/plot":929,"@turf/area":55,"@turf/centroid":56,"fast-isnumeric":225}],934:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/colorscale/defaults"),o=e("./attributes");t.exports=function(e,t,i,n){function l(r,i){return a.coerce(e,t,o,r,i)}var s=l("locations"),d=l("z"),c=l("geojson");if(!a.isArrayOrTypedArray(s)||!s.length||!a.isArrayOrTypedArray(d)||!d.length||!("string"==typeof c&&""!==c||a.isPlainObject(c)))return void(t.visible=!1);t._length=ea(s.length,d.length),l("below"),l("text"),l("hovertext"),l("hovertemplate");var p=l("marker.line.width");p&&l("marker.line.color"),l("marker.opacity"),r(e,t,n,l,{prefix:"",cLetter:"z"}),a.coerceSelectionMarkerOpacity(t,l)}},{"../../components/colorscale/defaults":603,"../../lib":719,"./attributes":932}],935:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../choropleth/calc"),plot:e("./plot"),hoverPoints:e("../choropleth/hover"),eventData:e("../choropleth/event_data"),selectPoints:e("../choropleth/select"),styleOnSelect:function(e,t){if(t){var a=t[0].trace;a._glTrace.updateOnSelect(t)}},getBelow:function(e,t){for(var a=t.getMapLayers(),r=a.length-2,o;0<=r;r--)if(o=a[r].id,"string"==typeof o&&0===o.indexOf("water"))for(var n=r+1;n<a.length;n++)if(o=a[n].id,"string"==typeof o&&-1===o.indexOf("plotly-"))return o},moduleType:"trace",name:"choroplethmapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","noOpacity"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":822,"../choropleth/calc":924,"../choropleth/event_data":926,"../choropleth/hover":927,"../choropleth/select":930,"../heatmap/colorbar":1004,"./attributes":932,"./defaults":934,"./plot":936}],936:[function(e,t){"use strict";function a(e,t){this.subplot=e,this.uid=t,this.sourceId="source-"+t,this.layerList=[["fill",i+t+"-fill"],["line",i+t+"-line"]],this.below=null}var r=e("./convert").convert,o=e("./convert").convertOnSelect,i=e("../../plots/mapbox/constants").traceLayerPrefix,n=a.prototype;n.update=function(e){this._update(r(e))},n.updateOnSelect=function(e){this._update(o(e))},n._update=function(e){var t=this.subplot,a=this.layerList,r=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(e.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(e,r),this.below=r);for(var o=0;o<a.length;o++){var n=a[o],l=n[0],s=n[1],d=e[l];t.setOptions(s,"setLayoutProperty",d.layout),"visible"===d.layout.visibility&&t.setOptions(s,"setPaintProperty",d.paint)}},n._addLayers=function(e,t){for(var a=this.subplot,r=this.layerList,o=this.sourceId,n=0;n<r.length;n++){var l=r[n],s=l[0],d=e[s];a.addLayer({type:s,id:l[1],source:o,layout:d.layout,paint:d.paint},t)}},n._removeLayers=function(){for(var e=this.subplot.map,t=this.layerList,a=t.length-1;0<=a;a--)e.removeLayer(t[a][1])},n.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},t.exports=function(e,t){var o=t[0].trace,i=new a(e,o.uid),n=i.sourceId,l=r(t),s=i.below=e.belowLookup["trace-"+o.uid];return e.map.addSource(n,{type:"geojson",data:l.geojson}),i._addLayers(l,s),t[0].trace._glTrace=i,i}},{"../../plots/mapbox/constants":820,"./convert":933}],937:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("../mesh3d/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:r({editType:"calc"},{keys:["norm"]})};n(l,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));["opacity","lightposition","lighting"].forEach(function(e){l[e]=o[e]}),l.hoverinfo=n({},i.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,t.exports=l},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../mesh3d/attributes":1053}],938:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){for(var r=t.u,o=t.v,n=t.w,l=ea(t.x.length,t.y.length,t.z.length,r.length,o.length,n.length),s=-Infinity,d=1/0,c=0;c<l;c++){var p=r[c],u=o[c],g=n[c],h=N(p*p+u*u+g*g);s=va(s,h),d=ea(d,h)}t._len=l,t._normMax=s,a(e,t,{vals:[d,s],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":601}],939:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.mesh=null,this.data=null}function r(e,t){function a(e,t){var a=r[t],o=i[p[t]];return n(e,function(e){return a.d2l(e)*o})}var r=e.fullSceneLayout,i=e.dataScale,c={};c.vectors=d(a(t.u,"xaxis"),a(t.v,"yaxis"),a(t.w,"zaxis"),t._len),c.positions=d(a(t.x,"xaxis"),a(t.y,"yaxis"),a(t.z,"zaxis"),t._len);var h=s(t);c.colormap=l(t),c.vertexIntensityBounds=[h.min/t._normMax,h.max/t._normMax],c.coneOffset=u[t.anchor],c.coneSize="scaled"===t.sizemode?t.sizeref||.5:t.sizeref&&t._normMax?t.sizeref/t._normMax:.5;var m=o(c),y=t.lightposition;return m.lightPosition=[y.x,y.y,y.z],m.ambient=t.lighting.ambient,m.diffuse=t.lighting.diffuse,m.specular=t.lighting.specular,m.roughness=t.lighting.roughness,m.fresnel=t.lighting.fresnel,m.opacity=t.opacity,t._pad=g[t.anchor]*m.vectorScale*m.coneScale*t._normMax,m}var o=e("gl-cone3d"),i=e("gl-cone3d").createConeMesh,n=e("../../lib").simpleMap,l=e("../../lib/gl_format_color").parseColorScale,s=e("../../components/colorscale").extractOpts,d=e("../../plots/gl3d/zip3"),c=a.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index,a=this.data.x[t],r=this.data.y[t],o=this.data.z[t],i=this.data.u[t],n=this.data.v[t],l=this.data.w[t];e.traceCoordinate=[a,r,o,i,n,l,N(i*i+n*n+l*l)];var s=this.data.hovertext||this.data.text;return Array.isArray(s)&&void 0!==s[t]?e.textLabel=s[t]:s&&(e.textLabel=s),!0}};var p={xaxis:0,yaxis:1,zaxis:2},u={tip:1,tail:0,cm:.25,center:.5},g={tip:1,tail:1,cm:.75,center:.5};c.update=function(e){this.data=e;var t=r(this.scene,e);this.mesh.update(t)},c.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var o=e.glplot.gl,n=r(e,t),l=i(o,n),s=new a(e,t.uid);return s.mesh=l,s.data=t,l._trace=s,e.glplot.add(l),s}},{"../../components/colorscale":605,"../../lib":719,"../../lib/gl_format_color":716,"../../plots/gl3d/zip3":818,"gl-cone3d":242}],940:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/colorscale/defaults"),o=e("./attributes");t.exports=function(e,t,i,n){function l(r,i){return a.coerce(e,t,o,r,i)}var s=l("u"),d=l("v"),c=l("w"),p=l("x"),u=l("y"),g=l("z");return s&&s.length&&d&&d.length&&c&&c.length&&p&&p.length&&u&&u.length&&g&&g.length?void(l("sizeref"),l("sizemode"),l("anchor"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),r(e,t,n,l,{prefix:"",cLetter:"c"}),l("text"),l("hovertext"),l("hovertemplate"),t._length=null):void(t.visible=!1)}},{"../../components/colorscale/defaults":603,"../../lib":719,"./attributes":937}],941:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"cone",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),eventData:function(e,t){return e.norm=t.traceCoordinate[6],e},meta:{}}},{"../../plots/gl3d":807,"./attributes":937,"./calc":938,"./convert":939,"./defaults":940}],942:[function(e,t){"use strict";var a=e("../heatmap/attributes"),r=e("../scatter/attributes"),o=e("../../components/colorscale/attributes"),i=e("../../components/drawing/attributes").dash,n=e("../../plots/font_attributes"),l=e("../../lib/extend").extendFlat,s=e("../../constants/filter_ops"),d=s.COMPARISON_OPS2,c=s.INTERVAL_OPS,p=e("../../constants/docs").FORMAT_LINK,u=r.line;t.exports=l({z:a.z,x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,xtype:a.xtype,ytype:a.ytype,zhoverformat:a.zhoverformat,hovertemplate:a.hovertemplate,connectgaps:a.connectgaps,fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:n({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(d).concat(c),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:l({},u.color,{editType:"style+colorbars"}),width:l({},u.width,{editType:"style+colorbars"}),dash:i,smoothing:l({},u.smoothing,{}),editType:"plot"}},o("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":600,"../../components/drawing/attributes":613,"../../constants/docs":690,"../../constants/filter_ops":691,"../../lib/extend":710,"../../plots/font_attributes":793,"../heatmap/attributes":1001,"../scatter/attributes":1112}],943:[function(e,t){"use strict";var a=e("../../components/colorscale"),r=e("../heatmap/calc"),o=e("./set_contours"),i=e("./end_plus");t.exports=function(e,t){var n=r(e,t),l=n[0].z;o(t,l);var s=t.contours,d=a.extractOpts(t),c;if("heatmap"===s.coloring&&d.auto&&!1===t.autocontour){var p=s.start,u=i(s),g=s.size||1,h=ba((u-p)/g)+1;isFinite(g)||(g=1,h=1);var m=p-g/2,y=m+h*g;c=[m,y]}else c=l;return a.calc(e,t,{vals:c,cLetter:"z"}),n}},{"../../components/colorscale":605,"../heatmap/calc":1002,"./end_plus":953,"./set_contours":961}],944:[function(e,t){"use strict";t.exports=function(e,t,a,r){var o=e[0],n=o.x.length,l=o.y.length,s=o.z,d=r.contours,c=-Infinity,p=1/0,u,g,h;for(u=0;u<l;u++)p=ea(p,s[u][0]),p=ea(p,s[u][n-1]),c=va(c,s[u][0]),c=va(c,s[u][n-1]);for(u=1;u<n-1;u++)p=ea(p,s[0][u]),p=ea(p,s[l-1][u]),c=va(c,s[0][u]),c=va(c,s[l-1][u]);o.prefixBoundary=!1;">"===t?d.value>c&&(o.prefixBoundary=!0):"<"===t?d.value<p&&(o.prefixBoundary=!0):"[]"===t?(g=ea.apply(null,d.value),h=va.apply(null,d.value),(h<p||g>c)&&(o.prefixBoundary=!0)):"]["===t?(g=ea.apply(null,d.value),h=va.apply(null,d.value),g<p&&h>c&&(o.prefixBoundary=!0)):void 0}},{}],945:[function(e,t){"use strict";var a=e("../../components/colorscale").extractOpts,r=e("./make_color_map"),o=e("./end_plus");t.exports={min:"zmin",max:"zmax",calc:function(e,t,i){var n=t.contours,l=t.line,s=n.size||1,d=n.coloring,c=r(t,{isColorbar:!0});if("heatmap"===d){var p=a(t);i._fillgradient=t.colorscale,i._zrange=[p.min,p.max]}else"fill"===d&&(i._fillcolor=c);i._line={color:"lines"===d?c:l.color,width:!1===n.showlines?0:l.width,dash:l.dash},i._levels={start:n.start,end:o(n),size:s}}}},{"../../components/colorscale":605,"./end_plus":953,"./make_color_map":958}],946:[function(e,t){"use strict";t.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],947:[function(e,t){"use strict";function a(e,t){var a;-1===c.indexOf(t.operation)?(e("contours.value",[0,1]),Array.isArray(t.value)?2<t.value.length?t.value=t.value.slice(2):0===t.length?t.value=[0,1]:2>t.length?(a=parseFloat(t.value[0]),t.value=[a,a+1]):t.value=[parseFloat(t.value[0]),parseFloat(t.value[1])]:r(t.value)&&(a=parseFloat(t.value),t.value=[a,a+1])):(e("contours.value",0),!r(t.value)&&(Array.isArray(t.value)?t.value=parseFloat(t.value[0]):t.value=0))}var r=e("fast-isnumeric"),o=e("./label_defaults"),i=e("../../components/color"),n=i.addOpacity,l=i.opacity,s=e("../../constants/filter_ops"),d=s.CONSTRAINT_REDUCTION,c=s.COMPARISON_OPS2;t.exports=function(e,t,r,i,s,c){var p=t.contours,u=r("contours.operation"),g,h,m;if(p._operation=d[u],a(r,p),"="===u?g=p.showlines=!0:(g=r("contours.showlines"),m=r("fillcolor",n((e.line||{}).color||s,.5))),g){var y=m&&l(m)?n(t.fillcolor,1):s;h=r("line.color",y),r("line.width",2),r("line.dash")}r("line.smoothing"),o(r,i,h,c)}},{"../../components/color":593,"../../constants/filter_ops":691,"./label_defaults":957,"fast-isnumeric":225}],948:[function(e,t){"use strict";function a(e,t){function a(e){return n(e)?+e:null}var r=Array.isArray(t),o;return-1===i.COMPARISON_OPS2.indexOf(e)?-1===i.INTERVAL_OPS.indexOf(e)?-1!==i.SET_OPS.indexOf(e)&&(o=r?t.map(a):[a(t)]):o=r?[a(t[0]),a(t[1])]:[a(t),a(t)]:o=r?a(t[0]):a(t),o}function r(e){return function(t){t=a(e,t);var r=ea(t[0],t[1]),o=va(t[0],t[1]);return{start:r,end:o,size:o-r}}}function o(e){return function(t){return t=a(e,t),{start:t,end:1/0,size:1/0}}}var i=e("../../constants/filter_ops"),n=e("fast-isnumeric");t.exports={"[]":r("[]"),"][":r("]["),">":o(">"),"<":o("<"),"=":o("=")}},{"../../constants/filter_ops":691,"fast-isnumeric":225}],949:[function(e,t){"use strict";t.exports=function(e,t,a,r){var o=r("contours.start"),i=r("contours.end"),n=a("contours.size"),l;l=!1===o||!1===i?t.autocontour=!0:a("autocontour",!1),(l||!n)&&a("ncontours")}},{}],950:[function(e,t){"use strict";function a(e){return r.extendFlat({},e,{edgepaths:r.extendDeep([],e.edgepaths),paths:r.extendDeep([],e.paths)})}var r=e("../../lib");t.exports=function(e,t){var o=function(e){return e.reverse()},n=function(e){return e},l,s,d;switch(t){case"=":case"<":return e;case">":for(1!==e.length&&r.warn("Contour data invalid for the specified inequality operation."),s=e[0],l=0;l<s.edgepaths.length;l++)s.edgepaths[l]=o(s.edgepaths[l]);for(l=0;l<s.paths.length;l++)s.paths[l]=o(s.paths[l]);return e;case"][":var c=o;o=n,n=c;case"[]":for(2!==e.length&&r.warn("Contour data invalid for the specified inequality range operation."),s=a(e[0]),d=a(e[1]),l=0;l<s.edgepaths.length;l++)s.edgepaths[l]=o(s.edgepaths[l]);for(l=0;l<s.paths.length;l++)s.paths[l]=o(s.paths[l]);for(;d.edgepaths.length;)s.edgepaths.push(n(d.edgepaths.shift()));for(;d.paths.length;)s.paths.push(n(d.paths.shift()));return[s];}}},{"../../lib":719}],951:[function(e,t){"use strict";var a=e("../../lib"),r=e("../heatmap/xyz_defaults"),o=e("./constraint_defaults"),i=e("./contours_defaults"),n=e("./style_defaults"),l=e("./attributes");t.exports=function(e,t,s,d){function c(r,o){return a.coerce(e,t,l,r,o)}var p=r(e,t,c,d);if(!p)return void(t.visible=!1);c("text"),c("hovertext"),c("hovertemplate");var u="constraint"===c("contours.type");c("connectgaps",a.isArray1D(t.z)),u?o(e,t,c,d,s):(i(e,t,c,function(r){return a.coerce2(e,t,l,r)}),n(e,t,c,d))}},{"../../lib":719,"../heatmap/xyz_defaults":1015,"./attributes":942,"./constraint_defaults":947,"./contours_defaults":949,"./style_defaults":963}],952:[function(e,t){"use strict";var a=e("../../lib"),r=e("./constraint_mapping"),o=e("./end_plus");t.exports=function(e,t,i){for(var n="constraint"===e.type?r[e._operation](e.value):e,l=n.size,s=[],d=o(n),c=i.trace._carpetTrace,p=c?{xaxis:c.aaxis,yaxis:c.baxis,x:i.a,y:i.b}:{xaxis:t.xaxis,yaxis:t.yaxis,x:i.x,y:i.y},u=n.start;u<d;u+=l)if(s.push(a.extendFlat({level:u,crossings:{},starts:[],edgepaths:[],paths:[],z:i.z,smoothing:i.trace.line.smoothing},p)),1e3<s.length){a.warn("Too many contours, clipping at 1000",e);break}return s}},{"../../lib":719,"./constraint_mapping":948,"./end_plus":953}],953:[function(e,t){"use strict";t.exports=function(e){return e.end+e.size/1e6}},{}],954:[function(e,t){"use strict";function a(e,t,a,r){return _a(e[0]-t[0])<a&&_a(e[1]-t[1])<r}function r(e,t){var a=e[2]-t[2],r=e[3]-t[3];return N(a*a+r*r)}function o(e,t,o,p,u){function g(e){return _[e%_.length]}var h=t.join(","),y=h,f=e.crossings[y],x=l(f,o,t),_=[s(e,t,[-x[0],-x[1]])],b=x.join(","),v=e.z.length,m=e.z[0].length,n;for(n=0;1e4>n;n++){if(20<f?(f=c.CHOOSESADDLE[f][0>(x[0]||x[1])?0:1],e.crossings[y]=c.SADDLEREMAINDER[f]):delete e.crossings[y],x=c.NEWDELTA[f],!x){d.log("Found bad marching index:",f,t,e.level);break}_.push(s(e,t,x)),t[0]+=x[0],t[1]+=x[1],a(_[_.length-1],_[_.length-2],p,u)&&_.pop(),y=t.join(",");var k=x[0]&&(0>t[0]||t[0]>m-2)||x[1]&&(0>t[1]||t[1]>v-2),w=y===h&&x.join(",")===b;if(w||o&&k)break;f=e.crossings[y]}1e4===n&&d.log("Infinite loop in contour?");var T=a(_[0],_[_.length-1],p,u),A=0,S=.2*e.smoothing,C=[],L=0,E,I,z,P,D,O,R,M,F,B,N;for(n=1;n<_.length;n++)R=r(_[n],_[n-1]),A+=R,C.push(R);var V=A/C.length*S;for(n=_.length-2;n>=L;n--)if(E=C[n],E<V){for(z=0,I=n-1;I>=L&&E+C[I]<V;I--)E+=C[I];if(T&&n===_.length-2)for(z=0;z<I&&E+C[z]<V;z++)E+=C[z];D=n-I+z+1,O=ba((n+I+z+2)/2),P=T||n!==_.length-2?T||-1!==I?D%2?g(O):[(g(O)[0]+g(O+1)[0])/2,(g(O)[1]+g(O+1)[1])/2]:_[0]:_[_.length-1],_.splice(I+1,n-I+1,P),n=I+1,z&&(L=z),T&&(n===_.length-2?_[z]=_[_.length-1]:0===n&&(_[_.length-1]=_[0]))}for(_.splice(0,L),n=0;n<_.length;n++)_[n].length=2;if(!(2>_.length))if(T)_.pop(),e.paths.push(_);else{o||d.log("Unclosed interior contour?",e.level,h,_.join("L"));var U=!1;for(M=0;M<e.edgepaths.length;M++)if(B=e.edgepaths[M],!U&&a(B[0],_[_.length-1],p,u)){_.pop(),U=!0;var H=!1;for(F=0;F<e.edgepaths.length;F++)if(N=e.edgepaths[F],a(N[N.length-1],_[0],p,u)){H=!0,_.shift(),e.edgepaths.splice(M,1),F===M?e.paths.push(_.concat(N)):(F>M&&F--,e.edgepaths[F]=N.concat(_,B));break}H||(e.edgepaths[M]=_.concat(B))}for(M=0;M<e.edgepaths.length&&!U;M++)B=e.edgepaths[M],a(B[B.length-1],_[0],p,u)&&(_.shift(),e.edgepaths[M]=B.concat(_),U=!0);U||e.edgepaths.push(_)}}function l(e,t,a){var r=0,o=0;return 20<e&&t?208===e||1114===e?r=0===a[0]?1:-1:o=0===a[1]?1:-1:-1===c.BOTTOMSTART.indexOf(e)?-1===c.LEFTSTART.indexOf(e)?-1===c.TOPSTART.indexOf(e)?r=-1:o=-1:r=1:o=1,[r,o]}function s(e,t,a){var r=t[0]+va(a[0],0),o=t[1]+va(a[1],0),i=e.z[o][r],n=e.xaxis,l=e.yaxis;if(a[1]){var s=(e.level-i)/(e.z[o][r+1]-i);return[n.c2p((1-s)*e.x[r]+s*e.x[r+1],!0),l.c2p(e.y[o],!0),r+s,o]}var d=(e.level-i)/(e.z[o+1][r]-i);return[n.c2p(e.x[r],!0),l.c2p((1-d)*e.y[o]+d*e.y[o+1],!0),r,o+d]}var d=e("../../lib"),c=e("./constants");t.exports=function(e,t,a){var r,n,l,s,c;for(t=t||.01,a=a||.01,l=0;l<e.length;l++){for(s=e[l],c=0;c<s.starts.length;c++)n=s.starts[c],o(s,n,"edge",t,a);for(r=0;Object.keys(s.crossings).length&&1e4>r;)r++,n=Object.keys(s.crossings)[0].split(",").map(Number),o(s,n,void 0,t,a);1e4===r&&d.log("Infinite loop in contour?")}}},{"../../lib":719,"./constants":946}],955:[function(e,t){"use strict";var a=e("../../components/color"),r=e("../heatmap/hover");t.exports=function(e,t,o,i,n){var l=r(e,t,o,i,n,!0);return l&&l.forEach(function(e){var t=e.trace;"constraint"===t.contours.type&&(t.fillcolor&&a.opacity(t.fillcolor)?e.color=a.addOpacity(t.fillcolor,1):t.contours.showlines&&a.opacity(t.line.color)&&(e.color=a.addOpacity(t.line.color,1)))}),l}},{"../../components/color":593,"../heatmap/hover":1008}],956:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot").plot,style:e("./style"),colorbar:e("./colorbar"),hoverPoints:e("./hover"),moduleType:"trace",name:"contour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":778,"./attributes":942,"./calc":943,"./colorbar":945,"./defaults":951,"./hover":955,"./plot":960,"./style":962}],957:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t,r,o){o||(o={});var i=e("contours.showlabels");if(i){var n=t.font;a.coerceFont(e,"contours.labelfont",{family:n.family,size:n.size,color:r}),e("contours.labelformat")}!1!==o.hasHover&&e("zhoverformat")}},{"../../lib":719}],958:[function(e,t){"use strict";var a=e("d3"),r=e("../../components/colorscale"),o=e("./end_plus");t.exports=function(e){var t=e.contours,n=t.start,l=o(t),s=t.size||1,d=ba((l-n)/s)+1,c="lines"===t.coloring?0:1,p=r.extractOpts(e);isFinite(s)||(s=1,d=1);var u=p.reversescale?r.flipScale(p.colorscale):p.colorscale,g=u.length,h=Array(g),m=Array(g),y,f;if("heatmap"===t.coloring){var x=p.min,_=p.max;for(f=0;f<g;f++)y=u[f],h[f]=y[0]*(_-x)+x,m[f]=y[1];var b=a.extent([x,_,t.start,t.start+s*(d-1)]),v=b[x<_?0:1],k=b[x<_?1:0];v!==x&&(h.splice(0,0,v),m.splice(0,0,m[0])),k!==_&&(h.push(k),m.push(m[m.length-1]))}else for(f=0;f<g;f++)y=u[f],h[f]=(y[0]*(d+c-1)-c/2)*s+n,m[f]=y[1];return r.makeColorScaleFunc({domain:h,range:m},{noNumericCheck:!0})}},{"../../components/colorscale":605,"./end_plus":953,d3:163}],959:[function(e,t){"use strict";function a(e,t){var a=(t[0][0]>e?0:1)+(t[0][1]>e?0:2)+(t[1][1]>e?0:4)+(t[1][0]>e?0:8);if(5==a||10==a){var r=(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4;return e>r?5==a?713:1114:5==a?104:208}return 15==a?0:a}var r=e("./constants");t.exports=function(e){var t=e[0].z,o=t.length,l=t[0].length,n,s,d,c,p,u,g,h,m;for(s=0;s<o-1;s++)for(c=[],0===s&&(c=c.concat(r.BOTTOMSTART)),s===o-2&&(c=c.concat(r.TOPSTART)),n=0;n<l-1;n++)for(d=c.slice(),0===n&&(d=d.concat(r.LEFTSTART)),n===l-2&&(d=d.concat(r.RIGHTSTART)),p=n+","+s,u=[[t[s][n],t[s][n+1]],[t[s+1][n],t[s+1][n+1]]],m=0;m<e.length;m++)h=e[m],g=a(h.level,u),g&&(h.crossings[p]=g,-1!==d.indexOf(g)&&(h.starts.push([n,s]),(2===o||2===l)&&-1!==d.indexOf(g,d.indexOf(g)+1)&&h.starts.push([n,s])))}},{"./constants":946}],960:[function(e,t,a){"use strict";function r(e,t,a){var r=g.ensureSingle(e,"g","contourbg"),o=r.selectAll("path").data("fill"===a.coloring?[0]:[]);o.enter().append("path"),o.exit().remove(),o.attr("d","M"+t.join("L")+"Z").style("stroke","none")}function o(e,t,a,r){var o=g.ensureSingle(e,"g","contourfill"),i=o.selectAll("path").data("fill"===r.coloring||"constraint"===r.type&&"="!==r._operation?t:[]);i.enter().append("path"),i.exit().remove(),i.each(function(e){var t=l(e,a);t?u.select(this).attr("d",t).style("stroke","none"):u.select(this).remove()})}function n(e,t){var a=e.prefixBoundary;if(a===void 0){var r=ea(e.z[0][0],e.z[0][1]);a=!e.edgepaths.length&&r>e.level}return a?"M"+t.join("L")+"Z":""}function l(e,t){function a(e){return .01>_a(e[1]-t[0][1])}function r(e){return .01>_a(e[1]-t[2][1])}function o(e){return .01>_a(e[0]-t[0][0])}function l(e){return .01>_a(e[0]-t[2][0])}for(var s=n(e,t),d=0,c=e.edgepaths.map(function(e,t){return t}),p=!0,u,m,y,f,x,_;c.length;){for(_=h.smoothopen(e.edgepaths[d],e.smoothing),s+=p?_:_.replace(/^M/,"L"),c.splice(c.indexOf(d),1),u=e.edgepaths[d][e.edgepaths[d].length-1],f=-1,y=0;4>y;y++){if(!u){g.log("Missing end?",d,e);break}for(a(u)&&!l(u)?m=t[1]:o(u)?m=t[0]:r(u)?m=t[3]:l(u)&&(m=t[2]),x=0;x<e.edgepaths.length;x++){var b=e.edgepaths[x][0];.01>_a(u[0]-m[0])?.01>_a(u[0]-b[0])&&0<=(b[1]-u[1])*(m[1]-b[1])&&(m=b,f=x):.01>_a(u[1]-m[1])?.01>_a(u[1]-b[1])&&0<=(b[0]-u[0])*(m[0]-b[0])&&(m=b,f=x):g.log("endpt to newendpt is not vert. or horz.",u,m,b)}if(u=m,0<=f)break;s+="L"+m}if(f===e.edgepaths.length){g.log("unclosed perimeter path");break}d=f,p=-1===c.indexOf(d),p&&(d=c[0],s+="Z")}for(d=0;d<e.paths.length;d++)s+=h.smoothclosed(e.paths[d],e.smoothing);return s}function s(e,t,r,o,i){var n=g.ensureSingle(e,"g","contourlines"),l=!1!==i.showlines,s=i.showlabels,d=l&&s,c=a.createLines(n,l||s,t),p=a.createLineClip(n,d,r,o.trace.uid),m=e.selectAll("g.contourlabels").data(s?[0]:[]);if(m.exit().remove(),m.enter().append("g").classed("contourlabels",!0),s){var y=[],f=[];g.clearLocationCache();var x=a.labelFormatter(i,o.t.cb,r._fullLayout),_=h.tester.append("text").attr("data-notex",1).call(h.font,i.labelfont),b=t[0].xaxis,v=t[0].yaxis,k=b._length,w=v._length,T=b.range,S=v.range,C=g.aggNums(Math.min,null,o.x),L=g.aggNums(Math.max,null,o.x),E=g.aggNums(Math.min,null,o.y),I=g.aggNums(Math.max,null,o.y),z=va(b.c2p(C,!0),0),P=ea(b.c2p(L,!0),k),D=va(v.c2p(I,!0),0),O=ea(v.c2p(E,!0),w),R={};T[0]<T[1]?(R.left=z,R.right=P):(R.left=P,R.right=z),S[0]<S[1]?(R.top=D,R.bottom=O):(R.top=O,R.bottom=D),R.middle=(R.top+R.bottom)/2,R.center=(R.left+R.right)/2,y.push([[R.left,R.top],[R.right,R.top],[R.right,R.bottom],[R.left,R.bottom]]);var j=N(k*k+w*w),F=A.LABELDISTANCE*j/va(1,t.length/A.LABELINCREASE);c.each(function(e){var t=a.calcTextOpts(e.level,x,_,r);u.select(this).selectAll("path").each(function(){var e=this,r=g.getVisibleSegment(e,R,t.height/2);if(r&&!(r.len<(t.width+t.height)*A.LABELMIN))for(var o=ea(M(r.len/F),A.LABELMAX),n=0,l;n<o&&(l=a.findBestTextLocation(e,r,t,f,R),!!l);n++)a.addLabelData(l,t,f,y)})}),_.remove(),a.drawLabels(m,f,r,p,d?y:null)}s&&!l&&c.remove()}function d(e,t,a,r){var o=t.width/2,n=t.height/2,l=e.x,s=e.y,d=e.theta,c=R(d)*o,p=De(d)*o,u=(l>r.center?r.right-l:l-r.left)/(c+_a(De(d)*n)),h=(s>r.middle?r.bottom-s:s-r.top)/(_a(p)+R(d)*n);if(1>u||1>h)return 1/0;var m=S.EDGECOST*(1/(u-1)+1/(h-1));m+=S.ANGLECOST*d*d;for(var y=0;y<a.length;y++){var f=a[y],x=R(f.theta)*f.width/2,_=De(f.theta)*f.width/2,b=2*g.segmentDistance(l-c,s-p,l+c,s+p,f.x-x,f.y-_,f.x+x,f.y+_)/(t.height+f.height),v=f.level===t.level,k=v?S.SAMELEVELDISTANCE:1;if(b<=k)return 1/0;var w=S.NEIGHBORCOST*(v?S.SAMELEVELFACTOR:1);m+=w/(b-k)}return m}function c(e,t,a,r,o){var i=a._fullLayout._clips,n="clip"+r.trace.uid,s=i.selectAll("#"+n).data(r.trace.connectgaps?[]:[0]);if(s.enter().append("clipPath").classed("contourclip",!0).attr("id",n),s.exit().remove(),!1===r.trace.connectgaps){var d={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:r.x,y:r.y,z:p(r),smoothing:0};b([d]),v([d]);var c=l(d,o),u=g.ensureSingle(s,"path","");u.attr("d",c)}else n=null;h.setClipUrl(e,n,a)}function p(e){var t=e.trace._emptypoints,a=[],r=e.z.length,o=e.z[0].length,n=[],l,s;for(l=0;l<o;l++)n.push(1);for(l=0;l<r;l++)a.push(n.slice());for(l=0;l<t.length;l++)s=t[l],a[s[0]][s[1]]=0;return e.zmask=a,a}var u=e("d3"),g=e("../../lib"),h=e("../../components/drawing"),m=e("../../lib/svg_text_utils"),y=e("../../plots/cartesian/axes"),f=e("../../plots/cartesian/set_convert"),_=e("../heatmap/plot"),b=e("./make_crossings"),v=e("./find_all_paths"),k=e("./empty_pathinfo"),w=e("./convert_to_constraints"),T=e("./close_boundaries"),A=e("./constants"),S=A.LABELOPTIMIZER;a.plot=function(e,t,a,i){var n=t.xaxis,l=t.yaxis;g.makeTraceGroups(i,a,"contour").each(function(a){var i=u.select(this),d=a[0],p=d.trace,h=d.x,m=d.y,y=p.contours,f=k(y,t,d),x=g.ensureSingle(i,"g","heatmapcoloring"),A=[];"heatmap"===y.coloring&&(A=[a]),_(e,t,A,x),b(f),v(f);var S=n.c2p(h[0],!0),C=n.c2p(h[h.length-1],!0),L=l.c2p(m[0],!0),E=l.c2p(m[m.length-1],!0),I=[[S,E],[C,E],[C,L],[S,L]],z=f;"constraint"===y.type&&(z=w(f,y._operation),T(z,y._operation,I,p)),r(i,I,y),o(i,z,I,y),s(i,f,e,d,y),c(i,t,e,d,I)})},a.createLines=function(e,t,a){var r=a[0].smoothing,o=e.selectAll("g.contourlevel").data(t?a:[]);if(o.exit().remove(),o.enter().append("g").classed("contourlevel",!0),t){var i=o.selectAll("path.openline").data(function(e){return e.pedgepaths||e.edgepaths});i.exit().remove(),i.enter().append("path").classed("openline",!0),i.attr("d",function(e){return h.smoothopen(e,r)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var n=o.selectAll("path.closedline").data(function(e){return e.ppaths||e.paths});n.exit().remove(),n.enter().append("path").classed("closedline",!0),n.attr("d",function(e){return h.smoothclosed(e,r)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return o},a.createLineClip=function(e,t,a,r){var o=a._fullLayout._clips,i=t?"clipline"+r:null,n=o.selectAll("#"+i).data(t?[0]:[]);return n.exit().remove(),n.enter().append("clipPath").classed("contourlineclip",!0).attr("id",i),h.setClipUrl(e,i,a),n},a.labelFormatter=function(e,t,a){if(e.labelformat)return a._d3locale.numberFormat(e.labelformat);var r;if(t)r=t.axis;else{if(r={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"},"constraint"===e.type){var o=e.value;r.range=Array.isArray(o)?[o[0],o[o.length-1]]:[o,o]}else r.range=[e.start,e.end],r.nticks=(e.end-e.start)/e.size;r.range[0]===r.range[1]&&(r.range[1]+=r.range[0]||1),r.nticks||(r.nticks=1e3),f(r,a),y.prepTicks(r),r._tmin=null,r._tmax=null}return function(e){return y.tickText(r,e).text}},a.calcTextOpts=function(e,t,a,r){var o=t(e);a.text(o).call(m.convertToTspans,r);var i=h.bBox(a.node(),!0);return{text:o,width:i.width,height:i.height,level:e,dy:(i.top+i.bottom)/2}},a.findBestTextLocation=function(e,t,a,r,o){var i=a.width,n,l,s,c,u;t.isClosed?(l=t.len/S.INITIALSEARCHPOINTS,n=t.min+l/2,s=t.max):(l=(t.len-i)/(S.INITIALSEARCHPOINTS+1),n=t.min+l+i/2,s=t.max-(l+i)/2);for(var h=1/0,m=0;m<S.ITERATIONS;m++){for(var y=n;y<s;y+=l){var f=g.getTextLocation(e,t.total,y,i),x=d(f,a,r,o);x<h&&(h=x,u=f,c=y)}if(h>2*S.MAXCOST)break;m&&(l/=2),n=c-l/2,s=n+1.5*l}if(h<=S.MAXCOST)return u},a.addLabelData=function(e,t,a,r){var o=t.width/2,i=t.height/2,n=e.x,l=e.y,s=e.theta,d=De(s),c=R(s),p=o*c,u=i*d,g=o*d,h=-i*c;a.push({text:t.text,x:n,y:l,dy:t.dy,theta:s,level:t.level,width:t.width,height:t.height}),r.push([[n-p-u,l-g-h],[n+p-u,l+g-h],[n+p+u,l+g+h],[n-p+u,l-g+h]])},a.drawLabels=function(e,t,a,r,o){var n=e.selectAll("text").data(t,function(e){return e.text+","+e.x+","+e.y+","+e.theta});if(n.exit().remove(),n.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(e){var t=e.x+De(e.theta)*e.dy,r=e.y-R(e.theta)*e.dy;u.select(this).text(e.text).attr({x:t,y:r,transform:"rotate("+180*e.theta/Pe+" "+t+" "+r+")"}).call(m.convertToTspans,a)}),o){for(var l="",s=0;s<o.length;s++)l+="M"+o[s].join("L")+"Z";var d=g.ensureSingle(r,"path","");d.attr("d",l)}}},{"../../components/drawing":614,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../plots/cartesian/set_convert":785,"../heatmap/plot":1012,"./close_boundaries":944,"./constants":946,"./convert_to_constraints":950,"./empty_pathinfo":952,"./find_all_paths":954,"./make_crossings":959,d3:163}],961:[function(e,t){"use strict";function a(e,t,a){var o={type:"linear",range:[e,t]};return r.autoTicks(o,(t-e)/(a||15)),o}var r=e("../../plots/cartesian/axes"),o=e("../../lib");t.exports=function(e,t){var i=e.contours;if(e.autocontour){var n=e.zmin,l=e.zmax;(e.zauto||n===void 0)&&(n=o.aggNums(Math.min,null,t)),(e.zauto||l===void 0)&&(l=o.aggNums(Math.max,null,t));var s=a(n,l,e.ncontours);i.size=s.dtick,i.start=r.tickFirst(s),s.range.reverse(),i.end=r.tickFirst(s),i.start===n&&(i.start+=i.size),i.end===l&&(i.end-=i.size),i.start>i.end&&(i.start=i.end=(i.start+i.end)/2),e._input.contours||(e._input.contours={}),o.extendFlat(e._input.contours,{start:i.start,end:i.end,size:i.size}),e._input.autocontour=!0}else if("constraint"!==i.type){var d=i.start,c=i.end,p=e._input.contours;if(d>c&&(i.start=p.start=c,c=i.end=p.end=d,d=i.start),!(0<i.size)){var u;u=d===c?1:a(d,c,e.ncontours).dtick,p.size=i.size=u}}}},{"../../lib":719,"../../plots/cartesian/axes":767}],962:[function(e,t){"use strict";var a=e("d3"),r=e("../../components/drawing"),o=e("../heatmap/style"),i=e("./make_color_map");t.exports=function(e){var t=a.select(e).selectAll("g.contour");t.style("opacity",function(e){return e[0].trace.opacity}),t.each(function(e){var t=a.select(this),o=e[0].trace,n=o.contours,l=o.line,s=n.size||1,d=n.start,c="constraint"===n.type,p=!c&&"lines"===n.coloring,u=!c&&"fill"===n.coloring,g=p||u?i(o):null;t.selectAll("g.contourlevel").each(function(e){a.select(this).selectAll("path").call(r.lineGroupStyle,l.width,p?g(e.level):l.color,l.dash)});var h=n.labelfont;if(t.selectAll("g.contourlabels text").each(function(e){r.font(a.select(this),{family:h.family,size:h.size,color:h.color||(p?g(e.level):l.color)})}),c)t.selectAll("g.contourfill path").style("fill",o.fillcolor);else if(u){var m;t.selectAll("g.contourfill path").style("fill",function(e){return void 0===m&&(m=e.level),g(e.level+.5*s)}),void 0===m&&(m=d),t.selectAll("g.contourbg path").style("fill",g(m-.5*s))}}),o(e)}},{"../../components/drawing":614,"../heatmap/style":1013,"./make_color_map":958,d3:163}],963:[function(e,t){"use strict";var a=e("../../components/colorscale/defaults"),r=e("./label_defaults");t.exports=function(e,t,o,i,n){var l=o("contours.coloring"),s="",d;"fill"===l&&(d=o("contours.showlines")),!1!==d&&("lines"!==l&&(s=o("line.color","#000")),o("line.width",.5),o("line.dash")),"none"!==l&&(!0!==e.showlegend&&(t.showlegend=!1),t._dfltShowLegend=!1,a(e,t,i,o,{prefix:"",cLetter:"z"})),o("line.smoothing"),r(o,i,s,n)}},{"../../components/colorscale/defaults":603,"./label_defaults":957}],964:[function(e,t){"use strict";var a=e("../heatmap/attributes"),r=e("../contour/attributes"),o=r.contours,i=e("../scatter/attributes"),n=e("../../components/colorscale/attributes"),l=e("../../lib/extend").extendFlat,s=i.line;t.exports=l({carpet:{valType:"string",editType:"calc"},z:a.z,a:a.x,a0:a.x0,da:a.dx,b:a.y,b0:a.y0,db:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,atype:a.xtype,btype:a.ytype,fillcolor:r.fillcolor,autocontour:r.autocontour,ncontours:r.ncontours,contours:{type:o.type,start:o.start,end:o.end,size:o.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:o.showlines,showlabels:o.showlabels,labelfont:o.labelfont,labelformat:o.labelformat,operation:o.operation,value:o.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:l({},s.color,{}),width:s.width,dash:s.dash,smoothing:l({},s.smoothing,{}),editType:"plot"},transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":600,"../../lib/extend":710,"../contour/attributes":942,"../heatmap/attributes":1001,"../scatter/attributes":1112}],965:[function(e,t){"use strict";function a(e,t){var c=t._carpetTrace,p=c.aaxis,u=c.baxis,g,h,m,y,f,x,_;p._minDtick=0,u._minDtick=0,o.isArray1D(t.z)&&i(t,p,u,"a","b",["z"]),g=t._a=t._a||t.a,y=t._b=t._b||t.b,g=g?p.makeCalcdata(t,"_a"):[],y=y?u.makeCalcdata(t,"_b"):[],h=t.a0||0,m=t.da||1,f=t.b0||0,x=t.db||1,_=t._z=n(t._z||t.z,t.transpose),t._emptypoints=s(_),l(_,t._emptypoints);var v=o.maxRowLength(_),k="scaled"===t.xtype?"":g,w=d(t,k,h,m,v,p),T="scaled"===t.ytype?"":y,A=d(t,T,f,x,_.length,u),S={a:w,b:A,z:_};return"levels"===t.contours.type&&"none"!==t.contours.coloring&&r(e,t,{vals:_,containerStr:"",cLetter:"z"}),[S]}var r=e("../../components/colorscale/calc"),o=e("../../lib"),i=e("../heatmap/convert_column_xyz"),n=e("../heatmap/clean_2d_array"),l=e("../heatmap/interp2d"),s=e("../heatmap/find_empties"),d=e("../heatmap/make_bound_array"),c=e("./defaults"),p=e("../carpet/lookup_carpetid"),u=e("../contour/set_contours");t.exports=function(e,t){var r=t._carpetTrace=p(e,t);if(r&&r.visible&&"legendonly"!==r.visible){if(!t.a||!t.b){var o=e.data[r.index],i=e.data[t.index];i.a||(i.a=o.a),i.b||(i.b=o.b),c(i,t,t._defaultColor,e._fullLayout)}var n=a(e,t);return u(t,t._z),n}}},{"../../components/colorscale/calc":601,"../../lib":719,"../carpet/lookup_carpetid":915,"../contour/set_contours":961,"../heatmap/clean_2d_array":1003,"../heatmap/convert_column_xyz":1005,"../heatmap/find_empties":1007,"../heatmap/interp2d":1010,"../heatmap/make_bound_array":1011,"./defaults":966}],966:[function(e,t){"use strict";var a=e("../../lib"),r=e("../heatmap/xyz_defaults"),o=e("./attributes"),i=e("../contour/constraint_defaults"),n=e("../contour/contours_defaults"),l=e("../contour/style_defaults");t.exports=function(e,t,s,d){function c(r,i){return a.coerce(e,t,o,r,i)}function p(r){return a.coerce2(e,t,o,r)}if(c("carpet"),e.a&&e.b){var u=r(e,t,c,d,"a","b");if(!u)return void(t.visible=!1);c("text");var g="constraint"===c("contours.type");g?i(e,t,c,d,s,{hasHover:!1}):(n(e,t,c,p),l(e,t,c,d,{hasHover:!1}))}else t._defaultColor=s,t._length=null}},{"../../lib":719,"../contour/constraint_defaults":947,"../contour/contours_defaults":949,"../contour/style_defaults":963,"../heatmap/xyz_defaults":1015,"./attributes":964}],967:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../contour/colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent"],meta:{}}},{"../../plots/cartesian":778,"../contour/colorbar":945,"../contour/style":962,"./attributes":964,"./calc":965,"./defaults":966,"./plot":970}],968:[function(e,t){"use strict";var a=e("../../components/drawing"),r=e("../carpet/axis_aligned_line"),o=e("../../lib");t.exports=function(e,t,n,l,s,d,c,p){function u(e){return _a(e[1]-n[0][1])<v}function g(e){return _a(e[1]-n[2][1])<v}function h(e){return _a(e[0]-n[0][0])<b}function m(e){return _a(e[0]-n[2][0])<b}function y(e,t){var a="",o,n,l,y;for(u(e)&&!m(e)||g(e)&&!h(e)?(y=s.aaxis,l=r(s,d,[e[0],t[0]],.5*(e[1]+t[1]))):(y=s.baxis,l=r(s,d,.5*(e[0]+t[0]),[e[1],t[1]])),o=1;o<l.length;o++)for(a+=y.smoothing?"C":"L",n=0;n<l[o].length;n++){var f=l[o][n];a+=[c.c2p(f[0]),p.c2p(f[1])]+" "}return a}var f="",x=t.edgepaths.map(function(e,t){return t}),_=!0,b=1e-4*_a(n[0][0]-n[2][0]),v=1e-4*_a(n[0][1]-n[2][1]),k,w,T,A,S,C,L;for(k=0,w=null;x.length;){var E=t.edgepaths[k][0];for(w&&(f+=y(w,E)),L=a.smoothopen(t.edgepaths[k].map(l),t.smoothing),f+=_?L:L.replace(/^M/,"L"),x.splice(x.indexOf(k),1),w=t.edgepaths[k][t.edgepaths[k].length-1],S=-1,A=0;4>A;A++){if(!w){o.log("Missing end?",k,t);break}for(u(w)&&!m(w)?T=n[1]:h(w)?T=n[0]:g(w)?T=n[3]:m(w)&&(T=n[2]),C=0;C<t.edgepaths.length;C++){var I=t.edgepaths[C][0];_a(w[0]-T[0])<b?_a(w[0]-I[0])<b&&0<=(I[1]-w[1])*(T[1]-I[1])&&(T=I,S=C):_a(w[1]-T[1])<v?_a(w[1]-I[1])<v&&0<=(I[0]-w[0])*(T[0]-I[0])&&(T=I,S=C):o.log("endpt to newendpt is not vert. or horz.",w,T,I)}if(0<=S)break;f+=y(w,T),w=T}if(S===t.edgepaths.length){o.log("unclosed perimeter path");break}k=S,_=-1===x.indexOf(k),_&&(k=x[0],f+=y(w,T)+"Z",w=null)}for(k=0;k<t.paths.length;k++)f+=a.smoothclosed(t.paths[k].map(l),t.smoothing);return f}},{"../../components/drawing":614,"../../lib":719,"../carpet/axis_aligned_line":899}],969:[function(e,t){"use strict";t.exports=function(e,t){var a,r,o,n,l,s,d,c,p;for(a=0;a<e.length;a++){for(n=e[a],l=n.pedgepaths=[],s=n.ppaths=[],r=0;r<n.edgepaths.length;r++){for(p=n.edgepaths[r],d=[],o=0;o<p.length;o++)d[o]=t(p[o]);l.push(d)}for(r=0;r<n.paths.length;r++){for(p=n.paths[r],c=[],o=0;o<p.length;o++)c[o]=t(p[o]);s.push(c)}}}},{}],970:[function(e,t){"use strict";function r(e,t,a,r,i,n,l){var s=g.ensureSingle(e,"g","contourlines"),d=!1!==i.showlines,p=i.showlabels,h=d&&p,m=y.createLines(s,d||p,t),x=y.createLineClip(s,h,a,r.trace.uid),_=e.selectAll("g.contourlabels").data(p?[0]:[]);if(_.exit().remove(),_.enter().append("g").classed("contourlabels",!0),p){var b=n.xaxis,v=n.yaxis,k=b._length,w=v._length,T=[[[0,0],[k,0],[k,w],[0,w]]],A=[];g.clearLocationCache();var S=y.labelFormatter(i,r.t.cb,a._fullLayout),C=u.tester.append("text").attr("data-notex",1).call(u.font,i.labelfont),L={left:0,right:k,center:k/2,top:0,bottom:w,middle:w/2},E=N(k*k+w*w),I=f.LABELDISTANCE*E/va(1,t.length/f.LABELINCREASE);m.each(function(e){var t=y.calcTextOpts(e.level,S,C,a);c.select(this).selectAll("path").each(function(a){var r=this,n=g.getVisibleSegment(r,L,t.height/2);if(n&&(o(r,a,e,n,l,t.height),!(n.len<(t.width+t.height)*f.LABELMIN)))for(var s=ea(M(n.len/I),f.LABELMAX),d=0,c;d<s&&(c=y.findBestTextLocation(r,n,t,A,L),!!c);d++)y.addLabelData(c,t,A,T)})}),C.remove(),y.drawLabels(_,A,a,x,h?T:null)}p&&!d&&m.remove()}function o(e,t,a,r,o,s){function d(e,t){var a=0,r=.1,i;return(_a(e[0]-u)<r||_a(e[0]-g)<r)&&(i=n(o.dxydb_rough(e[0],e[1],r)),a=va(a,s*l(t,i)/2)),(_a(e[1]-h)<r||_a(e[1]-m)<r)&&(i=n(o.dxyda_rough(e[0],e[1],r)),a=va(a,s*l(t,i)/2)),a}for(var c=0,p;c<a.pedgepaths.length;c++)t===a.pedgepaths[c]&&(p=a.edgepaths[c]);if(p){var u=o.a[0],g=o.a[o.a.length-1],h=o.b[0],m=o.b[o.b.length-1],y=i(e,0,1),f=i(e,r.total,r.total-1),x=d(p[0],y),_=r.total-d(p[p.length-1],f);r.min<x&&(r.min=x),r.max>_&&(r.max=_),r.len=r.max-r.min}}function i(e,t,a){var r=e.getPointAtLength(t),o=e.getPointAtLength(a),i=o.x-r.x,n=o.y-r.y,l=N(i*i+n*n);return[i/l,n/l]}function n(e){var t=N(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function l(e,t){var a=_a(e[0]*t[0]+e[1]*t[1]),r=N(1-a*a);return r/a}function s(e,t,r,o,n,l){var s=g.ensureSingle(e,"g","contourbg"),d=s.selectAll("path").data("fill"!==l||n?[]:[0]),c,u,h,m;d.enter().append("path"),d.exit().remove();var y=[];for(m=0;m<t.length;m++)c=t[m],u=a([],c.x,r.c2p),h=a([],c.y,o.c2p),y.push(p(u,h,c.bicubic));d.attr("d","M"+y.join("L")+"Z").style("stroke","none")}function d(e,t,a,r,o,i,n,l,s,d,p){var u=g.ensureSingle(t,"g","contourfill"),h=u.selectAll("path").data("fill"===d?o:[]);h.enter().append("path"),h.exit().remove(),h.each(function(t){var o=_(e,t,i,n,l,s,a,r);t.prefixBoundary&&(o=p+o),o?c.select(this).attr("d",o).style("stroke","none"):c.select(this).remove()})}var c=e("d3"),a=e("../carpet/map_1d_array"),p=e("../carpet/makepath"),u=e("../../components/drawing"),g=e("../../lib"),h=e("../contour/make_crossings"),m=e("../contour/find_all_paths"),y=e("../contour/plot"),f=e("../contour/constants"),x=e("../contour/convert_to_constraints"),_=e("./join_all_paths"),v=e("../contour/empty_pathinfo"),k=e("./map_pathinfo"),w=e("../carpet/lookup_carpetid"),T=e("../contour/close_boundaries");t.exports=function(e,t,o,i){var n=t.xaxis,l=t.yaxis;g.makeTraceGroups(i,o,"contour").each(function(o){function g(e){var t=A.ab2xy(e[0],e[1],!0);return[n.c2p(t[0]),l.c2p(t[1])]}var y=c.select(this),f=o[0],_=f.trace,A=_._carpetTrace=w(e,_),S=e.calcdata[A.index][0];if(A.visible&&"legendonly"!==A.visible){var C=f.a,L=f.b,b=_.contours,E=v(b,t,f),I="constraint"===b.type,z=b._operation,P=I?"="===z?"lines":"fill":b.coloring,D=[[C[0],L[L.length-1]],[C[C.length-1],L[L.length-1]],[C[C.length-1],L[0]],[C[0],L[0]]];h(E);var O=1e-8*(C[C.length-1]-C[0]),R=1e-8*(L[L.length-1]-L[0]);m(E,O,R);var M=E;"constraint"===b.type&&(M=x(E,z),T(M,z,D,_)),k(E,g);var j=[],F,B,N,V;for(V=S.clipsegments.length-1;0<=V;V--)F=S.clipsegments[V],B=a([],F.x,n.c2p),N=a([],F.y,l.c2p),B.reverse(),N.reverse(),j.push(p(B,N,F.bicubic));var U="M"+j.join("L")+"Z";s(y,S.clipsegments,n,l,I,P),d(_,y,n,l,M,D,g,A,S,P,U),r(y,E,e,f,b,t,A),u.setClipUrl(y,A._clipPathId,e)}})}},{"../../components/drawing":614,"../../lib":719,"../carpet/lookup_carpetid":915,"../carpet/makepath":916,"../carpet/map_1d_array":917,"../contour/close_boundaries":944,"../contour/constants":946,"../contour/convert_to_constraints":950,"../contour/empty_pathinfo":952,"../contour/find_all_paths":954,"../contour/make_crossings":959,"../contour/plot":960,"./join_all_paths":968,"./map_pathinfo":969,d3:163}],971:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("../../plots/attributes"),i=e("../scattermapbox/attributes"),n=e("../../lib/extend").extendFlat;t.exports=n({lon:i.lon,lat:i.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:i.text,hovertext:i.hovertext,hoverinfo:n({},o.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:r()},a("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../scattermapbox/attributes":1171}],972:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../lib").isArrayOrTypedArray,o=e("../../constants/numerical").BADNUM,n=e("../../components/colorscale/calc"),l=e("../../lib")._;t.exports=function(e,t){for(var s=t._length,d=Array(s),c=t.z,p=r(c)&&c.length,u=0;u<s;u++){var g=d[u]={},h=t.lon[u],m=t.lat[u];if(g.lonlat=a(h)&&a(m)?[+h,+m]:[o,o],p){var y=c[u];g.z=a(y)?y:o}}return n(e,t,{vals:p?c:[0,1],containerStr:"",cLetter:"z"}),s&&(d[0].t={labels:{lat:l(e,"lat:")+" ",lon:l(e,"lon:")+" "}}),d}},{"../../components/colorscale/calc":601,"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":225}],973:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../lib"),o=e("../../components/color"),n=e("../../components/colorscale"),l=e("../../constants/numerical").BADNUM,s=e("../../lib/geojson_utils").makeBlank;t.exports=function(e){var t=e[0].trace,d=!0===t.visible&&0!==t._length,c=t._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:s()};if(!d)return c;var p=[],u=t.z,g=t.radius,h=r.isArrayOrTypedArray(u)&&u.length,m=r.isArrayOrTypedArray(g),y;for(y=0;y<e.length;y++){var f=e[y],x=f.lonlat;if(x[0]!==l){var _={};if(h){var b=f.z;_.z=b===l?0:b}m&&(_.r=a(g[y])&&0<g[y]?+g[y]:0),p.push({type:"Feature",geometry:{type:"Point",coordinates:x},properties:_})}}var v=n.extractOpts(t),k=v.reversescale?n.flipScale(v.colorscale):v.colorscale,w=k[0][1],T=1>o.opacity(w)?w:o.addOpacity(w,0),A=["interpolate",["linear"],["heatmap-density"],0,T];for(y=1;y<k.length;y++)A.push(k[y][0],k[y][1]);var S=["interpolate",["linear"],["get","z"],v.min,0,v.max,1];return r.extendFlat(c.heatmap.paint,{"heatmap-weight":h?S:1/(v.max-v.min),"heatmap-color":A,"heatmap-radius":m?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),c.geojson={type:"FeatureCollection",features:p},c.heatmap.layout.visibility="visible",c}},{"../../components/color":593,"../../components/colorscale":605,"../../constants/numerical":695,"../../lib":719,"../../lib/geojson_utils":714,"fast-isnumeric":225}],974:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/colorscale/defaults"),o=e("./attributes");t.exports=function(e,t,i,n){function l(r,i){return a.coerce(e,t,o,r,i)}var s=l("lon")||[],d=l("lat")||[],c=ea(s.length,d.length);return c?void(t._length=c,l("z"),l("radius"),l("below"),l("text"),l("hovertext"),l("hovertemplate"),r(e,t,n,l,{prefix:"",cLetter:"z"})):void(t.visible=!1)}},{"../../components/colorscale/defaults":603,"../../lib":719,"./attributes":971}],975:[function(e,t){"use strict";t.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e.z=t.z,e}},{}],976:[function(e,t){"use strict";function a(e,t,a){function o(e){return e+"\xB0"}if(!e.hovertemplate){var i=t.hi||e.hoverinfo,n=i.split("+"),l=-1!==n.indexOf("all"),s=-1!==n.indexOf("lon"),d=-1!==n.indexOf("lat"),c=t.lonlat,p=[];return l||s&&d?p.push("("+o(c[0])+", "+o(c[1])+")"):s?p.push(a.lon+o(c[0])):d&&p.push(a.lat+o(c[1])),(l||-1!==n.indexOf("text"))&&r.fillText(t,e,p),p.join("<br>")}}var r=e("../../lib"),o=e("../../plots/cartesian/axes"),i=e("../scattermapbox/hover");t.exports=function(e,t,r){var n=i(e,t,r);if(n){var l=n[0],s=l.cd,d=s[0].trace,c=s[l.index];if(delete l.color,"z"in c){var p=l.subplot.mockAxis;l.z=c.z,l.zLabel=o.tickText(p,p.c2l(c.z),"hover").text}return l.extraText=a(d,c,s[0].t.labels),[l]}}},{"../../lib":719,"../../plots/cartesian/axes":767,"../scattermapbox/hover":1175}],977:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../heatmap/colorbar"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover"),eventData:e("./event_data"),getBelow:function(e,t){for(var a=t.getMapLayers(),r=0;r<a.length;r++){var o=a[r],n=o.id;if("symbol"===o.type&&"string"==typeof n&&-1===n.indexOf("plotly-"))return n}},moduleType:"trace",name:"densitymapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":822,"../heatmap/colorbar":1004,"./attributes":971,"./calc":972,"./defaults":974,"./event_data":975,"./hover":976,"./plot":978}],978:[function(e,t){"use strict";function a(e,t){this.subplot=e,this.uid=t,this.sourceId="source-"+t,this.layerList=[["heatmap",o+t+"-heatmap"]],this.below=null}var r=e("./convert"),o=e("../../plots/mapbox/constants").traceLayerPrefix,i=a.prototype;i.update=function(e){var t=this.subplot,a=this.layerList,o=r(e),n=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(o.geojson),n!==this.below&&(this._removeLayers(),this._addLayers(o,n),this.below=n);for(var l=0;l<a.length;l++){var s=a[l],d=s[0],c=s[1],p=o[d];t.setOptions(c,"setLayoutProperty",p.layout),"visible"===p.layout.visibility&&t.setOptions(c,"setPaintProperty",p.paint)}},i._addLayers=function(e,t){for(var a=this.subplot,r=this.layerList,o=this.sourceId,n=0;n<r.length;n++){var l=r[n],s=l[0],d=e[s];a.addLayer({type:s,id:l[1],source:o,layout:d.layout,paint:d.paint},t)}},i._removeLayers=function(){for(var e=this.subplot.map,t=this.layerList,a=t.length-1;0<=a;a--)e.removeLayer(t[a][1])},i.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},t.exports=function(e,t){var o=t[0].trace,i=new a(e,o.uid),n=i.sourceId,l=r(t),s=i.below=e.belowLookup["trace-"+o.uid];return e.map.addSource(n,{type:"geojson",data:l.geojson}),i._addLayers(l,s),i}},{"../../plots/mapbox/constants":820,"./convert":973}],979:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){for(var r=0;r<e.length;r++)e[r].i=r;a.mergeArray(t.text,e,"tx"),a.mergeArray(t.hovertext,e,"htx");var o=t.marker;if(o){a.mergeArray(o.opacity,e,"mo"),a.mergeArray(o.color,e,"mc");var n=o.line;n&&(a.mergeArray(n.color,e,"mlc"),a.mergeArrayCastPositive(n.width,e,"mlw"))}}},{"../../lib":719}],980:[function(e,t){"use strict";var a=e("../bar/attributes"),r=e("../scatter/attributes").line,o=e("../../plots/attributes"),i=e("../../components/fx/hovertemplate_attributes"),n=e("./constants"),l=e("../../lib/extend").extendFlat,s=e("../../components/color");t.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,hovertext:a.hovertext,hovertemplate:i({},{keys:n.eventDataKeys}),hoverinfo:l({},o.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},text:a.text,textposition:l({},a.textposition,{dflt:"auto"}),insidetextanchor:l({},a.insidetextanchor,{dflt:"middle"}),textangle:l({},a.textangle,{dflt:0}),textfont:a.textfont,insidetextfont:a.insidetextfont,outsidetextfont:a.outsidetextfont,constraintext:a.constraintext,cliponaxis:a.cliponaxis,orientation:l({},a.orientation,{}),offset:l({},a.offset,{arrayOk:!1}),width:l({},a.width,{arrayOk:!1}),marker:a.marker,connector:{fillcolor:{valType:"color",editType:"style"},line:{color:l({},r.color,{dflt:s.defaultLine}),width:l({},r.width,{dflt:0,editType:"plot"}),dash:r.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup}},{"../../components/color":593,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../bar/attributes":857,"../scatter/attributes":1112,"./constants":982}],981:[function(e,t){"use strict";function a(e){return e===l?0:e}var r=e("../../plots/cartesian/axes"),o=e("./arrays_to_calcdata"),n=e("../scatter/calc_selection"),l=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var s=r.getFromId(e,t.xaxis||"x"),d=r.getFromId(e,t.yaxis||"y"),c,p,u,g;"h"===t.orientation?(c=s.makeCalcdata(t,"x"),p=d.makeCalcdata(t,"y")):(c=d.makeCalcdata(t,"y"),p=s.makeCalcdata(t,"x"));var h=ea(p.length,c.length),m=Array(h);for(t._base=[],u=0;u<h;u++){0>c[u]&&(c[u]=l);var y=!1;c[u]!==l&&u+1<h&&c[u+1]!==l&&(y=!0),g=m[u]={p:p[u],s:c[u],cNext:y},t._base[u]=-.5*g.s,t.ids&&(g.id=t.ids[u]+""),0===u&&(m[0].vTotal=0),m[0].vTotal+=a(g.s),g.begR=a(g.s)/a(m[0].s)}var f;for(u=0;u<h;u++)g=m[u],g.s===l||(g.sumR=g.s/m[0].vTotal,g.difR=void 0===f?1:g.s/f,f=g.s);return o(m,t),n(m,t),m}},{"../../constants/numerical":695,"../../plots/cartesian/axes":767,"../scatter/calc_selection":1114,"./arrays_to_calcdata":979}],982:[function(e,t){"use strict";t.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],983:[function(e,t){"use strict";var a=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function(e,t){var r=e._fullLayout,o=e._fullData,n=e.calcdata,l=t.xaxis,s=t.yaxis,d=[],c=[],p=[],u,g;for(g=0;g<o.length;g++){var h=o[g],m="h"===h.orientation;!0===h.visible&&h.xaxis===l._id&&h.yaxis===s._id&&"funnel"===h.type&&(u=n[g],m?p.push(u):c.push(u),d.push(u))}var y={mode:r.funnelmode,norm:r.funnelnorm,gap:r.funnelgap,groupgap:r.funnelgroupgap};for(a(e,l,s,c,y),a(e,s,l,p,y),g=0;g<d.length;g++){u=d[g];for(var f=0;f<u.length;f++)f+1<u.length&&(u[f].nextP0=u[f+1].p0,u[f].nextS0=u[f+1].s0,u[f].nextP1=u[f+1].p1,u[f].nextS1=u[f+1].s1)}}},{"../bar/cross_trace_calc":860}],984:[function(e,t){"use strict";function a(e){var t=r.isArrayOrTypedArray(e)?"#000":e;return s.addOpacity(t,.5*s.opacity(t))}var r=e("../../lib"),o=e("../bar/defaults").handleGroupingDefaults,i=e("../bar/defaults").handleText,n=e("../scatter/xy_defaults"),l=e("./attributes"),s=e("../../components/color");t.exports={supplyDefaults:function(e,t,o,d){function c(a,o){return r.coerce(e,t,l,a,o)}var p=n(e,t,d,c);if(!p)return void(t.visible=!1);c("orientation",t.y&&!t.x?"v":"h"),c("offset"),c("width");var u=c("text");c("hovertext"),c("hovertemplate");var g=c("textposition");i(e,t,d,c,g,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==t.textposition&&c("textinfo",Array.isArray(u)?"text+value":"value");var h=c("marker.color",o);c("marker.line.color",s.defaultLine),c("marker.line.width");var m=c("connector.visible");if(m){c("connector.fillcolor",a(h));var y=c("connector.line.width");y&&(c("connector.line.color"),c("connector.line.dash"))}},crossTraceDefaults:function(e,t){function a(e){return r.coerce(s._input,s,l,e)}var n,s;if("group"===t.funnelmode)for(var d=0;d<e.length;d++)s=e[d],n=s._input,o(n,s,t,a)}}},{"../../components/color":593,"../../lib":719,"../bar/defaults":861,"../scatter/xy_defaults":1137,"./attributes":980}],985:[function(e,t){"use strict";t.exports=function(e,t){return e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,"percentInitial"in t&&(e.percentInitial=t.percentInitial),"percentPrevious"in t&&(e.percentPrevious=t.percentPrevious),"percentTotal"in t&&(e.percentTotal=t.percentTotal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},{}],986:[function(e,t){"use strict";function a(e,t){var a=e.marker,o=t.mc||a.color,i=t.mlc||a.line.color,n=t.mlw||a.line.width;if(r(o))return o;return r(i)&&n?i:void 0}var r=e("../../components/color").opacity,o=e("../bar/hover").hoverOnBars,i=e("../../lib").formatPercent;t.exports=function(e,t,r,n){var l=o(e,t,r,n);if(l){var s=l.cd,d=s[0].trace,c="h"===d.orientation,p=l.index,u=s[p],g=c?"x":"y";l[g+"LabelVal"]=u.s,l.percentInitial=u.begR,l.percentInitialLabel=i(u.begR,1),l.percentPrevious=u.difR,l.percentPreviousLabel=i(u.difR,1),l.percentTotal=u.sumR,l.percentTotalLabel=i(u.sumR,1);var h=u.hi||d.hoverinfo,m=[];if(h&&"none"!==h&&"skip"!==h){var y=h.split("+"),f=function(e){return"all"===h||-1!==y.indexOf(e)};f("percent initial")&&m.push(l.percentInitialLabel+" of initial"),f("percent previous")&&m.push(l.percentPreviousLabel+" of previous"),f("percent total")&&m.push(l.percentTotalLabel+" of total")}return l.extraText=m.join("<br>"),l.color=a(d,u),[l]}}},{"../../components/color":593,"../../lib":719,"../bar/hover":863}],987:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../bar/select":868,"./attributes":980,"./calc":981,"./cross_trace_calc":983,"./defaults":984,"./event_data":985,"./hover":986,"./layout_attributes":988,"./layout_defaults":989,"./plot":990,"./style":991}],988:[function(e,t){"use strict";t.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],989:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t,o){function n(o,i){return a.coerce(e,t,r,o,i)}for(var l=!1,s=0,d;s<o.length;s++)if(d=o[s],d.visible&&"funnel"===d.type){l=!0;break}l&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":719,"./layout_attributes":988}],990:[function(e,t){"use strict";function a(e,t,a,r){var s=t.xaxis,d=t.yaxis;n.makeTraceGroups(r,a,"trace bars").each(function(a){var r=i.select(this),c=a[0].trace,p=n.ensureSingle(r,"g","regions");if(!c.connector||!c.connector.visible)return void p.remove();var u="h"===c.orientation,g=p.selectAll("g.region").data(n.identity);g.enter().append("g").classed("region",!0),g.exit().remove();var h=g.size();g.each(function(a,r){if(r===h-1||a.cNext){var c=o(a,s,d,u),p=c[0],g=c[1],m="";void 0!==p[3]&&void 0!==g[3]&&(u?m+="M"+p[0]+","+g[1]+"L"+p[2]+","+g[2]+"H"+p[3]+"L"+p[1]+","+g[1]+"Z":m+="M"+p[1]+","+g[1]+"L"+p[2]+","+g[3]+"V"+g[2]+"L"+p[1]+","+g[0]+"Z"),n.ensureSingle(i.select(this),"path").attr("d",m).call(l.setClipUrl,t.layerClipId,e)}})})}function r(e,t,a,r){var s=t.xaxis,d=t.yaxis;n.makeTraceGroups(r,a,"trace bars").each(function(a){var r=i.select(this),c=a[0].trace,p=n.ensureSingle(r,"g","lines");if(!c.connector||!c.connector.visible||!c.connector.line.width)return void p.remove();var u="h"===c.orientation,g=p.selectAll("g.line").data(n.identity);g.enter().append("g").classed("line",!0),g.exit().remove();var h=g.size();g.each(function(a,r){if(r===h-1||a.cNext){var c=o(a,s,d,u),p=c[0],g=c[1],m="";void 0!==p[3]&&void 0!==g[3]&&(u?(m+="M"+p[0]+","+g[1]+"L"+p[2]+","+g[2],m+="M"+p[1]+","+g[1]+"L"+p[3]+","+g[2]):(m+="M"+p[1]+","+g[1]+"L"+p[2]+","+g[3],m+="M"+p[1]+","+g[0]+"L"+p[2]+","+g[2])),""===m&&(m="M0,0Z"),n.ensureSingle(i.select(this),"path").attr("d",m).call(l.setClipUrl,t.layerClipId,e)}})})}function o(e,t,a,r){var o=[],i=[],n=r?t:a,l=r?a:t;return o[0]=n.c2p(e.s0,!0),i[0]=l.c2p(e.p0,!0),o[1]=n.c2p(e.s1,!0),i[1]=l.c2p(e.p1,!0),o[2]=n.c2p(e.nextS0,!0),i[2]=l.c2p(e.nextP0,!0),o[3]=n.c2p(e.nextS1,!0),i[3]=l.c2p(e.nextP1,!0),r?[o,i]:[i,o]}var i=e("d3"),n=e("../../lib"),l=e("../../components/drawing"),s=e("../bar/plot").plot;t.exports=function(e,t,o,i){var n=e._fullLayout;a(e,t,o,i),r(e,t,o,i),s(e,t,o,i,{mode:n.funnelmode,norm:n.funnelmode,gap:n.funnelgap,groupgap:n.funnelgroupgap})}},{"../../components/drawing":614,"../../lib":719,"../bar/plot":867,d3:163}],991:[function(e,t){"use strict";var a=e("d3"),r=e("../../components/drawing"),o=e("../../components/color"),i=e("../../constants/interactions").DESELECTDIM,n=e("../bar/style").styleTextPoints;t.exports={style:function(e,t,l){var d=l?l:a.select(e).selectAll("g.funnellayer").selectAll("g.trace");d.style("opacity",function(e){return e[0].trace.opacity}),d.each(function(t){var l=a.select(this),s=t[0].trace;l.selectAll(".point > path").each(function(e){if(!e.isBlank){var t=s.marker;a.select(this).call(o.fill,e.mc||t.color).call(o.stroke,e.mlc||t.line.color).call(r.dashLine,t.line.dash,e.mlw||t.line.width).style("opacity",s.selectedpoints&&!e.selected?i:1)}}),n(l,s,e),l.selectAll(".regions").each(function(){a.select(this).selectAll("path").style("stroke-width",0).call(o.fill,s.connector.fillcolor)}),l.selectAll(".lines").each(function(){var e=s.connector.line;r.lineGroupStyle(a.select(this).selectAll("path"),e.width,e.color,e.dash)})})}}},{"../../components/color":593,"../../components/drawing":614,"../../constants/interactions":694,"../bar/style":870,d3:163}],992:[function(e,t){"use strict";var a=e("../pie/attributes"),r=e("../../plots/attributes"),o=e("../../plots/domain").attributes,i=e("../../components/fx/hovertemplate_attributes"),n=e("../../lib/extend").extendFlat;t.exports={labels:a.labels,label0:a.label0,dlabel:a.dlabel,values:a.values,marker:{colors:a.marker.colors,line:{color:n({},a.marker.line.color,{dflt:null}),width:n({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:a.text,hovertext:a.hovertext,scalegroup:n({},a.scalegroup,{}),textinfo:n({},a.textinfo,{flags:["label","text","value","percent"]}),hoverinfo:n({},r.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:i({},{keys:["label","color","value","percent","text"]}),textposition:n({},a.textposition,{values:["inside","none"],dflt:"inside"}),textfont:a.textfont,insidetextfont:a.insidetextfont,title:{text:a.title.text,font:a.title.font,position:n({},a.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:o({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../pie/attributes":1086}],993:[function(e,t,a){"use strict";var r=e("../../registry"),o=e("../../plots/get_data").getModuleCalcData;a.name="funnelarea",a.plot=function(e){var t=r.getModule("funnelarea"),a=o(e.calcdata,t)[0];t.plot(e,a)},a.clean=function(e,t,a,r){var o=r._has&&r._has("funnelarea"),i=t._has&&t._has("funnelarea");o&&!i&&r._funnelarealayer.selectAll("g.trace").remove()}},{"../../plots/get_data":802,"../../registry":847}],994:[function(e,t){"use strict";var a=e("../pie/calc");t.exports={calc:function(e,t){return a.calc(e,t)},crossTraceCalc:function(e){a.crossTraceCalc(e,{type:"funnelarea"})}}},{"../pie/calc":1088}],995:[function(e,t){"use strict";var a=e("../../lib"),r=e("./attributes"),o=e("../../plots/domain").defaults,i=e("../bar/defaults").handleText;t.exports=function(e,t,n,l){function s(o,i){return a.coerce(e,t,r,o,i)}var d=s("values"),c=a.isArrayOrTypedArray(d),p=s("labels"),u;if(Array.isArray(p)?(u=p.length,c&&(u=ea(u,d.length))):c&&(u=d.length,s("label0"),s("dlabel")),!u)return void(t.visible=!1);t._length=u;var g=s("marker.line.width");g&&s("marker.line.color",l.paper_bgcolor),s("marker.colors"),s("scalegroup");var h=s("text"),m=s("textinfo",Array.isArray(h)?"text+percent":"percent");if(s("hovertext"),s("hovertemplate"),m&&"none"!==m){var y=s("textposition");i(e,t,l,s,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}o(t,l,s);var f=s("title.text");f&&(s("title.position"),a.coerceFont(s,"title.font",l.font)),s("aspectratio"),s("baseratio")}},{"../../lib":719,"../../plots/domain":792,"../bar/defaults":861,"./attributes":992}],996:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"funnelarea",basePlotModule:e("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style"),styleOne:e("../pie/style_one"),meta:{}}},{"../pie/style_one":1097,"./attributes":992,"./base_plot":993,"./calc":994,"./defaults":995,"./layout_attributes":997,"./layout_defaults":998,"./plot":999,"./style":1e3}],997:[function(e,t){"use strict";var a=e("../pie/layout_attributes").hiddenlabels;t.exports={hiddenlabels:a,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1093}],998:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t){function o(o,i){return a.coerce(e,t,r,o,i)}o("hiddenlabels"),o("funnelareacolorway",t.colorway),o("extendfunnelareacolors")}},{"../../lib":719,"./layout_attributes":997}],999:[function(e,t){"use strict";function a(e,t){var a=t[0]-e[0],r=t[1]-e[1];return"l"+a+","+r}function r(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}function o(e){function t(){var e=N(g);return{x:e,y:-e}}function a(){var e=t();return[e.x,e.y]}if(e.length){var o=e[0],l=o.trace,s=l.aspectratio,d=l.baseratio;.999<d&&(d=.999);var c=ya(d,2),u=o.vTotal,g=u*c/(1-c)/u,m=[],f;m.push(a());var _,b;for(_=e.length-1;-1<_;_--)if(b=e[_],!b.hidden){var v=b.v/u;g+=v,m.push(a())}var k=1/0,w=-Infinity;for(_=0;_<m.length;_++)f=m[_],k=ea(k,f[1]),w=va(w,f[1]);for(_=0;_<m.length;_++)m[_][1]-=(w+k)/2;var T=m[m.length-1][0],A=o.r,S=(w-k)/2,C=A/S*s;for(o.r=C*S,_=0;_<m.length;_++)m[_][0]*=A/T,m[_][1]*=C;f=m[0];var L=[-f[0],f[1]],E=[f[0],f[1]],I=0;for(_=e.length-1;-1<_;_--)if(b=e[_],!b.hidden){I+=1;var z=m[I][0],x=m[I][1];b.TL=[-z,x],b.TR=[z,x],b.BL=L,b.BR=E,b.pxmid=r(b.TR,b.BR),L=b.TL,E=b.TR}}}var i=e("d3"),n=e("../../components/drawing"),l=e("../../lib"),s=e("../../lib/svg_text_utils"),d=e("../bar/plot"),c=d.getTransform,p=d.toMoveInsideBar,u=e("../pie/helpers"),g=e("../pie/plot"),h=g.attachFxHandlers,m=g.determineInsideTextFont,y=g.layoutAreas,f=g.prerenderTitles,x=g.positionTitleOutside;t.exports=function(e,t){var r=e._fullLayout;f(t,e),y(t,r._size),l.makeTraceGroups(r._funnelarealayer,t,"trace").each(function(t){var d=i.select(this),g=t[0],y=g.trace;o(t),d.each(function(){var o=i.select(this).selectAll("g.slice").data(t);o.enter().append("g").classed("slice",!0),o.exit().remove(),o.each(function(r){if(r.hidden)return void i.select(this).selectAll("path,g").remove();r.pointNumber=r.i,r.curveNumber=y.index;var o=g.cx,d=g.cy,f=i.select(this),x=f.selectAll("path.surface").data([r]);x.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),f.call(h,e,t);var _="M"+(o+r.TR[0])+","+(d+r.TR[1])+a(r.TR,r.BR)+a(r.BR,r.BL)+a(r.BL,r.TL)+"Z";x.attr("d",_);var b=u.castOption(y.textposition,r.pts),v=f.selectAll("g.slicetext").data(r.text&&"none"!==b?[0]:[]);v.enter().append("g").classed("slicetext",!0),v.exit().remove(),v.each(function(){var t=l.ensureSingle(i.select(this),"text","",function(e){e.attr("data-notex",1)});t.text(r.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(n.font,m(y,r,e._fullLayout.font)).call(s.convertToTspans,e);var a=n.bBox(t.node()),u=ea(r.BL[1],r.BR[1]),g=va(r.TL[1],r.TR[1]),h,f,x;f=va(r.TL[0],r.BL[0]),x=ea(r.TR[0],r.BR[0]),h=c(p(f,x,u,g,a,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})),t.attr("transform","translate("+o+","+d+")"+h)})});var d=i.select(this).selectAll("g.titletext").data(y.title.text?[0]:[]);d.enter().append("g").classed("titletext",!0),d.exit().remove(),d.each(function(){var t=l.ensureSingle(i.select(this),"text","",function(e){e.attr("data-notex",1)}),a=y.title.text;y._meta&&(a=l.templateString(a,y._meta)),t.text(a).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(n.font,y.title.font).call(s.convertToTspans,e);var o=x(g,r._size);t.attr("transform","translate("+o.x+","+o.y+")"+(1>o.scale?"scale("+o.scale+")":"")+"translate("+o.tx+","+o.ty+")")})})})}},{"../../components/drawing":614,"../../lib":719,"../../lib/svg_text_utils":743,"../bar/plot":867,"../pie/helpers":1091,"../pie/plot":1095,d3:163}],1e3:[function(e,t){"use strict";var a=e("d3"),r=e("../pie/style_one");t.exports=function(e){e._fullLayout._funnelarealayer.selectAll(".trace").each(function(e){var t=e[0],o=t.trace,i=a.select(this);i.style({opacity:o.opacity}),i.selectAll("path.surface").each(function(e){a.select(this).call(r,e,o)})})}},{"../pie/style_one":1097,d3:163}],1001:[function(e,t){"use strict";var a=e("../scatter/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("../../components/colorscale/attributes"),i=e("../../constants/docs").FORMAT_LINK,n=e("../../lib/extend").extendFlat;t.exports=n({z:{valType:"data_array",editType:"calc"},x:n({},a.x,{impliedEdits:{xtype:"array"}}),x0:n({},a.x0,{impliedEdits:{xtype:"scaled"}}),dx:n({},a.dx,{impliedEdits:{xtype:"scaled"}}),y:n({},a.y,{impliedEdits:{ytype:"array"}}),y0:n({},a.y0,{impliedEdits:{ytype:"scaled"}}),dy:n({},a.dy,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"},hovertemplate:r()},{transforms:void 0},o("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../constants/docs":690,"../../lib/extend":710,"../scatter/attributes":1112}],1002:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib"),o=e("../../plots/cartesian/axes"),n=e("../histogram2d/calc"),l=e("../../components/colorscale/calc"),s=e("./convert_column_xyz"),d=e("./clean_2d_array"),c=e("./interp2d"),p=e("./find_empties"),u=e("./make_bound_array");t.exports=function(e,t){function g(e){v=t._input.zsmooth=t.zsmooth=!1,r.warn("cannot use zsmooth: \"fast\": "+e)}var h=o.getFromId(e,t.xaxis||"x"),m=o.getFromId(e,t.yaxis||"y"),f=a.traceIs(t,"contour"),_=a.traceIs(t,"histogram"),b=a.traceIs(t,"gl2d"),v=f?"best":t.zsmooth,k,w,T,A,S,C,L,E,I;if(h._minDtick=0,m._minDtick=0,_)I=n(e,t),k=I.x,w=I.x0,T=I.dx,A=I.y,S=I.y0,C=I.dy,L=I.z;else{var P=t.z;r.isArray1D(P)?(s(t,h,m,"x","y",["z"]),k=t._x,A=t._y,P=t._z):(k=t._x=t.x?h.makeCalcdata(t,"x"):[],A=t._y=t.y?m.makeCalcdata(t,"y"):[]),w=t.x0,T=t.dx,S=t.y0,C=t.dy,L=d(P,t,h,m),(f||t.connectgaps)&&(t._emptypoints=p(L),c(L,t._emptypoints))}if("fast"===v)if("log"===h.type||"log"===m.type)g("log axis found");else if(!_){if(k.length){var D=(k[k.length-1]-k[0])/(k.length-1),O=_a(D/100);for(E=0;E<k.length-1;E++)if(_a(k[E+1]-k[E]-D)>O){g("x scale is not linear");break}}if(A.length&&"fast"===v){var R=(A[A.length-1]-A[0])/(A.length-1),M=_a(R/100);for(E=0;E<A.length-1;E++)if(_a(A[E+1]-A[E]-R)>M){g("y scale is not linear");break}}}var j=r.maxRowLength(L),F="scaled"===t.xtype?"":k,B=u(t,F,w,T,j,h),N="scaled"===t.ytype?"":A,V=u(t,N,S,C,L.length,m);b||(t._extremes[h._id]=o.findExtremes(h,B),t._extremes[m._id]=o.findExtremes(m,V));var U={x:B,y:V,z:L,text:t._text||t.text,hovertext:t._hovertext||t.hovertext};if(F&&F.length===B.length-1&&(U.xCenter=F),N&&N.length===V.length-1&&(U.yCenter=N),_&&(U.xRanges=I.xRanges,U.yRanges=I.yRanges,U.pts=I.pts),f||l(e,t,{vals:L,cLetter:"z"}),f&&t.contours&&"heatmap"===t.contours.coloring){var H={type:"contour"===t.type?"heatmap":"histogram2d",xcalendar:t.xcalendar,ycalendar:t.ycalendar};U.xfill=u(H,F,w,T,j,h),U.yfill=u(H,N,S,C,L.length,m)}return[U]}},{"../../components/colorscale/calc":601,"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":847,"../histogram2d/calc":1033,"./clean_2d_array":1003,"./convert_column_xyz":1005,"./find_empties":1007,"./interp2d":1010,"./make_bound_array":1011}],1003:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../lib"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n,l){function s(e){return a(e)?+e:void 0}function d(e){if(t&&"carpet"!==t.type&&"contourcarpet"!==t.type&&e&&"category"===e.type&&t["_"+e._id.charAt(0)].length){var a=e._id.charAt(0),n={},l=t["_"+a+"CategoryMap"]||t[a];for(h=0;h<l.length;h++)n[l[h]]=h;return function(t){var a=n[e._categories[t]];return a+1?a:o}}return r.identity}var c,p,u,g,h,m;if(t&&t.transpose){for(c=0,h=0;h<e.length;h++)c=va(c,e[h].length);if(0===c)return!1;u=function(e){return e.length},g=function(e,t,a){return(e[a]||[])[t]}}else c=e.length,u=function(e,t){return e[t].length},g=function(e,t,a){return(e[t]||[])[a]};var y=function(e,t,a){return t===o||a===o?o:g(e,t,a)},f=d(n),x=d(l);l&&"category"===l.type&&(c=l._categories.length);var _=Array(c);for(h=0;h<c;h++)for(p=n&&"category"===n.type?n._categories.length:u(e,h),_[h]=Array(p),m=0;m<p;m++)_[h][m]=s(y(e,x(h),f(m)));return _}},{"../../constants/numerical":695,"../../lib":719,"fast-isnumeric":225}],1004:[function(e,t){"use strict";t.exports={min:"zmin",max:"zmax"}},{}],1005:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../constants/numerical").BADNUM;t.exports=function(e,t,o,n,l,s){var d=e._length,c=t.makeCalcdata(e,n),p=o.makeCalcdata(e,l),u=e.text,g=u!==void 0&&a.isArray1D(u),h=e.hovertext,m=h!==void 0&&a.isArray1D(h),y=a.distinctVals(c),f=y.vals,x=a.distinctVals(p),_=x.vals,b=[],v,k,w,T;for(v=0;v<s.length;v++)b[v]=a.init2dArray(_.length,f.length);for(g&&(w=a.init2dArray(_.length,f.length)),m&&(T=a.init2dArray(_.length,f.length)),v=0;v<d;v++)if(c[v]!==r&&p[v]!==r){var A=a.findBin(c[v]+y.minDiff/2,f),S=a.findBin(p[v]+x.minDiff/2,_);for(k=0;k<s.length;k++){var C=s[k],L=e[C],E=b[k];E[S][A]=L[v]}g&&(w[S][A]=u[v]),m&&(T[S][A]=h[v])}for(e["_"+n]=f,e["_"+l]=_,k=0;k<s.length;k++)e["_"+s[k]]=b[k];g&&(e._text=w),m&&(e._hovertext=T),t&&"category"===t.type&&(e["_"+n+"CategoryMap"]=f.map(function(e){return t._categories[e]})),o&&"category"===o.type&&(e["_"+l+"CategoryMap"]=_.map(function(e){return o._categories[e]}))}},{"../../constants/numerical":695,"../../lib":719}],1006:[function(e,t){"use strict";var a=e("../../lib"),r=e("./xyz_defaults"),o=e("./style_defaults"),i=e("../../components/colorscale/defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(r,o){return a.coerce(e,t,n,r,o)}var c=r(e,t,d,s);return c?void(d("text"),d("hovertext"),d("hovertemplate"),o(e,t,d,s),d("connectgaps",a.isArray1D(t.z)&&!1!==t.zsmooth),i(e,t,s,d,{prefix:"",cLetter:"z"})):void(t.visible=!1)}},{"../../components/colorscale/defaults":603,"../../lib":719,"./attributes":1001,"./style_defaults":1014,"./xyz_defaults":1015}],1007:[function(e,t){"use strict";var a=e("../../lib").maxRowLength;t.exports=function(e){var t=[],r={},o=[],n=e[0],l=[],s=[0,0,0],d=a(e),c,u,g,h,m,y,f,x;for(u=0;u<e.length;u++)for(c=l,l=n,n=e[u+1]||[],g=0;g<d;g++)void 0===l[g]&&(y=(void 0===l[g-1]?0:1)+(void 0===l[g+1]?0:1)+(void 0===c[g]?0:1)+(void 0===n[g]?0:1),y?(0===u&&y++,0===g&&y++,u===e.length-1&&y++,g===l.length-1&&y++,4>y&&(r[[u,g]]=[u,g,y]),t.push([u,g,y])):o.push([u,g]));for(;o.length;){for(f={},x=!1,m=o.length-1;0<=m;m--)h=o[m],u=h[0],g=h[1],y=((r[[u-1,g]]||s)[2]+(r[[u+1,g]]||s)[2]+(r[[u,g-1]]||s)[2]+(r[[u,g+1]]||s)[2])/20,y&&(f[h]=[u,g,y],o.splice(m,1),x=!0);if(!x)throw"findEmpties iterated with no new neighbors";for(h in f)r[h]=f[h],t.push(f[h])}return t.sort(function(e,t){return t[2]-e[2]})}},{"../../lib":719}],1008:[function(e,t){"use strict";var a=e("../../components/fx"),r=e("../../lib"),o=e("../../plots/cartesian/axes"),i=e("../../components/colorscale").extractOpts;t.exports=function(t,n,l,s,d,c){var p=t.cd[0],u=p.trace,g=t.xa,e=t.ya,h=p.x,m=p.y,y=p.z,f=p.xCenter,x=p.yCenter,_=p.zmask,b=u.zhoverformat,v=h,k=m,w,T,A,S;if(!1!==t.index){try{A=V(t.index[1]),S=V(t.index[0])}catch(a){return void r.error("Error hovering on heatmap, pointNumber must be [row,col], found:",t.index)}if(0>A||A>=y[0].length||0>S||S>y.length)return}else{if(0<a.inbox(n-h[0],n-h[h.length-1],0)||0<a.inbox(l-m[0],l-m[m.length-1],0))return;if(c){var C;for(v=[2*h[0]-h[1]],C=1;C<h.length;C++)v.push((h[C]+h[C-1])/2);for(v.push([2*h[h.length-1]-h[h.length-2]]),k=[2*m[0]-m[1]],C=1;C<m.length;C++)k.push((m[C]+m[C-1])/2);k.push([2*m[m.length-1]-m[m.length-2]])}A=va(0,ea(v.length-2,r.findBin(n,v))),S=va(0,ea(k.length-2,r.findBin(l,k)))}var L=g.c2p(h[A]),E=g.c2p(h[A+1]),I=e.c2p(m[S]),z=e.c2p(m[S+1]);c?(E=L,w=h[A],z=I,T=m[S]):(w=f?f[A]:(h[A]+h[A+1])/2,T=x?x[S]:(m[S]+m[S+1])/2,g&&"category"===g.type&&(w=h[A]),e&&"category"===e.type&&(T=m[S]),u.zsmooth&&(L=E=g.c2p(w),I=z=e.c2p(T)));var P=y[S][A];_&&!_[S][A]&&(P=void 0);var D;Array.isArray(p.hovertext)&&Array.isArray(p.hovertext[S])?D=p.hovertext[S][A]:Array.isArray(p.text)&&Array.isArray(p.text[S])&&(D=p.text[S][A]);var O=i(u),R={type:"linear",range:[O.min,O.max],hoverformat:b,_separators:g._separators,_numFormat:g._numFormat},M=o.tickText(R,P,"hover").text;return[r.extendFlat(t,{index:[S,A],distance:t.maxHoverDistance,spikeDistance:t.maxSpikeDistance,x0:L,x1:E,y0:I,y1:z,xLabelVal:w,yLabelVal:T,zLabelVal:P,zLabel:M,text:D})]}},{"../../components/colorscale":605,"../../components/fx":632,"../../lib":719,"../../plots/cartesian/axes":767}],1009:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:e("./colorbar"),style:e("./style"),hoverPoints:e("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap"],meta:{}}},{"../../plots/cartesian":778,"./attributes":1001,"./calc":1002,"./colorbar":1004,"./defaults":1006,"./hover":1008,"./plot":1012,"./style":1013}],1010:[function(e,t){"use strict";function a(e){return .5-.25*ea(1,.5*e)}function r(e,t,a){var r=0,o,n,s,d,c,u,g,h,m,y,f,x,_;for(d=0;d<t.length;d++){for(o=t[d],n=o[0],s=o[1],f=e[n][s],y=0,m=0,c=0;4>c;c++)u=l[c],g=e[n+u[0]],g&&(h=g[s+u[1]],void 0!==h&&(0===y?x=_=h:(x=ea(x,h),_=va(_,h)),m++,y+=h));if(0===m)throw"iterateInterp2d order is wrong: no defined neighbors";e[n][s]=y/m,f===void 0?4>m&&(r=1):(e[n][s]=(1+a)*e[n][s]-a*f,_>x&&(r=va(r,_a(e[n][s]-f)/(_-x))))}return r}var o=e("../../lib"),n=.01,l=[[-1,0],[1,0],[0,-1],[0,1]];t.exports=function(e,t){var l=1,s;for(r(e,t),s=0;s<t.length&&!(4>t[s][2]);s++);for(t=t.slice(s),s=0;100>s&&l>n;s++)l=r(e,t,a(l));return l>n&&o.log("interp2d didn't converge quickly",l),e}},{"../../lib":719}],1011:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,o,n,l,s){var d=[],c=a.traceIs(e,"contour"),p=a.traceIs(e,"histogram"),u=a.traceIs(e,"gl2d"),g=r(t)&&1<t.length,h,m,y;if(g&&!p&&"category"!==s.type){var f=t.length;if(f<=l){if(c||u)d=t.slice(0,l);else if(1===l)d=[t[0]-.5,t[0]+.5];else{for(d=[1.5*t[0]-.5*t[1]],y=1;y<f;y++)d.push(.5*(t[y-1]+t[y]));d.push(1.5*t[f-1]-.5*t[f-2])}if(f<l){var x=d[d.length-1],_=x-d[d.length-2];for(y=f;y<l;y++)x+=_,d.push(x)}}else return c?t.slice(0,l):t.slice(0,l+1)}else{var b=e[s._id.charAt(0)+"calendar"];if(p)h=s.r2c(o,0,b);else if(r(t)&&1===t.length)h=t[0];else if(void 0===o)h=0;else{var v="log"===s.type?s.d2c:s.r2c;h=v(o,0,b)}for(m=n||1,y=c||u?0:-.5;y<l;y++)d.push(h+m*y)}return d}},{"../../lib":719,"../../registry":847}],1012:[function(e,t){"use strict";function a(e,t){var a=t.length-2,r=p.constrain(p.findBin(e,t),0,a),o=t[r],i=t[r+1],n=p.constrain(r+(e-o)/(i-o)-.5,0,a),l=V(n),s=_a(n-l);return n&&n!==a&&s?{bin0:l,frac:s,bin1:V(l+s/(n-l))}:{bin0:l,bin1:l,frac:0}}function r(e,t){var a=t.length-1,r=p.constrain(p.findBin(e,t),0,a),o=t[r],i=t[r+1],n=(e-o)/(i-o)||0;return 0>=n?{bin0:r,bin1:r,frac:0}:.5>n?{bin0:r,bin1:r+1,frac:n}:{bin0:r+1,bin1:r,frac:1-n}}function o(e,t,a){e[t]=a[0],e[t+1]=a[1],e[t+2]=a[2],e[t+3]=V(255*a[3])}var l=e("d3"),s=e("tinycolor2"),d=e("../../registry"),p=e("../../lib"),u=e("../../components/colorscale").makeColorScaleFuncFromTrace,g=e("../../constants/xmlns_namespaces");t.exports=function(e,t,i,n){var c=t.xaxis,h=t.yaxis;p.makeTraceGroups(n,i,"hm").each(function(t){function f(e,t){if(void 0!==e){var a=Z(e);return a[0]=V(a[0]),a[1]=V(a[1]),a[2]=V(a[2]),ae+=t,re+=a[0]*t,oe+=a[1]*t,ie+=a[2]*t,a}return[0,0,0,0]}function _(e,t,a,r){var o=e[a.bin0];if(void 0===o)return f(void 0,1);var i=e[a.bin1],n=t[a.bin0],l=t[a.bin1],s;return s=void 0===i?void 0===l?0:void 0===n?2*(l-o):2*(2*l-n-o)/3:void 0===l?void 0===n?0:2*(2*o-i-n)/3:void 0===n?2*(2*l-i-o)/3:l+o-i-n,f(o+a.frac*(i-o||0)+r.frac*((n-o||0)+a.frac*s))}var b=l.select(this),k=t[0],w=k.trace,T=k.z,A=k.x,S=k.y,C=k.xCenter,L=k.yCenter,E=d.traceIs(w,"contour"),I=E?"best":w.zsmooth,z=T.length,m=p.maxRowLength(T),n=!1,P=!1,D,O,R,M,F,B;for(B=0;void 0===D&&B<A.length-1;)D=c.c2p(A[B]),B++;for(B=A.length-1;void 0===O&&0<B;)O=c.c2p(A[B]),B--;for(O<D&&(R=O,O=D,D=R,n=!0),B=0;void 0===M&&B<S.length-1;)M=h.c2p(S[B]),B++;for(B=S.length-1;void 0===F&&0<B;)F=h.c2p(S[B]),B--;if(F<M&&(R=M,M=F,F=R,P=!0),E&&(C=A,L=S,A=k.xfill,S=k.yfill),"fast"!==I){var N="best"===I?0:.5;D=va(-N*c._length,D),O=ea((1+N)*c._length,O),M=va(-N*h._length,M),F=ea((1+N)*h._length,F)}var U=V(O-D),H=V(F-M);if(0>=U||0>=H){var G=b.selectAll("image").data([]);return void G.exit().remove()}var q,Y;"fast"===I?(q=m,Y=z):(q=U,Y=H);var W=document.createElement("canvas");W.width=q,W.height=Y;var X=W.getContext("2d"),Z=u(w,{noNumericCheck:!0,returnArray:!0}),K,J;"fast"===I?(K=n?function(e){return m-1-e}:p.identity,J=P?function(e){return z-1-e}:p.identity):(K=function(e){return p.constrain(V(c.c2p(A[e])-D),0,U)},J=function(e){return p.constrain(V(h.c2p(S[e])-M),0,H)});var Q=J(0),$=[Q,Q],ee=n?0:1,te=P?0:1,ae=0,re=0,oe=0,ie=0,ne,le,se,de,ce,pe;if(I){var ue=0,ge;try{ge=new Uint8Array(4*(U*H))}catch(t){ge=Array(4*(U*H))}if("best"===I){var he=C||A,me=L||S,ye=Array(he.length),fe=Array(me.length),xe=Array(U),_e=C?r:a,be=L?r:a,ve,ke,we;for(B=0;B<he.length;B++)ye[B]=V(c.c2p(he[B])-D);for(B=0;B<me.length;B++)fe[B]=V(h.c2p(me[B])-M);for(B=0;B<U;B++)xe[B]=_e(B,ye);for(le=0;le<H;le++)for(ve=be(le,fe),ke=T[ve.bin0],we=T[ve.bin1],B=0;B<U;B++,ue+=4)pe=_(ke,we,xe[B],ve),o(ge,ue,pe)}else for(le=0;le<z;le++)for(ce=T[le],$=J(le),B=0;B<U;B++)pe=f(ce[B],1),ue=4*($*U+K(B)),o(ge,ue,pe);var Te=X.createImageData(U,H);try{Te.data.set(ge)}catch(t){var Ae=Te.data,Se=Ae.length;for(le=0;le<Se;le++)Ae[le]=ge[le]}X.putImageData(Te,0,0)}else{var Ce=w.xgap,Le=w.ygap,Ee=ba(Ce/2),Ie=ba(Le/2);for(le=0;le<z;le++)if(ce=T[le],$.reverse(),$[te]=J(le+1),$[0]!==$[1]&&void 0!==$[0]&&void 0!==$[1])for(se=K(0),ne=[se,se],B=0;B<m;B++)(ne.reverse(),ne[ee]=K(B+1),ne[0]!==ne[1]&&void 0!==ne[0]&&void 0!==ne[1])&&(de=ce[B],pe=f(de,(ne[1]-ne[0])*($[1]-$[0])),X.fillStyle="rgba("+pe.join(",")+")",X.fillRect(ne[0]+Ee,$[0]+Ie,ne[1]-ne[0]-Ce,$[1]-$[0]-Le))}re=V(re/ae),oe=V(oe/ae),ie=V(ie/ae);var ze=s("rgb("+re+","+oe+","+ie+")");e._hmpixcount=(e._hmpixcount||0)+ae,e._hmlumcount=(e._hmlumcount||0)+ae*ze.getLuminance();var Pe=b.selectAll("image").data(t);Pe.enter().append("svg:image").attr({xmlns:g.svg,preserveAspectRatio:"none"}),Pe.attr({height:H,width:U,x:D,y:M,"xlink:href":W.toDataURL("image/png")})})}},{"../../components/colorscale":605,"../../constants/xmlns_namespaces":696,"../../lib":719,"../../registry":847,d3:163,tinycolor2:537}],1013:[function(e,t){"use strict";var a=e("d3");t.exports=function(e){a.select(e).selectAll(".hm image").style("opacity",function(e){return e.trace.opacity})}},{d3:163}],1014:[function(e,t){"use strict";t.exports=function(e,t,a){var r=a("zsmooth");!1===r&&(a("xgap"),a("ygap")),a("zhoverformat")}},{}],1015:[function(e,t){"use strict";function a(e,t){var a=t(e),r=a?t(e+"type","array"):"scaled";return"scaled"===r&&(t(e+"0"),t("d"+e)),a}function r(e){for(var t=!0,a=!1,r=!1,l=0,s;l<e.length;l++){if(s=e[l],!n.isArrayOrTypedArray(s)){t=!1;break}0<s.length&&(a=!0);for(var d=0;d<s.length;d++)if(o(s[d])){r=!0;break}}return t&&a&&r}var o=e("fast-isnumeric"),n=e("../../lib"),l=e("../../registry");t.exports=function(e,t,o,i,s,d){var c=o("z");s=s||"x",d=d||"y";var p,u;if(void 0===c||!c.length)return 0;if(n.isArray1D(e.z)){p=o(s),u=o(d);var g=n.minRowLength(p),h=n.minRowLength(u);if(0===g||0===h)return 0;t._length=ea(g,h,c.length)}else{if(p=a(s,o),u=a(d,o),!r(c))return 0;o("transpose"),t._length=null}var m=l.getComponentMethod("calendars","handleTraceDefaults");return m(e,t,[s,d],i),!0}},{"../../lib":719,"../../registry":847,"fast-isnumeric":225}],1016:[function(e,t){"use strict";for(var a=e("../heatmap/attributes"),r=e("../../components/colorscale/attributes"),o=e("../../lib/extend").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],s={},d=0,c;d<l.length;d++)c=l[d],s[c]=a[c];o(s,r("",{cLetter:"z",autoColorDflt:!1})),t.exports=n(s,"calc","nested")},{"../../components/colorscale/attributes":600,"../../lib/extend":710,"../../plot_api/edit_types":750,"../heatmap/attributes":1001}],1017:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=o(e.glplot,this.options),this.heatmap._trace=this}function r(e){for(var t=e.colorscale,a=e.zmin,r=e.zmax,o=t.length,l=Array(o),s=Array(4*o),d=0;d<o;d++){var c=t[d],p=n(c[1]);l[d]=a+c[0]*(r-a);for(var u=0;4>u;u++)s[4*d+u]=p[u]}return{colorLevels:l,colorValues:s}}var o=e("gl-heatmap2d"),i=e("../../plots/cartesian/axes"),n=e("../../lib/str2rgbarray"),l=a.prototype;l.handlePick=function(e){var t=this.options,a=t.shape,r=e.pointId,o=r%a[0],i=ba(r/a[0]);return{trace:this,dataCoord:e.dataCoord,traceCoord:[t.x[o],t.y[i],t.z[r]],textLabel:this.textLabels[r],name:this.name,pointIndex:[i,o],hoverinfo:this.hoverinfo}},l.update=function(e,t){var a=t[0];this.index=e.index,this.name=e.name,this.hoverinfo=e.hoverinfo;var o=a.z;this.options.z=[].concat.apply([],o);var n=o[0].length,l=o.length;this.options.shape=[n,l],this.options.x=a.x,this.options.y=a.y;var s=r(e);this.options.colorLevels=s.colorLevels,this.options.colorValues=s.colorValues,this.textLabels=[].concat.apply([],e.text),this.heatmap.update(this.options);var d=this.scene.xaxis,c=this.scene.yaxis;e._extremes[d._id]=i.findExtremes(d,a.x),e._extremes[c._id]=i.findExtremes(c,a.y)},l.dispose=function(){this.heatmap.dispose()},t.exports=function(e,t,r){var o=new a(e,t.uid);return o.update(t,r),o}},{"../../lib/str2rgbarray":742,"../../plots/cartesian/axes":767,"gl-heatmap2d":251}],1018:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("../heatmap/defaults"),colorbar:e("../heatmap/colorbar"),calc:e("../heatmap/calc"),plot:e("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":805,"../heatmap/calc":1002,"../heatmap/colorbar":1004,"../heatmap/defaults":1006,"./attributes":1016,"./convert":1017}],1019:[function(e,t){"use strict";var a=e("../bar/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("./bin_attributes"),i=e("./constants"),n=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:n({},a.text,{}),hovertext:n({},a.hovertext,{}),orientation:a.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:o("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:o("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:r({},{keys:i.eventDataKeys}),marker:a.marker,offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,_deprecated:{bardir:a._deprecated.bardir}}},{"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../bar/attributes":857,"./bin_attributes":1021,"./constants":1025}],1020:[function(e,t){"use strict";t.exports=function(e,t){for(var a=e.length,r=0,o=0;o<a;o++)t[o]?(e[o]/=t[o],r+=e[o]):e[o]=null;return r}},{}],1021:[function(e,t){"use strict";t.exports=function(){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1022:[function(e,t){"use strict";var a=e("fast-isnumeric");t.exports={count:function(e,t,a){return a[e]++,1},sum:function(e,t,r,o){var i=o[t];return a(i)?(i=+i,r[e]+=i,i):0},avg:function(e,t,r,o,i){var n=o[t];return a(n)&&(n=+n,r[e]+=n,i[e]++),0},min:function(e,t,r,o){var i=o[t];if(a(i)){if(i=+i,!a(r[e]))return r[e]=i,i;if(r[e]>i){var n=i-r[e];return r[e]=i,n}}return 0},max:function(e,t,r,o){var i=o[t];if(a(i)){if(i=+i,!a(r[e]))return r[e]=i,i;if(r[e]<i){var n=i-r[e];return r[e]=i,n}}return 0}}},{"fast-isnumeric":225}],1023:[function(e,t){"use strict";function a(e,t,a,n){if(0>=e*t)return 1/0;for(var l=_a(t-e),s="date"===a.type,d=r(l,s),c=0,p;10>c&&(p=r(80*d,s),d!==p)&&o(p,e,t,s,a,n);c++)d=p;return d}function r(e,t){return t&&e>u?e>d?e>1.1*l?l:e>1.1*s?s:d:e>c?c:e>p?p:u:ya(10,ba(P(e)/I))}function o(e,t,a,r,o,n){if(r&&e>d){var s=i(t,o,n),c=i(a,o,n),p=e===l?0:1;return s[p]!==c[p]}return .1<ba(a/e)-ba(t/e)}function i(e,t,a){var r=t.c2d(e,l,a).split("-");return""===r[0]&&(r.unshift(),r[0]="-"+r[0]),r}var n=e("../../constants/numerical"),l=n.ONEAVGYEAR,s=n.ONEAVGMONTH,d=n.ONEDAY,c=n.ONEHOUR,p=n.ONEMIN,u=n.ONESEC,g=e("../../plots/cartesian/axes").tickIncrement;t.exports=function(e,t,r,o,i){var n=-1.1*t,s=-.1*t,c=e-s,p=r[0],u=r[1],h=ea(a(p+s,p+c,o,i),a(u+s,u+c,o,i)),m=ea(a(p+n,p+s,o,i),a(u+n,u+s,o,i)),y,f;if(h>m&&m<_a(u-p)/4e3?(y=h,f=!1):(y=ea(h,m),f=!0),"date"===o.type&&y>d){var x=y===l?1:6,_=y===l?"M12":"M1";return function(t,a){var r=o.c2d(t,l,i),n=r.indexOf("-",x);0<n&&(r=r.substr(0,n));var s=o.d2c(r,0,i);if(s<t){var d=g(s,_,!1,i);(s+d)/2<t+e&&(s=d)}return a&&f?g(s,_,!0,i):s}}return function(t,a){var r=y*V(t/y);return r+y/10<t&&r+.9*y<t+e&&(r+=y),a&&f&&(r-=y),r}}},{"../../constants/numerical":695,"../../plots/cartesian/axes":767}],1024:[function(e,t){"use strict";function a(e,t,a,o,n){function l(e,t,a){t[e+"Found"]?(t[e]=_(t[e]),null===t[e]&&(t[e]=a[e])):(A[e]=t[e]=a[e],d.nestedProperty(v[0],u+"."+e).set(a[e]))}var u=o+"bins",g=e._fullLayout,h=t["_"+o+"bingroup"],m=g._histogramBinOpts[h],y="overlay"===g.barmode,f=function(e){return a.r2c(e,0,w)},x=function(e){return a.c2r(e,0,w)},_="date"===a.type?function(e){return e||0===e?d.cleanDate(e,null,w):null}:function(e){return s(e)?+e:null},b,v,k,w,T,A,S;if(t["_"+o+"autoBinFinished"])delete t["_"+o+"autoBinFinished"];else{v=m.traces;var C=[],L=!0,E=!1,I=!1;for(b=0;b<v.length;b++)if(k=v[b],k.visible){var z=m.dirs[b];T=k["_"+z+"pos0"]=a.makeCalcdata(k,z),C=d.concat(C,T),delete k["_"+o+"autoBinFinished"],!0===t.visible&&(L?L=!1:(delete k._autoBin,k["_"+o+"autoBinFinished"]=1),c.traceIs(k,"2dMap")&&(E=!0),"histogram2dcontour"===k.type&&(I=!0))}w=v[0][o+"calendar"];var P=p.autoBin(C,a,m.nbins,E,w,m.sizeFound&&m.size),D=v[0]._autoBin={};if(A=D[m.dirs[0]]={},I&&(!m.size&&(P.start=x(p.tickIncrement(f(P.start),P.size,!0,w))),void 0===m.end&&(P.end=x(p.tickIncrement(f(P.end),P.size,!1,w)))),y&&!c.traceIs(t,"2dMap")&&0===P._dataSpan&&"category"!==a.type&&"multicategory"!==a.type){if(n)return[P,T,!0];P=r(e,t,a,o,u)}S=k.cumulative||{},S.enabled&&"include"!==S.currentbin&&("decreasing"===S.direction?P.start=x(p.tickIncrement(f(P.start),P.size,!0,w)):P.end=x(p.tickIncrement(f(P.end),P.size,!1,w))),m.size=P.size,m.sizeFound||(A.size=P.size,d.nestedProperty(v[0],u+".size").set(P.size)),l("start",m,P),l("end",m,P)}T=t["_"+o+"pos0"],delete t["_"+o+"pos0"];var O=t._input[u]||{},R=d.extendFlat({},m),M=m.start,j=a.r2l(O.start),F=void 0!==j;if((m.startFound||F)&&j!==a.r2l(M)){var B=F?j:d.aggNums(Math.min,null,T),N={type:"category"===a.type||"multicategory"===a.type?"linear":a.type,r2l:a.r2l,dtick:m.size,tick0:M,calendar:w,range:[B,p.tickIncrement(B,m.size,!1,w)].map(a.l2r)},V=p.tickFirst(N);V>a.r2l(B)&&(V=p.tickIncrement(V,m.size,!0,w)),R.start=a.l2r(V),F||d.nestedProperty(t,u+".start").set(R.start)}var U=m.end,H=a.r2l(O.end),G=void 0!==H;if((m.endFound||G)&&H!==a.r2l(U)){var q=G?H:d.aggNums(Math.max,null,T);R.end=a.l2r(q),G||d.nestedProperty(t,u+".start").set(R.end)}var Y="autobin"+o;return!1===t._input[Y]&&(t._input[u]=d.extendFlat({},t[u]||{}),delete t._input[Y],delete t[Y]),[R,T]}function r(e,t,r,n,l){var s=e._fullLayout,c=o(e,t),p=!1,u=1/0,g=[t],h,m,y;for(h=0;h<c.length;h++)if(m=c[h],m===t)p=!0;else if(!p)y=s._histogramBinOpts[m["_"+n+"bingroup"]],u=ea(u,y.size||m[l].size);else{var f=a(e,m,r,n,!0),x=f[0],_=f[2];m["_"+n+"autoBinFinished"]=1,m["_"+n+"pos0"]=f[1],_?g.push(m):u=ea(u,x.size)}var b=Array(g.length);for(h=0;h<g.length;h++)for(var v=g[h]["_"+n+"pos0"],k=0;k<v.length;k++)if(void 0!==v[k]){b[h]=v[k];break}for(isFinite(u)||(u=d.distinctVals(b).minDiff),h=0;h<g.length;h++){m=g[h];var w=m[n+"calendar"],T={start:r.c2r(b[h]-u/2,0,w),end:r.c2r(b[h]+u/2,0,w),size:u};m._input[l]=m[l]=T,y=s._histogramBinOpts[m["_"+n+"bingroup"]],y&&d.extendFlat(y,T)}return t[l]}function o(e,t){for(var a=t.xaxis,r=t.yaxis,o=t.orientation,n=[],l=e._fullData,s=0,d;s<l.length;s++)d=l[s],"histogram"===d.type&&!0===d.visible&&d.orientation===o&&d.xaxis===a&&d.yaxis===r&&n.push(d);return n}function l(e,t,a){function r(t){s=e[t],e[t]/=2}function o(t){l=e[t],e[t]=s+l/2,s+=l}var n,l,s;if("half"===a){if("increasing"===t)for(r(0),n=1;n<e.length;n++)o(n);else for(r(e.length-1),n=e.length-2;0<=n;n--)o(n);}else if("increasing"===t){for(n=1;n<e.length;n++)e[n]+=e[n-1];"exclude"===a&&(e.unshift(0),e.pop())}else{for(n=e.length-2;0<=n;n--)e[n]+=e[n+1];"exclude"===a&&(e.push(0),e.shift())}}var s=e("fast-isnumeric"),d=e("../../lib"),c=e("../../registry"),p=e("../../plots/cartesian/axes"),u=e("../bar/arrays_to_calcdata"),g=e("./bin_functions"),h=e("./norm_functions"),m=e("./average"),y=e("./bin_label_vals");t.exports={calc:function(e,t){var r=[],o=[],c=p.getFromId(e,"h"===t.orientation?t.yaxis:t.xaxis),f="h"===t.orientation?"y":"x",x={x:"y",y:"x"}[f],_=t[f+"calendar"],b=t.cumulative,v=a(e,t,c,f),k=v[0],w=v[1],T="string"==typeof k.size,A=[],S=T?A:k,C=[],L=[],E=[],I=0,z=t.histnorm,P=t.histfunc,D=-1!==z.indexOf("density"),O,R,M,j;b.enabled&&D&&(z=z.replace(/ ?density$/,""),D=!1);var F="max"===P||"min"===P?null:0,B=g.count,N=h[z],V=!1,U=function(e){return c.r2c(e,0,_)},H;for(d.isArrayOrTypedArray(t[x])&&"count"!==P&&(H=t[x],V="avg"===P,B=g[P]),O=U(k.start),M=U(k.end)+(O-p.tickIncrement(O,k.size,!1,_))/1e6;O<M&&1e6>r.length&&(R=p.tickIncrement(O,k.size,!1,_),r.push((O+R)/2),o.push(F),E.push([]),A.push(O),D&&C.push(1/(R-O)),V&&L.push(0),!(R<=O));)O=R;A.push(O),T||"date"!==c.type||(S={start:U(S.start),end:U(S.end),size:S.size});var G=o.length,q=!0,Y=1/0,W=1/0,X={};for(O=0;O<w.length;O++){var Z=w[O];j=d.findBin(Z,S),0<=j&&j<G&&(I+=B(j,O,o,H,L),q&&E[j].length&&Z!==w[E[j][0]]&&(q=!1),E[j].push(O),X[O]=j,Y=ea(Y,Z-A[j]),W=ea(W,A[j+1]-Z))}var K;q||(K=y(Y,W,A,c,_)),V&&(I=m(o,L)),N&&N(o,I,C),b.enabled&&l(o,b.direction,b.currentbin);var J=ea(r.length,o.length),Q=[],$=0,ee=J-1;for(O=0;O<J;O++)if(o[O]){$=O;break}for(O=J-1;O>=$;O--)if(o[O]){ee=O;break}for(O=$;O<=ee;O++)if(s(r[O])&&s(o[O])){var te={p:r[O],s:o[O],b:0};b.enabled||(te.pts=E[O],q?te.ph0=te.ph1=E[O].length?w[E[O][0]]:r[O]:(te.ph0=K(A[O]),te.ph1=K(A[O+1],!0))),Q.push(te)}return 1===Q.length&&(Q[0].width1=p.tickIncrement(Q[0].p,k.size,!1,_)-Q[0].p),u(Q,t),d.isArrayOrTypedArray(t.selectedpoints)&&d.tagSelected(Q,t,X),Q},calcAllAutoBins:a}},{"../../lib":719,"../../plots/cartesian/axes":767,"../../registry":847,"../bar/arrays_to_calcdata":856,"./average":1020,"./bin_functions":1022,"./bin_label_vals":1023,"./norm_functions":1031,"fast-isnumeric":225}],1025:[function(e,t){"use strict";t.exports={eventDataKeys:["binNumber"]}},{}],1026:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../plots/cartesian/axis_ids"),o=e("../../registry").traceIs,n=e("../bar/defaults").handleGroupingDefaults,l=a.nestedProperty,s=r.getAxisGroup,d=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],c=["x","y"];t.exports=function(e,t){function p(e,t){return a.coerce(_._input,_,_._module.attributes,e,t)}function u(e){return"v"===e.orientation?"x":"y"}function g(e,a){var o=r.getFromTrace({_fullLayout:t},e,a);return o.type}function h(e,t,r){var o=e.uid+"__"+r;t||(t=o);var i=g(e,r),n=e[r+"calendar"],l=m[t],s=!0;l&&(i===l.axType&&n===l.calendar?(s=!1,l.traces.push(e),l.dirs.push(r)):(t=o,i!==l.axType&&a.warn(["Attempted to group the bins of trace",e.index,"set on a","type:"+i,"axis","with bins on","type:"+l.axType,"axis."].join(" ")),n!==l.calendar&&a.warn(["Attempted to group the bins of trace",e.index,"set with a",n,"calendar","with bins",l.calendar?"on a "+l.calendar+" calendar":"w/o a set calendar"].join(" ")))),s&&(m[t]={traces:[e],dirs:[r],axType:i,calendar:e[r+"calendar"]||""}),e["_"+r+"bingroup"]=t}var m=t._histogramBinOpts={},y=[],f={},x=[],_,b,v,w,T,A,S;for(T=0;T<e.length;T++)_=e[T],o(_,"histogram")&&(y.push(_),delete _._xautoBinFinished,delete _._yautoBinFinished,!o(_,"2dMap")&&n(_._input,_,t,p));var C=t._alignmentOpts||{};for(T=0;T<y.length;T++){if(_=y[T],v="",!o(_,"2dMap")){if(w=u(_),"group"===t.barmode&&_.alignmentgroup){var L=_[w+"axis"],E=s(t,L)+_.orientation;(C[E]||{})[_.alignmentgroup]&&(v=E)}v||"overlay"===t.barmode||(v=s(t,_.xaxis)+s(t,_.yaxis)+u(_))}v?(!f[v]&&(f[v]=[]),f[v].push(_)):x.push(_)}for(v in f){if(b=f[v],1===b.length){x.push(b[0]);continue}var I=!1;for(T=0;T<b.length;T++){_=b[T],I=p("bingroup");break}for(v=I||v,T=0;T<b.length;T++){_=b[T];var z=_._input.bingroup;z&&z!==v&&a.warn(["Trace",_.index,"must match","within bingroup",v+".","Ignoring its bingroup:",z,"setting."].join(" ")),_.bingroup=v,h(_,v,u(_))}}for(T=0;T<x.length;T++){_=x[T];var P=p("bingroup");if(o(_,"2dMap"))for(S=0;2>S;S++){w=c[S];var D=p(w+"bingroup",P?P+"__"+w:null);h(_,D,w)}else h(_,P,u(_))}for(v in m){var O=m[v];for(b=O.traces,A=0;A<d.length;A++){var R=d[A],M=R.name,F,B;if(!("nbins"===M&&O.sizeFound)){for(T=0;T<b.length;T++){if(_=b[T],w=O.dirs[T],F=R.aStr[w],void 0!==l(_._input,F).get()){O[M]=p(F),O[M+"Found"]=!0;break}B=(_._autoBin||{})[w]||{},B[M]&&l(_,F).set(B[M])}if("start"===M||"end"===M)for(;T<b.length;T++)_=b[T],_["_"+w+"bingroup"]&&(B=(_._autoBin||{})[w]||{},p(F,B[M]));"nbins"!==M||O.sizeFound||O.nbinsFound||(_=b[0],O[M]=p(F))}}}}},{"../../lib":719,"../../plots/cartesian/axis_ids":770,"../../registry":847,"../bar/defaults":861}],1027:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib"),o=e("../../components/color"),i=e("../bar/style_defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(a,o){return r.coerce(e,t,n,a,o)}var c=d("x"),p=d("y"),u=d("cumulative.enabled");u&&(d("cumulative.direction"),d("cumulative.currentbin")),d("text"),d("hovertext"),d("hovertemplate");var g=d("orientation",p&&!c?"h":"v"),h="v"===g?"x":"y",m="v"===g?"y":"x",y=c&&p?ea(r.minRowLength(c)&&r.minRowLength(p)):r.minRowLength(t[h]||[]);if(!y)return void(t.visible=!1);t._length=y;var f=a.getComponentMethod("calendars","handleTraceDefaults");f(e,t,["x","y"],s);var x=t[m];x&&d("histfunc"),d("histnorm"),d("autobin"+h),i(e,t,d,l,s),r.coerceSelectionMarkerOpacity(t,d);var _=(t.marker.line||{}).color,b=a.getComponentMethod("errorbars","supplyDefaults");b(e,t,_||o.defaultLine,{axis:"y"}),b(e,t,_||o.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":593,"../../lib":719,"../../registry":847,"../bar/style_defaults":871,"./attributes":1019}],1028:[function(e,t){"use strict";t.exports=function(e,t,a,r,o){if(e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,"zLabelVal"in t&&(e.z=t.zLabelVal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),!(a.cumulative||{}).enabled){var n=Array.isArray(o)?r[0].pts[o[0]][o[1]]:r[o].pts;e.pointNumbers=n,e.binNumber=e.pointNumber,delete e.pointNumber,delete e.pointIndex;var l;if(a._indexToPoints){l=[];for(var s=0;s<n.length;s++)l=l.concat(a._indexToPoints[n[s]])}else l=n;e.pointIndices=l}return e}},{}],1029:[function(e,t){"use strict";var a=e("../bar/hover").hoverPoints,r=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function(e,t,o,i){var n=a(e,t,o,i);if(n){e=n[0];var l=e.cd[e.index],s=e.cd[0].trace;if(!s.cumulative.enabled){var d="h"===s.orientation?"y":"x";e[d+"Label"]=r(e[d+"a"],l.ph0,l.ph1)}return s.hovermplate&&(e.hovertemplate=s.hovertemplate),n}}},{"../../plots/cartesian/axes":767,"../bar/hover":863}],1030:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("../bar/layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),supplyLayoutDefaults:e("../bar/layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("../bar/cross_trace_calc").crossTraceCalc,plot:e("../bar/plot").plot,layerName:"barlayer",style:e("../bar/style").style,styleOnSelect:e("../bar/style").styleOnSelect,colorbar:e("../scatter/marker_colorbar"),hoverPoints:e("./hover"),selectPoints:e("../bar/select"),eventData:e("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":778,"../bar/cross_trace_calc":860,"../bar/layout_attributes":865,"../bar/layout_defaults":866,"../bar/plot":867,"../bar/select":868,"../bar/style":870,"../scatter/marker_colorbar":1129,"./attributes":1019,"./calc":1024,"./cross_trace_defaults":1026,"./defaults":1027,"./event_data":1028,"./hover":1029}],1031:[function(e,t){"use strict";t.exports={percent:function(e,t){for(var a=e.length,r=0;r<a;r++)e[r]*=100/t},probability:function(e,t){for(var a=e.length,r=0;r<a;r++)e[r]/=t},density:function(e,t,a,r){var o=e.length;r=r||1;for(var i=0;i<o;i++)e[i]*=a[i]*r},"probability density":function(e,t,a,r){var o=e.length;r&&(t/=r);for(var i=0;i<o;i++)e[i]*=a[i]/t}}},{}],1032:[function(e,t){"use strict";var a=e("../histogram/attributes"),r=e("../histogram/bin_attributes"),o=e("../heatmap/attributes"),i=e("../../components/fx/hovertemplate_attributes"),n=e("../../components/colorscale/attributes"),l=e("../../lib/extend").extendFlat;t.exports=l({x:a.x,y:a.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:r("x"),nbinsy:a.nbinsy,ybins:r("y"),autobinx:a.autobinx,autobiny:a.autobiny,bingroup:l({},a.bingroup,{}),xbingroup:l({},a.bingroup,{}),ybingroup:l({},a.bingroup,{}),xgap:o.xgap,ygap:o.ygap,zsmooth:o.zsmooth,zhoverformat:o.zhoverformat,hovertemplate:i({},{keys:"z"})},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../heatmap/attributes":1001,"../histogram/attributes":1019,"../histogram/bin_attributes":1021}],1033:[function(e,t){"use strict";function a(e,t,a,r){var o=Array(e),n;if(r)for(n=0;n<e;n++)o[n]=1/(t[n+1]-t[n]);else{for(n=0;n<e;n++)o[n]=1/a}return o}function r(e,t){return{start:e(t.start),end:e(t.end),size:t.size}}function o(e,t,a,r,o,n){var l=e.length-1,s=Array(l),d=u(a,r,e,o,n),c;for(c=0;c<l;c++){var p=(t||[])[c];s[c]=p===void 0?[d(e[c]),d(e[c+1],!0)]:[p,p]}return s}var l=e("../../lib"),s=e("../../plots/cartesian/axes"),d=e("../histogram/bin_functions"),c=e("../histogram/norm_functions"),p=e("../histogram/average"),u=e("../histogram/bin_label_vals"),g=e("../histogram/calc").calcAllAutoBins;t.exports=function(e,t){var u=s.getFromId(e,t.xaxis),h=s.getFromId(e,t.yaxis),y=t.xcalendar,f=t.ycalendar,x=function(e){return u.r2c(e,0,y)},_=function(e){return h.r2c(e,0,f)},b=g(e,t,u,"x"),v=b[0],k=b[1],w=g(e,t,h,"y"),T=w[0],A=w[1],S=t._length,C,L,E,I;k.length>S&&k.splice(S,k.length-S),A.length>S&&A.splice(S,A.length-S);var P=[],z=[],D=[],O="string"==typeof v.size,R="string"==typeof T.size,M=[],F=[],B=O?M:v,N=R?F:T,V=0,U=[],H=[],G=t.histnorm,q=t.histfunc,Y=-1!==G.indexOf("density"),W="max"===q||"min"===q?null:0,X=d.count,Z=c[G],K=!1,J=[],Q=[],$="z"in t?t.z:"marker"in t&&Array.isArray(t.marker.color)?t.marker.color:"";$&&"count"!==q&&(K="avg"===q,X=d[q]);var ee=v.size,te=x(v.start),ae=x(v.end)+(te-s.tickIncrement(te,ee,!1,y))/1e6;for(C=te;C<ae;C=s.tickIncrement(C,ee,!1,y))z.push(W),M.push(C),K&&D.push(0);M.push(C);var re=z.length,oe=(C-te)/re,ie=function(e){return u.c2r(e,0,y)}(te+oe/2),ne=T.size,le=_(T.start),se=_(T.end)+(le-s.tickIncrement(le,ne,!1,f))/1e6;for(C=le;C<se;C=s.tickIncrement(C,ne,!1,f)){P.push(z.slice()),F.push(C);var de=Array(re);for(L=0;L<re;L++)de[L]=[];H.push(de),K&&U.push(D.slice())}F.push(C);var ce=P.length,pe=(C-le)/ce,ue=function(e){return h.c2r(e,0,f)}(le+pe/2);Y&&(J=a(z.length,B,oe,O),Q=a(P.length,N,pe,R)),O||"date"!==u.type||(B=r(x,B)),R||"date"!==h.type||(N=r(_,N));var ge=!0,he=!0,me=Array(re),ye=Array(ce),fe=1/0,xe=1/0,_e=1/0,be=1/0;for(C=0;C<S;C++){var ve=k[C],ke=A[C];E=l.findBin(ve,B),I=l.findBin(ke,N),0<=E&&E<re&&0<=I&&I<ce&&(V+=X(E,C,P[I],$,U[I]),H[I][E].push(C),ge&&(me[E]===void 0?me[E]=ve:me[E]!==ve&&(ge=!1)),he&&(ye[I]===void 0?ye[I]=ke:ye[I]!==ke&&(he=!1)),fe=ea(fe,ve-M[E]),xe=ea(xe,M[E+1]-ve),_e=ea(_e,ke-F[I]),be=ea(be,F[I+1]-ke))}if(K)for(I=0;I<ce;I++)V+=p(P[I],U[I]);if(Z)for(I=0;I<ce;I++)Z(P[I],V,J,Q[I]);return{x:k,xRanges:o(M,ge&&me,fe,xe,u,y),x0:ie,dx:oe,y:A,yRanges:o(F,he&&ye,_e,be,h,f),y0:ue,dy:pe,z:P,pts:H}}},{"../../lib":719,"../../plots/cartesian/axes":767,"../histogram/average":1020,"../histogram/bin_functions":1022,"../histogram/bin_label_vals":1023,"../histogram/calc":1024,"../histogram/norm_functions":1031}],1034:[function(e,t){"use strict";var a=e("../../lib"),r=e("./sample_defaults"),o=e("../heatmap/style_defaults"),i=e("../../components/colorscale/defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(r,o){return a.coerce(e,t,n,r,o)}r(e,t,d,s);!1===t.visible||(o(e,t,d,s),i(e,t,s,d,{prefix:"",cLetter:"z"}),d("hovertemplate"))}},{"../../components/colorscale/defaults":603,"../../lib":719,"../heatmap/style_defaults":1014,"./attributes":1032,"./sample_defaults":1037}],1035:[function(e,t){"use strict";var a=e("../heatmap/hover"),r=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function(e,t,o,i,n,l){var s=a(e,t,o,i,n,l);if(s){e=s[0];var d=e.index,c=d[0],p=d[1],u=e.cd[0],g=u.xRanges[p],h=u.yRanges[c];return e.xLabel=r(e.xa,g[0],g[1]),e.yLabel=r(e.ya,h[0],h[1]),s}}},{"../../plots/cartesian/axes":767,"../heatmap/hover":1008}],1036:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../heatmap/calc"),plot:e("../heatmap/plot"),layerName:"heatmaplayer",colorbar:e("../heatmap/colorbar"),style:e("../heatmap/style"),hoverPoints:e("./hover"),eventData:e("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram"],meta:{}}},{"../../plots/cartesian":778,"../heatmap/calc":1002,"../heatmap/colorbar":1004,"../heatmap/plot":1012,"../heatmap/style":1013,"../histogram/cross_trace_defaults":1026,"../histogram/event_data":1028,"./attributes":1032,"./defaults":1034,"./hover":1035}],1037:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib");t.exports=function(e,t,o,i){var n=o("x"),l=o("y"),s=r.minRowLength(n),d=r.minRowLength(l);if(!s||!d)return void(t.visible=!1);t._length=ea(s,d);var c=a.getComponentMethod("calendars","handleTraceDefaults");c(e,t,["x","y"],i);var p=o("z")||o("marker.color");p&&o("histfunc"),o("histnorm"),o("autobinx"),o("autobiny")}},{"../../lib":719,"../../registry":847}],1038:[function(e,t){"use strict";var a=e("../histogram2d/attributes"),r=e("../contour/attributes"),o=e("../../components/colorscale/attributes"),i=e("../../lib/extend").extendFlat;t.exports=i({x:a.x,y:a.y,z:a.z,marker:a.marker,histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:a.xbins,nbinsy:a.nbinsy,ybins:a.ybins,autobinx:a.autobinx,autobiny:a.autobiny,bingroup:a.bingroup,xbingroup:a.xbingroup,ybingroup:a.ybingroup,autocontour:r.autocontour,ncontours:r.ncontours,contours:r.contours,line:r.line,zhoverformat:a.zhoverformat,hovertemplate:a.hovertemplate},o("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":600,"../../lib/extend":710,"../contour/attributes":942,"../histogram2d/attributes":1032}],1039:[function(e,t){"use strict";var a=e("../../lib"),r=e("../histogram2d/sample_defaults"),o=e("../contour/contours_defaults"),i=e("../contour/style_defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(r,o){return a.coerce(e,t,n,r,o)}r(e,t,d,s);!1===t.visible||(o(e,t,d,function(r){return a.coerce2(e,t,n,r)}),i(e,t,d,s),d("hovertemplate"))}},{"../../lib":719,"../contour/contours_defaults":949,"../contour/style_defaults":963,"../histogram2d/sample_defaults":1037,"./attributes":1038}],1040:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../histogram/cross_trace_defaults"),calc:e("../contour/calc"),plot:e("../contour/plot").plot,layerName:"contourlayer",style:e("../contour/style"),colorbar:e("../contour/colorbar"),hoverPoints:e("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":778,"../contour/calc":943,"../contour/colorbar":945,"../contour/hover":955,"../contour/plot":960,"../contour/style":962,"../histogram/cross_trace_defaults":1026,"./attributes":1038,"./defaults":1039}],1041:[function(e,t){"use strict";var a=e("../../lib/extend").extendFlat,r=e("../../lib/extend").extendDeep,o=e("../../plot_api/edit_types").overrideAll,i=e("../../plots/font_attributes"),n=e("../../components/color/attributes"),l=e("../../plots/domain").attributes,s=e("../../plots/cartesian/layout_attributes"),d=e("../../plot_api/plot_template").templatedArray,c=e("../../constants/delta.js"),p=e("../../constants/docs").FORMAT_LINK,u=i({editType:"plot",colorEditType:"plot"}),g={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:n.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},h={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},m=d("step",r({},g,{range:h}));t.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:l({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:a({},u,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot"},font:a({},u,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot"},increasing:{symbol:{valType:"string",dflt:c.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:c.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:c.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:c.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:a({},u,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:r({},g,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:o({range:h,visible:a({},s.visible,{dflt:!0}),tickmode:s.tickmode,nticks:s.nticks,tick0:s.tick0,dtick:s.dtick,tickvals:s.tickvals,ticktext:s.ticktext,ticks:a({},s.ticks,{dflt:"outside"}),ticklen:s.ticklen,tickwidth:s.tickwidth,tickcolor:s.tickcolor,showticklabels:s.showticklabels,tickfont:i({}),tickangle:s.tickangle,tickformat:s.tickformat,tickformatstops:s.tickformatstops,tickprefix:s.tickprefix,showtickprefix:s.showtickprefix,ticksuffix:s.ticksuffix,showticksuffix:s.showticksuffix,separatethousands:s.separatethousands,exponentformat:s.exponentformat,showexponent:s.showexponent,editType:"plot"},"plot"),steps:m,threshold:{line:{color:a({},g.line.color,{}),width:a({},g.line.width,{dflt:1}),editType:"plot"},thickness:a({},g.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":592,"../../constants/delta.js":689,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/cartesian/layout_attributes":779,"../../plots/domain":792,"../../plots/font_attributes":793}],1042:[function(e,t,a){"use strict";var r=e("../../registry"),o=e("../../plots/get_data").getModuleCalcData,i=a.name="indicator";a.plot=function(e,t,a,n){var l=r.getModule(i),s=o(e.calcdata,l)[0];l.plot(e,s,a,n)},a.clean=function(e,t,a,r){var o=r._has&&r._has(i),n=t._has&&t._has(i);o&&!n&&r._indicatorlayer.selectAll("g.trace").remove()}},{"../../plots/get_data":802,"../../registry":847}],1043:[function(e,t){"use strict";t.exports={calc:function(e,t){var a=[],r=t.value;"number"==typeof t._lastValue||(t._lastValue=t.value);var o=t._lastValue,i=o;return t._hasDelta&&"number"==typeof t.delta.reference&&(i=t.delta.reference),a[0]={y:r,lastY:o,delta:r-i,relativeDelta:(r-i)/i},a}}},{}],1044:[function(e,t){"use strict";t.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1045:[function(e,t){"use strict";function a(e,t){function a(a,i){return r.coerce(e,t,o.gauge.steps,a,i)}a("color"),a("line.color"),a("line.width"),a("range"),a("thickness")}var r=e("../../lib"),o=e("./attributes"),i=e("../../plots/domain").defaults,n=e("../../plot_api/plot_template"),l=e("../../plots/array_container_defaults"),s=e("./constants.js"),d=e("../../plots/cartesian/tick_value_defaults"),c=e("../../plots/cartesian/tick_mark_defaults"),p=e("../../plots/cartesian/tick_label_defaults");t.exports={supplyDefaults:function(e,t,u,g){function h(a,i){return r.coerce(e,t,o,a,i)}function m(e,t){return r.coerce(v,k,o.gauge,e,t)}function y(e,t){return r.coerce(w,T,o.gauge.axis,e,t)}i(t,g,h),h("mode"),t._hasNumber=-1!==t.mode.indexOf("number"),t._hasDelta=-1!==t.mode.indexOf("delta"),t._hasGauge=-1!==t.mode.indexOf("gauge");var f=h("value");t._range=[0,"number"==typeof f?1.5*f:1];var x=[,,],_;t._hasNumber&&(h("number.valueformat"),h("number.font.color",g.font.color),h("number.font.family",g.font.family),h("number.font.size"),t.number.font.size===void 0&&(t.number.font.size=s.defaultNumberFontSize,x[0]=!0),h("number.prefix"),h("number.suffix"),_=t.number.font.size);var b;t._hasDelta&&(h("delta.font.color",g.font.color),h("delta.font.family",g.font.family),h("delta.font.size"),t.delta.font.size===void 0&&(t.delta.font.size=(t._hasNumber?.5:1)*(_||s.defaultNumberFontSize),x[1]=!0),h("delta.reference",t.value),h("delta.relative"),h("delta.valueformat",t.delta.relative?"2%":""),h("delta.increasing.symbol"),h("delta.increasing.color"),h("delta.decreasing.symbol"),h("delta.decreasing.color"),h("delta.position"),b=t.delta.font.size),t._scaleNumbers=(!t._hasNumber||x[0])&&(!t._hasDelta||x[1])||!1,h("title.font.color",g.font.color),h("title.font.family",g.font.family),h("title.font.size",.25*(_||b||s.defaultNumberFontSize)),h("title.text");var v,k,w,T;if(t._hasGauge){v=e.gauge,v||(v={}),k=n.newContainer(t,"gauge"),m("shape");var A=t._isBullet="bullet"===t.gauge.shape;A||h("title.align","center");var S=t._isAngular="angular"===t.gauge.shape;S||h("align","center"),m("bgcolor",g.paper_bgcolor),m("borderwidth"),m("bordercolor"),m("bar.color"),m("bar.line.color"),m("bar.line.width");var C=s.valueThickness*("bullet"===t.gauge.shape?.5:1);m("bar.thickness",C),l(v,k,{name:"steps",handleItemDefaults:a}),m("threshold.value"),m("threshold.thickness"),m("threshold.line.width"),m("threshold.line.color"),w={},v&&(w=v.axis||{}),T=n.newContainer(k,"axis"),y("visible"),t._range=y("range",t._range);var L={outerTicks:!0};d(w,T,y,"linear"),p(w,T,y,"linear",L),c(w,T,y,L)}else h("title.align","center"),h("align","center"),t._isAngular=t._isBullet=!1;t._length=null}}},{"../../lib":719,"../../plot_api/plot_template":757,"../../plots/array_container_defaults":763,"../../plots/cartesian/tick_label_defaults":786,"../../plots/cartesian/tick_mark_defaults":787,"../../plots/cartesian/tick_value_defaults":788,"../../plots/domain":792,"./attributes":1041,"./constants.js":1044}],1046:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"indicator",basePlotModule:e("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc").calc,plot:e("./plot"),meta:{}}},{"./attributes":1041,"./base_plot":1042,"./calc":1043,"./defaults":1045,"./plot":1047}],1047:[function(e,t){"use strict";function a(e){return e&&0<e.duration}function r(e,t,r,o){function i(e){e.attr("width",function(e){return va(0,f.c2p(e.range[1])-f.c2p(e.range[0]))}).attr("x",function(e){return f.c2p(e.range[0])}).attr("y",function(e){return .5*(1-e.thickness)*T}).attr("height",function(e){return e.thickness*T})}var l=r[0].trace,d=o.gauge,c=o.layer,p=o.gaugeBg,u=o.gaugeOutline,g=o.size,h=l.domain,m=o.transitionOpts,y=o.onComplete,f,x,b,v,w;d.enter().append("g").classed("bullet",!0),d.attr("transform","translate("+g.l+", "+g.t+")"),c.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),c.selectAll("g.xbulletaxistick,path,text").remove();var T=g.h,A=l.gauge.bar.thickness*T,C=h.x[0],L=h.x[0]+(h.x[1]-h.x[0])*(l._hasNumber||l._hasDelta?1-_.bulletNumberDomainSize:1);f=s(e,l.gauge.axis),f._id="xbulletaxis",f.domain=[C,L],f.setScale(),x=k.calcTicks(f),b=k.makeTransFn(f),v=k.getTickSigns(f)[2],w=g.t+g.h,f.visible&&(k.drawTicks(e,f,{vals:"inside"===f.ticks?k.clipEnds(f,x):x,layer:c,path:k.makeTickPath(f,w,v),transFn:b}),k.drawLabels(e,f,{vals:x,layer:c,transFn:b,labelFns:k.makeLabelFns(f,w)}));var E=[p].concat(l.gauge.steps),I=d.selectAll("g.bg-bullet").data(E);I.enter().append("g").classed("bg-bullet",!0).append("rect"),I.select("rect").call(i).call(n),I.exit().remove();var z=d.selectAll("g.value-bullet").data([l.gauge.bar]);z.enter().append("g").classed("value-bullet",!0).append("rect"),z.select("rect").attr("height",A).attr("y",(T-A)/2).call(n),a(m)?z.select("rect").transition().duration(m.duration).ease(m.easing).each("end",function(){y&&y()}).each("interrupt",function(){y&&y()}).attr("width",va(0,f.c2p(ea(l.gauge.axis.range[1],r[0].y)))):z.select("rect").attr("width","number"==typeof r[0].y?va(0,f.c2p(ea(l.gauge.axis.range[1],r[0].y))):0),z.exit().remove();var P=r.filter(function(){return l.gauge.threshold.value}),D=d.selectAll("g.threshold-bullet").data(P);D.enter().append("g").classed("threshold-bullet",!0).append("line"),D.select("line").attr("x1",f.c2p(l.gauge.threshold.value)).attr("x2",f.c2p(l.gauge.threshold.value)).attr("y1",(1-l.gauge.threshold.thickness)/2*T).attr("y2",(1-(1-l.gauge.threshold.thickness)/2)*T).call(S.stroke,l.gauge.threshold.line.color).style("stroke-width",l.gauge.threshold.line.width),D.exit().remove();var O=d.selectAll("g.gauge-outline").data([u]);O.enter().append("g").classed("gauge-outline",!0).append("rect"),O.select("rect").call(i).call(n),O.exit().remove()}function o(e,t,r,o){function i(e){var t=u.gauge.axis.range[0],a=u.gauge.axis.range[1],r=(e-t)/(a-t)*Pe-L;return r<-L?-L:r>L?L:r}function c(e){return h.svg.arc().innerRadius((x+m)/2-e/2*(m-x)).outerRadius((x+m)/2+e/2*(m-x)).startAngle(-L)}function p(e){e.attr("d",function(e){return c(e.thickness).startAngle(i(e.range[0])).endAngle(i(e.range[1]))()})}var u=r[0].trace,g=o.size,m=o.radius,x=o.innerRadius,_=o.gaugeBg,b=o.gaugeOutline,w=[g.l+g.w/2,g.t+g.h/2+m/2],T=o.gauge,A=o.layer,S=o.transitionOpts,C=o.onComplete,L=Pe/2,E,I,z,P;T.enter().append("g").classed("angular",!0),T.attr("transform",d(w[0],w[1])),A.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),A.selectAll("g.xangularaxistick,path,text").remove(),E=s(e,u.gauge.axis),E.type="linear",E.range=u.gauge.axis.range,E._id="xangularaxis",E.setScale();var D=function(e){return(E.range[0]-e.x)/(E.range[1]-E.range[0])*Pe+Pe},O={},M=k.makeLabelFns(E,0),j=M.labelStandoff;O.xFn=function(e){var t=D(e);return R(t)*j},O.yFn=function(e){var t=D(e),a=0<De(t)?.2:1;return-De(t)*(j+e.fontSize*a)+_a(R(t))*(e.fontSize*f)},O.anchorFn=function(e){var t=D(e),a=R(t);return .1>_a(a)?"middle":0<a?"start":"end"},O.heightFn=function(e,t,a){var r=D(e);return-.5*(1+De(r))*a};var F=function(e){return d(w[0]+m*R(e),w[1]-m*De(e))};z=function(e){return F(D(e))};var B=function(e){var t=D(e);return F(t)+"rotate("+-y(t)+")"};if(I=k.calcTicks(E),P=k.getTickSigns(E)[2],E.visible){P="inside"===E.ticks?-1:1;var N=(E.linewidth||1)/2;k.drawTicks(e,E,{vals:I,layer:A,path:"M"+P*N+",0h"+P*E.ticklen,transFn:B}),k.drawLabels(e,E,{vals:I,layer:A,transFn:z,labelFns:O})}var V=[_].concat(u.gauge.steps),U=T.selectAll("g.bg-arc").data(V);U.enter().append("g").classed("bg-arc",!0).append("path"),U.select("path").call(p).call(n),U.exit().remove();var H=c(u.gauge.bar.thickness),G=T.selectAll("g.value-arc").data([u.gauge.bar]);G.enter().append("g").classed("value-arc",!0).append("path");var q=G.select("path");a(S)?(q.transition().duration(S.duration).ease(S.easing).each("end",function(){C&&C()}).each("interrupt",function(){C&&C()}).attrTween("d",l(H,i(r[0].lastY),i(r[0].y))),u._lastValue=r[0].y):q.attr("d","number"==typeof r[0].y?H.endAngle(i(r[0].y)):"M0,0Z"),q.call(n),G.exit().remove(),V=[];var Y=u.gauge.threshold.value;Y&&V.push({range:[Y,Y],color:u.gauge.threshold.color,line:{color:u.gauge.threshold.line.color,width:u.gauge.threshold.line.width},thickness:u.gauge.threshold.thickness});var v=T.selectAll("g.threshold-arc").data(V);v.enter().append("g").classed("threshold-arc",!0).append("path"),v.select("path").call(p).call(n),v.exit().remove();var W=T.selectAll("g.gauge-outline").data([b]);W.enter().append("g").classed("gauge-outline",!0).append("path"),W.select("path").call(p).call(n),W.exit().remove()}function i(e,t,r,o){function i(t,a,r,o){if(t.match("s")&&0<=r!=0<=o&&!a(r).slice(-1).match(E)&&!a(o).slice(-1).match(E)){var i=t.slice().replace("s","f").replace(/\d+/,function(e){return parseInt(e)-1}),n=s(e,{tickformat:i});return function(e){return 1>_a(e)?k.tickText(n,e).text:a(e)}}return a}function n(){function t(){g.text(c(d(r[0]),n)).call(S.fill,p(r[0])).call(b.convertToTspans,e)}var o=s(e,{tickformat:l.delta.valueformat},l._range);o.setScale(),k.prepTicks(o);var n=function(e){return k.tickText(o,e).text},d=function(e){var t=l.delta.relative?e.relativeDelta:e.delta;return t},c=function(e,t){return 0===e||"number"!=typeof e||isNaN(e)?"-":(0<e?l.delta.increasing.symbol:l.delta.decreasing.symbol)+t(e)},p=function(e){return 0<=e.delta?l.delta.increasing.color:l.delta.decreasing.color};void 0===l._deltaLastValue&&(l._deltaLastValue=d(r[0]));var g=w.select("text.delta");return g.call(x.font,l.delta.font).call(S.fill,p({delta:l._deltaLastValue})),a(_)?g.transition().duration(_.duration).ease(_.easing).tween("text",function(){var e=h.select(this),t=d(r[0]),a=l._deltaLastValue,o=i(l.delta.valueformat,n,a,t),s=h.interpolateNumber(a,t);return l._deltaLastValue=t,function(a){e.text(c(s(a),o)),e.call(S.fill,p({delta:s(a)}))}}).each("end",function(){t(),v&&v()}).each("interrupt",function(){t(),v&&v()}):t(),I=u(c(d(r[0]),n),l.delta.font,f,e),g}var l=r[0].trace,c=o.numbersX,p=o.numbersY,y=l.align||"center",f=C[y],_=o.transitionOpts,v=o.onComplete,w=m.ensureSingle(t,"g","numbers"),T=[],A,I,z;l._hasNumber&&T.push("number"),l._hasDelta&&(T.push("delta"),"left"===l.delta.position&&T.reverse());var P=w.selectAll("text").data(T);P.enter().append("text"),P.attr("text-anchor",function(){return f}).attr("class",function(e){return e}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),P.exit().remove();var D=l.mode+l.align,O;if(l._hasDelta&&(O=n(),D+=l.delta.position+l.delta.font.size+l.delta.font.family+l.delta.valueformat,D+=l.delta.increasing.symbol+l.delta.decreasing.symbol,z=I),l._hasNumber&&(function(){function t(){var t="number"==typeof r[0].y?c+n(r[0].y)+d:"-";p.text(t).call(x.font,l.number.font).call(b.convertToTspans,e)}var o=s(e,{tickformat:l.number.valueformat},l._range);o.setScale(),k.prepTicks(o);var n=function(e){return k.tickText(o,e).text},d=l.number.suffix,c=l.number.prefix,p=w.select("text.number");return a(_)?p.transition().duration(_.duration).ease(_.easing).each("end",function(){t(),v&&v()}).each("interrupt",function(){t(),v&&v()}).attrTween("text",function(){var e=h.select(this),a=h.interpolateNumber(r[0].lastY,r[0].y);l._lastValue=r[0].y;var o=i(l.number.valueformat,n,r[0].lastY,r[0].y);return function(r){e.text(c+o(a(r))+d)}}):t(),A=u(c+n(r[0].y)+d,l.number.font,f,e),p}(),D+=l.number.font.size+l.number.font.family+l.number.valueformat+l.number.suffix+l.number.prefix,z=A),l._hasDelta&&l._hasNumber){var R=[(A.left+A.right)/2,(A.top+A.bottom)/2],M=[(I.left+I.right)/2,(I.top+I.bottom)/2],j=.75*l.delta.font.size,F,B;"left"===l.delta.position&&(F=g(l,"deltaPos",0,-1*(A.width*L[l.align]+I.width*(1-L[l.align])+j),D,Math.min),B=R[1]-M[1],z={width:A.width+I.width+j,height:va(A.height,I.height),left:I.left+F,right:A.right,top:ea(A.top,I.top+B),bottom:va(A.bottom,I.bottom+B)}),"right"===l.delta.position&&(F=g(l,"deltaPos",0,A.width*(1-L[l.align])+I.width*L[l.align]+j,D,Math.max),B=R[1]-M[1],z={width:A.width+I.width+j,height:va(A.height,I.height),left:A.left,right:I.right+F,top:ea(A.top,I.top+B),bottom:va(A.bottom,I.bottom+B)}),"bottom"===l.delta.position&&(F=null,B=I.height,z={width:va(A.width,I.width),height:A.height+I.height,left:ea(A.left,I.left),right:va(A.right,I.right),top:A.bottom-A.height,bottom:A.bottom+I.height}),"top"===l.delta.position&&(F=null,B=A.top,z={width:va(A.width,I.width),height:A.height+I.height,left:ea(A.left,I.left),right:va(A.right,I.right),top:A.bottom-A.height-I.height,bottom:A.bottom}),O.attr({dx:F,dy:B})}(l._hasNumber||l._hasDelta)&&w.attr("transform",function(){var e=o.numbersScaler(z);D+=e[2];var t=g(l,"numbersScale",1,e[0],D,Math.min),a;l._scaleNumbers||(t=1),a=l._isAngular?p-t*z.bottom:p-t*(z.top+z.bottom)/2,l._numbersTop=t*z.top+a;var r=z[y];"center"===y&&(r=(z.left+z.right)/2);var i=c-t*r;return i=g(l,"numbersTranslate",0,i,D,Math.max),d(i,a)+" scale("+t+")"})}function n(e){e.each(function(e){S.stroke(h.select(this),e.line.color)}).each(function(e){S.fill(h.select(this),e.color)}).style("stroke-width",function(e){return e.line.width})}function l(e,t,a){return function(){var r=h.interpolate(t,a);return function(a){return e.endAngle(r(a))()}}}function s(e,t,a){function r(e,t){return m.coerce(i,n,A,e,t)}var o=e._fullLayout,i=m.extendFlat({type:"linear",ticks:"outside",range:a,showline:!0},t),n={type:"linear",_id:"x"+t._id},l={letter:"x",font:o.font,noHover:!0,noTickson:!0};return w(i,n,r,l,o),T(i,n,r,l),n}function d(e,t){return"translate("+e+","+t+")"}function c(e,t,a){var r=ea(t/e.width,a/e.height);return[r,e,t+"x"+a]}function p(e,t){var a=N(e.width/2*(e.width/2)+e.height*e.height);return[t/a,e,t]}function u(e,t,a,r){var o=document.createElementNS("http://www.w3.org/2000/svg","text"),i=h.select(o);return i.text(e).attr("x",0).attr("y",0).attr("text-anchor",a).attr("data-unformatted",e).call(b.convertToTspans,r).call(x.font,t),x.bBox(i.node())}function g(e,t,a,r,o,i){var n="_cache"+t;e[n]&&e[n].key===o||(e[n]={key:o,value:a});var l=m.aggNums(i,null,[e[n].value,r],2);return e[n].value=l,l}var h=e("d3"),m=e("../../lib"),y=m.rad2deg,f=e("../../constants/alignment").MID_SHIFT,x=e("../../components/drawing"),_=e("./constants"),b=e("../../lib/svg_text_utils"),k=e("../../plots/cartesian/axes"),w=e("../../plots/cartesian/axis_defaults"),T=e("../../plots/cartesian/position_defaults"),A=e("../../plots/cartesian/layout_attributes"),S=e("../../components/color"),C={left:"start",center:"middle",right:"end"},L={left:0,center:.5,right:1},E=/[yzafpnµmkMGTPEZY]/;t.exports=function(e,t,n,l){var s=e._fullLayout,u;a(n)&&l&&(u=l()),m.makeTraceGroups(s._indicatorlayer,t,"trace").each(function(t){var a=t[0],l=a.trace,g=h.select(this),m=l._hasGauge,y=l._isAngular,f=l._isBullet,v=l.domain,k={w:s._size.w*(v.x[1]-v.x[0]),h:s._size.h*(v.y[1]-v.y[0]),l:s._size.l+s._size.w*v.x[0],r:s._size.r+s._size.w*(1-v.x[1]),t:s._size.t+s._size.h*(1-v.y[1]),b:s._size.b+s._size.h*v.y[0]},w=k.l+k.w/2,T=k.t+k.h/2,A=ea(k.w/2,k.h),S=_.innerRadius*A,E=l.align||"center",I,z,P;if(z=T,!m)I=k.l+L[E]*k.w,P=function(e){return c(e,k.w,k.h)};else if(y&&(I=w,z=T+A/2,P=function(e){return p(e,.9*S)}),f){var D=_.bulletPadding,O=1-_.bulletNumberDomainSize+D;I=k.l+(O+(1-O)*L[E])*k.w,P=function(e){return c(e,(_.bulletNumberDomainSize-D)*k.w,k.h)}}i(e,g,t,{numbersX:I,numbersY:z,numbersScaler:P,transitionOpts:n,onComplete:u});var R,M;m&&(R={range:l.gauge.axis.range,color:l.gauge.bgcolor,line:{color:l.gauge.bordercolor,width:0},thickness:1},M={range:l.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:l.gauge.bordercolor,width:l.gauge.borderwidth},thickness:1});var j=g.selectAll("g.angular").data(y?t:[]);j.exit().remove();var F=g.selectAll("g.angularaxis").data(y?t:[]);F.exit().remove(),y&&o(e,g,t,{radius:A,innerRadius:S,gauge:j,layer:F,size:k,gaugeBg:R,gaugeOutline:M,transitionOpts:n,onComplete:u});var B=g.selectAll("g.bullet").data(f?t:[]);B.exit().remove();var N=g.selectAll("g.bulletaxis").data(f?t:[]);N.exit().remove(),f&&r(e,g,t,{gauge:B,layer:N,size:k,gaugeBg:R,gaugeOutline:M,transitionOpts:n,onComplete:u});var V=g.selectAll("text.title").data(t);V.exit().remove(),V.enter().append("text").classed("title",!0),V.attr("text-anchor",function(){return f?C.right:C[l.title.align]}).text(l.title.text).call(x.font,l.title.font).call(b.convertToTspans,e),V.attr("transform",function(){var e=k.l+k.w*L[l.title.align],t=_.titlePadding,a=x.bBox(V.node()),r;if(m){if(y)if(l.gauge.axis.visible){var o=x.bBox(F.node());r=o.top-t-a.bottom}else r=k.t+k.h/2-A/2-a.bottom-t;f&&(r=z-(a.top+a.bottom)/2,e=k.l-_.bulletPadding*k.w)}else r=l._numbersTop-t-a.bottom;return d(e,r)})})}},{"../../components/color":593,"../../components/drawing":614,"../../constants/alignment":688,"../../lib":719,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_defaults":769,"../../plots/cartesian/layout_attributes":779,"../../plots/cartesian/position_defaults":782,"./constants":1044,d3:163}],1048:[function(e,t){"use strict";function a(){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function r(){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var o=e("../../components/colorscale/attributes"),i=e("../../components/fx/hovertemplate_attributes"),n=e("../mesh3d/attributes"),l=e("../../plots/attributes"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=t.exports=d(s({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:a("x"),y:a("y"),z:a("z")},caps:{x:r("x"),y:r("y"),z:r("z")},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:i()},o("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:n.opacity,lightposition:n.lightposition,lighting:n.lighting,flatshading:n.flatshading,contour:n.contour,hoverinfo:s({},l.hoverinfo)}),"calc","nested");c.flatshading.dflt=!0,c.lighting.facenormalsepsilon.dflt=0,c.x.editType=c.y.editType=c.z.editType=c.value.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../mesh3d/attributes":1053}],1049:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){t._len=ea(t.x.length,t.y.length,t.z.length,t.value.length);for(var r=1/0,o=-Infinity,n=t.value.length,l=0,s;l<n;l++)s=t.value[l],r=ea(r,s),o=va(o,s);t._minValues=r,t._maxValues=o,t._vMin=t.isomin===void 0||null===t.isomin?r:t.isomin,t._vMax=t.isomax===void 0||null===t.isomin?o:t.isomax,a(e,t,{vals:[t._vMin,t._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":601}],1050:[function(e,t){"use strict";function a(e){return n.distinctVals(e).vals}function r(e,t,a){this.scene=e,this.uid=a,this.mesh=t,this.name="",this.data=null,this.showContour=!1}function o(t){function r(e,t,a){return a+te*t+te*ee*e}function o(e,t,a){for(var r=pe.length,o=le;o<r;o++)if(e===se[o]&&t===de[o]&&a===ce[o])return o;return-1}function n(){le=ne}function l(){se=[],de=[],ce=[],pe=[],ne=0,n()}function s(e,t,a,r){return se.push(e),de.push(t),ce.push(a),pe.push(r),ne++,ne-1}function d(e,a,r){return t._i.push(e),t._j.push(a),t._k.push(r),Q++,Q-1}function u(e,t,a){for(var r=[],o=0;o<e.length;o++)r[o]=(e[o]+t[o]+a[o])/3;return r}function g(e,t,a){for(var r=[],o=0;o<e.length;o++)r[o]=e[o]*(1-a)+a*t[o];return r}function h(e){ue=e}function m(e,t){var o=e[0],i=e[1],n=e[2],l=u(o,i,n),s=N(1-ue),r=g(l,o,s),d=g(l,i,s),p=g(l,n,s),h=t[0],a=t[1],m=t[2];return{xyzv:[[o,i,d],[d,r,o],[i,n,p],[p,d,i],[n,o,r],[r,p,n]],abc:[[h,a,-1],[-1,-1,h],[a,m,-1],[-1,-1,a],[m,h,-1],[-1,-1,m]]}}function y(e,t){return"all"===e||null===e||-1<e.indexOf(t)}function f(e,t){return null===e?t:e}function x(e,t,a){n();var r=[t],l=[a];if(1<=ue)r=[t],l=[a];else if(0<ue){var c=m(t,a);r=c.xyzv,l=c.abc}for(var p=0;p<r.length;p++){t=r[p],a=l[p];for(var u=[],g=0;3>g;g++){var h=t[g][0],x=t[g][1],y=t[g][2],_=t[g][3],b=-1<a[g]?a[g]:o(h,x,y);u[g]=-1<b?b:s(h,x,y,f(e,_))}d(u[0],u[1],u[2])}}function _(e,t,a){var r=function(r,o,i){x(e,[t[r],t[o],t[i]],[a[r],a[o],a[i]])};r(0,1,2),r(2,3,0)}function b(e,t,a){var r=function(r,o,i){x(e,[t[r],t[o],t[i]],[a[r],a[o],a[i]])};r(0,1,2),r(3,0,1),r(2,3,0),r(1,2,3)}function v(e,t,a,r){var o=e[3];o<a&&(o=a),o>r&&(o=r);for(var i=(e[3]-o)/(e[3]-t[3]+1e-9),n=[],l=0;4>l;l++)n[l]=(1-i)*e[l]+i*t[l];return n}function k(e,t,a){return e>=t&&e<=a}function w(e){var t=.001*(ie-oe);return e>=oe-t&&e<=ie+t}function T(e){for(var a=[],r=0,o;4>r;r++)o=e[r],a.push([t.x[o],t.y[o],t.z[o],t.value[o]]);return a}function S(t,a,r,o,i,n){n||(n=1),r=[-1,-1,-1];var l=!1,s=[k(a[0][3],o,i),k(a[1][3],o,i),k(a[2][3],o,i)];if(!s[0]&&!s[1]&&!s[2])return!1;var d=function(e,t,a){return w(t[0][3])&&w(t[1][3])&&w(t[2][3])?(x(e,t,a),!0):!!(3>n)&&S(e,t,a,oe,ie,++n)};if(s[0]&&s[1]&&s[2])return d(t,a,r)||l;var c=!1;return([[0,1,2],[2,0,1],[1,2,0]].forEach(function(n){if(s[n[0]]&&s[n[1]]&&!s[n[2]]){var e=a[n[0]],p=a[n[1]],u=a[n[2]],g=v(u,e,o,i),h=v(u,p,o,i);l=d(t,[h,g,e],[-1,-1,r[n[0]]])||l,l=d(t,[e,p,h],[r[n[0]],r[n[1]],-1])||l,c=!0}}),c)?l:([[0,1,2],[1,2,0],[2,0,1]].forEach(function(n){if(s[n[0]]&&!s[n[1]]&&!s[n[2]]){var e=a[n[0]],p=a[n[1]],u=a[n[2]],g=v(p,e,o,i),h=v(u,e,o,i);l=d(t,[h,g,e],[-1,-1,r[n[0]]])||l,c=!0}}),l)}function C(t,a,r,o){var i=!1,n=T(a),l=[k(n[0][3],r,o),k(n[1][3],r,o),k(n[2][3],r,o),k(n[3][3],r,o)];if(!l[0]&&!l[1]&&!l[2]&&!l[3])return i;if(l[0]&&l[1]&&l[2]&&l[3])return J&&(i=b(t,n,a)||i),i;var s=!1;return([[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(d){if(l[d[0]]&&l[d[1]]&&l[d[2]]&&!l[d[3]]){var e=n[d[0]],c=n[d[1]],p=n[d[2]],u=n[d[3]];if(J)i=x(t,[e,c,p],[a[d[0]],a[d[1]],a[d[2]]])||i;else{var g=v(u,e,r,o),h=v(u,c,r,o),m=v(u,p,r,o);i=x(null,[g,h,m],[-1,-1,-1])||i}s=!0}}),s)?i:([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(d){if(l[d[0]]&&l[d[1]]&&!l[d[2]]&&!l[d[3]]){var e=n[d[0]],c=n[d[1]],p=n[d[2]],u=n[d[3]],g=v(p,e,r,o),h=v(p,c,r,o),m=v(u,c,r,o),y=v(u,e,r,o);J?(i=x(t,[e,y,g],[a[d[0]],-1,-1])||i,i=x(t,[c,h,m],[a[d[1]],-1,-1])||i):i=_(null,[g,h,m,y],[-1,-1,-1,-1])||i,s=!0}}),s)?i:([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(d){if(l[d[0]]&&!l[d[1]]&&!l[d[2]]&&!l[d[3]]){var e=n[d[0]],c=n[d[1]],p=n[d[2]],u=n[d[3]],g=v(c,e,r,o),h=v(p,e,r,o),m=v(u,e,r,o);J?(i=x(t,[e,g,h],[a[d[0]],-1,-1])||i,i=x(t,[e,h,m],[a[d[0]],-1,-1])||i,i=x(t,[e,m,g],[a[d[0]],-1,-1])||i):i=x(null,[g,h,m],[-1,-1,-1])||i,s=!0}}),i)}function L(e,t,a,r,o,i,n,l,s,d,c){var p=!1;return K&&(y(e,"A")&&(p=C(null,[t,a,r,i],d,c)||p),y(e,"B")&&(p=C(null,[a,r,o,s],d,c)||p),y(e,"C")&&(p=C(null,[a,i,n,s],d,c)||p),y(e,"D")&&(p=C(null,[r,i,l,s],d,c)||p),y(e,"E")&&(p=C(null,[a,r,i,s],d,c)||p)),J&&(p=C(e,[a,r,i,s],d,c)||p),p}function E(e,t,a,r,o,i,n,l){return[!0===l[0]||S(e,T([t,a,r]),[t,a,r],i,n),!0===l[1]||S(e,T([r,o,t]),[r,o,t],i,n)]}function I(e,t,a,r,o,i,n,l,s){return l?E(e,t,a,o,r,i,n,s):E(e,a,o,r,t,i,n,s)}function z(e,t,a,o,i,n,l){var s=!1,d=function(){s=S(e,[h,m,y],[-1,-1,-1],i,n)||s,s=S(e,[y,f,h],[-1,-1,-1],i,n)||s},c=l[0],p=l[1],u=l[2],h,m,y,f;return c&&(h=g(T([r(t,a-0,o-0)])[0],T([r(t-1,a-0,o-0)])[0],c),m=g(T([r(t,a-0,o-1)])[0],T([r(t-1,a-0,o-1)])[0],c),y=g(T([r(t,a-1,o-1)])[0],T([r(t-1,a-1,o-1)])[0],c),f=g(T([r(t,a-1,o-0)])[0],T([r(t-1,a-1,o-0)])[0],c),d()),p&&(h=g(T([r(t-0,a,o-0)])[0],T([r(t-0,a-1,o-0)])[0],p),m=g(T([r(t-0,a,o-1)])[0],T([r(t-0,a-1,o-1)])[0],p),y=g(T([r(t-1,a,o-1)])[0],T([r(t-1,a-1,o-1)])[0],p),f=g(T([r(t-1,a,o-0)])[0],T([r(t-1,a-1,o-0)])[0],p),d()),u&&(h=g(T([r(t-0,a-0,o)])[0],T([r(t-0,a-0,o-1)])[0],u),m=g(T([r(t-0,a-1,o)])[0],T([r(t-0,a-1,o-1)])[0],u),y=g(T([r(t-1,a-1,o)])[0],T([r(t-1,a-1,o-1)])[0],u),f=g(T([r(t-1,a-0,o)])[0],T([r(t-1,a-0,o-1)])[0],u),d()),s}function P(e,t,a,r,o,i,n,l,s,d,c,p){var u=e;return p?(K&&"even"===e&&(u=null),L(u,t,a,r,o,i,n,l,s,d,c)):(K&&"odd"===e&&(u=null),L(u,s,l,n,i,o,r,a,t,d,c))}function D(e,t,a,o,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<te;u++)for(var g=1;g<ee;g++)s.push(I(e,r(p,g-1,u-1),r(p,g-1,u),r(p,g,u-1),r(p,g,u),a,o,(p+g+u)%2,l&&l[d]?l[d]:[])),d++}return s}function O(e,t,a,o,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<A;u++)for(var g=1;g<te;g++)s.push(I(e,r(u-1,p,g-1),r(u,p,g-1),r(u-1,p,g),r(u,p,g),a,o,(u+p+g)%2,l&&l[d]?l[d]:[])),d++}return s}function R(e,t,a,o,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<ee;u++)for(var g=1;g<A;g++)s.push(I(e,r(g-1,u-1,p),r(g-1,u,p),r(g,u-1,p),r(g,u,p),a,o,(g+u+p)%2,l&&l[d]?l[d]:[])),d++}return s}function M(e,t,a){for(var o=1;o<te;o++)for(var n=1;n<ee;n++)for(var l=1;l<A;l++)P(e,r(l-1,n-1,o-1),r(l-1,n-1,o),r(l-1,n,o-1),r(l-1,n,o),r(l,n-1,o-1),r(l,n-1,o),r(l,n,o-1),r(l,n,o),t,a,(l+n+o)%2)}function j(e,t,a){J=!0,M(e,t,a),J=!1}function F(e,t,a){K=!0,M(e,t,a),K=!1}function B(e,t,a,r,o,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<te;u++)for(var g=1;g<ee;g++)s.push(z(e,p,g,u,a,r,o[c],l&&l[d]?l[d]:[])),d++}return s}function V(e,t,a,r,o,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<A;u++)for(var g=1;g<te;g++)s.push(z(e,u,p,g,a,r,o[c],l&&l[d]?l[d]:[])),d++}return s}function U(e,t,a,r,o,l){for(var s=[],d=0,c=0,p;c<t.length;c++){p=t[c];for(var u=1;u<ee;u++)for(var g=1;g<A;g++)s.push(z(e,g,u,p,a,r,o[c],l&&l[d]?l[d]:[])),d++}return s}function H(e,t){for(var a=[],r=e;r<t;r++)a.push(r);return a}function G(){for(var e=0;e<A;e++)for(var a=0;a<ee;a++)for(var o=0,n;o<te;o++)n=r(e,a,o),s(t.x[n],t.y[n],t.z[n],t.value[n])}function q(){l(),G();var a=null;if(W&&Z&&(h(Z),j(a,oe,ie)),Y&&X){h(X);for(var r=t.surface.pattern,o=t.surface.count,n=0;n<o;n++){var e=1===o?.5:n/(o-1),s=(1-e)*oe+e*ie,d=_a(s-ae),u=_a(s-re),g=d>u?[ae,s]:[s,re];F(r,g[0],g[1])}}var m=[[ea(oe,re),va(oe,re)],[ea(ae,ie),va(ae,ie)]];["x","y","z"].forEach(function(r){for(var e=[],o=0;o<m.length;o++){var n=0,l=m[o][0],d=m[o][1],u=t.slices[r];if(u.show&&u.fill){h(u.fill);var g=[],y=[],f=[];if(u.locations.length)for(var x=0,_;x<u.locations.length;x++)_=p(u.locations[x],"x"===r?$:"y"===r?i:c),0===_.distRatio?g.push(_.id):0<_.id&&(y.push(_.id),"x"===r?f.push([_.distRatio,0,0]):"y"===r?f.push([0,_.distRatio,0]):f.push([0,0,_.distRatio]));else g="x"===r?H(1,A-1):"y"===r?H(1,ee-1):H(1,te-1);0<y.length&&(e[n]="x"===r?B(a,y,l,d,f,e[n]):"y"===r?V(a,y,l,d,f,e[n]):U(a,y,l,d,f,e[n]),n++),0<g.length&&(e[n]="x"===r?D(a,g,l,d,e[n]):"y"===r?O(a,g,l,d,e[n]):R(a,g,l,d,e[n]),n++)}var b=t.caps[r];b.show&&b.fill&&(h(b.fill),e[n]="x"===r?D(a,[0,A-1],l,d,e[n]):"y"===r?O(a,[0,ee-1],l,d,e[n]):R(a,[0,te-1],l,d,e[n]),n++)}}),0==Q&&l(),t._x=se,t._y=de,t._z=ce,t._intensity=pe,t._Xs=$,t._Ys=i,t._Zs=c}t._i=[],t._j=[],t._k=[];var Y=t.surface.show,W=t.spaceframe.show,X=t.surface.fill,Z=t.spaceframe.fill,K=!1,J=!1,Q=0,$=a(t.x.slice(0,t._len)),i=a(t.y.slice(0,t._len)),c=a(t.z.slice(0,t._len)),A=$.length,ee=i.length,te=c.length,ae=t._minValues,re=t._maxValues,oe=t._vMin,ie=t._vMax,ne,le,se,de,ce,pe,ue;return q(),t}var i=e("gl-mesh3d"),n=e("../../lib"),l=e("../../lib/gl_format_color").parseColorScale,s=e("../../lib/str2rgbarray"),d=e("../../components/colorscale").extractOpts,c=e("../../plots/gl3d/zip3"),p=function(e,t){for(var a=t.length-1;0<a;a--){var r=ea(t[a],t[a-1]),o=va(t[a],t[a-1]);if(o>r&&r<e&&e<=o)return{id:a,distRatio:(o-e)/(o-r)}}return{id:0,distRatio:0}},u=r.prototype;u.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index,a=this.data._x[t],r=this.data._y[t],o=this.data._z[t],n=this.data._Ys.length,l=this.data._Zs.length,s=p(a,this.data._Xs).id,i=p(r,this.data._Ys).id,d=p(o,this.data._Zs).id,c=e.index=d+l*i+l*n*s;e.traceCoordinate=[this.data._x[c],this.data._y[c],this.data._z[c],this.data.value[c]];var u=this.data.hovertext||this.data.text;return Array.isArray(u)&&void 0!==u[c]?e.textLabel=u[c]:u&&(e.textLabel=u),!0}},u.update=function(e){function t(e,t,a,r){return t.map(function(t){return e.d2l(t,0,r)*a})}var a=this.scene,r=a.fullSceneLayout;this.data=o(e);var i=c(t(r.xaxis,e._x,a.dataScale[0],e.xcalendar),t(r.yaxis,e._y,a.dataScale[1],e.ycalendar),t(r.zaxis,e._z,a.dataScale[2],e.zcalendar)),n=c(e._i,e._j,e._k),p={positions:i,cells:n,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:s(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading},u=d(e);p.vertexIntensity=e._intensity,p.vertexIntensityBounds=[u.min,u.max],p.colormap=l(e),this.mesh.update(p)},u.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports={findNearestOnAxis:p,generateIsoMeshes:o,createIsosurfaceTrace:function(e,t){var a=e.glplot.gl,o=i({gl:a}),n=new r(e,o,t.uid);return o._trace=n,n.update(t),e.glplot.add(o),n}}},{"../../components/colorscale":605,"../../lib":719,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../../plots/gl3d/zip3":818,"gl-mesh3d":280}],1051:[function(e,t){"use strict";function a(e,t,a,r,i){var l=i("isomin"),s=i("isomax");s!==void 0&&null!==s&&l!==void 0&&null!==l&&l>s&&(t.isomin=null,t.isomax=null);var d=i("x"),c=i("y"),p=i("z"),u=i("value");if(!d||!d.length||!c||!c.length||!p||!p.length||!u||!u.length)return void(t.visible=!1);var g=o.getComponentMethod("calendars","handleTraceDefaults");g(e,t,["x","y","z"],r),["x","y","z"].forEach(function(e){var t="caps."+e,a=i(t+".show");a&&i(t+".fill");var r="slices."+e,o=i(r+".show");o&&(i(r+".fill"),i(r+".locations"))});var h=i("spaceframe.show");h&&i("spaceframe.fill");var m=i("surface.show");m&&(i("surface.count"),i("surface.fill"),i("surface.pattern"));var y=i("contour.show");y&&(i("contour.color"),i("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(e){i(e)}),n(e,t,r,i,{prefix:"",cLetter:"c"}),t._length=null}var r=e("../../lib"),o=e("../../registry"),i=e("./attributes"),n=e("../../components/colorscale/defaults");t.exports={supplyDefaults:function(e,t,o,n){a(e,t,o,n,function(a,o){return r.coerce(e,t,i,a,o)})},supplyIsoDefaults:a}},{"../../components/colorscale/defaults":603,"../../lib":719,"../../registry":847,"./attributes":1048}],1052:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],meta:{}}},{"../../plots/gl3d":807,"./attributes":1048,"./calc":1049,"./convert":1050,"./defaults":1051}],1053:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("../surface/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat;t.exports=n({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:r({editType:"calc"}),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},a("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:o.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:n({},o.contours.x.show,{}),color:o.contours.x.color,width:o.contours.x.width,editType:"calc"},lightposition:{x:n({},o.lightposition.x,{dflt:1e5}),y:n({},o.lightposition.y,{dflt:1e5}),z:n({},o.lightposition.z,{dflt:0}),editType:"calc"},lighting:n({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},o.lighting),hoverinfo:n({},i.hoverinfo,{editType:"calc"})})},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../surface/attributes":1225}],1054:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){t.intensity&&a(e,t,{vals:t.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":601}],1055:[function(e,t){"use strict";function a(e,t,a){this.scene=e,this.uid=a,this.mesh=t,this.name="",this.color="#fff",this.data=null,this.showContour=!1}function r(e){for(var t=[],a=e.length,r=0;r<a;r++)t[r]=h(e[r]);return t}function o(e,t,a,r){for(var o=[],n=t.length,l=0;l<n;l++)o[l]=e.d2l(t[l],0,r)*a;return o}function i(e){for(var t=[],a=e.length,r=0;r<a;r++)t[r]=V(e[r]);return t}function n(e,t){for(var a=["x","y","z"].indexOf(e),r=[],o=t.length,n=0;n<o;n++)r[n]=[t[n][(a+1)%3],t[n][(a+2)%3]];return c(r)}function l(e,t){for(var a=e.length,r=0;r<a;r++)if(-.5>=e[r]||e[r]>=t-.5)return!1;return!0}var s=e("gl-mesh3d"),c=e("delaunay-triangulate"),p=e("alpha-shape"),u=e("convex-hull"),g=e("../../lib/gl_format_color").parseColorScale,h=e("../../lib/str2rgbarray"),m=e("../../components/colorscale").extractOpts,y=e("../../plots/gl3d/zip3"),f=a.prototype;f.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]];var a=this.data.hovertext||this.data.text;return Array.isArray(a)&&void 0!==a[t]?e.textLabel=a[t]:a&&(e.textLabel=a),!0}},f.update=function(e){var t=this.scene,a=t.fullSceneLayout;this.data=e;var s=e.x.length,d=y(o(a.xaxis,e.x,t.dataScale[0],e.xcalendar),o(a.yaxis,e.y,t.dataScale[1],e.ycalendar),o(a.zaxis,e.z,t.dataScale[2],e.zcalendar)),c;if(e.i&&e.j&&e.k){if(e.i.length!==e.j.length||e.j.length!==e.k.length||!l(e.i,s)||!l(e.j,s)||!l(e.k,s))return;c=y(i(e.i),i(e.j),i(e.k))}else c=0===e.alphahull?u(d):0<e.alphahull?p(e.alphahull,d):n(e.delaunayaxis,d);var f={positions:d,cells:c,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:h(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};if(e.intensity){var x=m(e);this.color="#fff",f.vertexIntensity=e.intensity,f.vertexIntensityBounds=[x.min,x.max],f.colormap=g(e)}else e.vertexcolor?(this.color=e.vertexcolor[0],f.vertexColors=r(e.vertexcolor)):e.facecolor?(this.color=e.facecolor[0],f.cellColors=r(e.facecolor)):(this.color=e.color,f.meshColor=h(e.color));this.mesh.update(f)},f.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var r=e.glplot.gl,o=s({gl:r}),i=new a(e,o,t.uid);return o._trace=i,i.update(t),e.glplot.add(o),i}},{"../../components/colorscale":605,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../../plots/gl3d/zip3":818,"alpha-shape":64,"convex-hull":130,"delaunay-triangulate":165,"gl-mesh3d":280}],1056:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib"),o=e("../../components/colorscale/defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(a,o){return r.coerce(e,t,i,a,o)}function d(e){var t=e.map(function(e){var t=s(e);return t&&r.isArrayOrTypedArray(t)?t:null});return t.every(function(e){return e&&e.length===t[0].length})&&t}var c=d(["x","y","z"]);if(!c)return void(t.visible=!1);if(d(["i","j","k"]),t.i&&(!t.j||!t.k)||t.j&&(!t.k||!t.i)||t.k&&(!t.i||!t.j))return void(t.visible=!1);var p=a.getComponentMethod("calendars","handleTraceDefaults");p(e,t,["x","y","z"],l),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","contour.show","contour.color","contour.width","colorscale","reversescale","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(e){s(e)}),"intensity"in e?(s("intensity"),o(e,t,l,s,{prefix:"",cLetter:"c"})):(t.showscale=!1,"facecolor"in e?s("facecolor"):"vertexcolor"in e?s("vertexcolor"):s("color",n)),s("text"),s("hovertext"),s("hovertemplate"),t._length=null}},{"../../components/colorscale/defaults":603,"../../lib":719,"../../registry":847,"./attributes":1053}],1057:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],meta:{}}},{"../../plots/gl3d":807,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(e,t){"use strict";function a(e){return{line:{color:r({},c.color,{dflt:e}),width:c.width,dash:i,editType:"style"},editType:"style"}}var r=e("../../lib").extendFlat,o=e("../scatter/attributes"),i=e("../../components/drawing/attributes").dash,n=e("../../components/fx/attributes"),l=e("../../constants/delta.js"),s=l.INCREASING.COLOR,d=l.DECREASING.COLOR,c=o.line;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:r({},c.width,{}),dash:r({},i,{}),editType:"style"},increasing:a(s),decreasing:a(d),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:r({},n.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":613,"../../components/fx/attributes":623,"../../constants/delta.js":689,"../../lib":719,"../scatter/attributes":1112}],1059:[function(e,t){"use strict";function a(e,t,a,r){return{o:e,h:t,l:a,c:r}}function r(e,t,a,r,u){for(var g=r.makeCalcdata(t,"open"),o=r.makeCalcdata(t,"high"),h=r.makeCalcdata(t,"low"),l=r.makeCalcdata(t,"close"),c=Array.isArray(t.text),m=Array.isArray(t.hovertext),y=!0,f=null,x=[],_=0;_<a.length;_++){var b=a[_],v=g[_],k=o[_],w=h[_],T=l[_];if(b!==p&&v!==p&&k!==p&&w!==p&&T!==p){T===v?null!==f&&T!==f&&(y=T>f):y=T>v,f=T;var A=u(v,k,w,T);A.pos=b,A.yc=(v+T)/2,A.i=_,A.dir=y?"increasing":"decreasing",A.x=A.pos,A.y=[w,k],c&&(A.tx=t.text[_]),m&&(A.htx=t.hovertext[_]),x.push(A)}else x.push({pos:b,empty:!0})}return t._extremes[r._id]=d.findExtremes(r,n.concat(h,o),{padded:!0}),x.length&&(x[0].t={labels:{open:s(e,"open:")+" ",high:s(e,"high:")+" ",low:s(e,"low:")+" ",close:s(e,"close:")+" "}}),x}function o(e,t,a){var r=a._minDiff;if(!r){var o=e._fullData,l=[];r=1/0;var s;for(s=0;s<o.length;s++){var d=o[s];if("ohlc"===d.type&&!0===d.visible&&d.xaxis===t._id){l.push(d);var c=t.makeCalcdata(d,"x");d._xcalc=c;var p=n.distinctVals(c).minDiff;p&&isFinite(p)&&(r=ea(r,p))}}for(r===1/0&&(r=1),s=0;s<l.length;s++)l[s]._minDiff=r}return r*a.tickwidth}var n=e("../../lib"),s=n._,d=e("../../plots/cartesian/axes"),p=e("../../constants/numerical").BADNUM;t.exports={calc:function(e,t){var i=d.getFromId(e,t.xaxis),l=d.getFromId(e,t.yaxis),s=o(e,i,t),c=t._minDiff;t._minDiff=null;var p=t._xcalc;t._xcalc=null;var u=r(e,t,p,l,a);return t._extremes[i._id]=d.findExtremes(i,p,{vpad:c/2}),u.length?(n.extendFlat(u[0].t,{wHover:c/2,tickLen:s}),u):[{t:{empty:!0}}]},calcCommon:r}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767}],1060:[function(e,t){"use strict";function a(e,t,a,r){a(r+".line.color"),a(r+".line.width",t.line.width),a(r+".line.dash",t.line.dash)}var r=e("../../lib"),o=e("./ohlc_defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(a,o){return r.coerce(e,t,i,a,o)}var d=o(e,t,s,l);return d?void(s("line.width"),s("line.dash"),a(e,t,s,"increasing"),a(e,t,s,"decreasing"),s("text"),s("hovertext"),s("tickwidth"),l._requestRangeslider[t.xaxis]=!0):void(t.visible=!1)}},{"../../lib":719,"./attributes":1058,"./ohlc_defaults":1063}],1061:[function(e,t){"use strict";function a(e,a,r,o){function n(e){var t=f(e);return s.inbox(t-_,t+_,v)}function l(e){var t=e[h],a=e[m];return t===a||s.inbox(t-r,a-r,v)}function d(e){return(n(e)+l(e))/2}var c=e.cd,p=e.xa,u=c[0].trace,g=c[0].t,t=u.type,h="ohlc"===t?"l":"min",m="ohlc"===t?"h":"max",y=g.bPos||0,f=function(e){return e.pos+y-a},x=g.bdPos||g.tickLen,_=g.wHover,b=ea(1,x/_a(p.r2c(p.range[1])-p.r2c(p.range[0]))),v,k;v=e.maxHoverDistance-b,k=e.maxSpikeDistance-b;var w=s.getDistanceFunction(o,n,l,d);if(s.getClosest(c,w,e),!1===e.index)return null;var T=c[e.index];if(T.empty)return null;var A=T.dir,S=u[A],C=S.line.color;return e.color=i.opacity(C)&&S.line.width?C:S.fillcolor,e.x0=p.c2p(T.pos+y-x,!0),e.x1=p.c2p(T.pos+y+x,!0),e.xLabelVal=T.pos,e.spikeDistance=d(T)*k/v,e.xSpike=p.c2p(T.pos,!0),e}function r(e,r,o,s){var d=e.cd,c=e.ya,p=d[0].trace,u=d[0].t,t=[],g=a(e,r,o,s);if(!g)return[];var h=g.index,m=d[h],y=m.hi||p.hoverinfo,f=y.split("+"),x="all"===y||-1!==f.indexOf("y");if(!x)return[];for(var _=["high","open","close","low"],b={},v=0;v<_.length;v++){var k=_[v],w=p[k][g.index],T=c.c2p(w,!0),A;w in b?(A=b[w],A.yLabel+="<br>"+u.labels[k]+n.hoverLabelText(c,w)):(A=l.extendFlat({},g),A.y0=A.y1=T,A.yLabelVal=w,A.yLabel=u.labels[k]+n.hoverLabelText(c,w),A.name="",t.push(A),b[w]=A)}return t}function o(e,r,o,l){function s(e){return h.labels[e]+n.hoverLabelText(u,g[e][f])}var c=e.cd,u=e.ya,g=c[0].trace,h=c[0].t,t=a(e,r,o,l);if(!t)return[];var m=t.index,y=c[m],f=t.index=y.i,i=y.dir,x=y.hi||g.hoverinfo,_=x.split("+"),b="all"===x,v=b||-1!==_.indexOf("y"),k=b||-1!==_.indexOf("text"),w=v?[s("open"),s("high"),s("low"),s("close")+"  "+p[i]]:[];return k&&d(y,g,w),t.extraText=w.join("<br>"),t.y0=t.y1=u.c2p(y.yc,!0),[t]}var n=e("../../plots/cartesian/axes"),l=e("../../lib"),s=e("../../components/fx"),i=e("../../components/color"),d=e("../../lib").fillText,c=e("../../constants/delta.js"),p={increasing:c.INCREASING.SYMBOL,decreasing:c.DECREASING.SYMBOL};t.exports={hoverPoints:function(e,t,a,i){var n=e.cd,l=n[0].trace;return l.hoverlabel.split?r(e,t,a,i):o(e,t,a,i)},hoverSplit:r,hoverOnPoints:o}},{"../../components/color":593,"../../components/fx":632,"../../constants/delta.js":689,"../../lib":719,"../../plots/cartesian/axes":767}],1062:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"ohlc",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc").calc,plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select")}},{"../../plots/cartesian":778,"./attributes":1058,"./calc":1059,"./defaults":1060,"./hover":1061,"./plot":1064,"./select":1065,"./style":1066}],1063:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../lib");t.exports=function(e,t,o,i){var n=o("x"),l=o("open"),s=o("high"),d=o("low"),c=o("close");o("hoverlabel.split");var p=a.getComponentMethod("calendars","handleTraceDefaults");if(p(e,t,["x"],i),!!(l&&s&&d&&c)){var u=ea(l.length,s.length,d.length,c.length);return n&&(u=ea(u,r.minRowLength(n))),t._length=u,u}}},{"../../lib":719,"../../registry":847}],1064:[function(e,t){"use strict";var a=e("d3"),r=e("../../lib");t.exports=function(e,t,o,i){var n=t.xaxis,l=t.yaxis;r.makeTraceGroups(i,o,"trace ohlc").each(function(e){var o=a.select(this),i=e[0],s=i.t,t=i.trace;if(!0!==t.visible||s.empty)return void o.remove();var c=s.tickLen,p=o.selectAll("path").data(r.identity);p.enter().append("path"),p.exit().remove(),p.attr("d",function(e){if(e.empty)return"M0,0Z";var t=n.c2p(e.pos,!0),a=n.c2p(e.pos-c,!0),r=n.c2p(e.pos+c,!0),o=l.c2p(e.o,!0),i=l.c2p(e.h,!0),s=l.c2p(e.l,!0),d=l.c2p(e.c,!0);return"M"+a+","+o+"H"+t+"M"+t+","+i+"V"+s+"M"+r+","+d+"H"+t})})}},{"../../lib":719,d3:163}],1065:[function(e,t){"use strict";t.exports=function(e,t){var a=e.cd,r=e.xaxis,o=e.yaxis,n=[],l=a[0].t.bPos||0,s;if(!1===t)for(s=0;s<a.length;s++)a[s].selected=0;else for(s=0;s<a.length;s++){var d=a[s];t.contains([r.c2p(d.pos+l),o.c2p(d.yc)],null,d.i,e)?(n.push({pointNumber:d.i,x:r.c2d(d.pos),y:o.c2d(d.yc)}),d.selected=1):d.selected=0}return n}},{}],1066:[function(e,t){"use strict";var a=e("d3"),r=e("../../components/drawing"),o=e("../../components/color");t.exports=function(e,t,i){var n=i?i:a.select(e).selectAll("g.ohlclayer").selectAll("g.trace");n.style("opacity",function(e){return e[0].trace.opacity}),n.each(function(e){var t=e[0].trace;a.select(this).selectAll("path").each(function(e){if(!e.empty){var i=t[e.dir].line;a.select(this).style("fill","none").call(o.stroke,i.color).call(r.dashLine,i.dash,i.width).style("opacity",t.selectedpoints&&!e.selected?.3:1)}})})}},{"../../components/color":593,"../../components/drawing":614,d3:163}],1067:[function(e,t){"use strict";var a=e("../../lib/extend").extendFlat,r=e("../../plots/attributes"),o=e("../../plots/font_attributes"),i=e("../../components/colorscale/attributes"),n=e("../../components/fx/hovertemplate_attributes"),l=e("../../plots/domain").attributes,s=a({editType:"calc"},i("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:n({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});t.exports={domain:l({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:a({},r.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:n({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:o({editType:"calc"}),tickfont:o({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:s,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/font_attributes":793}],1068:[function(e,t,a){"use strict";var r=e("../../plots/get_data").getModuleCalcData,o=e("./plot"),i="parcats";a.name=i,a.plot=function(e,t,a,n){var l=r(e.calcdata,i);if(l.length){var s=l[0];o(e,s,a,n)}},a.clean=function(e,t,a,r){var o=r._has&&r._has("parcats"),i=t._has&&t._has("parcats");o&&!i&&r._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":802,"./plot":1073}],1069:[function(e,t){"use strict";function a(e,t,a){var r=e.map(function(e){return e.categories.length}).reduce(function(e,t){return va(e,t)});return{dimensions:e,paths:t,trace:void 0,maxCats:r,count:a}}function r(e,t,a,r,o){return{dimensionInd:e,containerInd:t,displayInd:a,dimensionLabel:r,count:o,categories:[],dragX:null}}function o(e,t,a,r){return{dimensionInd:e,categoryInd:t,categoryValue:a,displayInd:t,categoryLabel:r,valueInds:[],count:0,dragY:null}}function i(e,t,a){e.valueInds.push(t),e.count+=a}function n(e,t,a){return{categoryInds:e,color:t,rawColor:a,valueInds:[],count:0}}function l(e,t,a){e.valueInds.push(t),e.count+=a}function s(e,t){t=void 0===t||null===t?[]:t.map(function(t){return t});var a={},r={},o=[];t.forEach(function(e,t){a[e]=0,r[e]=t});for(var n=0;n<e.length;n++){var l=e[n],s;a[l]===void 0?(a[l]=1,s=t.push(l)-1,r[l]=s):(a[l]++,s=r[l]),o.push(s)}var d=t.map(function(e){return a[e]});return{uniqueValues:t,uniqueCounts:d,inds:o}}function c(e){var t=e.map(function(e){return e.displayindex}),a;if(u(t))for(a=0;a<e.length;a++)e[a]._displayindex=e[a].displayindex;else for(a=0;a<e.length;a++)e[a]._displayindex=a}function p(e,t){e._categoryarray=t.uniqueValues,e._ticktext=null===e.ticktext||void 0===e.ticktext?[]:e.ticktext.slice();for(var a=e._ticktext.length;a<t.uniqueValues.length;a++)e._ticktext.push(t.uniqueValues[a])}function u(e){for(var t=Array(e.length),a=0;a<e.length;a++){if(0>e[a]||e[a]>=e.length)return!1;if(void 0!==t[e[a]])return!1;t[e[a]]=!0}return!0}var g=e("../../lib/gup").wrap,h=e("../../components/colorscale/helpers").hasColorscale,m=e("../../components/colorscale/calc"),y=e("../../lib/filter_unique.js"),f=e("../../components/drawing"),x=e("../../lib");t.exports=function(e,t){function u(e){var t;return t=x.isArrayOrTypedArray(T.color)?T.color[e%T.color.length]:T.color,{color:A(t),rawColor:t}}var _=x.filterVisible(t.dimensions);if(0===_.length)return[];var b=_.map(function(e){var t;return"trace"===e.categoryorder?t=null:"array"===e.categoryorder?t=e.categoryarray:(t=y(e.values).sort(),"category descending"===e.categoryorder&&(t=t.reverse())),s(e.values,t)}),v,k,w;v=x.isArrayOrTypedArray(t.counts)?t.counts:[t.counts],c(_),_.forEach(function(e,t){p(e,b[t])});var T=t.line,A;T?(h(t,"line")&&m(e,t,{vals:t.line.color,containerStr:"line",cLetter:"c"}),A=f.tryColorscale(T)):A=x.identity;var S=_[0].values.length,C={},L=b.map(function(e){return e.inds});w=0;var E,I;for(E=0;E<S;E++){var z=[];for(I=0;I<L.length;I++)z.push(L[I][E]);k=v[E%v.length],w+=k;var P=u(E),D="-"+P.rawColor;C[D]===void 0&&(C[D]=n(z,P.color,P.rawColor)),l(C[D],E,k)}var O=_.map(function(e,t){return r(t,e._index,e._displayindex,e.label,w)});for(E=0;E<S;E++)for(k=v[E%v.length],I=0;I<O.length;I++){var R=O[I].containerInd,M=b[I].inds[E],j=O[I].categories;if(void 0===j[M]){var F=t.dimensions[R]._categoryarray[M],B=t.dimensions[R]._ticktext[M];j[M]=o(I,M,F,B)}i(j[M],E,k)}return g(a(O,C,w))}},{"../../components/colorscale/calc":601,"../../components/colorscale/helpers":604,"../../components/drawing":614,"../../lib":719,"../../lib/filter_unique.js":711,"../../lib/gup":717}],1070:[function(e,t){"use strict";function a(e,t,a,r,l){l("line.shape"),l("line.hovertemplate");var s=l("line.color",r.colorway[0]);if(i(e,"line")&&o.isArrayOrTypedArray(s)){if(s.length)return l("line.colorscale"),n(e,t,r,l,{prefix:"line.",cLetter:"c"}),s.length;t.line.color=a}return 1/0}function r(e,t){function a(a,r){return o.coerce(e,t,d.dimensions,a,r)}var r=a("values"),i=a("visible");if(r&&r.length||(i=t.visible=!1),i){a("label"),a("displayindex",t._index);var n=e.categoryarray,l=Array.isArray(n)&&0<n.length,s;l&&(s="array");var c=a("categoryorder",s);"array"===c?(a("categoryarray"),a("ticktext")):(delete e.categoryarray,delete e.ticktext),l||"array"!==c||(t.categoryorder="trace")}}var o=e("../../lib"),i=e("../../components/colorscale/helpers").hasColorscale,n=e("../../components/colorscale/defaults"),l=e("../../plots/domain").defaults,s=e("../../plots/array_container_defaults"),d=e("./attributes"),c=e("../parcoords/merge_length");t.exports=function(e,t,i,n){function p(a,r){return o.coerce(e,t,d,a,r)}var u=s(e,t,{name:"dimensions",handleItemDefaults:r}),g=a(e,t,i,n,p);l(t,n,p),Array.isArray(u)&&u.length||(t.visible=!1),c(t,u,"values",g),p("hoveron"),p("hovertemplate"),p("arrangement"),p("bundlecolors"),p("sortpaths"),p("counts");var h={family:n.font.family,size:V(n.font.size),color:n.font.color};o.coerceFont(p,"labelfont",h);var m={family:n.font.family,size:V(n.font.size/1.2),color:n.font.color};o.coerceFont(p,"tickfont",m)}},{"../../components/colorscale/defaults":603,"../../components/colorscale/helpers":604,"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/domain":792,"../parcoords/merge_length":1083,"./attributes":1067}],1071:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1067,"./base_plot":1068,"./calc":1069,"./defaults":1070,"./plot":1073}],1072:[function(e,t){"use strict";function a(e,t,a,s){var p=e.map(P.bind(0,t,a)),u=s.selectAll("g.parcatslayer").data([null]);u.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var h=u.selectAll("g.trace.parcats").data(p,r),y=h.enter().append("g").attr("class","trace parcats");h.attr("transform",function(e){return"translate("+e.x+", "+e.y+")"}),y.append("g").attr("class","paths");var f=h.select("g.paths"),x=f.selectAll("path.path").data(function(e){return e.paths},r);x.attr("fill",function(e){return e.model.color});var _=x.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(e){return e.model.color}).attr("fill-opacity",0);c(_),x.attr("d",function(e){return e.svgD}),_.empty()||x.sort(i),x.exit().remove(),x.on("mouseover",n).on("mouseout",l).on("click",d),y.append("g").attr("class","dimensions");var b=h.select("g.dimensions"),v=b.selectAll("g.dimension").data(function(e){return e.dimensions},r);v.enter().append("g").attr("class","dimension"),v.attr("transform",function(e){return"translate("+e.x+", 0)"}),v.exit().remove();var k=v.selectAll("g.category").data(function(e){return e.categories},r),w=k.enter().append("g").attr("class","category");k.attr("transform",function(e){return"translate(0, "+e.y+")"}),w.append("rect").attr("class","catrect").attr("pointer-events","none"),k.select("rect.catrect").attr("fill","none").attr("width",function(e){return e.width}).attr("height",function(e){return e.height}),g(w);var E=k.selectAll("rect.bandrect").data(function(e){return e.bands},r);E.each(function(){N.raiseToTop(this)}),E.attr("fill",function(e){return e.color});var I=E.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);E.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y}).attr("cursor",function(e){return"fixed"===e.parcatsViewModel.arrangement?"default":"perpendicular"===e.parcatsViewModel.arrangement?"ns-resize":"move"}),m(I),E.exit().remove(),w.append("text").attr("class","catlabel").attr("pointer-events","none");var z=t._fullLayout.paper_bgcolor;k.select("text.catlabel").attr("text-anchor",function(e){return o(e)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",z+" -1px  1px 2px, "+z+" 1px  1px 2px, "+z+"  1px -1px 2px, "+z+" -1px -1px 2px").style("fill","rgb(0, 0, 0)").attr("x",function(e){return o(e)?e.width+5:-5}).attr("y",function(e){return e.height/2}).text(function(e){return e.model.categoryLabel}).each(function(e){V.font(j.select(this),e.parcatsViewModel.categorylabelfont),H.convertToTspans(j.select(this),t)}),w.append("text").attr("class","dimlabel"),k.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(e){return"fixed"===e.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(e){return e.width/2}).attr("y",-5).text(function(e,t){return 0===t?e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel:null}).each(function(e){V.font(j.select(this),e.parcatsViewModel.labelfont)}),k.selectAll("rect.bandrect").on("mouseover",T).on("mouseout",A),k.exit().remove(),v.call(j.behavior.drag().origin(function(e){return{x:e.x,y:0}}).on("dragstart",S).on("drag",C).on("dragend",L)),h.each(function(e){e.traceSelection=j.select(this),e.pathSelection=j.select(this).selectAll("g.paths").selectAll("path.path"),e.dimensionSelection=j.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),h.exit().remove()}function r(e){return e.key}function o(e){var t=e.parcatsViewModel.dimensions.length,a=e.parcatsViewModel.dimensions[t-1].model.dimensionInd;return e.model.dimensionInd===a}function i(e,t){return e.model.rawColor>t.model.rawColor?1:e.model.rawColor<t.model.rawColor?-1:0}function n(e){if(!e.parcatsViewModel.dragDimension&&-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){N.raiseToTop(this),p(j.select(this));var t=s(e);if(e.parcatsViewModel.graphDiv.emit("plotly_hover",{points:t,event:j.event}),-1===e.parcatsViewModel.hoverinfoItems.indexOf("none")){var a=j.mouse(this)[0],r=e.parcatsViewModel.graphDiv,o=e.parcatsViewModel.trace,i=r._fullLayout,n=i._paperdiv.node().getBoundingClientRect(),l=e.parcatsViewModel.graphDiv.getBoundingClientRect(),d,c,u;for(u=0;u<e.leftXs.length-1;u++)if(e.leftXs[u]+e.dimWidths[u]-2<=a&&a<=e.leftXs[u+1]+2){var g=e.parcatsViewModel.dimensions[u],h=e.parcatsViewModel.dimensions[u+1];d=(g.x+g.width+h.x)/2,c=(e.topYs[u]+e.topYs[u+1]+e.height)/2;break}var m=e.parcatsViewModel.x+d,y=e.parcatsViewModel.y+c,f=U.mostReadable(e.model.color,["black","white"]),x=e.model.count,_=x/e.parcatsViewModel.model.count,b={countLabel:x,probabilityLabel:_.toFixed(3)},v=[];-1!==e.parcatsViewModel.hoverinfoItems.indexOf("count")&&v.push(["Count:",b.countLabel].join(" ")),-1!==e.parcatsViewModel.hoverinfoItems.indexOf("probability")&&v.push(["P:",b.probabilityLabel].join(" "));var k=v.join("<br>"),w=j.mouse(r)[0];B.loneHover({trace:o,x:m-n.left+l.left,y:y-n.top+l.top,text:k,color:e.model.color,borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontSize:10,fontColor:f,idealAlign:w<m?"right":"left",hovertemplate:(o.line||{}).hovertemplate,hovertemplateLabels:b,eventData:[{data:o._input,fullData:o,count:x,probability:_}]},{container:i._hoverlayer.node(),outerContainer:i._paper.node(),gd:r})}}}function l(e){if(!e.parcatsViewModel.dragDimension&&(c(j.select(this)),B.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),e.parcatsViewModel.pathSelection.sort(i),-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var t=s(e);e.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:t,event:j.event})}}function s(e){for(var t=[],a=E(e.parcatsViewModel),r=0,o;r<e.model.valueInds.length;r++)o=e.model.valueInds[r],t.push({curveNumber:a,pointNumber:o});return t}function d(e){if(-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){var t=s(e);e.parcatsViewModel.graphDiv.emit("plotly_click",{points:t,event:j.event})}}function c(e){e.attr("fill",function(e){return e.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function p(e){e.attr("fill-opacity",.8).attr("stroke",function(e){return U.mostReadable(e.model.color,["black","white"])}).attr("stroke-width",.3)}function u(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function g(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function h(e){e.attr("stroke","black").attr("stroke-width",1.5)}function m(e){e.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function y(e){var t=e.parcatsViewModel.pathSelection,a=e.categoryViewModel.model.dimensionInd,r=e.categoryViewModel.model.categoryInd;return t.filter(function(t){return t.model.categoryInds[a]===r&&t.model.color===e.color})}function f(e){var t=j.select(e.parentNode).selectAll("rect.bandrect");t.each(function(e){var t=y(e);p(t),t.each(function(){N.raiseToTop(this)})}),u(j.select(e.parentNode))}function x(e){var t=j.select(e).datum(),a=y(t);p(a),a.each(function(){N.raiseToTop(this)}),j.select(e.parentNode).selectAll("rect.bandrect").filter(function(e){return e.color===t.color}).each(function(){N.raiseToTop(this),h(j.select(this))})}function _(e,t,a){var r=j.select(e).datum(),o=r.parcatsViewModel.graphDiv,i=j.select(e.parentNode).selectAll("rect.bandrect"),n=[];i.each(function(e){var t=y(e);t.each(function(e){Array.prototype.push.apply(n,s(e))})}),o.emit(t,{points:n,event:a})}function b(e,t,a){var r=j.select(e).datum(),o=r.parcatsViewModel.graphDiv,i=y(r),n=[];i.each(function(e){Array.prototype.push.apply(n,s(e))}),o.emit(t,{points:n,event:a})}function v(e,t){var a=j.select(t.parentNode).select("rect.catrect"),r=a.node().getBoundingClientRect(),o=a.datum(),i=o.parcatsViewModel,n=i.model.dimensions[o.model.dimensionInd],l=i.trace,s=r.top+r.height/2,d,c;1<i.dimensions.length&&n.displayInd===i.dimensions.length-1?(d=r.left,c="left"):(d=r.left+r.width,c="right");var p=o.model.count,u=o.model.categoryLabel,g=p/o.parcatsViewModel.model.count,h={countLabel:p,categoryLabel:u,probabilityLabel:g.toFixed(3)},m=[];-1!==o.parcatsViewModel.hoverinfoItems.indexOf("count")&&m.push(["Count:",h.countLabel].join(" ")),-1!==o.parcatsViewModel.hoverinfoItems.indexOf("probability")&&m.push(["P("+h.categoryLabel+"):",h.probabilityLabel].join(" "));var y=m.join("<br>");return{trace:l,x:d-e.left,y:s-e.top,text:y,color:"lightgray",borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontSize:12,fontColor:"black",idealAlign:c,hovertemplate:l.hovertemplate,hovertemplateLabels:h,eventData:[{data:l._input,fullData:l,count:p,category:u,probability:g}]}}function k(e,t){var a=[];return j.select(t.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var t=this;a.push(v(e,t))}),a}function w(e,t){var a=t.getBoundingClientRect(),r=j.select(t).datum(),o=r.categoryViewModel,i=o.parcatsViewModel,n=i.model.dimensions[o.model.dimensionInd],l=i.trace,s=a.y+a.height/2,d,c;1<i.dimensions.length&&n.displayInd===i.dimensions.length-1?(d=a.left,c="left"):(d=a.left+a.width,c="right");var p=o.model.categoryLabel,u=r.parcatsViewModel.model.count,g=0;r.categoryViewModel.bands.forEach(function(e){e.color===r.color&&(g+=e.count)});var h=o.model.count,m=0;i.pathSelection.each(function(e){e.model.color===r.color&&(m+=e.model.count)});var y=g/u,f=g/m,x=g/h,_={countLabel:u,categoryLabel:p,probabilityLabel:y.toFixed(3)},b=[];-1!==o.parcatsViewModel.hoverinfoItems.indexOf("count")&&b.push(["Count:",_.countLabel].join(" ")),-1!==o.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(b.push("P(color \u2229 "+p+"): "+_.probabilityLabel),b.push("P("+p+" | color): "+f.toFixed(3)),b.push("P(color | "+p+"): "+x.toFixed(3)));var v=b.join("<br>"),k=U.mostReadable(r.color,["black","white"]);return{trace:l,x:d-e.left,y:s-e.top,text:v,color:r.color,borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontColor:k,fontSize:10,idealAlign:c,hovertemplate:l.hovertemplate,hovertemplateLabels:_,eventData:[{data:l._input,fullData:l,category:p,count:u,probability:y,categorycount:h,colorcount:m,bandcolorcount:g}]}}function T(e){if(!e.parcatsViewModel.dragDimension&&-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){var t=j.mouse(this)[1];if(-1>t)return;var a=e.parcatsViewModel.graphDiv,r=a._fullLayout,o=r._paperdiv.node().getBoundingClientRect(),i=e.parcatsViewModel.hoveron,n=this;if("color"===i?(x(n),b(n,"plotly_hover",j.event)):(f(n),_(n,"plotly_hover",j.event)),-1===e.parcatsViewModel.hoverinfoItems.indexOf("none")){var l;"category"===i?l=v(o,n):"color"===i?l=w(o,n):"dimension"===i&&(l=k(o,n)),l&&B.loneHover(l,{container:r._hoverlayer.node(),outerContainer:r._paper.node(),gd:a})}}}function A(e){var t=e.parcatsViewModel;if(!t.dragDimension&&(c(t.pathSelection),g(t.dimensionSelection.selectAll("g.category")),m(t.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),B.loneUnhover(t.graphDiv._fullLayout._hoverlayer.node()),t.pathSelection.sort(i),-1===t.hoverinfoItems.indexOf("skip"))){var a=e.parcatsViewModel.hoveron,r=this;"color"===a?b(r,"plotly_unhover",j.event):_(r,"plotly_unhover",j.event)}}function S(e){"fixed"===e.parcatsViewModel.arrangement||(e.dragDimensionDisplayInd=e.model.displayInd,e.initialDragDimensionDisplayInds=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd}),e.dragHasMoved=!1,e.dragCategoryDisplayInd=null,j.select(this).selectAll("g.category").select("rect.catrect").each(function(t){var a=j.mouse(this)[0],r=j.mouse(this)[1];-2<=a&&a<=t.width+2&&-2<=r&&r<=t.height+2&&(e.dragCategoryDisplayInd=t.model.displayInd,e.initialDragCategoryDisplayInds=e.model.categories.map(function(e){return e.displayInd}),t.model.dragY=t.y,N.raiseToTop(this.parentNode),j.select(this.parentNode).selectAll("rect.bandrect").each(function(t){t.y<r&&r<=t.y+t.height&&(e.potentialClickBand=this)}))}),e.parcatsViewModel.dragDimension=e,B.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function C(e){if("fixed"!==e.parcatsViewModel.arrangement&&(e.dragHasMoved=!0,null!==e.dragDimensionDisplayInd)){var t=e.dragDimensionDisplayInd,a=e.parcatsViewModel.dimensions[t];if(null!==e.dragCategoryDisplayInd){var r=a.categories[e.dragCategoryDisplayInd];r.model.dragY+=j.event.dy;var o=r.model.dragY,i=r.model.displayInd,n=a.categories,l=n[i-1],s=n[i+1];void 0!==l&&o<l.y+l.height/2&&(r.model.displayInd=l.model.displayInd,l.model.displayInd=i),void 0!==s&&o+r.height>s.y+s.height/2&&(r.model.displayInd=s.model.displayInd,s.model.displayInd=i),e.dragCategoryDisplayInd=r.model.displayInd}if(null===e.dragCategoryDisplayInd||"freeform"===e.parcatsViewModel.arrangement){a.model.dragX=j.event.x;var d=e.parcatsViewModel.dimensions[t-1],c=e.parcatsViewModel.dimensions[t+1];void 0!==d&&a.model.dragX<d.x+d.width&&(a.model.displayInd=d.model.displayInd,d.model.displayInd=t),void 0!==c&&a.model.dragX+a.width>c.x&&(a.model.displayInd=c.model.displayInd,c.model.displayInd=e.dragDimensionDisplayInd),e.dragDimensionDisplayInd=a.model.displayInd}R(e.parcatsViewModel),O(e.parcatsViewModel),z(e.parcatsViewModel),I(e.parcatsViewModel)}}function L(e){if("fixed"!==e.parcatsViewModel.arrangement&&null!==e.dragDimensionDisplayInd){j.select(this).selectAll("text").attr("font-weight","normal");var t={},a=E(e.parcatsViewModel),r=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd}),o=e.initialDragDimensionDisplayInds.some(function(e,t){return e!==r[t]});o&&r.forEach(function(a,r){var o=e.parcatsViewModel.model.dimensions[r].containerInd;t["dimensions["+o+"].displayindex"]=a});var i=!1;if(null!==e.dragCategoryDisplayInd){var n=e.model.categories.map(function(e){return e.displayInd});if(i=e.initialDragCategoryDisplayInds.some(function(e,t){return e!==n[t]}),i){var l=e.model.categories.slice().sort(function(e,t){return e.displayInd-t.displayInd}),s=l.map(function(e){return e.categoryValue}),d=l.map(function(e){return e.categoryLabel});t["dimensions["+e.model.containerInd+"].categoryarray"]=[s],t["dimensions["+e.model.containerInd+"].ticktext"]=[d],t["dimensions["+e.model.containerInd+"].categoryorder"]="array"}}if(-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!e.dragHasMoved&&e.potentialClickBand&&("color"===e.parcatsViewModel.hoveron?b(e.potentialClickBand,"plotly_click",j.event.sourceEvent):_(e.potentialClickBand,"plotly_click",j.event.sourceEvent)),e.model.dragX=null,null!==e.dragCategoryDisplayInd){var c=e.parcatsViewModel.dimensions[e.dragDimensionDisplayInd].categories[e.dragCategoryDisplayInd];c.model.dragY=null,e.dragCategoryDisplayInd=null}e.dragDimensionDisplayInd=null,e.parcatsViewModel.dragDimension=null,e.dragHasMoved=null,e.potentialClickBand=null,R(e.parcatsViewModel),O(e.parcatsViewModel);var p=j.transition().duration(300).ease("cubic-in-out");p.each(function(){z(e.parcatsViewModel,!0),I(e.parcatsViewModel,!0)}).each("end",function(){(o||i)&&F.restyle(e.parcatsViewModel.graphDiv,t,[a])})}}function E(e){for(var t=e.graphDiv._fullData,a=0,r;a<t.length;a++)if(e.key===t[a].uid){r=a;break}return r}function I(e,t){function a(e){return t?e.transition():e}t===void 0&&(t=!1),e.pathSelection.data(function(e){return e.paths},r),a(e.pathSelection).attr("d",function(e){return e.svgD})}function z(e,t){function a(e){return t?e.transition():e}t===void 0&&(t=!1),e.dimensionSelection.data(function(e){return e.dimensions},r);var i=e.dimensionSelection.selectAll("g.category").data(function(e){return e.categories},r);a(e.dimensionSelection).attr("transform",function(e){return"translate("+e.x+", 0)"}),a(i).attr("transform",function(e){return"translate(0, "+e.y+")"});var n=i.select(".dimlabel");n.text(function(e,t){return 0===t?e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel:null});var l=i.select(".catlabel");l.attr("text-anchor",function(e){return o(e)?"start":"end"}).attr("x",function(e){return o(e)?e.width+5:-5}).each(function(e){var t,a;o(e)?(t=e.width+5,a="start"):(t=-5,a="end"),j.select(this).selectAll("tspan").attr("x",t).attr("text-anchor",a)});var s=i.selectAll("rect.bandrect").data(function(e){return e.bands},r),d=s.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);s.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y}),m(d),s.each(function(){N.raiseToTop(this)}),s.exit().remove()}function P(e,t,a){var r=a[0],o=t.margin||{l:80,r:80,t:100,b:80},i=r.trace,n=i.domain,l=t.width,s=t.height,d=ba(l*(n.x[1]-n.x[0])),c=ba(s*(n.y[1]-n.y[0])),p=n.x[0]*l+o.l,u=t.height-n.y[1]*t.height+o.t,g=i.line.shape,h;h="all"===i.hoverinfo?["count","probability"]:(i.hoverinfo||"").split("+");var m={trace:i,key:i.uid,model:r,x:p,y:u,width:d,height:c,hoveron:i.hoveron,hoverinfoItems:h,arrangement:i.arrangement,bundlecolors:i.bundlecolors,sortpaths:i.sortpaths,labelfont:i.labelfont,categorylabelfont:i.tickfont,pathShape:g,dragDimension:null,margin:o,paths:[],dimensions:[],graphDiv:e,traceSelection:null,pathSelection:null,dimensionSelection:null};return r.dimensions&&(R(m),O(m)),m}function D(e,t,a,r,o){var i=[],n=[],l,s;for(s=0;s<a.length-1;s++)l=j.interpolateNumber(a[s]+e[s],e[s+1]),i.push(l(o)),n.push(l(1-o));var c="M "+e[0]+","+t[0];for(c+="l"+a[0]+",0 ",s=1;s<a.length;s++)c+="C"+i[s-1]+","+t[s-1]+" "+n[s-1]+","+t[s]+" "+e[s]+","+t[s],c+="l"+a[s]+",0 ";for(c+="l0,"+r+" ",c+="l -"+a[a.length-1]+",0 ",s=a.length-2;0<=s;s--)c+="C"+n[s]+","+(t[s+1]+r)+" "+i[s]+","+(t[s]+r)+" "+(e[s]+a[s])+","+(t[s]+r),c+="l-"+a[s]+",0 ";return c+="Z",c}function O(e){function t(e){var t=e.categoryInds.map(function(e,t){return i[t][e]}),a=l.map(function(e){return t[e]});return a}var a=e.dimensions,r=e.model,o=a.map(function(e){return e.categories.map(function(e){return e.y})}),i=e.model.dimensions.map(function(e){return e.categories.map(function(e){return e.displayInd})}),n=e.model.dimensions.map(function(e){return e.displayInd}),l=e.dimensions.map(function(e){return e.model.dimensionInd}),s=a.map(function(e){return e.x}),c=a.map(function(e){return e.width}),u=[];for(var g in r.paths)r.paths.hasOwnProperty(g)&&u.push(r.paths[g]);u.sort(function(a,r){var o=t(a),i=t(r);return"backward"===e.sortpaths&&(o.reverse(),i.reverse()),o.push(a.valueInds[0]),i.push(r.valueInds[0]),e.bundlecolors&&(o.unshift(a.rawColor),i.unshift(r.rawColor)),o<i?-1:o>i?1:0});for(var p=Array(u.length),h=a[0].model.count,m=a[0].categories.map(function(e){return e.height}).reduce(function(e,t){return e+t}),y=0;y<u.length;y++){var f=u[y],x;x=0<h?m*(f.count/h):0;for(var _=Array(o.length),b=0;b<f.categoryInds.length;b++){var v=f.categoryInds[b],k=i[b][v],w=n[b];_[w]=o[w][k],o[w][k]+=x;var T=e.dimensions[w].categories[k],A=T.bands.length,S=T.bands[A-1];if(S===void 0||f.rawColor!==S.rawColor){var C=S===void 0?0:S.y+S.height;T.bands.push({key:C,color:f.color,rawColor:f.rawColor,height:x,width:T.width,count:f.count,y:C,categoryViewModel:T,parcatsViewModel:e})}else{var L=T.bands[A-1];L.height+=x,L.count+=f.count}}var E;E="hspline"===e.pathShape?D(s,_,c,x,.5):D(s,_,c,x,0),p[y]={key:f.valueInds[0],model:f,height:x,leftXs:s,topYs:_,dimWidths:c,svgD:E,parcatsViewModel:e}}e.paths=p}function R(e){var t=e.model.dimensions.map(function(e){return{displayInd:e.displayInd,dimensionInd:e.dimensionInd}});t.sort(function(e,t){return e.displayInd-t.displayInd});var a=[];for(var r in t){var o=t[r].dimensionInd,i=e.model.dimensions[o];a.push(M(e,i))}e.dimensions=a}function M(e,t){var a=16,r=e.model.dimensions.length,o=t.displayInd,i,n,l;i=1<r?(e.width-80-a)/(r-1):0,n=40,l=n+i*o;var s=[],d=e.model.maxCats,c=t.categories.length,p=8,u=t.count,g=e.height-p*(d-1),h=(d-c)*p/2,m=t.categories.map(function(e){return{displayInd:e.displayInd,categoryInd:e.categoryInd}}),y,f,x,_,b;for(m.sort(function(e,t){return e.displayInd-t.displayInd}),b=0;b<c;b++)_=m[b].categoryInd,f=t.categories[_],y=0<u?f.count/u*g:0,x={key:f.valueInds[0],model:f,width:a,height:y,y:null===f.dragY?h:f.dragY,bands:[],parcatsViewModel:e},h=h+y+p,s.push(x);return{key:t.dimensionInd,x:null===t.dragX?l:t.dragX,y:0,width:a,model:t,categories:s,parcatsViewModel:e,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}var j=e("d3"),F=e("../../plot_api/plot_api"),B=e("../../components/fx"),N=e("../../lib"),V=e("../../components/drawing"),U=e("tinycolor2"),H=e("../../lib/svg_text_utils");t.exports=function(e,t,r,o){a(r,e,o,t)}},{"../../components/drawing":614,"../../components/fx":632,"../../lib":719,"../../lib/svg_text_utils":743,"../../plot_api/plot_api":754,d3:163,tinycolor2:537}],1073:[function(e,t){"use strict";var a=e("./parcats");t.exports=function(e,t,r,o){var i=e._fullLayout,n=i._paper,l=i._size;a(e,n,t,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},r,o)}},{"./parcats":1072}],1074:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),r=e("../../plots/cartesian/layout_attributes"),o=e("../../plots/font_attributes"),i=e("../../plots/domain").attributes,n=e("../../lib/extend").extendFlat,l=e("../../plot_api/plot_template").templatedArray;t.exports={domain:i({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:o({editType:"plot"}),tickfont:o({editType:"plot"}),rangefont:o({editType:"plot"}),dimensions:l("dimension",{label:{valType:"string",editType:"plot"},tickvals:n({},r.tickvals,{editType:"plot"}),ticktext:n({},r.ticktext,{editType:"plot"}),tickformat:n({},r.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:n({editType:"calc"},a("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":600,"../../lib/extend":710,"../../plot_api/plot_template":757,"../../plots/cartesian/layout_attributes":779,"../../plots/domain":792,"../../plots/font_attributes":793}],1075:[function(e,t){"use strict";function r(e,t){return e*(1-D)+t*D}function o(e,t){return e*(1-O)+t*O}function i(e,t,a,l){if(n(a,l))return a;var s=e?-1:1,d=0,c=t.length-1;if(0>s){var p=d;d=c,c=p}for(var u=t[d],g=u,h=d;s*h<s*c;h+=s){var m=h+s,y=t[m];if(s*a<s*o(u,y))return r(u,g);if(s*a<s*y||m===c)return r(y,u);g=u,u=y}}function n(e,t){for(var a=0;a<t.length;a++)if(e>=t[a][0]&&e<=t[a][1])return!0;return!1}function l(e){e.attr("x",-z.bar.captureWidth/2).attr("width",z.bar.captureWidth)}function s(e){e.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function d(e){if(!e.brush.filterSpecified)return"0,"+e.height;for(var t=u(e.brush.filter.getConsolidated(),e.height),a=[0],r=t.length?t[0][0]:null,o=0,n,l,s;o<t.length;o++)n=t[o],l=n[1]-n[0],a.push(r),a.push(l),s=o+1,s<t.length&&(r=t[s][0]-n[1]);return a.push(e.height),a}function u(e,t){return e.map(function(e){return e.map(function(e){return va(0,e*t)}).sort(P)})}function g(e,t){var a=z.bar.handleHeight;return t>e[1]+a||t<e[0]-a?void 0:t>=.9*e[1]+.1*e[0]?"n":t<=.9*e[0]+.1*e[1]?"s":"ns"}function h(){c.select(document.body).style("cursor",null)}function m(e){e.attr("stroke-dasharray",d)}function f(e,t){var a=c.select(e).selectAll(".highlight, .highlight-shadow"),r=t?a.transition().duration(z.bar.snapDuration).each("end",t):a;m(r)}function x(e,t){var r=e.brush,o=r.filterSpecified,n=NaN,l={},s;if(o){var d=e.height,c=r.filter.getConsolidated(),h=u(c,d),m=NaN,y=NaN,f=NaN;for(s=0;s<=h.length;s++){var x=h[s];if(x&&x[0]<=t&&t<=x[1]){m=s;break}else if(y=s?s-1:NaN,x&&x[0]>t){f=s;break}}if(n=m,isNaN(n)&&(isNaN(y)||isNaN(f)?n=isNaN(y)?f:y:n=t-h[y][1]<h[f][0]-t?y:f),!isNaN(n)){var p=h[n],_=g(p,t);_&&(l.interval=c[n],l.intervalPix=p,l.region=_)}}if(e.ordinal&&!l.region){var b=e.unitTickvals,a=e.unitToPaddedPx.invert(t);for(s=0;s<b.length;s++){var v=[.25*b[va(s-1,0)]+.75*b[s],.25*b[ea(s+1,b.length-1)]+.75*b[s]];if(a>=v[0]&&a<=v[1]){l.clickableOrdinalRange=v;break}}}return l}function _(e,t){c.event.sourceEvent.stopPropagation();var a=t.height-c.mouse(e)[1]-2*z.verticalPadding,r=t.unitToPaddedPx.invert(a),o=t.brush,i=x(t,a),n=i.interval,l=o.svgBrush;if(l.wasDragged=!1,l.grabbingBar="ns"===i.region,l.grabbingBar){var s=n.map(t.unitToPaddedPx);l.grabPoint=a-s[0]-z.verticalPadding,l.barLength=s[1]-s[0]}l.clickableOrdinalRange=i.clickableOrdinalRange,l.stayingIntervals=t.multiselect&&o.filterSpecified?o.filter.getConsolidated():[],n&&(l.stayingIntervals=l.stayingIntervals.filter(function(e){return e[0]!==n[0]&&e[1]!==n[1]})),l.startExtent=i.region?n["s"===i.region?1:0]:r,t.parent.inBrushDrag=!0,l.brushStartCallback()}function b(e,t){c.event.sourceEvent.stopPropagation();var a=t.height-c.mouse(e)[1]-2*z.verticalPadding,r=t.brush.svgBrush;r.wasDragged=!0,r._dragging=!0,r.newExtent=r.grabbingBar?[a-r.grabPoint,a+r.barLength-r.grabPoint].map(t.unitToPaddedPx.invert):[r.startExtent,t.unitToPaddedPx.invert(a)].sort(P),t.brush.filterSpecified=!0,r.extent=r.stayingIntervals.concat([r.newExtent]),r.brushCallback(t),f(e.parentNode)}function v(t,r){var o=r.brush,n=o.filter,l=o.svgBrush;l._dragging||(k(t,r),b(t,r),r.brush.svgBrush.wasDragged=!1),l._dragging=!1;var s=c.event;s.sourceEvent.stopPropagation();var e=l.grabbingBar;if(l.grabbingBar=!1,l.grabLocation=void 0,r.parent.inBrushDrag=!1,h(),!l.wasDragged)return l.wasDragged=void 0,l.clickableOrdinalRange?o.filterSpecified&&r.multiselect?l.extent.push(l.clickableOrdinalRange):(l.extent=[l.clickableOrdinalRange],o.filterSpecified=!0):e?(l.extent=l.stayingIntervals,0===l.extent.length&&C(o)):C(o),l.brushCallback(r),f(t.parentNode),void l.brushEndCallback(o.filterSpecified?n.getConsolidated():[]);var d=function(){n.set(n.getConsolidated())};if(r.ordinal){var p=r.unitTickvals;p[p.length-1]<p[0]&&p.reverse(),l.newExtent=[i(0,p,l.newExtent[0],l.stayingIntervals),i(1,p,l.newExtent[1],l.stayingIntervals)];var a=l.newExtent[1]>l.newExtent[0];l.extent=l.stayingIntervals.concat(a?[l.newExtent]:[]),l.extent.length||C(o),l.brushCallback(r),a?f(t.parentNode,d):(d(),f(t.parentNode))}else d();l.brushEndCallback(o.filterSpecified?n.getConsolidated():[])}function k(e,t){var a=t.height-c.mouse(e)[1]-2*z.verticalPadding,r=x(t,a),o="crosshair";r.clickableOrdinalRange?o="pointer":r.region&&(o=r.region+"-resize"),c.select(document.body).style("cursor",o)}function w(e){e.on("mousemove",function(e){c.event.preventDefault(),e.parent.inBrushDrag||k(this,e)}).on("mouseleave",function(e){e.parent.inBrushDrag||h()}).call(c.behavior.drag().on("dragstart",function(e){_(this,e)}).on("drag",function(e){b(this,e)}).on("dragend",function(e){v(this,e)}))}function T(e,t){return e[0]-t[0]}function A(e){var t=e.selectAll(".background").data(p);t.enter().append("rect").classed("background",!0).call(l).call(s).style("pointer-events","auto").attr("transform","translate(0 "+z.verticalPadding+")"),t.call(w).attr("height",function(e){return e.height-z.verticalPadding});var a=e.selectAll(".highlight-shadow").data(p);a.enter().append("line").classed("highlight-shadow",!0).attr("x",-z.bar.width/2).attr("stroke-width",z.bar.width+z.bar.strokeWidth).attr("stroke",z.bar.strokeColor).attr("opacity",z.bar.strokeOpacity).attr("stroke-linecap","butt"),a.attr("y1",function(e){return e.height}).call(m);var r=e.selectAll(".highlight").data(p);r.enter().append("line").classed("highlight",!0).attr("x",-z.bar.width/2).attr("stroke-width",z.bar.width-z.bar.strokeWidth).attr("stroke",z.bar.fillColor).attr("opacity",z.bar.fillOpacity).attr("stroke-linecap","butt"),r.attr("y1",function(e){return e.height}).call(m)}function S(e){return e.svgBrush.extent.map(function(t){return t.slice()})}function C(e){e.filterSpecified=!1,e.svgBrush.extent=[[-Infinity,1/0]]}function L(e){return function(t){var a=t.brush,r=S(a),o=r.slice();a.filter.set(o),e()}}function E(e){for(var t=e.slice(),a=[],r=t.shift(),o;r;){for(o=r.slice();(r=t.shift())&&r[0]<=o[1];)o[1]=va(o[1],r[1]);a.push(o)}return a}function I(){var e=[],t,r;return{set:function(o){e=o.map(function(e){return e.slice().sort(P)}).sort(T),1===e.length&&e[0][0]===-Infinity&&e[0][1]===1/0&&(e=[[0,-1]]),t=E(e),r=e.reduce(function(e,t){return[ea(e[0],t[0]),va(e[1],t[1])]},[1/0,-Infinity])},get:function(){return e.slice()},getConsolidated:function(){return t},getBounds:function(){return r}}}var z=e("./constants"),c=e("d3"),a=e("../../lib/gup").keyFun,p=e("../../lib/gup").repeat,P=e("../../lib").sorterAsc,D=z.bar.snapRatio,O=z.bar.snapClose;t.exports={makeBrush:function(e,t,a,r,o,i){var n=I();return n.set(a),{filter:n,filterSpecified:t,svgBrush:{extent:[],brushStartCallback:r,brushCallback:L(o),brushEndCallback:i}}},ensureAxisBrush:function(e){var t=e.selectAll("."+z.cn.axisBrush).data(p,a);t.enter().append("g").classed(z.cn.axisBrush,!0),A(t)},cleanRanges:function(e,t){if(Array.isArray(e[0])?(e=e.map(function(e){return e.sort(P)}),e=t.multiselect?E(e.sort(T)):[e[0]]):e=[e.sort(P)],t.tickvals){var a=t.tickvals.slice().sort(P);if(e=e.map(function(e){var t=[i(0,a,e[0],[]),i(1,a,e[1],[])];if(t[1]>t[0])return t}).filter(function(e){return e}),!e.length)return}return 1<e.length?e:e[0]}}},{"../../lib":719,"../../lib/gup":717,"./constants":1078,d3:163}],1076:[function(e,t,a){"use strict";var r=e("d3"),o=e("../../plots/get_data").getModuleCalcData,i=e("./plot"),n=e("../../constants/xmlns_namespaces");a.name="parcoords",a.plot=function(e){var t=o(e.calcdata,"parcoords")[0];t.length&&i(e,t)},a.clean=function(e,t,a,r){var o=r._has&&r._has("parcoords"),i=t._has&&t._has("parcoords");o&&!i&&(r._paperdiv.selectAll(".parcoords").remove(),r._glimages.selectAll("*").remove())},a.toSVG=function(e){var t=e._fullLayout._glimages,a=r.select(e).selectAll(".svg-container"),o=a.filter(function(e,t){return t===a.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");o.each(function(){var e=this,a=e.toDataURL("image/png"),r=t.append("svg:image");r.attr({xmlns:n.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})}),window.setTimeout(function(){r.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":696,"../../plots/get_data":802,"./plot":1085,d3:163}],1077:[function(e,t){"use strict";function a(e){for(var t=Array(e),a=0;a<e;a++)t[a]=.5;return t}var r=e("../../lib").isArrayOrTypedArray,o=e("../../components/colorscale"),i=e("../../lib/gup").wrap;t.exports=function(e,t){var n,l;return o.hasColorscale(t,"line")&&r(t.line.color)?(n=t.line.color,l=o.extractOpts(t.line).colorscale,o.calc(e,t,{vals:n,containerStr:"line",cLetter:"c"})):(n=a(t._length),l=[[0,t.line.color],[1,t.line.color]]),i({lineColor:n,cscale:l})}},{"../../components/colorscale":605,"../../lib":719,"../../lib/gup":717}],1078:[function(e,t){"use strict";t.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1079:[function(e,t){"use strict";function a(e,t,a,r,l){var s=l("line.color",a);if(i(e,"line")&&o.isArrayOrTypedArray(s)){if(s.length)return l("line.colorscale"),n(e,t,r,l,{prefix:"line.",cLetter:"c"}),s.length;t.line.color=a}return 1/0}function r(e,t,a,r){function i(a,r){return o.coerce(e,t,c.dimensions,a,r)}var n=i("values"),l=i("visible");if(n&&n.length||(l=t.visible=!1),l){i("label"),i("tickvals"),i("ticktext"),i("tickformat");var s=i("range");t._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:s},d.setConvert(t._ax,r.layout),i("multiselect");var u=i("constraintrange");u&&(t.constraintrange=p.cleanRanges(u,t))}}var o=e("../../lib"),i=e("../../components/colorscale/helpers").hasColorscale,n=e("../../components/colorscale/defaults"),l=e("../../plots/domain").defaults,s=e("../../plots/array_container_defaults"),d=e("../../plots/cartesian/axes"),c=e("./attributes"),p=e("./axisbrush"),u=e("./constants").maxDimensionCount,g=e("./merge_length");t.exports=function(e,t,i,n){function d(a,r){return o.coerce(e,t,c,a,r)}var p=e.dimensions;Array.isArray(p)&&p.length>u&&(o.log("parcoords traces support up to "+u+" dimensions at the moment"),p.splice(u));var h=s(e,t,{name:"dimensions",layout:n,handleItemDefaults:r}),m=a(e,t,i,n,d);l(t,n,d),Array.isArray(h)&&h.length||(t.visible=!1),g(t,h,"values",m);var y={family:n.font.family,size:V(n.font.size/1.2),color:n.font.color};o.coerceFont(d,"labelfont",y),o.coerceFont(d,"tickfont",y),o.coerceFont(d,"rangefont",y),d("labelangle"),d("labelside")}},{"../../components/colorscale/defaults":603,"../../components/colorscale/helpers":604,"../../lib":719,"../../plots/array_container_defaults":763,"../../plots/cartesian/axes":767,"../../plots/domain":792,"./attributes":1074,"./axisbrush":1075,"./constants":1078,"./merge_length":1083}],1080:[function(e,t,a){"use strict";var r=e("../../lib").isTypedArray;a.convertTypedArray=function(e){return r(e)?Array.prototype.slice.call(e):e},a.isOrdinal=function(e){return!!e.tickvals},a.isVisible=function(e){return e.visible||!("visible"in e)}},{"../../lib":719}],1081:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:e("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1074,"./base_plot":1076,"./calc":1077,"./defaults":1079,"./plot":1085}],1082:[function(e,t){"use strict";function a(e){e.read({x:0,y:0,width:1,height:1,data:C})}function r(e,t,a,r,o){var i=e._gl;i.enable(i.SCISSOR_TEST),i.scissor(t,a,r,o),e.clear({color:[0,0,0,0],depth:1})}function o(e,t,o,i,n,l){function s(a){var c=ea(i,n-a*i);0===a&&(window.cancelAnimationFrame(o.currentRafs[d]),delete o.currentRafs[d],r(e,l.scissorX,l.scissorY,l.scissorWidth,l.viewBoxSize[1]));o.clearOnly||(l.count=2*c,l.offset=2*a*i,t(l),a*i+c<n&&(o.currentRafs[d]=window.requestAnimationFrame(function(){s(a+1)})),o.drawCompleted=!1)}var d=l.key;o.drawCompleted||(a(e),o.drawCompleted=!0),s(0)}function l(e){return va(A,ea(1-A,e))}function s(e,t){for(var a=Array(256),r=0;256>r;r++)a[r]=e(r/255).concat(t);return a}function d(e,t){return(e>>>8*t)%256/255}function c(e,t,a){for(var r=Array(e*(w+4)),o=0,s=0;s<e;s++){for(var c=0;c<w;c++)r[o++]=c<t.length?t[c].paddedUnitValues[s]:.5;r[o++]=d(s,2),r[o++]=d(s,1),r[o++]=d(s,0),r[o++]=l(a[s])}return r}function p(e,t,a){for(var r=Array(8*t),o=0,l=0;l<t;l++)for(var s=0;2>s;s++)for(var d=0;4>d;d++){var c=4*e+d,p=a[64*l+c];63==c&&0==s&&(p*=-1),r[o++]=p}return r}function u(e){var t="0"+e;return t.substr(t.length-2)}function g(e){return e<w?"p"+u(e+1)+"_"+u(e+4):"colors"}function h(e,t,a){for(var r=0;r<=w;r+=4)e[g(r)](p(r/4,t,a))}function m(e){for(var t={},a=0;a<=w;a+=4)t[g(a)]=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return t}function f(e,t,a,r,o,i,n,l,s,d,c,p,u){for(var g=[[],[]],h=0;64>h;h++)g[0][h]=h===o?1:0,g[1][h]=h===i?1:0;var m=e.lines.canvasOverdrag,y=e.domain,f=e.canvasWidth,x=e.canvasHeight,_=e.deselectedLines.color,b=T.extendFlat({key:c,resolution:[f,x],viewBoxPos:[n+m,l],viewBoxSize:[s,d],i0:o,i1:i,dim0A:g[0].slice(0,16),dim0B:g[0].slice(16,32),dim0C:g[0].slice(32,48),dim0D:g[0].slice(48,64),dim1A:g[1].slice(0,16),dim1B:g[1].slice(16,32),dim1C:g[1].slice(32,48),dim1D:g[1].slice(48,64),drwLayer:p,contextColor:[_[0]/255,_[1]/255,_[2]/255,1>_[3]?_[3]:va(1/255,ya(1/e.lines.color.length,1/3))],scissorX:(r===t?0:n+m)+(e.pad.l-m)+e.layoutWidth*y.x[0],scissorWidth:(r===a?f-n+m:s+.5)+(r===t?n+m:0),scissorY:l+e.pad.b+e.layoutHeight*y.y[0],scissorHeight:d,viewportX:e.pad.l-m+e.layoutWidth*y.x[0],viewportY:e.pad.b+e.layoutHeight*y.y[0],viewportWidth:f,viewportHeight:x},u);return b}function x(e){var t=va(0,ba(e[0]*2047),0),a=ea(2047,M(e[1]*2047),2047);return[ea(t,a),va(t,a)]}var _=e("glslify"),b=_(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform sampler2D mask, palette;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(mask,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),v=_(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),w=e("./constants").maxDimensionCount,T=e("../../lib"),A=1e-6,S=2048,C=new Uint8Array(4),L=new Uint8Array(4),E={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};t.exports=function(e,t){function a(e){I=e.model,z=e.viewModel,y=z.dimensions.slice(),P=y[0]?y[0].values.length:0;var t=I.lines,a=g?t.color.map(function(e,a){return a/t.color.length}):t.color,r=c(P,y,a);h(w,P,r),u||g||(A=_.texture(T.extendFlat({data:s(I.unitToColor,255)},E)))}function n(e){var t=[[],[]],a,r,o;for(o=0;64>o;o++){var n=!e&&o<y.length?y[o].brush.filter.getBounds():[-Infinity,1/0];t[0][o]=n[0],t[1][o]=n[1]}var l=8*S,s=Array(l);for(a=0;a<l;a++)s[a]=255;if(!e)for(a=0;a<y.length;a++){var d=a%8,c=(a-d)/8,p=ya(2,d),u=y[a],g=u.brush.filter.get();if(!(2>g.length)){var h=x(g[0])[1];for(r=1;r<g.length;r++){var m=x(g[r]);for(o=h+1;o<m[0];o++)s[8*o+c]&=~p;h=va(h,m[1])}}}var f={shape:[8,S],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:s};return D?D(f):D=_.texture(f),{maskTexture:D,maskHeight:S,loA:t[0].slice(0,16),loB:t[0].slice(16,32),loC:t[0].slice(32,48),loD:t[0].slice(48,64),hiA:t[1].slice(0,16),hiB:t[1].slice(16,32),hiC:t[1].slice(32,48),hiD:t[1].slice(48,64)}}function l(e,t,a){var l=e.length,s=1/0,d=-Infinity,c,h,m;for(c=0;c<l;c++)e[c].dim0.canvasX<s&&(s=e[c].dim0.canvasX,h=c),e[c].dim1.canvasX>d&&(d=e[c].dim1.canvasX,m=c);0===l&&r(_,0,0,I.canvasWidth,I.canvasHeight);var b=n(u);for(c=0;c<l;c++){var v=e[c],p=v.dim0.crossfilterDimensionIndex,w=v.dim1.crossfilterDimensionIndex,T=v.canvasX,x=v.canvasY,y=T+v.panelSizeX;if(t||!C[p]||C[p][0]!==T||C[p][1]!==y){C[p]=[T,y];var A=f(I,h,m,c,p,w,T,x,v.panelSizeX,v.panelSizeY,v.dim0.crossfilterDimensionIndex,u?0:g?2:1,b);k.clearOnly=a;var S=t?I.lines.blockLineCount:P;o(_,O,k,S,P,A)}}}function d(){for(var t in e.style["pointer-events"]="none",A.destroy(),D&&D.destroy(),w)w[t].destroy()}var u=t.context,g=t.pick,_=t.regl,k={currentRafs:{},drawCompleted:!0,clearOnly:!1},w=m(_),A=_.texture(E),C=[],I,z,y,P,D;a(t);var O=_({profile:!1,blend:{enable:u,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!u,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:_.prop("scissorX"),y:_.prop("scissorY"),width:_.prop("scissorWidth"),height:_.prop("scissorHeight")}},viewport:{x:_.prop("viewportX"),y:_.prop("viewportY"),width:_.prop("viewportWidth"),height:_.prop("viewportHeight")},dither:!1,vert:b,frag:v,primitive:"lines",lineWidth:1,attributes:w,uniforms:{resolution:_.prop("resolution"),viewBoxPos:_.prop("viewBoxPos"),viewBoxSize:_.prop("viewBoxSize"),dim0A:_.prop("dim0A"),dim1A:_.prop("dim1A"),dim0B:_.prop("dim0B"),dim1B:_.prop("dim1B"),dim0C:_.prop("dim0C"),dim1C:_.prop("dim1C"),dim0D:_.prop("dim0D"),dim1D:_.prop("dim1D"),loA:_.prop("loA"),hiA:_.prop("hiA"),loB:_.prop("loB"),hiB:_.prop("hiB"),loC:_.prop("loC"),hiC:_.prop("hiC"),loD:_.prop("loD"),hiD:_.prop("hiD"),palette:A,contextColor:_.prop("contextColor"),mask:_.prop("maskTexture"),drwLayer:_.prop("drwLayer"),maskHeight:_.prop("maskHeight")},offset:_.prop("offset"),count:_.prop("count")});return{render:l,readPixel:function(e,t){return _.read({x:e,y:t,width:1,height:1,data:L}),L},readPixels:function(e,t,a,r){var o=new Uint8Array(4*a*r);return _.read({x:e,y:t,width:a,height:r,data:o}),o},destroy:d,update:a}}},{"../../lib":719,"./constants":1078,glslify:409}],1083:[function(e,t){"use strict";t.exports=function(e,t,a,r){r||(r=1/0);var o,n;for(o=0;o<t.length;o++)n=t[o],n.visible&&(r=ea(r,n[a].length));for(r===1/0&&(r=0),e._length=r,o=0;o<t.length;o++)n=t[o],n.visible&&(n._length=r);return r}},{}],1084:[function(e,t){"use strict";function a(e,t,a){return S.aggNums(e,null,t,a)}function r(e,t){return i(a(Math.min,e,t),a(Math.max,e,t))}function o(e){var t=e.range;return t?i(t[0],t[1]):r(e.values,e._length)}function i(e,t){return(isNaN(e)||!isFinite(e))&&(e=0),(isNaN(t)||!isFinite(t))&&(t=0),e===t&&(0===e?(e-=1,t+=1):(e*=.9,t*=1.1)),[e,t]}function n(e,t){return t?function(a,r){var o=t[r];return null===o||void 0===o?e(a):o}:e}function l(e,t,a,r,i){var l=o(a);return r?T.scale.ordinal().domain(r.map(n(T.format(a.tickformat),i))).range(r.map(function(a){var r=(a-l[0])/(l[1]-l[0]);return e-t+r*(2*t-e)})):T.scale.linear().domain(l).range([e-t,t])}function s(e,t){return T.scale.linear().range([t,e-t])}function d(e,t){return T.scale.linear().domain(o(e)).range([t,1-t])}function p(e){if(e.tickvals){var t=o(e);return T.scale.ordinal().domain(e.tickvals).range(e.tickvals.map(function(e){return(e-t[0])/(t[1]-t[0])}))}}function u(e){var t=e.map(function(e){return e[0]}),a=e.map(function(e){var t=v(e[1]);return T.rgb("rgb("+t[0]+","+t[1]+","+t[2]+")")}),r=function(e){return function(t){return t[e]}},o=["r","g","b"].map(function(e){return T.scale.linear().clamp(!0).domain(t).range(a.map(r(e)))});return function(e){return o.map(function(t){return t(e)})}}function g(e){return e.dimensions.some(function(e){return e.brush.filterSpecified})}function h(e,t,a){var r=D(t),i=r.trace,n=O.convertTypedArray(r.lineColor),l=i.line,s={color:v(M.deselectedLineColor)},d=E.extractOpts(l),c=d.reversescale?E.flipScale(r.cscale):r.cscale,p=i.domain,g=i.dimensions,h=e.width,m=i.labelangle,y=i.labelside,f=i.labelfont,x=i.tickfont,_=i.rangefont,b=S.extendDeepNoArrays({},l,{color:n.map(T.scale.linear().domain(o({values:n,range:[d.min,d.max],_length:i._length}))),blockLineCount:M.blockLineCount,canvasOverdrag:M.overdrag*M.canvasPixelRatio}),k=ba(h*(p.x[1]-p.x[0])),w=ba(e.height*(p.y[1]-p.y[0])),A=e.margin||{l:80,r:80,t:100,b:80},C=k,L=w;return{key:a,colCount:g.filter(O.isVisible).length,dimensions:g,tickDistance:M.tickDistance,unitToColor:u(c),lines:b,deselectedLines:s,labelAngle:m,labelSide:y,labelFont:f,tickFont:x,rangeFont:_,layoutWidth:h,layoutHeight:e.height,domain:p,translateX:p.x[0]*h,translateY:e.height-p.y[1]*e.height,pad:A,canvasWidth:C*M.canvasPixelRatio+2*b.canvasOverdrag,canvasHeight:L*M.canvasPixelRatio,width:C,height:L,canvasPixelRatio:M.canvasPixelRatio}}function m(e,t,a){var r=a.width,o=a.height,i=a.dimensions,n=a.canvasPixelRatio,u=function(e){return r*e/va(1,a.colCount-1)},h=M.verticalPadding/o,m=s(o,M.verticalPadding),y={key:a.key,xScale:u,model:a,inBrushDrag:!1},f={};return y.dimensions=i.filter(O.isVisible).map(function(r,s){function i(e,t){return{val:e,text:I[t]}}function x(e,t){return e.val-t.val}var _=d(r,h),b=f[r.label];f[r.label]=(b||0)+1;var v=r.label+(b?"__"+b:""),w=r.constraintrange,A=w&&w.length;A&&!Array.isArray(w[0])&&(w=[w]);var C=A?w.map(function(e){return e.map(_)}):[[-Infinity,1/0]],L=r.values;L.length>r._length&&(L=L.slice(0,r._length));var E=r.tickvals,I;if(Array.isArray(E)&&E.length){I=r.ticktext,Array.isArray(I)&&I.length?I.length>E.length?I=I.slice(0,E.length):E.length>I.length&&(E=E.slice(0,I.length)):I=E.map(T.format(r.tickformat));for(var z=1;z<E.length;z++)if(E[z]<E[z-1]){for(var P=E.map(i).sort(x),D=0;D<E.length;D++)E[D]=P[D].val,I[D]=P[D].text;break}}else E=void 0;return L=O.convertTypedArray(L),L=O.convertTypedArray(L),{key:v,label:r.label,tickFormat:r.tickformat,tickvals:E,ticktext:I,ordinal:O.isOrdinal(r),multiselect:r.multiselect,xIndex:s,crossfilterDimensionIndex:s,visibleIndex:r._index,height:o,values:L,paddedUnitValues:L.map(_),unitTickvals:E&&E.map(_),xScale:u,x:u(s),canvasX:u(s)*n,unitToPaddedPx:m,domainScale:l(o,M.verticalPadding,r,E,I),ordinalScale:p(r),parent:y,model:a,brush:c.makeBrush(e,A,C,function(){e.linePickActive(!1)},function(){var t=y;t.focusLayer&&t.focusLayer.render(t.panels,!0);var a=g(t);!e.contextShown()&&a?(t.contextLayer&&t.contextLayer.render(t.panels,!0),e.contextShown(!0)):e.contextShown()&&!a&&(t.contextLayer&&t.contextLayer.render(t.panels,!0,!0),e.contextShown(!1))},function(a){if(y.focusLayer.render(y.panels,!0),y.pickLayer&&y.pickLayer.render(y.panels,!0),e.linePickActive(!0),t&&t.filterChanged){var o=_.invert,i=a.map(function(e){return e.map(o).sort(S.sorterAsc)}).sort(function(e,t){return e[0]-t[0]});t.filterChanged(y.key,r._index,i)}})}}),y}function y(e){e.classed(M.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default").style("user-select","none")}function f(){var e=!0,t=!1;return{linePickActive:function(t){return arguments.length?e=!!t:e},contextShown:function(e){return arguments.length?t=!!e:t}}}function x(e,t){var a="top"===t?1:-1,r=e*Pe/180,o=De(r),i=R(r);return{dir:a,dx:o,dy:i,degrees:e}}function _(e,t){for(var a=t.panels||(t.panels=[]),r=e.data(),o=0;o<r.length-1;o++){var n=a[o]||(a[o]={}),l=r[o],s=r[o+1];n.dim0=l,n.dim1=s,n.canvasX=l.canvasX,n.panelSizeX=s.canvasX-l.canvasX,n.panelSizeY=t.model.canvasHeight,n.y=0,n.canvasY=0}}function b(e){for(var t=0;t<e.length;t++)for(var a=0;a<e[t].length;a++)for(var o=e[t][a].trace,n=o.dimensions,l=0;l<n.length;l++){var s=n[l].values,d=n[l]._ax;d&&(d.range=d.range?i(d.range[0],d.range[1]):r(s,o._length),!d.dtick&&(d.dtick=.01*(_a(d.range[1]-d.range[0])||1)),d.tickformat=n[l].tickformat,A.calcTicks(d),d.cleanRange())}}function k(e,t){return A.tickText(e._ax,t,!1).text}function w(e,t){if(e.ordinal)return"";var a=e.domainScale.domain(),r=a[t?a.length-1:0];return k(e.model.dimensions[e.visibleIndex],r)}var T=e("d3"),v=e("color-rgba"),A=e("../../plots/cartesian/axes"),S=e("../../lib"),C=e("../../lib/svg_text_utils"),L=e("../../components/drawing"),E=e("../../components/colorscale"),I=e("../../lib/gup"),z=I.keyFun,P=I.repeat,D=I.unwrap,O=e("./helpers"),M=e("./constants"),c=e("./axisbrush"),j=e("./lines");t.exports=function(t,e,a,r){var o=t._fullLayout,i=o._toppaper,n=o._glcontainer;b(e);var l=f(),s=e.filter(function(e){return D(e).trace.visible}).map(h.bind(0,a)).map(m.bind(0,l,r));n.each(function(e,t){return S.extendFlat(e,s[t])});var d=n.selectAll(".gl-canvas").each(function(e){e.viewModel=s[0],e.model=e.viewModel?e.viewModel.model:null}),p=null,u=d.filter(function(e){return e.pick});u.style("pointer-events","auto").on("mousemove",function(e){if(l.linePickActive()&&e.lineLayer&&r&&r.hover){var t=T.event,a=this.width,o=this.height,i=T.mouse(this),n=i[0],s=i[1];if(0>n||0>s||n>=a||s>=o)return;var d=e.lineLayer.readPixel(n,o-1-s),c=0!==d[3],u=c?d[2]+256*(d[1]+256*d[0]):null,g={x:n,y:s,clientX:t.clientX,clientY:t.clientY,dataIndex:e.model.key,curveNumber:u};u!==p&&(c?r.hover(g):r.unhover&&r.unhover(g),p=u)}}),d.style("opacity",function(e){return e.pick?0:1}),i.style("background","rgba(255, 255, 255, 0)");var v=i.selectAll("."+M.cn.parcoords).data(s,z);v.exit().remove(),v.enter().append("g").classed(M.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),v.attr("transform",function(e){return"translate("+e.model.translateX+","+e.model.translateY+")"});var A=v.selectAll("."+M.cn.parcoordsControlView).data(P,z);A.enter().append("g").classed(M.cn.parcoordsControlView,!0),A.attr("transform",function(e){return"translate("+e.model.pad.l+","+e.model.pad.t+")"});var E=A.selectAll("."+M.cn.yAxis).data(function(e){return e.dimensions},z);E.enter().append("g").classed(M.cn.yAxis,!0),A.each(function(e){_(E,e)}),d.each(function(e){if(e.viewModel){!e.lineLayer||r?e.lineLayer=j(this,e):e.lineLayer.update(e),(e.key||0===e.key)&&(e.viewModel[e.key]=e.lineLayer);var t=!e.context||r;e.lineLayer.render(e.viewModel.panels,t)}}),E.attr("transform",function(e){return"translate("+e.xScale(e.xIndex)+", 0)"}),E.call(T.behavior.drag().origin(function(e){return e}).on("drag",function(t){var a=t.parent;l.linePickActive(!1),t.x=va(-M.overdrag,ea(t.model.width+M.overdrag,T.event.x)),t.canvasX=t.x*t.model.canvasPixelRatio,E.sort(function(e,t){return e.x-t.x}).each(function(a,e){a.xIndex=e,a.x=t===a?a.x:a.xScale(a.xIndex),a.canvasX=a.x*a.model.canvasPixelRatio}),_(E,a),E.filter(function(a){return 0!==_a(t.xIndex-a.xIndex)}).attr("transform",function(e){return"translate("+e.xScale(e.xIndex)+", 0)"}),T.select(this).attr("transform","translate("+t.x+", 0)"),E.each(function(r,e,o){o===t.parent.key&&(a.dimensions[e]=r)}),a.contextLayer&&a.contextLayer.render(a.panels,!1,!g(a)),a.focusLayer.render&&a.focusLayer.render(a.panels)}).on("dragend",function(e){var t=e.parent;e.x=e.xScale(e.xIndex),e.canvasX=e.x*e.model.canvasPixelRatio,_(E,t),T.select(this).attr("transform",function(e){return"translate("+e.x+", 0)"}),t.contextLayer&&t.contextLayer.render(t.panels,!1,!g(t)),t.focusLayer&&t.focusLayer.render(t.panels),t.pickLayer&&t.pickLayer.render(t.panels,!0),l.linePickActive(!0),r&&r.axesMoved&&r.axesMoved(t.key,t.dimensions.map(function(t){return t.crossfilterDimensionIndex}))})),E.exit().remove();var I=E.selectAll("."+M.cn.axisOverlays).data(P,z);I.enter().append("g").classed(M.cn.axisOverlays,!0),I.selectAll("."+M.cn.axis).remove();var R=I.selectAll("."+M.cn.axis).data(P,z);R.enter().append("g").classed(M.cn.axis,!0),R.each(function(e){var t=e.model.height/e.model.tickDistance,a=e.domainScale,r=a.domain();T.select(this).call(T.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(t,e.tickFormat).tickValues(e.ordinal?r:null).tickFormat(function(t){return O.isOrdinal(e)?t:k(e.model.dimensions[e.visibleIndex],t)}).scale(a)),L.font(R.selectAll("text"),e.model.tickFont)}),R.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),R.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default").style("user-select","none");var F=I.selectAll("."+M.cn.axisHeading).data(P,z);F.enter().append("g").classed(M.cn.axisHeading,!0);var B=F.selectAll("."+M.cn.axisTitle).data(P,z);B.enter().append("text").classed(M.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("user-select","none").style("pointer-events","auto"),B.text(function(e){return e.label}).each(function(a){var r=T.select(this);L.font(r,a.model.labelFont),C.convertToTspans(r,t)}).attr("transform",function(e){var t=x(e.model.labelAngle,e.model.labelSide),a=M.axisTitleOffset;return(0<t.dir?"":"translate(0,"+(2*a+e.model.height)+")")+"rotate("+t.degrees+")translate("+-a*t.dx+","+-a*t.dy+")"}).attr("text-anchor",function(e){var t=x(e.model.labelAngle,e.model.labelSide),a=_a(t.dx),r=_a(t.dy);return 2*a>r?0>t.dir*t.dx?"start":"end":"middle"});var N=I.selectAll("."+M.cn.axisExtent).data(P,z);N.enter().append("g").classed(M.cn.axisExtent,!0);var V=N.selectAll("."+M.cn.axisExtentTop).data(P,z);V.enter().append("g").classed(M.cn.axisExtentTop,!0),V.attr("transform","translate(0,"+-M.axisExtentOffset+")");var U=V.selectAll("."+M.cn.axisExtentTopText).data(P,z);U.enter().append("text").classed(M.cn.axisExtentTopText,!0).call(y),U.text(function(e){return w(e,!0)}).each(function(e){L.font(T.select(this),e.model.rangeFont)});var H=N.selectAll("."+M.cn.axisExtentBottom).data(P,z);H.enter().append("g").classed(M.cn.axisExtentBottom,!0),H.attr("transform",function(e){return"translate(0,"+(e.model.height+M.axisExtentOffset)+")"});var G=H.selectAll("."+M.cn.axisExtentBottomText).data(P,z);G.enter().append("text").classed(M.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(y),G.text(function(e){return w(e,!1)}).each(function(e){L.font(T.select(this),e.model.rangeFont)}),c.ensureAxisBrush(I)}},{"../../components/colorscale":605,"../../components/drawing":614,"../../lib":719,"../../lib/gup":717,"../../lib/svg_text_utils":743,"../../plots/cartesian/axes":767,"./axisbrush":1075,"./constants":1078,"./helpers":1080,"./lines":1082,"color-rgba":122,d3:163}],1085:[function(e,t){"use strict";function a(e,t,a){var r=t.indexOf(a),o=e.indexOf(r);return-1===o&&(o+=t.length),o}function r(e,t){return function(r,o){return a(e,t,r)-a(e,t,o)}}var o=e("./parcoords"),i=e("../../lib/prepare_regl"),n=e("./helpers").isVisible;t.exports=function(e,t){var a=e._fullLayout,l=i(e);if(l){var s={},c={},p={},u={},g=a._size;t.forEach(function(t,a){var r=t[0].trace;p[a]=r.index;var o=u[a]=r._fullInput.index;s[a]=e.data[o].dimensions,c[a]=e.data[o].dimensions.slice()});var h=function(t,r,o){var i=c[t][r],n=o.map(function(e){return e.slice()}),l="dimensions["+r+"].constraintrange",s=a._tracePreGUI[e._fullData[p[t]]._fullInput.uid];if(void 0===s[l]){var d=i.constraintrange;s[l]=d||null}var g=e._fullData[p[t]].dimensions[r];n.length?(1===n.length&&(n=n[0]),i.constraintrange=n,g.constraintrange=n.slice(),n=[n]):(delete i.constraintrange,delete g.constraintrange,n=null);var h={};h[l]=n,e.emit("plotly_restyle",[h,[u[t]]])},m=function(t){e.emit("plotly_hover",t)},y=function(t){e.emit("plotly_unhover",t)},f=function(t,a){var o=r(a,c[t].filter(n));s[t].sort(o),c[t].filter(function(e){return!n(e)}).sort(function(e){return c[t].indexOf(e)}).forEach(function(e){s[t].splice(s[t].indexOf(e),1),s[t].splice(c[t].indexOf(e),0,e)}),e.emit("plotly_restyle",[{dimensions:[s[t]]},[u[t]]])};o(e,t,{width:g.w,height:g.h,margin:{t:g.t,r:g.r,b:g.b,l:g.l}},{filterChanged:h,hover:m,unhover:y,axesMoved:f})}}},{"../../lib/prepare_regl":732,"./helpers":1080,"./parcoords":1084}],1086:[function(e,t){"use strict";var a=e("../../plots/attributes"),r=e("../../plots/domain").attributes,o=e("../../plots/font_attributes"),i=e("../../components/color/attributes"),n=e("../../components/fx/hovertemplate_attributes"),l=e("../../lib/extend").extendFlat,s=o({editType:"plot",arrayOk:!0,colorEditType:"plot"});t.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:i.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:l({},a.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:n({},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:l({},s,{}),insidetextfont:l({},s,{}),outsidetextfont:l({},s,{}),title:{text:{valType:"string",dflt:"",editType:"plot"},font:l({},s,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:r({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:l({},s,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":592,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/font_attributes":793}],1087:[function(e,t,a){"use strict";var r=e("../../registry"),o=e("../../plots/get_data").getModuleCalcData;a.name="pie",a.plot=function(e){var t=r.getModule("pie"),a=o(e.calcdata,t)[0];t.plot(e,a)},a.clean=function(e,t,a,r){var o=r._has&&r._has("pie"),i=t._has&&t._has("pie");o&&!i&&r._pielayer.selectAll("g.trace").remove()}},{"../../plots/get_data":802,"../../registry":847}],1088:[function(e,t){"use strict";function a(e){return function(t,a){return!!t&&(t=l(t),!!t.isValid())&&(t=s.addOpacity(t,t.getAlpha()),e[a]||(e[a]=t),t)}}function r(e,t){var a=JSON.stringify(e),r=t[a],o;if(!r){for(r=e.slice(),o=0;o<e.length;o++)r.push(l(e[o]).lighten(20).toHexString());for(o=0;o<e.length;o++)r.push(l(e[o]).darken(20).toHexString());t[a]=r}return r}var o=e("fast-isnumeric"),n=e("../../lib").isArrayOrTypedArray,l=e("tinycolor2"),s=e("../../components/color"),d=e("./helpers"),c=e("../../lib").isValidTextValue,p={};t.exports={calc:function(e,t){var r=[],l=e._fullLayout,s=l.hiddenlabels||[],p=t.labels,u=t.marker.colors||[],g=t.values,h=n(g)&&g.length,m,y;if(t.dlabel)for(p=Array(g.length),m=0;m<g.length;m++)p[m]=t.label0+m*t.dlabel+"";var f={},x=a(l["_"+t.type+"colormap"]),_=(h?g:p).length,b=0,k=!1;for(m=0;m<_;m++){var w,T,A;if(h){if(w=g[m],!o(w))continue;if(w=+w,0>w)continue}else w=1;T=p[m],(T===void 0||""===T)&&(T=m),T=T+"";var S=f[T];S===void 0?(f[T]=r.length,A=-1!==s.indexOf(T),!A&&(b+=w),r.push({v:w,label:T,color:x(u[m],T),i:m,pts:[m],hidden:A})):(k=!0,y=r[S],y.v+=w,y.pts.push(m),!y.hidden&&(b+=w),!1===y.color&&u[m]&&(y.color=x(u[m],T)))}var C="funnelarea"===t.type?k:t.sort;C&&r.sort(function(e,t){return t.v-e.v}),r[0]&&(r[0].vTotal=b);var L=t.textinfo;if(L&&"none"!==L){var E=L.split("+"),I=function(e){return-1!==E.indexOf(e)},z=I("label"),P=I("text"),D=I("value"),O=I("percent"),R=l.separators,M;for(m=0;m<r.length;m++){if(y=r[m],M=z?[y.label]:[],P){var j=d.getFirstFilled(t.text,y.pts);c(j)&&M.push(j)}D&&M.push(d.formatPieValue(y.v,R)),O&&M.push(d.formatPiePercent(y.v/b,R)),y.text=M.join("<br>")}}return r},crossTraceCalc:function(e,t){var a=(t||{}).type;a||(a="pie");var o=e._fullLayout,n=e.calcdata,l=o[a+"colorway"],s=o["_"+a+"colormap"];o["extend"+a+"colors"]&&(l=r(l,p));for(var d=0,c=0;c<n.length;c++){var u=n[c],g=u[0].trace.type;if(g===a)for(var h=0,m;h<u.length;h++)m=u[h],!1===m.color&&(s[m.label]?m.color=s[m.label]:(s[m.label]=m.color=l[d%l.length],d++))}},makePullColorFn:a,generateExtendedColors:r}},{"../../components/color":593,"../../lib":719,"./helpers":1091,"fast-isnumeric":225,tinycolor2:537}],1089:[function(e,t){"use strict";var a=e("../../lib"),r=e("./attributes"),o=e("../../plots/domain").defaults,i=e("../bar/defaults").handleText;t.exports=function(e,t,n,l){function s(o,i){return a.coerce(e,t,r,o,i)}var d=s("values"),c=a.isArrayOrTypedArray(d),p=s("labels"),u;if(Array.isArray(p)?(u=p.length,c&&(u=ea(u,d.length))):c&&(u=d.length,s("label0"),s("dlabel")),!u)return void(t.visible=!1);t._length=u;var g=s("marker.line.width");g&&s("marker.line.color"),s("marker.colors"),s("scalegroup");var h=s("text"),m=s("textinfo",Array.isArray(h)?"text+percent":"percent");if(s("hovertext"),s("hovertemplate"),m&&"none"!==m){var y=s("textposition");i(e,t,l,s,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}o(t,l,s);var f=s("hole"),x=s("title.text");if(x){var _=s("title.position",f?"middle center":"top center");f||"middle center"!==_||(t.title.position="top center"),a.coerceFont(s,"title.font",l.font)}s("sort"),s("direction"),s("rotation"),s("pull")}},{"../../lib":719,"../../plots/domain":792,"../bar/defaults":861,"./attributes":1086}],1090:[function(e,t){"use strict";var a=e("../../components/fx/helpers").appendArrayMultiPointValues;t.exports=function(e,t){var r={curveNumber:t.index,pointNumbers:e.pts,data:t._input,fullData:t,label:e.label,color:e.color,value:e.v,percent:e.percent,text:e.text,v:e.v};return 1===e.pts.length&&(r.pointNumber=r.i=e.pts[0]),a(r,t,e.pts),"funnelarea"===t.type&&(delete r.v,delete r.i),r}},{"../../components/fx/helpers":628}],1091:[function(e,t,a){"use strict";var r=e("../../lib");a.formatPiePercent=function(e,t){var a=(100*e).toPrecision(3);return-1!==a.lastIndexOf(".")&&(a=a.replace(/[.]?0+$/,"")),r.numSeparate(a,t)+"%"},a.formatPieValue=function(e,t){var a=e.toPrecision(10);return-1!==a.lastIndexOf(".")&&(a=a.replace(/[.]?0+$/,"")),r.numSeparate(a,t)},a.getFirstFilled=function(e,t){if(Array.isArray(e))for(var a=0,r;a<t.length;a++)if(r=e[t[a]],r||0===r)return r},a.castOption=function(e,t){if(Array.isArray(e))return a.getFirstFilled(e,t);return e?e:void 0}},{"../../lib":719}],1092:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),layoutAttributes:e("./layout_attributes"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot").plot,style:e("./style"),styleOne:e("./style_one"),moduleType:"trace",name:"pie",basePlotModule:e("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1086,"./base_plot":1087,"./calc":1088,"./defaults":1089,"./layout_attributes":1093,"./layout_defaults":1094,"./plot":1095,"./style":1096,"./style_one":1097}],1093:[function(e,t){"use strict";t.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1094:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t){function o(o,i){return a.coerce(e,t,r,o,i)}o("hiddenlabels"),o("piecolorway",t.colorway),o("extendpiecolors")}},{"../../lib":719,"./layout_attributes":1093}],1095:[function(e,t){"use strict";function a(e,t){e.each(function(e){var a=_.select(this);if(!e.labelExtraX&&!e.labelExtraY)return void a.select("path.textline").remove();var r=a.select("g.slicetext text");r.attr("transform","translate("+e.labelExtraX+","+e.labelExtraY+")"+r.attr("transform"));var o=e.cxFinal+e.pxmid[0],i=e.cyFinal+e.pxmid[1],n="M"+o+","+i,l=(e.yLabelMax-e.yLabelMin)*(0>e.pxmid[0]?-1:1)/4;if(e.labelExtraX){var s=e.labelExtraX*e.pxmid[1]/e.pxmid[0],d=e.yLabelMid+e.labelExtraY-(e.cyFinal+e.pxmid[1]);n+=_a(s)>_a(d)?"l"+d*e.pxmid[0]/e.pxmid[1]+","+d+"H"+(o+e.labelExtraX+l):"l"+e.labelExtraX+","+s+"v"+(d-s)+"h"+l}else n+="V"+(e.yLabelMid+e.labelExtraY)+"h"+l;w.ensureSingle(a,"path","textline").call(v.stroke,t.outsidetextfont.color).attr({"stroke-width":ea(2,t.outsidetextfont.size/8),d:n,fill:"none"})})}function r(e,t,a){var r=a[0],o=r.trace,i=r.cx,n=r.cy;"_hasHoverLabel"in o||(o._hasHoverLabel=!1),"_hasHoverEvent"in o||(o._hasHoverEvent=!1),e.on("mouseover",function(e){var a=t._fullLayout,l=t._fullData[o.index];if(!(t._dragging||!1===a.hovermode)){var s=l.hoverinfo;if(Array.isArray(s)&&(s=b.castHoverinfo({hoverinfo:[A.castOption(s,e.pts)],_module:o._module},a,0)),"all"===s&&(s="label+text+value+percent+name"),l.hovertemplate||"none"!==s&&"skip"!==s&&s){var d=e.rInscribed||0,c=i+e.pxmid[0]*(1-d),p=n+e.pxmid[1]*(1-d),u=a.separators,g=[];if(s&&-1!==s.indexOf("label")&&g.push(e.label),e.text=A.castOption(l.hovertext||l.text,e.pts),s&&-1!==s.indexOf("text")){var h=e.text;w.isValidTextValue(h)&&g.push(h)}e.value=e.v,e.valueLabel=A.formatPieValue(e.v,u),s&&-1!==s.indexOf("value")&&g.push(e.valueLabel),e.percent=e.v/r.vTotal,e.percentLabel=A.formatPiePercent(e.percent,u),s&&-1!==s.indexOf("percent")&&g.push(e.percentLabel);var m=l.hoverlabel,y=m.font;b.loneHover({trace:o,x0:c-d*r.r,x1:c+d*r.r,y:p,text:g.join("<br>"),name:l.hovertemplate||-1!==s.indexOf("name")?l.name:void 0,idealAlign:0>e.pxmid[0]?"left":"right",color:A.castOption(m.bgcolor,e.pts)||e.color,borderColor:A.castOption(m.bordercolor,e.pts),fontFamily:A.castOption(y.family,e.pts),fontSize:A.castOption(y.size,e.pts),fontColor:A.castOption(y.color,e.pts),nameLength:A.castOption(m.namelength,e.pts),textAlign:A.castOption(m.align,e.pts),hovertemplate:A.castOption(l.hovertemplate,e.pts),hovertemplateLabels:e,eventData:[S(e,l)]},{container:a._hoverlayer.node(),outerContainer:a._paper.node(),gd:t}),o._hasHoverLabel=!0}o._hasHoverEvent=!0,t.emit("plotly_hover",{points:[S(e,l)],event:_.event})}}),e.on("mouseout",function(e){var a=t._fullLayout,r=t._fullData[o.index],i=_.select(this).datum();o._hasHoverEvent&&(e.originalEvent=_.event,t.emit("plotly_unhover",{points:[S(i,r)],event:_.event}),o._hasHoverEvent=!1),o._hasHoverLabel&&(b.loneUnhover(a._hoverlayer.node()),o._hasHoverLabel=!1)}),e.on("click",function(e){var a=t._fullLayout,r=t._fullData[o.index];t._dragging||!1===a.hovermode||(t._hoverdata=[S(e,r)],b.click(t,_.event))})}function o(e,t,a){var r=A.castOption(e.outsidetextfont.color,t.pts)||A.castOption(e.textfont.color,t.pts)||a.color,o=A.castOption(e.outsidetextfont.family,t.pts)||A.castOption(e.textfont.family,t.pts)||a.family,i=A.castOption(e.outsidetextfont.size,t.pts)||A.castOption(e.textfont.size,t.pts)||a.size;return{color:r,family:o,size:i}}function i(e,t,a){var r=A.castOption(e.insidetextfont.color,t.pts);!r&&e._input.textfont&&(r=A.castOption(e._input.textfont.color,t.pts));var o=A.castOption(e.insidetextfont.family,t.pts)||A.castOption(e.textfont.family,t.pts)||a.family,i=A.castOption(e.insidetextfont.size,t.pts)||A.castOption(e.textfont.size,t.pts)||a.size;return{color:r||v.contrast(t.color),family:o,size:i}}function n(e,t){for(var a=0,r,o;a<e.length;a++)if(r=e[a][0],o=r.trace,o.title.text){var n=o.title.text;o._meta&&(n=w.templateString(n,o._meta));var l=k.tester.append("text").attr("data-notex",1).text(n).call(k.font,o.title.font).call(T.convertToTspans,t),s=k.bBox(l.node(),!0);r.titleBox={width:s.width,height:s.height},l.remove()}}function l(e,t,a){var o=N(e.width*e.width+e.height*e.height),i=e.width/e.height,n=t.halfangle,l=t.ring,s=t.rInscribed,d=a.r||t.rpx1,r={scale:2*(s*d)/o,rCenter:1-s,rotate:0};if(1<=r.scale)return r;var c=i+1/(2*fa(n)),p=d*ea(1/(N(c*c+.5)+c),l/(N(i*i+l/2)+i)),u={scale:2*p/e.height,rCenter:R(p/d)-p*i/d,rotate:(180/Pe*t.midangle+720)%180-90},g=1/i,h=g+1/(2*fa(n)),m=d*ea(1/(N(h*h+.5)+h),l/(N(g*g+l/2)+g)),y={scale:2*m/e.width,rCenter:R(m/d)-m/i/d,rotate:(180/Pe*t.midangle+810)%180-90},f=y.scale>u.scale?y:u;return 1>r.scale&&f.scale>r.scale?f:r}function s(e,t){return e.v!==t.vTotal||t.trace.hole?ea(1/(1+1/De(e.halfangle)),e.ring/2):1}function d(e,t){var a=t.pxmid[0],r=t.pxmid[1],o=e.width/2,i=e.height/2;return 0>a&&(o*=-1),0>r&&(i*=-1),{scale:1,rCenter:1,rotate:0,x:o+_a(i)*(0<o?1:-1)/2,y:i/(1+a*a/(r*r)),outside:!0}}function c(e){var t=N(e.titleBox.width*e.titleBox.width+e.titleBox.height*e.titleBox.height);return{x:e.cx,y:e.cy,scale:2*(e.trace.hole*e.r)/t,tx:0,ty:-e.titleBox.height/2+e.trace.title.font.size}}function p(e,t){var a=1,r=1,o=e.trace,i={x:e.cx,y:e.cy},n={tx:0,ty:0},l;n.ty+=o.title.font.size,l=h(o),-1===o.title.position.indexOf("top")?-1!==o.title.position.indexOf("bottom")&&(i.y+=(1+l)*e.r):(i.y-=(1+l)*e.r,n.ty-=e.titleBox.height);var s=u(e.r,e.trace.aspectratio),d=t.w*(o.domain.x[1]-o.domain.x[0])/2;return-1===o.title.position.indexOf("left")?-1===o.title.position.indexOf("center")?-1!==o.title.position.indexOf("right")&&(d+=s,i.x+=(1+l)*s,n.tx-=e.titleBox.width/2):d*=2:(d+=s,i.x-=(1+l)*s,n.tx+=e.titleBox.width/2),a=d/e.titleBox.width,r=g(e,t)/e.titleBox.height,{x:i.x,y:i.y,scale:ea(a,r),tx:n.tx,ty:n.ty}}function u(e,t){return e/(t===void 0?1:t)}function g(e,t){var a=e.trace,r=t.h*(a.domain.y[1]-a.domain.y[0]);return ea(e.titleBox.height,r/2)}function h(e){var t=e.pull;if(!t)return 0;var a;if(Array.isArray(t))for(t=0,a=0;a<e.pull.length;a++)e.pull[a]>t&&(t=e.pull[a]);return t}function m(e,t){function a(e,t){return e.pxmid[1]-t.pxmid[1]}function r(e,t){return t.pxmid[1]-e.pxmid[1]}function o(e,a){a||(a={});var r=a.labelExtraY+(l?a.yLabelMax:a.yLabelMin),o=l?e.yLabelMin:e.yLabelMax,n=l?e.yLabelMax:e.yLabelMin,s=e.cyFinal+c(e.px0[1],e.px1[1]),g=r-o,h,y,f,x,_,b;if(0<g*u&&(e.labelExtraY=g),!!Array.isArray(t.pull))for(y=0;y<m.length;y++)(f=m[y],!(f===e||(A.castOption(t.pull,e.pts)||0)>=(A.castOption(t.pull,f.pts)||0)))&&(0<(e.pxmid[1]-f.pxmid[1])*u?(x=f.cyFinal+c(f.px0[1],f.px1[1]),g=x-o-e.labelExtraY,0<g*u&&(e.labelExtraY+=g)):0<(n+e.labelExtraY-s)*u&&(h=3*p*_a(y-m.indexOf(e)),_=f.cxFinal+d(f.px0[0],f.px1[0]),b=_+h-(e.cxFinal+e.pxmid[0])-e.labelExtraX,0<b*p&&(e.labelExtraX+=b)))}var n,l,s,d,c,p,u,g,h,m,y,f,x;for(l=0;2>l;l++)for(s=l?a:r,c=l?va:ea,u=l?1:-1,n=0;2>n;n++){for(d=n?va:ea,p=n?1:-1,g=e[l][n],g.sort(s),h=e[1-l][n],m=h.concat(g),f=[],y=0;y<g.length;y++)void 0!==g[y].yLabelMid&&f.push(g[y]);for(x=!1,y=0;l&&y<h.length;y++)if(void 0!==h[y].yLabelMid){x=h[y];break}for(y=0;y<f.length;y++){var _=y&&f[y-1];x&&!y&&(_=x),o(f[y],_)}}}function y(e,t){for(var a=[],r=0;r<e.length;r++){var o=e[r][0],n=o.trace,l=n.domain,s=t.w*(l.x[1]-l.x[0]),d=t.h*(l.y[1]-l.y[0]);n.title.text&&"middle center"!==n.title.position&&(d-=g(o,t));var c=d/2;"funnelarea"!==n.type||n.scalegroup||(c/=n.aspectratio),o.r=ea(s/2,c)/(1+h(n)),o.cx=t.l+t.w*(n.domain.x[1]+n.domain.x[0])/2,o.cy=t.t+t.h*(1-n.domain.y[0])-d/2,n.title.text&&-1!==n.title.position.indexOf("bottom")&&(o.cy-=g(o,t)),n.scalegroup&&-1===a.indexOf(n.scalegroup)&&a.push(n.scalegroup)}f(e,a)}function f(e,t){for(var a=0,r,o,n;a<t.length;a++){var l=1/0,s=t[a];for(o=0;o<e.length;o++)if(r=e[o][0],n=r.trace,n.scalegroup===s){var d;if("pie"===n.type)d=r.r*r.r;else if("funnelarea"===n.type){var c,p;1<n.aspectratio?(c=r.r,p=c/n.aspectratio):(p=r.r,c=p*n.aspectratio),c*=(1+n.baseratio)/2,d=c*p}l=ea(l,d/r.vTotal)}for(o=0;o<e.length;o++)if(r=e[o][0],n=r.trace,n.scalegroup===s){var u=l*r.vTotal;"funnelarea"===n.type&&(u/=(1+n.baseratio)/2,u/=n.aspectratio),r.r=N(u)}}}function x(e){function t(e){return[a.r*De(e),-a.r*R(e)]}var a=e[0],r=a.trace,o=r.rotation*Pe/180,n=2*Pe/a.vTotal,l="px0",d="px1",c,p,u;if("counterclockwise"===r.direction){for(c=0;c<e.length&&!!e[c].hidden;c++);if(c===e.length)return;o+=n*e[c].v,n*=-1,l="px1",d="px0"}for(u=t(o),c=0;c<e.length;c++)p=e[c],p.hidden||(p[l]=u,o+=n*p.v/2,p.pxmid=t(o),p.midangle=o,o+=n*p.v/2,u=t(o),p[d]=u,p.largeArc=p.v>a.vTotal/2?1:0,p.halfangle=Pe*ea(p.v/a.vTotal,.5),p.ring=1-r.hole,p.rInscribed=s(p,a))}var _=e("d3"),b=e("../../components/fx"),v=e("../../components/color"),k=e("../../components/drawing"),w=e("../../lib"),T=e("../../lib/svg_text_utils"),A=e("./helpers"),S=e("./event_data");t.exports={plot:function(e,t){var s=e._fullLayout;n(t,e),y(t,s._size);var u=w.makeTraceGroups(s._pielayer,t,"trace").each(function(t){var n=_.select(this),u=t[0],g=u.trace;x(t),n.attr("stroke-linejoin","round"),n.each(function(){var n=_.select(this).selectAll("g.slice").data(t);n.enter().append("g").classed("slice",!0),n.exit().remove();var h=[[[],[]],[[],[]]],y=!1;n.each(function(a){function n(e,t,r,o){var i=o*(t[0]-e[0]),n=o*(t[1]-e[1]);return"a"+o*u.r+","+o*u.r+" 0 "+a.largeArc+(r?" 1 ":" 0 ")+i+","+n}if(a.hidden)return void _.select(this).selectAll("path,g").remove();a.pointNumber=a.i,a.curveNumber=g.index,h[0>a.pxmid[1]?0:1][0>a.pxmid[0]?0:1].push(a);var s=u.cx,c=u.cy,p=_.select(this),m=p.selectAll("path.surface").data([a]);if(m.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),p.call(r,e,t),g.pull){var f=+A.castOption(g.pull,a.pts)||0;0<f&&(s+=f*a.pxmid[0],c+=f*a.pxmid[1])}a.cxFinal=s,a.cyFinal=c;var x=g.hole;if(a.v===u.vTotal){var b="M"+(s+a.px0[0])+","+(c+a.px0[1])+n(a.px0,a.pxmid,!0,1)+n(a.pxmid,a.px0,!0,1)+"Z";x?m.attr("d","M"+(s+x*a.px0[0])+","+(c+x*a.px0[1])+n(a.px0,a.pxmid,!1,x)+n(a.pxmid,a.px0,!1,x)+"Z"+b):m.attr("d",b)}else{var v=n(a.px0,a.px1,!0,1);if(x){var S=1-x;m.attr("d","M"+(s+x*a.px1[0])+","+(c+x*a.px1[1])+n(a.px1,a.px0,!1,x)+"l"+S*a.px0[0]+","+S*a.px0[1]+v+"Z")}else m.attr("d","M"+s+","+c+"l"+a.px0[0]+","+a.px0[1]+v+"Z")}var C=A.castOption(g.textposition,a.pts),L=p.selectAll("g.slicetext").data(a.text&&"none"!==C?[0]:[]);L.enter().append("g").classed("slicetext",!0),L.exit().remove(),L.each(function(){var t=w.ensureSingle(_.select(this),"text","",function(e){e.attr("data-notex",1)});t.text(a.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(k.font,"outside"===C?o(g,a,e._fullLayout.font):i(g,a,e._fullLayout.font)).call(T.convertToTspans,e);var r=k.bBox(t.node()),n;"outside"===C?n=d(r,a):(n=l(r,a,u),"auto"===C&&1>n.scale&&(t.call(k.font,g.outsidetextfont),(g.outsidetextfont.family!==g.insidetextfont.family||g.outsidetextfont.size!==g.insidetextfont.size)&&(r=k.bBox(t.node())),n=d(r,a)));var p=s+a.pxmid[0]*n.rCenter+(n.x||0),h=c+a.pxmid[1]*n.rCenter+(n.y||0);n.outside&&(a.yLabelMin=h-r.height/2,a.yLabelMid=h,a.yLabelMax=h+r.height/2,a.labelExtraX=0,a.labelExtraY=0,y=!0),t.attr("transform","translate("+p+","+h+")"+(1>n.scale?"scale("+n.scale+")":"")+(n.rotate?"rotate("+n.rotate+")":"")+"translate("+-(r.left+r.right)/2+","+-(r.top+r.bottom)/2+")")})});var f=_.select(this).selectAll("g.titletext").data(g.title.text?[0]:[]);f.enter().append("g").classed("titletext",!0),f.exit().remove(),f.each(function(){var t=w.ensureSingle(_.select(this),"text","",function(e){e.attr("data-notex",1)}),a=g.title.text;g._meta&&(a=w.templateString(a,g._meta)),t.text(a).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(k.font,g.title.font).call(T.convertToTspans,e);var r;r="middle center"===g.title.position?c(u):p(u,s._size),t.attr("transform","translate("+r.x+","+r.y+")"+(1>r.scale?"scale("+r.scale+")":"")+"translate("+r.tx+","+r.ty+")")}),y&&m(h,g),a(n,g)})});setTimeout(function(){u.selectAll("tspan").each(function(){var e=_.select(this);e.attr("dy")&&e.attr("dy",e.attr("dy"))})},0)},transformInsideText:l,determineInsideTextFont:i,positionTitleOutside:p,prerenderTitles:n,layoutAreas:y,attachFxHandlers:r}},{"../../components/color":593,"../../components/drawing":614,"../../components/fx":632,"../../lib":719,"../../lib/svg_text_utils":743,"./event_data":1090,"./helpers":1091,d3:163}],1096:[function(e,t){"use strict";var a=e("d3"),r=e("./style_one");t.exports=function(e){e._fullLayout._pielayer.selectAll(".trace").each(function(e){var t=e[0],o=t.trace,i=a.select(this);i.style({opacity:o.opacity}),i.selectAll("path.surface").each(function(e){a.select(this).call(r,e,o)})})}},{"./style_one":1097,d3:163}],1097:[function(e,t){"use strict";var a=e("../../components/color"),r=e("./helpers").castOption;t.exports=function(e,t,o){var i=o.marker.line,n=r(i.color,t.pts)||a.defaultLine,l=r(i.width,t.pts)||0;e.style("stroke-width",l).call(a.fill,t.color).call(a.stroke,n)}},{"../../components/color":593,"./helpers":1091}],1098:[function(e,t){"use strict";var a=e("../scatter/attributes");t.exports={x:a.x,y:a.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:a.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1112}],1099:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=r(e.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var r=e("gl-pointcloud2d"),o=e("../../lib/str2rgbarray"),n=e("../../plots/cartesian/autorange").findExtremes,l=e("../scatter/get_trace_color"),s=a.prototype;s.handlePick=function(e){var t=this.idToIndex[e.pointId];return{trace:this,dataCoord:e.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*t],this.pickXYData[2*t+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},s.update=function(e){this.index=e.index,this.textLabels=e.text,this.name=e.name,this.hoverinfo=e.hoverinfo,this.bounds=[1/0,1/0,-Infinity,-Infinity],this.updateFast(e),this.color=l(e,{})},s.updateFast=function(e){var t=this.xData=this.pickXData=e.x,a=this.yData=this.pickYData=e.y,r=this.pickXYData=e.xy,l=e.xbounds&&e.ybounds,s=e.indices,d=this.bounds,c,p,u,g,h,m;if(r){if(u=r,c=r.length>>>1,l)d[0]=e.xbounds[0],d[2]=e.xbounds[1],d[1]=e.ybounds[0],d[3]=e.ybounds[1];else for(m=0;m<c;m++)g=u[2*m],h=u[2*m+1],g<d[0]&&(d[0]=g),g>d[2]&&(d[2]=g),h<d[1]&&(d[1]=h),h>d[3]&&(d[3]=h);if(s)p=s;else for(p=new Int32Array(c),m=0;m<c;m++)p[m]=m}else for(c=t.length,u=new Float32Array(2*c),p=new Int32Array(c),m=0;m<c;m++)g=t[m],h=a[m],p[m]=m,u[2*m]=g,u[2*m+1]=h,g<d[0]&&(d[0]=g),g>d[2]&&(d[2]=g),h<d[1]&&(d[1]=h),h>d[3]&&(d[3]=h);this.idToIndex=p,this.pointcloudOptions.idToIndex=p,this.pointcloudOptions.positions=u;var y=o(e.marker.color),f=o(e.marker.border.color),x=e.opacity*e.marker.opacity;y[3]*=x,this.pointcloudOptions.color=y;var _=e.marker.blend;if(null===_){_=t.length<100||a.length<100}this.pointcloudOptions.blend=_,f[3]*=x,this.pointcloudOptions.borderColor=f;var b=e.marker.sizemin,v=va(e.marker.sizemax,e.marker.sizemin);this.pointcloudOptions.sizeMin=b,this.pointcloudOptions.sizeMax=v,this.pointcloudOptions.areaRatio=e.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,w=this.scene.yaxis,T=v/2||.5;e._extremes[k._id]=n(k,[d[0],d[2]],{ppad:T}),e._extremes[w._id]=n(w,[d[1],d[3]],{ppad:T})},s.dispose=function(){this.pointcloud.dispose()},t.exports=function(e,t){var r=new a(e,t.uid);return r.update(t),r}},{"../../lib/str2rgbarray":742,"../../plots/cartesian/autorange":766,"../scatter/get_trace_color":1121,"gl-pointcloud2d":292}],1100:[function(e,t){"use strict";var a=e("../../lib"),r=e("./attributes");t.exports=function(e,t,o){function i(o,i){return a.coerce(e,t,r,o,i)}i("x"),i("y"),i("xbounds"),i("ybounds"),e.xy&&e.xy instanceof Float32Array&&(t.xy=e.xy),e.indices&&e.indices instanceof Int32Array&&(t.indices=e.indices),i("text"),i("marker.color",o),i("marker.opacity"),i("marker.blend"),i("marker.sizemin"),i("marker.sizemax"),i("marker.border.color",o),i("marker.border.arearatio"),t._length=null}},{"../../lib":719,"./attributes":1098}],1101:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../scatter3d/calc"),plot:e("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:e("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":805,"../scatter3d/calc":1139,"./attributes":1098,"./convert":1099,"./defaults":1100}],1102:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),r=e("../../plots/attributes"),o=e("../../components/color/attributes"),i=e("../../components/fx/attributes"),n=e("../../plots/domain").attributes,l=e("../../components/fx/hovertemplate_attributes"),s=e("../../components/colorscale/attributes"),d=e("../../plot_api/plot_template").templatedArray,c=e("../../lib/extend").extendFlat,p=e("../../plot_api/edit_types").overrideAll,u=e("../../constants/docs").FORMAT_LINK,g=t.exports=p({hoverinfo:c({},r.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:i.hoverlabel,domain:n({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:a({}),node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:o.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:i.hoverlabel,hovertemplate:l({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:o.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:i.hoverlabel,hovertemplate:l({},{keys:["value","label"]}),colorscales:d("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:c(s().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");g.transforms=void 0},{"../../components/color/attributes":592,"../../components/colorscale/attributes":600,"../../components/fx/attributes":623,"../../components/fx/hovertemplate_attributes":631,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plot_api/plot_template":757,"../../plots/attributes":764,"../../plots/domain":792,"../../plots/font_attributes":793}],1103:[function(e,t,a){"use strict";function r(e,t){var a=e._fullData[t],r=e._fullLayout,o=r.dragmode,i="pan"===r.dragmode?"move":"crosshair",n=a._bgRect;if("pan"!==o&&"zoom"!==o){s(n,i);var l={_id:"x",c2p:p.identity,_offset:a._sankey.translateX,_length:a._sankey.width},g={_id:"y",c2p:p.identity,_offset:a._sankey.translateY,_length:a._sankey.height},h={gd:e,element:n.node(),plotinfo:{id:t,xaxis:l,yaxis:g,fillRangeItems:p.noop},subplot:t,xaxes:[l],yaxes:[g],doneFnCompleted:function(a){function r(e){for(var t=o._sankey.graph.nodes,a=0;a<t.length;a++)if(t[a].pointNumber===e)return t[a]}for(var o=e._fullData[t],i=o.node.groups.slice(),n=[],l=0,s,d;l<a.length;l++)if(d=r(a[l].pointNumber),d)if(d.group){for(var c=0;c<d.childrenNodes.length;c++)n.push(d.childrenNodes[c].pointNumber);i[d.pointNumber-o.node._count]=!1}else n.push(d.pointNumber);s=i.filter(Boolean).concat([n]),u.call("_guiRestyle",e,{"node.groups":[s]},t)}};h.prepFn=function(t,e,a){c(t,e,a,h,o)},d.init(h)}}var o=e("../../plot_api/edit_types").overrideAll,i=e("../../plots/get_data").getModuleCalcData,n=e("./plot"),l=e("../../components/fx/layout_attributes"),s=e("../../lib/setcursor"),d=e("../../components/dragelement"),c=e("../../plots/cartesian/select").prepSelect,p=e("../../lib"),u=e("../../registry"),g="sankey";a.name=g,a.baseLayoutAttrOverrides=o({hoverlabel:l.hoverlabel},"plot","nested"),a.plot=function(e){var t=i(e.calcdata,g)[0];n(e,t),a.updateFx(e)},a.clean=function(e,t,a,r){var o=r._has&&r._has(g),i=t._has&&t._has(g);o&&!i&&(r._paperdiv.selectAll(".sankey").remove(),r._paperdiv.selectAll(".bgsankey").remove())},a.updateFx=function(e){for(var t=0;t<e._fullData.length;t++)r(e,t)}},{"../../components/dragelement":611,"../../components/fx/layout_attributes":633,"../../lib":719,"../../lib/setcursor":739,"../../plot_api/edit_types":750,"../../plots/cartesian/select":784,"../../plots/get_data":802,"../../registry":847,"./plot":1108}],1104:[function(e,t){"use strict";function a(e){var t=e.node,a=e.link,o=[],p=s(a.color),u={},g={},h=a.colorscales.length,m;for(m=0;m<h;m++){var y=a.colorscales[m],f=c.extractScale(y,{cLetter:"c"}),x=c.makeColorScaleFunc(f);g[y.label]=x}var _=0;for(m=0;m<a.value.length;m++)a.source[m]>_&&(_=a.source[m]),a.target[m]>_&&(_=a.target[m]);var b=_+1;e.node._count=b;var v=e.node.groups,k={},w;for(m=0;m<v.length;m++){var T=v[m];for(w=0;w<T.length;w++){var A=T[w],S=b+m;k.hasOwnProperty(A)?n.warn("Node "+A+" is already part of a group."):k[A]=S}}var C={source:[],target:[]};for(m=0;m<a.value.length;m++){var L=a.value[m],E=a.source[m],I=a.target[m];if(0<L&&d(E,b)&&d(I,b)&&!(k.hasOwnProperty(E)&&k.hasOwnProperty(I)&&k[E]===k[I])){k.hasOwnProperty(I)&&(I=k[I]),k.hasOwnProperty(E)&&(E=k[E]),E=+E,I=+I,u[E]=u[I]=!0;var z="";a.label&&a.label[m]&&(z=a.label[m]);var P=null;z&&g.hasOwnProperty(z)&&(P=g[z]),o.push({pointNumber:m,label:z,color:p?a.color[m]:a.color,concentrationscale:P,source:E,target:I,value:+L}),C.source.push(E),C.target.push(I)}}var D=b+v.length,O=s(t.color),R=[];for(m=0;m<D;m++)if(u[m]){var M=t.label[m];R.push({group:m>b-1,childrenNodes:[],pointNumber:m,label:M,color:O?t.color[m]:t.color})}var l=!1;return r(D,C.source,C.target)&&(l=!0),{circular:l,links:o,nodes:R,groups:v,groupLookup:k}}function r(e,t,a){for(var r=n.init2dArray(e,0),l=0;l<ea(t.length,a.length);l++)if(n.isIndex(t[l],e)&&n.isIndex(a[l],e)){if(t[l]===a[l])return!0;r[t[l]].push(a[l])}var s=o(r);return s.components.some(function(e){return 1<e.length})}var o=e("strongly-connected-components"),n=e("../../lib"),l=e("../../lib/gup").wrap,s=n.isArrayOrTypedArray,d=n.isIndex,c=e("../../components/colorscale");t.exports=function(e,t){var r=a(t);return l({circular:r.circular,_nodes:r.nodes,_links:r.links,_groups:r.groups,_groupLookup:r.groupLookup})}},{"../../components/colorscale":605,"../../lib":719,"../../lib/gup":717,"strongly-connected-components":530}],1105:[function(e,t){"use strict";t.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1106:[function(e,t){"use strict";function a(e,t){function a(a,i){return r.coerce(e,t,o.link.colorscales,a,i)}a("label"),a("cmin"),a("cmax"),a("colorscale")}var r=e("../../lib"),o=e("./attributes"),n=e("../../components/color"),l=e("tinycolor2"),s=e("../../plots/domain").defaults,d=e("../../components/fx/hoverlabel_defaults"),c=e("../../plot_api/plot_template"),p=e("../../plots/array_container_defaults");t.exports=function(e,t,i,u){function g(a,i){return r.coerce(e,t,o,a,i)}function h(e,t){return r.coerce(f,x,o.node,e,t)}function m(e,t){return r.coerce(v,k,o.link,e,t)}var y=r.extendDeep(u.hoverlabel,e.hoverlabel),f=e.node,x=c.newContainer(t,"node");h("label"),h("groups"),h("x"),h("y"),h("pad"),h("thickness"),h("line.color"),h("line.width"),h("hoverinfo",e.hoverinfo),d(f,x,h,y),h("hovertemplate");var _=u.colorway,b=function(e){return _[e%_.length]};h("color",x.label.map(function(e,t){return n.addOpacity(b(t),.8)}));var v=e.link||{},k=c.newContainer(t,"link");m("label"),m("source"),m("target"),m("value"),m("line.color"),m("line.width"),m("hoverinfo",e.hoverinfo),d(v,k,m,y),m("hovertemplate");var w=.333>l(u.paper_bgcolor).getLuminance()?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";m("color",r.repeat(w,k.value.length)),p(v,k,{name:"colorscales",handleItemDefaults:a}),s(t,u,g),g("orientation"),g("valueformat"),g("valuesuffix");var T;x.x.length&&x.y.length&&(T="freeform"),g("arrangement",T),r.coerceFont(g,"textfont",r.extendFlat({},u.font)),t._length=null}},{"../../components/color":593,"../../components/fx/hoverlabel_defaults":630,"../../lib":719,"../../plot_api/plot_template":757,"../../plots/array_container_defaults":763,"../../plots/domain":792,"./attributes":1102,tinycolor2:537}],1107:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"sankey",basePlotModule:e("./base_plot"),selectPoints:e("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1102,"./base_plot":1103,"./calc":1104,"./defaults":1106,"./plot":1108,"./select.js":1110}],1108:[function(e,t){"use strict";function a(e){return""!==e}function r(e,t){return e.filter(function(e){return e.key===t.traceId})}function o(e,t){h.select(e).select("path").style("fill-opacity",t),h.select(e).select("rect").style("fill-opacity",t)}function i(e){h.select(e).select("text.name").style("fill","black")}function n(e){return function(t){return-1!==e.node.sourceLinks.indexOf(t.link)||-1!==e.node.targetLinks.indexOf(t.link)}}function l(e){return function(t){return-1!==t.node.sourceLinks.indexOf(e.link)||-1!==t.node.targetLinks.indexOf(e.link)}}function s(e,t,a){t&&a&&r(a,t).selectAll("."+x.sankeyLink).filter(n(t)).call(p.bind(0,t,a,!1))}function c(e,t,a){t&&a&&r(a,t).selectAll("."+x.sankeyLink).filter(n(t)).call(u.bind(0,t,a,!1))}function p(e,t,a,o){var i=o.datum().link.label;o.style("fill-opacity",function(e){if(!e.link.concentrationscale)return .4}),i&&r(t,e).selectAll("."+x.sankeyLink).filter(function(e){return e.link.label===i}).style("fill-opacity",function(e){if(!e.link.concentrationscale)return .4}),a&&r(t,e).selectAll("."+x.sankeyNode).filter(l(e)).call(s)}function u(e,t,a,o){var i=o.datum().link.label;o.style("fill-opacity",function(e){return e.tinyColorAlpha}),i&&r(t,e).selectAll("."+x.sankeyLink).filter(function(e){return e.link.label===i}).style("fill-opacity",function(e){return e.tinyColorAlpha}),a&&r(t,e).selectAll(x.sankeyNode).filter(l(e)).call(c)}function g(e,t){var a=e.hoverlabel||{},r=f.nestedProperty(a,t).get();return!Array.isArray(r)&&r}var h=e("d3"),d=e("./render"),m=e("../../components/fx"),y=e("../../components/color"),f=e("../../lib"),x=e("./constants").cn,b=f._;t.exports=function(e,t){for(var r=e._fullLayout,n=r._paper,l=r._size,f=0;f<e._fullData.length;f++)if(e._fullData[f].visible&&e._fullData[f].type===x.sankey&&!e._fullData[f]._viewInitial){var _=e._fullData[f].node;e._fullData[f]._viewInitial={node:{groups:_.groups.slice(),x:_.x.slice(),y:_.y.slice()}}}var v=b(e,"source:")+" ",k=b(e,"target:")+" ",w=b(e,"concentration:")+" ",T=b(e,"incoming flow count:")+" ",A=b(e,"outgoing flow count:")+" ",S=function(t,n){function l(e){var t,a;return e.circular?(t=(e.circularPathData.leftInnerExtent+e.circularPathData.rightInnerExtent)/2+n.parent.translateX,a=e.circularPathData.verticalFullExtent+n.parent.translateY):(t=(e.source.x1+e.target.x0)/2+n.parent.translateX,a=(e.y0+e.y1)/2+n.parent.translateY),[t,a]}if(!1!==e._fullLayout.hovermode){var s=n.link.trace.link;if("none"!==s.hoverinfo&&"skip"!==s.hoverinfo){for(var d=[],c=0,p=0,u;p<n.flow.links.length;p++)if(u=n.flow.links[p],"closest"!==e._fullLayout.hovermode||n.link.pointNumber===u.pointNumber){n.link.pointNumber===u.pointNumber&&(c=p),u.fullData=u.trace,s=n.link.trace.link;var f=l(u),x={valueLabel:h.format(n.valueFormat)(u.value)+n.valueSuffix};d.push({x:f[0],y:f[1],name:x.valueLabel,text:[u.label||"",v+u.source.label,k+u.target.label,u.concentrationscale?w+h.format("%0.2f")(u.flow.labelConcentration):""].filter(a).join("<br>"),color:g(s,"bgcolor")||y.addOpacity(u.color,1),borderColor:g(s,"bordercolor"),fontFamily:g(s,"font.family"),fontSize:g(s,"font.size"),fontColor:g(s,"font.color"),nameLength:g(s,"namelength"),textAlign:g(s,"align"),idealAlign:h.event.x<f[0]?"right":"left",hovertemplate:s.hovertemplate,hovertemplateLabels:x,eventData:[u]})}var _=m.loneHover(d,{container:r._hoverlayer.node(),outerContainer:r._paper.node(),gd:e,anchorIndex:c});_.each(function(){var e=this;n.link.concentrationscale||o(e,.65),i(e)})}}};d(e,n,t,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},{linkEvents:{hover:function(t,a,r){!1===e._fullLayout.hovermode||(h.select(t).call(p.bind(0,a,r,!0)),"skip"!==a.link.trace.link.hoverinfo&&(a.link.fullData=a.link.trace,e.emit("plotly_hover",{event:h.event,points:[a.link]})))},follow:S,unhover:function(t,a,o){!1===e._fullLayout.hovermode||(h.select(t).call(u.bind(0,a,o,!0)),"skip"!==a.link.trace.link.hoverinfo&&(a.link.fullData=a.link.trace,e.emit("plotly_unhover",{event:h.event,points:[a.link]})),m.loneUnhover(r._hoverlayer.node()))},select:function(t,a){var r=a.link;r.originalEvent=h.event,e._hoverdata=[r],m.click(e,{target:!0})}},nodeEvents:{hover:function(t,a,r){!1===e._fullLayout.hovermode||(h.select(t).call(s,a,r),"skip"!==a.node.trace.node.hoverinfo&&(a.node.fullData=a.node.trace,e.emit("plotly_hover",{event:h.event,points:[a.node]})))},follow:function(t,n){if(!1!==e._fullLayout.hovermode){var l=n.node.trace.node;if("none"!==l.hoverinfo&&"skip"!==l.hoverinfo){var s=h.select(t).select("."+x.nodeRect),d=e._fullLayout._paperdiv.node().getBoundingClientRect(),c=s.node().getBoundingClientRect(),p=c.left-2-d.left,u=c.right+2-d.left,y=c.top+c.height/4-d.top,f={valueLabel:h.format(n.valueFormat)(n.node.value)+n.valueSuffix};n.node.fullData=n.node.trace;var _=m.loneHover({x0:p,x1:u,y:y,name:h.format(n.valueFormat)(n.node.value)+n.valueSuffix,text:[n.node.label,T+n.node.targetLinks.length,A+n.node.sourceLinks.length].filter(a).join("<br>"),color:g(l,"bgcolor")||n.tinyColorHue,borderColor:g(l,"bordercolor"),fontFamily:g(l,"font.family"),fontSize:g(l,"font.size"),fontColor:g(l,"font.color"),nameLength:g(l,"namelength"),textAlign:g(l,"align"),idealAlign:"left",hovertemplate:l.hovertemplate,hovertemplateLabels:f,eventData:[n.node]},{container:r._hoverlayer.node(),outerContainer:r._paper.node(),gd:e});o(_,.85),i(_)}}},unhover:function(t,a,o){!1===e._fullLayout.hovermode||(h.select(t).call(c,a,o),"skip"!==a.node.trace.node.hoverinfo&&(a.node.fullData=a.node.trace,e.emit("plotly_unhover",{event:h.event,points:[a.node]})),m.loneUnhover(r._hoverlayer.node()))},select:function(t,a,r){var o=a.node;o.originalEvent=h.event,e._hoverdata=[o],h.select(t).call(c,a,r),m.click(e,{target:!0})}}})}},{"../../components/color":593,"../../components/fx":632,"../../lib":719,"./constants":1105,"./render":1109,d3:163}],1109:[function(e,t){"use strict";function a(e,t,a){function r(){for(b=0;b<_.nodes.length;b++){var e=_.nodes[b],t={},a,r;for(v=0;v<e.targetLinks.length;v++)r=e.targetLinks[v],a=r.source.pointNumber+":"+r.target.pointNumber,t.hasOwnProperty(a)||(t[a]=[]),t[a].push(r);var o=Object.keys(t);for(v=0;v<o.length;v++){a=o[v];var i=t[a],n=0,l={};for(w=0;w<i.length;w++)r=i[w],l[r.label]||(l[r.label]=0),l[r.label]+=r.value,n+=r.value;for(w=0;w<i.length;w++)r=i[w],r.flow={value:n,labelConcentration:l[r.label]/n,concentration:r.value/n,links:i},r.concentrationscale&&(r.color=D(r.concentrationscale(r.flow.labelConcentration)))}var s=0;for(v=0;v<e.sourceLinks.length;v++)s+=e.sourceLinks[v].value;for(v=0;v<e.sourceLinks.length;v++)r=e.sourceLinks[v],r.concentrationOut=r.value/s;var d=0;for(v=0;v<e.targetLinks.length;v++)d+=e.targetLinks[v].value;for(v=0;v<e.targetLinks.length;v++)r=e.targetLinks[v],r.concenrationIn=r.value/d}}function o(e){e.forEach(function(e){var t=0,a=e.length,r,o,n;for(e.sort(function(e,t){return e.y0-t.y0}),n=0;n<a;++n)r=e[n],r.y0>=t||(o=t-r.y0,1e-6<o&&(r.y0+=o,r.y1+=o)),t=r.y1+p})}function n(e){var t=e.map(function(e,t){return{x0:e.x0,index:t}}).sort(function(e,t){return e.x0-t.x0}),a=[],r=-1,o=-Infinity,i,n;for(b=0;b<t.length;b++){var l=e[t[b].index];l.x0>o+u&&(r+=1,i=l.x0),o=l.x0,a[r]||(a[r]=[]),a[r].push(l),n=i-l.x0,l.x0+=n,l.x1+=n}return a}var l=q(t),s=l.trace,d=s.domain,c="h"===s.orientation,p=s.node.pad,u=s.node.thickness,g=e.width*(d.x[1]-d.x[0]),h=e.height*(d.y[1]-d.y[0]),m=l._nodes,y=l._links,f=l.circular,x;x=f?B.sankeyCircular().circularLinkGap(0):F.sankey(),x.iterations(P.sankeyIterations).size(c?[g,h]:[h,g]).nodeWidth(u).nodePadding(p).nodeId(function(e){return e.pointNumber}).nodes(m).links(y);var _=x();x.nodePadding()<p&&V.warn("node.pad was reduced to ",x.nodePadding()," to fit within the figure.");var b,v,w;for(var T in l._groupLookup){var A=parseInt(l._groupLookup[T]),S;for(b=0;b<_.nodes.length;b++)if(_.nodes[b].pointNumber===A){S=_.nodes[b];break}if(S){var C={pointNumber:parseInt(T),x0:S.x0,x1:S.x1,y0:S.y0,y1:S.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};_.nodes.unshift(C),S.childrenNodes.unshift(C)}}if(r(),s.node.x.length&&s.node.y.length){for(b=0;b<ea(s.node.x.length,s.node.y.length,_.nodes.length);b++)if(s.node.x[b]&&s.node.y[b]){var L=[s.node.x[b]*g,s.node.y[b]*h];_.nodes[b].x0=L[0]-u/2,_.nodes[b].x1=L[0]+u/2;var E=_.nodes[b].y1-_.nodes[b].y0;_.nodes[b].y0=L[1]-E/2,_.nodes[b].y1=L[1]+E/2}if("snap"===s.arrangement){m=_.nodes;var I=n(m);o(I)}x.update(_)}return{circular:f,key:a,trace:s,guid:V.randstr(),horizontal:c,width:g,height:h,nodePad:s.node.pad,nodeLineColor:s.node.line.color,nodeLineWidth:s.node.line.width,linkLineColor:s.link.line.color,linkLineWidth:s.link.line.width,valueFormat:s.valueformat,valueSuffix:s.valuesuffix,textFont:s.textfont,translateX:d.x[0]*e.width+e.margin.l,translateY:e.height-d.y[1]*e.height+e.margin.t,dragParallel:c?h:g,dragPerpendicular:c?g:h,arrangement:s.arrangement,sankey:x,graph:_,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function r(e,t,a){var r=D(t.color),o=t.source.label+"|"+t.target.label;return t.trace=e.trace,t.curveNumber=e.trace.index,{circular:e.circular,key:o+"__"+a,traceId:e.key,pointNumber:t.pointNumber,link:t,tinyColorHue:O.tinyRGB(r),tinyColorAlpha:r.getAlpha(),linkPath:n,linkLineColor:e.linkLineColor,linkLineWidth:e.linkLineWidth,valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,parent:e,interactionState:e.interactionState,flow:t.flow}}function o(e){var t="",a=e.width/2,r=e.circularPathData;return t="top"===e.circularLinkType?"M "+r.targetX+" "+(r.targetY+a)+" L"+r.rightInnerExtent+" "+(r.targetY+a)+"A"+(r.rightLargeArcRadius+a)+" "+(r.rightSmallArcRadius+a)+" 0 0 1 "+(r.rightFullExtent-a)+" "+(r.targetY-r.rightSmallArcRadius)+"L"+(r.rightFullExtent-a)+" "+r.verticalRightInnerExtent+"A"+(r.rightLargeArcRadius+a)+" "+(r.rightLargeArcRadius+a)+" 0 0 1 "+r.rightInnerExtent+" "+(r.verticalFullExtent-a)+"L"+r.leftInnerExtent+" "+(r.verticalFullExtent-a)+"A"+(r.leftLargeArcRadius+a)+" "+(r.leftLargeArcRadius+a)+" 0 0 1 "+(r.leftFullExtent+a)+" "+r.verticalLeftInnerExtent+"L"+(r.leftFullExtent+a)+" "+(r.sourceY-r.leftSmallArcRadius)+"A"+(r.leftLargeArcRadius+a)+" "+(r.leftSmallArcRadius+a)+" 0 0 1 "+r.leftInnerExtent+" "+(r.sourceY+a)+"L"+r.sourceX+" "+(r.sourceY+a)+"L"+r.sourceX+" "+(r.sourceY-a)+"L"+r.leftInnerExtent+" "+(r.sourceY-a)+"A"+(r.leftLargeArcRadius-a)+" "+(r.leftSmallArcRadius-a)+" 0 0 0 "+(r.leftFullExtent-a)+" "+(r.sourceY-r.leftSmallArcRadius)+"L"+(r.leftFullExtent-a)+" "+r.verticalLeftInnerExtent+"A"+(r.leftLargeArcRadius-a)+" "+(r.leftLargeArcRadius-a)+" 0 0 0 "+r.leftInnerExtent+" "+(r.verticalFullExtent+a)+"L"+r.rightInnerExtent+" "+(r.verticalFullExtent+a)+"A"+(r.rightLargeArcRadius-a)+" "+(r.rightLargeArcRadius-a)+" 0 0 0 "+(r.rightFullExtent+a)+" "+r.verticalRightInnerExtent+"L"+(r.rightFullExtent+a)+" "+(r.targetY-r.rightSmallArcRadius)+"A"+(r.rightLargeArcRadius-a)+" "+(r.rightSmallArcRadius-a)+" 0 0 0 "+r.rightInnerExtent+" "+(r.targetY-a)+"L"+r.targetX+" "+(r.targetY-a)+"Z":"M "+r.targetX+" "+(r.targetY-a)+" L"+r.rightInnerExtent+" "+(r.targetY-a)+"A"+(r.rightLargeArcRadius+a)+" "+(r.rightSmallArcRadius+a)+" 0 0 0 "+(r.rightFullExtent-a)+" "+(r.targetY+r.rightSmallArcRadius)+"L"+(r.rightFullExtent-a)+" "+r.verticalRightInnerExtent+"A"+(r.rightLargeArcRadius+a)+" "+(r.rightLargeArcRadius+a)+" 0 0 0 "+r.rightInnerExtent+" "+(r.verticalFullExtent+a)+"L"+r.leftInnerExtent+" "+(r.verticalFullExtent+a)+"A"+(r.leftLargeArcRadius+a)+" "+(r.leftLargeArcRadius+a)+" 0 0 0 "+(r.leftFullExtent+a)+" "+r.verticalLeftInnerExtent+"L"+(r.leftFullExtent+a)+" "+(r.sourceY+r.leftSmallArcRadius)+"A"+(r.leftLargeArcRadius+a)+" "+(r.leftSmallArcRadius+a)+" 0 0 0 "+r.leftInnerExtent+" "+(r.sourceY-a)+"L"+r.sourceX+" "+(r.sourceY-a)+"L"+r.sourceX+" "+(r.sourceY+a)+"L"+r.leftInnerExtent+" "+(r.sourceY+a)+"A"+(r.leftLargeArcRadius-a)+" "+(r.leftSmallArcRadius-a)+" 0 0 1 "+(r.leftFullExtent-a)+" "+(r.sourceY+r.leftSmallArcRadius)+"L"+(r.leftFullExtent-a)+" "+r.verticalLeftInnerExtent+"A"+(r.leftLargeArcRadius-a)+" "+(r.leftLargeArcRadius-a)+" 0 0 1 "+r.leftInnerExtent+" "+(r.verticalFullExtent-a)+"L"+r.rightInnerExtent+" "+(r.verticalFullExtent-a)+"A"+(r.rightLargeArcRadius-a)+" "+(r.rightLargeArcRadius-a)+" 0 0 1 "+(r.rightFullExtent+a)+" "+r.verticalRightInnerExtent+"L"+(r.rightFullExtent+a)+" "+(r.targetY+r.rightSmallArcRadius)+"A"+(r.rightLargeArcRadius-a)+" "+(r.rightSmallArcRadius-a)+" 0 0 1 "+r.rightInnerExtent+" "+(r.targetY+a)+"L"+r.targetX+" "+(r.targetY+a)+"Z",t}function n(){var e=.5;return function(t){if(t.link.circular)return o(t.link);var a=t.link.source.x1,r=t.link.target.x0,i=Y(a,r),n=i(e),l=i(1-e),s=t.link.y0-t.link.width/2,d=t.link.y0+t.link.width/2,c=t.link.y1-t.link.width/2,p=t.link.y1+t.link.width/2;return"M"+a+","+s+"C"+n+","+s+" "+l+","+c+" "+r+","+c+"L"+r+","+p+"C"+l+","+p+" "+n+","+d+" "+a+","+d+"Z"}}function l(e,t){var a=D(t.color),r=P.nodePadAcross,o=e.nodePad/2;t.dx=t.x1-t.x0,t.dy=t.y1-t.y0;var i=t.dx,n=va(.5,t.dy),l="node_"+t.pointNumber;return t.group&&(l=V.randstr()),t.trace=e.trace,t.curveNumber=e.trace.index,{index:t.pointNumber,key:l,partOfGroup:t.partOfGroup||!1,group:t.group,traceId:e.key,trace:e.trace,node:t,nodePad:e.nodePad,nodeLineColor:e.nodeLineColor,nodeLineWidth:e.nodeLineWidth,textFont:e.textFont,size:e.horizontal?e.height:e.width,visibleWidth:M(i),visibleHeight:n,zoneX:-r,zoneY:-o,zoneWidth:i+2*r,zoneHeight:n+2*o,labelY:e.horizontal?t.dy/2+1:t.dx/2+1,left:1===t.originalLayer,sizeAcross:e.width,forceLayouts:e.forceLayouts,horizontal:e.horizontal,darkBackground:128>=a.getBrightness(),tinyColorHue:O.tinyRGB(a),tinyColorAlpha:a.getAlpha(),valueFormat:e.valueFormat,valueSuffix:e.valueSuffix,sankey:e.sankey,graph:e.graph,arrangement:e.arrangement,uniqueNodeLabelPathId:[e.guid,e.key,l].join("_"),interactionState:e.interactionState,figure:e}}function s(e){e.attr("transform",function(e){return"translate("+e.node.x0.toFixed(3)+", "+e.node.y0.toFixed(3)+")"})}function d(e){e.call(s)}function p(e,t){e.call(d),t.attr("d",n())}function u(e){e.attr("width",function(e){return e.node.x1-e.node.x0}).attr("height",function(e){return e.visibleHeight})}function g(e){return 1<e.link.width||0<e.linkLineWidth}function h(e){var t="translate("+e.translateX+","+e.translateY+")";return t+(e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function m(e){return"translate("+(e.horizontal?0:e.labelY)+" "+(e.horizontal?e.labelY:0)+")"}function y(e){return c.svg.line()([[e.horizontal?e.left?-e.sizeAcross:e.visibleWidth+P.nodeTextOffsetHorizontal:P.nodeTextOffsetHorizontal,0],[e.horizontal?e.left?-P.nodeTextOffsetHorizontal:e.sizeAcross:e.visibleHeight-P.nodeTextOffsetHorizontal,0]])}function f(e){return e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function x(e){return e.horizontal?"scale(1 1)":"scale(-1 1)"}function _(e){return e.darkBackground&&!e.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function b(e){return e.horizontal&&e.left?"100%":"0%"}function v(e,t,a){e.on(".basic",null).on("mouseover.basic",function(e){e.interactionState.dragInProgress||e.partOfGroup||(a.hover(this,e,t),e.interactionState.hovered=[this,e])}).on("mousemove.basic",function(e){e.interactionState.dragInProgress||e.partOfGroup||(a.follow(this,e),e.interactionState.hovered=[this,e])}).on("mouseout.basic",function(e){e.interactionState.dragInProgress||e.partOfGroup||(a.unhover(this,e,t),e.interactionState.hovered=!1)}).on("click.basic",function(e){e.interactionState.hovered&&(a.unhover(this,e,t),e.interactionState.hovered=!1),e.interactionState.dragInProgress||e.partOfGroup||a.select(this,e,t)})}function k(e,t,a,r){var o=c.behavior.drag().origin(function(e){return{x:e.node.x0+e.visibleWidth/2,y:e.node.y0+e.visibleHeight/2}}).on("dragstart",function(o){if("fixed"!==o.arrangement&&(V.ensureSingle(r._fullLayout._infolayer,"g","dragcover",function(e){r._fullLayout._dragCover=e}),V.raiseToTop(this),o.interactionState.dragInProgress=o.node,L(o.node),o.interactionState.hovered&&(a.nodeEvents.unhover.apply(0,o.interactionState.hovered),o.interactionState.hovered=!1),"snap"===o.arrangement)){var i=o.traceId+"|"+o.key;o.forceLayouts[i]?o.forceLayouts[i].alpha(1):w(e,i,o,r),T(e,t,o,i,r)}}).on("drag",function(a){if("fixed"!==a.arrangement){var r=c.event.x,o=c.event.y;"snap"===a.arrangement?(a.node.x0=r-a.visibleWidth/2,a.node.x1=r+a.visibleWidth/2,a.node.y0=o-a.visibleHeight/2,a.node.y1=o+a.visibleHeight/2):("freeform"===a.arrangement&&(a.node.x0=r-a.visibleWidth/2,a.node.x1=r+a.visibleWidth/2),o=va(0,ea(a.size-a.visibleHeight/2,o)),a.node.y0=o-a.visibleHeight/2,a.node.y1=o+a.visibleHeight/2),L(a.node),"snap"!==a.arrangement&&(a.sankey.update(a.graph),p(e.filter(E(a)),t))}}).on("dragend",function(e){if("fixed"!==e.arrangement){e.interactionState.dragInProgress=!1;for(var t=0;t<e.node.childrenNodes.length;t++)e.node.childrenNodes[t].x=e.node.x,e.node.childrenNodes[t].y=e.node.y;"snap"!==e.arrangement&&S(e,r)}});e.on(".drag",null).call(o)}function w(e,t,a,r){I(a.graph.nodes);var o=a.graph.nodes.filter(function(e){return e.originalX===a.node.originalX}).filter(function(e){return!e.partOfGroup});a.forceLayouts[t]=N.forceSimulation(o).alphaDecay(0).force("collide",N.forceCollide().radius(function(e){return e.dy/2+a.nodePad/2}).strength(1).iterations(P.forceIterations)).force("constrain",A(e,t,o,a,r)).stop()}function T(e,t,a,r,o){window.requestAnimationFrame(function n(){var l;for(l=0;l<P.forceTicksPerFrame;l++)a.forceLayouts[r].tick();var s=a.graph.nodes;if(z(s),a.sankey.update(a.graph),p(e.filter(E(a)),t),0<a.forceLayouts[r].alpha())window.requestAnimationFrame(n);else{var d=a.node.originalX;a.node.x0=d-a.visibleWidth/2,a.node.x1=d+a.visibleWidth/2,S(a,o)}})}function A(e,t,a,r){return function(){for(var e=0,o=0,l;o<a.length;o++)l=a[o],l===r.interactionState.dragInProgress?(l.x=l.lastDraggedX,l.y=l.lastDraggedY):(l.vx=(l.originalX-l.x)/P.forceTicksPerFrame,l.y=ea(r.size-l.dy/2,va(l.dy/2,l.y))),e=va(e,_a(l.vx),_a(l.vy));!r.interactionState.dragInProgress&&.1>e&&0<r.forceLayouts[t].alpha()&&r.forceLayouts[t].alpha(0)}}function S(e,t){for(var a=[],r=[],o=0;o<e.graph.nodes.length;o++){var n=(e.graph.nodes[o].x0+e.graph.nodes[o].x1)/2,l=(e.graph.nodes[o].y0+e.graph.nodes[o].y1)/2;a.push(n/e.figure.width),r.push(l/e.figure.height)}W.call("_guiRestyle",t,{"node.x":[a],"node.y":[r]},e.trace.index).then(function(){t._fullLayout._dragCover&&t._fullLayout._dragCover.remove()})}function C(e){var t=[],a;for(a=0;a<e.length;a++)e[a].originalX=(e[a].x0+e[a].x1)/2,e[a].originalY=(e[a].y0+e[a].y1)/2,-1===t.indexOf(e[a].originalX)&&t.push(e[a].originalX);for(t.sort(function(e,t){return e-t}),a=0;a<e.length;a++)e[a].originalLayerIndex=t.indexOf(e[a].originalX),e[a].originalLayer=e[a].originalLayerIndex/(t.length-1)}function L(e){e.lastDraggedX=e.x0+e.dx/2,e.lastDraggedY=e.y0+e.dy/2}function E(e){return function(t){return t.node.originalX===e.node.originalX}}function I(e){for(var t=0;t<e.length;t++)e[t].y=(e[t].y0+e[t].y1)/2,e[t].x=(e[t].x0+e[t].x1)/2}function z(e){for(var t=0;t<e.length;t++)e[t].y0=e[t].y-e[t].dy/2,e[t].y1=e[t].y0+e[t].dy,e[t].x0=e[t].x-e[t].dx/2,e[t].x1=e[t].x0+e[t].dx}var P=e("./constants"),c=e("d3"),D=e("tinycolor2"),O=e("../../components/color"),R=e("../../components/drawing"),F=e("@plotly/d3-sankey"),B=e("@plotly/d3-sankey-circular"),N=e("d3-force"),V=e("../../lib"),U=e("../../lib/gup"),H=U.keyFun,G=U.repeat,q=U.unwrap,Y=e("d3-interpolate").interpolateNumber,W=e("../../registry");t.exports=function(e,t,o,i,d){var p=!1;V.ensureSingle(e._fullLayout._infolayer,"g","first-render",function(){p=!0});var w=e._fullLayout._dragCover,T=o.filter(function(e){return q(e).trace.visible}).map(a.bind(null,i)),A=t.selectAll("."+P.cn.sankey).data(T,H);A.exit().remove(),A.enter().append("g").classed(P.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",h),A.each(function(t,a){e._fullData[a]._sankey=t;var r="bgsankey-"+t.trace.uid+"-"+a;V.ensureSingle(e._fullLayout._draggers,"rect",r),e._fullData[a]._bgRect=c.select("."+r),e._fullData[a]._bgRect.style("pointer-events","all").attr("width",t.width).attr("height",t.height).attr("x",t.translateX).attr("y",t.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),A.transition().ease(P.ease).duration(P.duration).attr("transform",h);var S=A.selectAll("."+P.cn.sankeyLinks).data(G,H);S.enter().append("g").classed(P.cn.sankeyLinks,!0).style("fill","none");var L=S.selectAll("."+P.cn.sankeyLink).data(function(e){var t=e.graph.links;return t.filter(function(e){return e.value}).map(r.bind(null,e))},H);L.enter().append("path").classed(P.cn.sankeyLink,!0).call(v,A,d.linkEvents),L.style("stroke",function(e){return g(e)?O.tinyRGB(D(e.linkLineColor)):e.tinyColorHue}).style("stroke-opacity",function(e){return g(e)?O.opacity(e.linkLineColor):e.tinyColorAlpha}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha}).style("stroke-width",function(e){return g(e)?e.linkLineWidth:1}).attr("d",n()),L.style("opacity",function(){return e._context.staticPlot||p||w?1:0}).transition().ease(P.ease).duration(P.duration).style("opacity",1),L.exit().transition().ease(P.ease).duration(P.duration).style("opacity",0).remove();var E=A.selectAll("."+P.cn.sankeyNodeSet).data(G,H);E.enter().append("g").classed(P.cn.sankeyNodeSet,!0),E.style("cursor",function(e){switch(e.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move";}});var I=E.selectAll("."+P.cn.sankeyNode).data(function(e){var t=e.graph.nodes;return C(t),t.map(l.bind(null,e))},H);I.enter().append("g").classed(P.cn.sankeyNode,!0).call(s).style("opacity",function(t){return(e._context.staticPlot||p)&&!t.partOfGroup?1:0}),I.call(v,A,d.nodeEvents).call(k,L,d,e),I.transition().ease(P.ease).duration(P.duration).call(s).style("opacity",function(e){return e.partOfGroup?0:1}),I.exit().transition().ease(P.ease).duration(P.duration).style("opacity",0).remove();var z=I.selectAll("."+P.cn.nodeRect).data(G);z.enter().append("rect").classed(P.cn.nodeRect,!0).call(u),z.style("stroke-width",function(e){return e.nodeLineWidth}).style("stroke",function(e){return O.tinyRGB(D(e.nodeLineColor))}).style("stroke-opacity",function(e){return O.opacity(e.nodeLineColor)}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha}),z.transition().ease(P.ease).duration(P.duration).call(u);var M=I.selectAll("."+P.cn.nodeCapture).data(G);M.enter().append("rect").classed(P.cn.nodeCapture,!0).style("fill-opacity",0),M.attr("x",function(e){return e.zoneX}).attr("y",function(e){return e.zoneY}).attr("width",function(e){return e.zoneWidth}).attr("height",function(e){return e.zoneHeight});var j=I.selectAll("."+P.cn.nodeCentered).data(G);j.enter().append("g").classed(P.cn.nodeCentered,!0).attr("transform",m),j.transition().ease(P.ease).duration(P.duration).attr("transform",m);var F=j.selectAll("."+P.cn.nodeLabelGuide).data(G);F.enter().append("path").classed(P.cn.nodeLabelGuide,!0).attr("id",function(e){return e.uniqueNodeLabelPathId}).attr("d",y).attr("transform",f),F.transition().ease(P.ease).duration(P.duration).attr("d",y).attr("transform",f);var B=j.selectAll("."+P.cn.nodeLabel).data(G);B.enter().append("text").classed(P.cn.nodeLabel,!0).attr("transform",x).style("user-select","none").style("cursor","default").style("fill","black"),B.style("text-shadow",function(e){return e.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(e){R.font(B,e.textFont)}),B.transition().ease(P.ease).duration(P.duration).attr("transform",x);var N=B.selectAll("."+P.cn.nodeLabelTextPath).data(G);N.enter().append("textPath").classed(P.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",function(e){return"#"+e.uniqueNodeLabelPathId}).attr("startOffset",b).style("fill",_),N.text(function(e){return e.horizontal||5<e.node.dy?e.node.label:""}).attr("text-anchor",function(e){return e.horizontal&&e.left?"end":"start"}),N.transition().ease(P.ease).duration(P.duration).attr("startOffset",b).style("fill",_)}},{"../../components/color":593,"../../components/drawing":614,"../../lib":719,"../../lib/gup":717,"../../registry":847,"./constants":1105,"@plotly/d3-sankey":54,"@plotly/d3-sankey-circular":53,d3:163,"d3-force":156,"d3-interpolate":158,tinycolor2:537}],1110:[function(e,t){"use strict";t.exports=function(e,t){for(var a=e.cd,r=[],o=a[0].trace,n=o._sankey.graph.nodes,l=0,s;l<n.length;l++)if(s=n[l],!s.partOfGroup){var d=[(s.x0+s.x1)/2,(s.y0+s.y1)/2];"v"===o.orientation&&d.reverse(),t&&t.contains(d,!1,l,e)&&r.push({pointNumber:s.pointNumber})}return r}},{}],1111:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){for(var r=0;r<e.length;r++)e[r].i=r;a.mergeArray(t.text,e,"tx"),a.mergeArray(t.hovertext,e,"htx"),a.mergeArray(t.customdata,e,"data"),a.mergeArray(t.textposition,e,"tp"),t.textfont&&(a.mergeArrayCastPositive(t.textfont.size,e,"ts"),a.mergeArray(t.textfont.color,e,"tc"),a.mergeArray(t.textfont.family,e,"tf"));var o=t.marker;if(o){a.mergeArrayCastPositive(o.size,e,"ms"),a.mergeArrayCastPositive(o.opacity,e,"mo"),a.mergeArray(o.symbol,e,"mx"),a.mergeArray(o.color,e,"mc");var n=o.line;o.line&&(a.mergeArray(n.color,e,"mlc"),a.mergeArrayCastPositive(n.width,e,"mlw"));var l=o.gradient;l&&"none"!==l.type&&(a.mergeArray(l.type,e,"mgt"),a.mergeArray(l.color,e,"mgc"))}}},{"../../lib":719}],1112:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),r=e("../../components/colorscale/attributes"),o=e("../../plots/font_attributes"),i=e("../../components/drawing/attributes").dash,n=e("../../components/drawing"),l=e("./constants"),s=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:a({},{keys:l.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:s({},i,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:s({symbol:{valType:"enumerated",values:n.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:s({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},r("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},r("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:o({editType:"calc",colorEditType:"style",arrayOk:!0}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorscale/attributes":600,"../../components/drawing":614,"../../components/drawing/attributes":613,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/font_attributes":793,"./constants":1116}],1113:[function(e,t){"use strict";function a(e,t,a,r,o,l,s){var d=t._length,p=e._fullLayout,g=a._id,h=r._id,m=p._firstScatter[i(t)]===t.uid,y=(n(t,p,a,r)||{}).orientation,f=t.fill;a._minDtick=0,r._minDtick=0;var x={padded:!0},_={padded:!0};s&&(x.ppad=_.ppad=s);var b=2>d||o[0]!==o[d-1]||l[0]!==l[d-1];b&&("tozerox"===f||"tonextx"===f&&(m||"h"===y))?x.tozero=!0:!(t.error_y||{}).visible&&("tonexty"===f||"tozeroy"===f||!u.hasMarkers(t)&&!u.hasText(t))&&(x.padded=!1,x.ppad=0),b&&("tozeroy"===f||"tonexty"===f&&(m||"v"===y))?_.tozero=!0:("tonextx"===f||"tozerox"===f)&&(_.padded=!1),g&&(t._extremes[g]=c.findExtremes(a,o,x)),h&&(t._extremes[h]=c.findExtremes(r,l,_))}function r(e,t){if(u.hasMarkers(e)){var a=e.marker,r=1.6*(e.marker.sizeref||1),o;if(o="area"===e.marker.sizemode?function(e){return va(N((e||0)/r),3)}:function(e){return va((e||0)/r,3)},d.isArrayOrTypedArray(a.size)){var n={type:"linear"};c.setConvert(n);for(var l=n.makeCalcdata(e.marker,"size"),s=Array(t),p=0;p<t;p++)s[p]=o(l[p]);return s}return o(a.size)}}function o(e,t){var a=i(t),r=e._firstScatter;r[a]||(r[a]=t.uid)}function i(e){var t=e.stackgroup;return e.xaxis+e.yaxis+e.type+(t?"-"+t:"")}function n(e,t,a,r){var o=e.stackgroup;if(o){var i=t._scatterStackOpts[a._id+r._id][o],n="v"===i.orientation?r:a;if("linear"===n.type||"log"===n.type)return i}}var l=e("fast-isnumeric"),d=e("../../lib"),c=e("../../plots/cartesian/axes"),p=e("../../constants/numerical").BADNUM,u=e("./subtypes"),g=e("./colorscale_calc"),h=e("./arrays_to_calcdata"),f=e("./calc_selection");t.exports={calc:function(e,t){var s=e._fullLayout,u=c.getFromId(e,t.xaxis||"x"),_=c.getFromId(e,t.yaxis||"y"),b=u.makeCalcdata(t,"x"),x=_.makeCalcdata(t,"y"),y=t._length,v=Array(y),w=t.ids,T=n(t,s,u,_),A=!1,S,C,L,E,I,z;o(s,t);var P="x",D="y",O;if(T)d.pushUnique(T.traceIndices,t._expandedIndex),S="v"===T.orientation,S?(D="s",O="x"):(P="s",O="y"),I="interpolate"===T.stackgaps;else{var R=r(t,y);a(e,t,u,_,b,x,R)}for(C=0;C<y;C++){var M=v[C]={},F=l(b[C]),B=l(x[C]);F&&B?(M[P]=b[C],M[D]=x[C]):T&&(S?F:B)?(M[O]=S?b[C]:x[C],M.gap=!0,I?(M.s=p,A=!0):M.s=0):M[P]=M[D]=p,w&&(M.id=w[C]+"")}if(h(v,t),g(e,t),f(v,t),T){for(C=0;C<v.length;)v[C][O]===p?v.splice(C,1):C++;if(d.sort(v,function(e,t){return e[O]-t[O]||e.i-t.i}),A){for(C=0;C<v.length-1&&v[C].gap;)C++;for(z=v[C].s,z||(z=v[C].s=0),L=0;L<C;L++)v[L].s=z;for(E=v.length-1;E>C&&v[E].gap;)E--;for(z=v[E].s,L=v.length-1;L>E;L--)v[L].s=z;for(;C<E;)if(C++,v[C].gap){for(L=C+1;v[L].gap;)L++;for(var N=v[C-1][O],V=v[C-1].s,U=(v[L].s-V)/(v[L][O]-N);C<L;)v[C].s=V+(v[C][O]-N)*U,C++}}}return v},calcMarkerSize:r,calcAxisExpansion:a,setFirstScatter:o,getStackOpts:n}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"./arrays_to_calcdata":1111,"./calc_selection":1114,"./colorscale_calc":1115,"./subtypes":1135,"fast-isnumeric":225}],1114:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){a.isArrayOrTypedArray(t.selectedpoints)&&a.tagSelected(e,t)}},{"../../lib":719}],1115:[function(e,t){"use strict";var a=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/calc"),o=e("./subtypes");t.exports=function(e,t){o.hasLines(t)&&a(t,"line")&&r(e,t,{vals:t.line.color,containerStr:"line",cLetter:"c"}),o.hasMarkers(t)&&(a(t,"marker")&&r(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),a(t,"marker.line")&&r(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":601,"../../components/colorscale/helpers":604,"./subtypes":1135}],1116:[function(e,t){"use strict";t.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1117:[function(e,t){"use strict";function a(e,t,a,o,i,n,l){i[o]=!0;var s={i:null,gap:!0,s:0};if(s[l]=a,e.splice(t,0,s),t&&a===e[t-1][l]){var d=e[t-1];s.s=d.s,s.i=d.i,s.gap=d.gap}else n&&(s.s=r(e,t,a,l));t||(e[0].t=e[1].t,e[0].trace=e[1].trace,delete e[1].t,delete e[1].trace)}function r(e,t,a,r){var o=e[t-1],i=e[t+1];return i?o?o.s+(i.s-o.s)*(a-o[r])/(i[r]-o[r]):i.s:o.s}var o=e("./calc");t.exports=function(e,t){var r=t.xaxis,n=t.yaxis,l=r._id+n._id,s=e._fullLayout._scatterStackOpts[l];if(s){var d=e.calcdata,c,p,u,g,h,m,f,_,b,v,w,T,A,S,C;for(var L in s){v=s[L];var E=v.traceIndices;if(E.length){for(w="interpolate"===v.stackgaps,T=v.groupnorm,"v"===v.orientation?(A="x",S="y"):(A="y",S="x"),C=Array(E.length),c=0;c<C.length;c++)C[c]=!1;m=d[E[0]];var I=Array(m.length);for(c=0;c<m.length;c++)I[c]=m[c][A];for(c=1;c<E.length;c++){for(h=d[E[c]],p=u=0;p<h.length;p++){for(f=h[p][A];f>I[u]&&u<I.length;u++)a(h,p,I[u],c,C,w,A),p++;if(f!==I[u]){for(g=0;g<c;g++)a(d[E[g]],u,f,g,C,w,A);I.splice(u,0,f)}u++}for(;u<I.length;u++)a(h,p,I[u],c,C,w,A),p++}var z=I.length;for(p=0;p<m.length;p++){for(_=m[p][S]=m[p].s,c=1;c<E.length;c++)h=d[E[c]],h[0].trace._rawLength=h[0].trace._length,h[0].trace._length=z,_+=h[p].s,h[p][S]=_;if(T)for(b=("fraction"===T?_:_/100)||1,c=0;c<E.length;c++){var P=d[E[c]][p];P[S]/=b,P.sNorm=P.s/b}}for(c=0;c<E.length;c++){h=d[E[c]];var D=h[0].trace,O=o.calcMarkerSize(D,D._rawLength),R=Array.isArray(O);if(O&&C[c]||R){var M=O;for(O=Array(z),p=0;p<z;p++)O[p]=h[p].gap?0:R?M[h[p].i]:M}var F=Array(z),x=Array(z);for(p=0;p<z;p++)F[p]=h[p].x,x[p]=h[p].y;o.calcAxisExpansion(e,D,r,n,F,x,O),h[0].t.orientation=v.orientation}}}}}},{"./calc":1113}],1118:[function(e,t){"use strict";t.exports=function(e){for(var t=0,a;t<e.length;t++)if(a=e[t],"scatter"===a.type){var r=a.fill;if("none"!==r&&"toself"!==r&&(a.opacity=void 0,"tonexty"===r||"tonextx"===r))for(var o=t-1,n;0<=o;o--)if(n=e[o],"scatter"===n.type&&n.xaxis===a.xaxis&&n.yaxis===a.yaxis){n.opacity=void 0;break}}}},{}],1119:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../registry"),o=e("./attributes"),i=e("./constants"),n=e("./subtypes"),l=e("./xy_defaults"),s=e("./stack_defaults"),d=e("./marker_defaults"),c=e("./line_defaults"),p=e("./line_shape_defaults"),u=e("./text_defaults"),g=e("./fillcolor_defaults");t.exports=function(e,t,h,m){function y(r,i){return a.coerce(e,t,o,r,i)}var f=l(e,t,m,y);if(f||(t.visible=!1),!!t.visible){var x=s(e,t,m,y),_=!x&&f<i.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("mode",_),n.hasLines(t)&&(c(e,t,h,m,y),p(e,t,y),y("connectgaps"),y("line.simplify")),n.hasMarkers(t)&&d(e,t,h,m,y,{gradient:!0}),n.hasText(t)&&u(e,t,m,y);var b=[];(n.hasMarkers(t)||n.hasText(t))&&(y("cliponaxis"),y("marker.maxdisplayed"),b.push("points")),y("fill",x?x.fillDflt:"none"),"none"!==t.fill&&(g(e,t,h,y),!n.hasLines(t)&&p(e,t,y));var v=(t.line||{}).color,k=(t.marker||{}).color;("tonext"===t.fill||"toself"===t.fill)&&b.push("fills"),y("hoveron",b.join("+")||"points"),"fills"!==t.hoveron&&y("hovertemplate");var w=r.getComponentMethod("errorbars","supplyDefaults");w(e,t,v||k||h,{axis:"y"}),w(e,t,v||k||h,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(t,y)}}},{"../../lib":719,"../../registry":847,"./attributes":1112,"./constants":1116,"./fillcolor_defaults":1120,"./line_defaults":1124,"./line_shape_defaults":1126,"./marker_defaults":1130,"./stack_defaults":1133,"./subtypes":1135,"./text_defaults":1136,"./xy_defaults":1137}],1120:[function(e,t){"use strict";var a=e("../../components/color"),r=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,o,i){var n=!1;if(t.marker){var l=t.marker.color,s=(t.marker.line||{}).color;l&&!r(l)?n=l:s&&!r(s)&&(n=s)}i("fillcolor",a.addOpacity((t.line||{}).color||n||o,.5))}},{"../../components/color":593,"../../lib":719}],1121:[function(e,t){"use strict";var a=e("../../components/color"),r=e("./subtypes");t.exports=function(e,t){var o,i;if("lines"===e.mode)return o=e.line.color,o&&a.opacity(o)?o:e.fillcolor;if("none"===e.mode)return e.fill?e.fillcolor:"";var n=t.mcc||(e.marker||{}).color,l=t.mlcc||((e.marker||{}).line||{}).color;return i=n&&a.opacity(n)?n:l&&a.opacity(l)&&(t.mlw||((e.marker||{}).line||{}).width)?l:"",i?.3>a.opacity(i)?a.addOpacity(i,.3):i:(o=(e.line||{}).color,o&&a.opacity(o)&&r.hasLines(e)&&e.line.width?o:e.fillcolor)}},{"../../components/color":593,"./subtypes":1135}],1122:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/fx"),o=e("../../registry"),i=e("./get_trace_color"),n=e("../../components/color"),l=a.fillText;t.exports=function(e,t,s,d){var c=e.cd,p=c[0].trace,u=e.xa,g=e.ya,h=u.c2p(t),m=g.c2p(s),y=[h,m],f=p.hoveron||"",x=-1===p.mode.indexOf("markers")?.5:3;if(-1!==f.indexOf("points")){var _=function(e){var t=va(3,e.mrc||0),a=1-1/t,r=_a(u.c2p(e.x)-h),o=r<t?a*r/t:r-t+a;return o},b=function(e){var t=va(3,e.mrc||0),a=1-1/t,r=_a(g.c2p(e.y)-m);return r<t?a*r/t:r-t+a},v=function(e){var t=va(x,e.mrc||0),a=u.c2p(e.x)-h,r=g.c2p(e.y)-m;return va(N(a*a+r*r)-t,1-x/t)},k=r.getDistanceFunction(d,_,b,v);if(r.getClosest(c,k,e),!1!==e.index){var w=c[e.index],T=u.c2p(w.x,!0),A=g.c2p(w.y,!0),S=w.mrc||1;e.index=w.i;var C=c[0].t.orientation,L=C&&(w.sNorm||w.s),E="h"===C?L:w.x,I="v"===C?L:w.y;return a.extendFlat(e,{color:i(p,w),x0:T-S,x1:T+S,xLabelVal:E,y0:A-S,y1:A+S,yLabelVal:I,spikeDistance:v(w),hovertemplate:p.hovertemplate}),l(w,p,e),o.getComponentMethod("errorbars","hoverInfo")(w,p,e),[e]}}if(-1!==f.indexOf("fills")&&p._polygons){var z=p._polygons,P=[],D=!1,O=1/0,R=-Infinity,M=1/0,F=-Infinity,B,V,U,H,G,q,Y,W,X;for(B=0;B<z.length;B++)U=z[B],U.contains(y)&&(D=!D,P.push(U),M=ea(M,U.ymin),F=va(F,U.ymax));if(D){M=va(M,0),F=ea(F,g._length);var Z=(M+F)/2;for(B=0;B<P.length;B++)for(H=P[B].pts,V=1;V<H.length;V++)W=H[V-1][1],X=H[V][1],W>Z!=X>=Z&&(q=H[V-1][0],Y=H[V][0],X-W&&(G=q+(Y-q)*(Z-W)/(X-W),O=ea(O,G),R=va(R,G)));O=va(O,0),R=ea(R,u._length);var K=n.defaultLine;return n.opacity(p.fillcolor)?K=p.fillcolor:n.opacity((p.line||{}).color)&&(K=p.line.color),a.extendFlat(e,{distance:e.maxHoverDistance,x0:O,x1:R,y0:Z,y1:Z,color:K,hovertemplate:!1}),delete e.index,e.text=p.text&&!Array.isArray(p.text)?p.text+"":p.name,[e]}}}},{"../../components/color":593,"../../components/fx":632,"../../lib":719,"../../registry":847,"./get_trace_color":1121}],1123:[function(e,t){"use strict";var a=e("./subtypes");t.exports={hasLines:a.hasLines,hasMarkers:a.hasMarkers,hasText:a.hasText,isBubble:a.isBubble,attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./cross_trace_calc"),arraysToCalcdata:e("./arrays_to_calcdata"),plot:e("./plot"),colorbar:e("./marker_colorbar"),style:e("./style").style,styleOnSelect:e("./style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"./arrays_to_calcdata":1111,"./attributes":1112,"./calc":1113,"./cross_trace_calc":1117,"./cross_trace_defaults":1118,"./defaults":1119,"./hover":1122,"./marker_colorbar":1129,"./plot":1131,"./select":1132,"./style":1134,"./subtypes":1135}],1124:[function(e,t){"use strict";var a=e("../../lib").isArrayOrTypedArray,r=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/defaults");t.exports=function(e,t,i,n,l,s){var d=(e.marker||{}).color;if(l("line.color",i),r(e,"line"))o(e,t,n,l,{prefix:"line.",cLetter:"c"});else{var c=!a(d)&&d||i;l("line.color",c)}l("line.width"),(s||{}).noDash||l("line.dash")}},{"../../components/colorscale/defaults":603,"../../components/colorscale/helpers":604,"../../lib":719}],1125:[function(e,t){"use strict";var a=e("../../constants/numerical"),r=a.BADNUM,o=a.LOG_CLIP,i=o+.5,n=o-.5,l=e("../../lib"),s=l.segmentsIntersect,d=l.constrain,c=e("./constants");t.exports=function(e,t){function a(t){var a=e[t];if(!a)return!1;var o=k.c2p(a.x),l=w.c2p(a.y);if(o===r){if(T&&(o=k.c2p(a.x,!0)),o===r)return!1;A&&l===r&&(o*=_a(k._m*C*(0<k._m?i:n)/(w._m*S*(0<w._m?i:n)))),o*=1e3}if(l===r){if(A&&(l=w.c2p(a.y,!0)),l===r)return!1;l*=1e3}return[o,l]}function o(e,t,a,r){var o=a-e,i=r-t,n=.5-e,l=.5-t,s=o*o+i*i,d=o*n+i*l;if(0<d&&d<s){var c=n*i-l*o;if(c*c<s)return!0}}function p(e,t){var a=e[0]/S,r=e[1]/C,i=va(0,-a,a-1,-r,r-1);return i&&void 0!==ne&&o(a,r,ne,le)&&(i=0),i&&t&&o(a,r,t[0]/S,t[1]/C)&&(i=0),(1+c.toleranceGrowth*i)*E}function u(e,t){var a=e[0]-t[0],r=e[1]-t[1];return N(a*a+r*r)}function g(e,t){for(var a=[],r=0,o=0;4>o;o++){var n=H[o],l=s(e[0],e[1],t[0],t[1],n[0],n[1],n[2],n[3]);l&&(!r||1<_a(l.x-a[0][0])||1<_a(l.y-a[0][1]))&&(l=[l.x,l.y],r&&u(l,e)<u(a[0],e)?a.unshift(l):a.push(l),r++)}return a}function h(e){if(e[0]<F||e[0]>B||e[1]<V||e[1]>U)return[d(e[0],F,B),d(e[1],V,U)]}function m(e,t){return!(e[0]!==t[0]||e[0]!==F&&e[0]!==B)||!(e[1]!==t[1]||e[1]!==V&&e[1]!==U)||void 0}function y(e,t){var a=[],r=h(e),o=h(t);return r&&o&&m(r,o)?a:(r&&a.push(r),o&&a.push(o),a)}function f(e,t,a){return function(r,o){var i=h(r),n=h(o),s=[];if(i&&n&&m(i,n))return s;i&&s.push(i),n&&s.push(n);var d=2*l.constrain((r[e]+o[e])/2,t,a)-((i||r)[e]+(n||o)[e]);if(d){var c;c=i&&n?0<d==i[e]>n[e]?i:n:i||n,c[e]+=d}return s}}function x(e,t){var a=t[0]-e[0],r=(t[1]-e[1])/a,o=(e[1]*t[0]-t[1]*e[0])/a;return 0<o?[0<r?F:B,U]:[0<r?B:F,V]}function _(e){var t=e[0],a=e[1],r=t===R[M-1][0],o=a===R[M-1][1];if(!(r&&o))if(1<M){var i=t===R[M-2][0],n=a===R[M-2][1];r&&(t===F||t===B)&&i?n?M--:R[M-1]=e:o&&(a===V||a===U)&&n?i?M--:R[M-1]=e:R[M++]=e}else R[M++]=e}function b(e){R[M-1][0]!==e[0]&&R[M-1][1]!==e[1]&&_([ce,pe]),_(e),ue=null,ce=pe=0}function v(e){if(ne=e[0]/S,le=e[1]/C,se=e[0]<F?F:e[0]>B?B:0,de=e[1]<V?V:e[1]>U?U:0,se||de){if(!M)R[M++]=[se||e[0],de||e[1]];else if(ue){var t=he(ue,e);1<t.length&&(b(t[0]),R[M++]=t[1])}else ge=he(R[M-1],e)[0],R[M++]=ge;var a=R[M-1];se&&de&&(a[0]!==se||a[1]!==de)?(ue&&(ce!==se&&pe!==de?ce&&pe?_(x(ue,e)):_([ce||se,pe||de]):ce&&pe&&_([ce,pe])),_([se,de])):ce-se&&pe-de&&_([se||ce,de||pe]),ue=e,ce=se,pe=de}else ue&&b(he(ue,e)[0]),R[M++]=e}var k=t.xaxis,w=t.yaxis,T="log"===k.type,A="log"===w.type,S=k._length,C=w._length,L=t.connectGaps,E=t.baseTolerance,I=t.shape,z=t.fill&&"none"!==t.fill,P=[],D=c.minTolerance,O=e.length,R=Array(O),M=0,j=c.maxScreensAway,F=-S*j,B=S*(1+j),V=-C*j,U=C*(1+j),H=[[F,V,B,V],[B,V,B,U],[B,U,F,U],[F,U,F,V]],G,q,Y,W,X,Z,K,J,Q,$,ee,te,ae,re,oe,ie,ne,le,se,de,ce,pe,ue,ge,he;for("linear"===I||"spline"===I?he=g:"hv"===I||"vh"===I?he=y:"hvh"===I?he=f(0,F,B):"vhv"===I&&(he=f(1,V,U)),G=0;G<O;G++)if(q=a(G),q){for(M=0,ue=null,v(q),G++;G<O;G++){if(W=a(G),!W)if(L)continue;else break;if(!("linear"===I)||!t.simplify){v(W);continue}var me=a(G+1);if($=u(W,q),z&&(0===M||M===O-1)||!($<p(W,me)*D)){for(J=[(W[0]-q[0])/$,(W[1]-q[1])/$],X=q,ee=$,te=re=oe=0,K=!1,Y=W,G++;G<e.length;G++){if(Z=me,me=a(G+1),!Z)if(L)continue;else break;if(Q=[Z[0]-q[0],Z[1]-q[1]],ie=Q[0]*J[1]-Q[1]*J[0],re=ea(re,ie),oe=va(oe,ie),oe-re>p(Z,me))break;Y=Z,ae=Q[0]*J[0]+Q[1]*J[1],ae>ee?(ee=ae,W=Z,K=!1):ae<te&&(te=ae,X=Z,K=!0)}if(K?(v(W),Y!==X&&v(X)):(X!==q&&v(X),Y!==W&&v(W)),v(Y),G>=e.length||!Z)break;v(Z),q=Z}}ue&&_([ce||ue[0],pe||ue[1]]),P.push(R.slice(0,M))}return P}},{"../../constants/numerical":695,"../../lib":719,"./constants":1116}],1126:[function(e,t){"use strict";t.exports=function(e,t,a){var r=a("line.shape");"spline"===r&&a("line.smoothing")}},{}],1127:[function(e,t){"use strict";var a={tonextx:1,tonexty:1,tonext:1};t.exports=function(e,t,r){var o={},n=!1,l=-1,s=0,d=-1,c,p,u,g,h;for(p=0;p<r.length;p++)c=r[p][0].trace,u=c.stackgroup||"",u?u in o?h=o[u]:(h=o[u]=s,s++):c.fill in a&&0<=d?h=d:(h=d=s,s++),h<l&&(n=!0),c._groupIndex=l=h;var m=r.slice();n&&m.sort(function(e,t){var a=e[0].trace,r=t[0].trace;return a._groupIndex-r._groupIndex||a.index-r.index});var y={};for(p=0;p<m.length;p++)c=m[p][0].trace,u=c.stackgroup||"",!0===c.visible?(c._nexttrace=null,c.fill in a&&(g=y[u],c._prevtrace=g||null,g&&(g._nexttrace=c)),c._ownfill=c.fill&&("tozero"===c.fill.substr(0,6)||"toself"===c.fill||"to"===c.fill.substr(0,2)&&!c._prevtrace),y[u]=c):c._prevtrace=c._nexttrace=c._ownfill=null;return m}},{}],1128:[function(e,t){"use strict";var a=e("fast-isnumeric");t.exports=function(e){var t=e.marker,r=t.sizeref||1,o=t.sizemin||0,i="area"===t.sizemode?function(e){return N(e/r)}:function(e){return e/r};return function(e){var t=i(e/2);return a(t)&&0<t?va(t,o):0}}},{"fast-isnumeric":225}],1129:[function(e,t){"use strict";t.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1130:[function(e,t){"use strict";var a=e("../../components/color"),r=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/defaults"),i=e("./subtypes");t.exports=function(e,t,n,l,s,d){var c=i.isBubble(e),p=(e.line||{}).color,u;if(d=d||{},p&&(n=p),s("marker.symbol"),s("marker.opacity",c?.7:1),s("marker.size"),s("marker.color",n),r(e,"marker")&&o(e,t,l,s,{prefix:"marker.",cLetter:"c"}),d.noSelect||(s("selected.marker.color"),s("unselected.marker.color"),s("selected.marker.size"),s("unselected.marker.size")),d.noLine||(u=p&&!Array.isArray(p)&&t.marker.color!==p?p:c?a.background:a.defaultLine,s("marker.line.color",u),r(e,"marker.line")&&o(e,t,l,s,{prefix:"marker.line.",cLetter:"c"}),s("marker.line.width",c?1:0)),c&&(s("marker.sizeref"),s("marker.sizemin"),s("marker.sizemode")),d.gradient){var g=s("marker.gradient.type");"none"!==g&&s("marker.gradient.color")}}},{"../../components/color":593,"../../components/colorscale/defaults":603,"../../components/colorscale/helpers":604,"./subtypes":1135}],1131:[function(e,t){"use strict";function a(e,t,a){t.each(function(t){var r=c(n.select(this),"g","fills");u.setClipUrl(r,a.layerClipId,e);var o=t[0].trace,i=[];o._ownfill&&i.push("_ownFill"),o._nexttrace&&i.push("_nextFill");var l=r.selectAll("g").data(i,p);l.enter().append("g"),l.exit().each(function(e){o[e]=null}).remove(),l.order().each(function(e){o[e]=c(n.select(this),"path","js-fill")})})}function r(e,t,a,r,d,m,f){function _(e){return x?e.transition():e}function b(e){_(e).attr("d","M0,0Z")}function v(e){return e.filter(function(e){return!e.gap&&e.vis})}function k(e){return e.filter(function(e){return e.vis})}function w(e){return e.filter(function(e){return!e.gap})}function T(e){return e.id}function A(e){if(e.ids)return T}function S(){return!1}function C(t,r,o){var i=o[0].trace,l=g.hasMarkers(i),s=g.hasText(i),d=A(i),c=S,h=S,m,y,f;if(l||s){var b=p,T=i.stackgroup,C=T&&"infer zero"===e._fullLayout._scatterStackOpts[E._id+I._id][T].stackgaps;i.marker.maxdisplayed||i._needsCull?b=C?k:v:T&&!C&&(b=w),l&&(c=b),s&&(h=b)}y=t.selectAll("path.point"),m=y.data(c,d);var L=m.enter().append("path").classed("point",!0);x&&L.call(u.pointStyle,i,e).call(u.translatePoints,E,I).style("opacity",0).transition().style("opacity",1),m.order();var z;l&&(z=u.makePointStyleFns(i)),m.each(function(t){var r=n.select(this),o=_(r);f=u.translatePoint(t,o,E,I),f?(u.singlePointStyle(t,o,i,z,e),a.layerClipId&&u.hideOutsideRangePoint(t,o,E,I,i.xcalendar,i.ycalendar),i.customdata&&r.classed("plotly-customdata",null!==t.data&&void 0!==t.data)):o.remove()}),x?m.exit().transition().style("opacity",0).remove():m.exit().remove(),y=r.selectAll("g"),m=y.data(h,d),m.enter().append("g").classed("textpoint",!0).append("text"),m.order(),m.each(function(e){var t=n.select(this),r=_(t.select("text"));f=u.translatePoint(e,r,E,I),f?a.layerClipId&&u.hideOutsideRangePoint(e,t,E,I,i.xcalendar,i.ycalendar):t.remove()}),m.selectAll("text").call(u.textPointStyle,i,e).each(function(e){var t=E.c2p(e.x),a=I.c2p(e.y);n.select(this).selectAll("tspan.line").each(function(){_(n.select(this)).attr({x:t,y:a})})}),m.exit().remove()}var L;o(e,t,a,r,d);var x=!!f&&0<f.duration,E=a.xaxis,I=a.yaxis,z=r[0].trace,P=z.line,D=n.select(m),O=c(D,"g","errorbars"),R=c(D,"g","lines"),M=c(D,"g","points"),j=c(D,"g","text");if(l.getComponentMethod("errorbars","plot")(e,O,a,f),!0===z.visible){_(D).style("opacity",z.opacity);var F=z.fill.charAt(z.fill.length-1),B,N;"x"!==F&&"y"!==F&&(F=""),r[0][a.isRangePlot?"nodeRangePlot3":"node3"]=D;var V="",U=[],H=z._prevtrace;H&&(V=H._prevRevpath||"",N=H._nextFill,U=H._polygons);var G="",q="",Y=[],W=s.noop,X,Z,K,J,Q,$,ee,te,ae;if(B=z._ownFill,g.hasLines(z)||"none"!==z.fill){for(N&&N.datum(r),-1===["hv","vh","hvh","vhv"].indexOf(P.shape)?"spline"===P.shape?K=J=function(e){var t=e[e.length-1];return 1<e.length&&e[0][0]===t[0]&&e[0][1]===t[1]?u.smoothclosed(e.slice(1),P.smoothing):u.smoothopen(e,P.smoothing)}:K=J=function(e){return"M"+e.join("L")}:(K=u.steps(P.shape),J=u.steps(P.shape.split("").reverse().join(""))),Q=function(e){return J(e.reverse())},Y=h(r,{xaxis:E,yaxis:I,connectGaps:z.connectgaps,baseTolerance:va(P.width||1,3)/4,shape:P.shape,simplify:P.simplify,fill:z.fill}),ae=z._polygons=Array(Y.length),L=0;L<Y.length;L++)z._polygons[L]=y(Y[L]);Y.length&&($=Y[0][0],ee=Y[Y.length-1],te=ee[ee.length-1]),W=function(e){return function(t){if(X=K(t),Z=Q(t),G?F?(G+="L"+X.substr(1),q=Z+("L"+q.substr(1))):(G+="Z"+X,q=Z+"Z"+q):(G=X,q=Z),g.hasLines(z)&&1<t.length){var a=n.select(this);if(a.datum(r),e)_(a.style("opacity",0).attr("d",X).call(u.lineGroupStyle)).style("opacity",1);else{var o=_(a);o.attr("d",X),u.singleLineStyle(r,o)}}}}}var re=R.selectAll(".js-line").data(Y);_(re.exit()).style("opacity",0).remove(),re.each(W(!1)),re.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(u.lineGroupStyle).each(W(!0)),u.setClipUrl(re,a.layerClipId,e),Y.length?(B?(B.datum(r),$&&te&&(F?("y"===F?$[1]=te[1]=I.c2p(0,!0):"x"===F&&($[0]=te[0]=E.c2p(0,!0)),_(B).attr("d","M"+te+"L"+$+"L"+G.substr(1)).call(u.singleFillStyle)):_(B).attr("d",G+"Z").call(u.singleFillStyle))):N&&("tonext"===z.fill.substr(0,6)&&G&&V?("tonext"===z.fill?_(N).attr("d",G+"Z"+V+"Z").call(u.singleFillStyle):_(N).attr("d",G+"L"+V.substr(1)+"Z").call(u.singleFillStyle),z._polygons=z._polygons.concat(U)):(b(N),z._polygons=null)),z._prevRevpath=q,z._prevPolygons=ae):(B?b(B):N&&b(N),z._polygons=z._prevRevpath=z._prevPolygons=null),M.datum(r),j.datum(r),C(M,j,r);var oe=!1===z.cliponaxis,ie=oe?null:a.layerClipId;u.setClipUrl(M,ie,e),u.setClipUrl(j,ie,e)}}function o(e,t,a,r,o){var i=a.xaxis,l=a.yaxis,d=n.extent(s.simpleMap(i.range,i.r2c)),c=n.extent(s.simpleMap(l.range,l.r2c)),p=r[0].trace;if(g.hasMarkers(p)){var u=p.marker.maxdisplayed;if(0!==u){var h=r.filter(function(e){return e.x>=d[0]&&e.x<=d[1]&&e.y>=c[0]&&e.y<=c[1]}),m=M(h.length/u),y=0;o.forEach(function(e,a){var r=e[0].trace;g.hasMarkers(r)&&0<r.marker.maxdisplayed&&a<t&&y++});var f=V(y*m/3+ba(y/3)*m/7.1);r.forEach(function(e){delete e.vis}),h.forEach(function(e,t){0===V((t+f)%m)&&(e.vis=!0)})}}}var n=e("d3"),l=e("../../registry"),s=e("../../lib"),c=s.ensureSingle,p=s.identity,u=e("../../components/drawing"),g=e("./subtypes"),h=e("./line_points"),m=e("./link_traces"),y=e("../../lib/polygon").tester;t.exports=function(e,t,o,i,l,s){var d=!!l&&0<l.duration,c=m(e,t,o),p,u;if(p=i.selectAll("g.trace").data(c,function(e){return e[0].trace.uid}),p.enter().append("g").attr("class",function(e){return"trace scatter trace"+e[0].trace.uid}).style("stroke-miterlimit",2),p.order(),a(e,p,t),d){s&&(u=s());var g=n.transition().duration(l.duration).ease(l.easing).each("end",function(){u&&u()}).each("interrupt",function(){u&&u()});g.each(function(){i.selectAll("g.trace").each(function(a,o){r(e,o,t,a,c,this,l)})})}else p.each(function(a,o){r(e,o,t,a,c,this,l)});!l&&p.exit().remove(),i.selectAll("path:not([d])").remove()}},{"../../components/drawing":614,"../../lib":719,"../../lib/polygon":731,"../../registry":847,"./line_points":1125,"./link_traces":1127,"./subtypes":1135,d3:163}],1132:[function(e,t){"use strict";var a=e("./subtypes");t.exports=function(e,t){var r=e.cd,o=e.xaxis,n=e.yaxis,l=[],s=r[0].trace,d=!a.hasMarkers(s)&&!a.hasText(s),c,p,u,g;if(d)return[];if(!1===t)for(c=0;c<r.length;c++)r[c].selected=0;else for(c=0;c<r.length;c++)p=r[c],u=o.c2p(p.x),g=n.c2p(p.y),null!==p.i&&t.contains([u,g],!1,c,e)?(l.push({pointNumber:p.i,x:o.c2d(p.x),y:n.c2d(p.y)}),p.selected=1):p.selected=0;return l}},{"./subtypes":1135}],1133:[function(e,t){"use strict";var a=["orientation","groupnorm","stackgaps"];t.exports=function(e,t,r,o){var n=r._scatterStackOpts,l=o("stackgroup");if(l){var s=t.xaxis+t.yaxis,d=n[s];d||(d=n[s]={});var c=d[l],p=!1;c?c.traces.push(t):(c=d[l]={traceIndices:[],traces:[t]},p=!0);for(var u={orientation:t.x&&!t.y?"h":"v"},g=0;g<a.length;g++){var h=a[g],m=h+"Found";if(!c[m]){var y=e[h]!==void 0,f="orientation"===h;if((y||p)&&(c[h]=o(h,u[h]),f&&(c.fillDflt="h"===c[h]?"tonextx":"tonexty"),y&&(c[m]=!0,!p&&(delete c.traces[0][h],f))))for(var x=0,_;x<c.traces.length-1;x++)_=c.traces[x],_._input.fill!==_.fill&&(_.fill=c.fillDflt)}}return c}}},{}],1134:[function(e,t){"use strict";function a(e,t,a){i.pointStyle(e.selectAll("path.point"),t,a)}function r(e,t,a){i.textPointStyle(e.selectAll("text"),t,a)}var o=e("d3"),i=e("../../components/drawing"),n=e("../../registry");t.exports={style:function(e){var t=o.select(e).selectAll("g.trace.scatter");t.style("opacity",function(e){return e[0].trace.opacity}),t.selectAll("g.points").each(function(t){var r=o.select(this),i=t.trace||t[0].trace;a(r,i,e)}),t.selectAll("g.text").each(function(t){var a=o.select(this),i=t.trace||t[0].trace;r(a,i,e)}),t.selectAll("g.trace path.js-line").call(i.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(i.fillGroupStyle),n.getComponentMethod("errorbars","style")(t)},stylePoints:a,styleText:r,styleOnSelect:function(e,t,o){var n=t[0].trace;n.selectedpoints?(i.selectedPointStyle(o.selectAll("path.point"),n),i.selectedTextStyle(o.selectAll("text"),n)):(a(o,n,e),r(o,n,e))}}},{"../../components/drawing":614,"../../registry":847,d3:163}],1135:[function(e,t){"use strict";var a=e("../../lib");t.exports={hasLines:function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("lines")},hasMarkers:function(e){return e.visible&&(e.mode&&-1!==e.mode.indexOf("markers")||"splom"===e.type)},hasText:function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("text")},isBubble:function(e){return a.isPlainObject(e.marker)&&a.isArrayOrTypedArray(e.marker.size)}}},{"../../lib":719}],1136:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t,r,o,i){i=i||{},o("textposition"),a.coerceFont(o,"textfont",r.font),i.noSelect||(o("selected.textfont.color"),o("unselected.textfont.color"))}},{"../../lib":719}],1137:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../registry");t.exports=function(e,t,o,i){var n=i("x"),l=i("y"),s=r.getComponentMethod("calendars","handleTraceDefaults"),d;if(s(e,t,["x","y"],o),n){var c=a.minRowLength(n);l?d=ea(c,a.minRowLength(l)):(d=c,i("y0"),i("dy"))}else{if(!l)return 0;d=a.minRowLength(l),i("x0"),i("dx")}return t._length=d,d}},{"../../lib":719,"../../registry":847}],1138:[function(e,t){"use strict";function a(){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var r=e("../scatter/attributes"),o=e("../../components/colorscale/attributes"),i=e("../../components/fx/hovertemplate_attributes"),n=e("../../plots/attributes"),l=e("../../constants/gl3d_dashes"),s=e("../../constants/gl3d_markers"),d=e("../../lib/extend").extendFlat,c=e("../../plot_api/edit_types").overrideAll,p=r.line,u=r.marker,g=u.line,h=d({width:p.width,dash:{valType:"enumerated",values:Object.keys(l),dflt:"solid"}},o("line")),m=t.exports=c({x:r.x,y:r.y,z:{valType:"data_array"},text:d({},r.text,{}),hovertext:d({},r.hovertext,{}),hovertemplate:i(),mode:d({},r.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:a("x"),y:a("y"),z:a("z")},connectgaps:r.connectgaps,line:h,marker:d({symbol:{valType:"enumerated",values:Object.keys(s),dflt:"circle",arrayOk:!0},size:d({},u.size,{dflt:8}),sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,opacity:d({},u.opacity,{arrayOk:!1}),colorbar:u.colorbar,line:d({width:d({},g.width,{arrayOk:!1})},o("marker.line"))},o("marker")),textposition:d({},r.textposition,{dflt:"top center"}),textfont:{color:r.textfont.color,size:r.textfont.size,family:d({},r.textfont.family,{arrayOk:!1})},hoverinfo:d({},n.hoverinfo)},"calc","nested");m.x.editType=m.y.editType=m.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../constants/gl3d_dashes":692,"../../constants/gl3d_markers":693,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../scatter/attributes":1112}],1139:[function(e,t){"use strict";var a=e("../scatter/arrays_to_calcdata"),r=e("../scatter/colorscale_calc");t.exports=function(e,t){var o=[{x:!1,y:!1,trace:t,t:{}}];return a(o,t),r(e,t),o}},{"../scatter/arrays_to_calcdata":1111,"../scatter/colorscale_calc":1115}],1140:[function(e,t){"use strict";function a(e,t,a,r){if(!t||!t.visible)return null;for(var n=o.getComponentMethod("errorbars","makeComputeError")(t),l=Array(e.length),s=0,d;s<e.length;s++)if(d=n(+e[s],s),"log"===r.type){var c=r.c2l(e[s]),p=e[s]-d[0],u=e[s]+d[1];if(l[s]=[(r.c2l(p,!0)-c)*a,(r.c2l(u,!0)-c)*a],0<p){var g=r.c2l(p);r._lowerLogErrorBound||(r._lowerLogErrorBound=g),r._lowerErrorBound=ea(r._lowerLogErrorBound,g)}}else l[s]=[-d[0]*a,d[1]*a];return l}function r(e){for(var t=0;t<e.length;t++)if(e[t])return e[t].length;return 0}var o=e("../../registry");t.exports=function(e,t,o){var l=[a(e.x,e.error_x,t[0],o.xaxis),a(e.y,e.error_y,t[1],o.yaxis),a(e.z,e.error_z,t[2],o.zaxis)],s=r(l);if(0===s)return null;for(var n=Array(s),d=0,c;d<s;d++){c=[[0,0,0],[0,0,0]];for(var p=0;3>p;p++)if(l[p])for(var u=0;2>u;u++)c[u][p]=l[p][d][u];n[d]=c}return n}},{"../../registry":847}],1141:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}function r(e,t,a){var r=(a+1)%3,o=(a+2)%3,n=[],l=[],s;for(s=0;s<e.length;++s){var d=e[s];!isNaN(d[r])&&isFinite(d[r])&&!isNaN(d[o])&&isFinite(d[o])&&(n.push([d[r],d[o]]),l.push(s))}var p=x(n);for(s=0;s<p.length;++s)for(var u=p[s],c=0;c<u.length;++c)u[c]=l[u[c]];return{positions:e,cells:p,meshColor:t}}function o(t){for(var a=[0,0,0],r=[[0,0,0],[0,0,0],[0,0,0]],o=[1,1,1],n=0,l;3>n;n++)l=t[n],l&&!1!==l.copy_zstyle&&!1!==t[2].visible&&(l=t[2]),!l||!l.visible||(a[n]=l.width/2,r[n]=b(l.color),o[n]=l.thickness);return{capSize:a,color:r,lineWidth:o}}function n(e){return null===e||void 0===e?0:-1<e.indexOf("left")?-1:-1<e.indexOf("right")?1:0}function l(e){return null===e||void 0===e?0:-1<e.indexOf("top")?-1:-1<e.indexOf("bottom")?1:0}function s(e){var t=0,a=[0,t];if(Array.isArray(e))for(var r=0;r<e.length;r++)a[r]=[0,t],e[r]&&(a[r][0]=n(e[r]),a[r][1]=l(e[r]));else a[0]=n(e),a[1]=l(e);return a}function d(e,t){return t(4*e)}function c(e){return T[e]}function p(e,t,a,r,o){var n=null;if(_.isArrayOrTypedArray(e)){n=[];for(var l=0;l<t;l++)n[l]=void 0===e[l]?r:a(e[l],o)}else n=a(e,_.identity);return n}function u(e,t){var a=[],r=e.fullSceneLayout,n=e.dataScale,l=r.xaxis,u=r.yaxis,g=r.zaxis,h=t.marker,m=t.line,f=t.x||[],x=t.y||[],y=t.z||[],w=f.length,T=t.xcalendar,S=t.ycalendar,C=t.zcalendar,L,E,I,z,P,D;for(P=0;P<w;P++)L=l.d2l(f[P],0,T)*n[0],E=u.d2l(x[P],0,S)*n[1],I=g.d2l(y[P],0,C)*n[2],a[P]=[L,E,I];if(Array.isArray(t.text))D=t.text;else if(void 0!==t.text)for(D=Array(w),P=0;P<w;P++)D[P]=t.text;if(z={position:a,mode:t.mode,text:D},"line"in t&&(z.lineColor=v(m,1,w),z.lineWidth=m.width,z.lineDashes=m.dash),"marker"in t){var O=k(t);z.scatterColor=v(h,1,w),z.scatterSize=p(h.size,w,d,20,O),z.scatterMarker=p(h.symbol,w,c,"\u25CF"),z.scatterLineWidth=h.line.width,z.scatterLineColor=v(h.line,1,w),z.scatterAngle=0}"textposition"in t&&(z.textOffset=s(t.textposition),z.textColor=v(t.textfont,1,w),z.textSize=p(t.textfont.size,w,_.identity,12),z.textFont=t.textfont.family,z.textAngle=0);var R=["x","y","z"];for(z.project=[!1,!1,!1],z.projectScale=[1,1,1],z.projectOpacity=[1,1,1],P=0;3>P;++P){var M=t.projection[R[P]];(z.project[P]=M.show)&&(z.projectOpacity[P]=M.opacity,z.projectScale[P]=M.scale)}z.errorBounds=A(t,n,r);var j=o([t.error_x,t.error_y,t.error_z]);return z.errorColor=j.color,z.errorLineWidth=j.lineWidth,z.errorCapSize=j.capSize,z.delaunayAxis=t.surfaceaxis,z.delaunayColor=b(t.surfacecolor),z}function g(e){if(Array.isArray(e)){var t=e[0];return Array.isArray(t)&&(e=t),"rgb("+e.slice(0,3).map(function(e){return V(255*e)})+")"}return null}var h=e("gl-line3d"),m=e("gl-scatter3d"),y=e("gl-error3d"),f=e("gl-mesh3d"),x=e("delaunay-triangulate"),_=e("../../lib"),b=e("../../lib/str2rgbarray"),v=e("../../lib/gl_format_color").formatColor,k=e("../scatter/make_bubble_size_func"),w=e("../../constants/gl3d_dashes"),T=e("../../constants/gl3d_markers"),A=e("./calc_errors"),S=a.prototype;S.handlePick=function(e){if(e.object&&(e.object===this.linePlot||e.object===this.delaunayMesh||e.object===this.textMarkers||e.object===this.scatterPlot)){var t=e.index=e.data.index;return e.object.highlight&&e.object.highlight(null),this.scatterPlot&&(e.object=this.scatterPlot,this.scatterPlot.highlight(e.data)),e.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[t]||0===this.textLabels[t])&&(e.textLabel=this.textLabels[t]):e.textLabel=this.textLabels),e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]],!0}},S.update=function(e){var t=this.scene.glplot.gl,a=w.solid,o,i,n,l;this.data=e;var s=u(this.scene,e);"mode"in s&&(this.mode=s.mode),"lineDashes"in s&&s.lineDashes in w&&(a=w[s.lineDashes]),this.color=g(s.scatterColor)||g(s.lineColor),this.dataPoints=s.position,o={gl:this.scene.glplot.gl,position:s.position,color:s.lineColor,lineWidth:s.lineWidth||1,dashes:a[0],dashScale:a[1],opacity:e.opacity,connectGaps:e.connectgaps},-1===this.mode.indexOf("lines")?this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null):this.linePlot?this.linePlot.update(o):(this.linePlot=h(o),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot));var d=e.opacity;if(e.marker&&e.marker.opacity&&(d*=e.marker.opacity),i={gl:this.scene.glplot.gl,position:s.position,color:s.scatterColor,size:s.scatterSize,glyph:s.scatterMarker,opacity:d,orthographic:!0,lineWidth:s.scatterLineWidth,lineColor:s.scatterLineColor,project:s.project,projectScale:s.projectScale,projectOpacity:s.projectOpacity},-1===this.mode.indexOf("markers")?this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null):this.scatterPlot?this.scatterPlot.update(i):(this.scatterPlot=m(i),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)),l={gl:this.scene.glplot.gl,position:s.position,glyph:s.text,color:s.textColor,size:s.textSize,angle:s.textAngle,alignment:s.textOffset,font:s.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:e.opacity},this.textLabels=e.hovertext||e.text,-1===this.mode.indexOf("text")?this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null):this.textMarkers?this.textMarkers.update(l):(this.textMarkers=m(l),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)),n={gl:this.scene.glplot.gl,position:s.position,color:s.errorColor,error:s.errorBounds,lineWidth:s.errorLineWidth,capSize:s.errorCapSize,opacity:e.opacity},this.errorBars?s.errorBounds?this.errorBars.update(n):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):s.errorBounds&&(this.errorBars=y(n),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),0<=s.delaunayAxis){var c=r(s.position,s.delaunayColor,s.delaunayAxis);c.opacity=e.opacity,this.delaunayMesh?this.delaunayMesh.update(c):(c.gl=t,this.delaunayMesh=f(c),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},S.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},t.exports=function(e,t){var r=new a(e,t.uid);return r.update(t),r}},{"../../constants/gl3d_dashes":692,"../../constants/gl3d_markers":693,"../../lib":719,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../scatter/make_bubble_size_func":1128,"./calc_errors":1140,"delaunay-triangulate":165,"gl-error3d":247,"gl-line3d":255,"gl-mesh3d":280,"gl-scatter3d":297}],1142:[function(e,t){"use strict";function a(e,t,a,o){var i=0,n=a("x"),l=a("y"),s=a("z"),d=r.getComponentMethod("calendars","handleTraceDefaults");return d(e,t,["x","y","z"],o),n&&l&&s&&(i=ea(n.length,l.length,s.length),t._length=t._xlength=t._ylength=t._zlength=i),i}var r=e("../../registry"),o=e("../../lib"),n=e("../scatter/subtypes"),l=e("../scatter/marker_defaults"),s=e("../scatter/line_defaults"),d=e("../scatter/text_defaults"),c=e("./attributes");t.exports=function(e,t,p,u){function g(a,r){return o.coerce(e,t,c,a,r)}var h=a(e,t,g,u);if(!h)return void(t.visible=!1);g("text"),g("hovertext"),g("hovertemplate"),g("mode"),n.hasLines(t)&&(g("connectgaps"),s(e,t,p,u,g)),n.hasMarkers(t)&&l(e,t,p,u,g,{noSelect:!0}),n.hasText(t)&&d(e,t,u,g,{noSelect:!0});var m=(t.line||{}).color,y=(t.marker||{}).color;0<=g("surfaceaxis")&&g("surfacecolor",m||y);for(var f=["x","y","z"],x=0,_;3>x;++x)_="projection."+f[x],g(_+".show")&&(g(_+".opacity"),g(_+".scale"));var b=r.getComponentMethod("errorbars","supplyDefaults");b(e,t,m||y||p,{axis:"z"}),b(e,t,m||y||p,{axis:"y",inherit:"z"}),b(e,t,m||y||p,{axis:"x",inherit:"z"})}},{"../../lib":719,"../../registry":847,"../scatter/line_defaults":1124,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"./attributes":1138}],1143:[function(e,t){"use strict";t.exports={plot:e("./convert"),attributes:e("./attributes"),markerSymbols:e("../../constants/gl3d_markers"),supplyDefaults:e("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:e("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","symbols","showLegend"],meta:{}}},{"../../constants/gl3d_markers":693,"../../plots/gl3d":807,"./attributes":1138,"./calc":1139,"./convert":1141,"./defaults":1142}],1144:[function(e,t){"use strict";var a=e("../scatter/attributes"),r=e("../../plots/attributes"),o=e("../../components/fx/hovertemplate_attributes"),i=e("../../components/colorscale/attributes"),n=e("../../lib/extend").extendFlat,l=a.marker,s=a.line,d=l.line;t.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:n({},a.mode,{dflt:"markers"}),text:n({},a.text,{}),hovertext:n({},a.hovertext,{}),line:{color:s.color,width:s.width,dash:s.dash,shape:n({},s.shape,{values:["linear","spline"]}),smoothing:s.smoothing,editType:"calc"},connectgaps:a.connectgaps,fill:n({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:n({symbol:l.symbol,opacity:l.opacity,maxdisplayed:l.maxdisplayed,size:l.size,sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,line:n({width:d.width,editType:"calc"},i("marker.line")),gradient:l.gradient,editType:"calc"},i("marker")),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:n({},r.hoverinfo,{flags:["a","b","text","name"]}),hoveron:a.hoveron,hovertemplate:o()}},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../scatter/attributes":1112}],1145:[function(e,t){"use strict";var r=e("fast-isnumeric"),o=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../scatter/calc").calcMarkerSize,d=e("../carpet/lookup_carpetid");t.exports=function(e,t){var c=t._carpetTrace=d(e,t);if(c&&c.visible&&"legendonly"!==c.visible){var p;t.xaxis=c.xaxis,t.yaxis=c.yaxis;var u=t._length,g=Array(u),h=!1,m,y;for(p=0;p<u;p++)if(m=t.a[p],y=t.b[p],r(m)&&r(y)){var f=c.ab2xy(+m,+y,!0),x=c.isVisible(+m,+y);x||(h=!0),g[p]={x:f[0],y:f[1],a:m,b:y,vis:x}}else g[p]={x:!1,y:!1};return t._needsCull=h,g[0].carpet=c,g[0].trace=t,s(t,u),o(e,t),n(g,t),l(g,t),g}}},{"../carpet/lookup_carpetid":915,"../scatter/arrays_to_calcdata":1111,"../scatter/calc":1113,"../scatter/calc_selection":1114,"../scatter/colorscale_calc":1115,"fast-isnumeric":225}],1146:[function(e,t){"use strict";var r=e("../../lib"),o=e("../scatter/constants"),i=e("../scatter/subtypes"),n=e("../scatter/marker_defaults"),l=e("../scatter/line_defaults"),s=e("../scatter/line_shape_defaults"),d=e("../scatter/text_defaults"),c=e("../scatter/fillcolor_defaults"),p=e("./attributes");t.exports=function(e,t,u,g){function h(a,o){return r.coerce(e,t,p,a,o)}h("carpet"),t.xaxis="x",t.yaxis="y";var m=h("a"),a=h("b"),y=ea(m.length,a.length);if(!y)return void(t.visible=!1);t._length=y,h("text"),h("hovertext");var f=y<o.PTS_LINESONLY?"lines+markers":"lines";h("mode",f),i.hasLines(t)&&(l(e,t,u,g,h),s(e,t,h),h("connectgaps")),i.hasMarkers(t)&&n(e,t,u,g,h,{gradient:!0}),i.hasText(t)&&d(e,t,g,h);var x=[];(i.hasMarkers(t)||i.hasText(t))&&(h("marker.maxdisplayed"),x.push("points")),h("fill"),"none"!==t.fill&&(c(e,t,u,h),!i.hasLines(t)&&s(e,t,h)),("tonext"===t.fill||"toself"===t.fill)&&x.push("fills");var _=h("hoveron",x.join("+")||"points");"fills"!==_&&h("hovertemplate"),r.coerceSelectionMarkerOpacity(t,h)}},{"../../lib":719,"../scatter/constants":1116,"../scatter/fillcolor_defaults":1120,"../scatter/line_defaults":1124,"../scatter/line_shape_defaults":1126,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"./attributes":1144}],1147:[function(e,t){"use strict";t.exports=function(e,t,a,r,o){var i=r[o];return e.a=i.a,e.b=i.b,e.y=i.y,e}},{}],1148:[function(e,t){"use strict";var a=e("../scatter/hover"),r=e("../../lib").fillText;t.exports=function(e,t,o,i){function n(e,t){var a;a=e.labelprefix&&0<e.labelprefix.length?e.labelprefix.replace(/ = $/,""):e._hovertitle,k.push(a+": "+t.toFixed(3)+e.labelsuffix)}var l=a(e,t,o,i);if(l&&!1!==l[0].index){var s=l[0];if(void 0===s.index){var d=1-s.y0/e.ya._length,c=e.xa._length,p=c*d/2,u=c-p;return s.x0=va(ea(s.x0,u),p),s.x1=va(ea(s.x1,u),p),l}var g=s.cd[s.index];s.a=g.a,s.b=g.b,s.xLabelVal=void 0,s.yLabelVal=void 0;var h=s.trace,m=h._carpet,y=m.ab2ij([g.a,g.b]),f=ba(y[0]),x=y[0]-f,_=ba(y[1]),b=y[1]-_,v=m.evalxy([],f,_,x,b);s.yLabel=v[1].toFixed(3),delete s.text;var k=[];if(!h.hovertemplate){var w=g.hi||h.hoverinfo,T=w.split("+");-1!==T.indexOf("all")&&(T=["a","b","text"]),-1!==T.indexOf("a")&&n(m.aaxis,g.a),-1!==T.indexOf("b")&&n(m.baxis,g.b),k.push("y: "+s.yLabel),-1!==T.indexOf("text")&&r(g,h,k),s.extraText=k.join("<br>")}return l}}},{"../../lib":719,"../scatter/hover":1122}],1149:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:e("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../scatter/marker_colorbar":1129,"../scatter/select":1132,"../scatter/style":1134,"./attributes":1144,"./calc":1145,"./defaults":1146,"./event_data":1147,"./hover":1148,"./plot":1150}],1150:[function(e,t){"use strict";var a=e("../scatter/plot"),r=e("../../plots/cartesian/axes"),o=e("../../components/drawing");t.exports=function(e,t,n,l){var s=n[0][0].carpet,d={xaxis:r.getFromId(e,s.xaxis||"x"),yaxis:r.getFromId(e,s.yaxis||"y"),plot:t.plot},c,p,u;for(a(e,d,n,l),c=0;c<n.length;c++)p=n[c][0].trace,u=l.selectAll("g.trace"+p.uid+" .js-line"),o.setClipUrl(u,n[c][0].carpet._clipPathId,e)}},{"../../components/drawing":614,"../../plots/cartesian/axes":767,"../scatter/plot":1131}],1151:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),r=e("../scatter/attributes"),o=e("../../plots/attributes"),i=e("../../components/colorscale/attributes"),n=e("../../components/drawing/attributes").dash,l=e("../../lib/extend").extendFlat,s=e("../../plot_api/edit_types").overrideAll,d=r.marker,c=r.line,p=d.line;t.exports=s({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names"],dflt:"ISO-3"},mode:l({},r.mode,{dflt:"markers"}),text:l({},r.text,{}),hovertext:l({},r.hovertext,{}),textfont:r.textfont,textposition:r.textposition,line:{color:c.color,width:c.width,dash:n},connectgaps:r.connectgaps,marker:l({symbol:d.symbol,opacity:d.opacity,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,colorbar:d.colorbar,line:l({width:p.width},i("marker.line")),gradient:d.gradient},i("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:r.fillcolor,selected:r.selected,unselected:r.unselected,hoverinfo:l({},o.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":600,"../../components/drawing/attributes":613,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../scatter/attributes":1112}],1152:[function(e,t){"use strict";var a=e("fast-isnumeric"),r=e("../../constants/numerical").BADNUM,o=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../../lib")._;t.exports=function(e,t){for(var d=Array.isArray(t.locations),c=d?t.locations.length:t._length,p=Array(c),u=0,g;u<c;u++)if(g=p[u]={},d){var h=t.locations[u];g.loc="string"==typeof h?h:null}else{var m=t.lon[u],y=t.lat[u];g.lonlat=a(m)&&a(y)?[+m,+y]:[r,r]}return n(p,t),o(e,t),l(p,t),c&&(p[0].t={labels:{lat:s(e,"lat:")+" ",lon:s(e,"lon:")+" "}}),p}},{"../../constants/numerical":695,"../../lib":719,"../scatter/arrays_to_calcdata":1111,"../scatter/calc_selection":1114,"../scatter/colorscale_calc":1115,"fast-isnumeric":225}],1153:[function(e,t){"use strict";function a(e,t,a){var r=0,o=a("locations"),i,n;return o?(a("locationmode"),r=o.length,r):(i=a("lon")||[],n=a("lat")||[],r=ea(i.length,n.length),t._length=r,r)}var r=e("../../lib"),o=e("../scatter/subtypes"),i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/text_defaults"),s=e("../scatter/fillcolor_defaults"),d=e("./attributes");t.exports=function(e,t,c,p){function u(a,o){return r.coerce(e,t,d,a,o)}var g=a(e,t,u);return g?void(u("text"),u("hovertext"),u("hovertemplate"),u("mode"),o.hasLines(t)&&(n(e,t,c,p,u),u("connectgaps")),o.hasMarkers(t)&&i(e,t,c,p,u,{gradient:!0}),o.hasText(t)&&l(e,t,p,u),u("fill"),"none"!==t.fill&&s(e,t,c,u),r.coerceSelectionMarkerOpacity(t,u)):void(t.visible=!1)}},{"../../lib":719,"../scatter/fillcolor_defaults":1120,"../scatter/line_defaults":1124,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"./attributes":1151}],1154:[function(e,t){"use strict";t.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e.location=t.loc?t.loc:null,e}},{}],1155:[function(e,t){"use strict";function a(e,t,a,r){function o(e){return e+"\xB0"}if(!e.hovertemplate){var i=t.hi||e.hoverinfo,n="all"===i?s.hoverinfo.flags:i.split("+"),d=-1!==n.indexOf("location")&&Array.isArray(e.locations),c=-1!==n.indexOf("lon"),p=-1!==n.indexOf("lat"),u=-1!==n.indexOf("text"),g=[];return d?g.push(t.loc):c&&p?g.push("("+o(a.lonLabel)+", "+o(a.latLabel)+")"):c?g.push(r.lon+o(a.lonLabel)):p&&g.push(r.lat+o(a.latLabel)),u&&l(t,e,g),g.join("<br>")}}var r=e("../../components/fx"),o=e("../../plots/cartesian/axes"),i=e("../../constants/numerical").BADNUM,n=e("../scatter/get_trace_color"),l=e("../../lib").fillText,s=e("./attributes");t.exports=function(e,t,l){var s=e.cd,d=s[0].trace,c=e.xa,p=e.ya,u=e.subplot,g=u.projection.isLonLatOverEdges,h=u.project;if(r.getClosest(s,function(e){var a=e.lonlat;if(a[0]===i)return 1/0;if(g(a))return 1/0;var r=h(a),o=h([t,l]),n=_a(r[0]-o[0]),s=_a(r[1]-o[1]),d=va(3,e.mrc||0);return va(N(n*n+s*s)-d,1-3/d)},e),!1!==e.index){var m=s[e.index],y=m.lonlat,f=[c.c2p(y),p.c2p(y)],x=m.mrc||1;e.x0=f[0]-x,e.x1=f[0]+x,e.y0=f[1]-x,e.y1=f[1]+x,e.loc=m.loc,e.lon=y[0],e.lat=y[1];var _=u.mockAxis;return e.lonLabel=o.tickText(_,_.c2l(e.lon),"hover").text,e.latLabel=o.tickText(_,_.c2l(e.lat),"hover").text,e.color=n(d,m),e.extraText=a(d,m,e,s[0].t.labels),e.hovertemplate=d.hovertemplate,[e]}}},{"../../components/fx":632,"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../scatter/get_trace_color":1121,"./attributes":1151}],1156:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:e("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":797,"../scatter/marker_colorbar":1129,"../scatter/style":1134,"./attributes":1151,"./calc":1152,"./defaults":1153,"./event_data":1154,"./hover":1155,"./plot":1157,"./select":1158,"./style":1159}],1157:[function(e,t){"use strict";function a(e,t){var a=e[0].trace;if(Array.isArray(a.locations))for(var r=l(a,t),o=a.locationmode,d=0;d<e.length;d++){var c=e[d],p=s(o,c.loc,r);c.lonlat=p?p.properties.ct:[n,n]}}var r=e("d3"),o=e("../../lib"),n=e("../../constants/numerical").BADNUM,l=e("../../lib/topojson_utils").getTopojsonFeatures,s=e("../../lib/geo_location_utils").locationToFeature,d=e("../../lib/geojson_utils"),c=e("../scatter/subtypes"),p=e("./style");t.exports=function(e,t,l){function s(e,t){e.lonlat[0]===n&&r.select(t).remove()}for(var u=0;u<l.length;u++)a(l[u],t.topojson);var g=t.layers.frontplot.select(".scatterlayer"),h=o.makeTraceGroups(g,l,"trace scattergeo");h.selectAll("*").remove(),h.each(function(t){var a=r.select(this),i=t[0].trace;if(c.hasLines(i)||"none"!==i.fill){var n=d.calcTraceToLineCoords(t),l="none"===i.fill?d.makeLine(n):d.makePolygon(n);a.selectAll("path.js-line").data([{geojson:l,trace:i}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}c.hasMarkers(i)&&a.selectAll("path.point").data(o.identity).enter().append("path").classed("point",!0).each(function(e){s(e,this)}),c.hasText(i)&&a.selectAll("g").data(o.identity).enter().append("g").append("text").each(function(e){s(e,this)}),p(e,t)})}},{"../../constants/numerical":695,"../../lib":719,"../../lib/geo_location_utils":713,"../../lib/geojson_utils":714,"../../lib/topojson_utils":746,"../scatter/subtypes":1135,"./style":1159,d3:163}],1158:[function(e,t){"use strict";var a=e("../scatter/subtypes"),r=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var o=e.cd,n=e.xaxis,l=e.yaxis,s=[],d=o[0].trace,c=!a.hasMarkers(d)&&!a.hasText(d),p,u,g,h,m;if(c)return[];if(!1===t)for(m=0;m<o.length;m++)o[m].selected=0;else for(m=0;m<o.length;m++)p=o[m],u=p.lonlat,u[0]===r||(g=n.c2p(u),h=l.c2p(u),t.contains([g,h],null,m,e)?(s.push({pointNumber:m,lon:u[0],lat:u[1]}),p.selected=1):p.selected=0);return s}},{"../../constants/numerical":695,"../scatter/subtypes":1135}],1159:[function(e,t){"use strict";function a(e,t){var a=t[0].trace,n=t[0].node3;n.style("opacity",t[0].trace.opacity),l(n,a,e),d(n,a,e),n.selectAll("path.js-line").style("fill","none").each(function(e){var t=r.select(this),a=e.trace,n=a.line||{};t.call(i.stroke,n.color).call(o.dashLine,n.dash||"",n.width||0),"none"!==a.fill&&t.call(i.fill,a.fillcolor)})}var r=e("d3"),o=e("../../components/drawing"),i=e("../../components/color"),n=e("../scatter/style"),l=n.stylePoints,d=n.styleText;t.exports=function(e,t){t&&a(e,t)}},{"../../components/color":593,"../../components/drawing":614,"../scatter/style":1134,d3:163}],1160:[function(e,t){"use strict";var a=e("../../plots/attributes"),r=e("../scatter/attributes"),o=e("../../components/colorscale/attributes"),i=e("../../lib/extend").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=e("./constants").DASHES,s=r.line,d=r.marker,c=d.line,p=t.exports=n({x:r.x,x0:r.x0,dx:r.dx,y:r.y,y0:r.y0,dy:r.dy,text:r.text,hovertext:r.hovertext,textposition:r.textposition,textfont:r.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:s.color,width:s.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:Object.keys(l),dflt:"solid"}},marker:i({},o("marker"),{symbol:d.symbol,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:d.opacity,colorbar:d.colorbar,line:i({},o("marker.line"),{width:c.width})}),connectgaps:r.connectgaps,fill:i({},r.fill,{dflt:"none"}),fillcolor:r.fillcolor,selected:{marker:r.selected.marker,textfont:r.selected.textfont},unselected:{marker:r.unselected.marker,textfont:r.unselected.textfont},opacity:a.opacity},"calc","nested");p.x.editType=p.y.editType=p.x0.editType=p.y0.editType="calc+clearAxisTypes",p.hovertemplate=r.hovertemplate},{"../../components/colorscale/attributes":600,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../scatter/attributes":1112,"./constants":1162}],1161:[function(e,t){"use strict";function a(e,t,a){var r=e._extremes[t._id],o=l(t,a._bnds,{padded:!0});r.min=r.min.concat(o.min),r.max=r.max.concat(o.max)}function r(e,t,a,r,o,n){var l=g.style(e,a);if(l.marker&&(l.marker.positions=r),l.line&&1<r.length&&i.extendFlat(l.line,g.linePositions(e,a,r)),l.errorX||l.errorY){var s=g.errorBarPositions(e,a,r,o,n);l.errorX&&i.extendFlat(l.errorX,s.x),l.errorY&&i.extendFlat(l.errorY,s.y)}return l.text&&(i.extendFlat(l.text,{positions:r},g.textPosition(e,a,l.text,l.marker)),i.extendFlat(l.textSel,{positions:r},g.textPosition(e,a,l.text,l.markerSel)),i.extendFlat(l.textUnsel,{positions:r},g.textPosition(e,a,l.text,l.markerUnsel))),l}var o=e("point-cluster"),i=e("../../lib"),n=e("../../plots/cartesian/axis_ids"),l=e("../../plots/cartesian/autorange").findExtremes,s=e("../scatter/calc"),d=s.calcMarkerSize,c=s.calcAxisExpansion,p=s.setFirstScatter,u=e("../scatter/colorscale_calc"),g=e("./convert"),h=e("./scene_update"),m=e("../../constants/numerical").BADNUM,f=e("./constants").TOO_MANY_POINTS;t.exports=function(e,t){var l=e._fullLayout,s=n.getFromId(e,t.xaxis),g=n.getFromId(e,t.yaxis),_=l._plots[t.xaxis+t.yaxis],b=t._length,v=b>=f,k=2*b,w={},T=s.makeCalcdata(t,"x"),x=g.makeCalcdata(t,"y"),y=Array(k),A,S,C;for(A=0;A<b;A++)S=T[A],C=x[A],y[2*A]=S===m?NaN:S,y[2*A+1]=C===m?NaN:C;if("log"===s.type)for(A=0;A<k;A+=2)y[A]=s.c2l(y[A]);if("log"===g.type)for(A=1;A<k;A+=2)y[A]=g.c2l(y[A]);if(v&&"log"!==s.type&&"log"!==g.type)w.tree=o(y);else{var L=w.ids=Array(b);for(A=0;A<b;A++)L[A]=A}u(e,t);var E=r(e,_,t,y,T,x),I=h(e,_);p(l,t);var z;return v?E.marker&&(z=2*(E.marker.sizeAvg||va(E.marker.size,3))):z=d(t,b),c(e,t,s,g,T,x,z),E.errorX&&a(t,s,E.errorX),E.errorY&&a(t,g,E.errorY),E.fill&&!I.fill2d&&(I.fill2d=!0),E.marker&&!I.scatter2d&&(I.scatter2d=!0),E.line&&!I.line2d&&(I.line2d=!0),(E.errorX||E.errorY)&&!I.error2d&&(I.error2d=!0),E.text&&!I.glText&&(I.glText=!0),E.marker&&(E.marker.snap=w.tree||f),I.lineOptions.push(E.line),I.errorXOptions.push(E.errorX),I.errorYOptions.push(E.errorY),I.fillOptions.push(E.fill),I.markerOptions.push(E.marker),I.markerSelectedOptions.push(E.markerSel),I.markerUnselectedOptions.push(E.markerUnsel),I.textOptions.push(E.text),I.textSelectedOptions.push(E.textSel),I.textUnselectedOptions.push(E.textUnsel),I.selectBatch.push([]),I.unselectBatch.push([]),w._scene=I,w.index=I.count,w.x=T,w.y=x,w.positions=y,I.count++,[{x:!1,y:!1,t:w,trace:t}]}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/autorange":766,"../../plots/cartesian/axis_ids":770,"../scatter/calc":1113,"../scatter/colorscale_calc":1115,"./constants":1162,"./convert":1163,"./scene_update":1169,"point-cluster":469}],1162:[function(e,t){"use strict";t.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1163:[function(e,t){"use strict";function a(e){var t=e._length,a=e.textfont,r=e.textposition,o=Array.isArray(r)?r:[r],n=a.color,l=a.size,s=a.family,d={},p;if(d.text=e.text,Array.isArray(d.text)&&d.text.length<t)for(d.text=e.text.slice(),p=d.text.length;p<t;p++)d.text[p]="";for(d.opacity=e.opacity,d.font={},d.align=[],d.baseline=[],p=0;p<o.length;p++){var u=o[p].split(/\s+/);switch(u[1]){case"left":d.align.push("right");break;case"right":d.align.push("left");break;default:d.align.push(u[1]);}switch(u[0]){case"top":d.baseline.push("bottom");break;case"bottom":d.baseline.push("top");break;default:d.baseline.push(u[0]);}}if(Array.isArray(n))for(d.color=Array(t),p=0;p<t;p++)d.color[p]=n[p];else d.color=n;if(Array.isArray(l)||Array.isArray(s))for(d.font=Array(t),p=0;p<t;p++){var g=d.font[p]={};g.size=Array.isArray(l)?c(l[p])?l[p]:0:l,g.family=Array.isArray(s)?s[p]:s}else d.font={size:l,family:s};return d}function r(e){var t=e._length,a=e.marker,r={},o=Array.isArray(a.symbol),n=h.isArrayOrTypedArray(a.color),l=h.isArrayOrTypedArray(a.line.color),c=h.isArrayOrTypedArray(a.opacity),p=h.isArrayOrTypedArray(a.size),g=h.isArrayOrTypedArray(a.line.width),m,y;if(o||(y=v.OPEN_RE.test(a.symbol)),o||n||l||c){r.colors=Array(t),r.borderColors=Array(t);var f=x(a,a.opacity,t),_=x(a.line,a.opacity,t);if(!Array.isArray(_[0])){var k=_;for(_=Array(t),m=0;m<t;m++)_[m]=k}if(!Array.isArray(f[0])){var w=f;for(f=Array(t),m=0;m<t;m++)f[m]=w}for(r.colors=f,r.borderColors=_,m=0;m<t;m++){if(o){var T=a.symbol[m];y=v.OPEN_RE.test(T)}y&&(_[m]=f[m].slice(),f[m]=f[m].slice(),f[m][3]=0)}r.opacity=e.opacity}else y?(r.color=u(a.color,"uint8"),r.color[3]=0,r.borderColor=u(a.color,"uint8")):(r.color=u(a.color,"uint8"),r.borderColor=u(a.line.color,"uint8")),r.opacity=e.opacity*a.opacity;if(o)for(r.markers=Array(t),m=0;m<t;m++)r.markers[m]=d(a.symbol[m]);else r.marker=d(a.symbol);var A=b(e),S;if(p||g){var C=r.sizes=Array(t),L=r.borderSizes=Array(t),E=0,I;if(p){for(m=0;m<t;m++)C[m]=A(a.size[m]),E+=C[m];I=E/t}else for(S=A(a.size),m=0;m<t;m++)C[m]=S;if(g)for(m=0;m<t;m++)L[m]=a.line.width[m]/2;else for(S=a.line.width/2,m=0;m<t;m++)L[m]=S;r.sizeAvg=I}else r.size=A(a&&a.size||10),r.borderSizes=A(a.line.width);return r}function o(e,t){var a=e.marker,o={};return t?(t.marker&&t.marker.symbol?o=r(h.extendFlat({},a,t.marker)):t.marker&&(t.marker.size&&(o.size=t.marker.size/2),t.marker.color&&(o.colors=t.marker.color),void 0!==t.marker.opacity&&(o.opacity=t.marker.opacity)),o):o}function n(e,t){var r={};if(!t)return r;if(t.textfont){var o={opacity:1,text:e.text,textposition:e.textposition,textfont:h.extendFlat({},e.textfont)};t.textfont&&h.extendFlat(o.textfont,t.textfont),r=a(o)}return r}function l(e,t){var a={capSize:2*t.width,lineWidth:t.thickness,color:t.color};return t.copy_ystyle&&(a=e.error_y),a}function d(e){if("circle"===e)return null;var t=m.symbolNumber(e),a=m.symbolFuncs[t%100],r=!!m.symbolNoDot[t%100],o=!!m.symbolNoFill[t%100],i=v.DOT_RE.test(e),n,l;return C[e]?C[e]:(n=i&&!r?a(1.1*A)+L:a(A),l=p(n,{w:T,h:T,viewBox:[-A,-A,A,A],stroke:o?S:-S}),C[e]=l,l||null)}var c=e("fast-isnumeric"),p=e("svg-path-sdf"),u=e("color-normalize"),g=e("../../registry"),h=e("../../lib"),m=e("../../components/drawing"),f=e("../../plots/cartesian/axis_ids"),x=e("../../lib/gl_format_color").formatColor,_=e("../scatter/subtypes"),b=e("../scatter/make_bubble_size_func"),v=e("./constants"),k=e("../../constants/interactions").DESELECTDIM,w={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},T=v.SYMBOL_SDF_SIZE,A=v.SYMBOL_SIZE,S=v.SYMBOL_STROKE,C={},L=m.symbolFuncs[0](.05*A);t.exports={style:function(e,t){var s={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},d;if(!0!==t.visible)return s;if(_.hasText(t)&&(s.text=a(t),s.textSel=n(t,t.selected),s.textUnsel=n(t,t.unselected)),_.hasMarkers(t)&&(s.marker=r(t),s.markerSel=o(t,t.selected),s.markerUnsel=o(t,t.unselected),!t.unselected&&Array.isArray(t.marker.opacity))){var c=t.marker.opacity;for(s.markerUnsel.opacity=Array(c.length),d=0;d<c.length;d++)s.markerUnsel.opacity[d]=k*c[d]}if(_.hasLines(t)){s.line={overlay:!0,thickness:t.line.width,color:t.line.color,opacity:t.opacity};var p=(v.DASHES[t.line.dash]||[1]).slice();for(d=0;d<p.length;++d)p[d]*=t.line.width;s.line.dashes=p}return t.error_x&&t.error_x.visible&&(s.errorX=l(t,t.error_x)),t.error_y&&t.error_y.visible&&(s.errorY=l(t,t.error_y)),!t.fill||"none"===t.fill||(s.fill={closed:!0,fill:t.fillcolor,thickness:0}),s},markerStyle:r,markerSelection:o,linePositions:function(e,t,a){var r=a.length,o=r/2,n,l;if(_.hasLines(t)&&o)if("hv"===t.line.shape){for(n=[],l=0;l<o-1;l++)isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN,NaN,NaN):(n.push(a[2*l],a[2*l+1]),isNaN(a[2*l+2])||isNaN(a[2*l+3])?n.push(NaN,NaN):n.push(a[2*l+2],a[2*l+1]));n.push(a[r-2],a[r-1])}else if("hvh"===t.line.shape){for(n=[],l=0;l<o-1;l++)if(isNaN(a[2*l])||isNaN(a[2*l+1])||isNaN(a[2*l+2])||isNaN(a[2*l+3]))isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+1]),n.push(NaN,NaN);else{var s=(a[2*l]+a[2*l+2])/2;n.push(a[2*l],a[2*l+1],s,a[2*l+1],s,a[2*l+3])}n.push(a[r-2],a[r-1])}else if("vhv"===t.line.shape){for(n=[],l=0;l<o-1;l++)if(isNaN(a[2*l])||isNaN(a[2*l+1])||isNaN(a[2*l+2])||isNaN(a[2*l+3]))isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+1]),n.push(NaN,NaN);else{var d=(a[2*l+1]+a[2*l+3])/2;n.push(a[2*l],a[2*l+1],a[2*l],d,a[2*l+2],d)}n.push(a[r-2],a[r-1])}else if("vh"===t.line.shape){for(n=[],l=0;l<o-1;l++)isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN,NaN,NaN):(n.push(a[2*l],a[2*l+1]),isNaN(a[2*l+2])||isNaN(a[2*l+3])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+3]));n.push(a[r-2],a[r-1])}else n=a;var c=!1;for(l=0;l<n.length;l++)if(isNaN(n[l])){c=!0;break}var p=c||n.length>v.TOO_MANY_POINTS?"rect":_.hasMarkers(t)?"rect":"round";if(c&&t.connectgaps){var u=n[0],g=n[1];for(l=0;l<n.length;l+=2)isNaN(n[l])||isNaN(n[l+1])?(n[l]=u,n[l+1]=g):(u=n[l],g=n[l+1])}return{join:p,positions:n}},errorBarPositions:function(e,t,a,r,o){function i(e,r){var o=r._id.charAt(0),l=t["error_"+o];if(l&&l.visible&&("linear"===r.type||"log"===r.type)){for(var s=n(l),u={x:0,y:1}[o],g={x:[0,1,2,3],y:[2,3,0,1]}[o],h=new Float64Array(4*d),m=1/0,y=-Infinity,f=0,x=0,_;f<d;f++,x+=4)if(_=e[f],c(_)){var b=a[2*f+u],v=s(_,f),k=v[0],w=v[1];if(c(k)&&c(w)){var T=_-k,A=_+w;h[x+g[0]]=b-r.c2l(T),h[x+g[1]]=r.c2l(A)-b,h[x+g[2]]=0,h[x+g[3]]=0,m=ea(m,_-k),y=va(y,_+w)}}p[o]={positions:a,errors:h,_bnds:[m,y]}}}var n=g.getComponentMethod("errorbars","makeComputeError"),l=f.getFromId(e,t.xaxis),s=f.getFromId(e,t.yaxis),d=a.length/2,p={};return i(r,l),i(o,s),p},textPosition:function(e,t,r,o){var n=t._length,l={},s;if(_.hasMarkers(t)){var d=r.font,c=r.align,p=r.baseline;for(l.offset=Array(n),s=0;s<n;s++){var u=o.sizes?o.sizes[s]:o.size,g=Array.isArray(d)?d[s].size:d.size,h=Array.isArray(c)?1<c.length?c[s]:c[0]:c,a=Array.isArray(p)?1<p.length?p[s]:p[0]:p,m=w[h],y=w[a],f=u?u/.8+1:0;l.offset[s]=[m*f/g,(-y*f-.5*y)/g]}}return l}}},{"../../components/drawing":614,"../../constants/interactions":694,"../../lib":719,"../../lib/gl_format_color":716,"../../plots/cartesian/axis_ids":770,"../../registry":847,"../scatter/make_bubble_size_func":1128,"../scatter/subtypes":1135,"./constants":1162,"color-normalize":120,"fast-isnumeric":225,"svg-path-sdf":535}],1164:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../registry"),o=e("./attributes"),i=e("../scatter/constants"),n=e("../scatter/subtypes"),l=e("../scatter/xy_defaults"),s=e("../scatter/marker_defaults"),d=e("../scatter/line_defaults"),c=e("../scatter/fillcolor_defaults"),p=e("../scatter/text_defaults");t.exports=function(e,t,u,g){function h(r,i){return a.coerce(e,t,o,r,i)}var m=!!e.marker&&/-open/.test(e.marker.symbol),y=n.isBubble(e),f=l(e,t,g,h);if(!f)return void(t.visible=!1);var x=f<i.PTS_LINESONLY?"lines+markers":"lines";h("text"),h("hovertext"),h("hovertemplate"),h("mode",x),n.hasLines(t)&&(h("connectgaps"),d(e,t,u,g,h),h("line.shape")),n.hasMarkers(t)&&(s(e,t,u,g,h),h("marker.line.width",m||y?1:0)),n.hasText(t)&&p(e,t,g,h);var _=(t.line||{}).color,b=(t.marker||{}).color;h("fill"),"none"!==t.fill&&c(e,t,u,h);var v=r.getComponentMethod("errorbars","supplyDefaults");v(e,t,_||b||u,{axis:"y"}),v(e,t,_||b||u,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(t,h)}},{"../../lib":719,"../../registry":847,"../scatter/constants":1116,"../scatter/fillcolor_defaults":1120,"../scatter/line_defaults":1124,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"../scatter/xy_defaults":1137,"./attributes":1160}],1165:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/color"),o=e("../../constants/interactions").DESELECTDIM;t.exports={styleTextSelection:function(e){var t=e[0],n=t.trace,l=t.t,s=l._scene,d=l.index,c=s.selectBatch[d],p=s.unselectBatch[d],u=s.textOptions[d],g=s.textSelectedOptions[d]||{},h=s.textUnselectedOptions[d]||{},m=a.extendFlat({},u),y,f;if(c.length||p.length){var x=g.color,_=h.color,b=u.color,v=Array.isArray(b);for(m.color=Array(n._length),y=0;y<c.length;y++)f=c[y],m.color[f]=x||(v?b[f]:b);for(y=0;y<p.length;y++){f=p[y];var k=v?b[f]:b;m.color[f]=_?_:x?k:r.addOpacity(k,o)}}s.glText[d].update(m)}}},{"../../components/color":593,"../../constants/interactions":694,"../../lib":719}],1166:[function(e,t){"use strict";function a(e,t,a,n){var l=e.xa,s=e.ya,d=e.distance,c=e.dxy,p=e.index,u={pointNumber:p,x:t[p],y:a[p]};u.tx=Array.isArray(n.text)?n.text[p]:n.text,u.htx=Array.isArray(n.hovertext)?n.hovertext[p]:n.hovertext,u.data=Array.isArray(n.customdata)?n.customdata[p]:n.customdata,u.tp=Array.isArray(n.textposition)?n.textposition[p]:n.textposition;var g=n.textfont;g&&(u.ts=Array.isArray(g.size)?g.size[p]:g.size,u.tc=Array.isArray(g.color)?g.color[p]:g.color,u.tf=Array.isArray(g.family)?g.family[p]:g.family);var h=n.marker;h&&(u.ms=o.isArrayOrTypedArray(h.size)?h.size[p]:h.size,u.mo=o.isArrayOrTypedArray(h.opacity)?h.opacity[p]:h.opacity,u.mx=Array.isArray(h.symbol)?h.symbol[p]:h.symbol,u.mc=o.isArrayOrTypedArray(h.color)?h.color[p]:h.color);var m=h&&h.line;m&&(u.mlc=Array.isArray(m.color)?m.color[p]:m.color,u.mlw=o.isArrayOrTypedArray(m.width)?m.width[p]:m.width);var y=h&&h.gradient;y&&"none"!==y.type&&(u.mgt=Array.isArray(y.type)?y.type[p]:y.type,u.mgc=Array.isArray(y.color)?y.color[p]:y.color);var f=l.c2p(u.x,!0),x=s.c2p(u.y,!0),_=u.mrc||1,b=n.hoverlabel;b&&(u.hbg=Array.isArray(b.bgcolor)?b.bgcolor[p]:b.bgcolor,u.hbc=Array.isArray(b.bordercolor)?b.bordercolor[p]:b.bordercolor,u.hts=Array.isArray(b.font.size)?b.font.size[p]:b.font.size,u.htc=Array.isArray(b.font.color)?b.font.color[p]:b.font.color,u.htf=Array.isArray(b.font.family)?b.font.family[p]:b.font.family,u.hnl=Array.isArray(b.namelength)?b.namelength[p]:b.namelength);var v=n.hoverinfo;v&&(u.hi=Array.isArray(v)?v[p]:v);var k=n.hovertemplate;k&&(u.ht=Array.isArray(k)?k[p]:k);var w={};return w[e.index]=u,o.extendFlat(e,{color:i(n,u),x0:f-_,x1:f+_,xLabelVal:u.x,y0:x-_,y1:x+_,yLabelVal:u.y,cd:w,distance:d,spikeDistance:c,hovertemplate:u.ht}),u.htx?e.text=u.htx:u.tx?e.text=u.tx:n.text&&(e.text=n.text),o.fillText(u,n,e),r.getComponentMethod("errorbars","hoverInfo")(u,n,e),e}var r=e("../../registry"),o=e("../../lib"),i=e("../scatter/get_trace_color");t.exports={hoverPoints:function(e,t,r,o){var n=e.cd,l=n[0].t,s=n[0].trace,d=e.xa,c=e.ya,p=l.x,u=l.y,g=d.c2p(t),h=c.c2p(r),m=e.distance,y;if(l.tree){var f=d.p2c(g-m),x=d.p2c(g+m),_=c.p2c(h-m),b=c.p2c(h+m);y="x"===o?l.tree.range(ea(f,x),ea(c._rl[0],c._rl[1]),va(f,x),va(c._rl[0],c._rl[1])):l.tree.range(ea(f,x),ea(_,b),va(f,x),va(_,b))}else if(l.ids)y=l.ids;else return[e];var v=m,k,w,T,A,S,C,L,E;if("x"===o)for(A=0;A<y.length;A++)w=p[y[A]],S=_a(d.c2p(w)-g),S<v&&(v=S,C=c.c2p(u[y[A]])-h,E=N(S*S+C*C),k=y[A]);else for(A=y.length-1;-1<A;A--)w=p[y[A]],T=u[y[A]],S=d.c2p(w)-g,C=c.c2p(T)-h,L=N(S*S+C*C),L<v&&(v=E=L,k=y[A]);return(e.index=k,e.distance=v,e.dxy=E,void 0===k)?[e]:(a(e,p,u,s),[e])},calcHover:a}},{"../../lib":719,"../../registry":847,"../scatter/get_trace_color":1121}],1167:[function(e,t){"use strict";var a=e("./hover");t.exports={moduleType:"trace",name:"scattergl",basePlotModule:e("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../scatter/cross_trace_defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),hoverPoints:a.hoverPoints,selectPoints:e("./select"),meta:{}}},{"../../plots/cartesian":778,"../scatter/cross_trace_defaults":1118,"../scatter/marker_colorbar":1129,"./attributes":1160,"./calc":1161,"./defaults":1164,"./hover":1166,"./plot":1168,"./select":1170}],1168:[function(e,t){"use strict";function a(e,t,a){var r=e._size,o=e.width,i=e.height;return[r.l+t.domain[0]*r.w,r.b+a.domain[0]*r.h,o-r.r-(1-t.domain[1])*r.w,i-r.t-(1-a.domain[1])*r.h]}var r=e("regl-scatter2d"),o=e("regl-line2d"),n=e("regl-error2d"),l=e("gl-text"),s=e("../../lib"),d=e("../../lib/prepare_regl"),c=e("../scatter/subtypes"),p=e("../scatter/link_traces"),u=e("./edit_style").styleTextSelection;t.exports=function(e,t,g){if(g.length){var h=e._fullLayout,m=t._scene,f=t.xaxis,_=t.yaxis,b,v;if(m){var k=d(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!k)return void m.init();var w=m.count,T=h._glcanvas.data()[0].regl;if(p(e,t,g),m.dirty){if(!0===m.error2d&&(m.error2d=n(T)),!0===m.line2d&&(m.line2d=o(T)),!0===m.scatter2d&&(m.scatter2d=r(T)),!0===m.fill2d&&(m.fill2d=o(T)),!0===m.glText)for(m.glText=Array(w),b=0;b<w;b++)m.glText[b]=new l(T);if(m.glText){if(w>m.glText.length){var A=w-m.glText.length;for(b=0;b<A;b++)m.glText.push(new l(T))}else if(w<m.glText.length){var S=m.glText.length-w,C=m.glText.splice(w,S);C.forEach(function(e){e.destroy()})}for(b=0;b<w;b++)m.glText[b].update(m.textOptions[b])}if(m.line2d&&(m.line2d.update(m.lineOptions),m.lineOptions=m.lineOptions.map(function(e){if(e&&e.positions){for(var t=e.positions,a=0;a<t.length&&(isNaN(t[a])||isNaN(t[a+1]));)a+=2;for(var r=t.length-2;r>a&&(isNaN(t[r])||isNaN(t[r+1]));)r-=2;e.positions=t.slice(a,r+2)}return e}),m.line2d.update(m.lineOptions)),m.error2d){var L=(m.errorXOptions||[]).concat(m.errorYOptions||[]);m.error2d.update(L)}m.scatter2d&&m.scatter2d.update(m.markerOptions),m.fillOrder=s.repeat(null,w),m.fill2d&&(m.fillOptions=m.fillOptions.map(function(e,t){var a=g[t];if(e&&a&&a[0]&&a[0].trace){var r=a[0],o=r.trace,n=r.t,l=m.lineOptions[t],s=[],d,c;o._ownfill&&s.push(t),o._nexttrace&&s.push(t+1),s.length&&(m.fillOrder[t]=s);var p=[],u=l&&l.positions||n.positions,h,y;if("tozeroy"===o.fill){for(h=0;h<u.length&&isNaN(u[h+1]);)h+=2;for(y=u.length-2;y>h&&isNaN(u[y+1]);)y-=2;0!==u[h+1]&&(p=[u[h],0]),p=p.concat(u.slice(h,y+2)),0!==u[y+1]&&(p=p.concat([u[y],0]))}else if("tozerox"===o.fill){for(h=0;h<u.length&&isNaN(u[h]);)h+=2;for(y=u.length-2;y>h&&isNaN(u[y]);)y-=2;0!==u[h]&&(p=[0,u[h+1]]),p=p.concat(u.slice(h,y+2)),0!==u[y]&&(p=p.concat([0,u[y+1]]))}else if("toself"===o.fill||"tonext"===o.fill){for(p=[],d=0,c=0;c<u.length;c+=2)(isNaN(u[c])||isNaN(u[c+1]))&&(p=p.concat(u.slice(d,c)),p.push(u[d],u[d+1]),d=c+2);p=p.concat(u.slice(d)),d&&p.push(u[d],u[d+1])}else{var f=o._nexttrace;if(f){var x=m.lineOptions[t+1];if(x){var _=x.positions;if("tonexty"===o.fill){for(p=u.slice(),t=ba(_.length/2);t--;){var b=_[2*t],v=_[2*t+1];isNaN(b)||isNaN(v)||p.push(b,v)}e.fill=f.fillcolor}}}}if(o._prevtrace&&"tonext"===o._prevtrace.fill){var k=m.lineOptions[t-1].positions,w=p.length/2;d=w;var T=[d];for(c=0;c<k.length;c+=2)(isNaN(k[c])||isNaN(k[c+1]))&&(T.push(c/2+w+1),d=c+2);p=p.concat(k),e.hole=T}return e.fillmode=o.fill,e.opacity=o.opacity,e.positions=p,e}}),m.fill2d.update(m.fillOptions))}var E=h.dragmode,I="lasso"===E||"select"===E,z=-1<h.clickmode.indexOf("select");for(b=0;b<w;b++){var P=g[b][0],D=P.trace,O=P.t,R=O.index,M=D._length,F=O.x,x=O.y;if(D.selectedpoints||I||z){if(I||(I=!0),D.selectedpoints){var y=m.selectBatch[R]=s.selIndices2selPoints(D),B={};for(v=0;v<y.length;v++)B[y[v]]=1;var N=[];for(v=0;v<M;v++)B[v]||N.push(v);m.unselectBatch[R]=N}var V=O.xpx=Array(M),U=O.ypx=Array(M);for(v=0;v<M;v++)V[v]=f.c2p(F[v]),U[v]=_.c2p(x[v])}else O.xpx=O.ypx=null}if(I){if(m.select2d||(m.select2d=r(h._glcanvas.data()[1].regl)),m.scatter2d){var H=Array(w);for(b=0;b<w;b++)H[b]=m.selectBatch[b].length||m.unselectBatch[b].length?m.markerUnselectedOptions[b]:{};m.scatter2d.update(H)}m.select2d&&(m.select2d.update(m.markerOptions),m.select2d.update(m.markerSelectedOptions)),m.glText&&g.forEach(function(e){var t=((e||[])[0]||{}).trace||{};c.hasText(t)&&u(e)})}else m.scatter2d&&m.scatter2d.update(m.markerOptions);var G={viewport:a(h,f,_),range:[(f._rl||f.range)[0],(_._rl||_.range)[0],(f._rl||f.range)[1],(_._rl||_.range)[1]]},q=s.repeat(G,m.count);m.fill2d&&m.fill2d.update(q),m.line2d&&m.line2d.update(q),m.error2d&&m.error2d.update(q.concat(q)),m.scatter2d&&m.scatter2d.update(q),m.select2d&&m.select2d.update(q),m.glText&&m.glText.forEach(function(e){e.update(G)})}}}},{"../../lib":719,"../../lib/prepare_regl":732,"../scatter/link_traces":1127,"../scatter/subtypes":1135,"./edit_style":1165,"gl-text":317,"regl-error2d":490,"regl-line2d":491,"regl-scatter2d":497}],1169:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){var r=t._scene,o={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},i={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return t._scene||(r=t._scene={},r.init=function(){a.extendFlat(r,i,o)},r.init(),r.update=function(e){var t=a.repeat(e,r.count);if(r.fill2d&&r.fill2d.update(t),r.scatter2d&&r.scatter2d.update(t),r.line2d&&r.line2d.update(t),r.error2d&&r.error2d.update(t.concat(t)),r.select2d&&r.select2d.update(t),r.glText)for(var o=0;o<r.count;o++)r.glText[o].update(e)},r.draw=function(){for(var e=r.count,t=r.fill2d,o=r.error2d,n=r.line2d,l=r.scatter2d,s=r.glText,d=r.select2d,c=r.selectBatch,p=r.unselectBatch,u=0;u<e;u++){if(t&&r.fillOrder[u]&&t.draw(r.fillOrder[u]),n&&r.lineOptions[u]&&n.draw(u),o&&(r.errorXOptions[u]&&o.draw(u),r.errorYOptions[u]&&o.draw(u+e)),l&&r.markerOptions[u])if(p[u].length){var g=a.repeat([],r.count);g[u]=p[u],l.draw(g)}else c[u].length||l.draw(u);s[u]&&r.textOptions[u]&&s[u].render()}d&&d.draw(c),r.dirty=!1},r.destroy=function(){r.fill2d&&r.fill2d.destroy&&r.fill2d.destroy(),r.scatter2d&&r.scatter2d.destroy&&r.scatter2d.destroy(),r.error2d&&r.error2d.destroy&&r.error2d.destroy(),r.line2d&&r.line2d.destroy&&r.line2d.destroy(),r.select2d&&r.select2d.destroy&&r.select2d.destroy(),r.glText&&r.glText.forEach(function(e){e.destroy&&e.destroy()}),r.lineOptions=null,r.fillOptions=null,r.markerOptions=null,r.markerSelectedOptions=null,r.markerUnselectedOptions=null,r.errorXOptions=null,r.errorYOptions=null,r.textOptions=null,r.textSelectedOptions=null,r.textUnselectedOptions=null,r.selectBatch=null,r.unselectBatch=null,t._scene=null}),r.dirty||a.extendFlat(r,o),r}},{"../../lib":719}],1170:[function(e,t){"use strict";var a=e("../scatter/subtypes"),r=e("./edit_style").styleTextSelection;t.exports=function(e,t){var o=e.cd,n=[],l=o[0].trace,s=o[0].t,d=l._length,c=s.x,p=s.y,u=s._scene,g=s.index;if(!u)return n;var h=a.hasText(l),m=a.hasMarkers(l);if(!0!==l.visible||!m&&!h)return n;var y=[],f=[];if(!1!==t&&!t.degenerate)for(var x=0;x<d;x++)t.contains([s.xpx[x],s.ypx[x]],!1,x,e)?(y.push(x),n.push({pointNumber:x,x:c[x],y:p[x]})):f.push(x);if(m){var _=u.scatter2d;if(!y.length&&!f.length){var b=Array(u.count);b[g]=u.markerOptions[g],_.update.apply(_,b)}else if(!u.selectBatch[g].length&&!u.unselectBatch[g].length){var v=Array(u.count);v[g]=u.markerUnselectedOptions[g],_.update.apply(_,v)}}return u.selectBatch[g]=y,u.unselectBatch[g]=f,h&&r(o),n}},{"../scatter/subtypes":1135,"./edit_style":1165}],1171:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),r=e("../scattergeo/attributes"),o=e("../scatter/attributes"),i=e("../../plots/mapbox/layout_attributes"),n=e("../../plots/attributes"),l=e("../../components/colorscale/attributes"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=r.line,p=r.marker;t.exports=d({lon:r.lon,lat:r.lat,mode:s({},o.mode,{dflt:"markers"}),text:s({},o.text,{}),hovertext:s({},o.hovertext,{}),line:{color:c.color,width:c.width},connectgaps:o.connectgaps,marker:s({symbol:{valType:"string",dflt:"circle",arrayOk:!0},opacity:p.opacity,size:p.size,sizeref:p.sizeref,sizemin:p.sizemin,sizemode:p.sizemode},l("marker")),fill:r.fill,fillcolor:o.fillcolor,textfont:i.layers.symbol.textfont,textposition:i.layers.symbol.textposition,below:{valType:"string"},selected:{marker:o.selected.marker},unselected:{marker:o.unselected.marker},hoverinfo:s({},n.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../../plots/mapbox/layout_attributes":824,"../scatter/attributes":1112,"../scattergeo/attributes":1151}],1172:[function(e,t){"use strict";function a(){return{geojson:u.makeBlank(),layout:{visibility:"none"},paint:{}}}function r(e){function t(e){return a.opacity*e}var a=e[0].trace,r=a.marker,o=a.selectedpoints,n=c.isArrayOrTypedArray(r.color),l=c.isArrayOrTypedArray(r.size),p=c.isArrayOrTypedArray(r.opacity),u,y;n&&(g.hasColorscale(a,"marker")?y=g.makeColorScaleFuncFromTrace(r):y=c.identity);var f;l&&(f=m(a));var x;p&&(x=function(e){var a=d(e)?+c.constrain(e,0,1):0;return t(a)});var _=[];for(u=0;u<e.length;u++){var b=e[u],v=b.lonlat;if(!s(v)){var k={};y&&(k.mcc=b.mcc=y(b.mc)),f&&(k.mrc=b.mrc=f(b.ms)),x&&(k.mo=x(b.mo)),o&&(k.selected=b.selected||0),_.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:k})}}var w;if(o)for(w=h.makeSelectedPointStyleFns(a),u=0;u<_.length;u++){var T=_[u].properties;w.selectedOpacityFn&&(T.mo=t(w.selectedOpacityFn(T))),w.selectedColorFn&&(T.mcc=w.selectedColorFn(T)),w.selectedSizeFn&&(T.mrc=w.selectedSizeFn(T))}return{geojson:{type:"FeatureCollection",features:_},mcc:n||w&&w.selectedColorFn?{type:"identity",property:"mcc"}:r.color,mrc:l||w&&w.selectedSizeFn?{type:"identity",property:"mrc"}:function(e){return e/2}(r.size),mo:p||w&&w.selectedOpacityFn?{type:"identity",property:"mo"}:t(r.opacity)}}function o(e){for(var t=e[0].trace,a=t.marker||{},r=a.symbol,o=t.text,d="circle"===r?l:n(r),c=y.hasText(t)?n(o):l,p=[],u=0,g;u<e.length;u++)g=e[u],s(g.lonlat)||p.push({type:"Feature",geometry:{type:"Point",coordinates:g.lonlat},properties:{symbol:d(g.mx),text:c(g.tx)}});return{type:"FeatureCollection",features:p}}function n(e){return c.isArrayOrTypedArray(e)?function(e){return e}:e?function(){return e}:l}function l(){return""}function s(e){return e[0]===p}var d=e("fast-isnumeric"),c=e("../../lib"),p=e("../../constants/numerical").BADNUM,u=e("../../lib/geojson_utils"),g=e("../../components/colorscale"),h=e("../../components/drawing"),m=e("../scatter/make_bubble_size_func"),y=e("../scatter/subtypes"),f=e("../../plots/mapbox/convert_text_opts");t.exports=function(e){var t=e[0].trace,i=!0===t.visible&&0!==t._length,n="none"!==t.fill,l=y.hasLines(t),s=y.hasMarkers(t),d=y.hasText(t),p=s&&"circle"===t.marker.symbol,g=s&&"circle"!==t.marker.symbol,h=a(),m=a(),x=a(),_=a(),b={fill:h,line:m,circle:x,symbol:_};if(!i)return b;var v;if((n||l)&&(v=u.calcTraceToLineCoords(e)),n&&(h.geojson=u.makePolygon(v),h.layout.visibility="visible",c.extendFlat(h.paint,{"fill-color":t.fillcolor})),l&&(m.geojson=u.makeLine(v),m.layout.visibility="visible",c.extendFlat(m.paint,{"line-width":t.line.width,"line-color":t.line.color,"line-opacity":t.opacity})),p){var k=r(e);x.geojson=k.geojson,x.layout.visibility="visible",c.extendFlat(x.paint,{"circle-color":k.mcc,"circle-radius":k.mrc,"circle-opacity":k.mo})}if((g||d)&&(_.geojson=o(e),c.extendFlat(_.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),g&&(c.extendFlat(_.layout,{"icon-size":t.marker.size/10}),c.extendFlat(_.paint,{"icon-opacity":t.opacity*t.marker.opacity,"icon-color":t.marker.color})),d)){var w=(t.marker||{}).size,T=f(t.textposition,w);c.extendFlat(_.layout,{"text-size":t.textfont.size,"text-anchor":T.anchor,"text-offset":T.offset}),c.extendFlat(_.paint,{"text-color":t.textfont.color,"text-opacity":t.opacity})}return b}},{"../../components/colorscale":605,"../../components/drawing":614,"../../constants/numerical":695,"../../lib":719,"../../lib/geojson_utils":714,"../../plots/mapbox/convert_text_opts":821,"../scatter/make_bubble_size_func":1128,"../scatter/subtypes":1135,"fast-isnumeric":225}],1173:[function(e,t){"use strict";function a(e,t,a){var r=a("lon")||[],o=a("lat")||[],i=ea(r.length,o.length);return t._length=i,i}var r=e("../../lib"),o=e("../scatter/subtypes"),i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/text_defaults"),s=e("../scatter/fillcolor_defaults"),d=e("./attributes");t.exports=function(e,t,c,p){function u(a,o){return r.coerce(e,t,d,a,o)}var g=a(e,t,u);if(!g)return void(t.visible=!1);if(u("text"),u("hovertext"),u("hovertemplate"),u("mode"),u("below"),o.hasLines(t)&&(n(e,t,c,p,u,{noDash:!0}),u("connectgaps")),o.hasMarkers(t)){i(e,t,c,p,u,{noLine:!0});var h=t.marker;"circle"!==h.symbol&&(r.isArrayOrTypedArray(h.size)&&(h.size=h.size[0]),r.isArrayOrTypedArray(h.color)&&(h.color=h.color[0]))}o.hasText(t)&&l(e,t,p,u,{noSelect:!0}),u("fill"),"none"!==t.fill&&s(e,t,c,u),r.coerceSelectionMarkerOpacity(t,u)}},{"../../lib":719,"../scatter/fillcolor_defaults":1120,"../scatter/line_defaults":1124,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"./attributes":1171}],1174:[function(e,t){"use strict";t.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e}},{}],1175:[function(e,t){"use strict";function a(e,t,a){function r(e){return e+"\xB0"}if(!e.hovertemplate){var o=t.hi||e.hoverinfo,i=o.split("+"),l=-1!==i.indexOf("all"),s=-1!==i.indexOf("lon"),d=-1!==i.indexOf("lat"),c=t.lonlat,p=[];return l||s&&d?p.push("("+r(c[0])+", "+r(c[1])+")"):s?p.push(a.lon+r(c[0])):d&&p.push(a.lat+r(c[1])),(l||-1!==i.indexOf("text"))&&n(t,e,p),p.join("<br>")}}var r=e("../../components/fx"),o=e("../../lib"),i=e("../scatter/get_trace_color"),n=o.fillText,l=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){var s=e.cd,d=s[0].trace,c=e.xa,p=e.ya,u=e.subplot,g=0<=t?ba((t+180)/360):M((t-180)/360),h=360*g;if(r.getClosest(s,function(e){var a=e.lonlat;if(a[0]===l)return 1/0;var r=o.modHalf(a[0],360),i=a[1],s=u.project([r,i]),d=s.x-c.c2p([t-h,i]),g=s.y-p.c2p([r,n]),m=va(3,e.mrc||0);return va(N(d*d+g*g)-m,1-3/m)},e),!1!==e.index){var m=s[e.index],y=m.lonlat,f=[o.modHalf(y[0],360)+h,y[1]],x=c.c2p(f),_=p.c2p(f),b=m.mrc||1;return e.x0=x-b,e.x1=x+b,e.y0=_-b,e.y1=_+b,e.color=i(d,m),e.extraText=a(d,m,s[0].t.labels),e.hovertemplate=d.hovertemplate,[e]}}},{"../../components/fx":632,"../../constants/numerical":695,"../../lib":719,"../scatter/get_trace_color":1121}],1176:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("../scattergeo/calc"),plot:e("./plot"),hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("./select"),styleOnSelect:function(e,t){if(t){var a=t[0].trace;a._glTrace.update(t)}},moduleType:"trace",name:"scattermapbox",basePlotModule:e("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatterlike"],meta:{}}},{"../../plots/mapbox":822,"../scatter/marker_colorbar":1129,"../scattergeo/calc":1152,"./attributes":1171,"./defaults":1173,"./event_data":1174,"./hover":1175,"./plot":1177,"./select":1178}],1177:[function(e,t){"use strict";function a(e,t){this.subplot=e,this.uid=t,this.sourceIds={fill:"source-"+t+"-fill",line:"source-"+t+"-line",circle:"source-"+t+"-circle",symbol:"source-"+t+"-symbol"},this.layerIds={fill:o+t+"-fill",line:o+t+"-line",circle:o+t+"-circle",symbol:o+t+"-symbol"},this.below=null}var r=e("./convert"),o=e("../../plots/mapbox/constants").traceLayerPrefix,n=["fill","line","circle","symbol"],l=a.prototype;l.addSource=function(e,t){this.subplot.map.addSource(this.sourceIds[e],{type:"geojson",data:t.geojson})},l.setSourceData=function(e,t){this.subplot.map.getSource(this.sourceIds[e]).setData(t.geojson)},l.addLayer=function(e,t,a){this.subplot.addLayer({type:e,id:this.layerIds[e],source:this.sourceIds[e],layout:t.layout,paint:t.paint},a)},l.update=function(e){var t=this.subplot,a=t.map,o=r(e),l=t.belowLookup["trace-"+this.uid],s,d,c;if(l!==this.below){for(s=n.length-1;0<=s;s--)d=n[s],a.removeLayer(this.layerIds[d]);for(s=0;s<n.length;s++)d=n[s],c=o[d],this.addLayer(d,c,l);this.below=l}for(s=0;s<n.length;s++)d=n[s],c=o[d],t.setOptions(this.layerIds[d],"setLayoutProperty",c.layout),"visible"===c.layout.visibility&&(this.setSourceData(d,c),t.setOptions(this.layerIds[d],"setPaintProperty",c.paint));e[0].trace._glTrace=this},l.dispose=function(){for(var e=this.subplot.map,t=n.length-1,a;0<=t;t--)a=n[t],e.removeLayer(this.layerIds[a]),e.removeSource(this.sourceIds[a])},t.exports=function(e,t){for(var o=t[0].trace,l=new a(e,o.uid),s=r(t),d=l.below=e.belowLookup["trace-"+o.uid],c=0;c<n.length;c++){var p=n[c],u=s[p];l.addSource(p,u),l.addLayer(p,u,d)}return t[0].trace._glTrace=l,l}},{"../../plots/mapbox/constants":820,"./convert":1172}],1178:[function(e,t){"use strict";var a=e("../../lib"),r=e("../scatter/subtypes"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var n=e.cd,l=e.xaxis,s=e.yaxis,d=[],c=n[0].trace,p;if(!r.hasMarkers(c))return[];if(!1===t)for(p=0;p<n.length;p++)n[p].selected=0;else for(p=0;p<n.length;p++){var u=n[p],g=u.lonlat;if(g[0]!==o){var h=[a.modHalf(g[0],360),g[1]],m=[l.c2p(h),s.c2p(h)];t.contains(m,null,p,e)?(d.push({pointNumber:p,lon:g[0],lat:g[1]}),u.selected=1):u.selected=0}}return d}},{"../../constants/numerical":695,"../../lib":719,"../scatter/subtypes":1135}],1179:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),r=e("../../lib/extend").extendFlat,o=e("../scatter/attributes"),i=e("../../plots/attributes"),n=o.line;t.exports={mode:o.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:o.text,hovertext:o.hovertext,line:{color:n.color,width:n.width,dash:n.dash,shape:r({},n.shape,{values:["linear","spline"]}),smoothing:n.smoothing,editType:"calc"},connectgaps:o.connectgaps,marker:o.marker,cliponaxis:r({},o.cliponaxis,{dflt:!1}),textposition:o.textposition,textfont:o.textfont,fill:r({},o.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:o.fillcolor,hoverinfo:r({},i.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:o.hoveron,hovertemplate:a(),selected:o.selected,unselected:o.unselected}},{"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../scatter/attributes":1112}],1180:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../constants/numerical").BADNUM,n=e("../../plots/cartesian/axes"),l=e("../scatter/colorscale_calc"),s=e("../scatter/arrays_to_calcdata"),d=e("../scatter/calc_selection"),c=e("../scatter/calc").calcMarkerSize;t.exports=function(e,t){for(var p=e._fullLayout,u=t.subplot,g=p[u].radialaxis,h=p[u].angularaxis,m=g.makeCalcdata(t,"r"),y=h.makeCalcdata(t,"theta"),f=t._length,x=Array(f),_=0;_<f;_++){var b=m[_],r=y[_],v=x[_]={};a(b)&&a(r)?(v.r=b,v.theta=r):v.r=o}var k=c(t,f);return t._extremes.x=n.findExtremes(g,m,{ppad:k}),l(e,t),s(x,t),d(x,t),x}},{"../../constants/numerical":695,"../../plots/cartesian/axes":767,"../scatter/arrays_to_calcdata":1111,"../scatter/calc":1113,"../scatter/calc_selection":1114,"../scatter/colorscale_calc":1115,"fast-isnumeric":225}],1181:[function(e,t){"use strict";function a(e,t,a,o){var i=o("r"),r=o("theta"),n;if(i)r?n=ea(i.length,r.length):(n=i.length,o("theta0"),o("dtheta"));else{if(!r)return 0;n=t.theta.length,o("r0"),o("dr")}return t._length=n,n}var r=e("../../lib"),o=e("../scatter/subtypes"),i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/line_shape_defaults"),s=e("../scatter/text_defaults"),d=e("../scatter/fillcolor_defaults"),c=e("../scatter/constants").PTS_LINESONLY,p=e("./attributes");t.exports={handleRThetaDefaults:a,supplyDefaults:function(e,t,u,g){function h(a,o){return r.coerce(e,t,p,a,o)}var m=a(e,t,g,h);if(!m)return void(t.visible=!1);h("thetaunit"),h("mode",m<c?"lines+markers":"lines"),h("text"),h("hovertext"),"fills"!==t.hoveron&&h("hovertemplate"),o.hasLines(t)&&(n(e,t,u,g,h),l(e,t,h),h("connectgaps")),o.hasMarkers(t)&&i(e,t,u,g,h,{gradient:!0}),o.hasText(t)&&s(e,t,g,h);var y=[];(o.hasMarkers(t)||o.hasText(t))&&(h("cliponaxis"),h("marker.maxdisplayed"),y.push("points")),h("fill"),"none"!==t.fill&&(d(e,t,u,h),!o.hasLines(t)&&l(e,t,h)),("tonext"===t.fill||"toself"===t.fill)&&y.push("fills"),h("hoveron",y.join("+")||"points"),r.coerceSelectionMarkerOpacity(t,h)}}},{"../../lib":719,"../scatter/constants":1116,"../scatter/fillcolor_defaults":1120,"../scatter/line_defaults":1124,"../scatter/line_shape_defaults":1126,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"./attributes":1179}],1182:[function(e,t){"use strict";function a(e,t,a,r){function n(e,t){u.push(e._hovertitle+": "+t)}var l=a.radialAxis,s=a.angularAxis;l._hovertitle="r",s._hovertitle="\u03B8";var d=l.c2l(e.r);r.rLabel=o.tickText(l,d,"hover").text;var c="degrees"===s.thetaunit?i.rad2deg(e.theta):e.theta;r.thetaLabel=o.tickText(s,c,"hover").text;var p=e.hi||t.hoverinfo,u=[];if(!t.hovertemplate){var g=p.split("+");-1!==g.indexOf("all")&&(g=["r","theta","text"]),-1!==g.indexOf("r")&&n(l,r.rLabel),-1!==g.indexOf("theta")&&n(s,r.thetaLabel),-1!==g.indexOf("text")&&r.text&&(u.push(r.text),delete r.text),r.extraText=u.join("<br>")}}var r=e("../scatter/hover"),o=e("../../plots/cartesian/axes"),i=e("../../lib");t.exports={hoverPoints:function(e,t,o,i){var n=r(e,t,o,i);if(n&&!1!==n[0].index){var l=n[0];if(void 0===l.index)return n;var s=e.subplot,d=l.cd[l.index],c=l.trace;if(s.isPtInside(d))return l.xLabelVal=void 0,l.yLabelVal=void 0,a(d,c,s,l),l.hovertemplate=c.hovertemplate,n}},makeHoverPointText:a}},{"../../lib":719,"../../plots/cartesian/axes":767,"../scatter/hover":1122}],1183:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:e("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scatter/select"),meta:{}}},{"../../plots/polar":831,"../scatter/marker_colorbar":1129,"../scatter/select":1132,"../scatter/style":1134,"./attributes":1179,"./calc":1180,"./defaults":1181,"./hover":1182,"./plot":1184}],1184:[function(e,t){"use strict";var a=e("../scatter/plot"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){for(var l=t.layers.frontplot.select("g.scatterlayer"),s={xaxis:t.xaxis,yaxis:t.yaxis,plot:t.framework,layerClipId:t._hasClipOnAxisFalse?t.clipIds.forTraces:null},d=t.radialAxis,c=t.angularAxis,p=0,u;p<n.length;p++){u=n[p];for(var g=0;g<u.length;g++){var h=u[g],m=h.r;if(m===o)h.x=h.y=o;else{var r=d.c2g(m),y=c.c2g(h.theta);h.x=r*R(y),h.y=r*De(y)}}}a(e,s,n,l)}},{"../../constants/numerical":695,"../scatter/plot":1131}],1185:[function(e,t){"use strict";var a=e("../scatterpolar/attributes"),r=e("../scattergl/attributes");t.exports={mode:a.mode,r:a.r,theta:a.theta,r0:a.r0,dr:a.dr,theta0:a.theta0,dtheta:a.dtheta,thetaunit:a.thetaunit,text:a.text,hovertext:a.hovertext,hovertemplate:a.hovertemplate,line:r.line,connectgaps:r.connectgaps,marker:r.marker,fill:r.fill,fillcolor:r.fillcolor,textposition:r.textposition,textfont:r.textfont,hoverinfo:a.hoverinfo,selected:a.selected,unselected:a.unselected}},{"../scattergl/attributes":1160,"../scatterpolar/attributes":1179}],1186:[function(e,t){"use strict";var a=e("../scatter/colorscale_calc"),r=e("../scatter/calc").calcMarkerSize,o=e("../scattergl/convert"),i=e("../../plots/cartesian/axes"),n=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function(e,t){var l=e._fullLayout,s=t.subplot,d=l[s].radialaxis,c=l[s].angularaxis,p=d.makeCalcdata(t,"r"),u=c.makeCalcdata(t,"theta"),g=t._length,h={};g<p.length&&(p=p.slice(0,g)),g<u.length&&(u=u.slice(0,g)),h.r=p,h.theta=u,a(e,t);var m=h.opts=o.style(e,t),y;return g<n?y=r(t,g):m.marker&&(y=2*(m.marker.sizeAvg||va(m.marker.size,3))),t._extremes.x=i.findExtremes(d,p,{ppad:y}),[{x:!1,y:!1,t:h,trace:t}]}},{"../../plots/cartesian/axes":767,"../scatter/calc":1113,"../scatter/colorscale_calc":1115,"../scattergl/constants":1162,"../scattergl/convert":1163}],1187:[function(e,t){"use strict";var a=e("../../lib"),r=e("../scatter/subtypes"),o=e("../scatterpolar/defaults").handleRThetaDefaults,i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/text_defaults"),s=e("../scatter/fillcolor_defaults"),d=e("../scatter/constants").PTS_LINESONLY,c=e("./attributes");t.exports=function(e,t,p,u){function g(r,o){return a.coerce(e,t,c,r,o)}var h=o(e,t,u,g);return h?void(g("thetaunit"),g("mode",h<d?"lines+markers":"lines"),g("text"),g("hovertext"),"fills"!==t.hoveron&&g("hovertemplate"),r.hasLines(t)&&(n(e,t,p,u,g),g("connectgaps")),r.hasMarkers(t)&&i(e,t,p,u,g),r.hasText(t)&&l(e,t,u,g),g("fill"),"none"!==t.fill&&s(e,t,p,g),a.coerceSelectionMarkerOpacity(t,g)):void(t.visible=!1)}},{"../../lib":719,"../scatter/constants":1116,"../scatter/fillcolor_defaults":1120,"../scatter/line_defaults":1124,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"../scatterpolar/defaults":1181,"./attributes":1185}],1188:[function(e,t){"use strict";var a=e("../scattergl/hover"),r=e("../scatterpolar/hover").makeHoverPointText;t.exports={hoverPoints:function(e,t,o,i){var n=e.cd,l=n[0].t,s=l.r,d=l.theta,c=a.hoverPoints(e,t,o,i);if(c&&!1!==c[0].index){var p=c[0];if(void 0===p.index)return c;var u=e.subplot,g=p.cd[p.index],h=p.trace;if(g.r=s[p.index],g.theta=d[p.index],!!u.isPtInside(g))return p.xLabelVal=void 0,p.yLabelVal=void 0,r(g,h,u,p),c}}}},{"../scattergl/hover":1166,"../scatterpolar/hover":1182}],1189:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:e("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scattergl/select"),meta:{}}},{"../../plots/polar":831,"../scatter/marker_colorbar":1129,"../scattergl/select":1170,"./attributes":1185,"./calc":1186,"./defaults":1187,"./hover":1188,"./plot":1190}],1190:[function(e,t){"use strict";var a=e("point-cluster"),o=e("fast-isnumeric"),i=e("../scattergl/plot"),n=e("../scattergl/scene_update"),l=e("../scattergl/convert"),s=e("../../lib"),d=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function(e,t,r){if(r.length){var c=t.radialAxis,p=t.angularAxis,u=n(e,t);return r.forEach(function(n){if(n&&n[0]&&n[0].trace){var g=n[0],h=g.trace,m=g.t,f=h._length,_=m.r,b=m.theta,v=m.opts,k=_.slice(),w=b.slice(),T;for(T=0;T<_.length;T++)t.isPtInside({r:_[T],theta:b[T]})||(k[T]=NaN,w[T]=NaN);var A=Array(2*f),S=Array(f),x=Array(f);for(T=0;T<f;T++){var y=k[T],r,C;if(o(y)){var L=c.c2g(y),E=p.c2g(w[T],h.thetaunit);r=L*R(E),C=L*De(E)}else r=C=NaN;S[T]=A[2*T]=r,x[T]=A[2*T+1]=C}m.tree=a(A),v.marker&&f>=d&&(v.marker.cluster=m.tree),v.marker&&(v.markerSel.positions=v.markerUnsel.positions=v.marker.positions=A),v.line&&1<A.length&&s.extendFlat(v.line,l.linePositions(e,h,A)),v.text&&(s.extendFlat(v.text,{positions:A},l.textPosition(e,h,v.text,v.marker)),s.extendFlat(v.textSel,{positions:A},l.textPosition(e,h,v.text,v.markerSel)),s.extendFlat(v.textUnsel,{positions:A},l.textPosition(e,h,v.text,v.markerUnsel))),v.fill&&!u.fill2d&&(u.fill2d=!0),v.marker&&!u.scatter2d&&(u.scatter2d=!0),v.line&&!u.line2d&&(u.line2d=!0),v.text&&!u.glText&&(u.glText=!0),u.lineOptions.push(v.line),u.fillOptions.push(v.fill),u.markerOptions.push(v.marker),u.markerSelectedOptions.push(v.markerSel),u.markerUnselectedOptions.push(v.markerUnsel),u.textOptions.push(v.text),u.textSelectedOptions.push(v.textSel),u.textUnselectedOptions.push(v.textUnsel),u.selectBatch.push([]),u.unselectBatch.push([]),m.x=S,m.y=x,m.rawx=S,m.rawy=x,m.r=_,m.theta=b,m.positions=A,m._scene=u,m.index=u.count,u.count++}}),i(e,t,r)}}},{"../../lib":719,"../scattergl/constants":1162,"../scattergl/convert":1163,"../scattergl/plot":1168,"../scattergl/scene_update":1169,"fast-isnumeric":225,"point-cluster":469}],1191:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),r=e("../scatter/attributes"),o=e("../../plots/attributes"),i=e("../../components/colorscale/attributes"),n=e("../../components/drawing/attributes").dash,l=e("../../lib/extend").extendFlat,s=r.marker,d=r.line,c=s.line;t.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:l({},r.mode,{dflt:"markers"}),text:l({},r.text,{}),hovertext:l({},r.hovertext,{}),line:{color:d.color,width:d.width,dash:n,shape:l({},d.shape,{values:["linear","spline"]}),smoothing:d.smoothing,editType:"calc"},connectgaps:r.connectgaps,cliponaxis:r.cliponaxis,fill:l({},r.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:r.fillcolor,marker:l({symbol:s.symbol,opacity:s.opacity,maxdisplayed:s.maxdisplayed,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,line:l({width:c.width,editType:"calc"},i("marker.line")),gradient:s.gradient,editType:"calc"},i("marker")),textfont:r.textfont,textposition:r.textposition,selected:r.selected,unselected:r.unselected,hoverinfo:l({},o.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:r.hoveron,hovertemplate:a()}},{"../../components/colorscale/attributes":600,"../../components/drawing/attributes":613,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../scatter/attributes":1112}],1192:[function(e,t){"use strict";var r=e("fast-isnumeric"),o=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../scatter/calc").calcMarkerSize,d=["a","b","c"],c={a:["b","c"],b:["a","c"],c:["a","b"]};t.exports=function(e,t){var p=e._fullLayout[t.subplot],u=p.sum,g=t.sum||u,h={a:t.a,b:t.b,c:t.c},m,f,_,v,k,w;for(m=0;m<d.length;m++)if(_=d[m],!h[_]){for(k=h[c[_][0]],w=h[c[_][1]],v=Array(k.length),f=0;f<k.length;f++)v[f]=g-k[f]-w[f];h[_]=v}var T=t._length,A=Array(T),S,C,L,E,I,z;for(m=0;m<T;m++)S=h.a[m],C=h.b[m],L=h.c[m],r(S)&&r(C)&&r(L)?(S=+S,C=+C,L=+L,E=u/(S+C+L),1!==E&&(S*=E,C*=E,L*=E),z=S,I=L-C,A[m]={x:I,y:z,a:S,b:C,c:L}):A[m]={x:!1,y:!1};return s(t,T),o(e,t),n(A,t),l(A,t),A}},{"../scatter/arrays_to_calcdata":1111,"../scatter/calc":1113,"../scatter/calc_selection":1114,"../scatter/colorscale_calc":1115,"fast-isnumeric":225}],1193:[function(e,t){"use strict";var r=e("../../lib"),o=e("../scatter/constants"),i=e("../scatter/subtypes"),n=e("../scatter/marker_defaults"),l=e("../scatter/line_defaults"),s=e("../scatter/line_shape_defaults"),d=e("../scatter/text_defaults"),p=e("../scatter/fillcolor_defaults"),u=e("./attributes");t.exports=function(e,t,g,h){function m(a,o){return r.coerce(e,t,u,a,o)}var y=m("a"),a=m("b"),f=m("c"),c;if(y?(c=y.length,a?(c=ea(c,a.length),f&&(c=ea(c,f.length))):f?c=ea(c,f.length):c=0):a&&f&&(c=ea(a.length,f.length)),!c)return void(t.visible=!1);t._length=c,m("sum"),m("text"),m("hovertext"),"fills"!==t.hoveron&&m("hovertemplate");var x=c<o.PTS_LINESONLY?"lines+markers":"lines";m("mode",x),i.hasLines(t)&&(l(e,t,g,h,m),s(e,t,m),m("connectgaps")),i.hasMarkers(t)&&n(e,t,g,h,m,{gradient:!0}),i.hasText(t)&&d(e,t,h,m);var _=[];(i.hasMarkers(t)||i.hasText(t))&&(m("cliponaxis"),m("marker.maxdisplayed"),_.push("points")),m("fill"),"none"!==t.fill&&(p(e,t,g,m),!i.hasLines(t)&&s(e,t,m)),("tonext"===t.fill||"toself"===t.fill)&&_.push("fills"),m("hoveron",_.join("+")||"points"),r.coerceSelectionMarkerOpacity(t,m)}},{"../../lib":719,"../scatter/constants":1116,"../scatter/fillcolor_defaults":1120,"../scatter/line_defaults":1124,"../scatter/line_shape_defaults":1126,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"../scatter/text_defaults":1136,"./attributes":1191}],1194:[function(e,t){"use strict";t.exports=function(e,t,a,r,o){if(t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),r[o]){var i=r[o];e.a=i.a,e.b=i.b,e.c=i.c}else e.a=t.a,e.b=t.b,e.c=t.c;return e}},{}],1195:[function(e,t){"use strict";var a=e("../scatter/hover"),r=e("../../plots/cartesian/axes");t.exports=function(e,t,o,i){function n(e,t){f.push(e._hovertitle+": "+t)}var l=a(e,t,o,i);if(l&&!1!==l[0].index){var s=l[0];if(void 0===s.index){var d=1-s.y0/e.ya._length,c=e.xa._length,p=c*d/2,u=c-p;return s.x0=va(ea(s.x0,u),p),s.x1=va(ea(s.x1,u),p),l}var g=s.cd[s.index];s.a=g.a,s.b=g.b,s.c=g.c,s.xLabelVal=void 0,s.yLabelVal=void 0;var h=s.subplot;s.aLabel=r.tickText(h.aaxis,g.a,"hover").text,s.bLabel=r.tickText(h.baxis,g.b,"hover").text,s.cLabel=r.tickText(h.caxis,g.c,"hover").text;var m=s.trace,y=g.hi||m.hoverinfo,f=[];if(!m.hovertemplate){var x=y.split("+");-1!==x.indexOf("all")&&(x=["a","b","c"]),-1!==x.indexOf("a")&&n(h.aaxis,s.aLabel),-1!==x.indexOf("b")&&n(h.baxis,s.bLabel),-1!==x.indexOf("c")&&n(h.caxis,s.cLabel)}return s.extraText=f.join("<br>"),s.hovertemplate=m.hovertemplate,l}}},{"../../plots/cartesian/axes":767,"../scatter/hover":1122}],1196:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../scatter/select"),eventData:e("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:e("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":843,"../scatter/marker_colorbar":1129,"../scatter/select":1132,"../scatter/style":1134,"./attributes":1191,"./calc":1192,"./defaults":1193,"./event_data":1194,"./hover":1195,"./plot":1197}],1197:[function(e,t){"use strict";var a=e("../scatter/plot");t.exports=function(e,t,r){var o=t.plotContainer;o.select(".scatterlayer").selectAll("*").remove();var i={xaxis:t.xaxis,yaxis:t.yaxis,plot:o,layerClipId:t._hasClipOnAxisFalse?t.clipIdRelative:null},n=t.layers.frontplot.select("g.scatterlayer");a(e,i,r,n)}},{"../scatter/plot":1131}],1198:[function(e,t){"use strict";function a(e){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:l[e],editType:"plot"}}}var r=e("../scatter/attributes"),o=e("../../components/colorscale/attributes"),i=e("../../components/fx/hovertemplate_attributes"),n=e("../scattergl/attributes"),l=e("../../plots/cartesian/constants").idRegex,s=e("../../plot_api/plot_template").templatedArray,d=e("../../lib/extend").extendFlat,c=r.marker,p=c.line,u=d(o("marker.line",{editTypeOverride:"calc"}),{width:d({},p.width,{editType:"calc"}),editType:"calc"}),g=d(o("marker"),{symbol:c.symbol,size:d({},c.size,{editType:"markerSize"}),sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:c.opacity,colorbar:c.colorbar,line:u,editType:"calc"});g.color.editType=g.cmin.editType=g.cmax.editType="style",t.exports={dimensions:s("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:d({},n.text,{}),hovertext:d({},n.hovertext,{}),hovertemplate:i(),marker:g,xaxes:a("x"),yaxes:a("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:n.selected.marker,editType:"calc"},unselected:{marker:n.unselected.marker,editType:"calc"},opacity:n.opacity}},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plot_api/plot_template":757,"../../plots/cartesian/constants":773,"../scatter/attributes":1112,"../scattergl/attributes":1160}],1199:[function(e,t){"use strict";function a(e,t,a){for(var r=a.matrixOptions.data.length,o=t._visibleDims,n=a.viewOpts.ranges=Array(r),l=0;l<o.length;l++){var s=o[l],i=n[l]=[,,,,],d=c(e,t._diag[s][0]);d&&(i[0]=d.r2l(d.range[0]),i[2]=d.r2l(d.range[1]));var p=c(e,t._diag[s][1]);p&&(i[1]=p.r2l(p.range[0]),i[3]=p.r2l(p.range[1]))}a.selectBatch.length||a.unselectBatch.length?a.matrix.update({ranges:n},{ranges:n}):a.matrix.update({ranges:n})}function r(e){var t=e._fullLayout,a=t._glcanvas.data()[0].regl,r=t._splomGrid;r||(r=t._splomGrid=i(a)),r.update(o(e))}function o(e){function t(e,t,a,r,n,l){var s=t[e+"color"],d=t[e+"width"],c=s+d+"";c in i?i[c].data.push(NaN,NaN,a,r,n,l):i[c]={data:[a,r,n,l],join:"rect",thickness:d,color:s,viewport:o,range:o,overlay:!1}}var a=e._fullLayout,r=a._size,o=[0,0,a.width,a.height],i={},n;for(n in a._splomSubplots){var l=a._plots[n],s=l.xaxis,d=l.yaxis,c=s._vals,u=d._vals,g=r.b+d.domain[0]*r.h,h=-d._m,m=-h*d.r2l(d.range[0],d.calendar),f,_;if(s.showgrid)for(n=0;n<c.length;n++)f=s._offset+s.l2p(c[n].x),t("grid",s,f,g,f,g+d._length);if(d.showgrid)for(n=0;n<u.length;n++)_=g+m+h*u[n].x,t("grid",d,s._offset,_,s._offset+s._length,_);p(e,s,d)&&(f=s._offset+s.l2p(0),t("zeroline",s,f,g,f,g+d._length)),p(e,d,s)&&(_=g+m+0,t("zeroline",d,s._offset,_,s._offset+s._length,_))}var b=[];for(n in i)b.push(i[n]);return b}var i=e("regl-line2d"),n=e("../../registry"),l=e("../../lib/prepare_regl"),s=e("../../plots/get_data").getModuleCalcData,d=e("../../plots/cartesian"),c=e("../../plots/cartesian/axis_ids").getFromId,p=e("../../plots/cartesian/axes").shouldShowZeroLine;t.exports={name:"splom",attr:d.attr,attrRegex:d.attrRegex,layoutAttributes:d.layoutAttributes,supplyLayoutDefaults:d.supplyLayoutDefaults,drawFramework:d.drawFramework,plot:function(e){var t=e._fullLayout,a=n.getModule("splom"),o=s(e.calcdata,a)[0],i=l(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);i&&(t._hasOnlyLargeSploms&&r(e),a.plot(e,{},o))},drag:function(e){var t=e.calcdata,o=e._fullLayout;o._hasOnlyLargeSploms&&r(e);for(var n=0;n<t.length;n++){var l=t[n][0],s=l.trace,d=o._splomScenes[s.uid];"splom"===s.type&&d&&d.matrix&&a(e,s,d)}},updateGrid:r,clean:function(e,t,a,r){var o={},n;if(r._splomScenes){for(n=0;n<e.length;n++){var l=e[n];"splom"===l.type&&(o[l.uid]=1)}for(n=0;n<a.length;n++){var s=a[n];if(!o[s.uid]){var c=r._splomScenes[s.uid];c&&c.destroy&&c.destroy(),r._splomScenes[s.uid]=null,delete r._splomScenes[s.uid]}}}0===Object.keys(r._splomScenes||{}).length&&delete r._splomScenes,r._splomGrid&&!t._hasOnlyLargeSploms&&r._hasOnlyLargeSploms&&(r._splomGrid.destroy(),r._splomGrid=null,delete r._splomGrid),d.clean(e,t,a,r)},updateFx:d.updateFx,toSVG:d.toSVG}},{"../../lib/prepare_regl":732,"../../plots/cartesian":778,"../../plots/cartesian/axes":767,"../../plots/cartesian/axis_ids":770,"../../plots/get_data":802,"../../registry":847,"regl-line2d":491}],1200:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../plots/cartesian/axis_ids"),o=e("../scatter/calc").calcMarkerSize,n=e("../scatter/calc").calcAxisExpansion,l=e("../scatter/colorscale_calc"),s=e("../scattergl/convert").markerSelection,d=e("../scattergl/convert").markerStyle,c=e("./scene_update"),p=e("../../constants/numerical").BADNUM,u=e("../scattergl/constants").TOO_MANY_POINTS;t.exports=function(e,t){function g(e,r){for(var o=e.makeCalcdata({v:r.values,vcalendar:t.calendar},"v"),i=0;i<o.length;i++)o[i]=o[i]===p?NaN:o[i];f.push(o),x.push("log"===e.type?a.simpleMap(o,e.c2l):o)}var h=t.dimensions,m=t._length,y={},f=y.cdata=[],x=y.data=[],_=t._visibleDims=[],b,v,w,T,A;for(b=0;b<h.length;b++)if(w=h[b],w.visible){if(T=r.getFromId(e,t._diag[b][0]),A=r.getFromId(e,t._diag[b][1]),T&&A&&T.type!==A.type){a.log("Skipping splom dimension "+b+" with conflicting axis types");continue}T?(g(T,w),A&&"category"===A.type&&(A._categories=T._categories.slice())):g(A,w),_.push(b)}l(e,t),a.extendFlat(y,d(t));var S=f.length,C;for(C=S*m>u?2*(y.sizeAvg||va(y.size,3)):o(t,m),v=0;v<_.length;v++)b=_[v],w=h[b],T=r.getFromId(e,t._diag[b][0])||{},A=r.getFromId(e,t._diag[b][1])||{},n(e,t,T,A,f[v],f[v],C);var L=c(e,t);return L.matrix||(L.matrix=!0),L.matrixOptions=y,L.selectedOptions=s(t,t.selected),L.unselectedOptions=s(t,t.unselected),[{x:!1,y:!1,t:{},trace:t}]}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axis_ids":770,"../scatter/calc":1113,"../scatter/colorscale_calc":1115,"../scattergl/constants":1162,"../scattergl/convert":1163,"./scene_update":1207}],1201:[function(e,t){"use strict";function a(e,t){function a(a,r){return o.coerce(e,t,n.dimensions,a,r)}a("label");var r=a("values");r&&r.length?a("visible"):t.visible=!1,a("axis.type"),a("axis.matches")}function r(e,t,a,r){function o(e,r,o,i){if(e){var n=e.charAt(0),l=a._splomAxes[n];if(t["_"+n+"axes"][e]=1,i.push(e),!(e in l)){var d=l[e]={};o&&(d.label=o.label||"",o.visible&&o.axis&&(o.axis.type&&(d.type=o.axis.type),o.axis.matches&&(d.matches=r)))}}}var n=t.dimensions,l=n.length,s=t.showupperhalf,d=t.showlowerhalf,c=t.diagonal.visible,p=Array(l),u=Array(l),g,h;for(g=0;g<l;g++){var m=g?g+1:"";p[g]="x"+m,u[g]="y"+m}var y=r("xaxes",p),f=r("yaxes",u),x=t._diag=Array(l);t._xaxes={},t._yaxes={};var _=[],b=[],v=!c&&!d,k=!c&&!s;for(t._axesDim={},g=0;g<l;g++){var w=n[g],T=0===g,A=g===l-1,S=T&&v||A&&k?void 0:y[g],C=T&&k||A&&v?void 0:f[g];o(S,C,w,_),o(C,S,w,b),x[g]=[S,C],t._axesDim[S]=g,t._axesDim[C]=g}for(g=0;g<_.length;g++)for(h=0;h<b.length;h++){var L=_[g]+b[h];g>h&&s?a._splomSubplots[L]=1:g<h&&d?a._splomSubplots[L]=1:g===h&&(c||!d||!s)&&(a._splomSubplots[L]=1)}(!d||!c&&s&&d)&&(a._splomGridDflt.xside="bottom",a._splomGridDflt.yside="left")}var o=e("../../lib"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("../scatter/subtypes"),s=e("../scatter/marker_defaults"),d=e("../parcoords/merge_length"),c=/-open/;t.exports=function(e,t,p,u){function g(a,r){return o.coerce(e,t,n,a,r)}var h=i(e,t,{name:"dimensions",handleItemDefaults:a}),m=g("diagonal.visible"),y=g("showupperhalf"),f=g("showlowerhalf"),x=d(t,h,"values");if(!x||!m&&!y&&!f)return void(t.visible=!1);g("text"),g("hovertext"),g("hovertemplate"),s(e,t,p,u,g);var _=c.test(t.marker.symbol),b=l.isBubble(t);g("marker.line.width",_||b?1:0),r(e,t,u,g),o.coerceSelectionMarkerOpacity(t,g)}},{"../../lib":719,"../../plots/array_container_defaults":763,"../parcoords/merge_length":1083,"../scatter/marker_defaults":1130,"../scatter/subtypes":1135,"./attributes":1198}],1202:[function(e,t){"use strict";var a=e("../../lib"),r=e("../scatter/colorscale_calc"),o=e("../scattergl/convert").markerStyle;t.exports=function(e,t){var i=t.trace,n=e._fullLayout._splomScenes[i.uid];if(n){r(e,i),a.extendFlat(n.matrixOptions,o(i));var l=a.extendFlat({},n.matrixOptions,n.viewOpts);n.matrix.update(l,null)}}},{"../../lib":719,"../scatter/colorscale_calc":1115,"../scattergl/convert":1163}],1203:[function(e,t,a){"use strict";a.getDimIndex=function(e,t){for(var a=t._id,r=a.charAt(0),o={x:0,y:1}[r],n=e._visibleDims,l=0,s;l<n.length;l++)if(s=n[l],e._diag[s][o]===a)return l;return!1}},{}],1204:[function(e,t){"use strict";var a=e("./helpers"),r=e("../scattergl/hover").calcHover;t.exports={hoverPoints:function(e,t,o){var n=e.cd,l=n[0].trace,s=e.scene,d=s.matrixOptions.cdata,c=e.xa,p=e.ya,u=c.c2p(t),g=p.c2p(o),h=e.distance,m=a.getDimIndex(l,c),f=a.getDimIndex(l,p);if(!1===m||!1===f)return[e];for(var _=d[m],x=d[f],y=h,b=0,v,k;b<_.length;b++){var w=_[b],T=x[b],A=c.c2p(w)-u,S=p.c2p(T)-g,C=N(A*A+S*S);C<y&&(y=k=C,v=b)}return(e.index=v,e.distance=y,e.dxy=k,void 0===v)?[e]:(r(e,_,x,l),[e])}}},{"../scattergl/hover":1166,"./helpers":1203}],1205:[function(e,t){"use strict";var a=e("../../registry"),r=e("../../components/grid");t.exports={moduleType:"trace",name:"splom",basePlotModule:e("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select"),editStyle:e("./edit_style"),meta:{}},a.register(r)},{"../../components/grid":636,"../../registry":847,"../scatter/marker_colorbar":1129,"./attributes":1198,"./base_plot":1199,"./calc":1200,"./defaults":1201,"./edit_style":1202,"./hover":1204,"./plot":1206,"./select":1208}],1206:[function(e,t){"use strict";function a(e,t){var a=e._fullLayout,l=a._size,s=t.trace,d=t.t,c=a._splomScenes[s.uid],p=c.matrixOptions,u=p.cdata,g=a._glcanvas.data()[0].regl,h=a.dragmode,m,y,f,x,_;if(0!==u.length){p.lower=s.showupperhalf,p.upper=s.showlowerhalf,p.diagonal=s.diagonal.visible;var b=s._visibleDims,v=u.length,w=c.viewOpts={};for(w.ranges=Array(v),w.domains=Array(v),_=0;_<b.length;_++){f=b[_];var T=w.ranges[_]=[,,,,],A=w.domains[_]=[,,,,];m=n.getFromId(e,s._diag[f][0]),m&&(T[0]=m._rl[0],T[2]=m._rl[1],A[0]=m.domain[0],A[2]=m.domain[1]),y=n.getFromId(e,s._diag[f][1]),y&&(T[1]=y._rl[0],T[3]=y._rl[1],A[1]=y.domain[0],A[3]=y.domain[1])}w.viewport=[l.l,l.b,l.w+l.l,l.h+l.b],!0===c.matrix&&(c.matrix=r(g));var S=-1<a.clickmode.indexOf("select"),C="lasso"===h||"select"===h||!!s.selectedpoints||S,L=!0;if(C){var E=s._length;if(s.selectedpoints){c.selectBatch=s.selectedpoints;var I=s.selectedpoints,z={};for(f=0;f<I.length;f++)z[I[f]]=!0;var P=[];for(f=0;f<E;f++)z[f]||P.push(f);c.unselectBatch=P}var D=d.xpx=Array(v),O=d.ypx=Array(v);for(_=0;_<b.length;_++){if(f=b[_],m=n.getFromId(e,s._diag[f][0]),m)for(D[_]=Array(E),x=0;x<E;x++)D[_][x]=m.c2p(u[_][x]);if(y=n.getFromId(e,s._diag[f][1]),y)for(O[_]=Array(E),x=0;x<E;x++)O[_][x]=y.c2p(u[_][x])}if(c.selectBatch.length||c.unselectBatch.length){var R=o.extendFlat({},p,c.unselectedOptions,w),M=o.extendFlat({},p,c.selectedOptions,w);c.matrix.update(R,M),L=!1}}else d.xpx=d.ypx=null;if(L){var F=o.extendFlat({},p,w);c.matrix.update(F,null)}}}var r=e("regl-splom"),o=e("../../lib"),n=e("../../plots/cartesian/axis_ids");t.exports=function(e,t,r){if(r.length)for(var o=0;o<r.length;o++)a(e,r[o][0])}},{"../../lib":719,"../../plots/cartesian/axis_ids":770,"regl-splom":501}],1207:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){var r=e._fullLayout,o=t.uid,i=r._splomScenes;i||(i=r._splomScenes={});var n={dirty:!0},l=i[t.uid];return l||(l=i[o]=a.extendFlat({},n,{matrix:!1,selectBatch:[],unselectBatch:[]}),l.draw=function(){l.matrix&&l.matrix.draw&&(l.selectBatch.length||l.unselectBatch.length?l.matrix.draw(l.unselectBatch,l.selectBatch):l.matrix.draw()),l.dirty=!1},l.destroy=function(){l.matrix&&l.matrix.destroy&&l.matrix.destroy(),l.matrixOptions=null,l.selectBatch=null,l.unselectBatch=null,l=null}),l.dirty||a.extendFlat(l,n),l}},{"../../lib":719}],1208:[function(e,t){"use strict";var a=e("../../lib"),r=e("../scatter/subtypes"),o=e("./helpers");t.exports=function(e,t){var n=e.cd,l=n[0].trace,s=n[0].t,d=e.scene,c=d.matrixOptions.cdata,p=e.xaxis,u=e.yaxis,g=[];if(!d)return g;var h=!r.hasMarkers(l)&&!r.hasText(l);if(!0!==l.visible||h)return g;var m=o.getDimIndex(l,p),f=o.getDimIndex(l,u);if(!1===m||!1===f)return g;var _=s.xpx[m],b=s.ypx[f],v=c[m],x=c[f],y=[],k=[];if(!1!==t&&!t.degenerate)for(var w=0;w<v.length;w++)t.contains([_[w],b[w]],null,w,e)?(y.push(w),g.push({pointNumber:w,x:v[w],y:x[w]})):k.push(w);var T=d.matrixOptions;return y.length||k.length?!d.selectBatch.length&&!d.unselectBatch.length&&d.matrix.update(d.unselectedOptions,a.extendFlat({},T,d.selectedOptions,d.viewOpts)):d.matrix.update(T,null),d.selectBatch=y,d.unselectBatch=k,g}},{"../../lib":719,"../scatter/subtypes":1135,"./helpers":1203}],1209:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("../mesh3d/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:r({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]})};n(l,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));["opacity","lightposition","lighting"].forEach(function(e){l[e]=o[e]}),l.hoverinfo=n({},i.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,t.exports=l},{"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../mesh3d/attributes":1053}],1210:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){var r=t.u,o=t.v,n=t.w,l=t.x,s=t.y,d=t.z,c=ea(l.length,s.length,d.length,r.length,o.length,n.length),p=0,u,g,h,m;t.starts&&(g=t.starts.x||[],h=t.starts.y||[],m=t.starts.z||[],p=ea(g.length,h.length,m.length));var y=0,f=1/0;for(u=0;u<c;u++){var x=r[u],_=o[u],b=n[u],v=N(x*x+_*_+b*b);y=va(y,v),f=ea(f,v)}a(e,t,{vals:[f,y],containerStr:"",cLetter:"c"});var k=-Infinity,w=1/0,T=-Infinity,A=1/0,S=-Infinity,C=1/0;for(u=0;u<c;u++){var L=l[u];k=va(k,L),w=ea(w,L);var E=s[u];T=va(T,E),A=ea(A,E);var I=d[u];S=va(S,I),C=ea(C,I)}for(u=0;u<p;u++){var z=g[u];k=va(k,z),w=ea(w,z);var P=h[u];T=va(T,P),A=ea(A,P);var D=m[u];S=va(S,D),C=ea(C,D)}t._len=c,t._slen=p,t._normMax=y,t._xbnds=[w,k],t._ybnds=[A,T],t._zbnds=[C,S]}},{"../../components/colorscale/calc":601}],1211:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.mesh=null,this.data=null}function r(e){return c.distinctVals(e).vals}function o(e){var t=e.length,a;return a=2<t?e.slice(1,t-1):2===t?[(e[0]+e[1])/2]:e,a}function n(e){var t=e.length;return 1===t?[.5,.5]:[e[1]-e[0],e[t-1]-e[t-2]]}function l(e,t){function a(e,t){var a=l[t],r=d[h[t]];return c.simpleMap(e,function(e){return a.d2l(e)*r})}var l=e.fullSceneLayout,d=e.dataScale,y=t._len,f={};f.vectors=g(a(t.u,"xaxis"),a(t.v,"yaxis"),a(t.w,"zaxis"),y);var x=r(t.x.slice(0,y)),_=r(t.y.slice(0,y)),b=r(t.z.slice(0,y));if(x.length*_.length*b.length>y)return{positions:[],cells:[]};var v=a(x,"xaxis"),w=a(_,"yaxis"),T=a(b,"zaxis");if(f.meshgrid=[v,w,T],t.starts){var A=t._slen;f.startingPositions=g(a(t.starts.x.slice(0,A),"xaxis"),a(t.starts.y.slice(0,A),"yaxis"),a(t.starts.z.slice(0,A),"zaxis"))}else{for(var S=w[0],C=o(v),L=o(T),E=Array(C.length*L.length),I=0,z=0;z<C.length;z++)for(var P=0;P<L.length;P++)E[I++]=[C[z],S,L[P]];f.startingPositions=E}f.colormap=p(t),f.tubeSize=t.sizeref,f.maxLength=t.maxdisplayed;var D=a(t._xbnds,"xaxis"),O=a(t._ybnds,"yaxis"),R=a(t._zbnds,"zaxis"),M=n(v),j=n(w),F=n(T),B=[[D[0]-M[0],O[0]-j[0],R[0]-F[0]],[D[1]+M[1],O[1]+j[1],R[1]+F[1]]],N=s(f,B),V=u(t);N.vertexIntensityBounds=[V.min/t._normMax,V.max/t._normMax];var U=t.lightposition;return N.lightPosition=[U.x,U.y,U.z],N.ambient=t.lighting.ambient,N.diffuse=t.lighting.diffuse,N.specular=t.lighting.specular,N.roughness=t.lighting.roughness,N.fresnel=t.lighting.fresnel,N.opacity=t.opacity,t._pad=2*(N.tubeScale*t.sizeref),N}var s=e("gl-streamtube3d"),d=s.createTubeMesh,c=e("../../lib"),p=e("../../lib/gl_format_color").parseColorScale,u=e("../../components/colorscale").extractOpts,g=e("../../plots/gl3d/zip3"),h={xaxis:0,yaxis:1,zaxis:2},m=a.prototype;m.handlePick=function(e){function t(e,t){var o=a[t],i=r[h[t]];return o.l2c(e)/i}var a=this.scene.fullSceneLayout,r=this.scene.dataScale;if(e.object===this.mesh){var o=e.data.position,i=e.data.velocity;return e.traceCoordinate=[t(o[0],"xaxis"),t(o[1],"yaxis"),t(o[2],"zaxis"),t(i[0],"xaxis"),t(i[1],"yaxis"),t(i[2],"zaxis"),e.data.intensity*this.data._normMax,e.data.divergence],e.textLabel=this.data.hovertext||this.data.text,!0}},m.update=function(e){this.data=e;var t=l(this.scene,e);this.mesh.update(t)},m.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var r=e.glplot.gl,o=l(e,t),i=d(r,o),n=new a(e,t.uid);return n.mesh=i,n.data=t,i._trace=n,e.glplot.add(i),n}},{"../../components/colorscale":605,"../../lib":719,"../../lib/gl_format_color":716,"../../plots/gl3d/zip3":818,"gl-streamtube3d":313}],1212:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/colorscale/defaults"),o=e("./attributes");t.exports=function(e,t,i,n){function l(r,i){return a.coerce(e,t,o,r,i)}var s=l("u"),d=l("v"),c=l("w"),p=l("x"),u=l("y"),g=l("z");return s&&s.length&&d&&d.length&&c&&c.length&&p&&p.length&&u&&u.length&&g&&g.length?void(l("starts.x"),l("starts.y"),l("starts.z"),l("maxdisplayed"),l("sizeref"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),r(e,t,n,l,{prefix:"",cLetter:"c"}),l("text"),l("hovertext"),l("hovertemplate"),t._length=null):void(t.visible=!1)}},{"../../components/colorscale/defaults":603,"../../lib":719,"./attributes":1209}],1213:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"streamtube",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),eventData:function(e,t){return e.tubex=e.x,e.tubey=e.y,e.tubez=e.z,e.tubeu=t.traceCoordinate[3],e.tubev=t.traceCoordinate[4],e.tubew=t.traceCoordinate[5],e.norm=t.traceCoordinate[6],e.divergence=t.traceCoordinate[7],delete e.x,delete e.y,delete e.z,e},meta:{}}},{"../../plots/gl3d":807,"./attributes":1209,"./calc":1210,"./convert":1211,"./defaults":1212}],1214:[function(e,t){"use strict";var a=e("../../plots/attributes"),r=e("../../components/fx/hovertemplate_attributes"),o=e("../../plots/domain").attributes,i=e("../pie/attributes"),n=e("../../lib/extend").extendFlat;t.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:n({},i.marker.line.color,{dflt:null}),width:n({},i.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},leaf:{opacity:{valType:"number",editType:"style",min:0,max:1,dflt:.7},editType:"plot"},text:i.text,textinfo:n({},i.textinfo,{editType:"plot",flags:["label","text","value"]}),textfont:i.textfont,hovertext:i.hovertext,hoverinfo:n({},a.hoverinfo,{flags:["label","text","value","name"]}),hovertemplate:r(),insidetextfont:i.insidetextfont,outsidetextfont:i.outsidetextfont,domain:o({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../../plots/domain":792,"../pie/attributes":1086}],1215:[function(e,t,a){"use strict";var r=e("../../registry"),o=e("../../plots/get_data").getModuleCalcData,i=a.name="sunburst";a.plot=function(e,t,a,n){var l=r.getModule(i),s=o(e.calcdata,l)[0];l.plot(e,s,a,n)},a.clean=function(e,t,a,r){var o=r._has&&r._has(i),n=t._has&&t._has(i);o&&!n&&r._sunburstlayer.selectAll("g.trace").remove()}},{"../../plots/get_data":802,"../../registry":847}],1216:[function(e,t,a){"use strict";var r=e("d3-hierarchy"),o=e("fast-isnumeric"),i=e("../../lib"),n=e("../pie/calc").makePullColorFn,l=e("../pie/calc").generateExtendedColors,s=i.isArrayOrTypedArray,d={};a.calc=function(e,t){var a=e._fullLayout,l=t.ids,d=s(l),c=t.labels,p=t.parents,u=t.values,g=s(u),h=[],m={},y={},f=function(e,t){m[e]?m[e].push(t):m[e]=[t],y[t]=1},x=function(e){return e||"number"==typeof e},_=function(e){return!g||o(u[e])&&0<=u[e]},b,v,w;d?(b=ea(l.length,p.length),v=function(e){return x(l[e])&&_(e)},w=function(e){return l[e]+""}):(b=ea(c.length,p.length),v=function(e){return x(c[e])&&_(e)},w=function(e){return c[e]+""}),g&&(b=ea(b,u.length));for(var T=0;T<b;T++)if(v(T)){var A=w(T),S=x(p[T])?p[T]+"":"",C={i:T,id:A,pid:S,label:x(c[T])?c[T]+"":""};g&&(C.v=+u[T]),h.push(C),f(S,A)}if(!m[""]){var L=[],E;for(E in m)y[E]||L.push(E);if(1===L.length)E=L[0],h.unshift({id:E,pid:"",label:E});else return i.warn("Multiple implied roots, cannot build sunburst hierarchy.")}else if(1<m[""].length){for(var I=i.randstr(),z=0;z<h.length;z++)""===h[z].pid&&(h[z].pid=I);h.unshift({hasMultipleRoots:!0,id:I,pid:""})}var P;try{P=r.stratify().id(function(e){return e.id}).parentId(function(e){return e.pid})(h)}catch(t){return i.warn("Failed to build sunburst hierarchy. Error: "+t.message)}var D=r.hierarchy(P),O=!1;if(g)switch(t.branchvalues){case"remainder":D.sum(function(e){return e.data.v});break;case"total":D.each(function(e){var t=e.data.data.v;if(e.children){var a=e.children.reduce(function(e,t){return e+t.data.data.v},0);if(t<a)return O=!0,i.warn(["Total value for node",e.data.data.id,"is smaller than the sum of its children."].join(" "))}e.value=t});}else D.count();if(!O){D.sort(function(e,t){return t.value-e.value});var R=t.marker.colors||[],M=n(a._sunburstcolormap);return D.each(function(e){var t=e.data.data,a=t.id;t.color=M(R[t.i],a)}),h[0].hierarchy=D,h}},a.crossTraceCalc=function(e){function t(e){var t=e.data.data,a=t.id;!1===t.color&&(n[a]?t.color=n[a]:e.parent?e.parent.parent?t.color=e.parent.data.data.color:(n[a]=t.color=o[s%o.length],s++):t.color="rgba(0,0,0,0)")}var a=e._fullLayout,r=e.calcdata,o=a.sunburstcolorway,n=a._sunburstcolormap;a.extendsunburstcolors&&(o=l(o,d));for(var s=0,c=0;c<r.length;c++){var p=r[c],u=p[0];"sunburst"===u.trace.type&&u.hierarchy&&u.hierarchy.each(t)}}},{"../../lib":719,"../pie/calc":1088,"d3-hierarchy":157,"fast-isnumeric":225}],1217:[function(e,t){"use strict";t.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear"}},{}],1218:[function(e,t){"use strict";var a=e("../../lib"),r=e("./attributes"),o=e("../../plots/domain").defaults,i=e("../bar/defaults").handleText;t.exports=function(e,t,n,l){function s(o,i){return a.coerce(e,t,r,o,i)}var d=s("labels"),c=s("parents");if(!d||!d.length||!c||!c.length)return void(t.visible=!1);var p=s("values");p&&p.length&&s("branchvalues"),s("level"),s("maxdepth");var u=s("marker.line.width");u&&s("marker.line.color",l.paper_bgcolor),s("marker.colors"),s("leaf.opacity");var g=s("text");s("textinfo",Array.isArray(g)?"text+label":"label"),s("hovertext"),s("hovertemplate");i(e,t,l,s,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),o(t,l,s),t._length=null}},{"../../lib":719,"../../plots/domain":792,"../bar/defaults":861,"./attributes":1214}],1219:[function(e,t,a){"use strict";var r=e("../../lib"),o=e("../../components/color"),i=e("../../lib/setcursor"),n=e("../../components/fx/helpers").appendArrayPointValue;a.makeEventData=function(e,t){var a=e.data.data,r={curveNumber:t.index,pointNumber:a.i,data:t._input,fullData:t};return n(r,t,a.i),r},a.findEntryWithLevel=function(e,t){var r;return t&&e.eachAfter(function(e){if(a.getPtId(e)===t)return r=e.copy()}),r||e},a.findEntryWithChild=function(e,t){var r;return e.eachAfter(function(e){for(var o=e.children||[],n=0,l;n<o.length;n++)if(l=o[n],a.getPtId(l)===t)return r=e.copy()}),r||e},a.isHierachyRoot=function(e){var t=e.data.data;return""===t.pid},a.isEntry=function(e){return!e.parent},a.isLeaf=function(e){return!e.children},a.getPtId=function(e){var t=e.data.data;return t.id},a.setSliceCursor=function(e,t,r){var o=e.datum(),n=(r||{}).isTransitioning;i(e,n||a.isLeaf(o)||a.isHierachyRoot(o)?null:"pointer")},a.determineOutsideTextFont=function(e,t,a){var o=t.data.data,i=o.i,n=r.castOption(e,i,"outsidetextfont.color")||r.castOption(e,i,"textfont.color")||a.color,l=r.castOption(e,i,"outsidetextfont.family")||r.castOption(e,i,"textfont.family")||a.family,s=r.castOption(e,i,"outsidetextfont.size")||r.castOption(e,i,"textfont.size")||a.size;return{color:n,family:l,size:s}},a.determineInsideTextFont=function(e,t,a){var i=t.data.data,n=i.i,l=r.castOption(e,n,"insidetextfont.color");!l&&e._input.textfont&&(l=r.castOption(e._input,n,"textfont.color"));var s=r.castOption(e,n,"insidetextfont.family")||r.castOption(e,n,"textfont.family")||a.family,d=r.castOption(e,n,"insidetextfont.size")||r.castOption(e,n,"textfont.size")||a.size;return{color:l||o.contrast(i.color),family:s,size:d}}},{"../../components/color":593,"../../components/fx/helpers":628,"../../lib":719,"../../lib/setcursor":739}],1220:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"sunburst",basePlotModule:e("./base_plot"),categories:[],animatable:!0,attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),style:e("./style").style,meta:{}}},{"./attributes":1214,"./base_plot":1215,"./calc":1216,"./defaults":1218,"./layout_attributes":1221,"./layout_defaults":1222,"./plot":1223,"./style":1224}],1221:[function(e,t){"use strict";t.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1222:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t){function o(o,i){return a.coerce(e,t,r,o,i)}o("sunburstcolorway",t.colorway),o("extendsunburstcolors")}},{"../../lib":719,"./layout_attributes":1221}],1223:[function(e,t){"use strict";function a(e,t,a,i){function c(e){var t=v.getPtId(e),r=F[t],o=F[v.getPtId(C)],i;if(o){var l=e.x1>o.x1?2*Pe:0;i=e.rpx1<o.rpx1?{rpx0:0,rpx1:0}:{x0:l,x1:l}}else{var a=v.getPtId(e.parent),s;w.each(function(e){if(v.getPtId(e)===a)return s=e});var c=s.children,p;c.forEach(function(e,a){if(v.getPtId(e)===t)return p=a});var u=c.length,n=d.interpolate(s.x0,s.x1);i={rpx0:D,rpx1:D,x0:n(p/u),x1:n((p+1)/u)}}return d.interpolate(r,i)}function p(e){var t=F[v.getPtId(e)],r={x0:e.x0,x1:e.x1,rpx0:e.rpx0,rpx1:e.rpx1},o;if(t)o=t;else if(!j)o={x0:0,x1:0};else if(!e.parent)o={rpx0:0,rpx1:0};else if(Z){var i=e.x1>Z?2*Pe:0;o={x0:i,x1:i}}else o={rpx0:D,rpx1:D},h.extendFlat(o,m(e));return d.interpolate(o,r)}function u(e){var t=F[v.getPtId(e)],r=e.transform,o;if(t)o=t;else if(o={rpx1:e.rpx1,transform:{scale:0,rotate:r.rotate,rCenter:r.rCenter,x:r.x,y:r.y}},!j)o.x0=o.x1=0;else if(!e.parent)o.x0=o.x1=0;else if(Z){var i=e.x1>Z?2*Pe:0;o.x0=o.x1=i}else h.extendFlat(o,m(e));var a=d.interpolate(o.rpx1,e.rpx1),n=d.interpolate(o.x0,e.x0),l=d.interpolate(o.x1,e.x1),s=d.interpolate(o.transform.scale,r.scale),c=d.interpolate(o.transform.rotate,r.rotate),p=0===r.rCenter?3:0===o.transform.rCenter?1/3:1,u=d.interpolate(o.transform.rCenter,r.rCenter),g=function(e){return u(ya(e,p))};return function(e){var t=a(e),o=n(e),i=l(e),p=g(e),u={pxmid:q(t,(o+i)/2),transform:{rCenter:p,x:r.x,y:r.y}},d={rpx1:a(e),translateX:W(u),translateY:X(u),transform:{scale:s(e),rotate:c(e),rCenter:p}};return d}}function m(e){var t=e.parent,a=F[v.getPtId(t)],r={};if(a){var o=t.children,i=o.indexOf(e),l=o.length,n=d.interpolate(a.x0,a.x1);r.x0=n(i/l),r.x1=n(i/l)}else r.x0=r.x1=0;return r}var x=e._fullLayout,b=i&&0<i.duration,k=d.select(a),w=k.selectAll("g.slice"),T=t[0],A=T.trace,S=T.hierarchy,C=o(S,A.level),L=0<=A.maxdepth?A.maxdepth:1/0,E=x._size,I=A.domain,z=E.w*(I.x[1]-I.x[0]),P=E.h*(I.y[1]-I.y[0]),D=.5*ea(z,P),O=T.cx=E.l+E.w*(I.x[1]+I.x[0])/2,M=T.cy=E.t+E.h*(1-I.y[0])-P/2;if(!C)return w.remove();var j=null,F={};b&&w.each(function(e){F[v.getPtId(e)]={rpx0:e.rpx0,rpx1:e.rpx1,x0:e.x0,x1:e.x1,transform:e.transform},!j&&v.isEntry(e)&&(j=e)});var B=r(C).descendants(),N=C.height+1,V=0,U=L;T.hasMultipleRoots&&v.isHierachyRoot(C)&&(B=B.slice(1),N-=1,V=1,U+=1),B=B.filter(function(e){return e.y1<=U});var H=ea(N,L),G=function(e){return(e-V)/H*D},q=function(e,t){return[e*R(t),-e*De(t)]},Y=function(e){return h.pathAnnulus(e.rpx0,e.rpx1,e.x0,e.x1,O,M)},W=function(e){return O+e.pxmid[0]*e.transform.rCenter+(e.transform.x||0)},X=function(e){return M+e.pxmid[1]*e.transform.rCenter+(e.transform.y||0)};w=w.data(B,function(e){return v.getPtId(e)}),w.enter().append("g").classed("slice",!0),b?w.exit().transition().each(function(){var e=d.select(this),t=e.select("path.surface");t.transition().attrTween("d",function(e){var a=c(e);return function(e){return Y(a(e))}});var a=e.select("g.slicetext");a.attr("opacity",0)}).remove():w.exit().remove(),w.order();var Z=null;if(b&&j){var K=v.getPtId(j);w.each(function(e){null===Z&&v.getPtId(e)===K&&(Z=e.x1)})}var J=w;b&&(J=J.transition().each("end",function(){var t=d.select(this);v.setSliceCursor(t,e,{isTransitioning:!1})})),J.each(function(a){var r=d.select(this),o=h.ensureSingle(r,"path","surface",function(e){e.style("pointer-events","all")});a.rpx0=G(a.y0),a.rpx1=G(a.y1),a.xmid=(a.x0+a.x1)/2,a.pxmid=q(a.rpx1,a.xmid),a.midangle=-(a.xmid-Pe/2),a.halfangle=.5*ea(h.angleDelta(a.x0,a.x1)||Pe,Math.PI),a.ring=1-a.rpx0/a.rpx1,a.rInscribed=s(a,A),b?o.transition().attrTween("d",function(e){var a=p(e);return function(e){return Y(a(e))}}):o.attr("d",Y),r.call(n,e,t).call(v.setSliceCursor,e,{isTransitioning:e._transitioning}),o.call(_,a,A);var i=h.ensureSingle(r,"g","slicetext"),c=h.ensureSingle(i,"text","",function(e){e.attr("data-notex",1)});c.text(l(a,A,x)).classed("slicetext",!0).attr("text-anchor","middle").call(g.font,v.isHierachyRoot(a)?v.determineOutsideTextFont(A,a,x.font):v.determineInsideTextFont(A,a,x.font)).call(y.convertToTspans,e);var m=g.bBox(c.node());a.transform=f(m,a,T),a.translateX=W(a),a.translateY=X(a);var k=function(e,t){return"translate("+e.translateX+","+e.translateY+")"+(1>e.transform.scale?"scale("+e.transform.scale+")":"")+(e.transform.rotate?"rotate("+e.transform.rotate+")":"")+"translate("+-(t.left+t.right)/2+","+-(t.top+t.bottom)/2+")"};b?c.transition().attrTween("transform",function(e){var a=u(e);return function(e){return k(a(e),m)}}):c.attr("transform",k(a,m))})}function r(e){return c.partition().size([2*Pe,e.height+1])(e)}function o(e,t){var a;return t&&e.eachAfter(function(e){if(v.getPtId(e)===t)return a=e.copy()}),a||e}function i(e,t){var a;return e.eachAfter(function(e){for(var r=e.children||[],o=0,n;o<r.length;o++)if(n=r[o],v.getPtId(n)===t)return a=e.copy()}),a||e}function n(e,t,a){var r=a[0],n=r.trace;"_hasHoverLabel"in n||(n._hasHoverLabel=!1),"_hasHoverEvent"in n||(n._hasHoverEvent=!1),e.on("mouseover",function(e){var a=t._fullLayout;if(!(t._dragging||!1===a.hovermode)){var o=t._fullData[n.index],i=e.data.data,l=i.i,s=function(e){return h.castOption(o,l,e)},c=s("hovertemplate"),p=u.castHoverinfo(o,a,l),g=a.separators;if(c||p&&"none"!==p&&"skip"!==p){var m=e.rInscribed,y=r.cx+e.pxmid[0]*(1-m),f=r.cy+e.pxmid[1]*(1-m),_={},b=[],k=[],w=function(e){return-1!==b.indexOf(e)};if(p&&(b="all"===p?o._module.attributes.hoverinfo.flags:p.split("+")),_.label=i.label,w("label")&&_.label&&k.push(_.label),i.hasOwnProperty("v")&&(_.value=i.v,_.valueLabel=x(_.value,g),w("value")&&k.push(_.valueLabel)),_.text=s("hovertext")||s("text"),w("text")){var T=_.text;h.isValidTextValue(T)&&k.push(T)}u.loneHover({trace:o,x0:y-m*e.rpx1,x1:y+m*e.rpx1,y:f,idealAlign:0>e.pxmid[0]?"left":"right",text:k.join("<br>"),name:c||w("name")?o.name:void 0,color:s("hoverlabel.bgcolor")||i.color,borderColor:s("hoverlabel.bordercolor"),fontFamily:s("hoverlabel.font.family"),fontSize:s("hoverlabel.font.size"),fontColor:s("hoverlabel.font.color"),nameLength:s("hoverlabel.namelength"),textAlign:s("hoverlabel.align"),hovertemplate:c,hovertemplateLabels:_,eventData:[v.makeEventData(e,o)]},{container:a._hoverlayer.node(),outerContainer:a._paper.node(),gd:t}),n._hasHoverLabel=!0}n._hasHoverEvent=!0,t.emit("plotly_hover",{points:[v.makeEventData(e,o)],event:d.event})}}),e.on("mouseout",function(e){var a=t._fullLayout,r=t._fullData[n.index],o=d.select(this).datum();n._hasHoverEvent&&(e.originalEvent=d.event,t.emit("plotly_unhover",{points:[v.makeEventData(o,r)],event:d.event}),n._hasHoverEvent=!1),n._hasHoverLabel&&(u.loneUnhover(a._hoverlayer.node()),n._hasHoverLabel=!1)}),e.on("click",function(e){var a=t._fullLayout,l=t._fullData[n.index],s=m.triggerHandler(t,"plotly_sunburstclick",{points:[v.makeEventData(e,l)],event:d.event});if(!1===s||v.isLeaf(e)||v.isHierachyRoot(e))return void(a.hovermode&&(t._hoverdata=[v.makeEventData(e,l)],u.click(t,d.event)));if(!t._dragging&&!t._transitioning){p.call("_storeDirectGUIEdit",l,a._tracePreGUI[l.uid],{level:l.level});var c=r.hierarchy,g=v.getPtId(e),h=v.isEntry(e)?i(c,g):o(c,g),y={data:[{level:v.getPtId(h)}],traces:[n.index]},f={frame:{redraw:!1,duration:b.CLICK_TRANSITION_TIME},transition:{duration:b.CLICK_TRANSITION_TIME,easing:b.CLICK_TRANSITION_EASING},mode:"immediate",fromcurrent:!0};u.loneUnhover(a._hoverlayer.node()),p.call("animate",t,y,f)}})}function l(e,t,a){var r=t.textinfo;if(!r||"none"===r)return"";var o=e.data.data,i=a.separators,n=r.split("+"),l=function(e){return-1!==n.indexOf(e)},s=[];if(l("label")&&o.label&&s.push(o.label),o.hasOwnProperty("v")&&l("value")&&s.push(x(o.v,i)),l("text")){var d=h.castOption(t,o.i,"text");h.isValidTextValue(d)&&s.push(d)}return s.join("<br>")}function s(e){return 0===e.rpx0&&h.isFullCircle([e.x0,e.x1])?1:va(0,ea(1/(1+1/De(e.halfangle)),e.ring/2))}var d=e("d3"),c=e("d3-hierarchy"),p=e("../../registry"),u=e("../../components/fx"),g=e("../../components/drawing"),h=e("../../lib"),m=e("../../lib/events"),y=e("../../lib/svg_text_utils"),f=e("../pie/plot").transformInsideText,x=e("../pie/helpers").formatPieValue,_=e("./style").styleOne,b=e("./constants"),v=e("./helpers");t.exports=function(e,t,r,o){var i=e._fullLayout,n=i._sunburstlayer,l=r&&0<r.duration,s,c;if(s=n.selectAll("g.trace.sunburst").data(t,function(e){return e[0].trace.uid}),s.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),s.order(),l){o&&(c=o());var p=d.transition().duration(r.duration).ease(r.easing).each("end",function(){c&&c()}).each("interrupt",function(){c&&c()});p.each(function(){n.selectAll("g.trace").each(function(t){a(e,t,this,r)})})}else s.each(function(t){a(e,t,this,r)});!r&&s.exit().remove()}},{"../../components/drawing":614,"../../components/fx":632,"../../lib":719,"../../lib/events":709,"../../lib/svg_text_utils":743,"../../registry":847,"../pie/helpers":1091,"../pie/plot":1095,"./constants":1217,"./helpers":1219,"./style":1224,d3:163,"d3-hierarchy":157}],1224:[function(e,t){"use strict";function a(e,t,a){var r=t.data.data,n=!t.children,l=r.i,s=i.castOption(a,l,"marker.line.color")||o.defaultLine,d=i.castOption(a,l,"marker.line.width")||0;e.style("stroke-width",d).call(o.fill,r.color).call(o.stroke,s).style("opacity",n?a.leaf.opacity:null)}var r=e("d3"),o=e("../../components/color"),i=e("../../lib");t.exports={style:function(e){e._fullLayout._sunburstlayer.selectAll(".trace").each(function(e){var t=r.select(this),o=e[0],i=o.trace;t.style("opacity",i.opacity),t.selectAll("path.surface").each(function(e){r.select(this).call(a,e,i)})})},styleOne:a}},{"../../components/color":593,"../../lib":719,d3:163}],1225:[function(e,t){"use strict";function a(){return{valType:"boolean",dflt:!1}}function r(){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:a("x"),y:a("y"),z:a("z")},color:{valType:"color",dflt:o.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:o.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var o=e("../../components/color"),i=e("../../components/colorscale/attributes"),n=e("../../components/fx/hovertemplate_attributes"),l=e("../../plots/attributes"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=t.exports=d(s({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:n(),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},i("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:r("x"),y:r("y"),z:r("z")},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},_deprecated:{zauto:s({},i.zauto,{}),zmin:s({},i.zmin,{}),zmax:s({},i.zmax,{})},hoverinfo:s({},l.hoverinfo)}),"calc","nested");c.x.editType=c.y.editType=c.z.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/color":593,"../../components/colorscale/attributes":600,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764}],1226:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){t.surfacecolor?a(e,t,{vals:t.surfacecolor,containerStr:"",cLetter:"c"}):a(e,t,{vals:t.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":601}],1227:[function(e,t){"use strict";function a(e,t,a){this.scene=e,this.uid=a,this.surface=t,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-Infinity,-Infinity,-Infinity],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}function r(e){var t=e[0].rgb,a=e[e.length-1].rgb;return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]}function o(e,t){if(e<t)return 0;for(var r=0;0===ba(e%t);)e/=t,r++;return r}function n(e){for(var t=[],a=0,r;a<k.length;a++)r=k[a],t.push(o(e,r));return t}function l(e){for(var t=n(e),a=e,r=0;r<k.length;r++)if(0<t[r]){a=k[r];break}return a}function s(e,t){if(!(1>e||1>t)){for(var a=n(e),r=n(t),o=1,l=0;l<k.length;l++)o*=ya(k[l],va(a[l],r[l]));return o}}function d(e){if(0!==e.length){for(var t=1,a=0;a<e.length;a++)t=s(t,e[a]);return t}}function c(e,t){for(var a=!1,r=0;r<e.length;r++)if(t===e[r]){a=!0;break}!1===a&&e.push(t)}var p=e("gl-surface3d"),u=e("ndarray"),g=e("ndarray-homography"),h=e("ndarray-fill"),m=e("../../lib").isArrayOrTypedArray,y=e("../../lib/gl_format_color").parseColorScale,f=e("../../lib/str2rgbarray"),x=e("../../components/colorscale").extractOpts,_=e("../heatmap/interp2d"),b=e("../heatmap/find_empties"),v=a.prototype;v.getXat=function(e,t,a,r){var o=m(this.data.x)?m(this.data.x[0])?this.data.x[t][e]:this.data.x[e]:e;return a===void 0?o:r.d2l(o,0,a)},v.getYat=function(e,t,a,r){var o=m(this.data.y)?m(this.data.y[0])?this.data.y[t][e]:this.data.y[t]:t;return a===void 0?o:r.d2l(o,0,a)},v.getZat=function(e,t,a,r){var o=this.data.z[t][e];return null===o&&this.data.connectgaps&&this.data._interpolatedZ&&(o=this.data._interpolatedZ[t][e]),void 0===a?o:r.d2l(o,0,a)},v.handlePick=function(e){if(e.object===this.surface){var t=(e.data.index[0]-1)/this.dataScaleX-1,a=(e.data.index[1]-1)/this.dataScaleY-1,r=va(ea(V(t),this.data.z[0].length-1),0),o=va(ea(V(a),this.data._ylength-1),0);e.index=[r,o],e.traceCoordinate=[this.getXat(r,o),this.getYat(r,o),this.getZat(r,o)],e.dataCoordinate=[this.getXat(r,o,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(r,o,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(r,o,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var n=0,l;3>n;n++)l=e.dataCoordinate[n],null!==l&&void 0!==l&&(e.dataCoordinate[n]*=this.scene.dataScale[n]);var s=this.data.hovertext||this.data.text;return e.textLabel=Array.isArray(s)&&s[o]&&void 0!==s[o][r]?s[o][r]:s?s:"",e.data.dataCoordinate=e.dataCoordinate.slice(),this.surface.highlight(e.data),this.scene.glplot.spikes.position=e.dataCoordinate,!0}};var k=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];v.calcXnums=function(e){var t=[],r;for(r=1;r<e;r++){var o=this.getXat(r-1,0),a=this.getXat(r,0);t[r-1]=a!==o&&void 0!==o&&null!==o&&void 0!==a&&null!==a?_a(a-o):0}var n=0;for(r=1;r<e;r++)n+=t[r-1];for(r=1;r<e;r++)t[r-1]=0===t[r-1]?1:V(n/t[r-1]);return t},v.calcYnums=function(e){var t=[],r;for(r=1;r<e;r++){var o=this.getYat(0,r-1),a=this.getYat(0,r);t[r-1]=a!==o&&void 0!==o&&null!==o&&void 0!==a&&null!==a?_a(a-o):0}var n=0;for(r=1;r<e;r++)n+=t[r-1];for(r=1;r<e;r++)t[r-1]=0===t[r-1]?1:V(n/t[r-1]);return t};var w=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],T=w[9],A=w[13];v.estimateScale=function(e,t){for(var a=0===t?this.calcXnums(e):this.calcYnums(e),r=1+d(a);r<T;)r*=2;for(;r>A;)r--,r/=l(r),r++,r<T&&(r=A);var o=V(r/e);return 1<o?o:1},v.refineCoords=function(e){for(var t=this.dataScaleX,a=this.dataScaleY,r=e[0].shape[0],o=e[0].shape[1],n=0|ba(e[0].shape[0]*t+1),l=0|ba(e[0].shape[1]*a+1),s=1+r+1,d=1+o+1,c=u(new Float32Array(s*d),[s,d]),p=0;p<e.length;++p){this.surface.padField(c,e[p]);var h=u(new Float32Array(n*l),[n,l]);g(h,c,[t,0,0,0,a,0,0,0,1]),e[p]=h}},v.setContourLevels=function(){var e=[[],[],[]],t=[!1,!1,!1],a=!1,r,o,n;for(r=0;3>r;++r)if(this.showContour[r]&&(a=!0,0<this.contourSize[r]&&null!==this.contourStart[r]&&null!==this.contourEnd[r]&&this.contourEnd[r]>this.contourStart[r]))for(t[r]=!0,o=this.contourStart[r];o<this.contourEnd[r];o+=this.contourSize[r])n=o*this.scene.dataScale[r],c(e[r],n);if(a){var l=[[],[],[]];for(r=0;3>r;++r)this.showContour[r]&&(l[r]=t[r]?e[r]:this.scene.contourLevels[r]);this.surface.update({levels:l})}},v.update=function(e){var t=this.scene,a=t.fullSceneLayout,o=this.surface,n=e.opacity,l=y(e,n),s=t.dataScale,d=e.z[0].length,c=e._ylength,p=t.contourLevels;this.data=e;var g=[],m,w,T,S;for(m=0;3>m;m++)for(g[m]=[],w=0;w<d;w++)g[m][w]=[];for(w=0;w<d;w++)for(T=0;T<c;T++)g[0][w][T]=this.getXat(w,T,e.xcalendar,a.xaxis),g[1][w][T]=this.getYat(w,T,e.ycalendar,a.yaxis),g[2][w][T]=this.getZat(w,T,e.zcalendar,a.zaxis);if(e.connectgaps)for(e._emptypoints=b(g[2]),_(g[2],e._emptypoints),e._interpolatedZ=[],w=0;w<d;w++)for(e._interpolatedZ[w]=[],T=0;T<c;T++)e._interpolatedZ[w][T]=g[2][w][T];for(m=0;3>m;m++)for(w=0;w<d;w++)for(T=0;T<c;T++)S=g[m][w][T],null===S||void 0===S?g[m][w][T]=NaN:S=g[m][w][T]*=s[m];for(m=0;3>m;m++)for(w=0;w<d;w++)for(T=0;T<c;T++)S=g[m][w][T],null!==S&&void 0!==S&&(this.minValues[m]>S&&(this.minValues[m]=S),this.maxValues[m]<S&&(this.maxValues[m]=S));for(m=0;3>m;m++)this.objectOffset[m]=.5*(this.minValues[m]+this.maxValues[m]);for(m=0;3>m;m++)for(w=0;w<d;w++)for(T=0;T<c;T++)S=g[m][w][T],null!==S&&void 0!==S&&(g[m][w][T]-=this.objectOffset[m]);var C=[u(new Float32Array(d*c),[d,c]),u(new Float32Array(d*c),[d,c]),u(new Float32Array(d*c),[d,c])];h(C[0],function(e,t){return g[0][e][t]}),h(C[1],function(e,t){return g[1][e][t]}),h(C[2],function(e,t){return g[2][e][t]}),g=[];var L={colormap:l,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!e.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacity:e.opacity},E=x(e);if(L.intensityBounds=[E.min,E.max],e.surfacecolor){var I=u(new Float32Array(d*c),[d,c]);h(I,function(t,a){return e.surfacecolor[a][t]}),C.push(I)}else L.intensityBounds[0]*=s[2],L.intensityBounds[1]*=s[2];(A<C[0].shape[0]||A<C[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(C[0].shape[0],0),this.dataScaleY=this.estimateScale(C[0].shape[1],1),(1!==this.dataScaleX||1!==this.dataScaleY)&&this.refineCoords(C)),e.surfacecolor&&(L.intensity=C.pop());var z=[!0,!0,!0],P=["x","y","z"];for(m=0;3>m;++m){var D=e.contours[P[m]];z[m]=D.highlight,L.showContour[m]=D.show||D.highlight,L.showContour[m]&&(L.contourProject[m]=[D.project.x,D.project.y,D.project.z],D.show?(this.showContour[m]=!0,L.levels[m]=p[m],o.highlightColor[m]=L.contourColor[m]=f(D.color),o.highlightTint[m]=D.usecolormap?L.contourTint[m]=0:L.contourTint[m]=1,L.contourWidth[m]=D.width,this.contourStart[m]=D.start,this.contourEnd[m]=D.end,this.contourSize[m]=D.size):(this.showContour[m]=!1,this.contourStart[m]=null,this.contourEnd[m]=null,this.contourSize[m]=0),D.highlight&&(L.dynamicColor[m]=f(D.highlightcolor),L.dynamicWidth[m]=D.highlightwidth))}r(l)&&(L.vertexColor=!0),L.objectOffset=this.objectOffset,L.coords=C,o.update(L),o.visible=e.visible,o.enableDynamic=z,o.enableHighlight=z,o.snapToData=!0,"lighting"in e&&(o.ambientLight=e.lighting.ambient,o.diffuseLight=e.lighting.diffuse,o.specularLight=e.lighting.specular,o.roughness=e.lighting.roughness,o.fresnel=e.lighting.fresnel),"lightposition"in e&&(o.lightPosition=[e.lightposition.x,e.lightposition.y,e.lightposition.z]),n&&1>n&&(o.supportsTransparency=!0)},v.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},t.exports=function(e,t){var r=e.glplot.gl,o=p({gl:r}),i=new a(e,o,t.uid);return o._trace=i,i.update(t),e.glplot.add(o),i}},{"../../components/colorscale":605,"../../lib":719,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../heatmap/find_empties":1007,"../heatmap/interp2d":1010,"gl-surface3d":316,ndarray:450,"ndarray-fill":440,"ndarray-homography":442}],1228:[function(e,t){"use strict";function a(e,t,a){t in e&&!(a in e)&&(e[a]=e[t])}var r=e("../../registry"),o=e("../../lib"),n=e("../../components/colorscale/defaults"),l=e("./attributes");t.exports=function(e,t,s,d){function c(a,r){return o.coerce(e,t,l,a,r)}var p=c("x"),u=c("y"),g=c("z"),h,m;if(!g||!g.length||!!p&&1>p.length||!!u&&1>u.length)return void(t.visible=!1);t._xlength=Array.isArray(p)&&o.isArrayOrTypedArray(p[0])?g.length:g[0].length,t._ylength=g.length;var y=r.getComponentMethod("calendars","handleTraceDefaults");y(e,t,["x","y","z"],d),c("text"),c("hovertext"),c("hovertemplate"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(e){c(e)});var f=c("surfacecolor"),x=["x","y","z"];for(h=0;3>h;++h){var _="contours."+x[h],b=c(_+".show"),v=c(_+".highlight");if(b||v)for(m=0;3>m;++m)c(_+".project."+x[m]);b&&(c(_+".color"),c(_+".width"),c(_+".usecolormap")),v&&(c(_+".highlightcolor"),c(_+".highlightwidth")),c(_+".start"),c(_+".end"),c(_+".size")}f||(a(e,"zmin","cmin"),a(e,"zmax","cmax"),a(e,"zauto","cauto")),n(e,t,d,c,{prefix:"",cLetter:"c"}),t._length=null}},{"../../components/colorscale/defaults":603,"../../lib":719,"../../registry":847,"./attributes":1225}],1229:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),moduleType:"trace",name:"surface",basePlotModule:e("../../plots/gl3d"),categories:["gl3d","2dMap","noOpacity"],meta:{}}},{"../../plots/gl3d":807,"./attributes":1225,"./calc":1226,"./convert":1227,"./defaults":1228}],1230:[function(e,t){"use strict";var a=e("../../components/annotations/attributes"),r=e("../../lib/extend").extendFlat,o=e("../../plot_api/edit_types").overrideAll,i=e("../../plots/font_attributes"),n=e("../../plots/domain").attributes,l=e("../../constants/docs").FORMAT_LINK,s=t.exports=o({domain:n({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:r({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:r({},i({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:r({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:r({},i({arrayOk:!0}))}},"calc","from-root");s.transforms=void 0},{"../../components/annotations/attributes":576,"../../constants/docs":690,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/domain":792,"../../plots/font_attributes":793}],1231:[function(e,t,a){"use strict";var r=e("../../plots/get_data").getModuleCalcData,o=e("./plot"),i="table";a.name=i,a.plot=function(e){var t=r(e.calcdata,i)[0];t.length&&o(e,t)},a.clean=function(e,t,a,r){var o=r._has&&r._has(i),n=t._has&&t._has(i);o&&!n&&r._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":802,"./plot":1238}],1232:[function(e,t){"use strict";var a=e("../../lib/gup").wrap;t.exports=function(){return a({})}},{"../../lib/gup":717}],1233:[function(e,t){"use strict";t.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1234:[function(e,t){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,r=0;r<e.length;r++)t=va(t,a(e[r]));return t}return e}function r(e,t){return e+t}function o(e){var t=e.slice(),a=1/0,r=0,o;for(o=0;o<t.length;o++)Array.isArray(t[o])||(t[o]=[t[o]]),a=ea(a,t[o].length),r=va(r,t[o].length);if(a!==r)for(o=0;o<t.length;o++){var l=r-t[o].length;l&&(t[o]=t[o].concat(n(l)))}return t}function n(e){for(var t=Array(e),a=0;a<e;a++)t[a]="";return t}function l(e){return e.calcdata.columns.reduce(function(t,a){return a.xIndex<e.xIndex?t+a.columnWidth:t},0)}function s(e,t){var a=Object.keys(e);return a.map(function(a){return i({},e[a],{auxiliaryBlocks:t})})}function d(e,t){for(var a={},r=0,o=0,n=p(),l=0,s=0,d=0,c;d<e.length;d++)c=e[d],n.rows.push({rowIndex:d,rowHeight:c}),o+=c,(o>=t||d==e.length-1)&&(a[r]=n,n.key=s++,n.firstRowIndex=l,n.lastRowIndex=d,n=p(),r+=o,l=d+1,o=0);return a}function p(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}var u=e("./constants"),i=e("../../lib/extend").extendFlat,c=e("fast-isnumeric");t.exports=function(e,t){var p=o(t.cells.values),g=function(e){return e.slice(t.header.values.length,e.length)},h=o(t.header.values);h.length&&!h[0].length&&(h[0]=[""],h=o(h));var m=h.concat(g(p).map(function(){return n((h[0]||[""]).length)})),y=t.domain,f=ba(e._fullLayout._size.w*(y.x[1]-y.x[0])),x=ba(e._fullLayout._size.h*(y.y[1]-y.y[0])),_=t.header.values.length?m[0].map(function(){return t.header.height}):[u.emptyHeaderHeight],b=p.length?p[0].map(function(){return t.cells.height}):[],v=_.reduce(r,0),k=x-v+u.uplift,w=d(b,k),T=d(_,v),A=s(T,[]),S=s(w,A),C={},L=t._fullInput.columnorder.concat(g(p.map(function(e,t){return t}))),E=m.map(function(e,a){var r=Array.isArray(t.columnwidth)?t.columnwidth[ea(a,t.columnwidth.length-1)]:t.columnwidth;return c(r)?+r:1}),I=E.reduce(r,0);E=E.map(function(e){return e/I*f});var z=va(a(t.header.line.width),a(t.cells.line.width)),P={key:t.uid+e._context.staticPlot,translateX:y.x[0]*e._fullLayout._size.w,translateY:e._fullLayout._size.h*(1-y.y[1]),size:e._fullLayout._size,width:f,maxLineWidth:z,height:x,columnOrder:L,groupHeight:x,rowBlocks:S,headerRowBlocks:A,scrollY:0,cells:i({},t.cells,{values:p}),headerCells:i({},t.header,{values:m}),gdColumns:m.map(function(e){return e[0]}),gdColumnsOriginalOrder:m.map(function(e){return e[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:m.map(function(e,t){var a=C[e];C[e]=(a||0)+1;var r=e+"__"+C[e];return{key:r,label:e,specIndex:t,xIndex:L[t],xScale:l,x:void 0,calcdata:void 0,columnWidth:E[t]}})};return P.columns.forEach(function(e){e.calcdata=P,e.x=l(e)}),P}},{"../../lib/extend":710,"./constants":1233,"fast-isnumeric":225}],1235:[function(e,t,a){"use strict";function r(e){var t=e.rowBlocks[e.page],a=t?t.rows[0].rowIndex:0,r=t?a+t.rows.length:0;return[a,r]}var o=e("../../lib/extend").extendFlat;a.splitToPanels=function(e){var t=[0,0],a=o({},e,{key:"header",type:"header",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:!0,values:e.calcdata.headerCells.values[e.specIndex],rowBlocks:e.calcdata.headerRowBlocks,calcdata:o({},e.calcdata,{cells:e.calcdata.headerCells})}),r=o({},e,{key:"cells1",type:"cells",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:!1,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks}),i=o({},e,{key:"cells2",type:"cells",page:1,prevPages:t,currentRepaint:[null,null],dragHandle:!1,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks});return[r,i,a]},a.splitToCells=function(e){var t=r(e);return(e.values||[]).slice(t[0],t[1]).map(function(a,r){var o="string"==typeof a&&a.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:r+o,key:t[0]+r,column:e,calcdata:e.calcdata,page:e.page,rowBlocks:e.rowBlocks,value:a}})}},{"../../lib/extend":710}],1236:[function(e,t){"use strict";function a(e,t){for(var a=e.columnorder||[],r=e.header.values.length,o=a.slice(0,r),n=o.slice().sort(function(e,t){return e-t}),l=o.map(function(e){return n.indexOf(e)}),s=l.length;s<r;s++)l.push(s);t("columnorder",l)}var r=e("../../lib"),o=e("./attributes"),i=e("../../plots/domain").defaults;t.exports=function(e,t,n,l){function s(a,i){return r.coerce(e,t,o,a,i)}i(t,l,s),s("columnwidth"),s("header.values"),s("header.format"),s("header.align"),s("header.prefix"),s("header.suffix"),s("header.height"),s("header.line.width"),s("header.line.color"),s("header.fill.color"),r.coerceFont(s,"header.font",r.extendFlat({},l.font)),a(t,s),s("cells.values"),s("cells.format"),s("cells.align"),s("cells.prefix"),s("cells.suffix"),s("cells.height"),s("cells.line.width"),s("cells.line.color"),s("cells.fill.color"),r.coerceFont(s,"cells.font",r.extendFlat({},l.font)),t._length=null}},{"../../lib":719,"../../plots/domain":792,"./attributes":1230}],1237:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("./plot"),moduleType:"trace",name:"table",basePlotModule:e("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1230,"./base_plot":1231,"./calc":1232,"./defaults":1236,"./plot":1238}],1238:[function(e,t){"use strict";function a(e){return M(e.calcdata.maxLineWidth/2)}function r(e,t){return"clip"+e._fullLayout._uid+"_scrollAreaBottomClip_"+t.key}function o(e,t){return"clip"+e._fullLayout._uid+"_columnBoundaryClippath_"+t.calcdata.key+"_"+t.specIndex}function i(e){return[].concat.apply([],e.map(function(e){return e})).map(function(e){return e.__data__})}function n(e,t,a){function r(e){var t=e.rowBlocks;return O(t,t.length-1)+(t.length?R(t[t.length-1],1/0):1)}var o=e.selectAll("."+N.cn.scrollbarKit).data(V.repeat,V.keyFun);o.enter().append("g").classed(N.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),o.each(function(e){var t=e.scrollbarState;t.totalHeight=r(e),t.scrollableAreaHeight=e.groupHeight-A(e),t.currentlyVisibleHeight=ea(t.totalHeight,t.scrollableAreaHeight),t.ratio=t.currentlyVisibleHeight/t.totalHeight,t.barLength=va(t.ratio*t.currentlyVisibleHeight,N.goldenRatio*N.scrollbarWidth),t.barWiggleRoom=t.currentlyVisibleHeight-t.barLength,t.wiggleRoom=va(0,t.totalHeight-t.scrollableAreaHeight),t.topY=0===t.barWiggleRoom?0:e.scrollY/t.wiggleRoom*t.barWiggleRoom,t.bottomY=t.topY+t.barLength,t.dragMultiplier=t.wiggleRoom/t.barWiggleRoom}).attr("transform",function(e){var t=e.width+N.scrollbarWidth/2+N.scrollbarOffset;return"translate("+t+" "+A(e)+")"});var i=o.selectAll("."+N.cn.scrollbar).data(V.repeat,V.keyFun);i.enter().append("g").classed(N.cn.scrollbar,!0);var n=i.selectAll("."+N.cn.scrollbarSlider).data(V.repeat,V.keyFun);n.enter().append("g").classed(N.cn.scrollbarSlider,!0),n.attr("transform",function(e){return"translate(0 "+(e.scrollbarState.topY||0)+")"});var l=n.selectAll("."+N.cn.scrollbarGlyph).data(V.repeat,V.keyFun);l.enter().append("line").classed(N.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",N.scrollbarWidth).attr("stroke-linecap","round").attr("y1",N.scrollbarWidth/2),l.attr("y2",function(e){return e.scrollbarState.barLength-N.scrollbarWidth/2}).attr("stroke-opacity",function(e){return e.columnDragInProgress||!e.scrollbarState.barWiggleRoom||a?0:.4}),l.transition().delay(0).duration(0),l.transition().delay(N.scrollbarHideDelay).duration(N.scrollbarHideDuration).attr("stroke-opacity",0);var s=i.selectAll("."+N.cn.scrollbarCaptureZone).data(V.repeat,V.keyFun);s.enter().append("line").classed(N.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",N.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(a){var r=c.event.y,o=this.getBoundingClientRect(),i=a.scrollbarState,n=r-o.top,l=c.scale.linear().domain([0,i.scrollableAreaHeight]).range([0,i.totalHeight]).clamp(!0);i.topY<=n&&n<=i.bottomY||L(t,e,null,l(n-i.barLength/2))(a)}).call(c.behavior.drag().origin(function(e){return c.event.stopPropagation(),e.scrollbarState.scrollbarScrollInProgress=!0,e}).on("drag",L(t,e)).on("dragend",function(){})),s.attr("y2",function(e){return e.scrollbarState.scrollableAreaHeight}),t._context.staticPlot&&(l.remove(),s.remove())}function l(e,t,a,r){var o=s(a),i=d(o);h(i);var n=p(i);y(n);var l=g(i),c=u(l);m(c),f(c,t,r,e),D(i)}function s(e){var t=e.selectAll("."+N.cn.columnCells).data(V.repeat,V.keyFun);return t.enter().append("g").classed(N.cn.columnCells,!0),t.exit().remove(),t}function d(e){var t=e.selectAll("."+N.cn.columnCell).data(W.splitToCells,function(e){return e.keyWithinBlock});return t.enter().append("g").classed(N.cn.columnCell,!0),t.exit().remove(),t}function p(e){var t=e.selectAll("."+N.cn.cellRect).data(V.repeat,function(e){return e.keyWithinBlock});return t.enter().append("rect").classed(N.cn.cellRect,!0),t}function u(e){var t=e.selectAll("."+N.cn.cellText).data(V.repeat,function(e){return e.keyWithinBlock});return t.enter().append("text").classed(N.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){c.event.stopPropagation()}),t}function g(e){var t=e.selectAll("."+N.cn.cellTextHolder).data(V.repeat,function(e){return e.keyWithinBlock});return t.enter().append("g").classed(N.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),t}function h(e){e.each(function(e,t){var a=e.calcdata.cells.font,r=e.column.specIndex,o={size:v(a.size,r,t),color:v(a.color,r,t),family:v(a.family,r,t)};e.rowNumber=e.key,e.align=v(e.calcdata.cells.align,r,t),e.cellBorderWidth=v(e.calcdata.cells.line.width,r,t),e.font=o})}function m(e){e.each(function(e){U.font(c.select(this),e.font)})}function y(e){e.attr("width",function(e){return e.column.columnWidth}).attr("stroke-width",function(e){return e.cellBorderWidth}).each(function(e){var t=c.select(this);X.stroke(t,v(e.calcdata.cells.line.color,e.column.specIndex,e.rowNumber)),X.fill(t,v(e.calcdata.cells.fill.color,e.column.specIndex,e.rowNumber))})}function f(e,t,a,r){e.text(function(e){var t=e.column.specIndex,a=e.rowNumber,r=e.value,o="string"==typeof r,i=o&&r.match(/<br>/i);e.mayHaveMarkup=o&&r.match(/[<&>]/);var n=x(r);e.latex=n;var l=n?"":v(e.calcdata.cells.prefix,t,a)||"",s=n?"":v(e.calcdata.cells.suffix,t,a)||"",d=n?null:v(e.calcdata.cells.format,t,a)||null,p=l+(d?c.format(d)(e.value):e.value)+s,u;e.wrappingNeeded=!e.wrapped&&!(!o||i)&&!n&&(u=_(p)),e.cellHeightMayIncrease=i||n||e.mayHaveMarkup||(void 0===u?_(p):u),e.needsConvertToTspans=e.mayHaveMarkup||e.wrappingNeeded||e.latex;var g;if(e.wrappingNeeded){var h=" "===N.wrapSplitCharacter?p.replace(/<a href=/ig,"<a_href="):p,m=h.split(N.wrapSplitCharacter),y=" "===N.wrapSplitCharacter?m.map(function(e){return e.replace(/<a_href=/ig,"<a href=")}):m;e.fragments=y.map(function(e){return{text:e,width:null}}),e.fragments.push({fragment:N.wrapSpacer,width:null}),g=y.join(N.lineBreaker)+N.lineBreaker+N.wrapSpacer}else delete e.fragments,g=p;return g}).attr("dy",function(e){return e.needsConvertToTspans?0:"0.75em"}).each(function(e){var o=this,i=c.select(o),n=e.wrappingNeeded?I:z;e.needsConvertToTspans?H.convertToTspans(i,r,n(a,o,t,r,e)):c.select(o.parentNode).attr("transform",function(e){return"translate("+P(e)+" "+N.cellPad+")"}).attr("text-anchor",function(e){return{left:"start",center:"middle",right:"end"}[e.align]})})}function x(e){return"string"==typeof e&&e.match(N.latexCheck)}function _(e){return-1!==e.indexOf(N.wrapSplitCharacter)}function b(e,t,r){var i=t.gdColumnsOriginalOrder;t.gdColumns.sort(function(e,t){return r[i.indexOf(e)]-r[i.indexOf(t)]}),t.columnorder=r,e.emit("plotly_restyle")}function v(e,t,a){if(Array.isArray(e)){var r=e[ea(t,e.length-1)];return Array.isArray(r)?r[ea(a,r.length-1)]:r}return e}function k(e,t,a){e.transition().ease(N.releaseTransitionEase).duration(N.releaseTransitionDuration).attr("transform","translate("+t.x+" "+a+")")}function w(e){return"cells"===e.type}function T(e){return"header"===e.type}function A(e){var t=e.rowBlocks.length?e.rowBlocks[0].auxiliaryBlocks:[];return t.reduce(function(e,t){return e+R(t,1/0)},0)}function S(e,t,a){for(var r=[],o=0,n=0;n<e.length;n++){for(var l=e[n],s=l.rows,d=0,c=0;c<s.length;c++)d+=s[c].rowHeight;l.allRowsHeight=d;var p=o+d,u=t;u<p&&u+a>o&&r.push(n),o+=d}return r}function C(e,t,a){var r=i(t)[0];if(void 0!==r){var o=r.rowBlocks,l=r.calcdata,s=O(o,o.length),d=r.calcdata.groupHeight-A(r),c=l.scrollY=va(0,ea(s-d,l.scrollY)),p=S(o,c,d);1===p.length&&(p[0]===o.length-1?p.unshift(p[0]-1):p.push(p[0]+1)),p[0]%2&&p.reverse(),t.each(function(e,t){e.page=p[t],e.scrollY=c}),t.attr("transform",function(e){var t=O(e.rowBlocks,e.page)-e.scrollY;return"translate(0 "+t+")"}),e&&(E(e,a,t,p,r.prevPages,r,0),E(e,a,t,p,r.prevPages,r,1),n(a,e))}}function L(e,t,a,r){return function(o){var i=o.calcdata?o.calcdata:o,n=t.filter(function(e){return i.key===e.key}),l=a||i.scrollbarState.dragMultiplier,s=i.scrollY;i.scrollY=void 0===r?i.scrollY+l*c.event.dy:r;var d=n.selectAll("."+N.cn.yColumn).selectAll("."+N.cn.columnBlock).filter(w);return C(e,d,n),i.scrollY===s}}function E(e,t,a,r,o,i,n){var s=r[n]!==o[n];s&&(clearTimeout(i.currentRepaint[n]),i.currentRepaint[n]=setTimeout(function(){var i=a.filter(function(e,t){return t===n&&r[t]!==o[t]});l(e,t,i,a),o[n]=r[n]}))}function I(e,t,a,r){return function(){var o=c.select(t.parentNode);o.each(function(e){var t=e.fragments;o.selectAll("tspan.line").each(function(e,a){t[a].width=this.getComputedTextLength()});var a=t[t.length-1].width,r=t.slice(0,-1),i=[],n=0,l=e.column.columnWidth-2*N.cellPad,s,d;for(e.value="";r.length;)s=r.shift(),d=s.width+a,n+d>l&&(e.value+=i.join(N.wrapSpacer)+N.lineBreaker,i=[],n=0),i.push(s.text),n+=d;n&&(e.value+=i.join(N.wrapSpacer)),e.wrapped=!0}),o.selectAll("tspan.line").remove(),f(o.select("."+N.cn.cellText),a,e,r),c.select(t.parentNode.parentNode).call(D)}}function z(e,t,a,r,o){return function(){if(!o.settledY){var i=c.select(t.parentNode),s=F(o),l=o.key-s.firstRowIndex,d=s.rows[l].rowHeight,p=o.cellHeightMayIncrease?t.parentNode.getBoundingClientRect().height+2*N.cellPad:d,u=va(p,d),g=u-s.rows[l].rowHeight;g&&(s.rows[l].rowHeight=u,e.selectAll("."+N.cn.columnCell).call(D),C(null,e.filter(w),0),n(a,r,!0)),i.attr("transform",function(){var e=this,t=e.parentNode,a=t.getBoundingClientRect(),r=c.select(e.parentNode).select("."+N.cn.cellRect).node().getBoundingClientRect(),i=e.transform.baseVal.consolidate(),n=r.top-a.top+(i?i.matrix.f:N.cellPad);return"translate("+P(o,c.select(e.parentNode).select("."+N.cn.cellTextHolder).node().getBoundingClientRect().width)+" "+n+")"}),o.settledY=!0}}}function P(e,t){switch(e.align){case"left":return N.cellPad;case"right":return e.column.columnWidth-(t||0)-N.cellPad;case"center":return(e.column.columnWidth-(t||0))/2;default:return N.cellPad;}}function D(e){e.attr("transform",function(e){var t=e.rowBlocks[0].auxiliaryBlocks.reduce(function(e,t){return e+R(t,1/0)},0),a=F(e),r=R(a,e.key);return"translate(0 "+(r+t)+")"}).selectAll("."+N.cn.cellRect).attr("height",function(e){return B(F(e),e.key).rowHeight})}function O(e,t){for(var a=0,r=t-1;0<=r;r--)a+=j(e[r]);return a}function R(e,t){for(var a=0,r=0;r<e.rows.length&&e.rows[r].rowIndex<t;r++)a+=e.rows[r].rowHeight;return a}function j(e){var t=e.allRowsHeight;if(void 0!==t)return t;for(var a=0,r=0;r<e.rows.length;r++)a+=e.rows[r].rowHeight;return e.allRowsHeight=a,a}function F(e){return e.rowBlocks[e.page]}function B(e,t){return e.rows[t-e.firstRowIndex]}var N=e("./constants"),c=e("d3"),V=e("../../lib/gup"),U=e("../../components/drawing"),H=e("../../lib/svg_text_utils"),G=e("../../lib").raiseToTop,q=e("../../lib").cancelTransition,Y=e("./data_preparation_helper"),W=e("./data_split_helpers"),X=e("../../components/color");t.exports=function(e,t){var s=!e._context.staticPlot,d=e._fullLayout._paper.selectAll("."+N.cn.table).data(t.map(function(t){var a=V.unwrap(t),r=a.trace;return Y(e,r)}),V.keyFun);d.exit().remove(),d.enter().append("g").classed(N.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),d.attr("width",function(e){return e.width+e.size.l+e.size.r}).attr("height",function(e){return e.height+e.size.t+e.size.b}).attr("transform",function(e){return"translate("+e.translateX+","+e.translateY+")"});var p=d.selectAll("."+N.cn.tableControlView).data(V.repeat,V.keyFun),u=p.enter().append("g").classed(N.cn.tableControlView,!0).style("box-sizing","content-box");s&&u.on("mousemove",function(t){p.filter(function(e){return t===e}).call(n,e)}).on("mousewheel",function(t){if(!t.scrollbarState.wheeling){t.scrollbarState.wheeling=!0;var a=t.scrollY+c.event.deltaY,r=L(e,p,null,a)(t);r||(c.event.stopPropagation(),c.event.preventDefault()),t.scrollbarState.wheeling=!1}}).call(n,e,!0),p.attr("transform",function(e){return"translate("+e.size.l+" "+e.size.t+")"});var g=p.selectAll("."+N.cn.scrollBackground).data(V.repeat,V.keyFun);g.enter().append("rect").classed(N.cn.scrollBackground,!0).attr("fill","none"),g.attr("width",function(e){return e.width}).attr("height",function(e){return e.height}),p.each(function(t){U.setClipUrl(c.select(this),r(e,t),e)});var h=p.selectAll("."+N.cn.yColumn).data(function(e){return e.columns},V.keyFun);h.enter().append("g").classed(N.cn.yColumn,!0),h.exit().remove(),h.attr("transform",function(e){return"translate("+e.x+" 0)"}),s&&h.call(c.behavior.drag().origin(function(t){var a=c.select(this);return k(a,t,-N.uplift),G(this),t.calcdata.columnDragInProgress=!0,n(p.filter(function(e){return t.calcdata.key===e.key}),e),t}).on("drag",function(e){var t=c.select(this),r=function(t){return(e===t?c.event.x:t.x)+t.columnWidth/2};e.x=va(-N.overdrag,ea(e.calcdata.width+N.overdrag-e.columnWidth,c.event.x));var o=i(h).filter(function(t){return t.calcdata.key===e.calcdata.key}),n=o.sort(function(e,t){return r(e)-r(t)});n.forEach(function(t,a){t.xIndex=a,t.x=e===t?t.x:t.xScale(t)}),h.filter(function(t){return e!==t}).transition().ease(N.transitionEase).duration(N.transitionDuration).attr("transform",function(e){return"translate("+e.x+" 0)"}),t.call(q).attr("transform","translate("+e.x+" -"+N.uplift+" )")}).on("dragend",function(t){var a=c.select(this),r=t.calcdata;t.x=t.xScale(t),t.calcdata.columnDragInProgress=!1,k(a,t,0),b(e,r,r.columns.map(function(e){return e.xIndex}))})),h.each(function(t){U.setClipUrl(c.select(this),o(e,t),e)});var m=h.selectAll("."+N.cn.columnBlock).data(W.splitToPanels,V.keyFun);m.enter().append("g").classed(N.cn.columnBlock,!0).attr("id",function(e){return e.key}),m.style("cursor",function(e){return e.dragHandle?"ew-resize":e.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var y=m.filter(T),f=m.filter(w);s&&f.call(c.behavior.drag().origin(function(e){return c.event.stopPropagation(),e}).on("drag",L(e,p,-1)).on("dragend",function(){})),l(e,p,y,m),l(e,p,f,m);var x=p.selectAll("."+N.cn.scrollAreaClip).data(V.repeat,V.keyFun);x.enter().append("clipPath").classed(N.cn.scrollAreaClip,!0).attr("id",function(t){return r(e,t)});var _=x.selectAll("."+N.cn.scrollAreaClipRect).data(V.repeat,V.keyFun);_.enter().append("rect").classed(N.cn.scrollAreaClipRect,!0).attr("x",-N.overdrag).attr("y",-N.uplift).attr("fill","none"),_.attr("width",function(e){return e.width+2*N.overdrag}).attr("height",function(e){return e.height+N.uplift});var v=h.selectAll("."+N.cn.columnBoundary).data(V.repeat,V.keyFun);v.enter().append("g").classed(N.cn.columnBoundary,!0);var A=h.selectAll("."+N.cn.columnBoundaryClippath).data(V.repeat,V.keyFun);A.enter().append("clipPath").classed(N.cn.columnBoundaryClippath,!0),A.attr("id",function(t){return o(e,t)});var S=A.selectAll("."+N.cn.columnBoundaryRect).data(V.repeat,V.keyFun);S.enter().append("rect").classed(N.cn.columnBoundaryRect,!0).attr("fill","none"),S.attr("width",function(e){return e.columnWidth+2*a(e)}).attr("height",function(e){return e.calcdata.height+2*a(e)+N.uplift}).attr("x",function(e){return-a(e)}).attr("y",function(e){return-a(e)}),C(null,f,p)}},{"../../components/color":593,"../../components/drawing":614,"../../lib":719,"../../lib/gup":717,"../../lib/svg_text_utils":743,"./constants":1233,"./data_preparation_helper":1234,"./data_split_helpers":1235,d3:163}],1239:[function(e,t){"use strict";var a=e("../box/attributes"),r=e("../../lib/extend").extendFlat;t.exports={y:a.y,x:a.x,x0:a.x0,y0:a.y0,name:r({},a.name,{}),orientation:r({},a.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,points:r({},a.boxpoints,{}),jitter:r({},a.jitter,{}),pointpos:r({},a.pointpos,{}),width:r({},a.width,{}),marker:a.marker,text:a.text,hovertext:a.hovertext,hovertemplate:a.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":710,"../box/attributes":880}],1240:[function(e,t){"use strict";function a(e,t,r){var o=ea(t,r/1.349);return 1.059*o*ya(e,-.2)}function r(e,t,r){var o=t.max-t.min;if(!o)return e.bandwidth?e.bandwidth:0;if(e.bandwidth)return va(e.bandwidth,o/1e4);var i=r.length,n=l.stdev(r,i-1,t.mean);return va(a(i,n,t.q3-t.q1),o/100)}function o(e,t,a,r){function o(r){var o=n[r],i="multicategory"===a.type?a.r2c(o):a.d2c(o,0,e[t.valLetter+"calendar"]);return i===p?d[r]:i}var i=e.spanmode,n=e.span||[],l=[t.min,t.max],d=[t.min-2*r,t.max+2*r],c;c="soft"===i?d:"hard"===i?l:[o(0),o(1)];var u={type:"linear",range:c};return s.setConvert(u),u.cleanRange(),c}var l=e("../../lib"),s=e("../../plots/cartesian/axes"),d=e("../box/calc"),c=e("./helpers"),p=e("../../constants/numerical").BADNUM;t.exports=function(e,a){var p=d(e,a);if(p[0].t.empty)return p;for(var u=e._fullLayout,g=s.getFromId(e,a["h"===a.orientation?"xaxis":"yaxis"]),h=1/0,m=-Infinity,y=0,f=0,x=0;x<p.length;x++){var _=p[x],b=_.pts.map(c.extractVal),w=_.bandwidth=r(a,_,b),T=_.span=o(a,_,g,w);if(_.min===_.max&&0===w)T=_.span=[_.min,_.max],_.density=[{v:1,t:T[0]}],_.bandwidth=w,y=va(y,1);else{var A=T[1]-T[0],S=M(A/(w/3)),n=A/S;if(!isFinite(n)||!isFinite(S))return l.error("Something went wrong with computing the violin span"),p[0].t.empty=!0,p;var C=c.makeKDE(_,a,b);_.density=Array(S);for(var L=0,E=T[0],I;E<T[1]+n/2;L++,E+=n)I=C(E),_.density[L]={v:I,t:E},y=va(y,I)}f=va(f,b.length),h=ea(h,T[0]),m=va(m,T[1])}var z=s.findExtremes(g,[h,m],{padded:!0});if(a._extremes[g._id]=z,a.width)p[0].t.maxKDE=y;else{var P=u._violinScaleGroupStats,D=a.scalegroup,O=P[D];O?(O.maxKDE=va(O.maxKDE,y),O.maxCount=va(O.maxCount,f)):P[D]={maxKDE:y,maxCount:f}}return p[0].t.labels.kde=l._(e,"kde:"),p}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../box/calc":881,"./helpers":1243}],1241:[function(e,t){"use strict";var a=e("../box/cross_trace_calc").setPositionOffset,r=["v","h"];t.exports=function(e,o){for(var n=e.calcdata,l=o.xaxis,s=o.yaxis,d=0;d<r.length;d++){for(var c=r[d],p="h"===c?s:l,u=[],g=0;g<n.length;g++){var h=n[g],m=h[0].t,t=h[0].trace;!0!==t.visible||"violin"!==t.type||m.empty||t.orientation!==c||t.xaxis!==l._id||t.yaxis!==s._id||u.push(g)}a("violin",e,u,p)}}},{"../box/cross_trace_calc":882}],1242:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../components/color"),o=e("../box/defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(r,o){return a.coerce(e,t,i,r,o)}function d(r,o){return a.coerce2(e,t,i,r,o)}if(o.handleSampleDefaults(e,t,s,l),!1!==t.visible){s("bandwidth"),s("side");var c=s("width");c||(s("scalegroup",t.name),s("scalemode"));var p=s("span"),u;Array.isArray(p)&&(u="manual"),s("spanmode",u);var g=s("line.color",(e.marker||{}).color||n),h=s("line.width"),m=s("fillcolor",r.addOpacity(t.line.color,.5));o.handlePointsDefaults(e,t,s,{prefix:""});var y=d("box.width"),f=d("box.fillcolor",m),x=d("box.line.color",g),_=d("box.line.width",h),b=s("box.visible",!!(y||f||x||_));b||(t.box={visible:!1});var v=d("meanline.color",g),k=d("meanline.width",h),w=s("meanline.visible",!!(v||k));w||(t.meanline={visible:!1})}}},{"../../components/color":593,"../../lib":719,"../box/defaults":883,"./attributes":1239}],1243:[function(e,t,a){"use strict";var r=e("../../lib"),o={gaussian:function(e){return 1/N(2*Pe)*m(-.5*e*e)}};a.makeKDE=function(e,t,a){var r=a.length,n=o.gaussian,l=e.bandwidth;return function(e){for(var t=0,o=0;o<r;o++)t+=n((e-a[o])/l);return 1/(r*l)*t}},a.getPositionOnKdePath=function(e,t,a){var o,i;"h"===t.orientation?(o="y",i="x"):(o="x",i="y");var n=r.findPointOnPath(e.path,a,i,{pathLength:e.pathLength}),l=e.posCenterPx,s=n[o],d="both"===t.side?2*l-s:l;return[s,d]},a.getKdeValue=function(e,t,r){var o=e.pts.map(a.extractVal),i=a.makeKDE(e,t,o);return i(r)/e.posDensityScale},a.extractVal=function(e){return e.v}},{"../../lib":719}],1244:[function(e,t){"use strict";var a=e("../../lib"),r=e("../../plots/cartesian/axes"),o=e("../box/hover"),i=e("./helpers");t.exports=function(e,t,n,l,s){var d=e.cd,c=d[0].trace,p=c.hoveron,u=-1!==p.indexOf("violins"),g=-1!==p.indexOf("kde"),h=[],m,y;if(u||g){var f=o.hoverOnBoxes(e,t,n,l);if(g&&0<f.length){var x=e.xa,_=e.ya,b,v,k,w,T;"h"===c.orientation?(T=t,b="y",k=_,v="x",w=x):(T=n,b="x",k=x,v="y",w=_);var A=d[e.index];if(T>=A.span[0]&&T<=A.span[1]){var S=a.extendFlat({},e),C=w.c2p(T,!0),L=i.getKdeValue(A,c,T),E=i.getPositionOnKdePath(A,c,C),I=k._offset,z=k._length;S[b+"0"]=E[0],S[b+"1"]=E[1],S[v+"0"]=S[v+"1"]=C,S[v+"Label"]=v+": "+r.hoverLabelText(w,T)+", "+d[0].t.labels.kde+" "+L.toFixed(3),S.spikeDistance=f[0].spikeDistance;var P=b+"Spike";S[P]=f[0][P],f[0].spikeDistance=void 0,f[0][P]=void 0,S.hovertemplate=!1,h.push(S),y={stroke:e.color},y[b+"1"]=a.constrain(I+E[0],I,I+z),y[b+"2"]=a.constrain(I+E[1],I,I+z),y[v+"1"]=y[v+"2"]=w._offset+C}}u&&(h=h.concat(f))}-1!==p.indexOf("points")&&(m=o.hoverOnPoints(e,t,n));var D=s.selectAll(".violinline-"+c.uid).data(y?[0]:[]);return D.enter().append("line").classed("violinline-"+c.uid,!0).attr("stroke-width",1.5),D.exit().remove(),D.attr(y),"closest"===l?m?[m]:h:m?(h.push(m),h):h}},{"../../lib":719,"../../plots/cartesian/axes":767,"../box/hover":885,"./helpers":1243}],1245:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../box/select"),moduleType:"trace",name:"violin",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../box/defaults":883,"../box/select":890,"../scatter/style":1134,"./attributes":1239,"./calc":1240,"./cross_trace_calc":1241,"./defaults":1242,"./hover":1244,"./layout_attributes":1246,"./layout_defaults":1247,"./plot":1248,"./style":1249}],1246:[function(e,t){"use strict";var a=e("../box/layout_attributes"),r=e("../../lib").extendFlat;t.exports={violinmode:r({},a.boxmode,{}),violingap:r({},a.boxgap,{}),violingroupgap:r({},a.boxgroupgap,{})}},{"../../lib":719,"../box/layout_attributes":887}],1247:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes"),o=e("../box/layout_defaults");t.exports=function(e,t,i){o._supply(e,t,i,function(o,i){return a.coerce(e,t,r,o,i)},"violin")}},{"../../lib":719,"../box/layout_defaults":888,"./layout_attributes":1246}],1248:[function(e,t){"use strict";var a=e("d3"),r=e("../../lib"),o=e("../../components/drawing"),i=e("../box/plot"),n=e("../scatter/line_points"),l=e("./helpers");t.exports=function(e,s,d,c){function p(e){var t=n(e,{xaxis:g,yaxis:h,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0});return o.smoothopen(t[0],1)}var u=e._fullLayout,g=s.xaxis,h=s.yaxis;r.makeTraceGroups(c,d,"trace violins").each(function(e){var o=a.select(this),n=e[0],c=n.t,t=n.trace;if(!0!==t.visible||c.empty)return void o.remove();var m=c.bPos,y=c.bdPos,f=s[c.valLetter+"axis"],x=s[c.posLetter+"axis"],_="both"===t.side,b=_||"positive"===t.side,v=_||"negative"===t.side,k=o.selectAll("path.violin").data(r.identity);k.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),k.exit().remove(),k.each(function(e){var r=a.select(this),o=e.density,n=o.length,l=e.pos+m,s=x.c2p(l),d;if(t.width)d=c.maxKDE/y;else{var g=u._violinScaleGroupStats[t.scalegroup];d="count"===t.scalemode?g.maxKDE/y*(g.maxCount/e.pts.length):g.maxKDE/y}var h,w,T,A,S,C,L;if(b){for(C=Array(n),A=0;A<n;A++)L=C[A]={},L[c.posLetter]=l+o[A].v/d,L[c.valLetter]=o[A].t;h=p(C)}if(v){for(C=Array(n),S=0,A=n-1;S<n;S++,A--)L=C[S]={},L[c.posLetter]=l-o[A].v/d,L[c.valLetter]=o[A].t;w=p(C)}if(_)T=h+"L"+w.substr(1)+"Z";else{var E=[s,f.c2p(o[0].t)],I=[s,f.c2p(o[n-1].t)];"h"===t.orientation&&(E.reverse(),I.reverse()),T=b?"M"+E+"L"+h.substr(1)+"L"+I:"M"+I+"L"+w.substr(1)+"L"+E}r.attr("d",T),e.posCenterPx=s,e.posDensityScale=d*y,e.path=r.node(),e.pathLength=e.path.getTotalLength()/(_?2:1)});var w=t.box,T=w.width,A=(w.line||{}).width,S,C;_?(S=y*T,C=0):b?(S=[0,y*T/2],C=-A):(S=[y*T/2,0],C=A),i.plotBoxAndWhiskers(o,{pos:x,val:f},t,{bPos:m,bdPos:S,bPosPxOffset:C}),i.plotBoxMean(o,{pos:x,val:f},t,{bPos:m,bdPos:S,bPosPxOffset:C});var L;!t.box.visible&&t.meanline.visible&&(L=r.identity);var d=o.selectAll("path.meanline").data(L||[]);d.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),d.exit().remove(),d.each(function(e){var r=f.c2p(e.mean,!0),o=l.getPositionOnKdePath(e,t,r);a.select(this).attr("d","h"===t.orientation?"M"+r+","+o[0]+"V"+o[1]:"M"+o[0]+","+r+"H"+o[1])}),i.plotPoints(o,{x:g,y:h},t,c)})}},{"../../components/drawing":614,"../../lib":719,"../box/plot":889,"../scatter/line_points":1125,"./helpers":1243,d3:163}],1249:[function(e,t){"use strict";var a=e("d3"),r=e("../../components/color"),o=e("../scatter/style").stylePoints;t.exports=function(e){var t=a.select(e).selectAll("g.trace.violins");t.style("opacity",function(e){return e[0].trace.opacity}),t.each(function(t){var i=t[0].trace,n=a.select(this),l=i.box||{},s=l.line||{},d=i.meanline||{},c=d.width;n.selectAll("path.violin").style("stroke-width",i.line.width+"px").call(r.stroke,i.line.color).call(r.fill,i.fillcolor),n.selectAll("path.box").style("stroke-width",s.width+"px").call(r.stroke,s.color).call(r.fill,l.fillcolor);var p={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};n.selectAll("path.mean").style(p).call(r.stroke,d.color),n.selectAll("path.meanline").style(p).call(r.stroke,d.color),o(n,i,e)})}},{"../../components/color":593,"../scatter/style":1134,d3:163}],1250:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),r=e("../isosurface/attributes"),o=e("../../plots/attributes"),i=e("../../lib/extend").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=t.exports=n(i({x:r.x,y:r.y,z:r.z,value:r.value,isomin:r.isomin,isomax:r.isomax,surface:r.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:r.slices,caps:r.caps,text:r.text,hovertext:r.hovertext,hovertemplate:r.hovertemplate},a("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:r.colorbar,opacity:r.opacity,opacityscale:{valType:"any",editType:"calc"},lightposition:r.lightposition,lighting:r.lighting,flatshading:r.flatshading,contour:r.contour,hoverinfo:i({},o.hoverinfo)}),"calc","nested");l.x.editType=l.y.editType=l.z.editType=l.value.editType="calc+clearAxisTypes",l.transforms=void 0},{"../../components/colorscale/attributes":600,"../../lib/extend":710,"../../plot_api/edit_types":750,"../../plots/attributes":764,"../isosurface/attributes":1048}],1251:[function(e,t){"use strict";function a(e,t,a){this.scene=e,this.uid=a,this.mesh=t,this.name="",this.data=null,this.showContour=!1}var r=e("gl-mesh3d"),o=e("../../lib/gl_format_color").parseColorScale,i=e("../../lib/str2rgbarray"),n=e("../../components/colorscale").extractOpts,l=e("../../plots/gl3d/zip3"),s=e("../isosurface/convert").findNearestOnAxis,d=e("../isosurface/convert").generateIsoMeshes,c=a.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.data.index,a=this.data._x[t],r=this.data._y[t],o=this.data._z[t],n=this.data._Ys.length,l=this.data._Zs.length,d=s(a,this.data._Xs).id,i=s(r,this.data._Ys).id,c=s(o,this.data._Zs).id,p=e.index=c+l*i+l*n*d;e.traceCoordinate=[this.data._x[p],this.data._y[p],this.data._z[p],this.data.value[p]];var u=this.data.hovertext||this.data.text;return Array.isArray(u)&&void 0!==u[p]?e.textLabel=u[p]:u&&(e.textLabel=u),!0}},c.update=function(e){function t(e,t,a,r){return t.map(function(t){return e.d2l(t,0,r)*a})}var a=this.scene,r=a.fullSceneLayout;this.data=d(e);var s=l(t(r.xaxis,e._x,a.dataScale[0],e.xcalendar),t(r.yaxis,e._y,a.dataScale[1],e.ycalendar),t(r.zaxis,e._z,a.dataScale[2],e.zcalendar)),c=l(e._i,e._j,e._k),p={positions:s,cells:c,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,opacityscale:e.opacityscale,contourEnable:e.contour.show,contourColor:i(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading},u=n(e);p.vertexIntensity=e._intensity,p.vertexIntensityBounds=[u.min,u.max],p.colormap=o(e),this.mesh.update(p)},c.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var o=e.glplot.gl,i=r({gl:o}),n=new a(e,i,t.uid);return i._trace=n,n.update(t),e.glplot.add(i),n}},{"../../components/colorscale":605,"../../lib/gl_format_color":716,"../../lib/str2rgbarray":742,"../../plots/gl3d/zip3":818,"../isosurface/convert":1050,"gl-mesh3d":280}],1252:[function(e,t){"use strict";function a(e,t){for(var a=[],r=32,o=0;o<r;o++){var n=o/(r-1),l=t+(1-t)*(1-ya(De(e*n*Pe),2));a.push([n,va(1,ea(0,l))])}return a}function r(e){var t=0;if(!Array.isArray(e)||2>e.length)return!1;if(!e[0]||!e[e.length-1])return!1;if(0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var a=0,r;a<e.length;a++){if(r=e[a],2!==r.length||+r[0]<t)return!1;t=+r[0]}return!0}var o=e("../../lib"),i=e("./attributes"),n=e("../isosurface/defaults").supplyIsoDefaults,l=.1;t.exports=function(e,t,s,d){function c(a,r){return o.coerce(e,t,i,a,r)}n(e,t,s,d,c);var p=c("opacityscale");"max"===p?t.opacityscale=[[0,l],[1,1]]:"min"===p?t.opacityscale=[[0,1],[1,l]]:"extremes"===p?t.opacityscale=a(1,l):!r(p)&&(t.opacityscale=void 0)}},{"../../lib":719,"../isosurface/defaults":1051,"./attributes":1250}],1253:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:e("./convert"),moduleType:"trace",name:"volume",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],meta:{}}},{"../../plots/gl3d":807,"../isosurface/calc":1049,"./attributes":1250,"./convert":1251,"./defaults":1252}],1254:[function(e,t){"use strict";function a(){return{marker:{color:s({},r.marker.color,{arrayOk:!1,editType:"style"}),line:{color:s({},r.marker.line.color,{arrayOk:!1,editType:"style"}),width:s({},r.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}var r=e("../bar/attributes"),o=e("../scatter/attributes").line,i=e("../../plots/attributes"),n=e("../../components/fx/hovertemplate_attributes"),l=e("./constants"),s=e("../../lib/extend").extendFlat,d=e("../../components/color");t.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:r.x,x0:r.x0,dx:r.dx,y:r.y,y0:r.y0,dy:r.dy,hovertext:r.hovertext,hovertemplate:n({},{keys:l.eventDataKeys}),hoverinfo:s({},i.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},text:r.text,textposition:r.textposition,insidetextanchor:r.insidetextanchor,textangle:r.textangle,textfont:r.textfont,insidetextfont:r.insidetextfont,outsidetextfont:r.outsidetextfont,constraintext:r.constraintext,cliponaxis:r.cliponaxis,orientation:r.orientation,offset:r.offset,width:r.width,increasing:a("increasing"),decreasing:a("decreasing"),totals:a("intermediate sums and total"),connector:{line:{color:s({},o.color,{dflt:d.defaultLine}),width:s({},o.width,{editType:"plot"}),dash:o.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:r.offsetgroup,alignmentgroup:r.alignmentgroup}},{"../../components/color":593,"../../components/fx/hovertemplate_attributes":631,"../../lib/extend":710,"../../plots/attributes":764,"../bar/attributes":857,"../scatter/attributes":1112,"./constants":1256}],1255:[function(e,t){"use strict";function a(e){return"a"===e||"absolute"===e}function r(e){return"t"===e||"total"===e}var o=e("../../plots/cartesian/axes"),n=e("../../lib").mergeArray,l=e("../scatter/calc_selection"),s=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var d=o.getFromId(e,t.xaxis||"x"),c=o.getFromId(e,t.yaxis||"y"),p,u;"h"===t.orientation?(p=d.makeCalcdata(t,"x"),u=c.makeCalcdata(t,"y")):(p=c.makeCalcdata(t,"y"),u=d.makeCalcdata(t,"x"));for(var g=ea(u.length,p.length),h=Array(g),m=0,y=!1,f=0,x;f<g;f++){var _=p[f]||0,b=!1;(p[f]!==s||r(t.measure[f])||a(t.measure[f]))&&f+1<g&&(p[f+1]!==s||r(t.measure[f+1])||a(t.measure[f+1]))&&(b=!0);var v=h[f]={i:f,p:u[f],s:_,rawS:_,cNext:b};a(t.measure[f])?(m=v.s,v.isSum=!0,v.dir="totals",v.s=m):r(t.measure[f])?(v.isSum=!0,v.dir="totals",v.s=m):(v.isSum=!1,v.dir=0>v.rawS?"decreasing":"increasing",x=v.s,v.s=m+x,m+=x),"totals"===v.dir&&(y=!0),t.ids&&(v.id=t.ids[f]+""),v.v=(t.base||0)+m}return h.length&&(h[0].hasTotals=y),n(t.text,h,"tx"),n(t.hovertext,h,"htx"),l(h,t),h}},{"../../constants/numerical":695,"../../lib":719,"../../plots/cartesian/axes":767,"../scatter/calc_selection":1114}],1256:[function(e,t){"use strict";t.exports={eventDataKeys:["initial","delta","final"]}},{}],1257:[function(e,t){"use strict";var a=e("../bar/cross_trace_calc").setGroupPositions;t.exports=function(e,t){var r=e._fullLayout,o=e._fullData,n=e.calcdata,l=t.xaxis,s=t.yaxis,d=[],c=[],p=[],u,g;for(g=0;g<o.length;g++){var h=o[g];!0===h.visible&&h.xaxis===l._id&&h.yaxis===s._id&&"waterfall"===h.type&&(u=n[g],"h"===h.orientation?p.push(u):c.push(u),d.push(u))}var m={mode:r.waterfallmode,norm:r.waterfallnorm,gap:r.waterfallgap,groupgap:r.waterfallgroupgap};for(a(e,l,s,c,m),a(e,s,l,p,m),g=0;g<d.length;g++){u=d[g];for(var y=0,f;y<u.length;y++)f=u[y],!1===f.isSum&&(f.s0+=0==y?0:u[y-1].s),y+1<u.length&&(u[y].nextP0=u[y+1].p0,u[y].nextS0=u[y+1].s0)}}},{"../bar/cross_trace_calc":860}],1258:[function(e,t){"use strict";function a(e,t,a){e(t+".marker.color",a),e(t+".marker.line.color",s.defaultLine),e(t+".marker.line.width")}var r=e("../../lib"),o=e("../bar/defaults").handleGroupingDefaults,i=e("../bar/defaults").handleText,n=e("../scatter/xy_defaults"),l=e("./attributes"),s=e("../../components/color"),d=e("../../constants/delta.js"),c=d.INCREASING.COLOR,p=d.DECREASING.COLOR;t.exports={supplyDefaults:function(e,t,o,s){function d(a,o){return r.coerce(e,t,l,a,o)}var u=n(e,t,s,d);if(!u)return void(t.visible=!1);d("measure"),d("orientation",t.x&&!t.y?"h":"v"),d("base"),d("offset"),d("width"),d("text"),d("hovertext"),d("hovertemplate");var g=d("textposition");i(e,t,s,d,g,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==t.textposition&&d("textinfo"),a(d,"increasing",c),a(d,"decreasing",p),a(d,"totals","#4499FF");var h=d("connector.visible");if(h){d("connector.mode");var m=d("connector.line.width");m&&(d("connector.line.color"),d("connector.line.dash"))}},crossTraceDefaults:function(e,t){function a(e){return r.coerce(s._input,s,l,e)}var n,s;if("group"===t.waterfallmode)for(var d=0;d<e.length;d++)s=e[d],n=s._input,o(n,s,t,a)}}},{"../../components/color":593,"../../constants/delta.js":689,"../../lib":719,"../bar/defaults":861,"../scatter/xy_defaults":1137,"./attributes":1254}],1259:[function(e,t){"use strict";t.exports=function(e,t){return e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,"initial"in t&&(e.initial=t.initial),"delta"in t&&(e.delta=t.delta),"final"in t&&(e.final=t.final),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},{}],1260:[function(e,t){"use strict";function a(e,t){var a=e[t.dir].marker,r=a.color,i=a.line.color,n=a.line.width;if(o(r))return r;return o(i)&&n?i:void 0}var r=e("../../plots/cartesian/axes").hoverLabelText,o=e("../../components/color").opacity,i=e("../bar/hover").hoverOnBars,n=e("../../constants/delta.js"),l={increasing:n.INCREASING.SYMBOL,decreasing:n.DECREASING.SYMBOL};t.exports=function(e,t,o,n){function s(e){return r(g,e)}var d=i(e,t,o,n);if(d){var c=d.cd,p=c[0].trace,u="h"===p.orientation,g=u?e.xa:e.ya,h=d.index,m=c[h],y=m.isSum?m.b+m.s:m.rawS;if(!m.isSum){d.initial=m.b+m.s-y,d.delta=y,d.final=d.initial+d.delta;var f=s(_a(d.delta));d.deltaLabel=0>y?"("+f+")":f,d.finalLabel=s(d.final),d.initialLabel=s(d.initial)}var x=m.hi||p.hoverinfo,_=[];if(x&&"none"!==x&&"skip"!==x){var b=x.split("+"),v=function(e){return"all"===x||-1!==b.indexOf(e)};m.isSum||(v("final")&&(u?!v("x"):!v("y"))&&_.push(d.finalLabel),v("delta")&&(0>y?_.push(d.deltaLabel+" "+l.decreasing):_.push(d.deltaLabel+" "+l.increasing)),v("initial")&&_.push("Initial: "+d.initialLabel))}return _.length&&(d.extraText=_.join("<br>")),d.color=a(p,m),[d]}}},{"../../components/color":593,"../../constants/delta.js":689,"../../plots/cartesian/axes":767,"../bar/hover":863}],1261:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults").supplyDefaults,crossTraceDefaults:e("./defaults").crossTraceDefaults,supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style").style,hoverPoints:e("./hover"),eventData:e("./event_data"),selectPoints:e("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:e("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":778,"../bar/select":868,"./attributes":1254,"./calc":1255,"./cross_trace_calc":1257,"./defaults":1258,"./event_data":1259,"./hover":1260,"./layout_attributes":1262,"./layout_defaults":1263,"./plot":1264,"./style":1265}],1262:[function(e,t){"use strict";t.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1263:[function(e,t){"use strict";var a=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t,o){function n(o,i){return a.coerce(e,t,r,o,i)}for(var l=!1,s=0,d;s<o.length;s++)if(d=o[s],d.visible&&"waterfall"===d.type){l=!0;break}l&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":719,"./layout_attributes":1262}],1264:[function(e,t){"use strict";function a(e,t,a,i){var s=t.xaxis,d=t.yaxis;n.makeTraceGroups(i,a,"trace bars").each(function(a){var i=o.select(this),c=a[0].trace,p=n.ensureSingle(i,"g","lines");if(!c.connector||!c.connector.visible)return void p.remove();var u="h"===c.orientation,g=c.connector.mode,h=p.selectAll("g.line").data(n.identity);h.enter().append("g").classed("line",!0),h.exit().remove();var m=h.size();h.each(function(a,c){if(c===m-1||a.cNext){var i=r(a,s,d,u),p=i[0],h=i[1],y="";"spanning"===g&&!a.isSum&&0<c&&(u?y+="M"+p[0]+","+h[1]+"V"+h[0]:y+="M"+p[1]+","+h[0]+"H"+p[0]),"between"!==g&&(a.isSum||c<m-1)&&(u?y+="M"+p[1]+","+h[0]+"V"+h[1]:y+="M"+p[0]+","+h[1]+"H"+p[1]),void 0!==p[2]&&void 0!==h[2]&&(u?y+="M"+p[1]+","+h[1]+"V"+h[2]:y+="M"+p[1]+","+h[1]+"H"+p[2]),""===y&&(y="M0,0Z"),n.ensureSingle(o.select(this),"path").attr("d",y).call(l.setClipUrl,t.layerClipId,e)}})})}function r(e,t,a,r){var o=[],i=[],n=r?t:a,l=r?a:t;return o[0]=n.c2p(e.s0,!0),i[0]=l.c2p(e.p0,!0),o[1]=n.c2p(e.s1,!0),i[1]=l.c2p(e.p1,!0),o[2]=n.c2p(e.nextS0,!0),i[2]=l.c2p(e.nextP0,!0),r?[o,i]:[i,o]}var o=e("d3"),n=e("../../lib"),l=e("../../components/drawing"),s=e("../bar/plot").plot;t.exports=function(e,t,r,o){var i=e._fullLayout;s(e,t,r,o,{mode:i.waterfallmode,norm:i.waterfallmode,gap:i.waterfallgap,groupgap:i.waterfallgroupgap}),a(e,t,r,o)}},{"../../components/drawing":614,"../../lib":719,"../bar/plot":867,d3:163}],1265:[function(e,t){"use strict";var a=e("d3"),r=e("../../components/drawing"),o=e("../../components/color"),i=e("../../constants/interactions").DESELECTDIM,n=e("../bar/style").styleTextPoints;t.exports={style:function(e,t,l){var d=l?l:a.select(e).selectAll("g.waterfalllayer").selectAll("g.trace");d.style("opacity",function(e){return e[0].trace.opacity}),d.each(function(t){var l=a.select(this),s=t[0].trace;l.selectAll(".point > path").each(function(e){if(!e.isBlank){var t=s[e.dir].marker;a.select(this).call(o.fill,t.color).call(o.stroke,t.line.color).call(r.dashLine,t.line.dash,t.line.width).style("opacity",s.selectedpoints&&!e.selected?i:1)}}),n(l,s,e),l.selectAll(".lines").each(function(){var e=s.connector.line;r.lineGroupStyle(a.select(this).selectAll("path"),e.width,e.color,e.dash)})})}}},{"../../components/color":593,"../../components/drawing":614,"../../constants/interactions":694,"../bar/style":870,d3:163}],1266:[function(e,t,a){"use strict";function r(e,t,a,r){if(r.enabled){for(var n=r.target,l=d.nestedProperty(t,n),c=l.get(),p=s.getDataConversions(e,t,n,c),u=o(r,p),g=Array(a.length),h=0;h<a.length;h++)g[h]=u(c,a[h]);l.set(g),"count"===r.func&&d.pushUnique(t._arrayAttrs,n)}}function o(e,t){var a=e.func,r=t.d2c,o=t.c2d;return"count"===a?i:"first"===a?n:"last"===a?l:"sum"===a?function(e,t){for(var a=0,n=0,l;n<t.length;n++)l=r(e[t[n]]),l!==u&&(a+=l);return o(a)}:"avg"===a?function(e,t){for(var a=0,n=0,l=0,s;l<t.length;l++)s=r(e[t[l]]),s!==u&&(a+=s,n++);return n?o(a/n):u}:"min"===a?function(e,t){for(var a=1/0,n=0,l;n<t.length;n++)l=r(e[t[n]]),l!==u&&(a=ea(a,l));return a===1/0?u:o(a)}:"max"===a?function(e,t){for(var a=-Infinity,n=0,l;n<t.length;n++)l=r(e[t[n]]),l!==u&&(a=va(a,l));return a===-Infinity?u:o(a)}:"range"===a?function(e,t){for(var a=1/0,n=-Infinity,l=0,s;l<t.length;l++)s=r(e[t[l]]),s!==u&&(a=ea(a,s),n=va(n,s));return n===-Infinity||a===1/0?u:o(n-a)}:"change"===a?function(e,t){var a=r(e[t[0]]),i=r(e[t[t.length-1]]);return a===u||i===u?u:o(i-a)}:"median"===a?function(e,t){for(var a=[],n=0,l;n<t.length;n++)l=r(e[t[n]]),l!==u&&a.push(l);if(!a.length)return u;a.sort();var s=(a.length-1)/2;return o((a[ba(s)]+a[M(s)])/2)}:"mode"===a?function(e,t){for(var a={},n=0,l=u,s=0,d;s<t.length;s++)if(d=r(e[t[s]]),d!==u){var c=a[d]=(a[d]||0)+1;c>n&&(n=c,l=d)}return n?o(l):u}:"rms"===a?function(e,t){for(var a=0,n=0,l=0,s;l<t.length;l++)s=r(e[t[l]]),s!==u&&(a+=s*s,n++);return n?o(N(a/n)):u}:"stddev"===a?function(t,a){var o=0,n=0,l=1,s=u,d;for(d=0;d<a.length&&s===u;d++)s=r(t[a[d]]);if(s===u)return u;for(;d<a.length;d++){var c=r(t[a[d]]);if(c!==u){var p=c-s;o+=p,n+=p*p,l++}}var g="sample"===e.funcmode?l-1:l;return g?N((n-o*o/l)/g):0}:void 0}function i(e,t){return t.length}function n(e,t){return e[t[0]]}function l(e,t){return e[t[t.length-1]]}var s=e("../plots/cartesian/axes"),d=e("../lib"),c=e("../plot_api/plot_schema"),p=e("./helpers").pointsAccessorFunction,u=e("../constants/numerical").BADNUM;a.moduleType="transform",a.name="aggregate";var g=a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},h=g.aggregations;a.supplyDefaults=function(e,t){function a(t,a){return d.coerce(e,o,g,t,a)}function r(e,t){return d.coerce(m[l],f,h,e,t)}var o={},n=a("enabled"),l;if(!n)return o;var s=c.findArrayAttributes(t),p={};for(l=0;l<s.length;l++)p[s[l]]=1;var u=a("groups");if(!Array.isArray(u)){if(!p[u])return o.enabled=!1,o;p[u]=0}var m=e.aggregations||[],y=o.aggregations=Array(m.length),f;for(l=0;l<m.length;l++){f={_index:l};var x=r("target"),_=r("func"),b=r("enabled");b&&x&&(p[x]||"count"===_&&p[x]===void 0)?("stddev"===_&&r("funcmode"),p[x]=0,y[l]=f):y[l]={enabled:!1,_index:l}}for(l=0;l<s.length;l++)p[s[l]]&&y.push({target:s[l],func:h.func.dflt,enabled:!0,_index:-1});return o},a.calcTransform=function(e,t,a){if(a.enabled){var o=a.groups,n=d.getTargetArray(t,{target:o});if(n){var l={},s={},c=[],u=p(t.transforms,a),g=n.length,h,m,y,f;for(t._length&&(g=ea(g,t._length)),h=0;h<g;h++)m=n[h],y=l[m],void 0===y?(l[m]=c.length,f=[h],c.push(f),s[l[m]]=u(h)):(c[y].push(h),s[l[m]]=(s[l[m]]||[]).concat(u(h)));a._indexToPoints=s;var x=a.aggregations;for(h=0;h<x.length;h++)r(e,t,c,x[h]);"string"==typeof o&&r(e,t,c,{target:o,func:"first",enabled:!0}),t._length=c.length}}}},{"../constants/numerical":695,"../lib":719,"../plot_api/plot_schema":756,"../plots/cartesian/axes":767,"./helpers":1269}],1267:[function(e,t,a){"use strict";function r(e,t,a){function r(e){return-1!==e.indexOf(o)}var o=e.operation,i=e.value,n=Array.isArray(i),l=function(a){return t(a,0,e.valuecalendar)},s=function(e){return t(e,0,a)},u;return r(d)?u=n?l(i[0]):l(i):r(c)?u=n?[l(i[0]),l(i[1])]:[l(i),l(i)]:r(p)&&(u=n?i.map(l):[l(i)]),"="===o?function(e){return s(e)===u}:"!="===o?function(e){return s(e)!==u}:"<"===o?function(e){return s(e)<u}:"<="===o?function(e){return s(e)<=u}:">"===o?function(e){return s(e)>u}:">="===o?function(e){return s(e)>=u}:"[]"===o?function(e){var t=s(e);return t>=u[0]&&t<=u[1]}:"()"===o?function(e){var t=s(e);return t>u[0]&&t<u[1]}:"[)"===o?function(e){var t=s(e);return t>=u[0]&&t<u[1]}:"(]"===o?function(e){var t=s(e);return t>u[0]&&t<=u[1]}:"]["===o?function(e){var t=s(e);return t<=u[0]||t>=u[1]}:")("===o?function(e){var t=s(e);return t<u[0]||t>u[1]}:"]("===o?function(e){var t=s(e);return t<=u[0]||t>u[1]}:")["===o?function(e){var t=s(e);return t<u[0]||t>=u[1]}:"{}"===o?function(e){return-1!==u.indexOf(s(e))}:"}{"===o?function(e){return-1===u.indexOf(s(e))}:void 0}var o=e("../lib"),i=e("../registry"),n=e("../plots/cartesian/axes"),l=e("./helpers").pointsAccessorFunction,s=e("../constants/filter_ops"),d=s.COMPARISON_OPS,c=s.INTERVAL_OPS,p=s.SET_OPS;a.moduleType="transform",a.name="filter",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(d).concat(c).concat(p),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},a.supplyDefaults=function(e){function t(t,i){return o.coerce(e,r,a.attributes,t,i)}var r={},n=t("enabled");if(n){var l=t("target");if(o.isArrayOrTypedArray(l)&&0===l.length)return r.enabled=!1,r;t("preservegaps"),t("operation"),t("value");var s=i.getComponentMethod("calendars","handleDefaults");s(e,r,"valuecalendar",null),s(e,r,"targetcalendar",null)}return r},a.calcTransform=function(e,t,a){function s(e,a){for(var r=0,i;r<g.length;r++)i=o.nestedProperty(t,g[r]),e(i,a)}if(a.enabled){var d=o.getTargetArray(t,a);if(d){var c=a.target,p=d.length;t._length&&(p=ea(p,t._length));var u=a.targetcalendar,g=t._arrayAttrs,h=a.preservegaps;if("string"==typeof c){var m=o.nestedProperty(t,c+"calendar").get();m&&(u=m)}var y=n.getDataToCoordFunc(e,t,c,d),f=r(a,y,u),x={},_={},b=0,v,k;h?(v=function(e){x[e.astr]=o.extendDeep([],e.get()),e.set(Array(p))},k=function(e,t){var a=x[e.astr][t];e.get()[t]=a}):(v=function(e){x[e.astr]=o.extendDeep([],e.get()),e.set([])},k=function(e,t){var a=x[e.astr][t];e.get().push(a)}),s(v);for(var w=l(t.transforms,a),T=0,A;T<p;T++)A=f(d[T]),A?(s(k,T),_[b++]=w(T)):h&&b++;a._indexToPoints=_,t._length=b}}}},{"../constants/filter_ops":691,"../lib":719,"../plots/cartesian/axes":767,"../registry":847,"./helpers":1269}],1268:[function(e,t,a){"use strict";function r(e,t){var a=t.transform,r=t.transformIndex,d=e.transforms[r].groups,c=s(e.transforms,a),p,u,g,h,m,y,f,x,_,b;if(!Array.isArray(d)||0===d.length)return[e];var v=o.filterUnique(d),w=Array(v.length),T=d.length,A=n.findArrayAttributes(e),S=a.styles||[],C={};for(p=0;p<S.length;p++)C[S[p].target]=S[p].value;a.styles&&(b=o.keyedContainer(a,"styles","target","value.name"));var L={},E={};for(p=0;p<v.length;p++){y=v[p],L[y]=p,E[y]=0,f=w[p]=o.extendDeepNoArrays({},e),f._group=y,f.transforms[r]._indexToPoints={};var I=null;for(b&&(I=b.get(y)),f.name=I||""===I?I:o.templateString(a.nameformat,{trace:e.name,group:y}),x=f.transforms,f.transforms=[],u=0;u<x.length;u++)f.transforms[u]=o.extendDeepNoArrays({},x[u]);for(u=0;u<A.length;u++)o.nestedProperty(f,A[u]).set([])}for(g=0;g<A.length;g++){for(h=A[g],u=0,_=[];u<v.length;u++)_[u]=o.nestedProperty(w[u],h).get();for(m=o.nestedProperty(e,h).get(),u=0;u<T;u++)_[L[d[u]]].push(m[u])}for(u=0;u<T;u++){f=w[L[d[u]]];var z=f.transforms[r]._indexToPoints;z[E[d[u]]]=c(u),E[d[u]]++}for(p=0;p<v.length;p++)y=v[p],f=w[p],l.clearExpandedTraceDefaultColors(f),f=o.extendDeepNoArrays(f,C[y]||{});return w}var o=e("../lib"),n=e("../plot_api/plot_schema"),l=e("../plots/plots"),s=e("./helpers").pointsAccessorFunction;a.moduleType="transform",a.name="groupby",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},a.supplyDefaults=function(e,t,r){function n(t,r){return o.coerce(e,l,a.attributes,t,r)}var l={},s=n("enabled"),d;if(!s)return l;n("groups"),n("nameformat",1<r._dataLength?"%{group} (%{trace})":"%{group}");var c=e.styles,p=l.styles=[];if(c)for(d=0;d<c.length;d++){var u=p[d]={};o.coerce(c[d],p[d],a.attributes.styles,"target");var g=o.coerce(c[d],p[d],a.attributes.styles,"value");o.isPlainObject(g)?u.value=o.extendDeep({},g):g&&delete u.value}return l},a.transform=function(e,t){var a=[],o,n,l;for(n=0;n<e.length;n++)for(o=r(e[n],t),l=0;l<o.length;l++)a.push(o[l]);return a}},{"../lib":719,"../plot_api/plot_schema":756,"../plots/plots":828,"./helpers":1269}],1269:[function(e,t,a){"use strict";a.pointsAccessorFunction=function(e,t){for(var a=0,r,o;a<e.length&&(r=e[a],r!==t);a++)!r._indexToPoints||!1===r.enabled||(o=r._indexToPoints);var n=o?function(e){return o[e]}:function(e){return[e]};return n}},{}],1270:[function(e,t,a){"use strict";function r(e,t,a,r){var n=Array(r),l=Array(r),s;for(s=0;s<r;s++)n[s]={v:t[s],i:s};for(n.sort(o(e,a)),s=0;s<r;s++)l[s]=n[s].i;return l}function o(e,t){switch(e.order){case"ascending":return function(e,a){return t(e.v)-t(a.v)};case"descending":return function(e,a){return t(a.v)-t(e.v)};}}var n=e("../lib"),l=e("../plots/cartesian/axes"),s=e("./helpers").pointsAccessorFunction;a.moduleType="transform",a.name="sort",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},a.supplyDefaults=function(e){function t(t,o){return n.coerce(e,r,a.attributes,t,o)}var r={},o=t("enabled");return o&&(t("target"),t("order")),r},a.calcTransform=function(e,t,a){if(a.enabled){var o=n.getTargetArray(t,a);if(o){var d=a.target,c=o.length;t._length&&(c=ea(c,t._length));var p=t._arrayAttrs,u=l.getDataToCoordFunc(e,t,d,o),g=r(a,o,u,c),h=s(t.transforms,a),m={},y,f;for(y=0;y<p.length;y++){var x=n.nestedProperty(t,p[y]),_=x.get(),b=Array(c);for(f=0;f<c;f++)b[f]=_[g[f]];x.set(b)}for(f=0;f<c;f++)m[f]=h(g[f]);a._indexToPoints=m,t._length=c}}}},{"../lib":719,"../plots/cartesian/axes":767,"./helpers":1269}]},{},[25])(25)});